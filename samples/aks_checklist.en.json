{
  "items": [
    {
      "category": "BC and DR",
      "subcategory": "Requirements",
      "text": "Define non-functional requirements usch as SLAs, RTO and RPO.",
      "severity": "High",
      "link": "https://docs.microsoft.com/azure/cloud-adoption-framework/ready/enterprise-scale/business-continuity-and-disaster-recovery"
    },
    {
      "category": "BC and DR",
      "subcategory": "DR",
      "text": "Perform DR tests",
      "severity": "High",
      "link": "https://docs.microsoft.com/azure/cloud-adoption-framework/ready/enterprise-scale/business-continuity-and-disaster-recovery"
    },
    {
      "category": "BC and DR",
      "subcategory": "DR",
      "text": "Use Traffic Manager or Front Door as a global load balancer for region failover",
      "severity": "Medium",
      "link": "https://docs.microsoft.com/azure/aks/operator-best-practices-multi-region"
    },
    {
      "category": "BC and DR",
      "subcategory": "HA",
      "text": "Use Availability Zones",
      "severity": "Medium",
      "link": "https://docs.microsoft.com/azure/aks/availability-zones"
    },
    {
      "category": "BC and DR",
      "subcategory": "HA",
      "text": "Use the SLA-backed AKS offering",
      "severity": "High",
      "graph_success": "where type=='microsoft.containerservice/managedclusters' | where sku.tier=='Paid' | distinct name,resourceGroup",
      "graph_failure": "where type=='microsoft.containerservice/managedclusters' | where sku.tier=='Free' | distinct name,resourceGroup",
      "link": "https://docs.microsoft.com/azure/aks/uptime-sla"
    },
    {
      "category": "BC and DR",
      "subcategory": "HA",
      "text": "Use Disruption Budgets in your pod specs",
      "severity": "Low",
      "link": "https://docs.microsoft.com/azure/aks/operator-best-practices-scheduler"
    },
    {
      "category": "BC and DR",
      "subcategory": "HA",
      "text": "If using a private registry, configure region replication to store images in multiple regions",
      "severity": "High",
      "link": "https://docs.microsoft.com/azure/container-registry/container-registry-geo-replication"
    },
    {
      "category": "Identity and Access Management",
      "subcategory": "Identity",
      "text": "Use managed identities instead of Service Principals",
      "severity": "High",
      "link": "https://docs.microsoft.com/azure/aks/use-managed-identity"
    },
    {
      "category": "Identity and Access Management",
      "subcategory": "Identity",
      "text": "Integrate authentication with AAD (using the managed integration)",
      "severity": "Medium",
      "link": "https://docs.microsoft.com/azure/aks/managed-aad"
    },
    {
      "category": "Identity and Access Management",
      "subcategory": "Identity",
      "text": "Limit access to admin kubeconfig (get-credentials --admin)",
      "severity": "Medium",
      "link": "https://docs.microsoft.com/azure/aks/control-kubeconfig-access"
    },
    {
      "category": "Identity and Access Management",
      "subcategory": "Identity",
      "text": "Integrate authorization with AAD RBAC",
      "severity": "Medium",
      "link": "https://docs.microsoft.com/azure/aks/manage-azure-rbac"
    },
    {
      "category": "Identity and Access Management",
      "subcategory": "Identity",
      "text": "Use namespaces for restricting RBAC privilege in Kubernetes",
      "severity": "High",
      "link": "https://docs.microsoft.com/azure/aks/operator-best-practices-identity"
    },
    {
      "category": "Identity and Access Management",
      "subcategory": "Identity",
      "text": "Use Pod identity for workload identities (addon v2 in preview today)",
      "severity": "Medium",
      "link": "https://docs.microsoft.com/azure/aks/operator-best-practices-identity"
    },
    {
      "category": "Network Topology and Connectivity",
      "subcategory": "IPAM",
      "text": "Choose the best CNI plugin for your requirements (Azure CNI recommended)",
      "severity": "High",
      "graph_success": "where type=='microsoft.containerservice/managedclusters' | where properties.networkProfile.networkPlugin=='azure' | distinct name,resourceGroup",
      "graph_failure": "where type=='microsoft.containerservice/managedclusters' | where properties.networkProfile.networkPlugin=='kubenet' | distinct name,resourceGroup",
      "link": "https://docs.microsoft.com/azure/aks/operator-best-practices-network"
    },
    {
      "category": "Network Topology and Connectivity",
      "subcategory": "IPAM",
      "text": "If using Azure CNI, size your subnet accordingly",
      "severity": "High",
      "link": "https://docs.microsoft.com/azure/aks/configure-azure-cni"
    },
    {
      "category": "Network Topology and Connectivity",
      "subcategory": "IPAM",
      "text": "If using Azure CNI, check the maximum pods/node (default 30)",
      "severity": "High",
      "link": "https://docs.microsoft.com/azure/aks/configure-azure-cni"
    },
    {
      "category": "Network Topology and Connectivity",
      "subcategory": "IPAM",
      "text": "If using private-IP LoadBalancer services, use a dedicated subnet (not the AKS subnet)",
      "severity": "Low",
      "link": "https://docs.microsoft.com/azure/aks/internal-lb"
    },
    {
      "category": "Network Topology and Connectivity",
      "subcategory": "Security",
      "text": "Filter egress traffic with AzFW/NVA if your security requirements mandate it",
      "severity": "High",
      "graph_success": "where type=='microsoft.containerservice/managedclusters' | where properties.networkProfile.outboundType=='userDefinedRouting' | distinct name,resourceGroup",
      "graph_failure": "where type=='microsoft.containerservice/managedclusters' | where properties.networkProfile.outboundType!='userDefinedRouting' | distinct name,resourceGroup",
      "link": "https://docs.microsoft.com/azure/aks/limit-egress-traffic"
    },
    {
      "category": "Network Topology and Connectivity",
      "subcategory": "Security",
      "text": "If using public API enpoints, restrict the IP addresses that can access it",
      "severity": "Medium",
      "graph_success": "where type=='microsoft.containerservice/managedclusters' | where properties.publicNetworkAccess=='Enabled' and isnotnull(properties.apiServerAccessProfile) | distinct name,resourceGroup",
      "graph_failure": "where type=='microsoft.containerservice/managedclusters' | where properties.publicNetworkAccess=='Enabled' and isnull(properties.apiServerAccessProfile) | distinct name,resourceGroup",
      "link": "https://docs.microsoft.com/azure/aks/api-server-authorized-ip-ranges"
    },
    {
      "category": "Network Topology and Connectivity",
      "subcategory": "Scalability",
      "text": "Use an ingress controller to expose web-based apps",
      "severity": "Medium",
      "link": "https://docs.microsoft.com/azure/aks/concepts-network"
    },
    {
      "category": "Network Topology and Connectivity",
      "subcategory": "Best practices",
      "text": "If using AGIC, do not share an AppGW across clusters",
      "severity": "Medium",
      "link": "https://azure.github.io/application-gateway-kubernetes-ingress/setup/install-existing/"
    },
    {
      "category": "Network Topology and Connectivity",
      "subcategory": "Cost",
      "text": "Use Private Endpoints (preferred) or VNet Service Endpoints to access PaaS from the cluster",
      "severity": "Medium",
      "link": "https://docs.microsoft.com/azure/private-link/private-link-overview"
    },
    {
      "category": "Network Topology and Connectivity",
      "subcategory": "Security",
      "text": "Use private clusters if your requirements mandate it",
      "severity": "High",
      "graph_success": "where type=='microsoft.containerservice/managedclusters' | where properties.publicNetworkAccess=='Disabled' | distinct name,resourceGroup",
      "graph_failure": "where type=='microsoft.containerservice/managedclusters' | where properties.publicNetworkAccess=='Enabled' | distinct name,resourceGroup",
      "link": "https://docs.microsoft.com/azure/aks/private-clusters"
    },
    {
      "category": "Network Topology and Connectivity",
      "subcategory": "Security",
      "text": "Enable a Kubernetes Network Policy option (Calico/Azure)",
      "severity": "High",
      "graph_success": "where type=='microsoft.containerservice/managedclusters' | where isnotnull(properties.networkProfile.networkPolicy) | distinct name,resourceGroup",
      "graph_failure": "where type=='microsoft.containerservice/managedclusters' | where isnull(properties.networkProfile.networkPolicy) | distinct name,resourceGroup",
      "link": "https://docs.microsoft.com/azure/aks/use-network-policies"
    },
    {
      "category": "Network Topology and Connectivity",
      "subcategory": "Security",
      "text": "Use Network policies to increase intra-cluster security",
      "severity": "High",
      "link": "https://docs.microsoft.com/azure/aks/operator-best-practices-network"
    },
    {
      "category": "Network Topology and Connectivity",
      "subcategory": "Security",
      "text": "Use a WAF for web workloads (UIs or APIs)",
      "severity": "High",
      "link": "https://docs.microsoft.com/azure/aks/operator-best-practices-network"
    },
    {
      "category": "Network Topology and Connectivity",
      "subcategory": "Security",
      "text": "Use DDoS Standard in the AKS VNet",
      "severity": "Medium",
      "link": "https://docs.microsoft.com/azure/virtual-network/ddos-protection-overview"
    },
    {
      "category": "Network Topology and Connectivity",
      "subcategory": "Best practices",
      "text": "Do not use AKS Application Routing Add-On",
      "severity": "High",
      "graph_success": "where type=='microsoft.containerservice/managedclusters' | where isnull(properties.addonProfiles.httpApplicationRouting) | distinct name,resourceGroup",
      "graph_failure": "where type=='microsoft.containerservice/managedclusters' | where isnotnull(properties.addonProfiles.httpApplicationRouting) | distinct name,resourceGroup",
      "link": "https://docs.microsoft.com/azure/aks/http-application-routing"
    },
    {
      "category": "Network Topology and Connectivity",
      "subcategory": "HA",
      "text": "If hybrid connectivity is required, use 2xER or ER+VPN for better availability",
      "severity": "Medium",
      "link": "https://docs.microsoft.com/azure/expressroute/designing-for-disaster-recovery-with-expressroute-privatepeering"
    },
    {
      "category": "Network Topology and Connectivity",
      "subcategory": "Security",
      "text": "Consider using a service mesh for advanced microservice communication management",
      "severity": "Medium",
      "link": "https://docs.microsoft.com/azure/aks/servicemesh-about"
    },
    {
      "category": "Governance and Security",
      "subcategory": "Secrets",
      "text": "Store your secrets in Azure Key Vault with the CSI Secrets Store driver",
      "severity": "Medium",
      "link": "https://github.com/Azure/secrets-store-csi-driver-provider-azure"
    },
    {
      "category": "Governance and Security",
      "subcategory": "Secrets",
      "text": "If user Service Principals for the cluster, refresh credentials periodically (like quarterly)",
      "severity": "High",
      "link": "https://docs.microsoft.com/azure/aks/update-credentials"
    },
    {
      "category": "Governance and Security",
      "subcategory": "Compliance",
      "text": "Use Azure Policy for Kubernetes to ensure cluster compliance",
      "severity": "Medium",
      "link": "https://docs.microsoft.com/azure/governance/policy/concepts/policy-for-kubernetes"
    },
    {
      "category": "Governance and Security",
      "subcategory": "Compliance",
      "text": "Separate applications from the control plane with user/system nodepools",
      "severity": "Medium",
      "link": "https://docs.microsoft.com/azure/aks/use-system-pools"
    },
    {
      "category": "Governance and Security",
      "subcategory": "Compliance",
      "text": "Label your system nodepool to use it with node selectors",
      "severity": "Low",
      "link": "https://docs.microsoft.com/azure/aks/use-multiple-node-pools"
    },
    {
      "category": "Governance and Security",
      "subcategory": "Compliance",
      "text": "Use a private registry for your images, such as ACR",
      "severity": "Medium",
      "link": "https://docs.microsoft.com/azure/container-registry/"
    },
    {
      "category": "Governance and Security",
      "subcategory": "Compliance",
      "text": "Scan your images for vulnerabilities",
      "severity": "Medium",
      "link": "https://docs.microsoft.com/azure/security-center/container-security"
    },
    {
      "category": "Governance and Security",
      "subcategory": "Compliance",
      "text": "Use Azure Security Center to detect security posture vulnerabiities",
      "severity": "Medium",
      "link": "https://docs.microsoft.com/azure/security-center/container-security"
    },
    {
      "category": "Governance and Security",
      "subcategory": "Compliance",
      "text": "Define app separation requirements (namespace/nodepool/cluster)",
      "severity": "High",
      "link": "https://docs.microsoft.com/azure/aks/operator-best-practices-cluster-isolation"
    },
    {
      "category": "Cost Governance",
      "subcategory": "Cost",
      "text": "Use an external application such as kubecost to allocate custs to different users",
      "severity": "Low",
      "link": "https://docs.microsoft.com/azure/cloud-adoption-framework/scenarios/aks/eslz-cost-governance-with-kubecost"
    },
    {
      "category": "Operations",
      "subcategory": "Storage",
      "text": "Use ephemeral OS disks",
      "severity": "High",
      "link": "https://docs.microsoft.com/azure/aks/cluster-configuration"
    },
    {
      "category": "Operations",
      "subcategory": "Storage",
      "text": "If not using ephemeral disks, use larger OS disks for the nodes, especially if many pods/node",
      "severity": "High",
      "link": "https://docs.microsoft.com/azure/virtual-machines/disks-types"
    },
    {
      "category": "Operations",
      "subcategory": "Storage",
      "text": "Avoid keeping state in the cluster, and store data outside (AzStorage, AzSQL, Cosmos, etc)",
      "severity": "Medium",
      "link": "https://docs.microsoft.com/azure/aks/operator-best-practices-multi-region"
    },
    {
      "category": "Operations",
      "subcategory": "Storage",
      "text": "If using AzFiles Standard, consider AzFiles Premium and/or ANF for performance reasons",
      "severity": "Medium",
      "link": "https://docs.microsoft.com/azure/aks/operator-best-practices-storage"
    },
    {
      "category": "Operations",
      "subcategory": "Storage",
      "text": "If using Azure Disks and AZs, consider dedicating nodes per AZ and WaitForFirstConsumer",
      "severity": "Medium",
      "link": "https://docs.microsoft.com/azure/aks/availability-zones"
    },
    {
      "category": "Operations",
      "subcategory": "Compliance",
      "text": "Check regularly Azure Advisor for recommendations on your cluster",
      "severity": "Low",
      "link": "https://docs.microsoft.com/azure/advisor/advisor-get-started"
    },
    {
      "category": "Operations",
      "subcategory": "Compliance",
      "text": "Check regularly kubeadvisor for recommendations on your cluster",
      "severity": "Low",
      "link": "https://docs.microsoft.com/azure/aks/operator-best-practices-scheduler"
    },
    {
      "category": "Operations",
      "subcategory": "Monitoring",
      "text": "Monitor your cluster metrics with Azure Monitor, Prometheus or similar",
      "severity": "High",
      "link": "https://docs.microsoft.com/azure/azure-monitor/insights/container-insights-overview"
    },
    {
      "category": "Operations",
      "subcategory": "Monitoring",
      "text": "Store and analyze your cluster logs with Azure Monitor, Telegraf/ElasticSearch or similar",
      "severity": "High",
      "link": "https://docs.microsoft.com/azure/azure-monitor/insights/container-insights-overview"
    },
    {
      "category": "Operations",
      "subcategory": "Alerting",
      "text": "Configure alerts on the most critical metrics (Container Insights for recommendations)",
      "severity": "High",
      "link": "https://docs.microsoft.com/azure/azure-monitor/insights/container-insights-metric-alerts"
    },
    {
      "category": "Operations",
      "subcategory": "Compliance",
      "text": "Have a regular process to upgrade the cluster periodically (quarterly, for example)",
      "severity": "High",
      "link": "https://docs.microsoft.com/azure/aks/supported-kubernetes-versions"
    },
    {
      "category": "Operations",
      "subcategory": "Compliance",
      "text": "Use kured for Linux node upgrades",
      "severity": "High",
      "link": "https://docs.microsoft.com/azure/aks/node-updates-kured"
    },
    {
      "category": "Operations",
      "subcategory": "Compliance",
      "text": "Consider gitops to deploy applications or cluster configuration to multiple clusters",
      "severity": "Low",
      "link": "https://docs.microsoft.com/azure/architecture/example-scenario/bedrock/bedrock-automated-deployments"
    },
    {
      "category": "Operations",
      "subcategory": "Cost",
      "text": "Consider spot node pools for non time-sensitive workloads",
      "severity": "Low",
      "link": "https://docs.microsoft.com/azure/aks/spot-node-pool"
    },
    {
      "category": "Operations",
      "subcategory": "Cost",
      "text": "Consider the virtual node for quick bursting",
      "severity": "Low",
      "link": "https://docs.microsoft.com/azure/aks/concepts-scale"
    },
    {
      "category": "Operations",
      "subcategory": "Cost",
      "text": "Use tools like kubecost to allocate costs to different departments",
      "severity": "Low",
      "link": "https://kubecost.com/"
    },
    {
      "category": "Operations",
      "subcategory": "Compliance",
      "text": "Make sure no changes are performed by operators in the node RG (aka 'infra RG')",
      "severity": "High",
      "link": "https://docs.microsoft.com/azure/aks/faq"
    },
    {
      "category": "Operations",
      "subcategory": "Compliance",
      "text": "Use custom Node RG (aka 'Infra RG') name",
      "severity": "Low",
      "link": "https://docs.microsoft.com/azure/aks/cluster-configuration"
    },
    {
      "category": "Operations",
      "subcategory": "Compliance",
      "text": "Do not use deprecated Kubernetes APIs in your YAML manifests",
      "severity": "Medium",
      "link": "https://kubernetes.io/docs/setup/release/notes/"
    },
    {
      "category": "Operations",
      "subcategory": "Compliance",
      "text": "Taint Windows nodes",
      "severity": "Low",
      "link": "https://docs.microsoft.com/azure-stack/aks-hci/adapt-apps-mixed-os-clusters"
    },
    {
      "category": "Operations",
      "subcategory": "Compliance",
      "text": "Keep windows containers patch level in sync with host patch level",
      "severity": "Low",
      "link": "https://docs.microsoft.com/virtualization/windowscontainers/deploy-containers/version-compatibility?tabs=windows-server-20H2%2Cwindows-10-20H2"
    },
    {
      "category": "Operations",
      "subcategory": "Monitoring",
      "text": "Monitor CPU and memory utilization of the nodes",
      "severity": "Medium",
      "link": "https://docs.microsoft.com/azure/azure-monitor/containers/container-insights-analyze"
    },
    {
      "category": "Operations",
      "subcategory": "Monitoring",
      "text": "If using Azure CNI, monitor % of pod IPs consumed per node",
      "severity": "Medium",
      "link": "https://docs.microsoft.com/azure/aks/configure-azure-cni"
    },
    {
      "category": "Operations",
      "subcategory": "Monitoring",
      "text": "Monitor OS disk queue depth in nodes",
      "severity": "Medium",
      "link": "https://docs.microsoft.com/azure/virtual-machines/premium-storage-performance"
    },
    {
      "category": "Operations",
      "subcategory": "Monitoring",
      "text": "If not using egress filtering with AzFW/NVA, monitor standard ALB allocated SNAT ports",
      "severity": "Medium",
      "link": "https://docs.microsoft.com/azure/aks/load-balancer-standard"
    },
    {
      "category": "Operations",
      "subcategory": "Compliance",
      "text": "Send master logs (aka API logs) to Log Analytics",
      "severity": "Low",
      "link": "https://docs.microsoft.com/azure/aks/monitor-aks"
    },
    {
      "category": "Operations",
      "subcategory": "Scalability",
      "text": "Use the Cluster Autoscaler",
      "severity": "Medium",
      "link": "https://docs.microsoft.com/azure/aks/concepts-scale"
    },
    {
      "category": "Operations",
      "subcategory": "Scalability",
      "text": "Use the Horizontal Pod Autoscaler when required",
      "severity": "Medium",
      "link": "https://docs.microsoft.com/azure/aks/concepts-scale"
    },
    {
      "category": "Operations",
      "subcategory": "Scalability",
      "text": "Consider an appropriate node size, not too large or too small",
      "severity": "High",
      "link": "https://blog.cloudtrooper.net/2020/10/23/which-vm-size-should-i-choose-as-aks-node/"
    },
    {
      "category": "Operations",
      "subcategory": "Resources",
      "text": "Configre requests and limits in your pod specs",
      "severity": "High",
      "link": "https://docs.microsoft.com/azure/aks/operator-best-practices-scheduler"
    },
    {
      "category": "Operations",
      "subcategory": "Resources",
      "text": "Enforce resource quotas for namespaces",
      "severity": "Medium",
      "link": "https://docs.microsoft.com/azure/aks/operator-best-practices-scheduler"
    },
    {
      "category": "Operations",
      "subcategory": "Resources",
      "text": "Ensure your subscription has enough quota to scale out your nodepools",
      "severity": "High",
      "link": "https://docs.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits"
    },
    {
      "category": "Application Deployment",
      "subcategory": "IaC",
      "text": "Use automation through ARM/TF to create your Azure resources",
      "severity": "Medium",
      "link": "https://docs.microsoft.com/azure/developer/terraform/create-k8s-cluster-with-tf-and-aks"
    },
    {
      "category": "Application Deployment",
      "subcategory": "Development",
      "text": "Use canary or blue/green deployments",
      "severity": "Medium",
      "link": "https://docs.microsoft.com/azure/architecture/reference-architectures/containers/aks/secure-baseline-aks"
    },
    {
      "category": "Application Deployment",
      "subcategory": "Development",
      "text": "Use KEDA if running event-driven workloads",
      "severity": "Low",
      "link": "https://docs.microsoft.com/azure/azure-functions/functions-kubernetes-keda"
    },
    {
      "category": "Application Deployment",
      "subcategory": "Development",
      "text": "Use Dapr to ease microservice development",
      "severity": "Low",
      "link": "https://dapr.io/"
    }
  ],
  "categories": [
    {
      "name": "Identity and Access Management"
    },
    {
      "name": "Network Topology and Connectivity"
    },
    {
      "name": "BC and DR"
    },
    {
      "name": "Governance and Security"
    },
    {
      "name": "Cost Governance"
    },
    {
      "name": "Operations"
    },
    {
      "name": "Application Deployment"
    }
  ],
  "severities": [
    {
      "name": "High"
    },
    {
      "name": "Medium"
    },
    {
      "name": "Low"
    }
  ],
  "metadata": {
    "name": "Azure Landing Zone Review"
  }
}


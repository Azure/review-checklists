description: |-
  Use Application Gateway with Web Application Firewall (WAF) in an application virtual network to safeguard inbound HTTP/S internet traffic. WAF offers centralized defense against potential exploits through OWASP core rule sets-based rules.
guid: 8d9223c4-730d-ca47-af88-a9a024c37270
labels:
  area: Security
links: []
queries:
  arg: |+
    // Azure Resource Graph Query
    // This query will return all Application Gateways that do not have WAF enabled
    Resources
    | where type =~ "microsoft.network/applicationGateways"
    | where properties.firewallpolicy != ""
    | project recommendationId = "8d9223c4-730d-ca47-af88-a9a024c37270", name, id, tags, param1 = "webApplicationFirewallConfiguration: isNull"
    | order by id asc

resourceTypes:
- Microsoft.Network/applicationGateways
service: AppGW
severity: 2
source:
  file: azure-resources/Network/applicationGateways/recommendations.yaml
  type: aprl
title: Enable Web Application Firewall policies

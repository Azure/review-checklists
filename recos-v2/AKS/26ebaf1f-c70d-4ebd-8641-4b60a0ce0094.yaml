description: 'Azure Policies in AKS clusters help enforce governance best practices
  concerning security, authentication, provisioning, networking, and more, ensuring
  a robust and secure environment for operations.

  '
guid: 26ebaf1f-c70d-4ebd-8641-4b60a0ce0094
labels:
  area: Governance
  source: azure-resources/ContainerService/managedClusters/recommendations.yaml
  sourceType: aprl
links: []
queries:
- arg: "// Azure Resource Graph Query\n// Returns a count of non-compliant policy\
    \ items per AKS cluster\nPolicyResources\n| where type =~ 'Microsoft.PolicyInsights/PolicyStates'\n\
    | extend complianceState = tostring(properties.complianceState)\n| where complianceState\
    \ == 'NonCompliant'\n| where properties.resourceType =~ 'Microsoft.ContainerService/managedClusters'\n\
    | extend\n    id = tostring(properties.resourceId)\n| summarize count() by id\n\
    | join kind=inner (\n    resources\n    | where type =~ 'Microsoft.ContainerService/managedClusters'\n\
    \    | project id, name\n) on id\n| project recommendationId=\"26ebaf1f-c70d-4ebd-8641-4b60a0ce0094\"\
    , id, name, param1=strcat(\"numNonCompliantAlerts: \", count_)\n"
resourceTypes:
- Microsoft.ContainerService/managedClusters
service: AKS
severity: 2
text: Enable and remediate Azure Policies configured for AKS

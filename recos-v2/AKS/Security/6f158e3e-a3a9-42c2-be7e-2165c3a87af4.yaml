guid: 6f158e3e-a3a9-42c2-be7e-2165c3a87af4
labels: {}
links:
- https://learn.microsoft.com/azure/aks/use-system-pools
queries:
  arg: where type=='microsoft.containerservice/managedclusters' | project id,resourceGroup,name,pools=properties.agentPoolProfiles
    | project id,name,resourceGroup,poolcount=array_length(pools) | extend compliant
    = (poolcount > 1)
resourceTypes:
- microsoft.containerservice/managedClusters
service: AKS
severity: 1
source:
  file: ./checklists/waf_checklist.en.json
  type: local
title: Separate applications from the control plane with user/system node pools
waf: Security

guid: e7dbd21f-b27a-4b8c-a901-cedb1e6d8e1e
name: DisabledFallbackRoute
title: Disabled Fallback Route
description: |-
  Using message routing for custom endpoints in IoT Hub, messages might not reach these destinations if specific conditions are unmet. A default route ensures all messages are received, but disabling this safety net risks leaving some messages undelivered.
source:
  type: aprl
  file: azure-resources/Devices/iotHubs/recommendations.yaml
  timestamp: July 24, 2024
services:
- Microsoft.Devices/IotHubs
resourceTypes:
- Microsoft.Devices/IotHubs
severity: 2
labels:
  area: Monitoring and Alerting
links: []
queries:
  arg: |
    // Azure Resource Graph Query
    // list all IoT Hubs that have the fallback route disabled
    resources
    | where type == "microsoft.devices/iothubs"
    | extend fallbackEnabled=properties.routing.fallbackRoute.isEnabled
    | where fallbackEnabled == false
    | project recommendationId="e7dbd21f-b27a-4b8c-a901-cedb1e6d8e1e", name, id, tags, param1='FallbackRouteEnabled:false'

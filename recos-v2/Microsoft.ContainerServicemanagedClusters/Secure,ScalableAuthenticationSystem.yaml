guid: ca324d71-54b0-4a3e-b9e4-10e767daa9fc
name: Secure,ScalableAuthenticationSystem
title: Disable local accounts
description: |-
  Local Kubernetes accounts in AKS, being non-auditable and legacy, are discouraged. Microsoft Entra's integration offers centralized management, multi-factor authentication, RBAC for detailed access, and a secure, scalable authentication system compatible with Azure and external identity providers.
source:
  type: aprl
  file: azure-resources/ContainerService/managedClusters/recommendations.yaml
  timestamp: July 24, 2024
services:
- Microsoft.ContainerService/managedClusters
resourceTypes:
- Microsoft.ContainerService/managedClusters
severity: 0
labels:
  area: Security
links: []
queries:
  arg: |
    // Azure Resource Graph Query
    // Returns a list of AKS clusters not using AAD enabled
    resources
    | where type == "microsoft.containerservice/managedclusters"
    | extend aadProfile = tostring (parse_json(properties.aadProfile))
    | extend disablelocalAdmin = tostring(parse_json(properties.disableLocalAccounts))
    | extend RBAC = tostring(parse_json(properties.enableRBAC))
    | where RBAC == "false"
    | project recommendationId="ca324d71-54b0-4a3e-b9e4-10e767daa9fc", name, id, tags, param1=strcat("aadProfile: ", aadProfile), param2=strcat("disablelocalAdmin: ",disablelocalAdmin), param3=strcat("RBAC: ", RBAC)

guid: baf8e317-2397-4d49-b3d1-0dcc16d8778d
name: WafPolicy-236
title: Deploy your WAF policy for Application Gateway in 'Prevention' mode.
source:
  type: revcl
  file: ./checklists/waf_checklist.en.json
services:
- App Gateway
resourceTypes:
- microsoft.network/applicationGateways
waf: Security
severity: 0
labels: {}
links:
- https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-policy-settings
queries:
  arg: resources | where type == 'microsoft.network/frontdoorwebapplicationfirewallpolicies'
    | project policyName=name, policyId=id,policySku=sku.name, links=properties.securityPolicyLinks,
    enabledState=properties.policySettings.enabledState, mode=properties.policySettings.mode
    | mvexpand links | extend securityPolicy=links.id | extend securityPolicyParts=split(securityPolicy,
    '/') | extend profileId=strcat_array(array_slice(securityPolicyParts, 0, -3),
    '/') | project id=profileId, compliant=((enabledState=='Enabled') and (mode=='Prevention')),
    enabledState, mode
reviewed: August 26, 2024

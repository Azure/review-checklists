guid: 8d9223c4-730d-ca47-af88-a9a024c37270
name: OwaspCoreRuleSets-BasedRules
title: Enable Web Application Firewall policies
description: Use Application Gateway with Web Application Firewall (WAF) in an application
  virtual network to safeguard inbound HTTP/S internet traffic. WAF offers centralized
  defense against potential exploits through OWASP core rule sets-based rules.
source:
  type: aprl
  file: azure-resources/Network/applicationGateways/recommendations.yaml
  timestamp: July 24, 2024
services:
- Microsoft.Network/applicationGateways
resourceTypes:
- Microsoft.Network/applicationGateways
severity: 2
labels:
  area: Security
links: []
queries:
  arg: |
    // Azure Resource Graph Query
    // This query will return all Application Gateways that do not have WAF enabled
    Resources
    | where type =~ "microsoft.network/applicationGateways"
    | where properties.firewallpolicy != ""
    | project recommendationId = "8d9223c4-730d-ca47-af88-a9a024c37270", name, id, tags, param1 = "webApplicationFirewallConfiguration: isNull"
    | order by id asc

guid: 9c2299c4-d7b5-47d0-a655-562f2b3e4563
labels: {}
links:
- https://learn.microsoft.com/learn/paths/implement-network-security/
queries:
  arg: Resources | where type=='microsoft.network/virtualnetworks' | project id,resourceGroup,name,subnets=properties.subnets
    | mv-expand subnets | project id,name,subnetName=subnets.name,subnetNsg=subnets.properties.networkSecurityGroup
    | where not (subnetName in ('GatewaySubnet', 'AzureFirewallSubnet', 'RouteServerSubnet',
    'AzureBastionSubnet')) | extend compliant = isnotnull(subnetNsg)
resourceTypes:
- Microsoft.Network/networkSecurityGroups
service: NSG
severity: 1
source:
  file: ./checklists/waf_checklist.en.json
  type: local
title: The application team should use application security groups at the subnet-level
  NSGs to help protect multi-tier VMs within the landing zone.
waf: Security

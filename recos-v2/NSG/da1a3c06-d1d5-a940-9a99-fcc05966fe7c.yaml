description: 'Monitoring, managing, and understanding your network is crucial for
  protection and optimization. Knowing the current state, who and from where connections
  are made, open internet ports, expected and irregular behavior, and traffic spikes
  is essential.

  '
guid: da1a3c06-d1d5-a940-9a99-fcc05966fe7c
labels:
  area: Monitoring and Alerting
  source: azure-resources/Network/networkSecurityGroups/recommendations.yaml
  sourceType: aprl
links: []
queries:
- arg: "// Azure Resource Graph Query\n// Find all Network Security Groups without\
    \ NSG Flow logs configured or disabled.\nresources\n| where type =~ \"Microsoft.Network/networkSecurityGroups\"\
    \n| project name, id, tags, lowerCaseNsgId = tolower(id)\n| join kind = leftouter\
    \ (\n    resources\n    | where type == \"microsoft.network/networkwatchers/flowlogs\"\
    \ and properties.enabled == true\n    | project flowLogName = name, lowerCaseTargetNsgId\
    \ = tolower(properties.targetResourceId)\n    )\n    on $left.lowerCaseNsgId ==\
    \ $right.lowerCaseTargetNsgId\n| where isempty(lowerCaseTargetNsgId)\n| project\
    \ recommendationId = \"da1a3c06-d1d5-a940-9a99-fcc05966fe7c\", name, id, tags,\
    \ param1 = \"NSGFlowLog: Not configured/Disabled\"\n\n"
resourceTypes:
- Microsoft.Network/networkSecurityGroups
service: NSG
severity: 1
text: Configure NSG Flow Logs

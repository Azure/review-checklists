description: |-
  Azure network security groups filter network traffic between resources in a virtual network, using security rules to allow or deny inbound or outbound traffic based on source, destination, port, and protocol.
guid: 8291c1fa-650c-b44b-b008-4deb7465919d
labels:
  area: Security
links: []
queries:
  arg: |
    // Azure Resource Graph Query
    // This query will return all NSGs that have NO security rules
    resources
    | where type =~ "microsoft.network/networksecuritygroups"
    | extend sr = string_size(properties.securityRules)
    | where sr <=2 or isnull(properties.securityRules)
    | project recommendationId = "8291c1fa-650c-b44b-b008-4deb7465919d", name, id
resourceTypes:
- Microsoft.Network/networkSecurityGroups
service: NSG
severity: 1
source:
  file: azure-resources/Network/networkSecurityGroups/recommendations.yaml
  type: aprl
title: The NSG only has Default Security Rules, make sure to configure the necessary
  rules

guid: 6eab9eb6-762b-485e-8ea8-15aa5dba0bd0
labels:
  alzArea: Network Topology and Connectivity
  alzId: D05.02
  alzSubarea: Internet
  checklist: alz
links:
- https://learn.microsoft.com/azure/bastion/bastion-faq#subnet
queries:
  arg: resources | where type=='microsoft.network/virtualnetworks' | project id,subnets=properties.subnets
    | mv-expand subnets | project id, subnetName = subnets.name, subnetPrefix = subnets.properties.addressPrefix
    | extend subnetPrefixLength = split(subnetPrefix, '/')[1] | where subnetName ==
    'AzureBastionSubnet' | extend compliant = (subnetPrefixLength <= 26) | distinct
    id, compliant
resourceTypes: []
service: Bastion
severity: 1
title: Use Azure Bastion in a subnet /26 or larger.
waf: Security

guid: 9ca48e4a-85e2-4223-bce8-bb12307ca5f1
title: Use Azure Policy for Kubernetes to ensure cluster compliance
source:
  type: local
  file: ./checklists/aks_checklist.en.json
services:
- AKS
resourceTypes:
- microsoft.containerservice/managedClusters
waf: Security
severity: 1
labels:
  area: Governance and Security
  subarea: Compliance
  id: 04.01.01
links:
- https://learn.microsoft.com/azure/governance/policy/concepts/policy-for-kubernetes
queries:
  arg: where type=='microsoft.containerservice/managedclusters' | extend compliant
    = (isnotnull(properties.addonProfiles.azurepolicy) and properties.addonProfiles.azurepolicy.enabled==true)
    | distinct id,compliant

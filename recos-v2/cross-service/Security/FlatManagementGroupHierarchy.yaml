guid: 2df27ee4-12e7-4f98-9f63-04722dd69c5b
name: FlatManagementGroupHierarchy
title: Enforce reasonably flat management group hierarchy with no more than four levels.
source:
  type: revcl
  file: ./checklists/alz_checklist.en.json
resourceTypes: []
waf: Security
severity: 1
labels:
  alzArea: Resource Organization
  alzSubarea: Subscriptions
  alzId: C02.01
  checklist: alz
links:
- https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/resource-org-management-groups
- https://learn.microsoft.com/learn/modules/azure-architecture-fundamentals/
queries:
  arg: resourcecontainers| where type == 'microsoft.resources/subscriptions'| extend
    ManagementGroup = tostring(tags),mgmtChain = properties.managementGroupAncestorsChain|
    extend compliant =( array_length(mgmtChain) <= 4 and array_length(mgmtChain) >
    1)

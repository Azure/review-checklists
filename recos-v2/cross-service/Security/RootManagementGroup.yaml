guid: 33b6b780-8b9f-4e5c-9104-9d403a923c34
name: RootManagementGroup
title: Enforce no subscriptions are placed under the root management group
source:
  type: revcl
  file: ./checklists/alz_checklist.en.json
resourceTypes: []
waf: Security
severity: 1
labels:
  alzArea: Resource Organization
  alzSubarea: Subscriptions
  alzId: C02.05
  checklist: alz
links:
- https://learn.microsoft.com/azure/governance/management-groups/how-to/protect-resource-hierarchy#setting---default-management-group
queries:
  arg: resourcecontainers| where type == 'microsoft.resources/subscriptions'| extend
    ManagementGroup = tostring(tags),mgmtChain = properties.managementGroupAncestorsChain|
    extend compliant = (array_length(mgmtChain) > 1)
reviewed: August 26, 2024

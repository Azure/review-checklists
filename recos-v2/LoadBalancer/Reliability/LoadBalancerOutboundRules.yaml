guid: 97a2fd46-64b0-1dfa-b72d-9c8869496d75
name: LoadBalancerOutboundRules
title: Use Azure NAT Gateway instead of Load Balancer outbound rules for better SNAT
  scalability
source:
  type: revcl
  file: ./checklists/waf_checklist.en.json
services:
- Load Balancer
resourceTypes:
- Microsoft.Network/loadBalancers
waf: Reliability
severity: 0
labels: {}
links:
- https://learn.microsoft.com/azure/nat-gateway/nat-overview#outbound-connectivity
queries:
  arg: resources | where type=='microsoft.network/loadbalancers' | extend countOutRules=array_length(properties.outboundRules)
    | extend compliant = (countOutRules == 0) | distinct id,compliant

guid: 9e39919b-78af-4a0b-b70f-c548dae97c25
name: RecoveryServicesVaults
title: Enable Soft Delete for Recovery Services Vaults in Azure Backup
description: |-
  With soft delete, if backup data is deleted, the backup data is retained for 14 additional days, allowing the recovery of that backup item with no data loss with no cost to you. Soft delete is enabled by default. Disabling this feature isn't recommended.
source:
  type: aprl
  file: azure-resources/RecoveryServices/vaults/recommendations.yaml
  timestamp: July 24, 2024
services:
- Microsoft.RecoveryServices/vaults
resourceTypes:
- Microsoft.RecoveryServices/vaults
severity: 1
labels:
  area: Disaster Recovery
links: []
queries:
  arg: |-
    // Azure Resource Graph Query
    // Find all Azure Recovery Services vaults that do not have soft delete  enabled
    resources
    | where type == "microsoft.recoveryservices/vaults"
    | mv-expand issoftDelete=properties.securitySettings.softDeleteSettings.softDeleteState
    | where issoftDelete == 'Disabled'
    | project recommendationId = "9e39919b-78af-4a0b-b70f-c548dae97c25", name, id, tags, param1=strcat("Soft Delete: ",issoftDelete)

guid: e7495e1c-0c75-0946-b266-b429b5c7f3bf
name: FlexOrchestrationMode
title: Deploy VMSS with Flex orchestration mode instead of Uniform
description: |-
  Deploying even single instance VMs into a scale set with Flexible orchestration mode future-proofs applications for scaling and availability. This mode guarantees high availability (up to 1000 VMs) by distributing VMs across fault domains in a region or within an Availability Zone.
source:
  type: aprl
  file: azure-resources/Compute/virtualMachineScaleSets/recommendations.yaml
  timestamp: July 24, 2024
services:
- Microsoft.Compute/virtualMachineScaleSets
resourceTypes:
- Microsoft.Compute/virtualMachineScaleSets
severity: 1
labels:
  area: Scalability
links: []
queries:
  arg: |
    // Azure Resource Graph Query
    // Find all zonal VMs that are NOT deployed with Flex orchestration mode
    resources
    | where type == "microsoft.compute/virtualmachinescalesets"
    | where properties.orchestrationMode != "Flexible"
    | project recommendationId = "e7495e1c-0c75-0946-b266-b429b5c7f3bf", name, id, tags, param1 = strcat("orchestrationMode: ", tostring(properties.orchestrationMode))

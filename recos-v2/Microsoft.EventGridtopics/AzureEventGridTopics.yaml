guid: b2069f64-4741-3d4a-a71d-50c8b03f5ab7
name: AzureEventGridTopics
title: Azure Event Grid topics should use Private Link Private Endpoints
description: |-
  Use private endpoints for secure event ingress to custom topics/domains via a private link, avoiding the public internet. It employs an IP from the VNet space for your topic/domain.
source:
  type: aprl
  file: azure-resources/EventGrid/topics/recommendations.yaml
  timestamp: July 24, 2024
services:
- Microsoft.EventGrid/topics
resourceTypes:
- Microsoft.EventGrid/topics
severity: 1
labels:
  area: Security
links: []
queries:
  arg: |
    // Azure Resource Graph Query
    // Find all eventgrid services not protected by private endpoints.
    Resources
    | where type contains "eventgrid"
    | where properties['publicNetworkAccess'] == "Enabled"
    | project recommendationId = "b2069f64-4741-3d4a-a71d-50c8b03f5ab7", name, id, tags
    | order by id asc

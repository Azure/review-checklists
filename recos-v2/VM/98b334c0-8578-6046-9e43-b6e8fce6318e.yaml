description: |-
  Azure Virtual Machines (VM) instances have various states, like provisioning and power states. A non-running VM may indicate issues or it being unnecessary, suggesting removal could help cut costs.
guid: 98b334c0-8578-6046-9e43-b6e8fce6318e
labels:
  area: Governance
links: []
queries:
  arg: |
    // Azure Resource Graph Query
    // Find all VMs that are NOT running
    Resources
    | where type =~ 'Microsoft.Compute/virtualMachines'
    | where properties.extended.instanceView.powerState.displayStatus != 'VM running'
    | project recommendationId = "98b334c0-8578-6046-9e43-b6e8fce6318e", name, id, tags
resourceTypes:
- Microsoft.Compute/virtualMachines
service: VM
severity: 2
source:
  file: azure-resources/Compute/virtualMachines/recommendations.yaml
  type: aprl
title: Review VMs in stopped state

description: 'Production VM workloads should be deployed on multiple VMs and grouped
  in a VMSS Flex instance to intelligently distribute across the platform, minimizing
  the impact of platform faults and updates.

  '
guid: 273f6b30-68e0-4241-85ea-acf15ffb60bf
labels:
  area: High Availability
  source: azure-resources/Compute/virtualMachines/recommendations.yaml
  sourceType: aprl
links: []
queries:
- arg: '// Azure Resource Graph Query

    // Find all VMs that are not associated with a VMSS Flex instance

    resources

    | where type =~ ''Microsoft.Compute/virtualMachines''

    | where isnull(properties.virtualMachineScaleSet.id)

    | project recommendationId="273f6b30-68e0-4241-85ea-acf15ffb60bf", name, id, tags


    '
resourceTypes:
- Microsoft.Compute/virtualMachines
service: VM
severity: 0
text: Run production workloads on two or more VMs using VMSS Flex

description: 'Container registries, used across multiple hosts, should be in their
  own resource group to prevent accidental deletion of images when container instances
  are deleted, preserving the image collection while experimenting with hosts.

  '
guid: 8e389532-5db5-7e4c-9d4d-443b3e55ae82
labels:
  area: Governance
  source: azure-resources/ContainerRegistry/registries/recommendations.yaml
  sourceType: aprl
links: []
queries:
- arg: "// Azure Resource Graph Query\n// List container registries that contain additional\
    \ resources within the same resource group.\nresources\n| where type =~ \"microsoft.containerregistry/registries\"\
    \n| project registryName=name, registryId=id, registryTags=tags, resourceGroupId=strcat('/subscriptions/',\
    \ subscriptionId, '/resourceGroups/', resourceGroup), resourceGroup, subscriptionId\n\
    | join kind=inner (\n    resources\n    | where not(type =~ \"microsoft.containerregistry/registries\"\
    )\n    | summarize recourceCount=count() by subscriptionId, resourceGroup\n  \
    \  | where recourceCount != 0\n) on resourceGroup, subscriptionId\n| project recommendationId\
    \ = \"8e389532-5db5-7e4c-9d4d-443b3e55ae82\", name=registryName, id=registryId,\
    \ tags=registryTags, param1=strcat('resourceGroupName:',resourceGroup), param2=strcat('resourceGroupId:',resourceGroupId)\n\
    \n"
resourceTypes:
- Microsoft.ContainerRegistry/registries
service: ACR
severity: 2
text: Move Container Registry to a dedicated resource group

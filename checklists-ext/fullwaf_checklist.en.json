{
    "items": [
        {
            "arm-service": "microsoft.containerregistry/registries",
            "checklist": "Azure Container Registry Security Review",
            "description": "Disable image export to prevent data exfiltration. Note that this will prevent image import of images into another ACR instance.",
            "guid": "ab91932c-9fc9-4d1b-a880-37f5e6bfcb9e",
            "link": "https://learn.microsoft.com/azure/container-registry/data-loss-prevention",
            "service": "ACR",
            "severity": "High",
            "text": "Disable Azure Container Registry image export",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerregistry/registries",
            "checklist": "Azure Container Registry Security Review",
            "description": "Enable audit compliance visibility by enabling Azure Policy for Azure Container Registry",
            "guid": "d503547c-d447-4e82-9128-a7100f1cac6d",
            "link": "https://learn.microsoft.com/azure/container-registry/container-registry-azure-policy",
            "service": "ACR",
            "severity": "High",
            "text": "Enable Azure Policies for Azure Container Registry",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerregistry/registries",
            "checklist": "Azure Container Registry Security Review",
            "description": "The Azure Key Vault (AKV) is used to store a signing key that can be utilized by?notation?with the notation AKV plugin (azure-kv) to sign and verify container images and other artifacts. The Azure Container Registry (ACR) allows you to attach these signatures using the?az?or?oras?CLI commands.",
            "guid": "d345293c-7639-4637-a551-c5c04e401955",
            "link": "https://learn.microsoft.com/azure/container-registry/container-registry-tutorial-sign-build-push",
            "service": "ACR",
            "severity": "High",
            "text": "Sign and Verify containers with notation (Notary v2)",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerregistry/registries",
            "checklist": "Azure Container Registry Security Review",
            "description": "Azure Container Registry automatically encrypts images and other artifacts that you store. By default, Azure automatically encrypts the registry content at rest by using service-managed keys. By using a customer-managed key, you can supplement default encryption with an additional encryption layer.",
            "guid": "0bd05dc2-efd5-4d76-8d41-d2500cc47b49",
            "link": "https://learn.microsoft.com/azure/container-registry/tutorial-customer-managed-keys",
            "service": "ACR",
            "severity": "Medium",
            "text": "Encrypt registry with a customer managed key",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerregistry/registries",
            "checklist": "Azure Container Registry Security Review",
            "description": "Use managed identities to secure ACRPull/Push RBAC access from client applications",
            "guid": "8f42d78e-79dc-47b3-9bd2-a1a27e7a8e90",
            "link": "https://learn.microsoft.com/azure/container-registry/container-registry-authentication-managed-identity",
            "service": "ACR",
            "severity": "High",
            "text": "Use Managed Identities to connect instead of Service Principals",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerregistry/registries",
            "checklist": "Azure Container Registry Security Review",
            "description": "The local Administrator account is disabled by default and should not be enabled. Use either Token or RBAC-based access methods instead",
            "guid": "be0e38ce-e297-411b-b363-caaab79b198d",
            "link": "https://learn.microsoft.com/azure/container-registry/container-registry-authentication-managed-identity",
            "service": "ACR",
            "severity": "High",
            "text": "Disable local authentication for management plane access",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerregistry/registries",
            "checklist": "Azure Container Registry Security Review",
            "description": "Disable Administrator account and assign RBAC roles to principals for ACR Pull/Push operations",
            "guid": "387e5ced-126c-4d13-8af5-b20c6998a646",
            "link": "https://learn.microsoft.com/azure/container-registry/container-registry-roles?tabs=azure-cli",
            "service": "ACR",
            "severity": "High",
            "text": "Assign AcrPull & AcrPush RBAC roles rather than granting Administrative access to identity principals",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerregistry/registries",
            "checklist": "Azure Container Registry Security Review",
            "description": "Disable anonymous pull/push access",
            "guid": "e338997e-41c7-47d7-acf6-a62a1194956d",
            "link": "https://learn.microsoft.com/azure/container-registry/anonymous-pull-access#configure-anonymous-pull-access",
            "service": "ACR",
            "severity": "Medium",
            "text": "Disable Anonymous pull access",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerregistry/registries",
            "checklist": "Azure Container Registry Security Review",
            "description": "Token authentication doesn't support assignment to an AAD principal. Any tokens provided are able to be used by anyone who can access the token",
            "guid": "698dc3a2-fd27-4b2e-8870-1a1252beedf6",
            "link": "https://learn.microsoft.com/azure/container-registry/container-registry-authentication?tabs=azure-cli",
            "service": "ACR",
            "severity": "High",
            "text": "Disable repository-scoped access tokens",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerregistry/registries",
            "checklist": "Azure Container Registry Security Review",
            "description": "Deploy container images to an ACR behind a Private endpoint within a trusted network",
            "guid": "b3bec3d4-f343-47c1-936d-b55f27a71eee",
            "service": "ACR",
            "severity": "High",
            "text": "Deploy images from a trusted environment",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerregistry/registries",
            "checklist": "Azure Container Registry Security Review",
            "description": "Only tokens with an ACR audience can be used for authentication. Used when enabling Conditional access policies for ACR",
            "guid": "3a041fd3-2947-498b-8288-b3c6a56ceb54",
            "link": "https://learn.microsoft.com/azure/container-registry/container-registry-enable-conditional-access-policy",
            "service": "ACR",
            "severity": "Medium",
            "text": "Disable Azure ARM audience tokens for authentication",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerregistry/registries",
            "checklist": "Azure Container Registry Security Review",
            "description": "Set up a diagnostic setting to send 'repositoryEvents' & 'LoginEvents' to Log Analytics as the central destination for logging and monitoring. This allows you to monitor control plane activity on the ACR resource itself.",
            "guid": "8a488cde-c486-42bc-9bd2-1be77f26e5e6",
            "link": "https://learn.microsoft.com/azure/container-registry/monitor-service",
            "service": "ACR",
            "severity": "Medium",
            "text": "Enable diagnostics logging",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerregistry/registries",
            "checklist": "Azure Container Registry Security Review",
            "description": "Service supports disabling public network access either through using service-level IP ACL filtering rule (not NSG or Azure Firewall) or using a 'Disable Public Network Access' toggle switch",
            "guid": "21d41d25-00b7-407a-b9ea-b40fd3290798",
            "link": "https://learn.microsoft.com/azure/container-registry/container-registry-private-link",
            "service": "ACR",
            "severity": "Medium",
            "text": "Control inbound network access with Private Link",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerregistry/registries",
            "checklist": "Azure Container Registry Security Review",
            "description": "Disable public network access if inbound network access is secured using Private Link",
            "guid": "cd289ced-6b17-4db8-8554-62f2aee4553a",
            "link": "https://learn.microsoft.com/azure/container-registry/container-registry-access-selected-networks#disable-public-network-access",
            "service": "ACR",
            "severity": "Medium",
            "text": "Disable Public Network access",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerregistry/registries",
            "checklist": "Azure Container Registry Security Review",
            "description": "Only the ACR Premium SKU supports Private Link access",
            "guid": "fc833934-8b26-42d6-ac5f-512925498f6d",
            "link": "https://learn.microsoft.com/azure/container-registry/container-registry-skus",
            "service": "ACR",
            "severity": "Medium",
            "text": "Use an Azure Container Registry SKU that supports Private Link (Premium SKU)",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerregistry/registries",
            "checklist": "Azure Container Registry Security Review",
            "description": "Azure Defender for containers or equivalent service should be used to scan container images for vulnerabilities",
            "guid": "bad37dac-43bc-46ce-8d7a-a9b24604489a",
            "link": "https://learn.microsoft.com/azure/defender-for-cloud/defender-for-containers-introduction",
            "service": "ACR",
            "severity": "Low",
            "text": "Enable Defender for Containers to scan Azure Container Registry for vulnerabilities",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerregistry/registries",
            "checklist": "Azure Container Registry Security Review",
            "description": "Deploy trusted code that was validated and scanned for vulnerabilities according to DevSecOps practices.",
            "guid": "4451e1a2-d345-4293-a763-9637a551c5c0",
            "service": "ACR",
            "severity": "Medium",
            "text": "Deploy validated container images",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerregistry/registries",
            "checklist": "Azure Container Registry Security Review",
            "description": "Use the latest versions of supported platforms, programming languages, protocols, and frameworks.",
            "guid": "4e401955-387e-45ce-b126-cd132af5b20c",
            "service": "ACR",
            "severity": "High",
            "text": "Use up-to-date platforms, languages, protocols and frameworks",
            "waf": "Reliability"
        },
        {
            "checklist": "Azure Service Fabric Review Checklist",
            "graph": "resources | where type=~'Microsoft.ServiceFabric/managedClusters' | extend compliant = (sku=~'{\"name\":\"Standard\"}') | distinct id,compliant",
            "guid": "182840d2-9ef8-4238-8fd6-0d76186830ac",
            "link": "https://learn.microsoft.com/azure/service-fabric/overview-managed-cluster#service-fabric-managed-cluster-skus",
            "service": "Azure Service Fabric",
            "severity": "Medium",
            "text": "Use Standard SKU for production scenarios.",
            "waf": "Reliability"
        },
        {
            "checklist": "Azure Service Fabric Review Checklist",
            "graph": "resources | where type=~'Microsoft.ServiceFabric/clusters' | extend nodeTypes= array_concat(properties.nodeTypes) | mv-expand nodeTypes | summarize BronzeDurabilityCount = countif(nodeTypes.durabilityLevel == 'Bronze') by id | extend compliant = (BronzeDurabilityCount == 0) | distinct id,compliant",
            "guid": "182840d2-9ef8-4238-8fd6-0d76186830ac",
            "link": "https://learn.microsoft.com/azure/service-fabric/service-fabric-cluster-capacity#durability-characteristics-of-the-cluster",
            "service": "Azure Service Fabric",
            "severity": "Medium",
            "text": "Use durability level Silver (5 VMs) or greater for production scenarios",
            "waf": "Reliability"
        },
        {
            "checklist": "Azure Service Fabric Review Checklist",
            "graph": "resources | where type=~'Microsoft.ServiceFabric/managedClusters' | extend compliant= ( properties.zonalResiliency =~ 'true') | distinct id,compliant",
            "guid": "2363878d-55c4-4cbd-9bc2-94523c85f12e",
            "link": "https://learn.microsoft.com/azure/service-fabric/how-to-managed-cluster-availability-zones",
            "service": "Azure Service Fabric",
            "severity": "Medium",
            "text": "Consider using Availability Zones for your Service Fabric clusters. Service Fabric managed cluster supports deployments that span across multiple Availability Zones to provide zone resiliency. This configuration will ensure high-availability of the critical system services and your applications to protect from single-points-of-failure.",
            "waf": "Reliability"
        },
        {
            "checklist": "Azure Service Fabric Review Checklist",
            "guid": "5ba74cc8-3ca2-44d5-9a67-bdc8e102e7b4",
            "link": "https://learn.microsoft.com/azure/service-fabric/service-fabric-api-management-overview",
            "service": "Azure Service Fabric",
            "severity": "Medium",
            "text": "Consider using Azure API Management to expose and offload cross-cutting functionality for APIs hosted on the cluster. API Management can integrate with Service Fabric directly.",
            "waf": "Reliability"
        },
        {
            "checklist": "Azure Service Fabric Review Checklist",
            "guid": "ef17bb8f-4e2c-488b-8ceb-a07c3d750dd3",
            "link": "https://learn.microsoft.com/azure/service-fabric/service-fabric-reliable-services-introduction",
            "service": "Azure Service Fabric",
            "severity": "Medium",
            "text": "For stateful workload scenarios, consider using Reliable Services. The Reliable Services model allows your services to stay up even in unreliable environments where your machines fail or hit network issues, or in cases where the services themselves encounter errors and crash or fail. For stateful services, your state is preserved even in the presence of network or other failures.",
            "waf": "Reliability"
        },
        {
            "checklist": "Azure Service Fabric Review Checklist",
            "graph": "resources | where type=~'Microsoft.Compute/virtualMachineScaleSets' | extend vmssExtension= array_concat(properties.virtualMachineProfile.extensionProfile.extensions) | mv-expand vmssExtension | where vmssExtension.properties.publisher matches regex '^Microsoft.Azure.ServiceFabric.*' | summarize arg_max(id, *) | summarize compliant = countif(sku.name matches regex '^Standard_[^d]*$' ) by id",
            "guid": "4da21268-f775-4c89-a271-eb80543c8df7",
            "service": "Azure Service Fabric",
            "severity": "Medium",
            "text": "Avoid VM SKUs with temp disk offerings. Service Fabric uses managed disks by default, so avoiding temp disk offerings ensures you don't pay for unneeded resources.",
            "waf": "Cost"
        },
        {
            "checklist": "Azure Service Fabric Review Checklist",
            "guid": "1890b796-f300-41a3-a8d4-29738c1f4ad0",
            "link": "https://learn.microsoft.com/azure/service-fabric/how-to-managed-cluster-stateless-node-type#temporary-disk-support",
            "service": "Azure Service Fabric",
            "severity": "Medium",
            "text": "If you need to select a certain VM SKU for capacity reasons and it happens to offer temp disk, consider using temporary disk support for your stateless workloads.",
            "waf": "Cost"
        },
        {
            "checklist": "Azure Service Fabric Review Checklist",
            "guid": "5247bb32-6778-49c7-8b40-e171c9a3ce1e",
            "service": "Azure Service Fabric",
            "severity": "Medium",
            "text": "Align SKU selection and managed disk size with workload requirements. Matching your selection to your workload demands ensures you don't pay for unneeded resources.",
            "waf": "Cost"
        },
        {
            "checklist": "Azure Service Fabric Review Checklist",
            "guid": "6028759b-446a-41bc-8b0e-7728e61ca704",
            "link": "https://learn.microsoft.com/azure/service-fabric/how-to-managed-cluster-networking#manage-nsg-rules",
            "service": "Azure Service Fabric",
            "severity": "Medium",
            "text": "Ensure Network Security Groups (NSG) are configured to restrict traffic flow between subnets and node types. For example, you may have an API Management instance (one subnet), a frontend subnet (exposing a website directly), and a backend subnet (accessible only to frontend).",
            "waf": "Reliability"
        },
        {
            "checklist": "Azure Service Fabric Review Checklist",
            "graph": "resources | where type=~'Microsoft.Compute/virtualMachineScaleSets' | extend vmssExtension= array_concat(properties.virtualMachineProfile.extensionProfile.extensions) | mv-expand vmssExtension | where vmssExtension.properties.publisher matches regex '^Microsoft.Azure.ServiceFabric.*' | summarize arg_max(id, *) | extend compliant = (isnotnull(properties.virtualMachineProfile.osProfile.secrets))",
            "guid": "4e98c903-14cf-4c72-9c45-b8b23bc4cbd8",
            "link": "https://learn.microsoft.com/azure/service-fabric/service-fabric-best-practices-security#deploy-key-vault-certificates-to-service-fabric-cluster-virtual-machine-scale-sets",
            "service": "Azure Service Fabric",
            "severity": "Medium",
            "text": "Deploy Key Vault certificates to Service Fabric cluster virtual machine scale sets. Centralizing storage of application secrets in Azure Key Vault allows you to control their distribution. Key Vault greatly reduces the chances that secrets may be accidentally leaked.",
            "waf": "Reliability"
        },
        {
            "checklist": "Azure Service Fabric Review Checklist",
            "guid": "001cbb6f-d88d-4431-8434-d01333397776",
            "link": "https://learn.microsoft.com/azure/service-fabric/service-fabric-best-practices-security#apply-an-access-control-list-acl-to-your-certificate-for-your-service-fabric-cluster",
            "service": "Azure Service Fabric",
            "severity": "Medium",
            "text": "Apply an Access Control List (ACL) to your client certificate for your Service Fabric cluster. Using an ACL provides an additional level of authentication.",
            "waf": "Reliability"
        },
        {
            "checklist": "Azure Service Fabric Review Checklist",
            "guid": "4b74b7a5-bb1e-4fca-948c-037ba95fb73b",
            "link": "https://learn.microsoft.com/azure/service-fabric/service-fabric-resource-governance#resource-governance-mechanism",
            "service": "Azure Service Fabric",
            "severity": "Medium",
            "text": "Use resource requests and limits to govern resource usage across the nodes in your cluster. Enforcing resource limits helps ensure that one service doesn't consume too many resources and starve other services.",
            "waf": "Reliability"
        },
        {
            "checklist": "Azure Service Fabric Review Checklist",
            "guid": "cd9233ba-f3aa-4353-8d2f-7ea4a64160e6",
            "link": "",
            "service": "Azure Service Fabric",
            "severity": "Medium",
            "text": "Encrypt Service Fabric package secret values. Encryption on your secret values provides an additional level of security.",
            "waf": "Reliability"
        },
        {
            "checklist": "Azure Service Fabric Review Checklist",
            "guid": "44b989d4-9f72-42b6-99da-ec2a79f83299",
            "link": "",
            "service": "Azure Service Fabric",
            "severity": "Medium",
            "text": "Include client certificates in Service Fabric applications. Having your applications use client certificates for authentication provides opportunities for security at both the cluster and workload level.",
            "waf": "Reliability"
        },
        {
            "checklist": "Azure Service Fabric Review Checklist",
            "guid": "28e66ff7-4a77-4b2c-910d-0335f141208a",
            "link": "https://learn.microsoft.com/azure/service-fabric/how-to-managed-identity-managed-cluster-virtual-machine-scale-sets",
            "service": "Azure Service Fabric",
            "severity": "Medium",
            "text": "Authenticate Service Fabric applications to Azure Resources using Managed Identity. Using Managed Identity allow you to securely manage the credentials in your code for authenticating to various services without saving them locally on a developer workstation or in source control.",
            "waf": "Reliability"
        },
        {
            "checklist": "Azure Service Fabric Review Checklist",
            "guid": "f16c413c-00a6-43aa-852c-b97292c33a56",
            "link": "https://learn.microsoft.com/azure/service-fabric/service-fabric-best-practices-security#hosting-untrusted-applications-in-a-service-fabric-cluster",
            "service": "Azure Service Fabric",
            "severity": "Medium",
            "text": "Follow Service Fabric best practices when hosting untrusted applications. Following the best practices provides a security standard to follow.",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/applicationGateways",
            "checklist": "Azure Application Delivery Networking",
            "graph": "resources | where type == 'microsoft.network/applicationgateways' | project id, compliant = properties.sku.name in ('Standard_v2', 'WAF_v2') | project id,compliant",
            "guid": "553585a6-abe0-11ed-afa1-0242ac120002",
            "link": "https://learn.microsoft.com/azure/application-gateway/overview-v2",
            "service": "AppGW",
            "severity": "Medium",
            "text": "Ensure you are using Application Gateway v2 SKU",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Network/loadBalancers",
            "checklist": "Azure Application Delivery Networking",
            "graph": "resources | where type == 'microsoft.network/loadbalancers' | project id, compliant=(tolower(sku.name) == 'standard')",
            "guid": "4e35fbf5-0ae2-48b2-97ce-753353edbd1a",
            "link": "https://learn.microsoft.com/azure/load-balancer/load-balancer-overview",
            "service": "Load Balancer",
            "severity": "Medium",
            "text": "Ensure you are using the Standard SKU for your Azure Load Balancers",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Network/loadBalancers",
            "checklist": "Azure Application Delivery Networking",
            "guid": "9432621a-8397-4654-a882-5bc856b7ef83",
            "link": "https://learn.microsoft.com/azure/load-balancer/load-balancer-standard-availability-zones",
            "service": "Load Balancer",
            "severity": "Medium",
            "text": "Ensure your Load Balancers frontend IP addresses are zone-redundant (unless you require zonal frontends).",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/applicationGateways",
            "checklist": "Azure Application Delivery Networking",
            "graph": "resources | where type=='microsoft.network/applicationgateways' | extend subnetId = tostring(properties.gatewayIPConfigurations[0].properties.subnet.id) | project id, subnetId | join (resources | where type=='microsoft.network/virtualnetworks' | project id,subnets=properties.subnets | mv-expand subnets | mv-expand subnets.properties.addressPrefixes | project id, subnetId = tostring(subnets.id), prefix1 = subnets.properties.addressPrefix, prefix2 = subnets.properties.addressPrefixes | mv-expand prefix2 | extend prefix = iff(isnotnull(prefix1), prefix1, prefix2) | extend subnetPrefixLength = split(prefix, '/')[1])on subnetId | extend compliant = (subnetPrefixLength <= 24 or subnetPrefixLength == 64) | distinct id,compliant",
            "guid": "dfc50f87-3800-424c-937b-ed5f186e7c15",
            "link": "https://learn.microsoft.com/azure/application-gateway/configuration-infrastructure#size-of-the-subnet",
            "service": "AppGW",
            "severity": "Medium",
            "text": "Your Application Gateways v2 should be deployed in subnets with IP prefixes equal or larger than /24",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/applicationGateways",
            "checklist": "Azure Application Delivery Networking",
            "description": "Administration of reverse proxies in general and WAF in particular is closer to the application than to networking, so they belong in the same subscription as the app. Centralizing the Application Gateway and WAF in the connectivity subscription might be OK if it is managed by one single team.",
            "guid": "48b662d6-d15f-4512-a654-98f6dfe237de",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "service": "AppGW",
            "severity": "Medium",
            "text": "Deploy Azure Application Gateway v2 or partner NVAs used for proxying inbound HTTP(S) connections within the landing-zone virtual network and with the apps that they're securing.",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/applicationGateways",
            "checklist": "Azure Application Delivery Networking",
            "guid": "f109e1f3-c79b-4f14-82de-6b5c22314d08",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "service": "AppGW",
            "severity": "Medium",
            "text": "Use a DDoS Network or IP protection plans for all Public IP addresses in application landing zones.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/applicationGateways",
            "checklist": "Azure Application Delivery Networking",
            "graph": "resources | where type =~ 'microsoft.network/applicationGateways' | extend compliant = (isnotnull(properties.autoscaleConfiguration) and properties.autoscaleConfiguration.minCapacity >= 2) | distinct id,compliant",
            "guid": "135bf4ac-f9db-461f-b76b-2ee9e30b12c0",
            "link": "https://learn.microsoft.com/azure/application-gateway/application-gateway-autoscaling-zone-redundant",
            "service": "AppGW",
            "severity": "Medium",
            "text": "Configure autoscaling with a minimum amount of instances of two.",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/applicationGateways",
            "checklist": "Azure Application Delivery Networking",
            "graph": "resources | where type =~ 'microsoft.network/applicationGateways' | extend compliant = (isnotnull(zones) and array_length(zones) > 1) | distinct id,compliant",
            "guid": "060c6964-52b5-48db-af8b-83e4b2d85349",
            "link": "https://learn.microsoft.com/azure/reliability/migrate-app-gateway-v2",
            "service": "AppGW",
            "severity": "Medium",
            "text": "Deploy Application Gateway across Availability Zones",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "Azure Application Delivery Networking",
            "guid": "3f29812b-2363-4cef-b179-b599de0d5973",
            "link": "https://learn.microsoft.com/azure/ddos-protection/ddos-protection-overview",
            "service": "Front Door",
            "severity": "Medium",
            "text": "When using Front Door and Application Gateway to help protect HTTP/S apps, use WAF policies in Front Door. Lock down Application Gateway to receive traffic only from Front Door.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Reliability"
        },
        {
            "ammp": true,
            "arm-service": "microsoft.network/trafficManagerProfiles",
            "checklist": "Azure Application Delivery Networking",
            "guid": "cd4cd21b-0881-437f-9e6c-4cfd3e504547",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "service": "Traffic Manager",
            "severity": "High",
            "text": "Use Traffic Manager to deliver global apps that span protocols other than HTTP/S.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Reliability"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "3b4b3e88-a459-4ed5-a22f-644dfbc58204",
            "link": "https://learn.microsoft.com/azure/active-directory/app-proxy/application-proxy#how-application-proxy-works",
            "service": "Entra",
            "severity": "Low",
            "text": "If users only need access to internal applications, has Microsoft Entra ID Application Proxy been considered as an alternative to Azure Virtual Desktop (AVD)?",
            "training": "https://learn.microsoft.com/learn/modules/configure-azure-ad-application-proxy/",
            "waf": "Reliability"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "01ca7cf1-5754-442d-babb-8ba6772e5c30",
            "link": "https://learn.microsoft.com/azure/active-directory/app-proxy/application-proxy#how-application-proxy-works",
            "service": "Entra",
            "severity": "Medium",
            "text": "To reduce the number of firewall ports open for incoming connections in your network, consider using Microsoft Entra ID Application Proxy to give remote users secure and authenticated access to internal applications.",
            "training": "https://learn.microsoft.com/learn/paths/implement-applications-external-access-azure-ad/",
            "waf": "Reliability"
        },
        {
            "ammp": true,
            "arm-service": "Microsoft.Network/loadBalancers",
            "checklist": "Azure Application Delivery Networking",
            "graph": "resources | where type=='microsoft.network/loadbalancers' | extend countOutRules=array_length(properties.outboundRules) | extend compliant = (countOutRules == 0) | distinct id,compliant",
            "guid": "97a2fd46-64b0-1dfa-b72d-9c8869496d75",
            "link": "https://learn.microsoft.com/azure/nat-gateway/nat-overview#outbound-connectivity",
            "service": "Load Balancer",
            "severity": "High",
            "text": "Use Azure NAT Gateway instead of Load Balancer outbound rules for better SNAT scalability",
            "waf": "Reliability"
        },
        {
            "ammp": true,
            "arm-service": "microsoft.network/applicationGateways",
            "checklist": "Azure Application Delivery Networking",
            "graph": "resources | where type == 'microsoft.network/applicationgatewaywebapplicationfirewallpolicies' | mv-expand properties.managedRules.managedRuleSets | project id, rulesettype = properties_managedRules_managedRuleSets.ruleSetType | extend compliant1 = (rulesettype == 'Microsoft_BotManagerRuleSet') | project id, compliant1 | summarize compliant = max(compliant1) by id",
            "guid": "2f8e81eb-8e68-4026-8b1f-70f9b05f7cf9",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/bot-protection",
            "service": "AppGW",
            "severity": "High",
            "text": "Enable the Azure Application Gateway WAF bot protection rule set. The bot rules detect good and bad bots.",
            "waf": "Reliability"
        },
        {
            "ammp": true,
            "arm-service": "microsoft.network/applicationGateways",
            "checklist": "Azure Application Delivery Networking",
            "graph": "resources | where type =~ 'microsoft.network/applicationgatewaywebapplicationfirewallpolicies' | extend compliant = (properties['policySettings']['requestBodyCheck'] == 'true' and properties['policySettings']['state'] =~ 'Enabled') | distinct id, name, compliant",
            "guid": "8ea8e0d4-84e8-4b33-aeab-493f6391b4d6",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/application-gateway-waf-request-size-limits#request-body-inspection",
            "service": "AppGW",
            "severity": "High",
            "text": "Ensure if request body inspection feature is enabled in Azure Application Gateway WAF policy.",
            "waf": "Reliability"
        },
        {
            "ammp": true,
            "arm-service": "microsoft.network/applicationGateways",
            "checklist": "Azure Application Delivery Networking",
            "guid": "a4dd86d3-5ffa-408c-b660-cce073d085b8",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/best-practices#tune-your-waf",
            "service": "AppGW",
            "severity": "High",
            "text": "Tune the Azure Application Gateway WAF in detection mode for your workload. Reduce false positive detections.",
            "waf": "Reliability"
        },
        {
            "ammp": true,
            "arm-service": "microsoft.network/applicationGateways",
            "checklist": "Azure Application Delivery Networking",
            "guid": "baf8e317-2397-4d49-b3d1-0dcc16d8778d",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/policy-overview?source=recommendations",
            "service": "AppGW",
            "severity": "High",
            "text": "Deploy your WAF policy for Application Gateway in 'Prevention' mode.",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/applicationGateways",
            "checklist": "Azure Application Delivery Networking",
            "guid": "43fae595-8a32-4299-a69e-0f32c454dcc9",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/rate-limiting-overview",
            "service": "AppGW",
            "severity": "Medium",
            "text": "Add rate limiting to the Azure Application Gateway WAF. Rate limiting blocks clients accidentally or intentionally sending large amounts of traffic in a short period of time.",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/applicationGateways",
            "checklist": "Azure Application Delivery Networking",
            "guid": "041e0ad8-7b12-4694-a0b7-a0e25ee2470f",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/rate-limiting-overview#rate-limiting-details",
            "service": "AppGW",
            "severity": "Medium",
            "text": "Use a high threshold for Azure Application Gateway WAF rate limits. High rate limit thresholds avoid blocking legitimate traffic, while still providing protection against extremely high numbers of requests that might overwhelm your infrastructure. ",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/applicationGateways",
            "checklist": "Azure Application Delivery Networking",
            "guid": "99937189-ff78-492a-b9ca-18d828d82b37",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/best-practices#geo-filtering-best-practices",
            "service": "AppGW",
            "severity": "Low",
            "text": "If you are not expecting traffic from all geographical regions, use geo-filters to block traffic from non-expected countries.",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/applicationGateways",
            "checklist": "Azure Application Delivery Networking",
            "guid": "349a15c1-52f4-4319-9078-3895d95ecafd",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/geomatch-custom-rules",
            "service": "AppGW",
            "severity": "Medium",
            "text": "Specify the unknown (ZZ) location when geo-filtering traffic with the Azure Application Gateway WAF. Avoid accidentally blocking legitimate requests when IP addresses can't be geo-matched.",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/applicationGateways",
            "checklist": "Azure Application Delivery Networking",
            "guid": "6c19dfd5-a61c-436c-9001-491b9b3d0228",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/best-practices#use-the-latest-ruleset-versions",
            "service": "AppGW",
            "severity": "Medium",
            "text": "Use the latest Azure Application Gateway WAF rule set version. Rule set updates are regularly updated to take account of the current threat landscape.",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/applicationGateways",
            "checklist": "Azure Application Delivery Networking",
            "guid": "f84106a2-2e9e-42ac-add6-d3416ecfed53",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/best-practices#add-diagnostic-settings-to-save-your-wafs-logs",
            "service": "AppGW",
            "severity": "Medium",
            "text": "Add diagnostic settings to save your Azure Application Gateway WAF logs.",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.network/applicationGateways",
            "checklist": "Azure Application Delivery Networking",
            "guid": "92664c60-47e3-4591-8b1b-8d557656e686",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/best-practices#send-logs-to-microsoft-sentinel",
            "service": "AppGW",
            "severity": "Medium",
            "text": "Send Azure Application Gateway WAF logs to Microsoft Sentinel.",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.network/applicationGateways",
            "checklist": "Azure Application Delivery Networking",
            "guid": "ba0e9b26-6e0d-4ec8-8541-023c00afd5b7",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/best-practices#define-your-waf-configuration-as-code",
            "service": "AppGW",
            "severity": "Medium",
            "text": "Define your Azure Application Gateway WAF configuration as code. By using code, you can more easily adopt new rule set version and gain additional protection.",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.network/applicationGateways",
            "checklist": "Azure Application Delivery Networking",
            "guid": "f17ec301-8470-4afd-aabc-c1fdfe47dcc0",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/policy-overview",
            "service": "AppGW",
            "severity": "Medium",
            "text": "Use WAF Policies instead of the legacy WAF configuration.",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.network/applicationGateways",
            "checklist": "Azure Application Delivery Networking",
            "guid": "d4eb8667-f8cb-4cdd-94e6-2f967ba98f88",
            "link": "https://learn.microsoft.com/azure/virtual-wan/scenario-secured-hub-app-gateway",
            "service": "AppGW",
            "severity": "Medium",
            "text": "Filter inbound traffic in the backends so that they only accept connections from the Application Gateway subnet, for example with NSGs.",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/applicationGateways",
            "checklist": "Azure Application Delivery Networking",
            "guid": "a66f0fd8-2ca4-422e-8df3-235148127ca2",
            "link": "https://learn.microsoft.com/azure/application-gateway/ssl-overview",
            "service": "AppGW",
            "severity": "High",
            "text": "You should encrypt traffic to the backend servers.",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/applicationGateways",
            "checklist": "Azure Application Delivery Networking",
            "guid": "3dba65cb-834d-44d8-a3ca-a6aa2f1587be",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/overview",
            "service": "AppGW",
            "severity": "High",
            "text": "You should use a Web Application Firewall.",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/applicationGateways",
            "checklist": "Azure Application Delivery Networking",
            "guid": "0158fcb6-0bc1-4687-832f-cc7c359c22d2",
            "link": "https://learn.microsoft.com/azure/application-gateway/redirect-overview",
            "service": "AppGW",
            "severity": "Medium",
            "text": "Redirect HTTP to HTTPS",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/applicationGateways",
            "checklist": "Azure Application Delivery Networking",
            "guid": "bb697864-1b4c-43af-8667-90cc69aaed5f",
            "link": "https://learn.microsoft.com/azure/application-gateway/how-application-gateway-works#modifications-to-the-request",
            "service": "AppGW",
            "severity": "Medium",
            "text": "Use gateway-managed cookies to direct traffic from a user session to the same server for processing",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.network/applicationGateways",
            "checklist": "Azure Application Delivery Networking",
            "guid": "ff353ad8-15fb-4ae8-9fc5-a85a36d36a35",
            "link": "https://learn.microsoft.com/azure/application-gateway/configuration-http-settings",
            "service": "AppGW",
            "severity": "High",
            "text": "Enable connection draining during planned service updates to prevent connection loss to existing members of the backend pool",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/applicationGateways",
            "checklist": "Azure Application Delivery Networking",
            "guid": "c8741f03-45a4-4183-a6b8-139e0773b8b5",
            "link": "https://learn.microsoft.com/azure/application-gateway/custom-error",
            "service": "AppGW",
            "severity": "Low",
            "text": "Create custom error pages to display a personalized user experience",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.network/applicationGateways",
            "checklist": "Azure Application Delivery Networking",
            "guid": "f850d46f-f5d7-4b17-b48c-a780741402e1",
            "link": "https://learn.microsoft.com/azure/application-gateway/rewrite-http-headers-url",
            "service": "AppGW",
            "severity": "Medium",
            "text": "Edit HTTP requests and response headers for easier routing and information exchange between the client and server",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/applicationGateways",
            "checklist": "Azure Application Delivery Networking",
            "guid": "eadc3164-4a0f-461c-85f1-1a372c04dfd1",
            "link": "https://learn.microsoft.com/azure/frontdoor/front-door-overview",
            "service": "AppGW",
            "severity": "Medium",
            "text": "Configure Front Door to optimize global web traffic routing and top-tier end-user performance, and reliability through quick global failover",
            "waf": "Performance"
        },
        {
            "arm-service": "microsoft.network/applicationGateways",
            "checklist": "Azure Application Delivery Networking",
            "guid": "29dcc19f-a8fa-4c35-8281-290577538793",
            "link": "https://learn.microsoft.com/azure/load-balancer/load-balancer-overview",
            "service": "AppGW",
            "severity": "Medium",
            "text": "Use transport layer load balancing",
            "waf": "Performance"
        },
        {
            "arm-service": "microsoft.network/applicationGateways",
            "checklist": "Azure Application Delivery Networking",
            "guid": "276898c1-af5e-4819-9e8e-049c7801ab9d",
            "link": "https://learn.microsoft.com/azure/application-gateway/multiple-site-overview",
            "service": "AppGW",
            "severity": "Medium",
            "text": "Configure routing based on host or domain name for multiple web applications on a single gateway",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/applicationGateways",
            "checklist": "Azure Application Delivery Networking",
            "guid": "5fe365b6-58e8-47ed-a8cf-5163850380a2",
            "link": "https://learn.microsoft.com/azure/application-gateway/create-ssl-portal",
            "service": "AppGW",
            "severity": "Medium",
            "text": "Centralize SSL certificate management to reduce encryption and decryption overhead from a backend server farm",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/applicationGateways",
            "checklist": "Azure Application Delivery Networking",
            "guid": "fa64b4dd-35c2-4047-ac5c-45dfbf8b0db9",
            "link": "https://learn.microsoft.com/azure/application-gateway/application-gateway-websocket",
            "service": "AppGW",
            "severity": "Low",
            "text": "Use Application Gateway for native support for WebSocket and HTTP/2 protocols",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.DBforPostgreSQL/servers",
            "checklist": "PostgreSQL Review Checklist",
            "guid": "65285269-441c-44bf-9d3e-0844276d4bdc",
            "link": "https://learn.microsoft.com/azure/postgresql/flexible-server/overview",
            "service": "PostgreSQL",
            "severity": "Medium",
            "text": "Leverage Flexible Server",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.DBforPostgreSQL/servers",
            "checklist": "PostgreSQL Review Checklist",
            "guid": "016ccf31-ae5a-41eb-9888-9535e227896d",
            "link": "https://learn.microsoft.com/azure/postgresql/flexible-server/overview#architecture-and-high-availability",
            "service": "PostgreSQL",
            "severity": "High",
            "text": "Leverage Availability Zones where regionally applicable",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.DBforPostgreSQL/servers",
            "checklist": "PostgreSQL Review Checklist",
            "guid": "31b67c67-be59-4519-8083-845d587cb391",
            "link": "https://learn.microsoft.com/azure/postgresql/single-server/concepts-business-continuity#cross-region-read-replicas",
            "service": "PostgreSQL",
            "severity": "Medium",
            "text": "Leverage cross-region read replicas for BCDR",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Cognitive Services Review Checklist",
            "guid": "21c30d25-ffb7-4f6a-b9ea-b3fec328f787",
            "link": "https://github.com/Azure/fta-resiliencyplaybooks/blob/main/paas-foundations-playbooks-cog_svcs_v1.docx",
            "service": "Cognitive Services",
            "severity": "Medium",
            "text": "Leverage FTA HandBook for Cognitive Services",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Cognitive Services Review Checklist",
            "guid": "78c34698-16b2-4763-aefe-1b9b599de0d5",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/concepts/advanced-prompt-engineering?pivots=programming-language-chat-completions",
            "service": "Cognitive Services",
            "severity": "Medium",
            "text": "Backup Your Prompts",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Cognitive Services Review Checklist",
            "guid": "750ab2ab-039d-4a6d-95d7-c892adb107d5",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/business-continuity-disaster-recovery",
            "service": "Cognitive Services",
            "severity": "High",
            "text": "Business Continuity and Disaster Recovery (BCDR) considerations with Azure OpenAI Service",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Cognitive Services Review Checklist",
            "guid": "325af625-ca44-4e46-a5e2-223ace8bb123",
            "link": "https://github.com/abacaj/chatgpt-backup#backup-your-chatgpt-conversations",
            "service": "Cognitive Services",
            "severity": "Medium",
            "text": "Backup Your ChatGPT conversations",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Cognitive Services Review Checklist",
            "guid": "07ca5f17-f154-4e3a-a369-2829e7e31618",
            "link": "https://learn.microsoft.com/azure/ai-services/speech-service/how-to-custom-speech-continuous-integration-continuous-deployment",
            "service": "Cognitive Services",
            "severity": "Medium",
            "text": "CI/CD for custom speech",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Cognitive Services Review Checklist",
            "guid": "3687a046-7a1f-4893-9bda-43324f248116",
            "link": "https://learn.microsoft.com/azure/ai-services/qnamaker/tutorials/export-knowledge-base",
            "service": "Cognitive Services",
            "severity": "Low",
            "text": "Move a knowledge base using export-import",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Web/sites",
            "checklist": "Logic Apps checklist",
            "guid": "3b7a56de-5020-4642-b3cb-c976e80b6d6d",
            "link": "https://learn.microsoft.com/azure/logic-apps/single-tenant-overview-compare",
            "service": "Logic Apps",
            "severity": "High",
            "text": "Select the right Logic App hosting plan based on your business & SLO requirements",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Web/sites",
            "checklist": "Logic Apps checklist",
            "guid": "3d7008bd-6bc1-4b03-8aa8-ec2a3b55786a",
            "link": "https://learn.microsoft.com/azure/logic-apps/set-up-zone-redundancy-availability-zones?tabs=standard#next-steps",
            "service": "Logic Apps",
            "severity": "High",
            "text": "Protect logic apps from region failures with zone redundancy and availability zones",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Web/sites",
            "checklist": "Logic Apps checklist",
            "guid": "1cda768f-a206-445d-8234-56f6a6e7286e",
            "link": "https://learn.microsoft.com/azure/logic-apps/business-continuity-disaster-recovery-guidance?toc=%2Fazure%2Freliability%2Ftoc.json&bc=%2Fazure%2Freliability%2Fbreadcrumb%2Ftoc.json",
            "service": "Logic Apps",
            "severity": "High",
            "text": "Consider a Cross-Region DR strategy for critical workloads",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Web/sites",
            "checklist": "Logic Apps checklist",
            "guid": "82118ec5-ed6f-4c68-9471-eb0da98a1b34",
            "link": "https://learn.microsoft.com/azure/app-service/environment/intro",
            "service": "Logic Apps",
            "severity": "High",
            "text": "If deploying to an Isolated environment, use or migrate to App Service Environment (ASE) v3",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Web/sites",
            "checklist": "Logic Apps checklist",
            "guid": "74275fa5-9e08-4c7e-b096-13b538fe1501",
            "link": "https://learn.microsoft.com/training/modules/deploy-azure-functions/",
            "service": "Logic Apps",
            "severity": "Medium",
            "text": "Leverage Azure DevOps or GitHub to streamline CI/CD and safeguard your Logic App code",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.Web/sites",
            "checklist": "Azure Function Review",
            "guid": "4238f409-2ea0-43be-a06b-2a993c98aa7b",
            "link": "https://learn.microsoft.com/en-us/azure/azure-functions/functions-scale#overview-of-plans",
            "service": "Functions",
            "severity": "High",
            "text": "Select the right Function hosting plan based on your business & SLO requirements",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Web/sites",
            "checklist": "Azure Function Review",
            "guid": "a9808100-d640-4f77-ac56-1ec0600f6752",
            "link": "https://learn.microsoft.com/en-us/azure/azure-functions/functions-scale#overview-of-plans",
            "query": "resources | where type =~ 'Microsoft.Web/sites' and kind has 'functionapp' and tolower(kind) !contains 'workflow' | extend aspResourceId = tostring(properties.serverFarmId), managedEnvId = tostring(properties.managedEnvironmentId), sku = tostring(properties.sku) | extend sku = iif(isnotempty(sku), sku, iif(isnotempty(managedEnvId), 'ContainerApps', '')) | where sku !in ('Dynamic', 'FlexConsumption', '') | extend aspName = tostring(split(aspResourceId, '/').[-1]), managedEnvName = tostring(split(managedEnvId, '/').[-1]) | extend HostingPlan = tostring(iif(isnotempty(aspName), aspName, managedEnvName)) | project functionAppName = name, functionAppId = id, HostingPlan, sku | join kind=inner ( resources | where type =~ 'Microsoft.Web/serverfarms' or type =~ 'Microsoft.App/managedEnvironments' | extend HostingPlan = tostring(name), zoneRedundant = tostring(properties.zoneRedundant), compliant = tobool(properties.zoneRedundant) | project HostingPlan, resourceId = id, zoneRedundant, compliant ) on HostingPlan | project functionAppName, functionAppId, sku, HostingPlan, resourceId, zoneRedundant, compliant",
            "service": "Functions",
            "severity": "High",
            "text": "Leverage Availability Zones where regionally applicable (not available for Consumption tier)",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Web/sites",
            "checklist": "Azure Function Review",
            "guid": "5969d03e-eacf-4042-b127-73c55e3575fa",
            "link": "https://learn.microsoft.com/en-us/azure/reliability/reliability-functions?tabs=azure-portal#cross-region-disaster-recovery-and-business-continuity",
            "service": "Functions",
            "severity": "Medium",
            "text": "Consider a Cross-Region DR strategy for critical workloads",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Web/sites",
            "checklist": "Azure Function Review",
            "guid": "47a0aae0-d8a0-43b1-9791-e934dee3754c",
            "link": "https://learn.microsoft.com/en-us/azure/app-service/environment/intro",
            "service": "Functions",
            "severity": "High",
            "text": "If deploying to an Isolated environment, use or migrate to App Service Environment (ASE) v3",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Web/sites",
            "checklist": "Azure Function Review",
            "guid": "17232891-f89f-4eaa-90f1-3b34bf798ed5",
            "link": "https://learn.microsoft.com/en-us/azure/azure-functions/dedicated-plan#always-on",
            "query": "resources | where type =~ 'Microsoft.Web/sites' and kind has 'functionapp' | where tolower(kind) !contains 'workflow' | where isnotempty(properties.serverFarmId) | extend sku = tostring(properties.sku) | where isnotempty(sku) | where sku !in ('Dynamic', 'FlexConsumption', 'ElasticPremium') | extend alwaysOn = properties.siteConfig.alwaysOn | project functionAppName = name, functionAppId = id, serverFarmId = tostring(properties.serverFarmId), sku, alwaysOn, compliant = tobool(alwaysOn)",
            "service": "Functions",
            "severity": "High",
            "text": "Ensure 'Always On' is enabled for all Function Apps running on App Service Plan",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Web/sites",
            "checklist": "Azure Function Review",
            "guid": "40a325c2-7c0e-49e6-86d8-c273b4dc21ba",
            "link": "https://learn.microsoft.com/en-us/azure/azure-functions/storage-considerations?tabs=azure-cli#shared-storage-accounts",
            "service": "Functions",
            "severity": "Medium",
            "text": "Pair a Function App to its own storage account. Try not to re-use storage accounts for Function Apps unless they are tightly coupled",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Web/sites",
            "checklist": "Azure Function Review",
            "guid": "bb42650c-257d-4cb0-822a-131138b8e6f0",
            "link": "https://learn.microsoft.com/en-us/training/modules/deploy-azure-functions/",
            "service": "Functions",
            "severity": "Medium",
            "text": "Leverage Azure DevOps or GitHub to streamline CI/CD and safeguard your Function App code",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.documentdb/databaseAccounts",
            "checklist": "CosmosDB Review Checklist",
            "guid": "43e52f47-22d9-428c-8b1c-d521e54a29a9",
            "link": "https://github.com/Azure/fta-resiliencyplaybooks/blob/main/pass-foundations-playbooks-CosmosDB_v1.docx",
            "service": "CosmosDB",
            "severity": "Medium",
            "text": "FTA Resiliency Playbook",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.documentdb/databaseAccounts",
            "checklist": "CosmosDB Review Checklist",
            "guid": "de39ac0e-7c28-4dc9-9565-7202bff4564b",
            "link": "https://learn.microsoft.com/azure/cosmos-db/high-availability#slas",
            "service": "CosmosDB",
            "severity": "High",
            "text": "Leverage Availablity Zones where regionally applicable and ofcourse if the service offers it",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.documentdb/databaseAccounts",
            "checklist": "CosmosDB Review Checklist",
            "guid": "0d934a34-8b26-43e7-bd60-513a3649906e",
            "link": "https://learn.microsoft.com/azure/cosmos-db/high-availability#replica-outages",
            "service": "CosmosDB",
            "severity": "Medium",
            "text": "Run multiple replicas of the database (>1 ) in Prod",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.documentdb/databaseAccounts",
            "checklist": "CosmosDB Review Checklist",
            "description": "Multi-region writes capability allows you to take advantage of the provisioned throughput for your databases and containers across the globe",
            "guid": "bad38ead-53cc-47de-8d8a-aab3571449ab",
            "link": "https://learn.microsoft.com/azure/cosmos-db/high-availability#multiple-write-regions",
            "service": "CosmosDB",
            "severity": "Medium",
            "text": "Leverage Multi-Region Writes",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.documentdb/databaseAccounts",
            "checklist": "CosmosDB Review Checklist",
            "description": "Span Cosmos account across two or more regions with multi-region writes",
            "guid": "8153d89f-89dc-47b3-9be2-b1a27f7b9e91",
            "link": "https://learn.microsoft.com/azure/cosmos-db/high-availability#slas",
            "service": "CosmosDB",
            "severity": "Medium",
            "text": "Distribute your data globally",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.documentdb/databaseAccounts",
            "checklist": "CosmosDB Review Checklist",
            "description": "Choose from various consistency levels such as Eventual, Consistent Prefix, Session, Bounded Staleness and strong",
            "guid": "9f8ea848-25ec-4140-bc32-2758e6ee9ac0",
            "link": "https://learn.microsoft.com/azure/cosmos-db/consistency-levels",
            "service": "CosmosDB",
            "severity": "High",
            "text": "Choose from several well-defined consistency models",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.documentdb/databaseAccounts",
            "checklist": "CosmosDB Review Checklist",
            "description": "Maintain business continuity during regional outages. Azure Cosmos DB supports service-managed failover during a regional outage. During a regional outage, Azure Cosmos DB continues to maintain its latency, availability, consistency, and throughput SLAs. To help make sure that your entire application is highly available, Azure Cosmos DB offers a manual failover API to simulate a regional outage. By using this API, you can carry out regular business continuity drills.",
            "guid": "a47e4d1e-bb79-43f9-bf87-69e1032b72fe",
            "link": "https://learn.microsoft.com/azure/cosmos-db/how-to-manage-database-account#automatic-failover",
            "service": "CosmosDB",
            "severity": "Medium",
            "text": "Enable Service managed failover",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.documentdb/databaseAccounts",
            "checklist": "CosmosDB Review Checklist",
            "description": "Azure Cosmos DB automatically takes backups of your data at regular intervals. The automatic backups are taken without affecting the performance or availability of the database operations. All the backups are stored separately in a storage service.",
            "guid": "3499c9c1-133d-42f7-a4b1-a5bd06ff1a90",
            "link": "https://learn.microsoft.com/azure/cosmos-db/online-backup-and-restore",
            "service": "CosmosDB",
            "severity": "Medium",
            "text": "Enable Automatic Backups",
            "training": "https://learn.microsoft.com/learn/modules/explore-basic-services-identity-types/",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.documentdb/databaseAccounts",
            "checklist": "CosmosDB Review Checklist",
            "description": "This mode is the default backup mode for all existing accounts. In this mode, backup is taken at a periodic interval and the data is restored by creating a request with the support team. In this mode, you configure a backup interval and retention for your account. The maximum retention period extends to a month. The minimum backup interval can be one hour.",
            "guid": "a6eb33f6-005c-4d92-9286-7655672d6121",
            "link": "https://learn.microsoft.com/azure/cosmos-db/periodic-backup-restore-introduction",
            "service": "CosmosDB",
            "severity": "Medium",
            "text": "Perform Periodic Backups",
            "training": "https://learn.microsoft.com/learn/paths/manage-identity-and-access/",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.documentdb/databaseAccounts",
            "checklist": "CosmosDB Review Checklist",
            "description": "Continous 7 day retention and 30 day retention backups. Azure Cosmos DB performs data backup in the background without consuming any extra provisioned throughput (RUs) or affecting the performance and availability of your database. Continuous backups are taken in every region where the account exists.",
            "guid": "d43918a8-cd28-49be-b6b1-7cb8245461e1",
            "link": "https://learn.microsoft.com/azure/cosmos-db/continuous-backup-restore-introduction",
            "service": "CosmosDB",
            "severity": "Medium",
            "text": "Continous Backup with point-in-time restore in Azure Cosmos DB",
            "training": "https://learn.microsoft.com/learn/modules/create-custom-azure-roles-with-rbac/",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.eventhub/namespaces",
            "checklist": "Azure Event Hub Review",
            "description": "Azure Event Hub provides encryption of data at rest. If you use your own key, the data is still encrypted using the Microsoft-managed key, but in addition the Microsoft-managed key will be encrypted using the customer-managed key. ",
            "guid": "7aaf12e7-b94e-4f6e-847d-2d92981b1cd6",
            "link": "https://learn.microsoft.com/azure/event-hubs/configure-customer-managed-key",
            "service": "Event Hubs",
            "severity": "Low",
            "text": "Use customer-managed key option in data at rest encryption when required",
            "training": "https://learn.microsoft.com/learn/modules/plan-implement-administer-conditional-access/",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.eventhub/namespaces",
            "checklist": "Azure Event Hub Review",
            "description": "Azure Event Hubs namespaces permit clients to send and receive data with TLS 1.0 and above. To enforce stricter security measures, you can configure your Event Hubs namespace to require that clients send and receive data with a newer version of TLS. If an Event Hubs namespace requires a minimum version of TLS, then any requests made with an older version will fail. ",
            "guid": "d2f54b29-769e-43a6-a0e7-828ac936657e",
            "link": "https://learn.microsoft.com/azure/event-hubs/transport-layer-security-configure-minimum-version",
            "service": "Event Hubs",
            "severity": "Medium",
            "text": "Enforce a minimum required version of Transport Layer Security (TLS) for requests ",
            "training": "https://learn.microsoft.com/learn/modules/secure-aad-users-with-mfa/",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.eventhub/namespaces",
            "checklist": "Azure Event Hub Review",
            "description": "When you create an Event Hubs namespace, a policy rule named RootManageSharedAccessKey is automatically created for the namespace. This policy has manage permissions for the entire namespace. It�s recommended that you treat this rule like an administrative root account and don�t use it in your application. Using AAD as an authentication provider with RBAC is recommended. ",
            "guid": "13b0f566-4b1e-4944-a459-837ee79d6c6d",
            "link": "https://learn.microsoft.com/azure/event-hubs/authorize-access-shared-access-signature#shared-access-authorization-policies",
            "service": "Event Hubs",
            "severity": "Medium",
            "text": "Avoid using root account when it is not necessary",
            "training": "https://learn.microsoft.com/learn/paths/azure-administrator-manage-identities-governance/",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.eventhub/namespaces",
            "checklist": "Azure Event Hub Review",
            "description": "Managed identities for Azure resources can authorize access to Event Hubs resources using Azure AD credentials from applications running in Azure Virtual Machines (VMs), Function apps, Virtual Machine Scale Sets, and other services. By using managed identities for Azure resources together with Azure AD authentication, you can avoid storing credentials with your applications that run in the cloud. ",
            "guid": "3a365a5c-7acb-4e48-abd5-4cd79f2e8776",
            "link": "https://learn.microsoft.com/azure/event-hubs/authenticate-managed-identity?tabs=latest",
            "service": "Event Hubs",
            "severity": "Medium",
            "text": "When possible, your application should be using a managed identity to authenticate to Azure Event Hub. If not, consider having the storage credential (SAS, service principal credential) in Azure Key Vault or an equivalent service",
            "training": "https://learn.microsoft.com/learn/modules/azure-ad-privileged-identity-management/",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.eventhub/namespaces",
            "checklist": "Azure Event Hub Review",
            "description": "When creating permissions, provide fine-grained control over a client's access to Azure Event Hub. Permissions in Azure Event Hub can and should be scoped to the individual resource level e.g. consumer group, event hub entity, event hub namespaces, etc.",
            "guid": "8357c559-675c-45ee-a5b8-6ad8844ce3b2",
            "link": "https://learn.microsoft.com/azure/event-hubs/authorize-access-azure-active-directory#azure-built-in-roles-for-azure-event-hubs",
            "service": "Event Hubs",
            "severity": "High",
            "text": "Use least privilege data plane RBAC",
            "training": "https://learn.microsoft.com/learn/modules/explore-basic-services-identity-types/",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.eventhub/namespaces",
            "checklist": "Azure Event Hub Review",
            "description": "Azure Event Hub resource logs include operational logs, virtual network and Kafka logs. Runtime audit logs capture aggregated diagnostic information for all data plane access operations (such as send or receive events) in Event Hubs.",
            "guid": "b38b875b-a1cf-4104-a900-3a4d3ce474db",
            "link": "https://learn.microsoft.com/azure/event-hubs/monitor-event-hubs-reference",
            "service": "Event Hubs",
            "severity": "Medium",
            "text": "Enable logging for security investigation. Use Azure Monitor to captured metrics and logs such as resource logs, runtime audit logs and Kafka logs",
            "training": "https://learn.microsoft.com/learn/paths/manage-identity-and-access/",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.eventhub/namespaces",
            "checklist": "Azure Event Hub Review",
            "description": "Azure Event Hub by default has a public IP address and is Internet-reachable. Private endpoints allow traffic between your virtual network and Azure Event Hub traverses over the Microsoft backbone network. In addition to that, you should disable public endpoints if those are not used. ",
            "guid": "5abca2a4-eda1-4dae-8cc9-5d48c6b791dc",
            "link": "https://learn.microsoft.com/azure/event-hubs/private-link-service",
            "service": "Event Hubs",
            "severity": "Medium",
            "text": "Consider using private endpoints to access Azure Event Hub and disable public network access when applicable.",
            "training": "https://learn.microsoft.com/learn/modules/azure-ad-privileged-identity-management/",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.eventhub/namespaces",
            "checklist": "Azure Event Hub Review",
            "description": "With IP firewall, you can restrict public endpoint further to only a set of IPv4 addresses or IPv4 address ranges in CIDR (Classless Inter-Domain Routing) notation. ",
            "guid": "a0e6c465-89e5-458b-a37d-3974d1112dbd",
            "link": "https://learn.microsoft.com/azure/event-hubs/event-hubs-ip-filtering",
            "service": "Event Hubs",
            "severity": "Medium",
            "text": "Consider only allowing access to Azure Event Hub namespace from specific IP addresses or ranges",
            "training": "https://learn.microsoft.com/learn/paths/implement-resource-mgmt-security/",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.eventhub/namespaces",
            "checklist": "Azure Event Hub Review",
            "guid": "31d41e36-11c8-417b-8afb-c410d4391898",
            "link": "https://github.com/Azure/fta-resiliencyplaybooks/blob/main/paas-foundations-playbooks-AEH_v1.docx",
            "service": "Event Hubs",
            "severity": "Medium",
            "text": "Leverage FTA Resillency HandBook",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.eventhub/namespaces",
            "checklist": "Azure Event Hub Review",
            "description": " This will be turned on automatically for a new EH namespace created from the portal with Premium, Dedicated, or Standard SKUs in a zone-enabled region. Both the EH metadata and the event data itself are replicated across zones",
            "guid": "f15bce21-9e4a-40eb-9787-9424d226786d",
            "link": "https://learn.microsoft.com/azure/event-hubs/event-hubs-premium-overview#high-availability-with-availability-zones",
            "service": "Event Hubs",
            "severity": "High",
            "text": "Leverage Availability Zones if regionally applicable",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.eventhub/namespaces",
            "checklist": "Azure Event Hub Review",
            "guid": "20b56c56-ad58-4519-8f82-735c586bb281",
            "link": "https://learn.microsoft.com/azure/event-hubs/compare-tiers",
            "service": "Event Hubs",
            "severity": "Medium",
            "text": "Use the Premium or Dedicated SKUs   for predicable performance",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.eventhub/namespaces",
            "checklist": "Azure Event Hub Review",
            "description": "The built-in geo-disaster recovery feature, when enabled, ensures that the entire configuration of anamespace (Event Hubs, Consumer Groups and settings) is continuously replicated from a primary namespace to a secondary namespace, and it allows a once-only failover move from the primary to the secondary at any time. Active/Passive feature is designed to make it easier to recover from and abandon a failed Azure region without having to change application configurations",
            "guid": "dc15a1c0-75ee-49f1-90ac-ccd579376bcd",
            "link": "https://learn.microsoft.com/azure/event-hubs/event-hubs-geo-dr?tabs=portal",
            "service": "Event Hubs",
            "severity": "High",
            "text": "Plan for Geo Disaster Recovery using Active Passive configuration",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.eventhub/namespaces",
            "checklist": "Azure Event Hub Review",
            "description": "Should be used for DR configurations where an outage or loss of event data in the downed region cannot be tolerated. For these cases, follow the replication guidance and do not use the built-in geo-disaster recovery capability (active/passive). With Active/Active, Maintain multiple Event Hubs in different regions and namespaces, and events will be replicated between the hubs",
            "guid": "6e31b67d-67ba-4591-89c0-9e805d597c7e",
            "link": "https://learn.microsoft.com/azure/event-hubs/event-hubs-federation-overview",
            "service": "Event Hubs",
            "severity": "Medium",
            "text": "For Business Critical Applications, use Active Active configuration",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.eventhub/namespaces",
            "checklist": "Azure Event Hub Review",
            "guid": "9ced16ad-d186-4f0a-a241-a999a68af77c",
            "link": "https://learn.microsoft.com/azure/architecture/serverless/event-hubs-functions/resilient-design",
            "service": "Event Hubs",
            "severity": "Medium",
            "text": "Design Resilient Event Hubs",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "ab5351f6-383a-45ed-9c5e-b143b16db40a",
            "link": "https://learn.microsoft.com/azure/aks/use-windows-hpc",
            "service": "AKS",
            "severity": "Low",
            "text": "If required for AKS Windows workloads HostProcess containers can be used",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "a280dcf5-90ce-465d-b8e1-3f9ccbd46926",
            "link": "https://learn.microsoft.com/azure/azure-functions/functions-kubernetes-keda",
            "service": "AKS",
            "severity": "Low",
            "text": "Use KEDA if running event-driven workloads",
            "waf": "Performance"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "26886d20-b66c-457b-a591-19bf8e8f5c58",
            "link": "https://dapr.io/",
            "service": "AKS",
            "severity": "Low",
            "text": "Use Dapr to ease microservice development",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (sku.tier=='Paid') | distinct id,compliant",
            "guid": "71d41e36-10cc-457b-9a4b-1410d4395898",
            "link": "https://learn.microsoft.com/azure/aks/uptime-sla",
            "service": "AKS",
            "severity": "High",
            "text": "Use the SLA-backed AKS offering",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "c1288b3c-6a57-4cfc-9444-51e1a3d3453a",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-scheduler",
            "service": "AKS",
            "severity": "Low",
            "text": "Use Disruption Budgets in your pod and deployment definitions",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerregistry/registries",
            "checklist": "Azure AKS Review",
            "guid": "3c763963-7a55-42d5-a15e-401955387e5c",
            "link": "https://learn.microsoft.com/azure/container-registry/container-registry-geo-replication",
            "service": "ACR",
            "severity": "High",
            "text": "If using a private registry, configure region replication to store images in multiple regions",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "f82cb8eb-8c0a-4a63-a25a-4956eaa8dc4a",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/aks/eslz-cost-governance-with-kubecost",
            "service": "AKS",
            "severity": "Low",
            "text": "Use an external application such as kubecost to allocate costs to different users",
            "waf": "Cost"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "4d3dfbab-9924-4831-a68d-fdf0d72f462c",
            "link": "https://learn.microsoft.com/azure/aks/scale-down-mode",
            "service": "AKS",
            "severity": "Low",
            "text": "Use scale down mode to delete/deallocate nodes",
            "waf": "Cost"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "87e651ea-bc4a-4a87-a6df-c06a4b570ebc",
            "link": "https://learn.microsoft.com/azure/aks/gpu-multi-instance",
            "service": "AKS",
            "severity": "Medium",
            "text": "When required use multi-instance partitioning GPU on AKS Clusters",
            "waf": "Cost"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "2b72a08b-0410-4cd6-9093-e068a5cf27e8",
            "link": "https://learn.microsoft.com/azure/aks/start-stop-nodepools",
            "service": "AKS",
            "severity": "Low",
            "text": "If running a Dev/Test cluster use NodePool Start/Stop",
            "waf": "Cost"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (isnotnull(properties.addonProfiles.azurepolicy) and properties.addonProfiles.azurepolicy.enabled==true) | distinct id,compliant",
            "guid": "9ca48e4a-85e2-4223-bce8-bb12307ca5f1",
            "link": "https://learn.microsoft.com/azure/governance/policy/concepts/policy-for-kubernetes",
            "service": "AKS",
            "severity": "Medium",
            "text": "Use Azure Policy for Kubernetes to ensure cluster compliance",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | project id,resourceGroup,name,pools=properties.agentPoolProfiles | project id,name,resourceGroup,poolcount=array_length(pools) | extend compliant = (poolcount > 1)",
            "guid": "6f158e3e-a3a9-42c2-be7e-2165c3a87af4",
            "link": "https://learn.microsoft.com/azure/aks/use-system-pools",
            "service": "AKS",
            "severity": "Medium",
            "text": "Separate applications from the control plane with user/system node pools",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "a7a1f893-9bda-4477-98f2-4c116775c2ea",
            "link": "https://learn.microsoft.com/azure/aks/use-system-pools",
            "service": "AKS",
            "severity": "Low",
            "text": "Add taint to your system nodepool to make it dedicated",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "55b46a94-8008-4ae7-b7e4-b475b6c8bdbf",
            "link": "https://learn.microsoft.com/azure/container-registry/",
            "service": "AKS",
            "severity": "Medium",
            "text": "Use a private registry for your images, such as ACR",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerregistry/registries",
            "checklist": "Azure AKS Review",
            "guid": "59bce65d-e8a0-43f9-9879-468d66a786d6",
            "link": "https://learn.microsoft.com/azure/security-center/container-security",
            "service": "ACR",
            "severity": "Medium",
            "text": "Scan your images for vulnerabilities",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "d167dd18-2b0a-4c24-8b99-9a646f8389a7",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-cluster-isolation",
            "service": "AKS",
            "severity": "High",
            "text": "Define app separation requirements (namespace/nodepool/cluster)",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "5e3df584-eccc-4d97-a3b6-bcda3b50eb2e",
            "link": "https://github.com/Azure/secrets-store-csi-driver-provider-azure",
            "service": "AKS",
            "severity": "Medium",
            "text": "Store your secrets in Azure Key Vault with the CSI Secrets Store driver",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "b03dda6d-58d7-4c89-8ddb-107d5769ae66",
            "link": "https://learn.microsoft.com/azure/aks/update-credentials",
            "service": "AKS",
            "severity": "High",
            "text": "If using Service Principals for the cluster, refresh credentials periodically (like quarterly)",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "e7ba73a3-0508-4f80-806f-527db30cee96",
            "link": "https://learn.microsoft.com/azure/aks/use-kms-etcd-encryption",
            "service": "AKS",
            "severity": "Medium",
            "text": "If required add Key Management Service etcd encryption",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "ec8e4e42-0344-41b0-b865-9123e8956d31",
            "link": "https://learn.microsoft.com/azure/confidential-computing/confidential-nodes-aks-overview",
            "service": "AKS",
            "severity": "Low",
            "text": "If required consider using Confidential Compute for AKS",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "c9e95ffe-6dd1-4a17-8c5f-110389ca9b21",
            "link": "https://learn.microsoft.com/azure/defender-for-cloud/defender-for-containers-enable",
            "service": "AKS",
            "severity": "Medium",
            "text": "Consider using Defender for Containers",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (properties.servicePrincipalProfile.clientId=='msi') | distinct id,compliant",
            "guid": "ed127dd1-42b0-46b2-8c69-99a646f3389a",
            "link": "https://learn.microsoft.com/azure/aks/use-managed-identity",
            "service": "AKS",
            "severity": "High",
            "text": "Use managed identities instead of Service Principals",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = isnotnull(properties.aadProfile) | distinct id,compliant",
            "guid": "7e42c78e-78c0-46a6-8a21-94956e698dc4",
            "link": "https://learn.microsoft.com/azure/aks/managed-aad",
            "service": "AKS",
            "severity": "Medium",
            "text": "Integrate authentication with AAD (using the managed integration)",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "a2fe27b2-e287-401a-8352-beedf79b488d",
            "link": "https://learn.microsoft.com/azure/aks/control-kubeconfig-access",
            "service": "AKS",
            "severity": "Medium",
            "text": "Limit access to admin kubeconfig (get-credentials --admin)",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "eec4962c-c3bd-421b-b77f-26e5e6b3bec3",
            "link": "https://learn.microsoft.com/azure/aks/manage-azure-rbac",
            "service": "AKS",
            "severity": "Medium",
            "text": "Integrate authorization with AAD RBAC",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "d4f3537c-1346-4dc5-9027-a71ffe1bd05d",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-identity",
            "service": "AKS",
            "severity": "High",
            "text": "Use namespaces for restricting RBAC privilege in Kubernetes",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "d2e0d5d7-71d4-41e3-910c-c57b4a4b1410",
            "link": "https://learn.microsoft.com/azure/aks/workload-identity-migration-sidecar",
            "service": "AKS",
            "severity": "Medium",
            "text": "For Pod Identity Access Management use Azure AD Workload Identity (preview)",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "f4dcf690-1b30-407d-abab-6f8aa780d3a3",
            "link": "https://learn.microsoft.com/azure/aks/managed-aad#non-interactive-sign-in-with-kubelogin",
            "service": "AKS",
            "severity": "Medium",
            "text": "For AKS non-interactive logins use kubelogin (preview)",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (properties.disableLocalAccounts==true) | distinct id,compliant",
            "guid": "b085b1f2-3119-4771-8c9a-bbf4411810ec",
            "link": "https://learn.microsoft.com/azure/aks/managed-aad#disable-local-accounts",
            "service": "AKS",
            "severity": "Medium",
            "text": "Disable AKS local accounts",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "36abb0db-c118-4f4c-9880-3f30f9a2deb6",
            "link": "https://learn.microsoft.com/azure/aks/managed-aad#configure-just-in-time-cluster-access-with-azure-ad-and-aks",
            "service": "AKS",
            "severity": "Low",
            "text": "Configure if required Just-in-time cluster access",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "c4d7f4c6-79bf-45d0-aa05-ce8fc717e150",
            "link": "https://learn.microsoft.com/azure/aks/managed-aad#use-conditional-access-with-azure-ad-and-aks",
            "service": "AKS",
            "severity": "Low",
            "text": "Configure if required AAD conditional access for AKS",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "e1123a7c-a333-4eb4-a120-4ee3f293c9f3",
            "link": "https://learn.microsoft.com/azure/aks/use-group-managed-service-accounts",
            "service": "AKS",
            "severity": "Low",
            "text": "If required for Windows AKS workloads configure gMSA ",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "1f711a74-3672-470b-b8b8-a2148d640d79",
            "link": "https://learn.microsoft.com/azure/aks/use-managed-identity#use-a-pre-created-kubelet-managed-identity",
            "service": "AKS",
            "severity": "Medium",
            "text": "For finer control consider using a managed Kubelet Identity",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "cbd8ac2a-aebc-4a2a-94da-1dbf3dc99248",
            "link": "https://azure.github.io/application-gateway-kubernetes-ingress/setup/install-existing/",
            "service": "AKS",
            "severity": "Medium",
            "text": "If using AGIC, do not share an AppGW across clusters",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (isnull(properties.addonProfiles.httpApplicationRouting) or properties.addonProfiles.httpApplicationRouting.enabled==false) | distinct id,compliant",
            "guid": "8008ae7d-7e4b-4475-a6c8-bdbf59bce65d",
            "link": "https://learn.microsoft.com/azure/aks/http-application-routing",
            "service": "AKS",
            "severity": "High",
            "text": "Do not use AKS HTTP Routing Add-On, use instead the managed NGINX ingress with the application routing add-on.",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "7bacd7b9-c025-4a9d-a5d2-25d6bc5439d9",
            "link": "https://learn.microsoft.com/azure/virtual-network/accelerated-networking-overview",
            "service": "AKS",
            "severity": "Medium",
            "text": "For Windows workloads use Accelerated Networking",
            "waf": "Performance"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (tolower(properties.networkProfile.loadBalancerSku)=='standard') | distinct id,compliant",
            "guid": "ba7da7be-9952-4914-a384-5d997cb39132",
            "link": "https://learn.microsoft.com/azure/aks/load-balancer-standard",
            "service": "AKS",
            "severity": "High",
            "text": "Use the standard ALB (as opposed to the basic one)",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "22fbe8d6-9b40-47ef-9011-25bb1a555a6b",
            "link": "https://learn.microsoft.com/azure/aks/use-multiple-node-pools#add-a-node-pool-with-a-unique-subnet",
            "service": "AKS",
            "severity": "Medium",
            "text": "If using Azure CNI, consider using different Subnets for NodePools",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "c3c39c98-6bb2-4c12-859a-114b5e3df584",
            "link": "https://learn.microsoft.com/azure/private-link/private-link-overview",
            "service": "AKS",
            "severity": "Medium",
            "text": "Use Private Endpoints (preferred) or Virtual Network Service Endpoints to access PaaS services from the cluster",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (properties.networkProfile.networkPlugin=='azure') | distinct id,compliant",
            "guid": "a0f61565-9de5-458f-a372-49c831112dbd",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-network",
            "service": "AKS",
            "severity": "High",
            "text": "Choose the best CNI network plugin for your requirements (Azure CNI recommended)",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "7faf12e7-0943-4f63-8472-2da29c2b1cd6",
            "link": "https://learn.microsoft.com/azure/aks/configure-azure-cni",
            "service": "AKS",
            "severity": "High",
            "text": "If using Azure CNI, size your subnet accordingly considering the maximum number of pods per node",
            "waf": "Performance"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "22f54b29-bade-43aa-b1e8-c38ec9366673",
            "link": "https://learn.microsoft.com/azure/aks/configure-azure-cni",
            "service": "AKS",
            "severity": "High",
            "text": "If using Azure CNI, check the maximum pods/node (default 30)",
            "waf": "Performance"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "description": "For internal apps organizations often open the whole AKS subnet in their firewalls. This opens network access to the nodes too, and potentially to the pods as well (if using Azure CNI). If LoadBalancer IPs are in a different subnet, only this one needs to be available to the app clients. Another reason is that if the IP addresses in the AKS subnet are a scarce resource, consuming its IP addresses for services will reduce the maximum scalability of the cluster .",
            "guid": "13c00567-4b1e-4945-a459-c373e7ed6162",
            "link": "https://learn.microsoft.com/azure/aks/internal-lb",
            "service": "AKS",
            "severity": "Low",
            "text": "If using private-IP LoadBalancer services, use a dedicated subnet (not the AKS subnet)",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "43f63047-22d9-429c-8b1c-d622f54b29ba",
            "link": "https://learn.microsoft.com/azure/aks/configure-azure-cni",
            "service": "AKS",
            "severity": "High",
            "text": "Size the service IP address range accordingly (it is going to limit the cluster scalability)",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "57bf217f-6dc8-481c-81e2-785773e9c00f",
            "link": "https://learn.microsoft.com/azure/aks/use-byo-cni",
            "service": "AKS",
            "severity": "Low",
            "text": "If required add your own CNI plugin",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "4b3bb365-9458-44d9-9ed1-5c8f52890364",
            "link": "https://learn.microsoft.com/azure/aks/use-multiple-node-pools#assign-a-public-ip-per-node-for-your-node-pools",
            "service": "AKS",
            "severity": "Low",
            "text": "If required configure Public IP per node in AKS",
            "waf": "Performance"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "b3808b9f-a1cf-4204-ad01-3a923ce474db",
            "link": "https://learn.microsoft.com/azure/aks/concepts-network",
            "service": "AKS",
            "severity": "Medium",
            "text": "Use an ingress controller to expose web-based apps instead of exposing them with LoadBalancer-type services",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "ccb534e7-416e-4a1d-8e93-533b53199085",
            "link": "https://learn.microsoft.com/azure/aks/nat-gateway",
            "service": "AKS",
            "severity": "Low",
            "text": "Use Azure NAT Gateway as outboundType for scaling egress traffic",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "8ee9a69a-1b58-4b1e-9c61-476e110a160b",
            "link": "https://learn.microsoft.com/azure/aks/configure-azure-cni#dynamic-allocation-of-ips-and-enhanced-subnet-support",
            "service": "AKS",
            "severity": "Medium",
            "text": "Use Dynamic allocations of IPs in order to avoid Azure CNI IP exhaustion",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (properties.networkProfile.outboundType=='userDefinedRouting') | distinct id,compliant",
            "guid": "3b365a91-7ecb-4e48-bbe5-4cd7df2e8bba",
            "link": "https://learn.microsoft.com/azure/aks/limit-egress-traffic",
            "service": "AKS",
            "severity": "High",
            "text": "Filter egress traffic with AzFW/NVA if your security requirements mandate it",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = ((isnull(properties.apiServerAccessProfile.enablePrivateCluster) or properties.apiServerAccessProfile.enablePrivateCluster==false) and isnotnull(properties.apiServerAccessProfile.authorizedIPRanges)) | distinct id,compliant",
            "guid": "c4581559-bb91-463e-a908-aed8c44ce3b2",
            "link": "https://learn.microsoft.com/azure/aks/api-server-authorized-ip-ranges",
            "service": "AKS",
            "severity": "Medium",
            "text": "If using a public API endpoint, restrict the IP addresses that can access it",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | where isnotnull(properties.apiServerAccessProfile.enablePrivateCluster) | extend compliant = (properties.apiServerAccessProfile.enablePrivateCluster==true) | distinct id, compliant",
            "guid": "ecccd979-3b6b-4cda-9b50-eb2eb03dda6d",
            "link": "https://learn.microsoft.com/azure/aks/private-clusters",
            "service": "AKS",
            "severity": "High",
            "text": "Use private clusters if your requirements mandate it",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | where isnotnull(properties.apiServerAccessProfile.enablePrivateCluster) | extend compliant = (properties.apiServerAccessProfile.enablePrivateCluster==true) | distinct id, compliant",
            "guid": "ce7f2a7c-297c-47c6-adea-a6ff838db665",
            "link": "https://learn.microsoft.com/azure/aks/use-network-policies",
            "service": "AKS",
            "severity": "Medium",
            "text": "For Windows 2019 and 2022 AKS nodes Calico Network Policies can be used ",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = isnotnull(properties.networkProfile.networkPolicy) | distinct id,compliant",
            "guid": "58d7c892-ddb1-407d-9769-ae669ca48e4a",
            "link": "https://learn.microsoft.com/azure/aks/use-network-policies",
            "service": "AKS",
            "severity": "High",
            "text": "Enable a Kubernetes Network Policy option (Calico/Azure)",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "85e2223e-ce8b-4b12-907c-a5f16f158e3e",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-network",
            "service": "AKS",
            "severity": "High",
            "text": "Use Kubernetes network policies to increase intra-cluster security",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "a3a92c2d-e7e2-4165-a3a8-7af4a7a1f893",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-network",
            "service": "AKS",
            "severity": "High",
            "text": "Use a WAF for web workloads (UIs or APIs)",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "Resources | where type=~'microsoft.containerservice/managedclusters' | project resourceGroup,name,pools=properties.agentPoolProfiles | mv-expand pools | project subnetId=tostring(pools.vnetSubnetID) | where isnotempty(subnetId) | join (Resources | where type=='microsoft.network/virtualnetworks' | project id,resourceGroup,name,enableDdosProtection=tostring(properties.enableDdosProtection),subnets=properties.subnets | mv-expand subnets | project id,resourceGroup,name,enableDdosProtection,subnetId=tostring(subnets.id)) on subnetId | distinct id,resourceGroup,name,enableDdosProtection | extend compliant = (enableDdosProtection == 'true')",
            "guid": "9bda4776-8f24-4c11-9775-c2ea55b46a94",
            "link": "https://learn.microsoft.com/azure/virtual-network/ddos-protection-overview",
            "service": "AKS",
            "severity": "Medium",
            "text": "Use DDoS Standard in the AKS Virtual Network",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "Resources | where type=~'microsoft.containerservice/managedclusters' | project resourceGroup,name,pools=properties.agentPoolProfiles | mv-expand pools | project subnetId=tostring(pools.vnetSubnetID) | where isnotempty(subnetId) | join (Resources | where type=='microsoft.network/virtualnetworks' | project id,resourceGroup,name,enableDdosProtection=tostring(properties.enableDdosProtection),subnets=properties.subnets | mv-expand subnets | project id,resourceGroup,name,enableDdosProtection,subnetId=tostring(subnets.id)) on subnetId | distinct id,resourceGroup,name,enableDdosProtection | extend compliant = (enableDdosProtection == 'true')",
            "guid": "6c46b91a-1107-4485-ad66-3183e2a8c266",
            "link": "https://learn.microsoft.com/azure/aks/http-proxy",
            "service": "AKS",
            "severity": "Low",
            "text": "If required add company HTTP Proxy",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "e9855d04-c3c3-49c9-a6bb-2c12159a114b",
            "link": "https://learn.microsoft.com/azure/aks/servicemesh-about",
            "service": "AKS",
            "severity": "Medium",
            "text": "Consider using a service mesh for advanced microservice communication management",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "67f7a9ed-5b31-4f38-a3f3-9812b2463cff",
            "link": "https://learn.microsoft.com/azure/azure-monitor/insights/container-insights-metric-alerts",
            "service": "AKS",
            "severity": "High",
            "text": "Configure alerts on the most critical metrics (see Container Insights for recommendations)",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "337453a3-cc63-4963-9a65-22ac19e80696",
            "link": "https://learn.microsoft.com/azure/advisor/advisor-get-started",
            "service": "AKS",
            "severity": "Low",
            "text": "Check regularly Azure Advisor for recommendations on your cluster",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "3aa70560-e7e7-4968-be3d-628af35b2ced",
            "link": "https://learn.microsoft.com/azure/aks/certificate-rotation",
            "service": "AKS",
            "severity": "Low",
            "text": "Enable AKS auto-certificate rotation",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "e189c599-df0d-45a7-9dd4-ce32c1881370",
            "link": "https://learn.microsoft.com/azure/aks/supported-kubernetes-versions",
            "service": "AKS",
            "severity": "High",
            "text": "Have a regular process to upgrade your kubernetes version periodically (quarterly, for example), or use the AKS autoupgrade feature",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "6f7c4c0d-4e51-4464-ad24-57ed67138b82",
            "link": "https://learn.microsoft.com/azure/aks/node-updates-kured",
            "service": "AKS",
            "severity": "High",
            "text": "Use kured for Linux node upgrades in case you are not using node-image upgrade",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "139c9580-ade3-426a-ba09-cf157d9f6477",
            "link": "https://learn.microsoft.com/azure/aks/node-image-upgrade",
            "service": "AKS",
            "severity": "High",
            "text": "Have a regular process to upgrade the cluster node images periodically (weekly, for example)",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "0102ce16-ee30-41e6-b882-e52e4621dd68",
            "link": "https://learn.microsoft.com/azure/architecture/example-scenario/bedrock/bedrock-automated-deployments",
            "service": "AKS",
            "severity": "Low",
            "text": "Consider gitops to deploy applications or cluster configuration to multiple clusters",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "d7672c26-7602-4482-85a4-14527fbe855c",
            "link": "https://learn.microsoft.com/azure/aks/command-invoke",
            "service": "AKS",
            "severity": "Low",
            "text": "Consider using AKS command invoke on private clusters",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "31d7aaab-7571-4449-ab80-53d89e89d17b",
            "link": "https://learn.microsoft.com/azure/aks/node-auto-repair#node-autodrain",
            "service": "AKS",
            "severity": "Low",
            "text": "For planned events consider using Node Auto Drain",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "ed0fda7f-211b-47c7-8b6e-c18873fb473c",
            "link": "https://learn.microsoft.com/azure/aks/faq",
            "service": "AKS",
            "severity": "High",
            "text": "Develop own governance practices to make sure no changes are performed by operators in the node RG (aka 'infra RG')",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (properties.nodeResourceGroup !startswith 'MC_') | distinct id,compliant",
            "guid": "73b32a5a-67f7-4a9e-b5b3-1f38c3f39812",
            "link": "https://learn.microsoft.com/azure/aks/cluster-configuration",
            "service": "AKS",
            "severity": "Low",
            "text": "Use custom Node RG (aka 'Infra RG') name",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "b2463cff-e189-4c59-adf0-d5a73dd4ce32",
            "link": "https://kubernetes.io/docs/setup/release/notes/",
            "service": "AKS",
            "severity": "Medium",
            "text": "Do not use deprecated Kubernetes APIs in your YAML manifests",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "c1881370-6f7c-44c0-b4e5-14648d2457ed",
            "link": "https://learn.microsoft.com/azure-stack/aks-hci/adapt-apps-mixed-os-clusters",
            "service": "AKS",
            "severity": "Low",
            "text": "Taint Windows nodes",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "67138b82-0102-4ce1-9ee3-01e6e882e52e",
            "link": "https://learn.microsoft.com/virtualization/windowscontainers/deploy-containers/version-compatibility?tabs=windows-server-20H2%2Cwindows-10-20H2",
            "service": "AKS",
            "severity": "Low",
            "text": "Keep windows containers patch level in sync with host patch level",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "description": "Via Diagnostic Settings at the cluster level",
            "guid": "5b56ad48-408f-4e72-934c-476ba280dcf5",
            "link": "https://learn.microsoft.com/azure/aks/monitor-aks",
            "service": "AKS",
            "severity": "Low",
            "text": "Send master logs (aka API logs) to Azure Monitor or your preferred log management solution",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "64d1a846-e28a-4b6b-9a33-22a635c15a21",
            "link": "https://learn.microsoft.com/azure/aks/node-pool-snapshot",
            "service": "AKS",
            "severity": "Low",
            "text": "If required use nodePool snapshots",
            "waf": "Cost"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "c5a5b252-1e44-4a59-a9d2-399c4d7b68d0",
            "link": "https://learn.microsoft.com/azure/aks/spot-node-pool",
            "service": "AKS",
            "severity": "Low",
            "text": "Consider spot node pools for non time-sensitive workloads",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (isnotnull(properties.addonProfiles.aciConnectorLinux) and properties.addonProfiles.aciConnectorLinux.enabled==true) | distinct id,compliant",
            "guid": "c755562f-2b4e-4456-9b4d-874a748b662e",
            "link": "https://learn.microsoft.com/azure/aks/concepts-scale",
            "service": "AKS",
            "severity": "Low",
            "text": "Consider AKS virtual node for quick bursting",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "6f8389a7-f82c-4b8e-a8c0-aa63a25a4956",
            "link": "https://learn.microsoft.com/azure/azure-monitor/insights/container-insights-overview",
            "service": "AKS",
            "severity": "High",
            "text": "Monitor your cluster metrics with Container Insights (or other tools like Prometheus)",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (isnotnull(properties.addonProfiles.omsagent) and properties.addonProfiles.omsagent.enabled==true) | distinct id,compliant",
            "guid": "eaa8dc4a-2436-47b3-9697-15b1752beee0",
            "link": "https://learn.microsoft.com/azure/azure-monitor/insights/container-insights-overview",
            "service": "AKS",
            "severity": "High",
            "text": "Store and analyze your cluster logs with Container Insights (or other tools like Telegraf/ElasticSearch)",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "4621dd68-c5a5-4be2-bdb1-1726769ef669",
            "link": "https://learn.microsoft.com/azure/azure-monitor/containers/container-insights-analyze",
            "service": "AKS",
            "severity": "Medium",
            "text": "Monitor CPU and memory utilization of the nodes",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "1a4835ac-9422-423e-ae80-b123081a5417",
            "link": "https://learn.microsoft.com/azure/aks/configure-azure-cni",
            "service": "AKS",
            "severity": "Medium",
            "text": "If using Azure CNI, monitor % of pod IPs consumed per node",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "description": "I/O in the OS disk is a critical resource. If the OS in the nodes gets throttled on I/O, this could lead to unpredictable behavior, typically ending up in node being declared NotReady",
            "guid": "415833ea-3ad3-4c2d-b733-165c3acbe04b",
            "link": "https://learn.microsoft.com/azure/virtual-machines/premium-storage-performance",
            "service": "AKS",
            "severity": "Medium",
            "text": "Monitor OS disk queue depth in nodes",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "be209d39-fda4-4777-a424-d116785c2fa5",
            "link": "https://learn.microsoft.com/azure/aks/load-balancer-standard",
            "service": "AKS",
            "severity": "Medium",
            "text": "If not using egress filtering with AzFW/NVA, monitor standard ALB allocated SNAT ports",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "74c2ee76-569b-4a79-a57e-dedf91b022c9",
            "link": "https://learn.microsoft.com/azure/aks/aks-resource-health",
            "service": "AKS",
            "severity": "Medium",
            "text": "Subscribe to resource health notifications for your AKS cluster",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "b54eb2eb-03dd-4aa3-9927-18e2edb11726",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-scheduler",
            "service": "AKS",
            "severity": "High",
            "text": "Configure requests and limits in your pod specs",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "769ef669-1a48-435a-a942-223ece80b123",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-scheduler",
            "service": "AKS",
            "severity": "Medium",
            "text": "Enforce resource quotas for namespaces",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "081a5417-4158-433e-a3ad-3c2de733165c",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits",
            "service": "AKS",
            "severity": "High",
            "text": "Ensure your subscription has enough quota to scale out your nodepools",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "f4fd0602-7ab5-46f1-b66a-e9dea9654a65",
            "link": "https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/",
            "service": "AKS",
            "severity": "High",
            "text": "Configure Liveness and Readiness probes for all deployments",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (isnotnull(properties.autoScalerProfile)) | distinct id,compliant",
            "guid": "90ce65de-8e13-4f9c-abd4-69266abca264",
            "link": "https://learn.microsoft.com/azure/aks/concepts-scale",
            "service": "AKS",
            "severity": "Medium",
            "text": "Use the Cluster Autoscaler",
            "waf": "Performance"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (isnotnull(properties.austoscalerProfile)) | distinct id,compliant",
            "guid": "831c2872-c693-4b39-a887-a561bada49bc",
            "link": "https://learn.microsoft.com/azure/aks/custom-node-configuration",
            "service": "AKS",
            "severity": "Low",
            "text": "Customize node configuration for AKS node pools",
            "waf": "Performance"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "faa19bfe-9d55-4d04-a3c4-919ca1b2d121",
            "link": "https://learn.microsoft.com/azure/aks/concepts-scale",
            "service": "AKS",
            "severity": "Medium",
            "text": "Use the Horizontal Pod Autoscaler when required",
            "waf": "Performance"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "description": "Larger nodes will bring higher performance and features such as ephemeral disks and accelerated networking, but they will increase the blast radius and decrease the scaling granularity",
            "guid": "5ae124ba-34df-4585-bcdc-e9bd3bb0cdb3",
            "link": "https://blog.cloudtrooper.net/2020/10/23/which-vm-size-should-i-choose-as-aks-node/",
            "service": "AKS",
            "severity": "High",
            "text": "Consider an appropriate node size, not too large or too small",
            "waf": "Performance"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "38800e6a-ae01-40a2-9fbc-ae5a06e5462d",
            "link": "https://learn.microsoft.com/azure/aks/quotas-skus-regions#service-quotas-and-limits",
            "service": "AKS",
            "severity": "Low",
            "text": "If more than 5000 nodes are required for scalability then consider using an additional AKS cluster",
            "waf": "Performance"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "9583c0f6-6083-43f6-aa6b-df7102c901bb",
            "link": "https://learn.microsoft.com/azure/event-grid/event-schema-aks",
            "service": "AKS",
            "severity": "Low",
            "text": "Consider subscribing to EventGrid Events for AKS automation",
            "waf": "Performance"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "c5016d8c-c6c9-4165-89ae-673ef0fff19d",
            "link": "https://learn.microsoft.com/azure/aks/manage-abort-operations",
            "service": "AKS",
            "severity": "Low",
            "text": "For long running operation on an AKS cluster consider event termination",
            "waf": "Performance"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "c4e37133-f186-4ce1-aed9-9f1b32f6e021",
            "link": "https://learn.microsoft.com/azure/aks/use-azure-dedicated-hosts",
            "service": "AKS",
            "severity": "Low",
            "text": "If required consider using Azure Dedicated Hosts for AKS nodes",
            "waf": "Performance"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | project id,resourceGroup,name,pools=properties.agentPoolProfiles | mvexpand pools | extend compliant = (pools.osDiskType=='Ephemeral') | project id,name=strcat(name,'-',pools.name), resourceGroup, compliant",
            "guid": "24367b33-6971-45b1-952b-eee0b9b588de",
            "link": "https://learn.microsoft.com/azure/aks/cluster-configuration",
            "service": "AKS",
            "severity": "High",
            "text": "Use ephemeral OS disks",
            "waf": "Performance"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "f0ce315f-1120-4166-8206-94f2cf3a4d07",
            "link": "https://learn.microsoft.com/azure/virtual-machines/disks-types",
            "service": "AKS",
            "severity": "High",
            "text": "For non-ephemeral disks, use high IOPS and larger OS disks for the nodes when running many pods/node since it requires high performance for running multiple pods and will generate huge logs with default AKS log rotation thresholds",
            "waf": "Performance"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "39c486ce-d5af-4062-89d5-18bb5fd795db",
            "link": "https://learn.microsoft.com/azure/aks/use-ultra-disks",
            "service": "AKS",
            "severity": "Low",
            "text": "For hyper performance storage option use Ultra Disks on AKS",
            "waf": "Performance"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "9f7547c1-747d-4c56-868a-714435bd19dd",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-multi-region",
            "service": "AKS",
            "severity": "Medium",
            "text": "Avoid keeping state in the cluster, and store data outside (AzStorage, AzSQL, Cosmos, etc)",
            "waf": "Performance"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "24429eb7-2281-4376-85cc-57b4a4b18142",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-storage",
            "service": "AKS",
            "severity": "Medium",
            "text": "If using AzFiles Standard, consider AzFiles Premium and/or ANF for performance reasons",
            "waf": "Performance"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "83958a8c-2689-4b32-ab57-cfc64546135a",
            "link": "https://learn.microsoft.com/azure/aks/availability-zones#azure-disk-availability-zone-support",
            "service": "AKS",
            "severity": "Medium",
            "text": "If using Azure Disks and AZs, consider having nodepools within a zone for LRS disk with VolumeBindingMode:WaitForFirstConsumer for provisioning storage in right zone or use ZRS disk for nodepools spanning multiple zones",
            "waf": "Performance"
        },
        {
            "arm-service": "Microsoft.Purview/accounts",
            "checklist": "Microsoft Purview Review Checklist",
            "guid": "1fc2fc14-eea6-4e69-b8d9-a3edc218e687",
            "link": "https://polite-sea-0995b240f.2.azurestaticapps.net/technical-delivery-playbook/azure-services/analytics/purview/",
            "service": "Purview",
            "severity": "Medium",
            "text": "Leverage FTA Resillency Handbook",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Purview/accounts",
            "checklist": "Microsoft Purview Review Checklist",
            "guid": "ab067acb-49e5-4b96-8332-4ecf8cc13318",
            "link": "https://learn.microsoft.com/purview/disaster-recovery",
            "service": "Purview",
            "severity": "High",
            "text": "Plan for Data Center level outage",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Purview/accounts",
            "checklist": "Microsoft Purview Review Checklist",
            "description": "1. Create the new account 2. Migrate configuration items 3. Run scans 4. Migrate custom typedefs and custom assets 5. Migrate relationships 6. Migrate glossary terms 7. Assign classifications to assets 8. Assign contacts to assets",
            "guid": "da611702-69f4-4fb4-aa3d-3ef7f3176c4b",
            "link": "https://learn.microsoft.com/purview/disaster-recovery",
            "service": "Purview",
            "severity": "Medium",
            "text": "Practice Failover for BCDR",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Purview/accounts",
            "checklist": "Microsoft Purview Review Checklist",
            "guid": "97b15b8a-219a-44ab-bb57-879024d22678",
            "link": "https://learn.microsoft.com/purview/disaster-recovery",
            "service": "Purview",
            "severity": "High",
            "text": "Plan a backup strategy and take regular backups",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Purview/accounts",
            "checklist": "Microsoft Purview Review Checklist",
            "guid": "6d20b56c-56a9-4581-89bf-8d8e5c586b7d",
            "link": "https://learn.microsoft.com/purview/manage-kafka-dotnet",
            "service": "Purview",
            "severity": "Low",
            "text": "Use Microsoft Purview's Event Hubs to subscribe and create entities to another account",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Purview/accounts",
            "checklist": "Microsoft Purview Review Checklist",
            "guid": "8cdc15ac-c075-4ee9-a130-a8889579e76b",
            "link": "https://learn.microsoft.com/purview/deployment-best-practices",
            "service": "Purview",
            "severity": "Medium",
            "text": "Follow Purview accounts architectures and deployment best practices",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Purview/accounts",
            "checklist": "Microsoft Purview Review Checklist",
            "guid": "896e710a-7da7-4be9-a56d-14d3c49d997c",
            "link": "https://learn.microsoft.com/purview/concept-best-practices-collections",
            "service": "Purview",
            "severity": "Medium",
            "text": "Follow Collection Architectures and best practices",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Purview/accounts",
            "checklist": "Microsoft Purview Review Checklist",
            "guid": "b3d1325a-a225-4c6f-9e06-85edddea8a4b",
            "link": "https://learn.microsoft.com/purview/concept-best-practices-asset-lifecycle",
            "service": "Purview",
            "severity": "Medium",
            "text": "Follow Assest lifecycle best practices",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Purview/accounts",
            "checklist": "Microsoft Purview Review Checklist",
            "guid": "7cdeb3c6-1fc2-4fc1-9eea-6e69d8d9a3ed",
            "link": "https://learn.microsoft.com/purview/concept-best-practices-automation",
            "service": "Purview",
            "severity": "Medium",
            "text": "Follow automation best practices",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Purview/accounts",
            "checklist": "Microsoft Purview Review Checklist",
            "guid": "c218e687-ab06-47ac-a49e-5b9603324ecf",
            "link": "https://learn.microsoft.com/purview/disaster-recovery",
            "service": "Purview",
            "severity": "Medium",
            "text": "Follow Backup and Migration Best practices",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Purview/accounts",
            "checklist": "Microsoft Purview Review Checklist",
            "guid": "8cc13318-da61-4170-869f-4fb4aa3d3ef7",
            "link": "https://learn.microsoft.com/purview/concept-best-practices-glossary",
            "service": "Purview",
            "severity": "Medium",
            "text": "Follow Purview Glossary Best Practices",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Purview/accounts",
            "checklist": "Microsoft Purview Review Checklist",
            "guid": "f3176c4b-97b1-45b8-a219-a4abeb578790",
            "link": "https://learn.microsoft.com/purview/concept-workflow",
            "service": "Purview",
            "severity": "Low",
            "text": "Leverage Workflows ",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Purview/accounts",
            "checklist": "Microsoft Purview Review Checklist",
            "guid": "24d22678-6d20-4b56-a56a-958119bf8d8e",
            "link": "https://learn.microsoft.com/purview/concept-best-practices-security",
            "service": "Purview",
            "severity": "Medium",
            "text": "Follow Purview Security Best Practices",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Purview/accounts",
            "checklist": "Microsoft Purview Review Checklist",
            "guid": "5c586b7d-8cdc-415a-ac07-5ee9b130a888",
            "link": "https://learn.microsoft.com/purview/concept-best-practices-lineage-azure-data-factory",
            "service": "Purview",
            "severity": "Medium",
            "text": "Follow Purview Data Lineage Best Practices",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Purview/accounts",
            "checklist": "Microsoft Purview Review Checklist",
            "guid": "9579e76b-896e-4710-a7da-7be9956d14d3",
            "link": "https://learn.microsoft.com/purview/concept-best-practices-scanning",
            "service": "Purview",
            "severity": "Medium",
            "text": "Follow Best Practices for Scanning Registered Sources",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Purview/accounts",
            "checklist": "Microsoft Purview Review Checklist",
            "guid": "c49d997c-b3d1-4325-aa22-5c6f4e0685ed",
            "link": "https://learn.microsoft.com/purview/concept-best-practices-classification",
            "service": "Purview",
            "severity": "Medium",
            "text": "Follow Classification Best Practices in Governance Portal",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Purview/accounts",
            "checklist": "Microsoft Purview Review Checklist",
            "guid": "ddea8a4b-7cde-4b3c-91fc-2fc14eea6e69",
            "link": "https://learn.microsoft.com/purview/sensitivity-labels-frequently-asked-questions",
            "service": "Purview",
            "severity": "Medium",
            "text": "Perform Sensitivity Labelling in the Purview Data Map",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Purview/accounts",
            "checklist": "Microsoft Purview Review Checklist",
            "guid": "d8d9a3ed-c218-4e68-9ab0-67acb49e5b96",
            "link": "https://learn.microsoft.com/purview/concept-data-share",
            "service": "Purview",
            "severity": "Low",
            "text": "Leverage Azure Storage in-place data sharing with Microsoft Purview",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Purview/accounts",
            "checklist": "Microsoft Purview Review Checklist",
            "guid": "03324ecf-8cc1-4331-ada6-1170269f4fb4",
            "link": "https://learn.microsoft.com/purview/concept-insights",
            "service": "Purview",
            "severity": "Low",
            "text": "Leverage Data Estate Insights",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Purview/accounts",
            "checklist": "Microsoft Purview Review Checklist",
            "guid": "aa3d3ef7-f317-46c4-a97b-15b8a219a4ab",
            "link": "https://learn.microsoft.com/purview/catalog-adoption-insights",
            "service": "Purview",
            "severity": "Low",
            "text": "Use Data stewardship and Catalog adoption",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Purview/accounts",
            "checklist": "Microsoft Purview Review Checklist",
            "guid": "eb578790-24d2-4267-a6d2-0b56c56a9581",
            "link": "https://learn.microsoft.com/purview/concept-insights",
            "service": "Purview",
            "severity": "Low",
            "text": "Use Inventory and Ownership",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Purview/accounts",
            "checklist": "Microsoft Purview Review Checklist",
            "guid": "19bf8d8e-5c58-46b7-b8cd-c15acc075ee9",
            "link": "https://learn.microsoft.com/purview/glossary-insights",
            "service": "Purview",
            "severity": "Low",
            "text": "Leverage Insights for Glossary, Classifications, Sensitivity Labels",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Purview/accounts",
            "checklist": "Microsoft Purview Review Checklist",
            "guid": "b130a888-9579-4e76-a896-e710a7da7be9",
            "link": "https://learn.microsoft.com/purview/compliance-manager",
            "service": "Purview",
            "severity": "Medium",
            "text": "Generate assessment scores",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Purview/accounts",
            "checklist": "Microsoft Purview Review Checklist",
            "guid": "956d14d3-c49d-4997-ab3d-1325aa225c6f",
            "link": "https://learn.microsoft.com/purview/compliance-manager-scoring",
            "service": "Purview",
            "severity": "Medium",
            "text": "Profiling- get summaries of data content",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Purview/accounts",
            "checklist": "Microsoft Purview Review Checklist",
            "guid": "4e0685ed-ddea-48a4-a7cd-eb3c61fc2fc1",
            "link": "https://learn.microsoft.com/purview/concept-policies-data-owner#microsoft-purview-policy-concepts",
            "service": "Purview",
            "severity": "Low",
            "text": "Follow Microsoft Purview Data Owner access policies",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Purview/accounts",
            "checklist": "Microsoft Purview Review Checklist",
            "guid": "4eea6e69-d8d9-4a3e-bc21-8e687ab067ac",
            "link": "https://learn.microsoft.com/purview/concept-self-service-data-access-policy",
            "service": "Purview",
            "severity": "Low",
            "text": "Follow Self-service access policies",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Purview/accounts",
            "checklist": "Microsoft Purview Review Checklist",
            "guid": "b49e5b96-0332-44ec-b8cc-13318da61170",
            "link": "https://learn.microsoft.com/purview/concept-policies-devops",
            "service": "Purview",
            "severity": "Low",
            "text": "Follow DevOps policies",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.App/containerApps",
            "checklist": "Container Apps Review",
            "guid": "af416482-663c-4ed6-b195-b44c7068e09c",
            "link": "https://learn.microsoft.com/azure/reliability/reliability-azure-container-apps?tabs=azure-cli#availability-zone-support",
            "query": "resources | where type =~ 'Microsoft.App/managedEnvironments' | project name, resourceGroup, location, zoneRedundancy = tolower(tostring(properties.zoneRedundant)) | extend Compliance = iff(zoneRedundancy == 'true', true, false)",
            "service": "Container Apps",
            "severity": "High",
            "text": "Leverage Availability Zones if regionally applicable",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.App/containerApps",
            "checklist": "Container Apps Review",
            "guid": "95bc80ec-6499-4d14-a7d2-7d296b1d8abc",
            "link": "https://learn.microsoft.com/azure/reliability/reliability-azure-container-apps?tabs=azure-cli#set-up-zone-redundancy-in-your-container-apps-environment",
            "query": "resources | where type =~ 'Microsoft.App/containerApps' | project name, resourceGroup, location, minReplicas = toint(properties.template.scale.minReplicas), maxReplicas = toint(properties.template.scale.maxReplicas) | extend Compliance = iff(minReplicas >= 1, true, false)",
            "service": "Container Apps",
            "severity": "High",
            "text": "Use more than one replica and enable Zone Redundancy.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.App/containerApps",
            "checklist": "Container Apps Review",
            "guid": "ccaa4fc2-fdbc-4432-8bb7-f7e6469e4dc3",
            "link": "https://learn.microsoft.com/azure/reliability/reliability-azure-container-apps?tabs=azure-cli#cross-region-disaster-recovery-and-business-continuity",
            "service": "Container Apps",
            "severity": "High",
            "text": "For cross-region DR, deploy container apps in multiple regions and follow active/active or active/passive application guidance.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.App/containerApps",
            "checklist": "Container Apps Review",
            "guid": "2ffada86-c031-4933-bf7d-0c45bc4e5919",
            "link": "https://learn.microsoft.com/azure/reliability/reliability-azure-container-apps?tabs=azure-cli#cross-region-disaster-recovery-and-business-continuity",
            "service": "Container Apps",
            "severity": "High",
            "text": "Use Front Door or Traffic Manager to route traffic to the closest region",
            "waf": "Reliability"
        },
        {
            "checklist": "Identity Review Checklist",
            "guid": "bb235c70-5e17-496f-bedf-a8a4c8cdec4c",
            "link": "https://learn.microsoft.com/entra/identity-platform/msal-acquire-cache-tokens",
            "service": "Entra",
            "severity": "Medium",
            "text": "Use long-live revocable token, cache your token and acquire your silently using Microsoft Identity Library",
            "waf": "Reliability"
        },
        {
            "checklist": "Identity Review Checklist",
            "guid": "503547c1-447e-4c66-828a-71f0f1ce16dd",
            "link": "https://learn.microsoft.com/azure/active-directory-b2c/deploy-custom-policies-devops",
            "service": "AAD B2C",
            "severity": "Medium",
            "text": "Make sure that your sign-in user flows are backed up and resilient. Make sure that the code that you use to sign-in your users are backed up and recoverable. Resilient interfaces with external processes",
            "waf": "Reliability"
        },
        {
            "checklist": "Identity Review Checklist",
            "guid": "3e3553a4-c873-4964-ab66-2d6c15f51296",
            "link": "https://learn.microsoft.com/entra/architecture/resilient-end-user-experience#use-a-content-delivery-network",
            "service": "AAD B2C",
            "severity": "Medium",
            "text": "Custom brand assets should be hosted on a CDN",
            "waf": "Performance"
        },
        {
            "checklist": "Identity Review Checklist",
            "guid": "5398e6df-d237-4de1-93b1-6c21d79a9b64",
            "link": "https://learn.microsoft.com/entra/identity/monitoring-health/reference-sla-performance",
            "service": "AAD B2C",
            "severity": "Low",
            "text": "Have multiple identiy providers (i.e., login with your microsoft, google, facebook accounts)",
            "waf": "Reliability"
        },
        {
            "checklist": "Identity Review Checklist",
            "guid": "604489a8-f42d-478e-98c0-7a73b22a4a57",
            "link": "https://azure.microsoft.com/blog/setting-up-active-directory-for-a-disaster-recovery-environment-2/",
            "service": "Windows AD",
            "severity": "Medium",
            "text": "Follow VM rules for high availability on the VM level (premium disks, two or more in a region, in different availability zones)",
            "waf": "Reliability"
        },
        {
            "checklist": "Identity Review Checklist",
            "guid": "e7a8dd4a-30e3-47c3-b297-11b2362ceee0",
            "link": "https://azure.microsoft.com/blog/setting-up-active-directory-for-a-disaster-recovery-environment-2/",
            "service": "Windows AD",
            "severity": "Medium",
            "text": "Don't replicate! Replication can create issues with directory synchronization",
            "waf": "Reliability"
        },
        {
            "checklist": "Identity Review Checklist",
            "guid": "79b598de-fc59-472c-b4cd-21b078036f5e",
            "link": "https://azure.microsoft.com/blog/setting-up-active-directory-for-a-disaster-recovery-environment-2/",
            "service": "Windows AD",
            "severity": "Medium",
            "text": "Have active-active for multi-regions",
            "waf": "Reliability"
        },
        {
            "checklist": "Identity Review Checklist",
            "guid": "6b4bfd3d-5035-447c-8447-ec66128a71f0",
            "link": "https://learn.microsoft.com/entra/identity/domain-services/tutorial-perform-disaster-recovery-drill",
            "service": "Entra",
            "severity": "Medium",
            "text": "Add Azure AD Domain service stamps to additional regions and locations",
            "waf": "Reliability"
        },
        {
            "checklist": "Identity Review Checklist",
            "guid": "f1ce16dd-3f1d-45e8-92e4-2e3611cc58b4",
            "link": "https://learn.microsoft.com/entra/identity/domain-services/tutorial-perform-disaster-recovery-drill",
            "service": "Entra",
            "severity": "Medium",
            "text": "Use Replica Sets for DR",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "32e42e36-11c8-418b-8a0b-c510e43a18a9",
            "service": "AVS",
            "severity": "High",
            "text": "Ensure ADDS domain controller(s) are deployed in the identity subscription in native Azure",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "75089c20-990d-4927-b105-885576f76fc2",
            "service": "AVS",
            "severity": "Medium",
            "text": "Ensure ADDS sites and services is configured to keep authentication requests from Azure-based resources (including Azure VMware Solution) local to Azure",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "de3aad1e-7c28-4ec9-9666-b7570449aa80",
            "service": "AVS",
            "severity": "High",
            "text": "Ensure that vCenter is connected to ADDS to enable authentication based on 'named user accounts'",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "cd289ced-6b17-4db8-8554-61e2aee3553a",
            "service": "AVS",
            "severity": "Medium",
            "text": "Ensure that the connection from vCenter to ADDS is using a secure protocol (LDAPS)",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "b9d37dac-43bc-46cd-8d79-a9b24604489a",
            "service": "AVS",
            "severity": "Medium",
            "text": "CloudAdmin account in vCenter IdP is used only as an emergency account (break-glass)",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "53d88e89-d17b-473b-82a5-a67e7a9ed5b3",
            "service": "AVS",
            "severity": "High",
            "text": "Ensure that NSX-Manager is integrated with an external Identity provider (LDAPS)",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "ae0e37ce-e297-411b-b352-caaab79b198d",
            "service": "AVS",
            "severity": "Medium",
            "text": "Has an RBAC model been created for use within VMware vSphere",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "ab81932c-9fc9-4d1b-a780-36f5e6bfbb9e",
            "service": "AVS",
            "severity": "Medium",
            "text": "RBAC permissions should be granted on ADDS groups and not on specific users",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "d503547c-c447-4e82-9128-a71f0f1cac6d",
            "service": "AVS",
            "severity": "High",
            "text": "RBAC permissions on the Azure VMware Solution resource in Azure are 'locked down' to a limited set of owners only",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "fd9f0df4-68dc-4976-b9a9-e6a79f7682c5",
            "service": "AVS",
            "severity": "High",
            "text": "Ensure all custom roles are scoped with CloudAdmin permitted authorizations",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "9ef1d5e8-32e4-42e3-911c-818b0a0bc510",
            "link": "https://github.com/Azure/AzureCAT-AVS/tree/main/networking",
            "service": "AVS",
            "severity": "High",
            "text": "Is the correct Azure VMware Solution connectivity model selected for the customer use case at hand",
            "waf": "Performance"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "eb710a37-cbc1-4055-8dd5-a936a8bb7cf5",
            "service": "AVS",
            "severity": "High",
            "text": "Ensure ExpressRoute or VPN connections from on-premises to Azure are monitored using 'connection monitor'",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "976e24f2-a7f8-426c-9253-2a92a2a7ed99",
            "service": "AVS",
            "severity": "Medium",
            "text": "Ensure a connection monitor is created from an Azure native resource to an Azure VMware Solution virtual machine to monitor the Azure VMware Solution back-end ExpressRoute connection",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "f41ce6a0-64f3-4805-bc65-3ab50df01265",
            "service": "AVS",
            "severity": "Medium",
            "text": "Ensure a connection monitor is created from an on-premises resource to an Azure VMware Solution virtual machine to monitor end-2-end connectivity",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "563b4dc7-4a74-48b6-933a-d1a0916a6649",
            "service": "AVS",
            "severity": "High",
            "text": "When route server is used, ensure no more then 1000 routes are propagated from route server to ExR gateway to on-premises (ARS limit).",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "6128a71f-0f1c-4ac6-b9ef-1d5e832e42e3",
            "service": "AVS",
            "severity": "High",
            "text": "Is Privileged Identity Management implemented for roles managing the Azure VMware Solution resource in the Azure Portal (no standing permissions allowed)",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "c4e2436b-b336-4d71-9f17-960eee0b9b5c",
            "service": "AVS",
            "severity": "High",
            "text": "Privileged Identity Management audit reporting should be implemented for the Azure VMware Solution PIM roles",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "78c447a8-26b2-4863-af0f-1cac599ef1d5",
            "service": "AVS",
            "severity": "Medium",
            "text": "If using Privileged Identity Management is being used, ensure that a valid Entra ID enabled account is created with a valid SMTP record for Azure VMware Solution Automatic Host replacement notifications. (standing permissions required)",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "8defc4d7-21d3-41d2-90fb-707ae9eab40e",
            "service": "AVS",
            "severity": "High",
            "text": "Limit use of CloudAdmin account to emergency access only",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "d329f798-bc17-48bd-a5a0-6ca7144351d1",
            "service": "AVS",
            "severity": "Medium",
            "text": "Create custom RBAC roles in vCenter to implement a least-privilege model inside vCenter",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "9dd24429-eb72-4281-97a1-51c5bb4e4f18",
            "service": "AVS",
            "severity": "Medium",
            "text": "Is a process defined to regularly rotate cloudadmin (vCenter) and admin (NSX) credentials",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "586cb291-ec16-4a1d-876e-f9f141acdce5",
            "service": "AVS",
            "severity": "High",
            "text": "Use a centralized identity provider to be used for workloads (VM's) running on Azure VMware Solution",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "79377bcd-b375-41ab-8ab0-ead66e15d3d4",
            "service": "AVS",
            "severity": "Medium",
            "text": "Is East-West traffic filtering implemented within NSX-T",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "a2adb1c3-d232-46af-825c-a44e1695fddd",
            "service": "AVS",
            "severity": "High",
            "text": "Workloads on Azure VMware Solution are not directly exposed to the internet. Traffic is filtered and inspected by Azure Application Gateway, Azure Firewall or 3rd party solutions",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "eace4cb1-deb4-4c65-8c3f-c14eeab36938",
            "service": "AVS",
            "severity": "High",
            "text": "Auditing and logging is implemented for inbound internet requests to Azure VMware Solution and Azure VMware Solution based workloads",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "29e3eec2-1836-487a-8077-a2b5945bda43",
            "service": "AVS",
            "severity": "Medium",
            "text": "Session monitoring is implemented for outbound internet connections from Azure VMware Solution or Azure VMware Solution based workloads to identify suspicious/malicious activity",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "graph": "resources| where type =~ 'Microsoft.Network/virtualNetworkGateways'| mv-expand ipConfigurations=properties.ipConfigurations| project subnetId=tostring(ipConfigurations.properties.subnet.id)| where isnotempty(subnetId)| join (resources | where type=='microsoft.network/virtualnetworks' | project id,resourceGroup,name,enableDdosProtection=tostring(properties.enableDdosProtection),subnets=properties.subnets | mv-expand subnets | project id,resourceGroup,name,enableDdosProtection,subnetId=tostring(subnets.id)) on subnetId | distinct id,resourceGroup,name,enableDdosProtection | project id, compliant = (enableDdosProtection == 'true')",
            "guid": "334fdf91-c234-4182-a652-75269440b4be",
            "service": "AVS",
            "severity": "Medium",
            "text": "Is DDoS standard protection enabled on ExR/VPN Gateway subnet in Azure",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "3d3e0843-276d-44bd-a015-bcf219e4a1eb",
            "service": "AVS",
            "severity": "Medium",
            "text": "Use a dedicated privileged access workstation (PAW) to manage Azure VMware Solution, vCenter, NSX manager and HCX manager",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "9ccbd869-266a-4cca-874f-aa19bf39d95d",
            "service": "AVS",
            "severity": "Medium",
            "text": "Enable Advanced Threat Detection (Microsoft Defender for Cloud aka ASC) for workloads running on Azure VMware Solution",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "44c7c891-9ca1-4f6d-9315-ae524ba34d45",
            "service": "AVS",
            "severity": "Medium",
            "text": "Use Azure ARC for Servers to properly govern workloads running on Azure VMware Solution using Azure native technologies (Azure ARC for Azure VMware Solution is not yet available)",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "85e12139-bd7b-4b01-8f7b-95ef6e043e2a",
            "service": "AVS",
            "severity": "Low",
            "text": "Ensure workloads on Azure VMware Solution use sufficient data encryption during run-time (like in-guest disk encryption and SQL TDE). (vSAN encryption at rest is default)",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "a3592718-e6e2-4051-9267-6ae46691e883",
            "service": "AVS",
            "severity": "Low",
            "text": "When in-guest encryption is used, store encryption keys in Azure Key vault when possible",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "5ac94222-3e13-4810-9230-81a941741583",
            "service": "AVS",
            "severity": "Medium",
            "text": "Consider using extended security update support for workloads running on Azure VMware Solution (Azure VMware Solution is eligible for ESU)",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "3ef7ad7c-6d37-4331-95c7-acbe44bbe609",
            "service": "AVS",
            "severity": "High",
            "text": "Ensure that the appropriate vSAN Data redundancy method is used (RAID specification)",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "d88408f3-7273-44c8-96ba-280214590146",
            "service": "AVS",
            "severity": "High",
            "text": "Ensure that the Failure-to-tolerate policy is in place to meet your vSAN storage needs",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "d89f2e87-7784-424d-9167-85c6fa95b96a",
            "service": "AVS",
            "severity": "High",
            "text": "Ensure that you have requested enough quota, ensuring you have considered growth and Disaster Recovery requirement",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "5d38e53f-9ccb-4d86-a266-acca274faa19",
            "service": "AVS",
            "severity": "Medium",
            "text": "Ensure that access constraints to ESXi are understood, there are access limits which might affect 3rd party solutions.",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "bf39d95d-44c7-4c89-89ca-1f6d5315ae52",
            "service": "AVS",
            "severity": "Medium",
            "text": "Ensure that you have a policy around ESXi host density and efficiency, keeping in mind the lead time for requesting new nodes",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "4ba34d45-85e1-4213-abd7-bb012f7b95ef",
            "service": "AVS",
            "severity": "Medium",
            "text": "Ensure a good cost management process is in place for Azure VMware Solution - Azure Cost Management can be used",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "6e043e2a-a359-4271-ae6e-205172676ae4",
            "service": "AVS",
            "severity": "Low",
            "text": "Are Azure reserved instances used to optimize cost for using Azure VMware Solution",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "6691e883-5ac9-4422-83e1-3810523081a9",
            "service": "AVS",
            "severity": "Medium",
            "text": "Consider the use of Azure Private-Link when using other Azure Native Services",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "db611712-6904-40b4-aa3d-3e0803276d4b",
            "service": "AVS",
            "severity": "High",
            "text": "Ensure all required resource reside within the same Azure availability zone(s)",
            "waf": "Performance"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "48b262d6-cc5f-4512-a253-98e6db9d37da",
            "service": "AVS",
            "severity": "Medium",
            "text": "Enable Microsoft Defender for Cloud for Azure VMware Solution guest VM workloads",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "41741583-3ef7-4ad7-a6d3-733165c7acbe",
            "service": "AVS",
            "severity": "Medium",
            "text": "Use Azure Arc enabled servers to manage your Azure VMware Solution guest VM workloads",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "88f03a4d-2cd4-463c-abbc-868295abc91a",
            "service": "AVS",
            "severity": "High",
            "text": "Enable Diagnostic and metric logging on Azure VMware Solution",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "4ed90dae-2cc8-44c4-9b6b-781cbafe6c46",
            "service": "AVS",
            "severity": "Medium",
            "text": "Deploy the Log Analytics Agents to Azure VMware Solution guest VM workloads",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "589d457a-927c-4397-9d11-02cad6aae11e",
            "service": "AVS",
            "severity": "Medium",
            "text": "Ensure you have a documented and implemented backup policy and solution for Azure VMware Solution VM workloads",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "ee29711b-d352-4caa-ab79-b198dab81932",
            "service": "AVS",
            "severity": "Medium",
            "text": "Use Microsoft Defender for Cloud for compliance monitoring of workloads running on Azure VMware Solution",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "c9fc9d1b-b780-436f-9e6b-fbb9ed503547",
            "service": "AVS",
            "severity": "Medium",
            "text": "Are the applicable compliance baselines added to Microsoft Defender for Cloud",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "cc447e82-6128-4a71-b0f1-cac6d9ef1d5e",
            "service": "AVS",
            "severity": "High",
            "text": "Was data residency evaluated when selecting Azure regions to use for Azure VMware Solution deployment",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "832e42e3-611c-4818-a0a0-bc510e43a18a",
            "service": "AVS",
            "severity": "High",
            "text": "Are data processing implications (service provider / service consumer model) clear and documented",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "547c1747-dc56-4068-a714-435cd19dd244",
            "service": "AVS",
            "severity": "Medium",
            "text": "Consider using CMK (Customer Managed Key) for vSAN only if needed for compliance reason(s).",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "e43a18a9-cd28-49ce-b6b1-7db8255461e2",
            "service": "AVS",
            "severity": "High",
            "text": "Create dashboards to enable core Azure VMware Solution monitoring insights",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "graph": "resources| where type =~ 'Microsoft.AVS/privateClouds'| join kind=leftouter(resources| where type =~ 'Microsoft.Insights/metricalerts'| mv-expand scopes=properties.scopes| mv-expand criteria=properties.criteria.allOf| extend metricName=criteria.metricName| distinct tostring(scopes), tostring(metricName))on $left.id == $right.scopes| extend compliant=toint(metricName in ('UsageAverage', 'EffectiveCpuAverage', 'DiskUsedPercentage'))| summarize compliant=min(compliant) by id",
            "guid": "6b84ee5d-f47d-42d9-8881-b1cd5d1e54a2",
            "service": "AVS",
            "severity": "High",
            "text": "Create warning alerts for critical thresholds for automatic alerting on Azure VMware Solution performance (CPU >80%, Avg Memory >80%, vSAN >70%)",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "graph": "resources| where type =~ 'Microsoft.AVS/privateClouds'| join kind=leftouter(resources| where type =~ 'Microsoft.Insights/metricalerts'| mv-expand scopes=properties.scopes| mv-expand criteria=properties.criteria.allOf| extend metricName=criteria.metricName| distinct tostring(scopes), tostring(metricName))on $left.id == $right.scopes| extend compliant=toint(metricName in ('UsageAverage', 'EffectiveCpuAverage', 'DiskUsedPercentage'))| summarize compliant=min(compliant) by id",
            "guid": "9659e396-80e7-4828-ac93-5657d02bff45",
            "service": "AVS",
            "severity": "High",
            "text": "Ensure critical alert is created to monitor if vSAN consumption is below 75% as this is a support threshold from VMware",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "graph": "resources| distinct subscriptionId| join kind=leftouter(    resources    | where type =~ 'microsoft.insights/activitylogalerts'    | mv-expand condition1 = properties.condition.allOf    | mv-expand condition2 = condition1.anyOf    | extend alertEnabled = tostring(properties.enabled)    | summarize set_condition1=make_set(condition1.equals), set_condition2=make_set(condition2.equals) by id, name,type,tenantId,resourceGroup,subscriptionId, alertEnabled    | where set_has_element(set_condition1, 'ServiceHealth')    | extend category = 'ServiceHealth'    | extend all = iff(set_has_element(set_condition1, 'ServiceHealth') and array_length(set_condition2) == 0, true, false)    | extend incident = iff(all, true, iff(set_has_element(set_condition1, 'Incident'), true, set_has_element(set_condition2, 'Incident')))    | extend maintenance = iff(all, true, iff(set_has_element(set_condition1, 'Maintenance'), true, set_has_element(set_condition2, 'Maintenance')))    | extend informational = iff(all, true, iff(set_has_element(set_condition1, 'Informational') or set_has_element(set_condition1, 'ActionRequired'), true, set_has_element(set_condition2, 'Informational') or set_has_element(set_condition2, 'ActionRequired')))    | extend security = iff(all, true, iff(set_has_element(set_condition1, 'Security'), true, set_has_element(set_condition2, 'Security')))    | project id, name, subscriptionId, category, tostring(alertEnabled), tostring(incident), tostring(maintenance), tostring(informational), tostring(security)    | summarize count_alertEnabled=countif(alertEnabled == 'true'), count_incident=countif(incident == 'True'), count_maintenance=countif(maintenance == 'True'), count_informational=countif(informational == 'True'), count_security=countif(security == 'True') by subscriptionId)     on subscriptionId| project subscriptionId, alertEnabled=iff(isnotnull(count_alertEnabled), count_alertEnabled, 0), incident=iff(isnotnull(count_incident), count_incident, 0), security=iff(isnotnull(count_security), count_security, 0), maintenance=iff(isnotnull(count_maintenance), count_maintenance, 0), informational=iff(isnotnull(count_informational), count_informational, 0)| order by incident, maintenance, informational, security desc| project id=subscriptionId, compliant=(alertEnabled > 0 and incident > 0 and security > 0 and maintenance > 0 and informational > 0)",
            "guid": "64b0d934-a348-4726-be79-d6b5c3a36495",
            "service": "AVS",
            "severity": "High",
            "text": "Ensure alerts are configured for Azure Service Health alerts and notifications",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "b6abad38-aad5-43cc-99e1-d86667357c54",
            "service": "AVS",
            "severity": "Medium",
            "text": "Configure Azure VMware Solution logging to be send to an Azure Storage account or Azure EventHub for processing",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "9674c5ed-85b8-459c-9733-be2b1a27b775",
            "service": "AVS",
            "severity": "Low",
            "text": "If deep insight in VMware vSphere is required: Is vRealize Operations and/or vRealize Network Insights used in the solution?",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "a91be1f3-88f0-43a4-b2cd-463cbbbc8682",
            "service": "AVS",
            "severity": "High",
            "text": "Ensure the vSAN storage policy for VM's is NOT the default storage policy as this policy applies thick provisioning",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "d9ef1d5e-832d-442e-9611-c818b0afbc51",
            "service": "AVS",
            "severity": "Medium",
            "text": "Ensure vSphere content libraries are not placed on vSAN as vSAN is a finite resource",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "0e43a18a-9cd2-489b-bd6b-17db8255461e",
            "service": "AVS",
            "severity": "Medium",
            "text": "Ensure data repositories for the backup solution are stored outside of vSAN storage. Either in Azure native or on a disk pool-backed datastore",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "2aee3453-aec8-4339-848b-262d6cc5f512",
            "service": "AVS",
            "severity": "Medium",
            "text": "Ensure workloads running on Azure VMware Solution are hybrid managed using Azure Arc for Servers (Arc for Azure VMware Solution is in preview)",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "925398e6-da9d-437d-ac43-bc6cd1d79a9b",
            "service": "AVS",
            "severity": "Medium",
            "text": "Ensure workloads running on Azure VMware Solution are monitored using Azure Log Analytics and Azure Monitor",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "24604489-a8f4-42d7-ae78-cb6a33bd2a09",
            "service": "AVS",
            "severity": "Medium",
            "text": "Include workloads running on Azure VMware Solution in existing update management tooling or in Azure Update Management",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "17e7a8d9-0ae0-4e27-aee2-9711bd352caa",
            "service": "AVS",
            "severity": "Medium",
            "text": "Use Azure Policy to onboard Azure VMware Solution workloads in the Azure Management, Monitoring and Security solutions",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "aee3553a-fc83-4392-98b2-62d6cc5f5129",
            "service": "AVS",
            "severity": "Medium",
            "text": "Ensure workloads running on Azure VMware Solution are onboarded to Microsoft Defender for Cloud",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "25398e6d-b9d3-47da-a43b-c6cd1d79a9b2",
            "service": "AVS",
            "severity": "Medium",
            "text": "Ensure backups are not stored on vSAN as vSAN is a finite resource",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "5e6bfbb9-ed50-4354-9cc4-47e826028a71",
            "service": "AVS",
            "severity": "Medium",
            "text": "Have all DR solutions been considered and a solution that is best for your business been decided upon? [SRM/JetStream/Zerto/Veeam/...]",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "f0f1cac6-d9ef-41d5-b832-d42e3611c818",
            "service": "AVS",
            "severity": "Medium",
            "text": "Use Azure Site Recovery when the Disaster Recovery technology is native Azure IaaS",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "b0afbc51-0e43-4a18-a9cd-289bed6b17db",
            "service": "AVS",
            "severity": "High",
            "text": "Use Automated recovery plans with either of the Disaster solutions, avoid manual tasks as much as possible",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "8255461e-2aee-4345-9aec-8339248b262d",
            "service": "AVS",
            "severity": "Medium",
            "text": "Use the geopolitical region pair as the secondary disaster recovery environment",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "6cc5f512-9253-498e-9da9-d37dac43bc6c",
            "service": "AVS",
            "severity": "High",
            "text": "Use 2 different address spaces between the regions, for example: 10.0.0.0/16 and 192.168.0.0/16 for the different regions",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "d1d79a9b-2460-4448-aa8f-42d78e78cb6a",
            "service": "AVS",
            "severity": "Medium",
            "text": "Will ExpressRoute Global Reach be used for connectivity between the primary and secondary Azure VMware Solution Private Clouds or is routing done through network virtual appliances?",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "33bd2a09-17e7-4a8d-a0ae-0e27cee29711",
            "service": "AVS",
            "severity": "Medium",
            "text": "Have all Backup solutions been considered and a solution that is best for your business been decided upon? [ MABS/CommVault/Metallic.io/Veeam/�. ]",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "bd352caa-ab79-4b18-adab-81932c9fc9d1",
            "service": "AVS",
            "severity": "Medium",
            "text": "Deploy your backup solution in the same region as your Azure VMware Solution private cloud",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "bb77036f-5e6b-4fbb-aed5-03547cc447e8",
            "service": "AVS",
            "severity": "Medium",
            "text": "Deploy your backup solution outside of vSan, on Azure native components",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "26028a71-f0f1-4cac-9d9e-f1d5e832d42e",
            "service": "AVS",
            "severity": "Low",
            "text": "Is a process in place to request a restore of the VMware components managed by the Azure Platform?",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "4604489a-8f42-4d78-b78c-b7a33bd2a0a1",
            "service": "AVS",
            "severity": "Low",
            "text": "For manual deployments, all configuration and deployments must be documented",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "7e7a8d90-ae0e-437c-be29-711bd352caaa",
            "service": "AVS",
            "severity": "Low",
            "text": "For manual deployments, consider implementing resource locks to prevent accidental actions on your Azure VMware Solution Private Cloud",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "b79b198d-ab81-4932-a9fc-9d1bb78036f5",
            "service": "AVS",
            "severity": "Low",
            "text": "For automated deployments, deploy a minimal private cloud and scale as needed",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "e6bfbb9e-d503-4547-ac44-7e826128a71f",
            "service": "AVS",
            "severity": "Low",
            "text": "For automated deployments,  request or reserve quota prior to starting the deployment",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "0f1cac6d-9ef1-4d5e-a32e-42e3611c818b",
            "service": "AVS",
            "severity": "Low",
            "text": "For automated deployment, ensure that relevant resource locks are created through the automation or through Azure Policy for proper governance",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "e2cc95d4-8c6b-4791-bca0-f6c56589e558",
            "service": "AVS",
            "severity": "Low",
            "text": "Implement human understandable names for ExR authorization keys to allow for easy identification of the keys purpose/use",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "255461e2-aee3-4553-afc8-339248b262d6",
            "service": "AVS",
            "severity": "Low",
            "text": "Use Key vault to store secrets and authorization keys when separate Service Principles are used for deploying Azure VMware Solution and ExpressRoute",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "cc5f5129-2539-48e6-bb9d-37dac43bc6cd",
            "service": "AVS",
            "severity": "Low",
            "text": "Define resource dependencies for serializing actions in IaC when many resources need to be deployed in/on Azure VMware Solution as Azure VMware Solution only supports a limited number of parallel operations.",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "1d79a9b2-4604-4489-a8f4-2d78e78cb7a3",
            "service": "AVS",
            "severity": "Low",
            "text": "When performing automated configuration of NSX-T segments with a single Tier-1 gateway, use Azure Portal APIs instead of NSX-Manager APIs",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "3bd2a0a1-7e7a-48d9-8ae0-e37cee29711b",
            "service": "AVS",
            "severity": "Medium",
            "text": "When intending to use automated scale-out, be sure to apply for sufficient Azure VMware Solution quota for the subscriptions running Azure VMware Solution",
            "waf": "Performance"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "d352caaa-b79b-4198-bab8-1932c9fc9d1b",
            "service": "AVS",
            "severity": "Medium",
            "text": "When intending to use automated scale-in, be sure to take storage policy requirements into account before performing such action",
            "waf": "Performance"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "b78036f5-e6bf-4bb9-bd50-3547cc447e82",
            "service": "AVS",
            "severity": "Medium",
            "text": "Scaling operations always need to be serialized within a single SDDC as only one scale operation can be performed at a time (even when multiple clusters are used)",
            "waf": "Performance"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "bf15bce2-19e4-4a0e-a588-79424d226786",
            "service": "AVS",
            "severity": "Medium",
            "text": "Consider and validate scaling operations on 3rd party solutions used in the architecture (supported or not)",
            "waf": "Performance"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "d20b56c5-7be5-4851-a0f8-3835c586cb29",
            "service": "AVS",
            "severity": "Medium",
            "text": "Define and enforce scale in/out maximum limits for your environment in the automations",
            "waf": "Performance"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "1dc15a1c-075e-4e9f-841a-cccd579376bc",
            "service": "AVS",
            "severity": "Medium",
            "text": "Implement monitoring rules to monitor automated scaling operations and monitor success and failure to enable appropriate (automated) responses",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "c5972cd4-cd21-4b07-9036-f5e6b4bfd3d5",
            "link": "https://learn.microsoft.com/azure/active-directory/app-proxy/application-proxy#how-application-proxy-works",
            "service": "AVS",
            "severity": "High",
            "text": "When using MON, be aware of the limits of simulataneously configured VMs (MON Limit for HCX [400 - standard, 1000 - Larger appliance])",
            "training": "https://learn.microsoft.com/learn/modules/configure-azure-ad-application-proxy/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "be1f38cf-03a8-422b-b463-cbbbc8ac299e",
            "link": "https://learn.microsoft.com/azure/active-directory/app-proxy/application-proxy#how-application-proxy-works",
            "service": "AVS",
            "severity": "High",
            "text": "When using MON, you cannot enable MON on more than 100 Network extensions",
            "training": "https://learn.microsoft.com/learn/paths/implement-applications-external-access-azure-ad/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "bc91a43d-90da-4e2c-a881-4706f7c1cbaf",
            "service": "AVS",
            "severity": "Medium",
            "text": "If using a VPN connection for migrations, adjust your MTU size accordingly.",
            "waf": "Performance"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "e614658d-d457-4e92-9139-b821102cad6e",
            "service": "AVS",
            "severity": "Medium",
            "text": "For low connectivity regions connecting into Azure (500Mbps or less), considering deploying the HCX WAN optimization appliance",
            "waf": "Performance"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "ae01e6e8-43e5-42f4-922d-928c1b1cd521",
            "service": "AVS",
            "severity": "Medium",
            "text": "Ensure that migrations are started from the on-premises appliance and NOT from the Cloud appliance (do NOT perform a reverse migration)",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "e54a29a9-de39-4ac0-b7c2-8dc935657202",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-policy-settings",
            "service": "AVS",
            "severity": "Medium",
            "text": "When Azure Netapp Files is used to extend storage for Azure VMware Solution,consider using this as a VMware datastore instead of attaching directly to a VM.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "bff4564b-0d93-44a3-98b2-63e7dd60513a",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#avoid-combining-traffic-manager-and-front-door",
            "service": "AVS",
            "severity": "Medium",
            "text": "Ensure that a dedicated ExpressRoute Gateway is being used for external data storage solutions",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "3649906e-bad3-48ea-b53c-c7de1d8aaab3",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-the-same-domain-name-on-front-door-and-your-origin",
            "service": "AVS",
            "severity": "Medium",
            "text": "Ensure that FastPath is enabled on the ExpressRoute Gateway that is being used for external data storage solutions",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "571549ab-8153-4d89-b89d-c7b33be2b1a2",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#disable-health-probes-when-theres-only-one-origin-in-an-origin-group",
            "service": "AVS",
            "severity": "High",
            "text": "If using stretched cluster, ensure that your selected Disaster Recovery solution is supported by the vendor",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "4c486b6d-8bdc-4059-acf7-5ee8a1309888",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#select-good-health-probe-endpoints",
            "service": "AVS",
            "severity": "High",
            "text": "If using stretched cluster, ensure that the SLA provided will meet your requirements",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "9579d66b-896d-471f-a6ca-7be9955d04c3",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-head-health-probes",
            "service": "AVS",
            "severity": "High",
            "text": "If using stretched cluster, ensure that both ExpressRoute circuits are connected to your connectivity hub.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "c49d987c-b3d1-4325-aa12-4b6e4d0685ed",
            "link": "https://learn.microsoft.com/azure/nat-gateway/nat-overview#outbound-connectivity",
            "service": "AVS",
            "severity": "High",
            "text": "If using stretched cluster, ensure that both ExpressRoute circuits have GlobalReach enabled.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "dce9793b-7bcd-4b3b-91eb-2ec14eea6e59",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-managed-tls-certificates",
            "service": "AVS",
            "severity": "High",
            "text": "Have site disaster tolerance settings been properly considered and changed for your business if needed.",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.cache/redis",
            "checklist": "Redis Resiliency checklist",
            "guid": "65285269-440b-44be-9d3e-0844276d4bdc",
            "link": "https://learn.microsoft.com/azure/azure-cache-for-redis/cache-how-to-zone-redundancy",
            "service": "Redis",
            "severity": "High",
            "text": "Enable zone redundancy for Azure Cache for Redis. Azure Cache for Redis supports zone redundant configurations in the Premium and Enterprise tiers. A zone redundant cache can place its nodes across different Azure Availability Zones in the same region. It eliminates data center or AZ outage as a single point of failure and increases the overall availability of your cache.",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.cache/redis",
            "checklist": "Redis Resiliency checklist",
            "guid": "bc178bdc-5a06-4ca7-8443-51e19dd34429",
            "link": "https://learn.microsoft.com/en-us/azure/azure-cache-for-redis/cache-high-availability#persistence",
            "service": "Redis",
            "severity": "Medium",
            "text": "Configure data persistence for an Azure Cache for Redis instance. Because your cache data is stored in memory, a rare and unplanned failure of multiple nodes can cause all the data to be dropped. To avoid losing data completely, Redis persistence allows you to take periodic snapshots of in-memory data, and store it to your storage account.",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.cache/redis",
            "checklist": "Redis Resiliency checklist",
            "guid": "eb722823-7a15-41c5-ab4e-4f1814387e5c",
            "link": "https://learn.microsoft.com/en-us/azure/azure-cache-for-redis/cache-high-availability#storage-account-for-persistence",
            "service": "Redis",
            "severity": "Medium",
            "text": "Use Geo-redundant storage account to persist Azure Cache for Redis data, or zonally redundant where geo-redundancy is not available",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.cache/redis",
            "checklist": "Redis Resiliency checklist",
            "guid": "a8c26c9b-32ab-45bd-bc69-98a135e33789",
            "link": "https://learn.microsoft.com/azure/azure-cache-for-redis/cache-how-to-geo-replication",
            "service": "Redis",
            "severity": "Medium",
            "text": "Configure passive geo-replication for Premium Azure Cache for Redis instances. Geo-replication is a mechanism for linking two or more Azure Cache for Redis instances, typically spanning two Azure regions. Geo-replication is designed mainly for cross-region disaster recovery. Two Premium tier cache instances are connected through geo-replication in a way that provides reads and writes to your primary cache, and that data is replicated to the secondary cache.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.DataFactory/datafactories",
            "checklist": "Azure Data Factory Review Checklist",
            "guid": "ab91932c-9fc9-4d1b-a881-37f5e6c0cb9e",
            "link": "https://github.com/Azure/fta-resiliencyplaybooks/blob/main/paas-foundations-playbooks-ADF_v1.docx",
            "service": "Data Factory",
            "severity": "Medium",
            "text": "Leverage FTA Resiliency Playbook for Azure Data Factory",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.DataFactory/datafactories",
            "checklist": "Azure Data Factory Review Checklist",
            "guid": "e503547c-d447-4e82-9138-a7200f1cac6d",
            "link": "https://learn.microsoft.com/azure/architecture/example-scenario/analytics/pipelines-disaster-recovery",
            "service": "Data Factory",
            "severity": "High",
            "text": "Use zone redundant pipelines in regions that support Availability Zones",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.DataFactory/datafactories",
            "checklist": "Azure Data Factory Review Checklist",
            "guid": "9ef1d6e8-32e5-42e3-911c-818b1a0bc511",
            "link": "https://learn.microsoft.com/azure/data-factory/source-control",
            "service": "Data Factory",
            "severity": "Medium",
            "text": "Use DevOps to Backup the ARM templates with Github/Azure DevOps integration ",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.DataFactory/datafactories",
            "checklist": "Azure Data Factory Review Checklist",
            "guid": "e43a18a9-cd29-49cf-b7b1-7db8255562f2",
            "link": "https://learn.microsoft.com/azure/architecture/example-scenario/analytics/pipelines-disaster-recovery",
            "service": "Data Factory",
            "severity": "Medium",
            "text": "Make sure you replicate the Self-Hosted Integration Runtime VMs in another region ",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.DataFactory/datafactories",
            "checklist": "Azure Data Factory Review Checklist",
            "guid": "aee4563a-fd83-4393-98b2-62d6dc5f512a",
            "link": "https://learn.microsoft.com/azure/architecture/example-scenario/analytics/pipelines-disaster-recovery",
            "service": "Data Factory",
            "severity": "Medium",
            "text": "Make sure you replicate or duplicate your network in the sister region. You have to make a copy of your Vnet in another region",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.DataFactory/datafactories",
            "checklist": "Azure Data Factory Review Checklist",
            "description": "If your ADF Pipelines use Key Vault you don't have to do anything to replicate Key Vault. Key Vault is a managed service and Microsoft takes care of it for you",
            "guid": "25498f6d-bad3-47da-a43b-c6ce1d7aa9b2",
            "link": "https://learn.microsoft.com/azure/key-vault/general/disaster-recovery-guidance",
            "service": "Data Factory",
            "severity": "Low",
            "text": "If using Keyvault integration, use SLA of Keyvault to understand your availablity",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.ServiceBus/namespaces",
            "checklist": "Service Bus Review Checklist",
            "description": "Azure Service Bus Premium provides encryption of data at rest. If you use your own key, the data is still encrypted using the Microsoft-managed key, but in addition the Microsoft-managed key will be encrypted using the customer-managed key. ",
            "guid": "87af4a79-1f89-439b-ba47-768e14c11567",
            "link": "https://learn.microsoft.com/azure/service-bus-messaging/configure-customer-managed-key",
            "service": "Service Bus",
            "severity": "Low",
            "text": "Use customer-managed key option in data at rest encryption when required",
            "training": "https://learn.microsoft.com/learn/modules/plan-implement-administer-conditional-access/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.ServiceBus/namespaces",
            "checklist": "Service Bus Review Checklist",
            "description": "Communication between a client application and an Azure Service Bus namespace is encrypted using Transport Layer Security (TLS). Azure Service Bus namespaces permit clients to send and receive data with TLS 1.0 and above. To enforce stricter security measures, you can configure your Service Bus namespace to require that clients send and receive data with a newer version of TLS.",
            "guid": "5c1ea55b-46a9-448f-b8ae-7d7e4b475b6c",
            "link": "https://learn.microsoft.com/azure/service-bus-messaging/transport-layer-security-enforce-minimum-version",
            "service": "Service Bus",
            "severity": "Medium",
            "text": "Enforce a minimum required version of Transport Layer Security (TLS) for requests ",
            "training": "https://learn.microsoft.com/learn/modules/secure-aad-users-with-mfa/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.ServiceBus/namespaces",
            "checklist": "Service Bus Review Checklist",
            "description": "When you create a Service Bus namespace, a SAS rule named RootManageSharedAccessKey is automatically created for the namespace. This policy has Manage permissions for the entire namespace. It's recommended that you treat this rule like an administrative root account and don't use it in your application.  Using AAD as an authentication provider with RBAC is recommended. ",
            "guid": "8bcbf59b-ce65-4de8-a03f-97879468d66a",
            "link": "https://learn.microsoft.com/azure/service-bus-messaging/service-bus-sas#shared-access-authorization-policies",
            "service": "Service Bus",
            "severity": "Medium",
            "text": "Avoid using root account when it is not necessary",
            "training": "https://learn.microsoft.com/learn/paths/azure-administrator-manage-identities-governance/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.ServiceBus/namespaces",
            "checklist": "Service Bus Review Checklist",
            "description": "Microsoft Entra ID provides superior security and ease of use over shared access signatures (SAS). With Microsoft Entra ID, there’s no need to store the tokens in your code and risk potential security vulnerabilities. We recommend that you use Microsoft Entra ID with your Azure Service Bus applications when possible.",
            "graph": "Resources | where type =~ 'microsoft.servicebus/namespaces' | extend compliant = iif(properties.disableLocalAuth == 'false', 'No', 'Yes') | project id, compliant",
            "guid": "786d60f9-6c96-4ad8-a55d-04c2b39c986b",
            "link": "https://learn.microsoft.com/en-us/azure/service-bus-messaging/disable-local-authentication",
            "service": "Service Bus",
            "severity": "Medium",
            "text": "When possible, disable SAS key authentication (or local authentication) and use only Microsoft Entra ID for authentication",
            "training": "https://learn.microsoft.com/learn/modules/azure-ad-privileged-identity-management/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.ServiceBus/namespaces",
            "checklist": "Service Bus Review Checklist",
            "description": "When creating permissions, provide fine-grained control over a client's access to Azure Service Bus. Permissions in Azure Service Bus can and should be scoped to the individual resource level e.g. queue, topic or subscription. ",
            "guid": "f615658d-e558-4f93-9249-b831112dbd7e",
            "link": "https://learn.microsoft.com/azure/service-bus-messaging/authenticate-application#azure-built-in-roles-for-azure-service-bus",
            "service": "Service Bus",
            "severity": "High",
            "text": "Use least privilege data plane RBAC",
            "training": "https://learn.microsoft.com/learn/modules/explore-basic-services-identity-types/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.ServiceBus/namespaces",
            "checklist": "Service Bus Review Checklist",
            "description": "Azure Service Bus resource logs include operational logs,  virtual network and IP filtering logs. Runtime audit logs capture aggregated diagnostic information for various data plane access operations (such as send or receive messages) in Service Bus.",
            "guid": "af12e7f9-43f6-4304-922d-929c2b1cd622",
            "link": "https://learn.microsoft.com/azure/service-bus-messaging/monitor-service-bus-reference",
            "service": "Service Bus",
            "severity": "Medium",
            "text": "Enable logging for security investigation. Use Azure Monitor to trace resource logs and runtime audit logs (currently available only in the premium tier)",
            "training": "https://learn.microsoft.com/learn/paths/manage-identity-and-access/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.ServiceBus/namespaces",
            "checklist": "Service Bus Review Checklist",
            "description": "Azure Service Bus by default has a public IP address and is Internet-reachable. Private endpoints allow traffic between your virtual network and Azure Service Bus traverses over the Microsoft backbone network. In addition to that, you should disable public endpoints if those are not used. ",
            "guid": "9ae669ca-48e4-4a85-b222-3ece8bb12307",
            "link": "https://learn.microsoft.com/azure/service-bus-messaging/private-link-service",
            "service": "Service Bus",
            "severity": "Medium",
            "text": "Consider using private endpoints to access Azure Service Bus and disable public network access when applicable.",
            "training": "https://learn.microsoft.com/learn/modules/azure-ad-privileged-identity-management/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.ServiceBus/namespaces",
            "checklist": "Service Bus Review Checklist",
            "description": "With IP firewall, you can restrict the public endpoint further to only a set of IPv4 addresses or IPv4 address ranges in CIDR (Classless Inter-Domain Routing) notation. ",
            "guid": "ca5f06f1-58e3-4ea3-a92c-2de7e2165c3a",
            "link": "https://learn.microsoft.com/azure/service-bus-messaging/service-bus-ip-filtering",
            "service": "Service Bus",
            "severity": "Medium",
            "text": "Consider only allowing access to Azure Service Bus namespace from specific IP addresses or ranges",
            "training": "https://learn.microsoft.com/learn/paths/implement-resource-mgmt-security/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Devices/provisioningServices",
            "checklist": "Device Provisioning Service Review",
            "guid": "cb26b2ba-a9db-45d1-8260-d9c6ec1447d9",
            "link": "https://learn.microsoft.com/en-us/azure/logic-apps/single-tenant-overview-compare",
            "service": "IoT Hub DPS",
            "severity": "High",
            "text": "Select the right Logic App hosting plan based on your business & SLO requirements",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Devices/provisioningServices",
            "checklist": "Device Provisioning Service Review",
            "guid": "f6dd7977-1123-4f39-b488-f91415a8430a",
            "link": "https://learn.microsoft.com/en-us/azure/logic-apps/set-up-zone-redundancy-availability-zones?tabs=standard#next-steps",
            "service": "IoT Hub DPS",
            "severity": "High",
            "text": "Protect logic apps from region failures with zone redundancy and availability zones",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Devices/provisioningServices",
            "checklist": "Device Provisioning Service Review",
            "guid": "8aed4fbf-0830-4883-899d-222a154af478",
            "link": "https://learn.microsoft.com/en-us/azure/logic-apps/business-continuity-disaster-recovery-guidance?toc=%2Fazure%2Freliability%2Ftoc.json&bc=%2Fazure%2Freliability%2Fbreadcrumb%2Ftoc.json",
            "service": "IoT Hub DPS",
            "severity": "High",
            "text": "Consider a Cross-Region DR strategy for critical workloads",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Devices/provisioningServices",
            "checklist": "Device Provisioning Service Review",
            "guid": "da0f033e-d180-4f36-9aa4-c468dba14203",
            "link": "https://learn.microsoft.com/en-us/azure/app-service/environment/intro",
            "service": "IoT Hub DPS",
            "severity": "High",
            "text": "If deploying to an Isolated environment, use or migrate to App Service Environment (ASE) v3",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Devices/provisioningServices",
            "checklist": "Device Provisioning Service Review",
            "guid": "62711604-c9d1-4b0a-bdb7-5fda54a4f6c1",
            "link": "https://learn.microsoft.com/en-us/training/modules/deploy-azure-functions/",
            "service": "IoT Hub DPS",
            "severity": "Medium",
            "text": "Leverage Azure DevOps or GitHub to streamline CI/CD and safeguard your Logic App code",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "Azure Storage Review Checklist",
            "description": "Apply guidance from the Microsoft cloud security benchmark related to Storage",
            "guid": "d237de14-3b16-4c21-b7aa-9b64604489a8",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/storage-security-baseline",
            "service": "Storage",
            "severity": "Medium",
            "text": "Consider the 'Azure security baseline for storage'",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "Azure Storage Review Checklist",
            "description": "Azure Storage by default has a public IP address and is Internet-reachable. Private endpoints allow to securely expose Azure Storage only to those Azure Compute resources that need access, thus eliminating exposure to the public Internet",
            "graph": "resources | where type =~ 'Microsoft.Storage/StorageAccounts' | where isnull(properties.privateEndpointConnections) or properties.privateEndpointConnections[0].properties.provisioningState != ('Succeeded') or (isnull(properties.networkAcls) and properties.publicNetworkAccess == 'Enabled') | extend compliant = (isnotnull(properties.privateEndpointConnections) and properties.privateEndpointConnections[0].properties.provisioningState == 'Succeeded' and properties.publicNetworkAccess == 'Disabled') | distinct id, compliant",
            "guid": "f42d78e7-9d17-4a73-a22a-5a67e7a8ed4b",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-private-endpoints",
            "service": "Storage",
            "severity": "High",
            "text": "Consider using private endpoints for Azure Storage",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "Azure Storage Review Checklist",
            "description": "Newly created storage accounts are created using the ARM deployment model, so that RBAC, auditing etc. are all enabled. Ensure that there are no old storage accounts with classic deployment model in a subscription",
            "guid": "30e37c3e-2971-41b2-963c-eee079b598de",
            "link": "https://learn.microsoft.com/azure/virtual-machines/migration-classic-resource-manager-overview#migration-of-storage-accounts",
            "service": "Storage",
            "severity": "Medium",
            "text": "Ensure older storage accounts are not using 'classic deployment model'",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "Azure Storage Review Checklist",
            "description": "Leverage Microsoft Defender to learn about suspicious activity and misconfigurations.",
            "graph": "resources | where type =~ 'Microsoft.Storage/StorageAccounts' | project storageAccountId = id | join kind=leftouter (resourceContainers | where type == 'microsoft.security/pricings' | where name == 'StorageAccounts' | project resourceId = id, pricingTier = properties.pricingTier) on $left.storageAccountId == $right.resourceId | where isnull(pricingTier) or pricingTier != 'Standard' | extend compliant = false | distinct storageAccountId, compliant",
            "guid": "fc5972cd-4cd2-41b0-a803-7f5e6b4bfd3d",
            "link": "https://learn.microsoft.com/azure/storage/common/azure-defender-storage-configure",
            "service": "Storage",
            "severity": "High",
            "text": "Enable Microsoft Defender for all of your storage accounts",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "Azure Storage Review Checklist",
            "description": "The soft-delete mechanism allows to recover accidentally deleted blobs.",
            "guid": "503547c1-447e-4c66-828a-7100f1ce16dd",
            "link": "https://learn.microsoft.com/azure/storage/blobs/soft-delete-blob-overview",
            "service": "Storage",
            "severity": "Medium",
            "text": "Enable 'soft delete' for blobs",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "Azure Storage Review Checklist",
            "description": "Consider selectively disabling 'soft delete' for certain blob containers, for example if the application must ensure that deleted information is immediately deleted, e.g. for confidentiality, privacy or compliance reasons. ",
            "guid": "3f1d5e87-2e52-4e36-81cc-58b4a4b1510e",
            "link": "https://learn.microsoft.com/azure/storage/blobs/soft-delete-blob-enable",
            "service": "Storage",
            "severity": "Medium",
            "text": "Disable 'soft delete' for blobs",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "Azure Storage Review Checklist",
            "description": "Soft delete for containers enables you to recover a container after it has been deleted, for example recover from an accidental delete operation.",
            "guid": "43a58a9c-2289-4c3d-9b57-d0c655462f2a",
            "link": "https://learn.microsoft.com/azure/storage/blobs/soft-delete-container-overview",
            "service": "Storage",
            "severity": "High",
            "text": "Enable 'soft delete' for containers",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "Azure Storage Review Checklist",
            "description": "Consider selectively disabling 'soft delete' for certain blob containers, for example if the application must ensure that deleted information is immediately deleted, e.g. for confidentiality, privacy or compliance reasons. ",
            "guid": "3e3453a3-c863-4964-ab65-2d6c15f51296",
            "link": "https://learn.microsoft.com/azure/storage/blobs/soft-delete-container-enable",
            "service": "Storage",
            "severity": "Medium",
            "text": "Disable 'soft delete' for containers",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "Azure Storage Review Checklist",
            "description": "Prevents accidental deletion of a storage account, by forcing the user to first remove the deletion lock, prior to deletion",
            "guid": "5398e6de-d227-4dd1-92b0-6c21d7999a64",
            "link": "https://learn.microsoft.com/azure/storage/common/lock-account-resource",
            "service": "Storage",
            "severity": "High",
            "text": "Enable resource locks on storage accounts",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "Azure Storage Review Checklist",
            "description": "Consider 'legal hold' or 'time-based retention' policies for blobs, so that is is impossible to delete the blob, the container, or the storage account. Please note that 'impossible' actually means 'impossible'; once a storage account contains an immutable blob, the only way to 'get rid' of that storage account is by cancelling the Azure subscription.",
            "guid": "6f4389a8-f42c-478e-98c0-6a73a22a4956",
            "link": "https://learn.microsoft.com/azure/storage/blobs/immutable-storage-overview",
            "service": "Storage",
            "severity": "High",
            "text": "Consider immutable blobs",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "Azure Storage Review Checklist",
            "description": "Consider disabling unprotected HTTP/80 access to the storage account, so that all data transfers are encrypted, integrity protected, and the server is authenticated. ",
            "graph": "resources | where type =~ 'Microsoft.Storage/StorageAccounts' | extend compliant = (properties.supportsHttpsTrafficOnly == false) | distinct id, compliant",
            "guid": "e7a8dc4a-20e2-47c3-b297-11b1352beee0",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-require-secure-transfer",
            "service": "Storage",
            "severity": "High",
            "text": "Require HTTPS, i.e. disable port 80 on the storage account",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "Azure Storage Review Checklist",
            "description": "When configuring a custom domain (hostname) on a storage account, check whether you need TLS/HTTPS; if so, you might have to put Azure CDN in front of your storage account.",
            "guid": "79b588de-fc49-472c-b3cd-21bf77036e5e",
            "link": "https://learn.microsoft.com/azure/storage/blobs/storage-custom-domain-name",
            "service": "Storage",
            "severity": "High",
            "text": "When enforcing HTTPS (disabling HTTP), check that you do not use custom domains (CNAME) for the storage account.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "Azure Storage Review Checklist",
            "description": "Requiring HTTPS when a client uses a SAS token to access blob data helps to minimize the risk of credential loss.",
            "guid": "6b4bed3d-5035-447c-8347-dc56028a71ff",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-sas-overview",
            "service": "Storage",
            "severity": "Medium",
            "text": "Limit shared access signature (SAS) tokens to HTTPS connections only",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "Azure Storage Review Checklist",
            "description": ". Enforcing the latest TLS version will reject request from clients using the older version. ",
            "graph": "resources | where type == 'microsoft.storage/storageaccounts' | extend compliant = (isnull(properties.minimumTlsVersion) == false and properties.minimumTlsVersion in ('TLS1_2', 'TLS1_3')) | distinct id, compliant",
            "guid": "e12be569-a18f-4562-8d5d-ce151b9e7d55",
            "link": "https://learn.microsoft.com/azure/storage/common/transport-layer-security-configure-minimum-version",
            "service": "Storage",
            "severity": "High",
            "text": "Enforce the latest TLS version for a storage account",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "Azure Storage Review Checklist",
            "description": "Microsoft Entra ID tokens should be favored over shared access signatures, wherever possible",
            "guid": "e1ce15dd-3f0d-45e7-92d4-1e3611cc57b4",
            "link": "https://learn.microsoft.com/azure/storage/common/authorize-data-access",
            "service": "Storage",
            "severity": "High",
            "text": "Use Microsoft Entra ID tokens for blob access",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "Azure Storage Review Checklist",
            "description": "When assigning a role to a user, group, or application, grant that security principal only those permissions that are necessary for them to perform their tasks. Limiting access to resources helps prevent both unintentional and malicious misuse of your data.",
            "guid": "a4b1410d-4395-48a8-a228-9b3d6b57cfc6",
            "service": "Storage",
            "severity": "Medium",
            "text": "Least privilege in IaM permissions",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "Azure Storage Review Checklist",
            "description": "A user delegation SAS is secured with Azure Active Directory (Azure AD) credentials and also by the permissions specified for the SAS. A user delegation SAS is analogous to a service SAS in terms of its scope and function, but offers security benefits over the service SAS. ",
            "guid": "55461e1a-3e34-453a-9c86-39648b652d6c",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-sas-overview?toc=%2Fazure%2Fstorage%2Fblobs%2Ftoc.json#best-practices-when-using-sas",
            "service": "Storage",
            "severity": "High",
            "text": "When using SAS, prefer 'user delegation SAS' over storage-account-key based SAS.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "Azure Storage Review Checklist",
            "description": "Storage account keys ('shared keys') have very little audit capabilities. While it can be monitored on who/when fetched a copy of the keys, once the keys are in the hands of multiple people, it is impossible to attribute usage to a specific user. Solely relying on Entra ID authentication makes it easier to tie storage access to a user. ",
            "graph": "resources | where type == 'microsoft.storage/storageaccounts' | extend allowSharedKeyAccess = tostring(properties.allowSharedKeyAccess) | extend compliant = (isnotempty(allowSharedKeyAccess) and allowSharedKeyAccess == 'false') | distinct id, compliant",
            "guid": "15f51296-5398-4e6d-bd22-7dd142b06c21",
            "link": "https://learn.microsoft.com/rest/api/storageservices/authorize-with-shared-key",
            "service": "Storage",
            "severity": "High",
            "text": "Consider disabling storage account keys, so that only Microsoft Entra ID access (and user delegation SAS) is supported.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "Azure Storage Review Checklist",
            "description": "Use Activity Log data to identify 'when', 'who', 'what' and 'how' the security of your storage account is being viewed or changed (i.e. storage account keys, access policies, etc.).",
            "guid": "d7999a64-6f43-489a-af42-c78e78c06a73",
            "link": "https://learn.microsoft.com/azure/storage/blobs/blob-storage-monitoring-scenarios#audit-account-activity",
            "service": "Storage",
            "severity": "High",
            "text": "Consider using Azure Monitor to audit control plane operations on the storage account",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "Azure Storage Review Checklist",
            "description": "A key expiration policy enables you to set a reminder for the rotation of the account access keys. The reminder is displayed if the specified interval has elapsed and the keys have not yet been rotated.",
            "guid": "a22a4956-e7a8-4dc4-a20e-27c3e29711b1",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-account-keys-manage?tabs=azure-portal#create-a-key-expiration-policy",
            "service": "Storage",
            "severity": "Medium",
            "text": "When using storage account keys, consider enabling a 'key expiration policy'",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "Azure Storage Review Checklist",
            "description": "A SAS expiration policy specifies a recommended interval over which the SAS is valid. SAS expiration policies apply to a service SAS or an account SAS. When a user generates service SAS or an account SAS with a validity interval that is larger than the recommended interval, they'll see a warning.",
            "guid": "352beee0-79b5-488d-bfc4-972cd3cd21bf",
            "link": "https://learn.microsoft.com/azure/storage/common/sas-expiration-policy",
            "service": "Storage",
            "severity": "Medium",
            "text": "Consider configuring an SAS expiration policy",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "Azure Storage Review Checklist",
            "description": "Stored access policies give you the option to revoke permissions for a service SAS without having to regenerate the storage account keys. ",
            "guid": "77036e5e-6b4b-4ed3-b503-547c1347dc56",
            "link": "https://learn.microsoft.com/rest/api/storageservices/define-stored-access-policy",
            "service": "Storage",
            "severity": "Medium",
            "text": "Consider linking SAS to a stored access policy",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "Azure Storage Review Checklist",
            "guid": "028a71ff-e1ce-415d-b3f0-d5e772d41e36",
            "link": "https://microsoft.github.io/code-with-engineering-playbook/continuous-integration/dev-sec-ops/secret-management/recipes/detect-secrets-ado/",
            "service": "Storage",
            "severity": "Medium",
            "text": "Consider configuring your application's source code repository to detect checked-in connection strings and storage account keys.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "Azure Storage Review Checklist",
            "description": "Ideally, your application should be using a managed identity to authenticate to Azure Storage. If that is not possible, consider having the storage credential (connection string, storage account key, SAS, service principal credential) in Azure KeyVault or an equivalent service.",
            "guid": "11cc57b4-a4b1-4410-b439-58a8c2289b3d",
            "link": "https://learn.microsoft.com/azure/architecture/framework/security/design-storage-keys",
            "service": "Storage",
            "severity": "High",
            "text": "Consider storing connection strings in Azure KeyVault (in scenarios where managed identities are not possible)",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "Azure Storage Review Checklist",
            "description": "Use near-term expiration times on an ad hoc SAS service SAS or account SAS. In this way, even if a SAS is compromised, it's valid only for a short time. This practice is especially important if you cannot reference a stored access policy. Near-term expiration times also limit the amount of data that can be written to a blob by limiting the time available to upload to it.",
            "guid": "27138b82-1102-4cac-9eae-01e6e842e52f",
            "link": "https://learn.microsoft.com/rest/api/storageservices/delegate-access-with-shared-access-signature",
            "service": "Storage",
            "severity": "High",
            "text": "Strive for short validity periods for ad-hoc SAS",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "Azure Storage Review Checklist",
            "description": "When creating a SAS, be as specific and restrictive as possible. Prefer a SAS for a single resource and operation over a SAS which gives much broader access.",
            "guid": "4721d928-c1b1-4cd5-81e5-4a29a9de399c",
            "link": "https://learn.microsoft.com/rest/api/storageservices/delegate-access-with-shared-access-signature",
            "service": "Storage",
            "severity": "Medium",
            "text": "Apply a narrow scope to a SAS",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "Azure Storage Review Checklist",
            "description": "A SAS can include parameters on which client IP addresses or address ranges are authorized to request a resource using the SAS. ",
            "guid": "fd7b28dc-9355-4562-82bf-e4564b0d834a",
            "link": "https://learn.microsoft.com/rest/api/storageservices/create-account-sas",
            "service": "Storage",
            "severity": "Medium",
            "text": "Consider scoping SAS to a specific client IP address, wherever possible",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "Azure Storage Review Checklist",
            "description": "A SAS cannot constrain how much data a client uploads; given the pricing model of amount of storage over time, it might make sense to validate whether clients uploaded maliciously large contents.",
            "guid": "348b263e-6dd6-4051-8a36-498f6dbad38e",
            "service": "Storage",
            "severity": "Low",
            "text": "Consider checking uploaded data, after clients used a SAS to upload a file. ",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "Azure Storage Review Checklist",
            "description": "When accessing blob storage via SFTP using a 'local user account', the 'usual' RBAC controls do not apply. Blob access via NFS or REST might be more restrictive than SFTP access. Unfortunately, as of early 2023, local users are the only form of identity management that is currently supported for the SFTP endpoint",
            "guid": "ad53cc7c-e1d7-4aaa-a357-1449ab8053d8",
            "link": "https://learn.microsoft.com/azure/storage/blobs/secure-file-transfer-protocol-support#sftp-permission-model",
            "service": "Storage",
            "severity": "High",
            "text": "SFTP: Limit the amount of 'local users' for SFTP access, and audit whether access is needed over time.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "Azure Storage Review Checklist",
            "guid": "9f89dc7b-33be-42a1-a27f-7b9e91be1f38",
            "link": "https://learn.microsoft.com/azure/storage/blobs/secure-file-transfer-protocol-known-issues#authentication-and-authorization",
            "service": "Storage",
            "severity": "Medium",
            "text": "SFTP: The SFTP endpoint does not support POSIX-like ACLs.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "Azure Storage Review Checklist",
            "description": "Storage supports CORS (Cross-Origin Resource Sharing), i.e. an HTTP feature that enables web apps from a different domain to loosen the same-origin policy. When enabling CORS, keep the CorsRules to the least privilege.",
            "guid": "cef39812-bd46-43cb-aac8-ac199ebb91a3",
            "link": "https://learn.microsoft.com/rest/api/storageservices/cross-origin-resource-sharing--cors--support-for-the-azure-storage-services",
            "service": "Storage",
            "severity": "High",
            "text": "Avoid overly broad CORS policies",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "Azure Storage Review Checklist",
            "description": "Data at rest is always encrypted server-side, and in addition might be encrypted client-side as well. Server-side encryption might happen using a platform-managed key (default) or customer-managed key. Client-side encryption might happen by either having the client supply an encryption/decryption key on a per-blob basis to Azure storage, or by completely handling encryption on the client-side. thus not relying on Azure Storage at all for confidentiality guarantees.",
            "guid": "3d90cae2-cc88-4137-86f7-c0cbafe61464",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-service-encryption",
            "service": "Storage",
            "severity": "High",
            "text": "Determine how data at rest should be encrypted. Understand the thread model for data.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "Azure Storage Review Checklist",
            "guid": "8dd457e9-2713-48b8-8110-2cac6eae01e6",
            "link": "https://learn.microsoft.com/azure/storage/common/customer-managed-keys-overview?toc=%2Fazure%2Fstorage%2Fblobs%2Ftoc.json&bc=%2Fazure%2Fstorage%2Fblobs%2Fbreadcrumb%2Ftoc.json",
            "service": "Storage",
            "severity": "Medium",
            "text": "Determine which/if platform encryption should be used.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "Azure Storage Review Checklist",
            "guid": "e842e52f-4721-4d92-ac1b-1cd521e54a29",
            "link": "https://learn.microsoft.com/azure/storage/blobs/encryption-customer-provided-keys",
            "service": "Storage",
            "severity": "Medium",
            "text": "Determine which/if client-side encryption should be used.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "Azure Storage Review Checklist",
            "description": "Anonymous access may present a security risk. We recommend that you disable anonymous access for optimal security. Disallowing anonymous access helps to prevent data breaches caused by undesired anonymous access.",
            "graph": "resources | where type == 'microsoft.storage/storageaccounts' | extend compliant = (properties.allowBlobPublicAccess == 'false') | distinct id, compliant",
            "guid": "659ae558-b937-4d49-a5e1-112dbd7ba012",
            "link": "https://learn.microsoft.com/azure/storage/blobs/anonymous-read-access-configure?tabs=portal#allow-or-disallow-public-read-access-for-a-storage-account",
            "service": "Storage",
            "severity": "High",
            "text": "Consider whether public blob anonymous access is needed, or whether it can be disabled for certain storage accounts. ",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "Azure Storage Review Checklist",
            "guid": "cb8eb8c0-aa62-4a25-a495-6eaa8dc4a243",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-account-upgrade?tabs=azure-portal",
            "service": "Storage",
            "severity": "High",
            "text": "Leverage a storagev2 account type for better performance and reliability",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "Azure Storage Review Checklist",
            "graph": "resources | where type =~ 'Microsoft.Storage/StorageAccounts' | extend compliant = (sku.name != 'Standard_LRS' and sku.name != 'Premium_LRS') | distinct id, compliant",
            "guid": "e05bbe20-9d49-4fda-9777-8424d116785c",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-redundancy",
            "service": "Storage",
            "severity": "High",
            "text": "Leverage GRS, ZRS or GZRS storage for the highest availability",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "Azure Storage Review Checklist",
            "guid": "2fa56c56-ad48-4408-be72-734c486ba280",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-disaster-recovery-guidance",
            "service": "Storage",
            "severity": "Medium",
            "text": "For write operation after failover, use customer-Managed Failover ",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "Azure Storage Review Checklist",
            "guid": "dc0590cf-65de-48e1-909c-cbd579266bcc",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-disaster-recovery-guidance#microsoft-managed-failover",
            "service": "Storage",
            "severity": "Medium",
            "text": "Understand Microsoft-Managed Failover details",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "Azure Storage Review Checklist",
            "guid": "a274faa1-abfe-49d5-9d04-c3c4919cb1b3",
            "link": "https://learn.microsoft.com/azure/storage/blobs/soft-delete-blob-enable?tabs=azure-portal",
            "service": "Storage",
            "severity": "Medium",
            "text": "Enable Soft Delete",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.BotService/botServices",
            "checklist": "Azure Bot Service",
            "guid": "6ad48408-ee72-4734-a476-ba28fdcf590c",
            "link": "https://learn.microsoft.com/en-us/azure/reliability/reliability-bot",
            "service": "Bot service",
            "severity": "Medium",
            "text": "Follow reliability support recommendations in Azure Bot Service",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.BotService/botServices",
            "checklist": "Azure Bot Service",
            "guid": "e65de8e1-3f9c-4cbd-9682-66abca264f9a",
            "link": "https://learn.microsoft.com/en-us/azure/bot-service/bot-builder-concept-regionalization",
            "service": "Bot service",
            "severity": "Medium",
            "text": "Deploying bots with local data residency and regional compliance",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.BotService/botServices",
            "checklist": "Azure Bot Service",
            "guid": "19bfe9d5-5d04-4c3c-9919-ca1b2d1215ae",
            "link": "https://learn.microsoft.com/en-us/azure/reliability/reliability-bot#cross-region-disaster-recovery-in-multi-region-geography",
            "service": "Bot service",
            "severity": "Medium",
            "text": "Azure Bot Service runs in active-active mode for both global and regional services. When an outage occurs, you don't need to detect errors or manage the service. Azure Bot Service automatically performs auto failover and auto recovery in a multi-region geographical architecture. For the EU bot regional service, Azure Bot Service provides two full regions inside Europe with active/active replication to ensure redundancy. For the global bot service, all available regions/geographies can be served as the global footprint.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AppPlatform/Spring",
            "checklist": "Azure Spring Apps Review",
            "guid": "6d8e32a8-3892-479d-a40b-10f6b4f6f298",
            "link": "https://learn.microsoft.com/azure/spring-apps/concepts-blue-green-deployment-strategies",
            "service": "Spring Apps",
            "severity": "Medium",
            "text": "Azure Spring Apps permits two deployments for every app, only one of which receives production traffic. You can achieve zero downtime with blue green deployment strategies. Blue green deployment is only available in Standard and Enterprise tiers. You could automate deployment using CI/CD with ADO/GitHub actions",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AppPlatform/Spring",
            "checklist": "Azure Spring Apps Review",
            "guid": "fbcb40ac-9480-4a6d-bcf4-8081252a6716",
            "link": "https://learn.microsoft.com/azure/architecture/web-apps/spring-apps/architectures/spring-apps-multi-region",
            "service": "Spring Apps",
            "severity": "Medium",
            "text": "Azure Spring Apps instances could be created in multiple regions for your applications and traffic could be routed by Traffic Manager/Front Door.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AppPlatform/Spring",
            "checklist": "Azure Spring Apps Review",
            "guid": "ff1ae6a7-9301-4feb-9d11-56cd72f1d4ef",
            "link": "https://learn.microsoft.com/azure/reliability/reliability-spring-apps",
            "service": "Spring Apps",
            "severity": "Medium",
            "text": "In supported region, Azure Spring Apps can be deployed as zone redundant, which means that instances are automatically distributed across availability zones. This feature is only available in Standard and Enterprise tiers.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AppPlatform/Spring",
            "checklist": "Azure Spring Apps Review",
            "guid": "ffc735ad-fbb1-4802-b43f-ad6387c4c066",
            "link": "https://learn.microsoft.com/azure/spring-apps/concept-understand-app-and-deployment",
            "service": "Spring Apps",
            "severity": "Medium",
            "text": "Use more than 1 app instance for your apps",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AppPlatform/Spring",
            "checklist": "Azure Spring Apps Review",
            "guid": "7504c230-6035-4183-95a5-85762acc6075",
            "link": "https://learn.microsoft.com/azure/spring-apps/diagnostic-services",
            "service": "Spring Apps",
            "severity": "Medium",
            "text": "Monitor Azure Spring Apps with logs, metrics and tracing. Integrate ASA with application insights and track failures and create workbooks.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AppPlatform/Spring",
            "checklist": "Azure Spring Apps Review",
            "guid": "1eb48d58-3eec-4ef5-80b0-d2b0dde3f0c6",
            "link": "https://learn.microsoft.com/azure/spring-apps/how-to-configure-enterprise-spring-cloud-gateway",
            "service": "Spring Apps",
            "severity": "Medium",
            "text": "Set up autoscaling in Spring Cloud Gateway",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AppPlatform/Spring",
            "checklist": "Azure Spring Apps Review",
            "guid": "97411607-b6fd-4335-99d1-9885faf4e392",
            "link": "https://learn.microsoft.com/azure/spring-apps/how-to-setup-autoscale",
            "service": "Spring Apps",
            "severity": "Low",
            "text": "Enable autoscale for the apps with Standard consumption & dedicated plan.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AppPlatform/Spring",
            "checklist": "Azure Spring Apps Review",
            "guid": "dfcaffd1-d27c-4ef2-998d-64c1df3a7ac3",
            "link": "https://learn.microsoft.com/azure/spring-apps/overview",
            "service": "Spring Apps",
            "severity": "Medium",
            "text": "Use Enterprise plan for commercial support of spring boot for mission critical apps. With other tiers you get OSS support.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Devices/deviceUpdateServices",
            "checklist": "Device Update Review",
            "guid": "0e03f5ee-4648-423c-bb86-7239480f9171",
            "link": "https://learn.microsoft.com/en-us/azure/iot-dps/iot-dps-ha-dr#high-availability",
            "service": "Device Update for IoT Hub",
            "severity": "High",
            "text": "Leverage Availability Zones if regionally applicable (this is automatically enabled).",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Devices/deviceUpdateServices",
            "checklist": "Device Update Review",
            "guid": "c0c273bd-00ad-419a-9f2f-fc72fb181e55",
            "link": "https://learn.microsoft.com/en-us/azure/iot-dps/iot-dps-ha-dr#high-availability",
            "service": "Device Update for IoT Hub",
            "severity": "High",
            "text": "Be aware of Microsoft-initiated failovers. These are exercised by Microsoft in rare situations to fail over all the DPS instances from an affected region to the corresponding geo-paired region.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Devices/deviceUpdateServices",
            "checklist": "Device Update Review",
            "guid": "3af8abe6-07eb-4287-b393-6c4abe3702eb",
            "link": "https://learn.microsoft.com/en-us/azure/logic-apps/business-continuity-disaster-recovery-guidance?toc=%2Fazure%2Freliability%2Ftoc.json&bc=%2Fazure%2Freliability%2Fbreadcrumb%2Ftoc.json",
            "service": "Device Update for IoT Hub",
            "severity": "High",
            "text": "Consider a Cross-Region DR strategy for critical workloads",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Devices/deviceUpdateServices",
            "checklist": "Device Update Review",
            "guid": "bd91245c-fe32-4e98-a085-794a40f4bfe1",
            "link": "https://learn.microsoft.com/en-us/azure/app-service/environment/intro",
            "service": "Device Update for IoT Hub",
            "severity": "High",
            "text": "If deploying to an Isolated environment, use or migrate to App Service Environment (ASE) v3",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Network/virtualNetworks",
            "checklist": "Azure Landing Zone Review",
            "guid": "7bc1c396-2461-4698-b57f-30ca69525252",
            "link": "https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/ready/considerations/regions",
            "service": "VNet",
            "severity": "Medium",
            "text": "Deploy your Azure landing zone connectivity resources in multiple regions, so that you can quickly support multi-region application landing zones and disaster recovery scenarios.",
            "training": "https://learn.microsoft.com/training/modules/hub-and-spoke-network-architecture/",
            "waf": "Reliability"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "70c15989-c726-42c7-b0d3-24b7375b9201",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/multi-tenant/considerations-recommendations",
            "service": "Entra",
            "severity": "Medium",
            "text": "Use one Entra tenant for managing your Azure resources, unless you have a clear regulatory or business requirement for multi-tenants.",
            "training": "https://learn.microsoft.com/training/modules/deploy-resources-scopes-bicep/2-understand-deployment-scopes",
            "waf": "Operations"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "6309957b-821a-43d1-b9d9-7fcf1802b747",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/multi-tenant/automation",
            "service": "Entra",
            "severity": "Low",
            "text": "Use Multi-Tenant Automation approach to managing your Microsoft Entra ID Tenants.",
            "training": "https://learn.microsoft.com/entra/architecture/multi-tenant-user-management-introduction/",
            "waf": "Operations"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "78e11934-499a-45ed-8ef7-aae5578f0ecf",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/multi-tenant/lighthouse",
            "service": "Entra",
            "severity": "High",
            "text": "Use Azure Lighthouse for Multi-Tenant Management with the same IDs.",
            "training": "https://learn.microsoft.com/azure/lighthouse/concepts/cross-tenant-management-experience",
            "waf": "Operations"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "5d82e6df-6f61-42f2-82e2-3132d293be3d",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-microsoft-customer-agreement#design-recommendations",
            "service": "Entra",
            "severity": "High",
            "text": "If you give a partner access to administer your tenant, use Azure Lighthouse.",
            "training": "https://learn.microsoft.com/azure/lighthouse/how-to/onboard-customer",
            "waf": "Cost"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "348ef254-c27d-442e-abba-c7571559ab91",
            "link": "https://learn.microsoft.com/azure/role-based-access-control/overview",
            "service": "Entra",
            "severity": "High",
            "text": "Enforce a RBAC model that aligns to your cloud operating model. Scope and Assign across Management Groups and Subscriptions.",
            "training": "https://learn.microsoft.com/learn/paths/implement-resource-mgmt-security/",
            "waf": "Reliability"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "12e7f983-f630-4472-8dd6-9c5b5c2622f5",
            "link": "https://learn.microsoft.com/azure/active-directory/roles/security-planning#identify-microsoft-accounts-in-administrative-roles-that-need-to-be-switched-to-work-or-school-accounts",
            "service": "Entra",
            "severity": "Medium",
            "text": "Only use the authentication type Work or school account for all account types. Avoid using the Microsoft account",
            "training": "https://learn.microsoft.com/learn/modules/explore-basic-services-identity-types/",
            "waf": "Reliability"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "4b69bad3-3aad-45e8-a68e-1d76667313b4",
            "link": "https://learn.microsoft.com/azure/active-directory/fundamentals/active-directory-groups-create-azure-portal",
            "service": "Entra",
            "severity": "Medium",
            "text": "Only use groups to assign permissions. Add on-premises groups to the Entra ID only group if a group management system is already in place.",
            "training": "https://learn.microsoft.com/learn/paths/manage-identity-and-access/",
            "waf": "Reliability"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "53e8908a-e28c-484c-93b6-b7808b9fe5c4",
            "link": "https://learn.microsoft.com/azure/active-directory/conditional-access/overview",
            "service": "Entra",
            "severity": "High",
            "text": "Enforce Microsoft Entra ID Conditional Access policies for any user with rights to Azure environments.",
            "training": "https://learn.microsoft.com/learn/modules/plan-implement-administer-conditional-access/",
            "waf": "Reliability"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "1049d403-a923-4c34-94d0-0018ac6a9e01",
            "link": "https://learn.microsoft.com/azure/active-directory/authentication/concept-mfa-howitworks",
            "service": "Entra",
            "severity": "High",
            "text": "Enforce multi-factor authentication for any user with rights to the Azure environments.",
            "training": "https://learn.microsoft.com/entra/identity/authentication/concept-mandatory-multifactor-authentication",
            "waf": "Reliability"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "14658d35-58fd-4772-99b8-21112df27ee4",
            "link": "https://learn.microsoft.com/azure/active-directory/privileged-identity-management/pim-configure",
            "service": "Entra",
            "severity": "Medium",
            "text": "Enforce Microsoft Entra ID Privileged Identity Management (PIM) to establish zero standing access and least privilege.",
            "training": "https://learn.microsoft.com/learn/modules/azure-ad-privileged-identity-management/",
            "waf": "Reliability"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "8b9fe5c4-1049-4d40-9a92-3c3474d00018",
            "link": "https://learn.microsoft.com/entra/identity/domain-services/overview",
            "service": "Entra",
            "severity": "Medium",
            "text": "If planning to switch from Active Directory Domain Services to Entra domain services, evaluate the compatibility of all workloads.",
            "training": "https://learn.microsoft.com/learn/modules/implement-hybrid-identity-windows-server/",
            "waf": "Reliability"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type == 'microsoft.aad/domainservices' | extend replicaSets = properties.replicaSets | where array_length(replicaSets) < 2 | project name=name, id=id, tags=tags, param1=strcat('replicaSetLocation:', replicaSets[0].location)",
            "guid": "0dd4e625-9c4b-4a56-b54a-4357bac12761",
            "link": "https://learn.microsoft.com/entra/identity/domain-services/overview",
            "service": "Entra",
            "severity": "Medium",
            "text": "When using Microsoft Entra Domain Services use replica sets. Replica sets will improve the resiliency of your managed domain and allow you to deploy to additional regions. ",
            "training": "https://learn.microsoft.com/training/modules/understand-azure-active-directory/6-examine-azure-domain-services",
            "waf": "Reliability"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "1cf0b8da-70bd-44d0-94af-8d99cfc89ae1",
            "link": "https://learn.microsoft.com/azure/active-directory/reports-monitoring/concept-activity-logs-azure-monitor",
            "service": "Entra",
            "severity": "Medium",
            "text": "Integrate Microsoft Entra ID logs with the platform-central Azure Monitor. Azure Monitor allows for a single source of truth around log and monitoring data in Azure, giving organizations a cloud native options to meet requirements around log collection and retention.",
            "training": "https://learn.microsoft.com/entra/identity/monitoring-health/howto-integrate-activity-logs-with-azure-monitor-logs",
            "waf": "Reliability"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "984a859c-773e-47d2-9162-3a765a917e1f",
            "link": "https://learn.microsoft.com/azure/active-directory/roles/security-emergency-access",
            "service": "Entra",
            "severity": "High",
            "text": "Implement an emergency access or break-glass accounts to prevent tenant-wide account lockout. MFA will be turned on by default for all users in Oct 2024. We recommend updating these accounts to use passkey (FIDO2) or configure certificate-based authentication for MFA. ",
            "training": "https://learn.microsoft.com/entra/identity/role-based-access-control/security-emergency-access#exclude-at-least-one-account-from-conditional-access-policies",
            "waf": "Reliability"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "35037e68-9349-4c15-b371-228514f4cdff",
            "link": "https://learn.microsoft.com/azure/active-directory/roles/best-practices",
            "service": "Entra",
            "severity": "Medium",
            "text": "Do not use on-premises synced accounts for Microsoft Entra ID role assignments, unless you have a scenario that specifically requires it.",
            "training": "https://learn.microsoft.com/learn/modules/design-identity-security-strategy/",
            "waf": "Reliability"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "d5d1e4e6-1465-48d3-958f-d77249b82111",
            "link": "https://learn.microsoft.com/azure/active-directory/app-proxy/application-proxy",
            "service": "Entra",
            "severity": "Medium",
            "text": "When using Microsoft Entra ID Application Proxy to give remote users access to applications, manage it as a Platform resource as you can only have one instance per tenant.",
            "training": "https://learn.microsoft.com/learn/paths/implement-applications-external-access-azure-ad/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Network/virtualNetworks",
            "checklist": "Azure Landing Zone Review",
            "guid": "e8bbac75-7155-49ab-a153-e8908ae28c84",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/enterprise-scale/network-topology-and-connectivity",
            "service": "VNet",
            "severity": "Medium",
            "text": "Use a hub-and-spoke network topology for network scenarios that require maximum flexibility.",
            "training": "https://learn.microsoft.com/learn/paths/architect-network-infrastructure/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Network/virtualNetworks",
            "checklist": "Azure Landing Zone Review",
            "guid": "7dd61623-a364-4a90-9eca-e48ebd54cd7d",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/traditional-azure-networking-topology",
            "service": "VNet",
            "severity": "High",
            "text": "Deploy shared networking services, including ExpressRoute gateways, VPN gateways, and Azure Firewall or partner NVAs in the central-hub virtual network. If necessary, also deploy DNS services.",
            "training": "https://learn.microsoft.com/training/modules/hub-and-spoke-network-architecture/",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Network/virtualNetworks",
            "checklist": "Azure Landing Zone Review",
            "guid": "143b16c3-1d7a-4a9b-9470-4489a8042d88",
            "link": "https://learn.microsoft.com/azure/ddos-protection/ddos-protection-overview",
            "service": "VNet",
            "severity": "High",
            "text": "Use a DDoS Network or IP protection plan for all public IP addresses in application landing zones.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "Azure Landing Zone Review",
            "guid": "e2e8abac-3571-4559-ab91-53e89f89dc7b",
            "link": "https://learn.microsoft.com/azure/architecture/reference-architectures/dmz/nva-ha",
            "service": "NVA",
            "severity": "Medium",
            "text": "When deploying partner networking technologies or NVAs, follow the partner vendor's guidance.",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "guid": "ce463dbb-bc8a-4c2a-aebc-92a43da1dae2",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-howto-coexist-resource-manager#to-enable-transit-routing-between-expressroute-and-azure-vpn",
            "service": "ExpressRoute",
            "severity": "Low",
            "text": "If you need transit between ExpressRoute and VPN gateways in hub and spoke scenarios, use Azure Route Server.",
            "training": "https://learn.microsoft.com/training/modules/intro-to-azure-route-server/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Network/virtualHubs",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,subnets=properties.subnets | mv-expand subnets | project id, subnetName = subnets.name, subnetPrefix = subnets.properties.addressPrefix | extend subnetPrefixLength = split(subnetPrefix, '/')[1] | where subnetName == 'RouteServerSubnet' | extend compliant = (subnetPrefixLength <= 27) | distinct id, compliant",
            "guid": "91b9d7d5-91e1-4dcb-8f1f-fa7e465646cc",
            "link": "https://learn.microsoft.com/azure/route-server/quickstart-configure-route-server-portal#create-a-route-server-1",
            "service": "ARS",
            "severity": "Low",
            "text": "If using Route Server, use a /27 prefix for the Route Server subnet.",
            "training": "https://learn.microsoft.com/training/modules/intro-to-azure-route-server/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Network/virtualNetworks",
            "checklist": "Azure Landing Zone Review",
            "guid": "cc881471-607c-41cc-a0e6-14658dd558f9",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-networks-faq#can-i-create-a-peering-connection-to-a-vnet-in-a-different-region",
            "service": "VNet",
            "severity": "Medium",
            "text": "For network architectures with multiple hub-and-spoke topologies across Azure regions, use global virtual network peerings between the hub VNets to connect the regions to each other.",
            "training": "https://learn.microsoft.com/learn/paths/azure-administrator-manage-virtual-networks/",
            "waf": "Performance"
        },
        {
            "arm-service": "Microsoft.Network/virtualNetworks",
            "checklist": "Azure Landing Zone Review",
            "guid": "4722d929-c1b1-4cd6-81f5-4b29bade39ad",
            "link": "https://learn.microsoft.com/azure/azure-monitor/insights/network-insights-overview",
            "service": "VNet",
            "severity": "Medium",
            "text": "Use Azure Monitor for Networks to monitor the end-to-end state of the networks on Azure.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-network-monitoring/",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.Network/virtualNetworks",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type == 'microsoft.network/virtualnetworks' | mvexpand properties.virtualNetworkPeerings | summarize peeringcount = count() by id | extend compliant = (peeringcount < 450) | distinct id,compliant",
            "guid": "0e7c28ec-9366-4572-83b0-f4664b1d944a",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits?toc=/azure/virtual-network/toc.json#azure-resource-manager-virtual-networking-limits",
            "service": "VNet",
            "severity": "Medium",
            "text": "If you have more than 400 spoke networks in a region, deploy an additional hub to bypass VNet peering limits (500) and the maximum number of prefixes that can be advertised via ExpressRoute (1000).",
            "training": "https://learn.microsoft.com/training/modules/hub-and-spoke-network-architecture/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Network/virtualNetworks",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/routetables' | mvexpand properties.routes | summarize routeCount = count() by id | extend compliant = (routeCount < 360) | distinct id,compliant",
            "guid": "3d457936-e9b7-41eb-bdff-314b26450b12",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits?toc=/azure/virtual-network/toc.json#azure-resource-manager-virtual-networking-limits",
            "service": "VNet",
            "severity": "Medium",
            "text": "Limit the number of routes per route table to 400.",
            "training": "https://learn.microsoft.com/training/modules/hub-and-spoke-network-architecture/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Network/virtualNetworks",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type == 'microsoft.network/virtualnetworks' | mvexpand properties.virtualNetworkPeerings | project id, peeringName=properties_virtualNetworkPeerings.name, compliant = (properties_virtualNetworkPeerings.properties.allowVirtualNetworkAccess == True)",
            "guid": "c76cb5a2-abe2-11ed-afa1-0242ac120002",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-network-manage-peering",
            "service": "VNet",
            "severity": "High",
            "text": "Use the setting 'Allow traffic to remote virtual network' when configuring VNet peerings.",
            "training": "https://learn.microsoft.com/training/modules/hub-and-spoke-network-architecture/",
            "waf": "Reliability"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type == 'microsoft.network/loadbalancers' | where tolower(sku.name) != 'basic' | mv-expand feIPconfigs = properties.frontendIPConfigurations | extend feConfigName = (feIPconfigs.name), PrivateSubnetId = toupper(feIPconfigs.properties.subnet.id), PrivateIPZones = feIPconfigs.zones, PIPid = toupper(feIPconfigs.properties.publicIPAddress.id), JoinID = toupper(id) | where isnotempty(PrivateSubnetId) | where isnull(PrivateIPZones) or array_length(PrivateIPZones) < 2 | project name, feConfigName, id | union (resources | where type == 'microsoft.network/loadbalancers' | where tolower(sku.name) != 'basic' | mv-expand feIPconfigs = properties.frontendIPConfigurations | extend feConfigName = (feIPconfigs.name), PIPid = toupper(feIPconfigs.properties.publicIPAddress.id), JoinID = toupper(id) | where isnotempty(PIPid) | join kind=innerunique ( resources | where type == 'microsoft.network/publicipaddresses' | where isnull(zones) or array_length(zones) < 2 | extend LBid = toupper(substring(properties.ipConfiguration.id, 0, indexof(properties.ipConfiguration.id, '/frontendIPConfigurations'))), InnerID = toupper(id) ) on $left.PIPid == $right.InnerID) | project name, id, tags, param1='Zones: No Zone or Zonal', param2=strcat('Frontend IP Configuration:', ' ', feConfigName)",
            "guid": "9dcd6250-9c4a-4382-aa9b-5b84c64fc1fe",
            "link": "https://learn.microsoft.com/en-us/azure/reliability/reliability-load-balancer?tabs=graph#zone-redundant",
            "service": "Load Balancers",
            "severity": "High",
            "text": "Use Standard Load Balancer SKU with a zone-redundant deployment, Selecting Standard SKU Load Balancer enhances reliability through availability zones and zone resiliency, ensuring deployments withstand zone and region failures. Unlike Basic, it supports global load balancing and offers an SLA.",
            "waf": "Reliability"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type =~ 'Microsoft.Network/loadBalancers' | extend bep = properties.backendAddressPools | extend BackEndPools = array_length(bep) | where BackEndPools == 0 | project name, id, Param1='backendPools', Param2=toint(0), tags | union (resources | where type =~ 'Microsoft.Network/loadBalancers' | where sku.name == 'Standard' | extend bep = properties.backendAddressPools | extend BackEndPools = toint(array_length(bep)) | mv-expand bip = properties.backendAddressPools | extend BackendAddresses = array_length(bip.properties.loadBalancerBackendAddresses) | where toint(BackendAddresses) <= 1 | project name, id, tags, Param1='backendAddresses', Param2=toint(BackendAddresses)) | union ( resources | where type =~ 'Microsoft.Network/loadBalancers' | where sku.name == 'Basic' | mv-expand properties.backendAddressPools | extend backendPoolId = properties_backendAddressPools.id | project id, name, tags, tostring(backendPoolId), Param1='BackEndPools' | join kind = leftouter ( resources | where type =~ 'Microsoft.Network/networkInterfaces' | mv-expand properties.ipConfigurations | mv-expand properties_ipConfigurations.properties.loadBalancerBackendAddressPools | extend backendPoolId = tostring(properties_ipConfigurations_properties_loadBalancerBackendAddressPools.id) | summarize poolMembers = count() by backendPoolId | project tostring(backendPoolId), poolMembers ) on backendPoolId | where toint(poolMembers) <= 1 | extend BackendAddresses = poolMembers | project id, name, tags, Param1='backendAddresses', Param2=toint(BackendAddresses))",
            "guid": "48682fb1-1e86-4458-a686-518ebd47393d",
            "link": "https://learn.microsoft.com/en-us/azure/reliability/reliability-load-balancer?tabs=graph#zone-redundant",
            "service": "Load Balancers",
            "severity": "High",
            "text": "Ensure load balancer backend pool(s) contains at least two instances, Deploying Azure Load Balancers with at least two instances in the backend prevents a single point of failure and supports scalability.",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "guid": "de0d5973-cd4c-4d21-a088-137f5e6c4cfd",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-howto-macsec",
            "service": "ExpressRoute",
            "severity": "Medium",
            "text": "When you're using ExpressRoute Direct, configure MACsec in order to encrypt traffic at the layer-two level between the organization's routers and MSEE. The diagram shows this encryption in flow.",
            "training": "https://learn.microsoft.com/training/modules/design-implement-azure-expressroute/",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "guid": "ed301d6e-872e-452e-9611-cc58b5a4b151",
            "link": "https://learn.microsoft.com/azure/vpn-gateway/site-to-site-vpn-private-peering",
            "service": "ExpressRoute",
            "severity": "Medium",
            "text": "For scenarios where MACsec isn't an option (for example, not using ExpressRoute Direct), use a VPN gateway to establish IPsec tunnels over ExpressRoute private peering.",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "guid": "558fd772-49b8-4211-82df-27ee412e7f98",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-ip-addressing",
            "service": "ExpressRoute",
            "severity": "High",
            "text": "Ensure no overlapping IP address spaces across Azure regions and on-premises locations are used.",
            "training": "https://learn.microsoft.com/learn/paths/architect-network-infrastructure/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Network/virtualNetworks",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type == 'microsoft.network/virtualnetworks' | extend addressSpace = todynamic(properties.addressSpace) | extend addressPrefix = todynamic(properties.addressSpace.addressPrefixes) | mvexpand addressSpace | mvexpand addressPrefix | project name, id, location, resourceGroup, subscriptionId, cidr = addressPrefix | extend compliant = (cidr matches regex @'^(10\\\\.|172\\\\.(1[6-9]|2[0-9]|3[01])\\\\.|192\\\\.168\\\\.)')  | project id, compliant, cidr",
            "guid": "3f630472-2dd6-49c5-a5c2-622f54b69bad",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-ip-addressing",
            "service": "VNet",
            "severity": "Medium",
            "text": "Use IP addresses from the address allocation ranges for private internets (RFC 1918).",
            "training": "https://learn.microsoft.com/learn/paths/architect-network-infrastructure/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Network/virtualNetworks",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type == 'microsoft.network/virtualnetworks' | extend addressSpace = todynamic(properties.addressSpace) | extend addressPrefix = todynamic(properties.addressSpace.addressPrefixes) | mvexpand addressSpace | mvexpand addressPrefix | extend addressMask = split(addressPrefix,'/')[1] | extend compliant = addressMask > 16 | project name, id, subscriptionId, resourceGroup, addressPrefix, compliant",
            "guid": "33aad5e8-c68e-41d7-9667-313b4f5664b5",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-ip-addressing",
            "service": "VNet",
            "severity": "High",
            "text": "Ensure that IP address space isn't wasted, don't create unnecessarily large virtual networks (for example /16).",
            "training": "https://learn.microsoft.com/learn/paths/architect-network-infrastructure/",
            "waf": "Performance"
        },
        {
            "arm-service": "Microsoft.Network/virtualNetworks",
            "checklist": "Azure Landing Zone Review",
            "guid": "f348ef25-4c27-4d42-b8bb-ac7571559ab9",
            "link": "https://learn.microsoft.com/azure/site-recovery/concepts-on-premises-to-azure-networking#retain-ip-addresses",
            "service": "VNet",
            "severity": "High",
            "text": "Do not use overlapping IP address ranges for production and disaster recovery sites.",
            "training": "https://learn.microsoft.com/learn/paths/az-104-manage-virtual-networks/",
            "waf": "Reliability"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "graph": "Resources | where type =~ 'Microsoft.Network/publicIPAddresses' and sku.tier =~ 'Regional' | where isempty(zones) or array_length(zones) <= 1 | extend az = case(isempty(zones), 'Non-zonal', array_length(zones) <= 1, strcat('Zonal (', strcat_array(zones, ','), ')'), zones) | project name, id, tags, param1 = strcat('sku: ', sku.name), param2 = strcat('availabilityZone: ', az)",
            "guid": "0c47f486-656d-4699-8c30-edef5b8a93c4",
            "link": "https://learn.microsoft.com/azure/virtual-network/ip-services/public-ip-addresses#availability-zone",
            "service": "Public IP Addresses",
            "severity": "High",
            "text": "Use Standard SKU and Zone-Redundant IPs when applicable, Public IP addresses in Azure can be of standard SKU, available as non-zonal, zonal, or zone-redundant. Zone-redundant IPs are accessible across all zones, resisting any single zone failure, thereby providing higher resilience. ",
            "training": "https://learn.microsoft.com/en-gb/training/modules/configure-virtual-networks/6-create-public-ip-addressing",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Network/dnsZones",
            "checklist": "Azure Landing Zone Review",
            "guid": "153e8908-ae28-4c84-a33b-6b7808b9fe5c",
            "link": "https://learn.microsoft.com/azure/dns/private-dns-getstarted-portal",
            "service": "DNS",
            "severity": "Medium",
            "text": "For environments where name resolution in Azure is all that's required, use Azure Private DNS for resolution with a delegated zone for name resolution (such as 'azure.contoso.com').",
            "training": "https://learn.microsoft.com/learn/paths/az-104-manage-virtual-networks/",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.Network/dnsZones",
            "checklist": "Azure Landing Zone Review",
            "guid": "41049d40-3a92-43c3-974d-00018ac6a9e0",
            "link": "https://learn.microsoft.com/azure/dns/dns-private-resolver-overview",
            "service": "DNS",
            "severity": "Medium",
            "text": "For environments where name resolution across Azure and on-premises is required and there is no existing enterprise DNS service like Active Directory, use Azure DNS Private Resolver to route DNS requests to Azure or to on-premises DNS servers.",
            "training": "https://learn.microsoft.com/training/modules/intro-to-azure-dns-private-resolver/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Network/dnsZones",
            "checklist": "Azure Landing Zone Review",
            "guid": "1e6a83de-5de3-42c1-a924-81607d5d1e4e",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-networks-name-resolution-for-vms-and-role-instances",
            "service": "DNS",
            "severity": "Low",
            "text": "Special workloads that require and deploy their own DNS (such as Red Hat OpenShift) should use their preferred DNS solution.",
            "training": "https://learn.microsoft.com/training/courses/az-700t00",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.Network/dnsZones",
            "checklist": "Azure Landing Zone Review",
            "guid": "614658d3-558f-4d77-849b-821112df27ee",
            "link": "https://learn.microsoft.com/azure/dns/private-dns-autoregistration",
            "service": "DNS",
            "severity": "High",
            "text": "Enable auto-registration for Azure DNS to automatically manage the lifecycle of the DNS records for the virtual machines deployed within a virtual network.",
            "training": "https://learn.microsoft.com/learn/paths/az-104-manage-virtual-networks/",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.Network/dnsZones",
            "checklist": "Azure Landing Zone Review",
            "guid": "18c80eb0-582a-4198-bf5c-d8800b2d263b",
            "link": "https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/ready/azure-best-practices/private-link-and-dns-integration-at-scale#private-link-and-dns-integration-in-hub-and-spoke-network-architectures",
            "service": "DNS",
            "severity": "Medium",
            "text": "Implement a plan for managing DNS resolution between multiple Azure regions and when services fail over to another region",
            "training": "https://learn.microsoft.com/learn/paths/az-104-manage-virtual-networks/",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/bastionHosts",
            "checklist": "Azure Landing Zone Review",
            "guid": "ee1ac551-c4d5-46cf-b035-d0a3c50d87ad",
            "link": "https://learn.microsoft.com/azure/bastion/bastion-overview",
            "service": "Bastion",
            "severity": "Medium",
            "text": "Use Azure Bastion to securely connect to your network.",
            "training": "https://learn.microsoft.com/training/modules/intro-to-azure-bastion/",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/bastionHosts",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,subnets=properties.subnets | mv-expand subnets | project id, subnetName = subnets.name, subnetPrefix = subnets.properties.addressPrefix | extend subnetPrefixLength = split(subnetPrefix, '/')[1] | where subnetName == 'AzureBastionSubnet' | extend compliant = (subnetPrefixLength <= 26) | distinct id, compliant",
            "guid": "6eab9eb6-762b-485e-8ea8-15aa5dba0bd0",
            "link": "https://learn.microsoft.com/azure/bastion/bastion-faq#subnet",
            "service": "Bastion",
            "severity": "Medium",
            "text": "Use Azure Bastion in a subnet /26 or larger.",
            "training": "https://learn.microsoft.com/training/modules/intro-to-azure-bastion/",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/frontdoorwebApplicationFirewalls",
            "checklist": "Azure Landing Zone Review",
            "guid": "1d7aa9b6-4704-4489-a804-2d88e79d17b7",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/afds-overview",
            "service": "WAF",
            "severity": "Medium",
            "text": "Use Azure Front Door and WAF policies to provide global protection across Azure regions for inbound HTTP/S connections to a landing zone.",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/frontdoorwebApplicationFirewalls",
            "checklist": "Azure Landing Zone Review",
            "guid": "3b22a5a6-7e7a-48ed-9b30-e38c3f29812b",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "service": "WAF",
            "severity": "Low",
            "text": "When using Azure Front Door and Azure Application Gateway to help protect HTTP/S apps, use WAF policies in Azure Front Door. Lock down Azure Application Gateway to receive traffic only from Azure Front Door.",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/frontdoorwebApplicationFirewalls",
            "checklist": "Azure Landing Zone Review",
            "guid": "2363cefe-179b-4599-be0d-5973cd4cd21b",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "service": "WAF",
            "severity": "High",
            "text": "When WAFs and other reverse proxies are required for inbound HTTP/S connections, deploy them within a landing-zone virtual network and together with the apps that they're protecting and exposing to the internet.",
            "training": "https://learn.microsoft.com/learn/paths/architect-network-infrastructure/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Network/virtualNetworks",
            "checklist": "Azure Landing Zone Review",
            "guid": "088137f5-e6c4-4cfd-9e50-4547c2447ec6",
            "link": "https://learn.microsoft.com/azure/ddos-protection/ddos-protection-reference-architectures",
            "service": "VNet",
            "severity": "High",
            "text": "Use Azure DDoS Network or IP Protection plans to help protect Public IP Addresses endpoints within the virtual networks.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Network/virtualNetworks",
            "checklist": "Azure Landing Zone Review",
            "guid": "b034c01e-110b-463a-b36e-e3346e57f225",
            "link": "https://learn.microsoft.com/azure/virtual-network/ip-services/default-outbound-access",
            "service": "VNet",
            "severity": "High",
            "text": "Plan for how to manage your network outbound traffic configuration and strategy before the upcoming breaking change. On September 30, 2025, default outbound access for new deployments will be retired and only explicit access configurations will be allowed.",
            "training": "https://learn.microsoft.com/training/modules/configure-virtual-networks/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Network/virtualNetworks",
            "checklist": "Azure Landing Zone Review",
            "guid": "b1c82a3f-2320-4dfa-8972-7ae4823c8930",
            "link": "https://learn.microsoft.com/azure/ddos-protection/ddos-protection-reference-architectures",
            "service": "VNet",
            "severity": "High",
            "text": "Add diagnostic settings to save DDoS related logs for all the protected public IP addresses (DDoS IP or Network Protection).",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Authorization/policyDefinitions",
            "checklist": "Azure Landing Zone Review",
            "guid": "3c5a808d-c695-4c14-a63c-c7ab7a510e41",
            "link": "https://github.com/Azure/Enterprise-Scale/wiki/ALZ-Policies#corp",
            "service": "Policy",
            "severity": "High",
            "text": "Ensure there is a policy assignment to deny Public IP addresses directly tied to Virtual Machines.  Use exclusions if public IPs are needed on specific VMs.",
            "training": "https://learn.microsoft.com/training/modules/configure-azure-policy/",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "guid": "359c373e-7dd6-4162-9a36-4a907ecae48e",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/connectivity-to-azure",
            "service": "ExpressRoute",
            "severity": "Medium",
            "text": "Use ExpressRoute as the primary connection to Azure.  Use VPNs as a source of backup connectivity.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Performance"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "description": "You can use AS-path prepending and connection weights to influence traffic from Azure to on-premises, and the full range of BGP attributes in your own routers to influence traffic from on-premises to Azure.",
            "guid": "f29812b2-363c-4efe-879b-599de0d5973c",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-routing",
            "service": "ExpressRoute",
            "severity": "Medium",
            "text": "When you use multiple ExpressRoute circuits or multiple on-prem locations, use BGP attributes to optimize routing.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources| where type == 'microsoft.network/virtualnetworkgateways'| where properties.gatewayType =~ 'vpn' or properties.gatewayType == 'ExpressRoute'| extend SKUName = properties.sku.name, SKUTier = properties.sku.tier, Type = properties.gatewayType| extend compliant = SKUTier !in ('Basic', 'Standard')| project name, id, subscriptionId, resourceGroup, compliant",
            "guid": "d4cd21b0-8813-47f5-b6c4-cfd3e504547c",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-about-virtual-network-gateways?source=recommendations#gwsku",
            "service": "ExpressRoute",
            "severity": "Medium",
            "text": "Select the right SKU for the ExpressRoute/VPN gateways based on bandwidth and performance requirements.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Performance"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/expressroutecircuits' | extend compliant = (tolower(sku.family) == 'metereddata' or tolower(sku.tier) == 'local') | distinct id,compliant",
            "guid": "7025b442-f6e9-4af6-b11f-c9574916016f",
            "link": "https://learn.microsoft.com/azure/expressroute/plan-manage-cost",
            "service": "ExpressRoute",
            "severity": "High",
            "text": "Ensure that you're using unlimited-data ExpressRoute circuits only if you reach the bandwidth that justifies their cost.",
            "training": "https://learn.microsoft.com/training/modules/design-implement-azure-expressroute/",
            "waf": "Cost"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/connections' | where properties.connectionType == 'ExpressRoute' | project id, gwid=tostring(properties.virtualNetworkGateway1.id), circuitid=tostring(properties.peer.id) | join (resources | where type=='microsoft.network/expressroutecircuits' | project circuitid=tostring(id), circuitsku=sku.tier) on circuitid | project id=gwid, compliant = (circuitsku == 'Local') | summarize compliant=max(compliant) by id",
            "guid": "f4e7926a-ec35-476e-a412-5dd17136bd62",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-faqs#expressroute-local",
            "service": "ExpressRoute",
            "severity": "High",
            "text": "Leverage the Local SKU of ExpressRoute to reduce the cost of your circuits, if your circuit peering location supports your Azure regions for the Local SKU.",
            "training": "https://learn.microsoft.com/training/modules/design-implement-azure-expressroute/",
            "waf": "Cost"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources| where type == 'microsoft.network/virtualnetworkgateways'| where properties.gatewayType =~ 'vpn' or properties.gatewayType == 'ExpressRoute'| extend SKUName = properties.sku.name, SKUTier = properties.sku.tier, Type = properties.gatewayType| extend compliant = SKUTier contains 'AZ'| project name, id, subscriptionId, resourceGroup, Type, compliant",
            "guid": "2447ec66-138a-4720-8f1c-e16ed301d6e8",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-about-virtual-network-gateways",
            "service": "ExpressRoute",
            "severity": "Medium",
            "text": "Deploy a zone-redundant ExpressRoute gateway in the supported Azure regions.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "guid": "72e52e36-11cc-458b-9a4b-1511e43a58a9",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/connectivity-to-azure",
            "service": "ExpressRoute",
            "severity": "Medium",
            "text": "For scenarios that require bandwidth higher than 10 Gbps or dedicated 10/100-Gbps ports, use ExpressRoute Direct.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Performance"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "guid": "c2299c4d-7b57-4d0c-9555-62f2b3e4563a",
            "link": "https://learn.microsoft.com/azure/expressroute/about-fastpath",
            "service": "ExpressRoute",
            "severity": "Medium",
            "text": "When low latency is required, or throughput from on-premises to Azure must be greater than 10 Gbps, enable FastPath to bypass the ExpressRoute gateway from the data path.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Performance"
        },
        {
            "arm-service": "microsoft.network/virtualNetworkGateways",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/virtualnetworkgateways' | where properties.gatewayType == 'Vpn' | extend compliant = (tolower(properties.sku.name) contains 'az') | distinct id, compliant",
            "guid": "4d873974-8b66-42d6-b15f-512a65498f6d",
            "link": "https://learn.microsoft.com/azure/vpn-gateway/create-zone-redundant-vnet-gateway",
            "service": "VPN",
            "severity": "Medium",
            "text": "Use zone-redundant VPN gateways to connect branches or remote locations to Azure (where available).",
            "training": "https://learn.microsoft.com/training/modules/intro-to-azure-vpn-gateway/",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/virtualNetworkGateways",
            "checklist": "Azure Landing Zone Review",
            "guid": "45866df8-cf85-4ca9-bbe2-65ec1478919e",
            "link": "https://learn.microsoft.com/azure/vpn-gateway/vpn-gateway-highlyavailable",
            "service": "VPN",
            "severity": "Medium",
            "text": "Use redundant VPN appliances on-premises (active/active or active/passive).",
            "training": "https://learn.microsoft.com/training/modules/intro-to-azure-vpn-gateway/",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "guid": "718cb437-b060-2589-8856-2e93a5c6633b",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-erdirect-about",
            "service": "ExpressRoute",
            "severity": "High",
            "text": "If using ExpressRoute Direct, consider using ExpressRoute Local circuits to the local Azure regions to save costs.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Cost"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "guid": "8042d88e-79d1-47b7-9b22-a5a67e7a8ed4",
            "link": "https://learn.microsoft.com/azure/architecture/framework/services/networking/expressroute/reliability",
            "service": "ExpressRoute",
            "severity": "Medium",
            "text": "When traffic isolation or dedicated bandwidth is required, such as for separating production and nonproduction environments, use different ExpressRoute circuits. It will help you ensure isolated routing domains and alleviate noisy-neighbor risks.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "guid": "b30e38c3-f298-412b-8363-cefe179b599d",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-monitoring-metrics-alerts",
            "service": "ExpressRoute",
            "severity": "Medium",
            "text": "Monitor ExpressRoute availability and utilization using built-in Express Route Insights.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "guid": "5bf68dc9-325e-4873-bf88-f8214ef2e5d2",
            "link": "https://learn.microsoft.com/azure/expressroute/how-to-configure-connection-monitor",
            "service": "ExpressRoute",
            "severity": "Medium",
            "text": "Use Connection Monitor for connectivity monitoring across the network, especially between on-premises and Azure.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/connections' | where properties.connectionType == 'ExpressRoute' | project cxId=id, gwId=tostring(properties.virtualNetworkGateway1.id), circuitId=tostring(properties.peer.id) | join (resources | where type=='microsoft.network/expressroutecircuits' | project circuitId=tostring(id), circuitLocation=tostring(properties.serviceProviderProperties.peeringLocation)) on circuitId | distinct gwId, circuitLocation | summarize countErLocations=count() by id=gwId | extend compliant = (countErLocations >= 2)",
            "guid": "e0d5973c-d4cd-421b-8881-37f5e6c4cfd3",
            "link": "https://learn.microsoft.com/azure/expressroute/designing-for-disaster-recovery-with-expressroute-privatepeering#need-for-redundant-connectivity-solution",
            "service": "ExpressRoute",
            "severity": "Medium",
            "text": "Use ExpressRoute circuits from different peering locations for redundancy.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "guid": "cf3fe65c-fec0-495a-8edc-9675200f2add",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-howto-coexist-resource-manager",
            "service": "ExpressRoute",
            "severity": "Medium",
            "text": "Use site-to-site VPN as failover of ExpressRoute, if only using a single ExpressRoute circuit.",
            "training": "https://learn.microsoft.com/training/modules/design-implement-azure-expressroute/",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,resourceGroup,name,subnets=properties.subnets | mv-expand subnets | project id,resourceGroup,name,subnetName=tostring(subnets.name),routeTableId=tostring(subnets.properties.routeTable.id) | where subnetName == 'GatewaySubnet' | join kind=leftouter (Resources | where type == 'microsoft.network/routetables' | project routeTableName=name,routeTableId=id, disableBgpRoutePropagation=properties.disableBgpRoutePropagation) on routeTableId | project id,compliant = (disableBgpRoutePropagation == False or isnull(disableBgpRoutePropagation))",
            "guid": "72105cc8-aaea-4ee1-8c7a-ad25977afcaf",
            "link": "https://learn.microsoft.com/azure/vpn-gateway/vpn-gateway-about-vpn-gateway-settings#gwsub",
            "service": "ExpressRoute",
            "severity": "High",
            "text": "If you are using a route table in the GatewaySubnet, make sure that gateway routes are propagated.",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "guid": "d581a947-69a2-4783-942e-9df3664324c8",
            "link": "https://learn.microsoft.com/azure/expressroute/designing-for-high-availability-with-expressroute#active-active-connections",
            "service": "ExpressRoute",
            "severity": "High",
            "text": "If using ExpressRoute, your on-premises routing should be dynamic: in the event of a connection failure it should converge to the remaining connection of the circuit. Load should be shared across both connections ideally as active/active, although active/passive is supported too.",
            "training": "https://learn.microsoft.com/training/modules/design-implement-azure-expressroute/",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "guid": "b258f058-b9f6-46cd-b28d-990106f0c3f8",
            "link": "https://learn.microsoft.com/azure/expressroute/designing-for-high-availability-with-expressroute",
            "service": "ExpressRoute",
            "severity": "Medium",
            "text": "Ensure the two physical links of your ExpressRoute circuit are connected to two distinct edge devices in your network.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "guid": "fe2a1b53-6fbd-4c67-b58a-85d7c7a0afcb",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-bfd",
            "service": "ExpressRoute",
            "severity": "Medium",
            "text": "Ensure Bidirectional Forwarding Detection (BFD) is enabled and configured on customer or provider edge routing devices.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "guid": "669b215a-ce43-4371-8f6f-11047f6490f1",
            "link": "https://learn.microsoft.com/azure/expressroute/designing-for-disaster-recovery-with-expressroute-privatepeering",
            "service": "ExpressRoute",
            "severity": "High",
            "text": "Connect the ExpressRoute Gateway to two or more circuits from different peering locations for higher resiliency.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "guid": "3f79ed00-203b-4c95-9efd-691505f5a1f9",
            "link": "https://learn.microsoft.com/azure/vpn-gateway/vpn-gateway-howto-setup-alerts-virtual-network-gateway-log",
            "service": "ExpressRoute",
            "severity": "Medium",
            "text": "Configure diagnostic logs and alerts for ExpressRoute virtual network gateway.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "guid": "5234c93f-b651-41dd-80c1-234177b91ced",
            "link": "https://learn.microsoft.com/azure/expressroute/virtual-network-connectivity-guidance",
            "service": "ExpressRoute",
            "severity": "Medium",
            "text": "Do not use ExpressRoute circuits for VNet-to-VNet communication.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Performance"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "8ac6a9e0-1e6a-483d-b5de-32c199248160",
            "link": "https://learn.microsoft.com/azure/virtual-wan/virtual-wan-about",
            "service": "N/A",
            "severity": "Low",
            "text": "Do not send Azure traffic to hybrid locations for inspection.  Instead, follow the principle 'traffic in Azure stays in Azure' so that communication across resources in Azure occurs via the Microsoft backbone network.",
            "waf": "Performance"
        },
        {
            "arm-service": "Microsoft.Network/azureFirewalls",
            "checklist": "Azure Landing Zone Review",
            "guid": "e6c4cfd3-e504-4547-a244-7ec66138a720",
            "link": "https://learn.microsoft.com/azure/firewall/overview",
            "service": "Firewall",
            "severity": "High",
            "text": "Use Azure Firewall to govern Azure outbound traffic to the internet, non-HTTP/S inbound connections, and East/West traffic filtering (if the organization requires it).",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Network/azureFirewalls",
            "checklist": "Azure Landing Zone Review",
            "guid": "5a4b1511-e43a-458a-ac22-99c4d7b57d0c",
            "link": "https://learn.microsoft.com/azure/firewall-manager/policy-overview",
            "service": "Firewall",
            "severity": "Medium",
            "text": "Create a global Azure Firewall policy to govern security posture across the global network environment and assign it to all Azure Firewall instances. Allow for granular policies to meet requirements of specific regions by delegating incremental firewall policies to local security teams via Azure role-based access control.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Network/azureFirewalls",
            "checklist": "Azure Landing Zone Review",
            "guid": "655562f2-b3e4-4563-a4d8-739748b662d6",
            "link": "https://learn.microsoft.com/azure/firewall-manager/deploy-trusted-security-partner",
            "service": "Firewall",
            "severity": "Low",
            "text": "Configure supported partner SaaS security providers within Firewall Manager if the organization wants to use such solutions to help protect outbound connections.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Network/azureFirewalls",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/firewallpolicies' | extend compliant = (properties.dnsSettings.enableProxy == true) | distinct id,compliant",
            "guid": "14d99880-2f88-47e8-a134-62a7d85c94af",
            "link": "https://learn.microsoft.com/azure/firewall/fqdn-filtering-network-rules",
            "service": "Firewall",
            "severity": "High",
            "text": "Use application rules to filter outbound traffic on destination host name for supported protocols.  Use FQDN-based network rules and Azure Firewall with DNS proxy to filter egress traffic to the Internet over other protocols.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Network/azureFirewalls",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/firewallpolicies' | extend compliant = (properties.sku.tier == 'Premium') | distinct id,compliant",
            "guid": "c10d51ef-f999-455d-bba0-5c90ece07447",
            "link": "https://learn.microsoft.com/azure/firewall/premium-features",
            "service": "Firewall",
            "severity": "High",
            "text": "Use Azure Firewall Premium to enable additional security features.",
            "training": "https://learn.microsoft.com/training/modules/introduction-azure-firewall/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Network/azureFirewalls",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/firewallpolicies' | extend compliant = (properties.threatIntelMode == 'Deny') | distinct id,compliant",
            "guid": "e9c8f584-6d5e-473b-8dc5-acc9fbaab4e3",
            "link": "https://learn.microsoft.com/azure/firewall/premium-features#idps-signature-rules",
            "service": "Firewall",
            "severity": "High",
            "text": "Configure Azure Firewall Threat Intelligence mode to Alert and Deny for additional protection.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Network/azureFirewalls",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/firewallpolicies' | extend compliant = (properties.intrusionDetection.mode == 'Deny') | project id, compliant",
            "guid": "b9d0dff5-bdd4-4cd8-88ed-5811610b2b2c",
            "link": "https://learn.microsoft.com/azure/firewall/premium-features#idps",
            "service": "Firewall",
            "severity": "High",
            "text": "Configure Azure Firewall IDPS mode to Deny for additional protection.",
            "training": "https://learn.microsoft.com/training/modules/introduction-azure-firewall/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Network/azureFirewalls",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,resourceGroup,name,subnets=properties.subnets | mv-expand subnets | project id,name,subnetId=tostring(subnets.id), subnetName=tostring(subnets.name),subnetRT=subnets.properties.routeTable.id | where not (subnetName in ('GatewaySubnet', 'AzureFirewallSubnet', 'RouteServerSubnet', 'AzureBastionSubnet')) | extend hasRT = isnotnull(subnetRT) | distinct id, hasRT, subnetId | join kind=fullouter (resources | where type == 'microsoft.network/virtualnetworks' | mvexpand properties.virtualNetworkPeerings | extend isVWAN=(tolower(split(properties_virtualNetworkPeerings.name, '_')[0]) == 'remotevnettohubpeering') | mv-expand properties.subnets | project id, isVWAN, name, subnetId=tostring(properties_subnets.id), subnetName=tostring(properties_subnets.name) | summarize PeeredToVWAN=max(isVWAN) by id, subnetId | project id, subnetId, isVWANpeer = (PeeredToVWAN == true)) on subnetId | project id=iff(isnotempty(id), id, id1), subnetId=iff(isnotempty(subnetId), subnetId, subnetId1), hasRT, isVWANpeer | extend compliant = (hasRT==true or isVWANpeer==true) | distinct id, subnetId, compliant",
            "guid": "a3784907-9836-4271-aafc-93535f8ec08b",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-networks-udr-overview",
            "service": "Firewall",
            "severity": "High",
            "text": "For subnets in VNets not connected to Virtual WAN, attach a route table so that Internet traffic is redirected to Azure Firewall or a Network Virtual Appliance.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Network/azureFirewalls",
            "checklist": "Azure Landing Zone Review",
            "guid": "715d833d-4708-4527-90ac-1b142c7045ba",
            "link": "https://learn.microsoft.com/azure/firewall/firewall-structured-logs",
            "service": "Firewall",
            "severity": "Medium",
            "text": "Add diagnostic settings to save logs, using the Resource Specific destination table, for all Azure Firewall deployments.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.Network/azureFirewalls",
            "checklist": "Azure Landing Zone Review",
            "guid": "e960fc6b-4ab2-4db6-9609-3745135f9ffa",
            "link": "https://learn.microsoft.com/azure/firewall-manager/migrate-to-policy",
            "service": "Firewall",
            "severity": "Important",
            "text": "Migrate from Azure Firewall Classic rules (if exist) to Firewall Policy.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.Network/azureFirewalls",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,subnets=properties.subnets | mv-expand subnets | project id, subnetName = subnets.name, subnetPrefix = subnets.properties.addressPrefix | extend subnetPrefixLength = split(subnetPrefix, '/')[1] | where subnetName == 'AzureFirewallSubnet' | extend compliant = (subnetPrefixLength == 26) | distinct id, compliant",
            "guid": "22d6419e-b627-4d95-9e7d-019fa759387f",
            "link": "https://learn.microsoft.com/azure/firewall/firewall-faq#why-does-azure-firewall-need-a--26-subnet-size",
            "service": "Firewall",
            "severity": "High",
            "text": "Use a /26 prefix for your Azure Firewall subnets.",
            "training": "https://learn.microsoft.com/training/modules/introduction-azure-firewall/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Network/azureFirewalls",
            "checklist": "Azure Landing Zone Review",
            "guid": "828cec2e-af6c-40c2-8fa2-1b681ee63eb7",
            "link": "https://learn.microsoft.com/azure/firewall-manager/rule-hierarchy",
            "service": "Firewall",
            "severity": "Medium",
            "text": "Arrange rules within the firewall policy into Rule Collection Groups and Rule Collections and based on their frequency of use.",
            "training": "https://learn.microsoft.com/training/modules/intro-to-azure-firewall-manager/",
            "waf": "Performance"
        },
        {
            "arm-service": "Microsoft.Network/azureFirewalls",
            "checklist": "Azure Landing Zone Review",
            "guid": "0da83bb1-2f39-49af-b5c9-835fc455e3d1",
            "link": "https://learn.microsoft.com/azure/firewall/ip-groups",
            "service": "Firewall",
            "severity": "Medium",
            "text": "Use IP Groups or IP prefixes to reduce number of IP table rules.",
            "waf": "Performance"
        },
        {
            "arm-service": "Microsoft.Network/azureFirewalls",
            "checklist": "Azure Landing Zone Review",
            "guid": "c44c6f0e-1642-4a61-a17b-0922f835c93a",
            "link": "https://learn.microsoft.com/azure/firewall/tutorial-firewall-dnat",
            "service": "Firewall",
            "severity": "Medium",
            "text": "Do not use wildcards as a source IP for DNATS, such as * or any, you should specify source IPs for incoming DNATs.",
            "training": "https://learn.microsoft.com/training/modules/introduction-to-azure-virtual-networks/",
            "waf": "Performance"
        },
        {
            "arm-service": "Microsoft.Network/azureFirewalls",
            "checklist": "Azure Landing Zone Review",
            "guid": "7371dc21-251a-47a3-af14-6e01b9da4757",
            "link": "https://learn.microsoft.com/azure/firewall/integrate-with-nat-gateway",
            "service": "Firewall",
            "severity": "Medium",
            "text": "Prevent SNAT Port exhaustion by monitoring SNAT port usage, evaluating NAT Gateway settings, and ensuring seamless failover. If the port count approaches the limit, it’s a sign that SNAT exhaustion might be imminent.",
            "training": "https://learn.microsoft.com/training/modules/introduction-to-azure-virtual-networks/",
            "waf": "Performance"
        },
        {
            "arm-service": "Microsoft.Network/azureFirewalls",
            "checklist": "Azure Landing Zone Review",
            "guid": "346840b8-1064-496e-8396-4b1340172d52",
            "link": "https://learn.microsoft.com/azure/firewall/premium-features#tls-inspection",
            "service": "Firewall",
            "severity": "High",
            "text": "If you are using Azure Firewall Premium, enable TLS Inspection.",
            "waf": "Performance"
        },
        {
            "arm-service": "Microsoft.Network/azureFirewalls",
            "checklist": "Azure Landing Zone Review",
            "guid": "39990a13-915c-45f9-a2d3-562d7d6c4b7c",
            "link": "https://learn.microsoft.com/azure/firewall/premium-features#web-categories",
            "service": "Firewall",
            "severity": "Low",
            "text": "Use web categories to allow or deny outbound access to specific topics.",
            "waf": "Performance"
        },
        {
            "arm-service": "Microsoft.Network/azureFirewalls",
            "checklist": "Azure Landing Zone Review",
            "guid": "6eff7e6c-6c4a-43d7-be3f-6641c2cb3d4a",
            "link": "https://learn.microsoft.com/azure/architecture/example-scenario/gateway/application-gateway-before-azure-firewall",
            "service": "Firewall",
            "severity": "Medium",
            "text": "As part of your TLS inspection, plan for receiving traffic from Azure App Gateways for inspection.",
            "training": "https://learn.microsoft.com/training/modules/configure-azure-application-gateway/",
            "waf": "Performance"
        },
        {
            "arm-service": "Microsoft.Network/azureFirewalls",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type =~ 'Microsoft.Network/firewallPolicies' | where array_length(properties.firewalls) > 0 | extend compliant = (properties.dnsSettings.enableProxy =~ 'true') | distinct id, compliant",
            "guid": "94f3eede-9aa3-4088-92a3-bb9a56509fad",
            "link": "https://learn.microsoft.com/azure/firewall/dns-details",
            "service": "Firewall",
            "severity": "Medium",
            "text": "Enable Azure Firewall DNS proxy configuration.",
            "training": "https://learn.microsoft.com/training/courses/az-700t00/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Network/azureFirewalls",
            "checklist": "Azure Landing Zone Review",
            "guid": "1dc04554-dece-4ffb-a49e-5c683e09f8da",
            "link": "https://learn.microsoft.com/azure/firewall/firewall-diagnostics",
            "service": "Firewall",
            "severity": "High",
            "text": "Integrate Azure Firewall with Azure Monitor and enable diagnostic logging to store and analyze firewall logs and metrics.",
            "training": "https://learn.microsoft.com/training/courses/az-700t00/",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.Network/azureFirewalls",
            "checklist": "Azure Landing Zone Review",
            "guid": "64e7000e-3c06-485e-b455-ced7f454cba3",
            "link": "https://learn.microsoft.com/azure/well-architected/service-guides/azure-firewall",
            "service": "Firewall",
            "severity": "Low",
            "text": "Implement backups for your firewall rules",
            "training": "https://learn.microsoft.com/training/courses/az-104t00/",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.Network/azureFirewalls",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type == 'microsoft.network/azurefirewalls' | where array_length(zones) <= 1 or isnull(zones) | where isempty(properties.virtualHub.id) or isnull(properties.virtualHub.id) | project name, id, tags, param1='multipleZones:false'",
            "guid": "d38ad60c-bc9e-4d49-b699-97e5d4dcf707",
            "link": "https://learn.microsoft.com/azure/firewall/deploy-availability-zone-powershell",
            "service": "Firewall",
            "severity": "High",
            "text": "Deploy Azure Firewall across multiple availability zones. Azure Firewall offers different SLAs depending on its deployment; in a single availability zone or across multiple, potentially improving reliability and performance.",
            "training": "https://learn.microsoft.com/training/courses/az-104t00/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Network/azureFirewalls",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type =~ 'Microsoft.Network/azureFirewalls' | where isempty(properties.virtualHub.id) or isnull(properties.virtualHub.id) | mv-expand ipConfig = properties.ipConfigurations | project name, firewallId = id, tags, vNetName = split(ipConfig.properties.subnet.id, '/', 8)[0], vNetId = tolower(substring(ipConfig.properties.subnet.id, 0, indexof(ipConfig.properties.subnet.id, /subnet'))) | join kind=fullouter ( resources | where type =~ 'Microsoft.Network/ddosProtectionPlans' | mv-expand vNet = properties.virtualNetworks | project ddosProtectionPlanId = id, vNetId = tolower(vNet.id) ) on vNetId | where isempty(ddosProtectionPlanId) | , name, id = firewallId, tags, param1 = strcat('vNet: ', vNetName), param2 = 'ddosProtection: Disabled'",
            "guid": "e8143efa-0301-4d62-be54-ca7b5ce566dc",
            "link": "https://learn.microsoft.com/en-gb/azure/ddos-protection/ddos-protection-overview",
            "service": "Firewall",
            "severity": "High",
            "text": "Configure DDoS Protection on the Azure Firewall VNet, Associate a DDoS protection plan with the virtual network hosting Azure Firewall to provide enhanced mitigation against DDoS attacks. Azure Firewall Manager integrates the creation of firewall infrastructure and DDoS protection plans. ",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/applicationGateways",
            "checklist": "Azure Landing Zone Review",
            "guid": "d301d6e8-72e5-42e3-911c-c58b5a4b1511",
            "link": "https://learn.microsoft.com/azure/virtual-network/vnet-integration-for-azure-services",
            "service": "AppGW",
            "severity": "High",
            "text": "Do not disrupt control-plane communication for Azure PaaS services injected into a virtual networks, such as with a 0.0.0.0/0 route or an NSG rule that blocks control plane traffic.",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/?source=learn",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "guid": "b3e4563a-4d87-4397-98b6-62d6d15f512a",
            "link": "https://learn.microsoft.com/azure/private-link/private-endpoint-overview",
            "service": "ExpressRoute",
            "severity": "Medium",
            "text": "Access Azure PaaS services from on-premises via private endpoints and ExpressRoute private peering. This method avoids transiting over the public internet.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Network/virtualNetworks",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type =~ 'microsoft.network/virtualnetworks' | project id,resourceGroup,name,subnets = properties.subnets | mv-expand subnets | project id = subnets.id, resourceGroup, VNet = name, serviceEndpoints = subnets.properties.serviceEndpoints, compliant = (isnull(subnets.properties.serviceEndpoints) or array_length(subnets.properties.serviceEndpoints) == 0) | order by compliant asc",
            "guid": "4704489a-8042-4d88-b79d-17b73b22a5a6",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-network-service-endpoints-overview",
            "service": "VNet",
            "severity": "High",
            "text": "Don't enable virtual network service endpoints by default on all subnets.",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/?source=learn",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Network/azureFirewalls",
            "checklist": "Azure Landing Zone Review",
            "guid": "7e7a8ed4-b30e-438c-9f29-812b2363cefe",
            "link": "azure/private-link/inspect-traffic-with-azure-firewall",
            "service": "Firewall",
            "severity": "Medium",
            "text": "Filter egress traffic to Azure PaaS services using FQDNs instead of IP addresses in Azure Firewall or an NVA to prevent data exfiltration. If using Private Link you can block all FQDNs, otherwise allow only the required PaaS services.",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/?source=learn",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,subnets=properties.subnets | mv-expand subnets | project id, subnetName = subnets.name, subnetPrefix = subnets.properties.addressPrefix | extend subnetPrefixLength = split(subnetPrefix, '/')[1] | where subnetName == 'GatewaySubnet' | extend compliant = (subnetPrefixLength <= 27) | distinct id, compliant",
            "guid": "f2aad7e3-bb03-4adc-8606-4123d342a917",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-howto-add-gateway-resource-manager#add-a-gateway",
            "service": "ExpressRoute",
            "severity": "High",
            "text": "Use at least a /27 prefix for your Gateway subnets.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Network/networkSecurityGroups",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/networksecuritygroups' | mvexpand properties.securityRules | project id,name,ruleAction=properties_securityRules.properties.access,rulePriority=properties_securityRules.properties.priority,ruleDst=properties_securityRules.properties.destinationAddressPrefix,ruleSrc=properties_securityRules.properties.sourceAddressPrefix,ruleProt=properties_securityRules.properties.protocol,ruleDirection=properties_securityRules.properties.direction,rulePort=properties_securityRules.properties.destinationPortRange | summarize StarDenies=countif(ruleAction=='Deny' and ruleDst=='*' and ruleSrc=='*' and ruleProt=='*' and rulePort=='*') by id,tostring(ruleDirection) | where ruleDirection == 'Inbound' | project id,compliant=(StarDenies>0) | union (resources | where type=='microsoft.network/networksecuritygroups' | where array_length(properties.securityRules)==0 | extend compliant=false | project id,compliant)",
            "guid": "11deb39d-8299-4e47-bbe0-0fb5a36318a8",
            "link": "https://learn.microsoft.com/azure/virtual-network/service-tags-overview#available-service-tags",
            "service": "NSG",
            "severity": "High",
            "text": "Don't rely on the NSG inbound default rules using the VirtualNetwork service tag to limit connectivity.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Network/networkSecurityGroups",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type == 'microsoft.network/virtualnetworks' | mv-expand subnet = properties.subnets | where subnet.name !in~ ('GatewaySubnet', 'AzureFirewallSubnet', 'AzureFirewallManagementSubnet', 'RouteServerSubnet') | extend compliant = iff(isnotnull(subnet.properties.networkSecurityGroup.id), true, false) | project id, subnetName = subnet.name, vnetName = name, NSG = subnet.properties.networkSecurityGroup.id, compliant",
            "guid": "872e52e3-611c-4c58-a5a4-b1511e43a58a",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-landing-zone-network-segmentation",
            "service": "NSG",
            "severity": "Medium",
            "text": "Use NSGs to help protect traffic across subnets, as well as east/west traffic across the platform (traffic between landing zones).",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Network/networkSecurityGroups",
            "checklist": "Azure Landing Zone Review",
            "guid": "a4d87397-48b6-462d-9d15-f512a65498f6",
            "link": "https://learn.microsoft.com/azure/virtual-network/network-security-group-how-it-works",
            "service": "NSG",
            "severity": "Medium",
            "text": "Use NSGs and application security groups to micro-segment traffic within the landing zone and avoid using a central NVA to filter traffic flows.",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Network/networkSecurityGroups",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type =~ 'Microsoft.Network/virtualnetworks' | project subscriptionId, lowerCaseVNetId = tolower(id) | join kind = leftouter (    resources    | where type =~ 'microsoft.network/networkwatchers/flowlogs' and properties.enabled == true and properties.provisioningState =~ 'succeeded'    | where properties.targetResourceId contains '/Microsoft.Network/virtualNetworks/'    | project flowlogId = id, trafficAnalyticsEnabled = properties.flowAnalyticsConfiguration.networkWatcherFlowAnalyticsConfiguration.enabled, lowerCaseTargetVNetId = tolower(properties.targetResourceId)    )    on $left.lowerCaseVNetId == $right.lowerCaseTargetVNetId | extend compliant = iff(isnotempty(lowerCaseTargetVNetId), true, false) | project id = lowerCaseVNetId, flowlogId, trafficAnalyticsEnabled, compliant",
            "guid": "dfe237de-143b-416c-91d7-aa9b64704489",
            "link": "https://learn.microsoft.com/azure/network-watcher/vnet-flow-logs-overview",
            "service": "NSG",
            "severity": "Medium",
            "text": "Enable VNet Flow Logs and feed them into Traffic Analytics to gain insights into internal and external traffic flows.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-network-monitoring/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Network/networkSecurityGroups",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type == 'microsoft.network/networksecuritygroups' | project id, rules = array_length(properties.securityRules) | project id, compliant = (rules < 900)",
            "guid": "0390417d-53dc-44d9-b3f4-c8832f359b41",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits",
            "service": "NSG",
            "severity": "Medium",
            "text": "Do not implement more than 900 NSG rules per NSG, due to the limit of 1000 rules.",
            "training": "https://learn.microsoft.com/azure/virtual-network/network-security-group-how-it-works",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/virtualWans",
            "checklist": "Azure Landing Zone Review",
            "guid": "412e7f98-3f63-4047-82dd-69c5b5c2622f",
            "link": "https://learn.microsoft.com/azure/virtual-wan/scenario-any-to-any",
            "service": "VWAN",
            "severity": "Medium",
            "text": "Use Virtual WAN if your scenario is explicitly described in the list of Virtual WAN routing designs.",
            "training": "https://learn.microsoft.com/learn/modules/introduction-azure-virtual-wan/",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.network/virtualWans",
            "checklist": "Azure Landing Zone Review",
            "guid": "54b69bad-33aa-4d5e-ac68-e1d76667313b",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/virtual-wan-network-topology#virtual-wan-network-design-recommendationst",
            "service": "VWAN",
            "severity": "Medium",
            "text": "Use a Virtual WAN hub per Azure region to connect multiple landing zones together across Azure regions via a common global Azure Virtual WAN.",
            "training": "https://learn.microsoft.com/training/modules/introduction-azure-virtual-wan/",
            "waf": "Performance"
        },
        {
            "arm-service": "microsoft.network/virtualWans",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/virtualhubs' | extend compliant = isnotnull(properties.azureFirewall.id) | project id, compliant",
            "guid": "7d5d1e4e-6146-458d-9558-fd77249b8211",
            "link": "https://learn.microsoft.com/azure/virtual-wan/howto-firewall",
            "service": "VWAN",
            "severity": "Medium",
            "text": "For outbound Internet traffic protection and filtering, deploy Azure Firewall in secured hubs.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/virtualWans",
            "checklist": "Azure Landing Zone Review",
            "guid": "6667313b-4f56-464b-9e98-4a859c773e7d",
            "link": "https://learn.microsoft.com/azure/virtual-wan/migrate-from-hub-spoke-topology",
            "service": "VWAN",
            "severity": "Medium",
            "text": "Ensure that your virtual WAN network architecture aligns to an identified architecture scenario.",
            "training": "https://learn.microsoft.com/training/modules/introduction-azure-virtual-wan/",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/virtualWans",
            "checklist": "Azure Landing Zone Review",
            "guid": "261623a7-65a9-417e-8f34-8ef254c27d42",
            "link": "https://learn.microsoft.com/azure/virtual-wan/azure-monitor-insights",
            "service": "VWAN",
            "severity": "Medium",
            "text": "Use Azure Monitor Insights for Virtual WAN to monitor the end-to-end topology of the Virtual WAN, status, and key metrics.",
            "training": "https://learn.microsoft.com/training/modules/introduction-azure-virtual-wan/",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.network/virtualWans",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources| where type =~ 'microsoft.network/virtualwans' | extend compliant= (properties.allowBranchToBranchTraffic == 'true') | distinct id,compliant",
            "guid": "727c77e1-b9aa-4a37-a024-129d042422c1",
            "link": "https://learn.microsoft.com/azure/virtual-wan/virtual-wan-faq#is-branch-to-branch-connectivity-allowed-in-virtual-wan",
            "service": "VWAN",
            "severity": "Medium",
            "text": "Do not disable branch-to-branch traffic in Virtual WAN, unless these flows should be explicitly blocked.",
            "training": "https://learn.microsoft.com/training/modules/introduction-azure-virtual-wan/",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/virtualWans",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type =~ 'microsoft.network/virtualhubs'| extend compliant= (properties.hubRoutingPreference =~ 'ASPath') | distinct id,compliant",
            "guid": "d49ac006-6670-4bc9-9948-d3e0a3a94f4d",
            "link": "https://learn.microsoft.com/azure/virtual-wan/about-virtual-hub-routing-preference",
            "service": "VWAN",
            "severity": "Medium",
            "text": "Use AS-Path as hub routing preference, since it is more flexible than ExpressRoute or VPN.",
            "training": "https://learn.microsoft.com/training/modules/introduction-azure-virtual-wan/",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/virtualWans",
            "checklist": "Azure Landing Zone Review",
            "guid": "2586b854-237e-47f1-84a1-d45d4cd2310d",
            "link": "https://learn.microsoft.com/azure/virtual-wan/about-virtual-hub-routing#labels",
            "service": "VWAN",
            "severity": "Medium",
            "text": "Configure label-based propagation in Virtual WAN, otherwise connectivity between virtual hubs will be impaired.",
            "training": "https://learn.microsoft.com/training/modules/introduction-azure-virtual-wan/",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/virtualWans",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type =~ 'microsoft.network/virtualhubs' | extend addressSpace = properties.addressPrefix | extend compliant= (toint(substring(addressSpace, indexof(addressSpace, '/') + 1)) < 23) | distinct name, id, compliant",
            "guid": "9c75dfef-573c-461c-a698-68598595581a",
            "link": "https://learn.microsoft.com/azure/virtual-wan/virtual-wan-faq#what-is-the-recommended-hub-address-space-during-hub-creation",
            "service": "VWAN",
            "severity": "High",
            "text": "Assign at least a /23 prefix to virtual hubs to ensure enough IP space is available.",
            "training": "https://learn.microsoft.com/training/modules/introduction-azure-virtual-wan/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Authorization/policyDefinitions",
            "checklist": "Azure Landing Zone Review",
            "guid": "5c986cb2-9131-456a-8247-6e49f541acdc",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "service": "Policy",
            "severity": "High",
            "text": "Leverage Azure Policy strategically, define controls for your environment, using Policy Initiatives to group related policies.",
            "training": "https://learn.microsoft.com/training/modules/configure-azure-policy/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Authorization/policyDefinitions",
            "checklist": "Azure Landing Zone Review",
            "guid": "d8a2adb1-17d6-4326-af62-5ca44e5695f2",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "service": "Policy",
            "severity": "Medium",
            "text": "Map regulatory and compliance requirements to Azure Policy definitions and Azure role assignments.",
            "training": "https://learn.microsoft.com/training/modules/governance-security/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Authorization/policyDefinitions",
            "checklist": "Azure Landing Zone Review",
            "guid": "223ace8c-b123-408c-a501-7f154e3ab369",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "service": "Policy",
            "severity": "Medium",
            "text": "Establish Azure Policy definitions at the intermediate root management group so that they can be assigned at inherited scopes.",
            "training": "https://learn.microsoft.com/training/modules/configure-azure-policy/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Authorization/policyDefinitions",
            "checklist": "Azure Landing Zone Review",
            "guid": "3829e7e3-1618-4368-9a04-77a209945bda",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "service": "Policy",
            "severity": "High",
            "text": "Manage policy assignments at the highest appropriate level with exclusions at bottom levels, if required.",
            "training": "https://learn.microsoft.com/training/modules/configure-azure-policy/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Authorization/policyDefinitions",
            "checklist": "Azure Landing Zone Review",
            "guid": "43334f24-9116-4341-a2ba-527526944008",
            "link": "https://learn.microsoft.com/security/benchmark/azure/mcsb-asset-management#am-2-use-only-approved-services",
            "service": "Policy",
            "severity": "Low",
            "text": "Use Azure Policy to control which services users can provision at the subscription/management group level.",
            "training": "https://learn.microsoft.com/training/modules/configure-azure-policy/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Authorization/policyDefinitions",
            "checklist": "Azure Landing Zone Review",
            "guid": "be7d7e48-4327-46d8-adc0-55bcf619e8a1",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "service": "Policy",
            "severity": "High",
            "text": "Use built-in policies where possible to minimize operational overhead.",
            "training": "https://learn.microsoft.com/training/modules/configure-azure-policy/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Authorization/policyDefinitions",
            "checklist": "Azure Landing Zone Review",
            "description": "Assigning the Resource Policy Contributor role to specific scopes allows you to delegate policy management to relevant teams. For instance, a central IT team may oversee management group-level policies, while application teams handle policies for their subscriptions, enabling distributed governance with adherence to organizational standards.",
            "guid": "3f988795-25d6-4268-a6d7-0ba6c97be995",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview#azure-rbac-permissions-in-azure-policy",
            "service": "Policy",
            "severity": "Medium",
            "text": "Assign the built-in Resource Policy Contributor role at a particular scope to enable application-level governance.",
            "training": "https://learn.microsoft.com/training/modules/configure-azure-policy/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Authorization/policyDefinitions",
            "checklist": "Azure Landing Zone Review",
            "guid": "19048384-5c98-46cb-8913-156a12476e49",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "service": "Policy",
            "severity": "Medium",
            "text": "Limit the number of Azure Policy assignments made at the root management group scope to avoid managing through exclusions at inherited scopes.",
            "training": "https://learn.microsoft.com/training/modules/configure-azure-policy/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Authorization/policyDefinitions",
            "checklist": "Azure Landing Zone Review",
            "guid": "5a917e1f-348e-4f25-9c27-d42e8bbac757",
            "link": "https://learn.microsoft.com/industry/release-plan/2023wave2/cloud-sovereignty/enable-data-sovereignty-policy-baseline",
            "service": "Policy",
            "severity": "Medium",
            "text": "If any data sovereignty requirements exist, Azure Policies should be deployed to enforce them.",
            "training": "https://learn.microsoft.com/learn/paths/secure-your-cloud-data/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Authorization/policyDefinitions",
            "checklist": "Azure Landing Zone Review",
            "guid": "78b22132-b41c-460b-a4d3-df8f73a67dc2",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/sovereign-landing-zone",
            "service": "Policy",
            "severity": "Medium",
            "text": "For Sovereign Landing Zone, deploy sovereignty policy baseline and assign at correct management group level.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Authorization/policyDefinitions",
            "checklist": "Azure Landing Zone Review",
            "guid": "caeea0e9-1024-41df-a52e-d99c3f22a6f4",
            "link": "https://learn.microsoft.com/industry/sovereignty/policy-portfolio-baseline",
            "service": "Policy",
            "severity": "Medium",
            "text": "For Sovereign Landing Zone, document Sovereign Control objectives to policy mapping.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Authorization/policyDefinitions",
            "checklist": "Azure Landing Zone Review",
            "guid": "9b461617-db7b-4399-8ac6-d4eb7153893a",
            "link": "https://learn.microsoft.com/industry/sovereignty/policy-portfolio-baseline#sovereignty-baseline-policy-initiatives",
            "service": "Policy",
            "severity": "Medium",
            "text": "For Sovereign Landing Zone, ensure process is in place for management of 'Sovereign Control objectives to policy mapping'.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Insights/components",
            "checklist": "Azure Landing Zone Review",
            "guid": "67e7a8ed-4b30-4e38-a3f2-9812b2363cef",
            "link": "https://learn.microsoft.com/en-us/azure/azure-monitor/logs/workspace-design#azure-regions",
            "service": "Monitor",
            "severity": "Medium",
            "text": "Use a single monitor logs workspace to manage platforms centrally except where Azure role-based access control (Azure RBAC), data sovereignty requirements, or data retention policies mandate separate workspaces.",
            "training": "https://learn.microsoft.com/azure/azure-monitor/logs/design-logs-deployment",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.Insights/components",
            "checklist": "Azure Landing Zone Review",
            "guid": "7418ada9-4199-4c28-8286-d15e9433e8f3",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/design-logs-deployment",
            "service": "Monitor",
            "severity": "Medium",
            "text": "Decide whether to use a single Azure Monitor Logs workspace for all regions or to create multiple workspaces to cover various geographical regions. Each approach has advantages and disadvantages, including potential cross-region networking charges",
            "training": "https://learn.microsoft.com/azure/azure-monitor/logs/design-logs-deployment",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Insights/components",
            "checklist": "Azure Landing Zone Review",
            "guid": "5e6c4cfd-3e50-4454-9c24-47ec66138a72",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/data-retention-archive?tabs=portal-1%2Cportal-2#how-retention-and-archiving-work",
            "service": "Monitor",
            "severity": "High",
            "text": "Export logs to Azure Storage if your log retention requirements exceed twelve years. Use immutable storage with a write-once, read-many policy to make data non-erasable and non-modifiable for a user-specified interval.",
            "training": "https://learn.microsoft.com/learn/paths/architect-infrastructure-operations/",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "Azure Landing Zone Review",
            "guid": "e7d7e484-3276-4d8b-bc05-5bcf619e8a13",
            "link": "https://learn.microsoft.com/azure/governance/machine-configuration/overview",
            "service": "VM",
            "severity": "Medium",
            "text": "Monitor OS level virtual machine (VM) configuration drift using Azure Policy. Enabling Azure Automanage Machine Configuration audit capabilities through policy helps application team workloads to immediately consume feature capabilities with little effort.",
            "training": "https://learn.microsoft.com/learn/paths/implement-resource-mgmt-security/",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "Azure Landing Zone Review",
            "guid": "f9887952-5d62-4688-9d70-ba6c97be9951",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/management-operational-compliance#update-management-considerations",
            "service": "VM",
            "severity": "Medium",
            "text": "Use Azure Update Manager as a patching mechanism for Windows and Linux VMs in Azure.",
            "training": "https://learn.microsoft.com/azure/update-manager/overview?tabs=azure-vms",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "Azure Landing Zone Review",
            "guid": "c806c048-26b7-4ddf-b4c2-b4f0c476925d",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/management-operational-compliance#update-management-considerations ",
            "service": "VM",
            "severity": "Medium",
            "text": "Use Azure Update Manager as a patching mechanism for Windows and Linux VMs outside of Azure using Azure Arc.",
            "training": "https://learn.microsoft.com/azure/update-manager/overview?tabs=azure-vms",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.network/networkWatchers",
            "checklist": "Azure Landing Zone Review",
            "guid": "90483845-c986-4cb2-a131-56a12476e49f",
            "link": "https://learn.microsoft.com/azure/network-watcher/network-watcher-monitoring-overview",
            "service": "Network Watcher",
            "severity": "Medium",
            "text": "Use Network Watcher to proactively monitor traffic flows.",
            "training": "https://learn.microsoft.com/learn/modules/configure-network-watcher/",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.Insights/components",
            "checklist": "Azure Landing Zone Review",
            "guid": "6944008b-e7d7-4e48-9327-6d8bdc055bcf",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-setup-guide/monitoring-reporting?tabs=AzureMonitor",
            "service": "Monitor",
            "severity": "Medium",
            "text": "Use Azure Monitor Logs for insights and reporting.",
            "training": "https://learn.microsoft.com/training/modules/configure-azure-monitor/",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.Insights/components",
            "checklist": "Azure Landing Zone Review",
            "guid": "97be9951-9048-4384-9c98-6cb2913156a1",
            "link": "https://learn.microsoft.com/azure/azure-monitor/alerts/alerts-overview",
            "service": "Monitor",
            "severity": "Medium",
            "text": "Use Azure Monitor alerts for the generation of operational alerts.",
            "training": "https://learn.microsoft.com/training/modules/incident-response-with-alerting-on-azure/",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.Insights/components",
            "checklist": "Azure Landing Zone Review",
            "guid": "fed3c55f-a67e-4875-aadd-3aba3f9fde31",
            "link": "https://learn.microsoft.com/azure/automation/how-to/region-mappings",
            "service": "Monitor",
            "severity": "Medium",
            "text": "When using Change and Inventory Tracking via Azure Automation Accounts, ensure that you have selected supported regions for linking your Log Analytics workspace and automation accounts together.",
            "training": "https://learn.microsoft.com/training/modules/explore-azure-automation-devops/",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.RecoveryServices/vaults",
            "checklist": "Azure Landing Zone Review",
            "guid": "eba8cf22-45c6-4dc1-9b57-2cceb3b97ce5",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-redundancy",
            "service": "Backup",
            "severity": "Low",
            "text": "When using Azure Backup, use the correct backup types (GRS, ZRS & LRS) for your backup, as the default setting is GRS.",
            "training": "https://learn.microsoft.com/training/modules/design-solution-for-backup-disaster-recovery/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "Azure Landing Zone Review",
            "guid": "f541acdc-e979-4377-acdb-3751ab2ab13a",
            "link": "https://learn.microsoft.com/azure/governance/policy/concepts/guest-configuration",
            "service": "VM",
            "severity": "Medium",
            "text": "Use Azure guest policies to automatically deploy software configurations through VM extensions and enforce a compliant baseline VM configuration.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "Azure Landing Zone Review",
            "description": "Use Azure Policy's guest configuration features  to audit and remediate machine settings (e.g., OS, application, environment) to ensure resources align with expected configurations, and Update Management can enforce patch management for VMs.",
            "guid": "da6e55d7-d8a2-4adb-817d-6326af625ca4",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/management-operational-compliance#monitoring-for-configuration-drift",
            "service": "VM",
            "severity": "Medium",
            "text": "Monitor VM security configuration drift via Azure Policy.",
            "training": "https://learn.microsoft.com/training/paths/implement-resource-mgmt-security/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "Azure Landing Zone Review",
            "guid": "2476e49f-541a-4cdc-b979-377bcdb3751a",
            "link": "https://learn.microsoft.com/azure/site-recovery/site-recovery-overview",
            "service": "VM",
            "severity": "Medium",
            "text": "Use Azure Site Recovery for Azure-to-Azure Virtual Machines disaster recovery scenarios. This enables you to replicate workloads across regions.",
            "training": "https://learn.microsoft.com/training/modules/protect-infrastructure-with-site-recovery/",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.RecoveryServices/vaults",
            "checklist": "Azure Landing Zone Review",
            "guid": "f625ca44-e569-45f2-823a-ce8cb12308ca",
            "link": "https://learn.microsoft.com/azure/backup/backup-center-overview",
            "service": "Backup",
            "severity": "Medium",
            "text": "Use Azure-native backup capabilities, or an Azure-compatible, 3rd-party backup solution.",
            "training": "https://learn.microsoft.com/training/modules/design-solution-for-backup-disaster-recovery/",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.network/frontdoorwebApplicationFirewalls",
            "checklist": "Azure Landing Zone Review",
            "guid": "89cc5e11-aa4d-4c3b-893d-feb99215266a",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#add-diagnostic-settings-to-save-your-wafs-logs",
            "service": "WAF",
            "severity": "High",
            "text": "Add diagnostic settings to save WAF logs from application delivery services like Azure Front Door and Azure Application Gateway. Regularly review the logs to check for attacks and for false positive detections.",
            "training": "https://learn.microsoft.com/training/modules/capture-application-logs-app-service/",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.network/frontdoorwebApplicationFirewalls",
            "checklist": "Azure Landing Zone Review",
            "guid": "7f408960-c626-44cb-a018-347c8d790cdf",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#send-logs-to-microsoft-sentinel",
            "service": "WAF",
            "severity": "Medium",
            "text": "Send WAF logs from your application delivery services like Azure Front Door and Azure Application Gateway to Microsoft Sentinel. Detect attacks and integrate WAF telemetry into your overall Azure environment.",
            "training": "https://learn.microsoft.com/training/paths/sc-200-connect-logs-to-azure-sentinel/",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.KeyVault/vaults",
            "checklist": "Azure Landing Zone Review",
            "guid": "5017f154-e3ab-4369-9829-e7e316183687",
            "link": "https://learn.microsoft.com/azure/key-vault/general/overview",
            "service": "Key Vault",
            "severity": "High",
            "text": "Use Azure Key Vault to store your secrets and credentials.",
            "training": "https://learn.microsoft.com/training/modules/implement-azure-key-vault/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.KeyVault/vaults",
            "checklist": "Azure Landing Zone Review",
            "graph": "ResourceContainers | where type=='microsoft.resources/subscriptions'| parse id with '/subscriptions/' SubscriptionID| project subscriptionId, SubscriptionName = name| join kind=leftouter (Resources| where type == 'microsoft.keyvault/vaults'| project id, name, subscriptionId) on subscriptionId| join kind= leftouter (Resources| where type == 'microsoft.keyvault/vaults'| summarize ResourceCount = count() by subscriptionId) on subscriptionId| extend RCount = iff(isnull(ResourceCount), 0, ResourceCount)| project-away ResourceCount| extend compliant = (RCount <> 1)",
            "guid": "a0477a20-9945-4bda-9333-4f2491163418",
            "link": "https://learn.microsoft.com/azure/key-vault/general/overview-throttling",
            "service": "Key Vault",
            "severity": "Medium",
            "text": "Use different Azure Key Vaults for different applications and regions to avoid transaction scale limits and restrict access to secrets.",
            "training": "https://learn.microsoft.com/training/modules/configure-and-manage-azure-key-vault/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.KeyVault/vaults",
            "checklist": "Azure Landing Zone Review",
            "guid": "2ba52752-6944-4008-ae7d-7e4843276d8b",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "severity": "Medium",
            "text": "Provision Azure Key Vault with the soft delete and purge policies enabled to allow retention protection for deleted objects.",
            "training": "https://learn.microsoft.com/training/modules/implement-azure-key-vault/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.KeyVault/vaults",
            "checklist": "Azure Landing Zone Review",
            "guid": "dc055bcf-619e-48a1-9f98-879525d62688",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "severity": "Medium",
            "text": "Follow a least privilege model by limiting authorization to permanently delete keys, secrets, and certificates to specialized custom Microsoft Entra ID roles.",
            "training": "https://learn.microsoft.com/training/modules/implement-azure-key-vault/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.KeyVault/vaults",
            "checklist": "Azure Landing Zone Review",
            "guid": "6d70ba6c-97be-4995-8904-83845c986cb2",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "severity": "Medium",
            "text": "Automate the certificate management and renewal process with public certificate authorities to ease administration.",
            "training": "https://learn.microsoft.com/en-us/training/modules/configure-and-manage-azure-key-vault/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.KeyVault/vaults",
            "checklist": "Azure Landing Zone Review",
            "guid": "913156a1-2476-4e49-b541-acdce979377b",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "severity": "Medium",
            "text": "Establish an automated process for key and certificate rotation.",
            "training": "https://learn.microsoft.com/training/modules/configure-and-manage-azure-key-vault/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.KeyVault/vaults",
            "checklist": "Azure Landing Zone Review",
            "guid": "cdb3751a-b2ab-413a-ba6e-55d7d8a2adb1",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "severity": "Medium",
            "text": "Enable firewall and virtual network service endpoint or private endpoint on the vault to control access to the key vault.",
            "training": "https://learn.microsoft.com/training/modules/design-implement-private-access-to-azure-services/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.KeyVault/vaults",
            "checklist": "Azure Landing Zone Review",
            "guid": "17d6326a-f625-4ca4-9e56-95f2223ace8c",
            "link": "https://learn.microsoft.com/azure/key-vault/general/monitor-key-vault",
            "service": "Key Vault",
            "severity": "Medium",
            "text": "Use the platform-central Azure Monitor Log Analytics workspace to audit key, certificate, and secret usage within each instance of Key Vault.",
            "training": "https://learn.microsoft.com/training/modules/analyze-infrastructure-with-azure-monitor-logs/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.KeyVault/vaults",
            "checklist": "Azure Landing Zone Review",
            "guid": "b12308ca-5017-4f15-9e3a-b3693829e7e3",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "severity": "Medium",
            "text": "Delegate Key Vault instantiation and privileged access and use Azure Policy to enforce a consistent compliant configuration.",
            "training": "https://learn.microsoft.com/training/modules/configure-azure-key-vault-networking-settings/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.KeyVault/vaults",
            "checklist": "Azure Landing Zone Review",
            "guid": "91163418-2ba5-4275-8694-4008be7d7e48",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "severity": "Medium",
            "text": "Use an Azure Key Vault per application per environment per region.",
            "training": "https://learn.microsoft.com/training/modules/implement-azure-key-vault/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.KeyVault/vaults",
            "checklist": "Azure Landing Zone Review",
            "guid": "25d62688-6d70-4ba6-a97b-e99519048384",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "severity": "Medium",
            "text": "If you want to bring your own keys, this might not be supported across all considered services. Implement relevant mitigation so that inconsistencies don't hinder desired outcomes. Choose appropriate region pairs and disaster recovery regions that minimize latency.",
            "training": "https://learn.microsoft.com/training/modules/configure-and-manage-azure-key-vault/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.KeyVault/vaults",
            "checklist": "Azure Landing Zone Review",
            "guid": "4ac6b67c-b3a4-4ff9-8e87-b07a7ce7bbdb",
            "link": "https://learn.microsoft.com/industry/sovereignty/key-management",
            "service": "Key Vault",
            "severity": "Medium",
            "text": "For Sovereign Landing Zone, use Azure Key Vault managed HSM to store your secrets and credentials.",
            "training": "https://learn.microsoft.com/training/modules/configure-and-manage-azure-key-vault/",
            "waf": "Reliability"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "4e5695f2-223a-4ce8-ab12-308ca5017f15",
            "link": "https://learn.microsoft.com/azure/active-directory/reports-monitoring/overview-reports",
            "service": "Entra",
            "severity": "Medium",
            "text": "Use Microsoft Entra ID reporting capabilities to generate access control audit reports.",
            "training": "https://learn.microsoft.com/training/modules/monitor-report-aad-security-events/",
            "waf": "Reliability"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "09945bda-4333-44f2-9911-634182ba5275",
            "link": "https://learn.microsoft.com/azure/defender-for-cloud/concept-cloud-security-posture-management",
            "service": "Defender",
            "severity": "High",
            "text": "Enable Defender Cloud Security Posture Management for all subscriptions.",
            "training": "https://learn.microsoft.com/training/modules/microsoft-defender-cloud-security-posture/",
            "waf": "Reliability"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "36a72a48-fffe-4c40-9747-0ab5064355ba",
            "link": "https://learn.microsoft.com/azure/defender-for-cloud/plan-defender-for-servers-select-plan",
            "service": "Defender",
            "severity": "High",
            "text": "Enable a Defender Cloud Workload Protection Plan for Servers on all subscriptions.",
            "training": "https://learn.microsoft.com/training/modules/understand-azure-defender-cloud-workload-protection/",
            "waf": "Reliability"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "77425f48-ecba-43a0-aeac-a3ac733ccc6a",
            "link": "https://learn.microsoft.com/azure/defender-for-cloud/connect-azure-subscription",
            "service": "Defender",
            "severity": "High",
            "text": "Enable Defender Cloud Workload Protection Plans for Azure Resources on all subscriptions.",
            "training": "https://learn.microsoft.com/training/modules/understand-azure-defender-cloud-workload-protection/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "Azure Landing Zone Review",
            "guid": "24d96b30-61ee-4436-a1cc-d6ef08bc574b",
            "link": "https://learn.microsoft.com/mem/configmgr/protect/deploy-use/endpoint-protection",
            "service": "VM",
            "severity": "High",
            "text": "Enable Endpoint Protection on IaaS Servers.",
            "training": "https://learn.microsoft.com/training/modules/design-solutions-securing-server-client-endpoints/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "Azure Landing Zone Review",
            "guid": "15833ee7-ad6c-46d3-9331-65c7acbe44ab",
            "link": "https://learn.microsoft.com/azure/security-center/",
            "service": "VM",
            "severity": "Medium",
            "text": "Monitor base operating system patching drift via Azure Monitor Logs and Defender for Cloud.",
            "training": "https://learn.microsoft.com/training/modules/create-log-analytics-workspace-microsoft-defender-cloud/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Insights/components",
            "checklist": "Azure Landing Zone Review",
            "guid": "e5f8d79f-2e87-4768-924c-516775c6ea95",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/design-logs-deployment",
            "service": "Monitor",
            "severity": "Medium",
            "text": "Connect default resource configurations to a centralized Azure Monitor Log Analytics workspace.",
            "training": "https://learn.microsoft.com/training/modules/analyze-infrastructure-with-azure-monitor-logs/",
            "waf": "Reliability"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "graph": "resources| where type == 'microsoft.operationalinsights/workspaces'| extend wsid = properties.customerId| project workspaceResourceId = tolower(id), name, wsid| join (resources| where type == 'microsoft.operationsmanagement/solutions'| where name has 'SecurityInsights'| extend workspaceResourceId = tostring(tolower(properties.workspaceResourceId))| project workspaceResourceId | summarize ResourceCount = count() by workspaceResourceId) on workspaceResourceId| extend RCount = iff(isnull(ResourceCount), 0, ResourceCount)| project-away ResourceCount| extend compliant = (RCount <> 0)",
            "guid": "a56888b2-7e83-4404-bd31-b886528502d1",
            "link": "https://learn.microsoft.com/en-us/azure/well-architected/security/monitor-threats#centralized-threat-detection-with-correlated-logs",
            "service": "Entra",
            "severity": "High",
            "text": "Centralized threat detection with correlated logs -  consolidate security data in a central location where it can be correlated across various services via SIEM (security information and event management)",
            "waf": "Reliability"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "1761e147-f65e-4d09-bbc2-f464f23e2eba",
            "link": "https://learn.microsoft.com/industry/sovereignty/transparency-logs",
            "service": "Entra",
            "severity": "Medium",
            "text": "For Sovereign Landing Zone, enable transparancy logs on the Entra ID tenant.",
            "waf": "Reliability"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "d21a922d-5ca7-427a-82a6-35f7b21f1bfc",
            "link": "https://learn.microsoft.com/azure/security/fundamentals/customer-lockbox-overview",
            "service": "Entra",
            "severity": "Medium",
            "text": "For Sovereign Landing Zone, enable customer Lockbox on the Entra ID tenant.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "Azure Landing Zone Review",
            "guid": "b03ed428-4617-4067-a787-85468b9ccf3f",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-require-secure-transfer",
            "service": "Storage",
            "severity": "High",
            "text": "Enable secure transfer to storage accounts.",
            "training": "https://learn.microsoft.com/training/modules/secure-azure-storage-account/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "Azure Landing Zone Review",
            "guid": "159aac9f-863f-4f48-82cf-00c28fa97a0e",
            "link": "https://learn.microsoft.com/azure/storage/blobs/data-protection-overview#recommendations-for-basic-data-protection",
            "service": "Storage",
            "severity": "High",
            "text": "Enable container soft delete for the storage account to recover a deleted container and its contents.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.KeyVault/vaults",
            "checklist": "Azure Landing Zone Review",
            "guid": "108d5099-a11d-4445-bd8b-e12a5e95412e",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/development-strategy-development-lifecycle#automated-builds",
            "service": "Key Vault",
            "severity": "High",
            "text": "Use Key Vault secrets to avoid hard-coding sensitive information such as credentials (virtual machines user passwords), certificates or keys.",
            "training": "https://learn.microsoft.com/en-us/training/modules/implement-azure-key-vault/",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "Azure App Service Review",
            "guid": "b32e1aa1-4813-4602-88fe-27ca2891f421",
            "link": "https://learn.microsoft.com/en-us/azure/architecture/reference-architectures/app-service-web-app/zone-redundant?source=recommendations",
            "service": "App Service",
            "severity": "Low",
            "text": "Refer to baseline highly available zone-redundant web application architecture for best practices",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "Azure App Service Review",
            "graph": "resources | where type =~ 'microsoft.web/serverfarms' | extend compliant = (sku.tier == 'Premium' or sku.tier == 'Standard') | distinct id,compliant",
            "guid": "e4b31c6a-2e3f-4df1-8e8b-9c3aa5a27820",
            "link": "https://learn.microsoft.com/en-us/azure/app-service/overview-hosting-plans",
            "service": "App Service",
            "severity": "Medium",
            "text": "Use Premium and Standard tiers. These tiers support staging slots and automated backups.",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "Azure App Service Review",
            "guid": "a7e2e6c2-491f-4fa4-a82b-521d0bc3b202",
            "link": "https://learn.microsoft.com/en-us/azure/reliability/migrate-app-service",
            "service": "App Service",
            "severity": "High",
            "text": "Leverage Availability Zones where regionally applicable (requires Premium v2 or v3 tier)",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "Azure App Service Review",
            "graph": "appserviceresources  | where type =~ 'microsoft.web/sites/config' | extend compliant = (properties.HealthCheckPath != '') | distinct id,compliant",
            "guid": "1275e4a9-7b6a-43c3-a9cd-5ee18d8995ad",
            "link": "https://learn.microsoft.com/en-us/azure/app-service/monitor-instances-health-check",
            "service": "App Service",
            "severity": "Medium",
            "text": "Implement health checks",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "Azure App Service Review",
            "guid": "35a91c5d-4ad6-4d9b-8e0f-c47db9e6d1e7",
            "link": "https://learn.microsoft.com/en-us/azure/app-service/manage-backup",
            "service": "App Service",
            "severity": "High",
            "text": "Refer to backup and restore best practices for Azure App Service",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "Azure App Service Review",
            "guid": "e68cd0ec-afc6-4bd8-a27f-7860ad9a0db2",
            "link": "https://learn.microsoft.com/en-us/azure/architecture/framework/services/compute/azure-app-service/reliability",
            "service": "App Service",
            "severity": "High",
            "text": "Implement Azure App Service reliability best practices",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "Azure App Service Review",
            "guid": "bd2a865c-0835-4418-bb58-4df91a5a9b3f",
            "link": "https://learn.microsoft.com/en-us/azure/app-service/manage-disaster-recovery#recover-app-content-only",
            "service": "App Service",
            "severity": "Low",
            "text": "Familiarize with how to move an App Service app to another region During a disaster",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "Azure App Service Review",
            "guid": "f3d2f1e4-e6d4-4b7a-a5a5-e2a9b2c6f293",
            "link": "https://learn.microsoft.com/en-us/azure/reliability/reliability-app-service",
            "service": "App Service",
            "severity": "High",
            "text": "Familiarize with reliability support in Azure App Service",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "Azure App Service Review",
            "guid": "c7b5f3d1-0569-4fd2-9f32-c0b64e9c0c5e",
            "link": "https://learn.microsoft.com/en-us/azure/azure-functions/dedicated-plan#always-on",
            "service": "App Service",
            "severity": "Medium",
            "text": "Ensure \"Always On\" is enabled for Function Apps running on a app service plan",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "Azure App Service Review",
            "guid": "a3b4d5f6-758c-4f9d-9e1a-d7c6b7e8f9ab",
            "link": "https://learn.microsoft.com/en-us/azure/app-service/monitor-instances-health-check",
            "service": "App Service",
            "severity": "Medium",
            "text": "Monitor App Service instances using Health checks",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "Azure App Service Review",
            "guid": "c7d3e5f9-a19c-4833-8ca6-1dcb0128e129",
            "link": "https://learn.microsoft.com/en-us/azure/azure-monitor/app/availability-overview",
            "service": "App Service",
            "severity": "Medium",
            "text": "Monitor availability and responsiveness of web app or website using Application Insights availability tests",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "Azure App Service Review",
            "guid": "b4e3f2d5-a5c6-4d7e-8b2f-c5d9e7a8f0ea",
            "link": "https://learn.microsoft.com/en-us/azure/azure-monitor/app/availability-standard-tests",
            "service": "App Service",
            "severity": "Low",
            "text": "Use Application Insights Standard test to monitor availability and responsiveness of web app or website",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "Azure App Service Review",
            "description": "Use Azure Key Vault to store any secrets the application needs.  Key Vault provides a safe and audited environment for storing secrets and is well-integrated with App Service through the Key Vault SDK or App Service Key Vault References.",
            "guid": "834ac932-223e-4ce8-8b12-3071a5416415",
            "link": "https://learn.microsoft.com/azure/app-service/app-service-key-vault-references",
            "service": "App Service",
            "severity": "High",
            "text": "Use Key Vault to store secrets",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "Azure App Service Review",
            "description": "Use a Managed Identity to connect to Key Vault either using the Key Vault SDK or through App Service Key Vault References.",
            "guid": "833ea3ad-2c2d-4e73-8165-c3acbef4abe1",
            "link": "https://learn.microsoft.com/azure/app-service/app-service-key-vault-references",
            "service": "App Service",
            "severity": "High",
            "text": "Use Managed Identity to connect to Key Vault",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "Azure App Service Review",
            "description": "Store the App Service TLS certificate in Key Vault.",
            "guid": "f8d39fda-4776-4831-9c11-5775c2ea55b4",
            "link": "https://learn.microsoft.com/azure/app-service/configure-ssl-certificate",
            "service": "App Service",
            "severity": "High",
            "text": "Use Key Vault to store TLS certificate.",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "Azure App Service Review",
            "description": "Systems that process sensitive information should be isolated.  To do so, use separate App Service Plans or App Service Environments and consider the use of different subscriptions or management groups.",
            "guid": "6ad48408-ee72-4734-a475-ba18fdbf590c",
            "link": "https://learn.microsoft.com/azure/app-service/overview-hosting-plans",
            "service": "App Service",
            "severity": "Medium",
            "text": "Isolate systems that process sensitive information",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "Azure App Service Review",
            "description": "Local disks on App Service are not encrypted and sensitive data should not be stored on those.  (For example: D:\\\\Local and %TMP%).",
            "guid": "e65de8e0-3f9b-4cbd-9682-66abca264f9a",
            "link": "https://learn.microsoft.com/azure/app-service/operating-system-functionality#file-access",
            "service": "App Service",
            "severity": "Medium",
            "text": "Do not store sensitive data on local disk",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "Azure App Service Review",
            "description": "For authenticated web application, use a well established Identity Provider like Azure AD or Azure AD B2C.  Leverage the application framework of your choice to integrate with this provider or use the App Service Authentication / Authorization feature.",
            "guid": "919ca0b2-c121-459e-814b-933df574eccc",
            "link": "https://learn.microsoft.com/azure/app-service/overview-authentication-authorization",
            "service": "App Service",
            "severity": "Medium",
            "text": "Use an established Identity Provider for authentication",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "Azure App Service Review",
            "description": "Deploy code to App Service from a controlled and trusted environment, like a well-managed and secured DevOps deployment pipeline. This avoids code that was not version controlled and verified to be deployed from a malicious host.",
            "guid": "3f9bcbd4-6826-46ab-aa26-4f9a19aed9c5",
            "link": "https://learn.microsoft.com/azure/app-service/deploy-best-practices",
            "service": "App Service",
            "severity": "High",
            "text": "Deploy from a trusted environment",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "Azure App Service Review",
            "description": "Disable basic authentication for both FTP/FTPS and for WebDeploy/SCM.  This disables access to these services and enforces the use of Azure AD secured endpoints for deployment.  Note that the SCM site can also be opened using Azure AD credentials.",
            "guid": "5d04c2c3-919c-4a0b-8c12-159e114b933d",
            "link": "https://learn.microsoft.com/azure/app-service/deploy-configure-credentials#disable-basic-authentication",
            "service": "App Service",
            "severity": "High",
            "text": "Disable basic authentication",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "Azure App Service Review",
            "description": "Where possible use Managed Identity to connect to Azure AD secured resources.  If this is not possible, store secrets in Key Vault and connect to Key Vault using a Managed Identity instead.",
            "guid": "f574eccc-d9bd-43ba-bcda-3b54eb2eb03d",
            "link": "https://learn.microsoft.com/azure/app-service/overview-managed-identity?tabs=portal%2Chttp",
            "service": "App Service",
            "severity": "High",
            "text": "Use Managed Identity to connect to resources",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "Azure App Service Review",
            "description": "Where using images stored in Azure Container Registry, pull these using a Managed Identity.",
            "guid": "d9a25827-18d2-4ddb-8072-5769ee6691a4",
            "link": "https://learn.microsoft.com/azure/app-service/configure-custom-container#use-managed-identity-to-pull-image-from-azure-container-registry",
            "service": "App Service",
            "severity": "High",
            "text": "Pull containers using a Managed Identity",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "Azure App Service Review",
            "description": "By configuring the diagnostic settings of App Service, you can send all telemetry to Log Analytics as the central destination for logging and monitoring. This allows you to monitor runtime activity of App Service such as HTTP logs, application logs, platform logs, ...",
            "guid": "47768314-c115-4775-a2ea-55b46ad48408",
            "link": "https://learn.microsoft.com/azure/app-service/troubleshoot-diagnostic-logs",
            "service": "App Service",
            "severity": "Medium",
            "text": "Send App Service runtime logs to Log Analytics",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "Azure App Service Review",
            "description": "Set up a diagnostic setting to send the activity log to Log Analytics as the central destination for logging and monitoring. This allows you to monitor control plane activity on the App Service resource itself.",
            "guid": "ee72734b-475b-4a18-bdbf-590ce65de8e0",
            "link": "https://learn.microsoft.com/azure/azure-monitor/essentials/activity-log",
            "service": "App Service",
            "severity": "Medium",
            "text": "Send App Service activity logs to Log Analytics",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "Azure App Service Review",
            "description": "Control outbound network access using a combination of regional VNet integration, network security groups and UDR's.  Traffic should be routed to an NVA such as Azure Firewall.  Ensure to monitor the Firewall's logs.",
            "guid": "c12159e1-14b9-433d-b574-ecccd9bd3baf",
            "link": "https://learn.microsoft.com/azure/app-service/overview-vnet-integration",
            "service": "App Service",
            "severity": "Medium",
            "text": "Outbound network access should be controlled",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "Azure App Service Review",
            "description": "You can provide a stable outbound IP by using VNet integration and using a VNet NAT Gateway or an NVA like Azure Firewall.  This allows the receiving party to allow-list based on IP, should that be needed.  Note that for communications towards Azure Services often there's no need to depend on the IP address and mechanics like Service Endpoints should be used instead.  (Also the use of private endpoints on the receiving end avoids for SNAT to happen and provides a stable outbound IP range.)",
            "guid": "cda3b54e-b2eb-403d-b9a2-582718d2ddb1",
            "link": "https://learn.microsoft.com/azure/app-service/networking/nat-gateway-integration",
            "service": "App Service",
            "severity": "Low",
            "text": "Ensure a stable IP for outbound communications towards internet addresses",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "Azure App Service Review",
            "description": "Control inbound network access using a combination of App Service Access Restrictions, Service Endpoints or Private Endpoints. Different access restrictions can be required and configured for the web app itself and the SCM site.",
            "guid": "0725769e-e669-41a4-a34a-c932223ece80",
            "link": "https://learn.microsoft.com/azure/app-service/networking-features#access-restrictions",
            "service": "App Service",
            "severity": "High",
            "text": "Inbound network access should be controlled",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "Azure App Service Review",
            "description": "Protect against malicious inbound traffic using a Web Application Firewall like Application Gateway or Azure Front Door.  Make sure to monitor the WAF's logs.",
            "guid": "b123071a-5416-4415-a33e-a3ad2c2de732",
            "link": "https://learn.microsoft.com/azure/app-service/networking/app-gateway-with-service-endpoints",
            "service": "App Service",
            "severity": "High",
            "text": "Use a WAF in front of App Service",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "Azure App Service Review",
            "description": "Make sure the WAF cannot be bypassed by locking down access to only the WAF.  Use a combination of Access Restrictions, Service Endpoints and Private Endpoints.",
            "guid": "165c3acb-ef4a-4be1-b8d3-9fda47768314",
            "link": "https://learn.microsoft.com/azure/app-service/networking-features#access-restrictions",
            "service": "App Service",
            "severity": "High",
            "text": "Avoid for WAF to be bypassed",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "Azure App Service Review",
            "description": "Set minimum TLS policy to 1.2 in App Service configuration.",
            "graph": "appserviceresources | where type =~ 'microsoft.web/sites/config' | extend compliant = (properties.MinTlsVersion>=1.2) | distinct id,compliant",
            "guid": "c115775c-2ea5-45b4-9ad4-8408ee72734b",
            "link": "https://learn.microsoft.com/azure/app-service/configure-ssl-bindings#enforce-tls-versions",
            "service": "App Service",
            "severity": "Medium",
            "text": "Set minimum TLS policy to 1.2",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "Azure App Service Review",
            "description": "Configure App Service to use HTTPS only.  This causes App Service to redirect from HTTP to HTTPS.  Strongly consider the use of HTTP Strict Transport Security (HSTS) in your code or from your WAF, which informs browsers that the site should only be accessed using HTTPS.",
            "graph": "where (type=='microsoft.web/sites' and (kind == 'app' or kind == 'app,linux' )) | extend compliant = (properties.httpsOnly==true) | distinct id,compliant",
            "guid": "475ba18f-dbf5-490c-b65d-e8e03f9bcbd4",
            "link": "https://learn.microsoft.com/azure/app-service/configure-ssl-bindings#enforce-https",
            "service": "App Service",
            "severity": "High",
            "text": "Use HTTPS only",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "Azure App Service Review",
            "description": "Do not use wildcards in your CORS configuration, as this allows all origins to access the service (thereby defeating the purpose of CORS). Specifically only allow the origins that you expect to be able to access the service.",
            "guid": "68266abc-a264-4f9a-89ae-d9c55d04c2c3",
            "link": "https://learn.microsoft.com/azure/app-service/app-service-web-tutorial-rest-api",
            "service": "App Service",
            "severity": "High",
            "text": "Wildcards must not be used for CORS",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "Azure App Service Review",
            "description": "Remote debugging must not be turned on in production as this opens additional ports on the service which increases the attack surface. Note that the service does turn of remote debugging automatically after 48 hours.",
            "graph": "appserviceresources | where type =~ 'microsoft.web/sites/config' | extend compliant = (properties.RemoteDebuggingEnabled == false) | distinct id,compliant",
            "guid": "d9bd3baf-cda3-4b54-bb2e-b03dd9a25827",
            "link": "https://learn.microsoft.com/azure/app-service/configure-common#configure-general-settings",
            "service": "App Service",
            "severity": "High",
            "text": "Turn off remote debugging",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "Azure App Service Review",
            "description": "Enable Defender for App Service.  This (amongst other threats) detects communications to known malicious IP addresses.  Review the recommendations from Defender for App Service as part of your operations.",
            "guid": "18d2ddb1-0725-4769-be66-91a4834ac932",
            "link": "https://learn.microsoft.com/azure/defender-for-cloud/defender-for-app-service-introduction",
            "service": "App Service",
            "severity": "Medium",
            "text": "Enable Defender for Cloud - Defender for App Service",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "Azure App Service Review",
            "description": "Azure provides DDoS Basic protection on its network, which can be improved with intelligent DDoS Standard capabilities which learns about normal traffic patterns and can detect unusual behavior. DDoS Standard applies to a Virtual Network so it must be configured for the network resource in front of the app, such as Application Gateway or an NVA.",
            "guid": "223ece80-b123-4071-a541-6415833ea3ad",
            "link": "https://learn.microsoft.com/azure/ddos-protection/ddos-protection-overview",
            "service": "App Service",
            "severity": "Medium",
            "text": "Enable DDOS Protection Standard on the WAF VNet",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "Azure App Service Review",
            "description": "Where using images stored in Azure Container Registry, pull these over a virtual network from Azure Container Registry using its private endpoint and the app setting 'WEBSITE_PULL_IMAGE_OVER_VNET'.",
            "guid": "2c2de732-165c-43ac-aef4-abe1f8d39fda",
            "link": "https://learn.microsoft.com/azure/app-service/configure-custom-container#use-an-image-from-a-network-protected-registry",
            "service": "App Service",
            "severity": "Medium",
            "text": "Pull containers over a Virtual Network",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "Azure App Service Review",
            "description": "Conduct a penetration test on the web application following the penetration testing rules of engagement.",
            "guid": "eb2eb03d-d9a2-4582-918d-2ddb10725769",
            "link": "https://learn.microsoft.com/azure/security/fundamentals/pen-testing",
            "service": "App Service",
            "severity": "Medium",
            "text": "Conduct a penetration test",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "Azure App Service Review",
            "description": "Deploy trusted code that was validated and scanned for vulnerabilities according to DevSecOps practices.",
            "guid": "19aed9c5-5d04-4c2c-9919-ca0b2c12159e",
            "link": "https://learn.microsoft.com/azure/architecture/solution-ideas/articles/devsecops-in-azure",
            "service": "App Service",
            "severity": "Medium",
            "text": "Deploy validated code",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "Azure App Service Review",
            "description": "Use the latest versions of supported platforms, programming languages, protocols, and frameworks.",
            "guid": "114b933d-f574-4ecc-ad9b-d3bafcda3b54",
            "link": "https://learn.microsoft.com/azure/app-service/overview-patch-os-runtime",
            "service": "App Service",
            "severity": "High",
            "text": "Use up-to-date platforms, languages, protocols and frameworks",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Devices/IotHubs",
            "checklist": "IoT Hub Review",
            "guid": "ac1d6380-f866-4bbd-a9b4-b1ee5d7908b8",
            "link": "https://learn.microsoft.com/azure/iot-hub/iot-hub-ha-dr#availability-zones",
            "service": "IoT Hub",
            "severity": "High",
            "text": "Leverage  Availability Zones if regionally applicable (this is automatically enabled)",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Devices/IotHubs",
            "checklist": "IoT Hub Review",
            "guid": "35f651e8-0124-4ef7-8c57-658e38609e6e",
            "link": "https://learn.microsoft.com/azure/iot-hub/iot-hub-ha-dr#microsoft-initiated-failover",
            "service": "IoT Hub",
            "severity": "Medium",
            "text": "Be aware of Microsoft-initiated failovers. These are exercised by Microsoft in rare situations to fail over all the IoT hubs from an affected region to the corresponding geo-paired region.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Devices/IotHubs",
            "checklist": "IoT Hub Review",
            "guid": "4ed3e490-dc06-4a1e-b467-5d0239d85540",
            "link": "https://learn.microsoft.com/azure/iot-hub/iot-hub-ha-dr#cross-region-dr",
            "service": "IoT Hub",
            "severity": "High",
            "text": "Consider a Cross-Region DR strategy for critical workloads",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Devices/IotHubs",
            "checklist": "IoT Hub Review",
            "guid": "a11ecab0-db47-46f7-9aa7-17764e7e45a1",
            "link": "https://learn.microsoft.com/azure/iot-hub/iot-hub-ha-dr#microsoft-initiated-failover",
            "service": "IoT Hub",
            "severity": "High",
            "text": "Learn how to trigger a manual failover.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Devices/IotHubs",
            "checklist": "IoT Hub Review",
            "guid": "f9db8dfb-1194-460b-aedd-34dd6a69db22",
            "link": "https://learn.microsoft.com/azure/iot-hub/iot-hub-ha-dr#failback",
            "service": "IoT Hub",
            "severity": "High",
            "text": "Learn how to fail back after a failover.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachineScaleSets",
            "checklist": "Resiliency Review",
            "description": "Automatic instance repairs ensure that unhealthy instances are promptly identified and replaced, maintaining a set of healthy instances within your scale set.",
            "guid": "7e13c105-675c-41e9-95b4-59837ff7ae7c",
            "link": "https://learn.microsoft.com/azure/virtual-machine-scale-sets/virtual-machine-scale-sets-automatic-instance-repairs",
            "service": "VMSS",
            "severity": "Low",
            "text": "Enable automatic instance repairs for enhanced VM Scale Sets resiliency",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "Resiliency Review",
            "description": "Ensure that Azure Backup is utilized appropriately to meet your organization's resiliency requirements for Azure virtual machines (VMs).",
            "guid": "4d874a74-8b66-42d6-b150-512a66498f6d",
            "link": "https://learn.microsoft.com/azure/backup/backup-azure-vms-introduction",
            "service": "VM",
            "severity": "High",
            "text": "Consider Azure Backup to meet your resiliency requirements for Azure VMs",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "Resiliency Review",
            "description": "Single Instance VMs using Premium SSD or Ultra Disk for all Operating System Disks and Data Disks are guaranteed to have Virtual Machine Connectivity of at least 99.9%",
            "guid": "8052d88e-79d1-47b7-9b22-a5a67e7a8ed4",
            "link": "https://learn.microsoft.com/azure/virtual-machines/disks-types",
            "service": "VM",
            "severity": "High",
            "text": "Use Premium or Ultra disks for production VMs",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "Resiliency Review",
            "description": "Azure automatically replicates managed disks within a region to ensure data durability and protect against single-point failures.",
            "guid": "b31e38c3-f298-412b-8363-cffe179b599d",
            "link": "https://learn.microsoft.com/azure/virtual-machines/managed-disks-overview",
            "service": "VM",
            "severity": "High",
            "text": "Ensure Managed Disks are used for all VMs",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "Resiliency Review",
            "description": "Temporary disks are intended for short-term storage of non-persistent data such as page files, swap files, or SQL Server tempdb. Storing persistent data on temporary disks can lead to data loss during maintenance events or VM redeployment.",
            "guid": "e0d5973c-d4ce-432c-8881-37f6f7c4c0d4",
            "link": "https://learn.microsoft.com/azure/virtual-machines/managed-disks-overview#temporary-disk",
            "service": "VM",
            "severity": "Medium",
            "text": "Do not use the Temp disk for anything that is not acceptable to be lost",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "Resiliency Review",
            "description": "Co-locate your compute, storage, networking, and data resources across an availability zone, and replicate this arrangement in other availability zones.",
            "guid": "e514548d-2447-4ec6-9138-b8200f1ce16e",
            "link": "https://learn.microsoft.com/azure/reliability/availability-zones-overview",
            "service": "VM",
            "severity": "Medium",
            "text": "Leverage Availability Zones for your VMs in regions where they are supported",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "Resiliency Review",
            "description": "Use at least two VMs in Availability Sets to isolate VMs on different fault and update domains.",
            "guid": "5a785d6f-e96c-496a-b884-4cf3b2b38c88",
            "link": "https://learn.microsoft.com/azure/virtual-machines/availability-set-overview",
            "service": "VM",
            "severity": "Medium",
            "text": "For regions that do not support Availability Zones deploy VMs into Availability Sets",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "Resiliency Review",
            "description": "Azure provides multiple options for VM redundancy to meet different requirements (Availability Zones, Virtual Machine Scale Sets, Availability Sets, Azure Site Recovery)",
            "guid": "6ba2c021-4991-414a-9d3c-e574dccbd979",
            "link": "https://learn.microsoft.com/azure/virtual-machines/availability",
            "service": "VM",
            "severity": "High",
            "text": "Avoid running a production workload on a single VM",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "Resiliency Review",
            "description": "Azure Site Recovery enables you to achieve low RTO (Recovery Time Objective) for your Azure and hybrid VMs by providing continuous replication and failover capabilities.",
            "guid": "2a6bcca2-b5fe-4a1e-af3d-d95d48c7c891",
            "link": "https://learn.microsoft.com/azure/site-recovery/site-recovery-overview",
            "service": "VM",
            "severity": "High",
            "text": "For Azure and on-premises VMs (Hyper-V/Phyiscal/VMware) with low RTO requirements use Azure Site Recovery",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "Resiliency Review",
            "description": "By using Capacity Reservations, you can effectively manage capacity for critical workloads, ensuring resource availability in specified regions.",
            "guid": "bd7bb012-f7b9-45e0-9e15-8e3ea3992c2d",
            "link": "https://learn.microsoft.com/azure/virtual-machines/capacity-reservation-overview",
            "service": "VM",
            "severity": "Low",
            "text": "Use Capacity Reservations for critical workloads that require guaranteed capacity",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "Resiliency Review",
            "description": "By ensuring that the necessary quotas are increased in your DR region before testing failover with ASR, you can avoid any potential resource constraints during the recovery process for failed over VMs.",
            "guid": "e6e2065b-3a76-4af4-a691-e8939ada4666",
            "link": "https://learn.microsoft.com/azure/quotas/per-vm-quota-requests",
            "service": "VM",
            "severity": "Medium",
            "text": "Increase quotas in DR region before testing failover with ASR",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "Resiliency Review",
            "description": "Scheduled Events is an Azure Metadata Service that provides information about upcoming maintenance events for virtual machines (VMs). By leveraging Scheduled Events, you can proactively prepare your applications for VM maintenance, minimizing disruption and improving the availability of your VMs.",
            "guid": "6d3b475a-5c7a-4cbe-99bb-e64dd8902e87",
            "link": "https://learn.microsoft.com/azure/virtual-machines/windows/scheduled-events",
            "service": "VM",
            "severity": "Low",
            "text": "Utilize Scheduled Events to prepare for VM maintenance",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "Resiliency Review",
            "description": "Use Zone-redundant Storage (ZRS) in the primary region for scenarios that require high availability and for restricting replication to a particular country or region. For protection against regional disasters, use Geo-zone-redundant Storage (GZRS), which combines ZRS in the primary region with geo-replication to a secondary region?.",
            "guid": "48c7c891-dcb1-4f7d-9769-ae568ba38d4a",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-redundancy",
            "service": "Storage",
            "severity": "Medium",
            "text": "Choose the most appropriate data redundancy option for Azure Storage based on your requirements",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "Resiliency Review",
            "description": "Assigning a Delete lock to your storage account helps protect the availability of your data, minimizing the risk of disruptions to your business operations.",
            "guid": "85e2213d-bd7b-4b01-8f7b-95e06e158e3e",
            "link": "https://learn.microsoft.com/azure/storage/common/lock-account-resource",
            "service": "Storage",
            "severity": "Low",
            "text": "Apply a Delete lock to prevent accidental or malicious deletion of storage accounts",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "Resiliency Review",
            "description": "Container soft delete protects your data from being accidentally deleted by maintaining the deleted data in the system for a specified period of time.",
            "guid": "a3992c2d-e6e2-4065-a3a7-6af4a691e893",
            "link": "https://learn.microsoft.com/azure/storage/blobs/soft-delete-container-enable",
            "service": "Storage",
            "severity": "Low",
            "text": "Enable soft delete for Storage Account Containers",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "Resiliency Review",
            "description": "Blob soft delete protects an individual blob and its versions, snapshots, and metadata from accidental deletes or overwrites by maintaining the deleted data in the system for a specified period of time.",
            "guid": "9ada4666-7e13-4c10-96b9-153d89f89dc7",
            "link": "https://learn.microsoft.com/azure/storage/blobs/soft-delete-blob-enable",
            "service": "Storage",
            "severity": "Low",
            "text": "Enable soft delete for blobs",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.RecoveryServices/vaults",
            "checklist": "Resiliency Review",
            "description": "Azure Backup enhanced soft delete provides critical protection against ransomware attacks by retaining deleted backups, enabling recovery from potential ransomware encryption or deletion.",
            "guid": "b44be3b1-a27f-48b9-b91b-e1038df03a82",
            "link": "https://learn.microsoft.com/azure/backup/backup-azure-enhanced-soft-delete-about",
            "service": "Backup",
            "severity": "Medium",
            "text": "Enable Azure Backup enhanced soft delete for improved data protection and recovery",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.RecoveryServices/vaults",
            "checklist": "Resiliency Review",
            "description": "Azure Backup's multi-user authorization enables fine-grained control over user access to backup resources, allowing you to restrict privileges and ensure proper authentication and authorization for backup operations.",
            "guid": "2cd463cb-bbc8-4ac2-a9eb-c92a43da1dae",
            "link": "https://learn.microsoft.com/azure/backup/multi-user-authorization-concept",
            "service": "Backup",
            "severity": "Low",
            "text": "Implement multi-user authorization for Azure Backup to ensure secure and controlled access to backup resources",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.RecoveryServices/vaults",
            "checklist": "Resiliency Review",
            "description": "Azure Immutable Storage provides an additional layer of security by ensuring that backup data stored in the vault cannot be modified or deleted for a specified retention period. This helps safeguard your backups from ransomware attacks that may attempt to compromise or manipulate your backup data.",
            "guid": "2cc88147-0607-4c1c-aa0e-614658dd458e",
            "link": "https://learn.microsoft.com/azure/backup/backup-azure-immutable-vault-concept?source=recommendations&tabs=recovery-services-vault",
            "service": "Backup",
            "severity": "Low",
            "text": "Implement Immutable Storage for your vaults to protect against ransomware and prevent unauthorized modifications to backups",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Network/dnsZones",
            "checklist": "Resiliency Review",
            "description": "To eliminate a single point of failure in your on-premises DNS services and ensure reliable DNS resolution during business continuity and disaster recovery scenarios, it is recommended to utilize Azure DNS Private Resolvers in multiple regions. By deploying two or more Azure DNS private resolvers across different regions, you can enable DNS failover and achieve resiliency in your DNS infrastructure.",
            "guid": "43da1dae-2cc8-4814-9060-7c1cca0e6146",
            "link": "https://learn.microsoft.com/azure/dns/tutorial-dns-private-resolver-failover",
            "service": "DNS",
            "severity": "Low",
            "text": "Implement DNS Failover using Azure DNS Private Resolvers",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.PowerBI/gateways",
            "checklist": "Resiliency Review",
            "description": "Use an on-premises data gateway cluster to avoid single points of failure and to load balance traffic across gateways.",
            "guid": "89f89dc7-b44b-4e3b-8a27-f8b9e91be103",
            "link": "https://learn.microsoft.com/data-integration/gateway/service-gateway-high-availability-clusters",
            "service": "Data Gateways",
            "severity": "Medium",
            "text": "Use on-premises data gateway clusters to ensure high availability for business-critical data",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "Resiliency Review",
            "description": "When choosing the best option for deploying NVAs in Azure, it is crucial to consider the vendor's recommendations and validate that the specific design has been vetted and validated by the NVA vendor. The vendor should also provide the necessary NVA configuration for seamless integration in Azure.",
            "guid": "8b1188b3-c6a4-46ce-a544-451e192d3442",
            "link": "https://learn.microsoft.com/azure/architecture/reference-architectures/dmz/nva-ha",
            "service": "NVA",
            "severity": "High",
            "text": "Deploy Network Virtual Appliances (NVAs) in a vendor supported configuration for High Availability",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.KeyVault/vaults",
            "checklist": "Azure Key Vault",
            "guid": "6d37a33b-531c-4a91-871a-b69d8044f04e",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "severity": "High",
            "text": "Familiarize yourself with the Key Vault's best practices such as isolation recommendations, access control, data protection, backup, and logging.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.KeyVault/vaults",
            "checklist": "Azure Key Vault",
            "guid": "7ba4d380-7b9e-4a8b-a0c3-2d8e49c11872",
            "link": "https://learn.microsoft.com/azure/key-vault/general/disaster-recovery-guidance",
            "service": "Key Vault",
            "severity": "Medium",
            "text": "Key Vault is a managed service and Microsoft will handle the failover within and across region. Familiarize yourself with the Key Vault's availability and redundancy.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.KeyVault/vaults",
            "checklist": "Azure Key Vault",
            "guid": "17fb86a2-eb45-42a4-9c34-52b92a2a1842",
            "link": "https://learn.microsoft.com/azure/key-vault/general/disaster-recovery-guidance#data-replication",
            "service": "Key Vault",
            "severity": "Medium",
            "text": "The contents of your key vault are replicated within the region and to a secondary region at least 150 miles away, but within the same geography to maintain high durability of your keys and secrets. Familiarize yourself with the Key Vault's data replication.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.KeyVault/vaults",
            "checklist": "Azure Key Vault",
            "guid": "614682ca-6e0c-4f34-9f03-c6d3f2b99a32",
            "link": "https://learn.microsoft.com/azure/key-vault/general/disaster-recovery-guidance#failover-across-regions",
            "service": "Key Vault",
            "severity": "Medium",
            "text": "During failover, access policy or firewall configurations and settings can't be changed. The key vault will be in read-only mode during failover. Familiarize yourself with the Key Vault's failover guidance.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.KeyVault/vaults",
            "checklist": "Azure Key Vault",
            "guid": "9ef2b0d2-3206-4c94-b47a-4f07e6a1c509",
            "link": "https://learn.microsoft.com/azure/key-vault/general/backup?tabs=azure-cli#design-considerations",
            "service": "Key Vault",
            "severity": "Medium",
            "text": "When you back up a key vault object, such as a secret, key, or certificate, the backup operation will download the object as an encrypted blob. This blob can't be decrypted outside of Azure. To get usable data from this blob, you must restore the blob into a key vault within the same Azure subscription and Azure geography. Familiarize yourself with the Key Vault's backup and restore guidance.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.KeyVault/vaults",
            "checklist": "Azure Key Vault",
            "guid": "2df045b1-c0f6-47d3-9a9b-99cf6999684e",
            "link": "https://learn.microsoft.com/azure/key-vault/general/soft-delete-overview",
            "service": "Key Vault",
            "severity": "High",
            "text": "If you want protection against accidental or malicious deletion of your secrets, configure soft-delete and purge protection features on your key vault.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.KeyVault/vaults",
            "checklist": "Azure Key Vault",
            "guid": "cbfa96b0-5249-4e6f-947c-d0e79509708c",
            "link": "https://learn.microsoft.com/azure/key-vault/general/soft-delete-overview",
            "service": "Key Vault",
            "severity": "Low",
            "text": "Key Vault's soft-deleted resources are retained for a set period of 90 calendar days. Familiarize yourself with the Key Vault's soft-delete guidance.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.KeyVault/vaults",
            "checklist": "Azure Key Vault",
            "guid": "e8659d11-7e02-4db0-848c-c6541dbab68c",
            "link": "https://learn.microsoft.com/azure/key-vault/general/backup?tabs=azure-cli#limitations",
            "service": "Key Vault",
            "severity": "Low",
            "text": "Understand Key Vault's backup limitations. Key Vault does not support the ability to backup more than 500 past versions of a key, secret, or certificate object. Attempting to backup a key, secret, or certificate object may result in an error. It is not possible to delete previous versions of a key, secret, or certificate.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.KeyVault/vaults",
            "checklist": "Azure Key Vault",
            "guid": "45c25e29-d0ef-4f07-aa04-0f8c64cbcc04",
            "link": "https://learn.microsoft.com/azure/key-vault/general/backup?tabs=azure-cli#limitations",
            "service": "Key Vault",
            "severity": "Low",
            "text": "Key Vault doesn't currently provide a way to back up an entire key vault in a single operation and keys, secrets and certitificates must be backup indvidually. Familiarize yourself with the Key Vault's backup and restore guidance.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.KeyVault/vaults",
            "checklist": "Azure Key Vault",
            "guid": "0f15640b-31e5-4de6-85a7-d2c652fa09d3",
            "link": "https://learn.microsoft.com/azure/key-vault/general/soft-delete-overview#purge-protection",
            "service": "Key Vault",
            "severity": "Medium",
            "text": "Purge protection is recommended when using keys for encryption to prevent data loss. Purge protection is an optional Key Vault behavior and is not enabled by default. Purge protection can only be enabled once soft-delete is enabled. It can be turned on via CLI, PowerShell or Portal.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.KeyVault/vaults",
            "checklist": "Azure Key Vault",
            "graph": "resources| where type =~ 'microsoft.keyvault/vaults' | extend compliant = (properties.enableRbacAuthorization == true) | distinct id, compliant",
            "guid": "d0642c1c-312b-4116-94ab-439e1c836819",
            "link": "https://learn.microsoft.com/azure/key-vault/general/rbac-guide?tabs=azure-cli",
            "service": "Key Vault",
            "severity": "Medium",
            "text": "RBAC is recommended to control access to your key vault. Familiarize yourself with the Key Vault's access control guidance.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Kusto/clusters",
            "checklist": "Azure Data Explorer Review Checklist",
            "description": "Using the correct approach to feed a datalake with cold data and having the Kusto query engine at your disposal at the same time, as in the short-term storage",
            "guid": "ba7da7be-9951-4914-a384-5d997cb39132",
            "link": "https://learn.microsoft.com/azure/data-explorer/kusto/management/data-export/continuous-data-export",
            "service": "Data Explorer",
            "text": "Leverage External Tables and Continuous data export overview to reduce costs",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Kusto/clusters",
            "checklist": "Azure Data Explorer Review Checklist",
            "description": "Azure Data Explorer provides an optional follower capability for a leader cluster to be followed by other follower clusters for read-only access to the leader's data and metadata. Changes in the leader, such as create, append, and drop are automatically synchronized to the follower. While the leaders could span Azure regions, the follower clusters should be hosted in the same region(s) as the leader. If the leader cluster is down or databases or tables are accidentally dropped, the follower clusters will lose access until access is recovered in the leader.",
            "guid": "56a22586-f490-4641-addd-ea8a377cdeb3",
            "link": "https://learn.microsoft.com/azure/data-explorer/follower?tabs=csharp",
            "service": "Data Explorer",
            "text": "To share data, explore Leader-follower cluster configuration",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Kusto/clusters",
            "checklist": "Azure Data Explorer Review Checklist",
            "description": "Azure Data Explorer doesn't support automatic protection against the outage of an entire Azure region. This disruption can happen during a natural disaster, like an earthquake. If you require a solution for a disaster recovery situation, do the following steps to ensure business continuity. In these steps, you'll replicate your clusters, management, and data ingestion in two Azure paired regions.",
            "guid": "861bb2bc-14ae-4a6e-95d8-d9a3adc218e6",
            "link": "https://learn.microsoft.com/azure/data-explorer/business-continuity-create-solution#create-multiple-independent-clusters",
            "service": "Data Explorer",
            "text": "To protect against regional failure, create Multiple independent clusters, preferably in two Azure Paired regions",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Kusto/clusters",
            "checklist": "Azure Data Explorer Review Checklist",
            "guid": "436b0635-cb45-4e57-a603-324ace8cc123",
            "link": "https://learn.microsoft.com/azure/data-explorer/business-continuity-create-solution#replicate-management-activities",
            "service": "Data Explorer",
            "text": "Replicate all management activities such as creating new tables or managing user roles on each cluster.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Kusto/clusters",
            "checklist": "Azure Data Explorer Review Checklist",
            "guid": "18ca6017-0265-4f4b-a46a-393af7f31728",
            "link": "https://learn.microsoft.com/azure/data-explorer/business-continuity-create-solution",
            "service": "Data Explorer",
            "text": "Ingest data into each cluster in parallel",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Kusto/clusters",
            "checklist": "Azure Data Explorer Review Checklist",
            "description": "This configuration is also called 'always-on'. For critical application deployments with no tolerance for outages, you should use multiple Azure Data Explorer clusters across Azure paired regions.",
            "guid": "58a9c279-9c42-4bb6-9d0c-65556246b338",
            "link": "https://learn.microsoft.com/azure/data-explorer/business-continuity-overview#active-active-active-configuration",
            "service": "Data Explorer",
            "text": "For critical application with no tolerance for outages, create Active-Active-Active (always-on) configuration",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Kusto/clusters",
            "checklist": "Azure Data Explorer Review Checklist",
            "description": "This configuration is identical to the active-active-active configuration, but only involves two Azure paired regions. Configure dual ingestion, processing, and curation. Users are routed to the nearest region. The cluster SKU must be the same across regions.",
            "guid": "563a4dc7-4a74-48b6-922a-d190916a6649",
            "link": "https://learn.microsoft.com/azure/data-explorer/business-continuity-overview#active-active-configuration",
            "service": "Data Explorer",
            "text": "For critical applications, create Active-Active configuration in two paired regions",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Kusto/clusters",
            "checklist": "Azure Data Explorer Review Checklist",
            "description": "The Active-Hot configuration is similar to the Active-Active configuration in dual ingest, processing, and curation. While the standby cluster is online for ingestion, process, and curation, it isn't available to query. The standby cluster doesn't need to be in the same SKU as the primary cluster. It can be of a smaller SKU and scale, which may result in it being less performant. In a disaster scenario, users are redirected to the standby cluster, which can optionally be scaled up to increase performance.",
            "guid": "8fadfe27-7de2-483b-8ac3-52baa9b75708",
            "link": "https://learn.microsoft.com/azure/data-explorer/business-continuity-overview#active-hot-standby-configuration",
            "service": "Data Explorer",
            "text": "For applications, which required only read during failure, create Active-Hot standby configuration",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Kusto/clusters",
            "checklist": "Azure Data Explorer Review Checklist",
            "description": "This solution offers the least resiliency (highest RPO and RTO), is the lowest in cost and highest in effort. In this configuration, there's no data recovery cluster. Configure continuous export of curated data (unless raw and intermediate data is also required) to a storage account that is configured GRS (Geo Redundant Storage). A data recovery cluster is spun up if there is a disaster recovery scenario. At that time, DDLs, configuration, policies, and processes are applied. Data is ingested from storage with the ingestion property kustoCreationTime to over-ride the ingestion time that defaults to system time.",
            "guid": "49aa8092-dc8e-4b9d-8bb7-3b26a5a67eba",
            "link": "https://learn.microsoft.com/azure/data-explorer/business-continuity-overview#on-demand-data-recovery-configuration",
            "service": "Data Explorer",
            "text": "For applications, where cost is a concern and can withstand some downtime during failure, create on-demand data recovery cluster configuration",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Kusto/clusters",
            "checklist": "Azure Data Explorer Review Checklist",
            "description": "All database objects, policies, and configurations should be persisted in source control so they can be released to the cluster from your release automation tool.",
            "guid": "5a907e1e-348e-4f25-9c27-d32e8bbac757",
            "link": "https://learn.microsoft.com/azure/data-explorer/devops",
            "service": "Data Explorer",
            "text": "Wrap DevOps and source control around all your code",
            "training": "https://learn.microsoft.com/learn/paths/secure-your-cloud-data/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Kusto/clusters",
            "checklist": "Azure Data Explorer Review Checklist",
            "guid": "1559ab91-53e8-4908-ae28-b84c33b6b780",
            "link": "https://learn.microsoft.com/azure/data-explorer/devops",
            "service": "Data Explorer",
            "text": "Design, develop, and implement validation routines to ensure all clusters are in-sync from a data perspective.",
            "training": "https://learn.microsoft.com/learn/modules/azure-active-directory/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Kusto/clusters",
            "checklist": "Azure Data Explorer Review Checklist",
            "guid": "8b9fe5c4-1049-4d40-9a82-2c3474d00f18",
            "link": "https://learn.microsoft.com/azure/data-explorer/devops",
            "service": "Data Explorer",
            "text": "Be fully cognizant of what it takes to build a cluster from scratch. Leverage Infrastructure as a Code for your deployments",
            "training": "https://learn.microsoft.com/learn/modules/implement-hybrid-identity-windows-server/",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "4620dc87-e948-4ce8-8426-f3e6e5d7bd85",
            "link": "https://learn.microsoft.com/azure/sap/center-sap-solutions/overview",
            "service": "SAP",
            "severity": "Medium",
            "text": "Azure Center for SAP solutions (ACSS) is an Azure offering that makes SAP a top-level workload on Azure. ACSS is an end-to-end solution that enables you to create and run SAP systems as a unified workload on Azure and provides a more seamless foundation for innovation. You can take advantage of the management capabilities for both new and existing Azure-based SAP systems.",
            "training": "https://learn.microsoft.com/training/modules/explore-azure-center-sap-solutions/?source=recommendations",
            "waf": "Operations"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "5d75e99d-624d-4afe-91d9-e17adc580790",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/sap/eslz-platform-automation-and-devops",
            "service": "SAP",
            "severity": "Medium",
            "text": "Azure supports automating SAP deployments in Linux and Windows. SAP Deployment Automation Framework is an open-source orchestration tool that can deploy, install, and maintain SAP environments.",
            "training": "https://github.com/Azure/sap-automation",
            "waf": "Operations"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "d17f6f39-a377-48a2-931f-5ead3ebe33a8",
            "link": "https://learn.microsoft.com/azure/well-architected/sap/design-areas/data-platform",
            "service": "SAP",
            "severity": "Medium",
            "text": "Perform a point-in-time recovery for your production databases at any point and in a time frame that meets your RTO; point-in-time recovery typically includes operator errors deleting data either on the DBMS layer or through SAP, incidentally",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "c4b8e117-930b-4dbd-ae50-7bc5faf6f91a",
            "service": "SAP",
            "severity": "Medium",
            "text": "Test the backup and recovery times to verify that they meet your RTO requirements for restoring all systems simultaneously after a disaster.",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "b651423c-8552-42db-a545-5cb50c05527a",
            "link": "https://learn.microsoft.com/azure/reliability/cross-region-replication-azure",
            "service": "SAP",
            "severity": "High",
            "text": "You can replicate standard storage between paired regions, but you can't use standard storage to store your databases or virtual hard disks. You can replicate backups only between paired regions that you use. For all your other data, run your replication by using native DBMS features like SQL Server Always On or SAP HANA System Replication. Use a combination of Site Recovery, rsync or robocopy, and other third-party software for the SAP application layer.",
            "training": "https://learn.microsoft.com/training/paths/ensure-business-continuity-implement-disaster-recovery/",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "aa208dca-784f-46c6-9014-cc919c542dc9",
            "link": "https://learn.microsoft.com/azure/sap/workloads/high-availability-zones",
            "service": "SAP",
            "severity": "Medium",
            "text": "When using Azure Availability Zones to achieve high availability, you must consider latency between SAP application servers and database servers. For zones with high latencies, operational procedures need to be in place to ensure that SAP application servers and database servers are running in the same zone at all times.",
            "training": "https://learn.microsoft.com/training/modules/implement-high-availability-for-sap-workloads-azure/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "ba07c007-1f90-43e9-aa4f-601346b80352",
            "link": "https://learn.microsoft.com/azure/expressroute/designing-for-disaster-recovery-with-expressroute-privatepeering",
            "service": "SAP",
            "severity": "High",
            "text": "Set up ExpressRoute connections from on-premises to the primary and secondary Azure disaster recovery regions. Also, as an alternative to using ExpressRoute, consider setting up VPN connections from on-premises to the primary and secondary Azure disaster recovery regions.",
            "training": "https://learn.microsoft.com/azure/expressroute/use-s2s-vpn-as-backup-for-expressroute-privatepeering",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "d2b30195-b11d-4a8f-a672-28b2b4169a7c",
            "link": "https://learn.microsoft.com/azure/key-vault/general/disaster-recovery-guidance",
            "service": "SAP",
            "severity": "Low",
            "text": "Replicate key vault contents like certificates, secrets, or keys across regions so you can decrypt data in the DR region.",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "05f1101d-250f-40e7-b2a1-b674ab50edbd",
            "link": "https://learn.microsoft.com/azure/architecture/guide/sap/sap-s4hana",
            "service": "SAP",
            "severity": "Medium",
            "text": "Peer the primary and disaster recovery virtual networks. For example, for HANA System Replication, an SAP HANA DB virtual network needs to be peered to the disaster recovery site's SAP HANA DB virtual network.",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "d3351bf7-628a-46de-917d-dfc11d3b6b40",
            "link": "https://learn.microsoft.com/azure/azure-netapp-files/azure-netapp-files-service-levels",
            "service": "SAP",
            "severity": "Low",
            "text": "If you use Azure NetApp Files storage for your SAP deployments, at a minimum, create two Azure NetApp Files accounts in the Premium tier, in two regions.",
            "training": "https://learn.microsoft.com/training/modules/choose-service-level-azure-netapp-files-hpc-applications/2-identify-decision-criteria",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "726a1d3e-5508-4a06-9d54-93f4b50040c1",
            "link": "https://learn.microsoft.com/azure/sap/workloads/disaster-recovery-sap-guide?tabs=windows",
            "service": "SAP",
            "severity": "High",
            "text": "Native database replication technology should be used to synchronize the database in a HA pair.",
            "training": "https://learn.microsoft.com/training/modules/implement-disaster-recovery-for-sap-workloads-azure/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "6561f847-3db5-4ff8-9200-5ad3c3b436ad",
            "link": "https://learn.microsoft.com/ja-jp/azure/virtual-network/virtual-networks-faq",
            "service": "SAP",
            "severity": "High",
            "text": "The CIDR for the primary virtual network (VNet) shouldn't conflict or overlap with the CIDR of the DR site's VNet",
            "training": "https://learn.microsoft.com/training/paths/azure-fundamentals-describe-azure-architecture-services/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "0258ed30-fe42-434f-87b9-58f91f908e0a",
            "service": "SAP",
            "severity": "High",
            "text": "Use Site Recovery to replicate an application server to a DR site. Site Recovery can also help with replicating central-services cluster VMs to the DR site. When you invoke DR, you'll need to reconfigure the Linux Pacemaker cluster on the DR site (for example, replace the VIP or SBD, run corosync.conf, and more).",
            "training": "https://learn.microsoft.com/training/paths/ensure-business-continuity-implement-disaster-recovery/",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "8300cb30-766b-4084-b126-0dd8fb1269a1",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/sap/eslz-business-continuity-and-disaster-recovery",
            "service": "SAP",
            "severity": "High",
            "text": "Consider the availability of SAP software against single points of failure. This includes single points of failure within applications such as DBMSs utilized in SAP NetWeaver and SAP S/4HANA architectures, SAP ABAP and ASCS + SCS. Also, other tools such as SAP Web Dispatcher.",
            "training": "https://learn.microsoft.com/training/modules/implement-high-availability-for-sap-workloads-azure/2-explore-high-availability-disaster-recovery-support-azure-for-sap-workloads?source=recommendations",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "56402f11-ccbe-42c3-a2f6-c6f6f38ab579",
            "link": "https://learn.microsoft.com/azure/sap/workloads/planning-supported-configurations",
            "service": "SAP",
            "severity": "High",
            "text": "For SAP and SAP databases, consider implementing automatic failover clusters. In Windows, Windows Server Failover Clustering supports failover. In Linux, Linux Pacemaker or third-party tools like SIOS Protection Suite and Veritas InfoScale support failover.",
            "training": "https://learn.microsoft.com/training/modules/implement-ha-sap-netweaver-anydb/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "afae6bec-2671-49ae-bc69-140b8ec8d320",
            "link": "https://learn.microsoft.com/azure/sap/workloads/disaster-recovery-sap-guide?tabs=windows",
            "service": "SAP",
            "severity": "High",
            "text": "Azure doesn't support architectures in which the primary and secondary VMs share storage for DBMS data. For the DBMS layer, the common architecture pattern is to replicate databases at the same time and with different storage stacks than the ones that the primary and secondary VMs use.",
            "training": "https://learn.microsoft.com/training/paths/ensure-business-continuity-implement-disaster-recovery/?source=recommendationshttps%3A%2F%2Flearn.microsoft.com%2Fja-jp%2Ftraining%2Fpaths%2Fensure-business-continuity-implement-disaster-recovery%2F%3Fsource%3Drecommendations",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "ac614e95-6767-4bc3-b8a4-9953533da6ba",
            "link": "https://learn.microsoft.com/azure/sap/workloads/dbms-guide-general",
            "service": "SAP",
            "severity": "High",
            "text": "The DBMS data and transaction/redo log files are stored in Azure supported block storage or Azure NetApp Files. Azure Files or Azure Premium Files isn't supported as storage for DBMS data and/or redo log files with SAP workload.",
            "training": "https://learn.microsoft.com/training/modules/explore-azure-databases/2-explore-database-support-azure-for-sap-workloads",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "1f737179-8e7f-4e1a-a30c-e5a649a3092b",
            "link": "https://learn.microsoft.com/azure/sap/workloads/sap-high-availability-guide-wsfc-shared-disk",
            "service": "SAP",
            "severity": "High",
            "text": "You can use Azure shared disks in Windows for ASCS + SCS components and specific high-availability scenarios. Set up your failover clusters separately for SAP application layer components and the DBMS layer. Azure doesn't currently support high-availability architectures that combine SAP application layer components and the DBMS layer into one failover cluster.",
            "training": "https://learn.microsoft.com/training/modules/implement-ha-sap-netweaver-anydb/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "a78b3d31-3170-44f2-b5d7-651a29f4ccf5",
            "link": "https://learn.microsoft.com/azure/sap/workloads/high-availability-guide-standard-load-balancer-outbound-connections",
            "service": "SAP",
            "severity": "High",
            "text": "Most failover clusters for SAP application layer components (ASCS) and the DBMS layer require a virtual IP address for a failover cluster.  Azure Load Balancer should handle the virtual IP address for all other cases. One design principle is to use one load balancer per cluster configuration. We recommend that you use the standard version of the load balancer (Standard Load Balancer SKU).",
            "training": "https://learn.microsoft.com/training/modules/implement-high-availability-for-sap-workloads-azure/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "1a541741-5833-4fb4-ae3c-2df743165c3a",
            "link": "https://learn.microsoft.com/azure/load-balancer/load-balancer-ha-ports-overview?source=recommendations",
            "service": "SAP",
            "severity": "High",
            "text": "Make sure the Floating IP is enabled on the Load balancer",
            "training": "https://learn.microsoft.com/training/modules/load-balancing-non-https-traffic-azure/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "c47cc4f3-f105-452c-845e-9b307b3856c1",
            "link": "https://learn.microsoft.com/azure/virtual-machines/availability",
            "service": "SAP",
            "severity": "High",
            "text": "Before you deploy your high-availability infrastructure, and depending on the region you choose, determine whether to deploy with an Azure availability set or an availability zone.",
            "training": "https://learn.microsoft.com/training/modules/configure-virtual-machine-availability/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "844f69c3-07e5-4ec1-bff7-4be27bcf5fea",
            "link": "https://www.microsoft.com/licensing/docs/view/Service-Level-Agreements-SLA-for-Online-Services?lang=1",
            "service": "SAP",
            "severity": "High",
            "text": "If you want to meet the infrastructure SLAs for your applications for SAP components (central services, application servers, and databases), you must choose the same high availability options (VMs, availability sets, availability zones) for all components.",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "cbe05bbe-209d-4490-ba47-778424d11678",
            "link": "https://learn.microsoft.com/azure/virtual-machines/availability-set-overview",
            "service": "SAP",
            "severity": "High",
            "text": "Do not mix servers of different roles in the same availability set. Keep central services VMs, database VMs, application VMs in their own availability sets",
            "training": "https://learn.microsoft.com/training/modules/configure-virtual-machine-availability/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "f2201000-d045-40a6-a79a-d7cdc01b4d86",
            "link": "https://learn.microsoft.com/azure/virtual-machines/co-location",
            "service": "SAP",
            "severity": "Medium",
            "text": "You can't deploy Azure availability sets within an Azure availability zone unless you use proximity placement groups.",
            "training": "https://learn.microsoft.com/azure/sap/workloads/proximity-placement-scenarios",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "9674e7c7-7796-4181-8920-09f4429543ba",
            "link": "https://learn.microsoft.com/azure/virtual-machines/availability-set-overview",
            "service": "SAP",
            "severity": "High",
            "text": "When you create availability sets, use the maximum number of fault domains and update domains available. For example, if you deploy more than two VMs in one availability set, use the maximum number of fault domains (three) and enough update domains to limit the effect of potential physical hardware failures, network outages, or power interruptions, in addition to Azure planned maintenance. The default number of fault domains is two, and you can't change it online later.",
            "training": "https://learn.microsoft.com/training/modules/configure-virtual-machine-availability/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "ae4ecb95-b70f-428f-8b9a-4c5b7e3478a2",
            "link": "https://learn.microsoft.com/azure/sap/workloads/proximity-placement-scenarios",
            "service": "SAP",
            "severity": "High",
            "text": "When you use Azure proximity placement groups in an availability set deployment, all three SAP components (central services, application server, and database) should be in the same proximity placement group.",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "5d2fa56c-56ad-4484-88fe-72734c486ba2",
            "link": "https://learn.microsoft.com/azure/sap/workloads/proximity-placement-scenarios",
            "service": "SAP",
            "severity": "High",
            "text": "Use one proximity placement group per SAP SID. Groups don't span across Availability Zones or Azure regions",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "bca3b10e-0ff5-4aec-ac16-4c4bd1a1c13f",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/sap/eslz-business-continuity-and-disaster-recovery",
            "service": "SAP",
            "severity": "High",
            "text": "Use one of the following services to run SAP central services clusters, depending on the operating system.",
            "training": "https://learn.microsoft.com/training/modules/implement-ha-sap-netweaver-anydb/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "ed46b937-913e-4018-9c62-8393ab037e53",
            "link": "https://learn.microsoft.com/azure/sap/workloads/high-availability-guide-suse-multi-sid",
            "service": "SAP",
            "severity": "Medium",
            "text": "Azure doesn't currently support combining ASCS and DB HA in the same Linux Pacemaker cluster; separate them into individual clusters. However, you can combine up to five multiple central-services clusters into a pair of VMs.",
            "training": "https://learn.microsoft.com/training/modules/implement-ha-sap-netweaver-anydb/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "f656e745-0cfb-453e-8008-0528fa21c933",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/sap/eslz-business-continuity-and-disaster-recovery",
            "service": "SAP",
            "severity": "Medium",
            "text": "Deploy both VMs in the high-availability pair in an availability set or in availability zones. These VMs should be the same size and have the same storage configuration.",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "7f684ebc-95da-425e-b329-e782dbed050f",
            "link": "https://learn.microsoft.com/azure/sap/workloads/high-availability-guide-rhel-with-hana-ascs-ers-dialog-instance",
            "service": "SAP",
            "severity": "Medium",
            "text": "Azure supports installing and configuring SAP HANA and ASCS/SCS and ERS instances on the same high availability cluster running on Red Hat Enterprise Linux (RHEL).",
            "training": "https://learn.microsoft.com/training/modules/implement-ha-sap-netweaver-anydb/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "07991f7d-6598-4d90-9431-45c62605d3a5",
            "link": "https://learn.microsoft.com/azure/sap/workloads/planning-guide-storage",
            "service": "SAP",
            "severity": "High",
            "text": "Run all production systems on Premium managed SSDs and use Azure NetApp Files or Ultra Disk Storage. At least the OS disk should be on the Premium tier so you can achieve better performance and the best SLA.",
            "training": "https://learn.microsoft.com/training/modules/explore-azure-storage/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "73cdaecc-7d74-48d8-a040-88416eebc98c",
            "link": "https://learn.microsoft.com/azure/sap/workloads/hana-vm-operations-storage",
            "service": "SAP",
            "severity": "High",
            "text": "You should run SAP HANA on Azure only on the types of storage that are certified by SAP. Note that certain volumes must be run on certain disk configurations, where applicable. These configurations include enabling Write Accelerator and using Premium storage. You also need to ensure that the file system that runs on storage is compatible with the DBMS that runs on the machine.",
            "training": "https://learn.microsoft.com/azure/sap/workloads/hana-vm-premium-ssd-v1?source=recommendations",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "51904867-a70e-4fa0-b4ff-3e6292846d7c",
            "link": "https://learn.microsoft.com/azure/sap/workloads/disaster-recovery-overview-guide#storage",
            "service": "SAP",
            "severity": "High",
            "text": "Consider configuring high availability depending on the type of storage you use for your SAP workloads. Some storage services available in Azure are not supported by Azure Site Recovery, so your high availability configuration may differ.",
            "training": "https://learn.microsoft.com/training/modules/implement-disaster-recovery-for-sap-workloads-azure/2-explore-disaster-recovery-sap-workloads",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "1ac2d928-c9b7-42c6-ba18-23b1aea78693",
            "link": "https://azure.microsoft.com/ja-jp/explore/global-infrastructure/products-by-region/",
            "service": "SAP",
            "severity": "High",
            "text": "Different native Azure storage services (like Azure Files, Azure NetApp Files, Azure Shared Disk) may not be available in all regions. So to have similar SAP setup on the DR region after failover, ensure the respective storage service is offered in DR site.",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "925d1f8c-01f3-4a67-948e-aabf0a1fad60",
            "link": "https://techcommunity.microsoft.com/t5/running-sap-applications-on-the/optimize-your-azure-costs-by-automating-sap-system-start-stop/ba-p/2120675",
            "service": "SAP",
            "severity": "Medium",
            "text": "Automate SAP System Start-Stop to manage costs.",
            "waf": "Cost"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "71dc00cd-4392-4262-8949-20c05e6c0333",
            "link": "https://learn.microsoft.com/azure/sap/workloads/hana-vm-premium-ssd-v1",
            "service": "SAP",
            "severity": "Low",
            "text": "In the case of using Azure Premium Storage with SAP HANA, Azure Standard SSD storage can be used to select a cost-conscious storage solution. However, please note that choosing Standard SSD or Standard HDD Azure storage will affect the SLA of the individual VMs. Also, for systems with lower I/O throughput and low latency, such as non-production environments, lower series VMs can be used.",
            "waf": "Cost"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "9877f353-2591-4e8b-8381-e9043fed1010",
            "link": "https://learn.microsoft.com/azure/sap/workloads/hana-vm-premium-ssd-v1",
            "service": "SAP",
            "severity": "Low",
            "text": "As a lower-cost alternative configuration (multipurpose), you can choose a low-performance SKU for your non-production HANA database server VMs. However, it is important to note that some VM types, such as E-series, are not HANA certified (SAP HANA Hardware Directory) or cannot achieve storage latency of less than 1ms.",
            "waf": "Cost"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "fda1dbf3-dc95-4d48-a7c7-91dca0f6c565",
            "link": "https://learn.microsoft.com/azure/well-architected/sap/design-areas/security",
            "service": "SAP",
            "severity": "High",
            "text": "Enforce a RBAC model for management groups, subscriptions, resource groups and resources",
            "training": "https://learn.microsoft.com/training/paths/implement-resource-mgmt-security/",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "45911475-e39e-4530-accc-d979366bcda2",
            "link": "https://learn.microsoft.com/azure/active-directory/fundamentals/scenario-azure-first-sap-identity-integration",
            "service": "SAP",
            "severity": "Medium",
            "text": "Enforce Principal propagation for forwarding the identity from SAP cloud application to SAP on-premises (Including IaaS) through cloud connector",
            "training": "https://learn.microsoft.com/training/modules/explore-identity-services/2-explore-azure-virtual-machine-auth-access-control",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "750ab1ab-039d-495d-94c7-c8929cb107d5",
            "link": "https://learn.microsoft.com/azure/active-directory/fundamentals/scenario-azure-first-sap-identity-integration",
            "service": "SAP",
            "severity": "Medium",
            "text": "Implement SSO to SAP SaaS applications like SAP Analytics Cloud, SAP Cloud Platform, Business by design, SAP Qualtrics and SAP C4C with Azure AD using SAML.",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "325ae525-ba34-4d46-a5e2-213ace7bb122",
            "link": "https://learn.microsoft.com/azure/active-directory/saas-apps/sap-netweaver-tutorial",
            "service": "SAP",
            "severity": "Medium",
            "text": "Implement SSO to SAP NetWeaver-based web applications like SAP Fiori and SAP Web GUI by using SAML.",
            "training": "https://learn.microsoft.com/training/modules/explore-identity-services/8-exercise-integrate-azure-active-directory-sap-netweaver",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "9eb54dad-7861-4e1c-973a-f3bb003fc9c1",
            "service": "SAP",
            "severity": "Medium",
            "text": "Implement SSO to SAP NetWeaver-based web applications like SAP Fiori and SAP Web GUI by using SAML.",
            "training": "https://learn.microsoft.com/training/modules/explore-identity-services/6-exercise-integrate-azure-active-directory-sap-fiori",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "f29676ef-0c9c-4c4d-ab21-a55504c0c829",
            "link": "https://learn.microsoft.com/azure/active-directory/saas-apps/sap-netweaver-tutorial",
            "service": "SAP",
            "severity": "Medium",
            "text": "You can implement SSO to SAP GUI by using SAP NetWeaver SSO or a partner solution.",
            "training": "https://learn.microsoft.com/training/modules/explore-identity-services/8-exercise-integrate-azure-active-directory-sap-netweaver",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "23181aa4-1742-4694-9ff8-ae7d7d474317",
            "service": "SAP",
            "severity": "Medium",
            "text": "For SSO for SAP GUI and web browser access, implement SNC / Kerberos/SPNEGO (simple and protected GSSAPI negotiation mechanism) due to its ease of configuration and maintenance. For SSO with X.509 client certificates, consider the SAP Secure Login Server, which is a component of the SAP SSO solution.",
            "training": "https://learn.microsoft.com/training/modules/explore-identity-services/9-exercise-integrate-active-directory-sap-single-sign-on",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "6c8bcbf4-5bbe-4609-b8a0-3e97778424d6",
            "link": "https://blogs.sap.com/2017/07/12/sap-single-sign-on-protect-your-sap-landscape-with-x.509-certificates/",
            "service": "SAP",
            "severity": "Medium",
            "text": "For SSO for SAP GUI and web browser access, implement SNC / Kerberos/SPNEGO (simple and protected GSSAPI negotiation mechanism) due to its ease of configuration and maintenance. For SSO with X.509 client certificates, consider the SAP Secure Login Server, which is a component of the SAP SSO solution.",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "16785d6f-a96c-496a-b885-18f482734c88",
            "link": "https://learn.microsoft.com/azure/active-directory/saas-apps/sap-netweaver-tutorial#configure-sap-netweaver-for-oauth",
            "service": "SAP",
            "severity": "Medium",
            "text": "Implement SSO by using OAuth for SAP NetWeaver to allow third-party or custom applications to access SAP NetWeaver OData services.",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "a747c350-8d4c-449c-93af-393dbca77c48",
            "link": "https://learn.microsoft.com/azure/active-directory/saas-apps/saphana-tutorial",
            "service": "SAP",
            "severity": "Medium",
            "text": "Implement SSO to SAP HANA",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "c7bae5bf-daf9-4761-9c56-f92891890aa4",
            "link": "https://learn.microsoft.com/azure/sap/workloads/rise-integration#connectivity-with-sap-rise",
            "service": "SAP",
            "severity": "Medium",
            "text": "Consider Azure AD an identity provider for SAP systems hosted on RISE. For more information, see Integrating the Service with Azure AD.",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "e4e48226-ce54-44b6-bb6b-bfa15bd8f753",
            "link": "https://github.com/azuredevcollege/SAP/blob/master/sap-oauth-saml-flow/README.md",
            "service": "SAP",
            "severity": "Medium",
            "text": "For applications that access SAP, you might want to use principal propagation to establish SSO.",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "59921095-4980-4fc1-a5b6-524a5a560c79",
            "link": "https://learn.microsoft.com/azure/active-directory/saas-apps/sap-hana-cloud-platform-identity-authentication-tutorial",
            "service": "SAP",
            "severity": "Medium",
            "text": "If you're using SAP BTP services or SaaS solutions that require SAP Identity Authentication Service (IAS), consider implementing SSO between SAP Cloud Identity Authentication Services and Azure AD to access those SAP services. This integration lets SAP IAS act as a proxy identity provider and forwards authentication requests to Azure AD as the central user store and identity provider.",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "a709c664-317e-41e4-9e34-67d9016a86f4",
            "link": "https://learn.microsoft.com/azure/active-directory/saas-apps/sap-hana-cloud-platform-tutorial",
            "service": "SAP",
            "severity": "Medium",
            "text": "Implement SSO to SAP BTP",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "01f11b7f-38df-4251-9c76-4dec19abd3e8",
            "link": "https://learn.microsoft.com/azure/active-directory/saas-apps/sap-successfactors-inbound-provisioning-cloud-only-tutorial",
            "service": "SAP",
            "severity": "Medium",
            "text": "If you're using SAP SuccessFactors, consider using the Azure AD automated user provisioning. With this integration, as you add new employees to SAP SuccessFactors, you can automatically create their user accounts in Azure AD. Optionally, you can create user accounts in Microsoft 365 or other SaaS applications that are supported by Azure AD. Use write-back of the email address to SAP SuccessFactors.",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "6ba28021-4591-4147-9e39-e5309cccd979",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/resource-org-management-groups",
            "service": "SAP",
            "severity": "Medium",
            "text": "enforce existing Management Group policies to SAP Subscriptions",
            "training": "https://learn.microsoft.com/training/modules/enterprise-scale-organization/4-management-group-subscription-organization",
            "waf": "Operations"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "366bcda2-750a-4b1a-a039-d95d54c7c892",
            "link": "https://learn.microsoft.com/azure/architecture/guide/sap/sap-whole-landscape",
            "service": "SAP",
            "severity": "High",
            "text": "Integrate tightly coupled applications into the same SAP subscription to avoid additional routing and management complexity",
            "training": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/resource-org-subscriptions",
            "waf": "Operations"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "9cb107d5-325a-4e52-9ba3-4d4685e2213a",
            "link": "https://learn.microsoft.com/azure/architecture/guide/sap/sap-whole-landscape",
            "service": "SAP",
            "severity": "High",
            "text": "Leverage Subscription as scale unit and scaling our resources, consider deploying subscription per environment eg. Sandbox, non-prod, prod ",
            "training": "https://learn.microsoft.com/training/modules/configure-subscriptions/?source=recommendations",
            "waf": "Operations"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "ce7bb122-f7c9-45f0-9e15-4e3aa3592829",
            "link": "https://learn.microsoft.com/azure/quotas/quotas-overview",
            "service": "SAP",
            "severity": "High",
            "text": "Ensure quota increase as a part of subscription provisioning (e.g. total available VM cores within a subscription)",
            "training": "https://learn.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits",
            "waf": "Operations"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "ce4fab2f-433a-4d59-a5a9-3d1032e03ebc",
            "link": "https://learn.microsoft.com/rest/api/reserved-vm-instances/quotaapi?branch=capacity",
            "service": "SAP",
            "severity": "Low",
            "text": "The Quota API is a REST API that you can use to view and manage quotas for Azure services. Consider using it if necessary.",
            "waf": "Operations"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "cbfad17b-f240-42bf-a1d8-f4f4cee661c8",
            "link": "https://learn.microsoft.com/azure/quotas/quickstart-increase-quota-portal",
            "service": "SAP",
            "severity": "High",
            "text": "If deploying to an availability zone, ensure that the VM's zone deployment is available once the quota has been approved. Submit a support request with the subscription, VM series, number of CPUs and availability zone required.",
            "waf": "Operations"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "e6e20617-3686-4af4-9791-f8935ada4332",
            "link": "https://azure.microsoft.com/explore/global-infrastructure/products-by-region/",
            "service": "SAP",
            "severity": "High",
            "text": "Ensure required services and features are available within the chosen deployment regions eg. ANF , Zone etc.",
            "training": "https://learn.microsoft.com/azure/cloud-adoption-framework/migrate/azure-best-practices/multiple-regions?source=recommendations",
            "waf": "Operations"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "4e138115-2318-41aa-9174-26943ff8ae7d",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/sap/eslz-resource-organization",
            "service": "SAP",
            "severity": "Medium",
            "text": "Leverage Azure resource tag for cost categorization and resource grouping (: BillTo, Department (or Business Unit), Environment (Production, Stage, Development), Tier (Web Tier, Application Tier), Application Owner, ProjectName)",
            "training": "https://learn.microsoft.com/training/paths/implement-resource-mgmt-security/",
            "waf": "Operations"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "2f7c95f0-6e15-44e3-aa35-92829e6e2061",
            "link": "https://learn.microsoft.com/azure/backup/sap-hana-database-about",
            "service": "SAP",
            "severity": "High",
            "text": "Help protect your HANA database by using the Azure Backup service.",
            "training": "https://learn.microsoft.com/training/modules/implement-azure-backup-sap-workloads-azure-virtual-machines/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "302a2fbf-3745-4a5f-a365-c9d1a16ca22c",
            "link": "https://learn.microsoft.com/azure/azure-netapp-files/azacsnap-introduction",
            "service": "SAP",
            "severity": "Medium",
            "text": "If you deploy Azure NetApp Files for your HANA, Oracle, or DB2 database, use the Azure Application Consistent Snapshot tool (AzAcSnap) to take application-consistent snapshots. AzAcSnap also supports Oracle databases. Consider using AzAcSnap on a central VM rather than on individual VMs.",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "42d37218-a3a7-45df-bff6-1173e7f249ea",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/sap/eslz-management-and-monitoring",
            "service": "SAP",
            "severity": "High",
            "text": "Ensure time-zone matches between the operating system and the SAP system.",
            "waf": "Operations"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "c3c7abc0-716c-4486-893c-40e181d65539",
            "link": "https://learn.microsoft.com/azure/sap/workloads/high-availability-guide-rhel-multi-sid",
            "service": "SAP",
            "severity": "Medium",
            "text": "Don't group different application services in the same cluster. For example, don't combine DRBD and central services clusters on the same cluster. However, you can use the same Pacemaker cluster to manage approximately five different central services (multi-SID cluster).",
            "training": "https://learn.microsoft.com/training/modules/implement-ha-sap-netweaver-anydb/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "a491dfc4-9353-4213-9217-eef0949f9467",
            "link": "https://azure.microsoft.com/pricing/offers/dev-test/",
            "service": "SAP",
            "severity": "Low",
            "text": "Consider running dev/test systems in a snooze model to save and optimize Azure run costs.",
            "waf": "Cost"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "b7056168-6199-4732-a514-cdbb2d5c9c54",
            "link": "https://learn.microsoft.com/azure/lighthouse/overview",
            "service": "SAP",
            "severity": "Medium",
            "text": "If you partner with customers by managing their SAP estates, consider Azure Lighthouse. Azure Lighthouse allows managed service providers to use Azure native identity services to authenticate to the customers' environment. It puts the control in the hands of customers, because they can revoke access at any time and audit service providers' actions.",
            "waf": "Operations"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "4d116785-d2fa-456c-96ad-48408fe72734",
            "link": "https://learn.microsoft.com/azure/update-manager/scheduled-patching?tabs=schedule-updates-single-machine%2Cschedule-updates-scale-overview",
            "service": "SAP",
            "severity": "Medium",
            "text": "Use Azure Update Manager to check the status of available updates for a single VM or multiple VMs and consider scheduling regular patching.",
            "training": "https://learn.microsoft.com/training/modules/keep-your-virtual-machines-updated/?source=recommendations",
            "waf": "Operations"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "76c8bcbf-45bb-4e60-ad8a-03e97778424d",
            "link": "https://learn.microsoft.com/azure/sap/workloads/lama-installation",
            "service": "SAP",
            "severity": "Low",
            "text": "Optimize and manage SAP Basis operations by using SAP Landscape Management (LaMa). Use the SAP LaMa connector for Azure to relocate, copy, clone, and refresh SAP systems.",
            "training": "https://learn.microsoft.com/training/modules/explore-azure-remote-management/?source=recommendations",
            "waf": "Operations"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "14591147-5e39-4e53-89cc-cd979366bcda",
            "link": "https://learn.microsoft.com/azure/sap/monitor/about-azure-monitor-sap-solutions",
            "service": "SAP",
            "severity": "Medium",
            "text": "Use Azure Monitor for SAP solutions to monitor your SAP workloads(SAP HANA, high-availability SUSE clusters, and SQL systems) on Azure. Consider supplementing Azure Monitor for SAP solutions with SAP Solution Manager.",
            "training": "https://learn.microsoft.com/training/modules/implement-azure-monitoring-sap-workloads-azure-virtual-machines/?source=recommendations",
            "waf": "Operations"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "2750ab1a-b039-4d95-b54c-7c8929cb107d",
            "link": "https://learn.microsoft.com/azure/sap/workloads/vm-extension-for-sap",
            "service": "SAP",
            "severity": "High",
            "text": "Run a VM Extension for SAP check. VM Extension for SAP uses the assigned managed identity of a virtual machine (VM) to access VM monitoring and configuration data. The check ensures that all performance metrics in your SAP application come from the underlying Azure Extension for SAP.",
            "training": "https://learn.microsoft.com/training/modules/configure-azure-enhanced-monitoring-extension-for-sap/?source=recommendations",
            "waf": "Operations"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "5325ae52-5ba3-44d4-985e-2213ace7bb12",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/design-logs-deployment",
            "service": "SAP",
            "severity": "Medium",
            "text": "Use Azure Policy for access control and compliance reporting. Azure Policy provides the ability to enforce organization-wide settings to ensure consistent policy adherence and fast violation detection. ",
            "training": "https://learn.microsoft.com/learn/paths/architect-infrastructure-operations/",
            "waf": "Operations"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "523181aa-4174-4269-93ff-8ae7d7d47431",
            "link": "https://learn.microsoft.com/azure/network-watcher/connection-monitor-overview",
            "service": "SAP",
            "severity": "Medium",
            "text": "Use Connection Monitor in Azure Network Watcher to monitor latency metrics for SAP databases and application servers. Or collect and display network latency measurements by using Azure Monitor.",
            "training": "https://techcommunity.microsoft.com/t5/running-sap-applications-on-the/collecting-and-displaying-niping-network-latency-measurements/ba-p/1833979",
            "waf": "Operations"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "73686af4-6791-4f89-95ad-a43324e13811",
            "link": "https://github.com/Azure/SAP-on-Azure-Scripts-and-Utilities/tree/main/QualityCheck",
            "service": "SAP",
            "severity": "Medium",
            "text": "Perform a quality check for SAP HANA on the provisioned Azure infrastructure to verify that provisioned VMs comply with SAP HANA on Azure best practices.",
            "waf": "Operations"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "616785d6-fa96-4c96-ad88-518f482734c8",
            "link": "https://learn.microsoft.com/azure/sap/workloads/high-availability-zones",
            "service": "SAP",
            "severity": "High",
            "text": "For each Azure subscription, run a latency test on Azure availability zones before zonal deployment to choose low-latency zones for deployment of SAP on Azure.",
            "training": "https://github.com/Azure/SAP-on-Azure-Scripts-and-Utilities/tree/main/AvZone-Latency-Test",
            "waf": "Performance"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "410adcba-db46-424f-a6c4-05ecde75c52e",
            "link": "https://learn.microsoft.com/azure/advisor/advisor-how-to-improve-reliability",
            "service": "SAP",
            "severity": "Medium",
            "text": "Run the Resiliency Report to ensure that the configuration of the entire provisioned Azure infrastructure (Compute, Database, Networking, Storage, Site Recovery) complies with the configuration defined by Cloud Adaption Framework for Azure.",
            "training": "https://learn.microsoft.com/training/paths/azure-well-architected-framework/",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "86ba2802-1459-4114-95e3-9e5309cccd97",
            "link": "https://learn.microsoft.com/azure/sentinel/sap/deployment-overview",
            "service": "SAP",
            "severity": "Medium",
            "text": "Implement threat protection by using the Microsoft Sentinel solution for SAP. Use this solution to monitor your SAP systems and detect sophisticated threats throughout the business logic and application layers.",
            "training": "https://learn.microsoft.com/training/modules/plan-microsoft-sentinel-deployment-sap/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "579266bc-ca27-45fa-a1ab-fe9d55d04c3c",
            "link": "https://learn.microsoft.com/azure/cost-management-billing/costs/enable-tag-inheritance",
            "service": "SAP",
            "severity": "Medium",
            "text": "Azure tagging can be leveraged to logically group and track resources, automate their deployments, and most importantly, provide visibility on the incurred costs.",
            "training": "https://learn.microsoft.com/training/modules/analyze-costs-create-budgets-azure-cost-management/?source=recommendations",
            "waf": "Operations"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "04b8e5e5-13cb-4b22-af62-5a8ecfcf0337",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-network-test-latency?tabs=windows",
            "service": "SAP",
            "severity": "Low",
            "text": "Use inter-VM latency monitoring for latency-sensitive applications.",
            "waf": "Performance"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "07e5ed53-3d96-43d8-87ea-631b77da5aba",
            "link": "https://learn.microsoft.com/azure/sap/workloads/planning-guide-storage",
            "service": "SAP",
            "severity": "Medium",
            "text": "Use Azure Site Recovery monitoring to maintain the health of the disaster recovery service for SAP application servers.",
            "training": "https://learn.microsoft.com/training/modules/explore-azure-storage/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "abb6af9c-982c-4cf1-83fb-329fafd1ee56",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/sap/eslz-management-and-monitoring",
            "service": "SAP",
            "severity": "Medium",
            "text": "Exclude all the database file systems and executable programs from antivirus scans. Including them could lead to performance problems. Check with the database vendors for prescriptive details on the exclusion list. For example, Oracle recommends excluding /oracle/<sid>/sapdata from antivirus scans.",
            "waf": "Performance"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "c027f893-f404-41a9-b33d-39d625a14964",
            "link": "https://sapit-forme-prod.authentication.eu11.hana.ondemand.com/login",
            "service": "SAP",
            "severity": "Low",
            "text": "Consider collecting full database statistics for non-HANA databases after migration. For example, implement SAP note 1020260 - Delivery of Oracle statistics.",
            "waf": "Performance"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "fdafb1f5-3eee-4354-a8c9-deb8127ebc2e",
            "link": "https://learn.microsoft.com/azure/virtual-machines/workloads/oracle/configure-oracle-asm",
            "service": "SAP",
            "severity": "Medium",
            "text": "Consider using Oracle Automatic Storage Management (ASM) for all Oracle deployments that use SAP on Azure.",
            "training": "https://learn.microsoft.com/training/paths/administer-infrastructure-resources-in-azure/?source=recommendations",
            "waf": "Performance"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "33c5d5bf-daf3-4f0d-bd50-6010fdcec22e",
            "link": "https://techcommunity.microsoft.com/t5/running-sap-applications-on-the/announcement-sap-on-azure-oracle-performance-efficiency-scripts/ba-p/3725178",
            "service": "SAP",
            "severity": "Medium",
            "text": "For SAP on Azure running Oracle, a collection of SQL scripts can help you diagnose performance problems.  Automatic Workload Repository (AWR) reports contain valuable information for diagnosing problems in the Oracle system. We recommend that you run an AWR report during several sessions and choose peak times for it, to ensure broad coverage for the analysis.",
            "training": "https://learn.microsoft.com/ja-jp/azure/well-architected/oracle-iaas/performance-efficiency",
            "waf": "Performance"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "d89fd98d-23e4-4b40-a92e-32db9365522c",
            "link": "https://learn.microsoft.com/azure/site-recovery/site-recovery-monitor-and-troubleshoot",
            "service": "SAP",
            "severity": "High",
            "text": "Use Azure Site Recovery monitoring to maintain the health of the disaster recovery service for SAP application servers.",
            "training": "https://learn.microsoft.com/training/modules/protect-on-premises-infrastructure-with-azure-site-recovery/?source=recommendations",
            "waf": "Operations"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "5ba34d46-85e2-4213-ace7-bb122f7c95f0",
            "link": "https://learn.microsoft.com/azure/ddos-protection/ddos-protection-overview",
            "service": "SAP",
            "severity": "Medium",
            "text": "For secure delivery of HTTP/S apps, use Application Gateway v2 and ensure that WAF protection and policies are enabled.",
            "training": "https://learn.microsoft.com/training/modules/introduction-azure-web-application-firewall/",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "fa9d30bc-1b82-4e4b-bfdf-6b017938b9e6",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/sap/eslz-network-topology-and-connectivity",
            "service": "SAP",
            "severity": "Medium",
            "text": "If the virtual machine's DNS or virtual name is not changed during migration to Azure, Background DNS and virtual names connect many system interfaces in the SAP landscape, and customers are only sometimes aware of the interfaces that developers define over time. Connection challenges arise between various systems when virtual or DNS names change after migrations, and it's recommended to retain DNS aliases to prevent these types of difficulties.",
            "training": "https://learn.microsoft.com/training/modules/explore-azure-networking/4-explore-name-resolution",
            "waf": "Operations"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "a2858f78-105b-4f52-b7a9-5b0f4439743b",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/sap/eslz-network-topology-and-connectivity",
            "service": "SAP",
            "severity": "Medium",
            "text": "Use different DNS zones to distinguish each environment (sandbox, development, preproduction, and production) from each other. The exception is for SAP deployments with their own VNet; here, private DNS zones might not be necessary.",
            "training": "https://learn.microsoft.com/training/modules/explore-azure-networking/4-explore-name-resolution",
            "waf": "Operations"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "a3592829-e6e2-4061-9368-6af46791f893",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-network-peering-overview",
            "service": "SAP",
            "severity": "Medium",
            "text": "Local and global VNet peering provide connectivity and are the preferred approaches to ensure connectivity between landing zones for SAP deployments across multiple Azure regions",
            "training": "https://learn.microsoft.com/training/modules/configure-vnet-peering/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "41742694-3ff8-4ae7-b7d4-743176c8bcbf",
            "link": "https://learn.microsoft.com/azure/sap/workloads/planning-guide",
            "service": "SAP",
            "severity": "High",
            "text": "It is not supported to deploy any NVA between SAP application and SAP Database server",
            "training": "https://me.sap.com/notes/2731110",
            "waf": "Performance"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "7d4bc7d2-c34a-452e-8f1d-6ae3c8eafcc3",
            "link": "https://learn.microsoft.com/training/modules/introduction-azure-virtual-wan/?source=recommendations",
            "service": "SAP",
            "severity": "Medium",
            "text": "Use Virtual WAN for Azure deployments in new, large, or global networks where you need global transit connectivity across Azure regions and on-premises locations. With this approach, you won't need to manually set up transitive routing for Azure networking, and you can follow a standard for SAP on Azure deployments.",
            "training": "https://learn.microsoft.com/azure/virtual-wan/virtual-wan-about",
            "waf": "Operations"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "0cedb1f6-ae6c-492b-8b17-8061f50b16d3",
            "link": "https://learn.microsoft.com/azure/well-architected/services/networking/network-virtual-appliances/reliability",
            "service": "SAP",
            "severity": "Medium",
            "text": "Consider deploying network virtual appliances (NVAs) between regions only if partner NVAs are used. NVAs between regions or VNets aren't required if native NVAs are present. When you're deploying partner networking technologies and NVAs, follow the vendor's guidance to verify conflicting configurations with Azure networking.",
            "training": "https://learn.microsoft.com/training/modules/control-network-traffic-flow-with-routes/?source=recommendations",
            "waf": "Operations"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "facc08c6-ea95-4641-91cd-fa09e573adbd",
            "link": "https://learn.microsoft.com/azure/architecture/networking/hub-spoke-vwan-architecture",
            "service": "SAP",
            "severity": "Medium",
            "text": "Virtual WAN manages connectivity between spoke VNets for virtual-WAN-based topologies (no need to set up user-defined routing [UDR] or NVAs), and maximum network throughput for VNet-to-VNet traffic in the same virtual hub is 50 gigabits per second. If necessary, SAP landing zones can use VNet peering to connect to other landing zones and overcome this bandwidth limitation.",
            "training": "https://learn.microsoft.com/training/modules/hub-and-spoke-network-architecture/?source=recommendations",
            "waf": "Operations"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "82734c88-6ba2-4802-8459-11475e39e530",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-ip-addressing",
            "service": "SAP",
            "severity": "High",
            "text": "Public IP assignment to VM running SAP Workload is not recommended.",
            "training": "https://learn.microsoft.com/training/modules/design-ip-addressing-for-azure/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "9cccd979-366b-4cda-8750-ab1ab039d95d",
            "link": "https://learn.microsoft.com/training/modules/protect-on-premises-infrastructure-with-azure-site-recovery/?source=recommendations",
            "service": "SAP",
            "severity": "High",
            "text": "Consider reserving IP address on DR side when configuring ASR",
            "training": "https://learn.microsoft.com/learn/paths/architect-network-infrastructure/",
            "waf": "Operations"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "54c7c892-9cb1-407d-9325-ae525ba34d46",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-ip-addressing",
            "service": "SAP",
            "severity": "High",
            "text": "Avoid using overlapping IP address ranges for production and DR sites.",
            "training": "https://learn.microsoft.com/training/modules/design-ip-addressing-for-azure/?source=recommendations",
            "waf": "Operations"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "6e154e3a-a359-4282-ae6e-206173686af4",
            "link": "https://learn.microsoft.com/azure/azure-netapp-files/azure-netapp-files-delegate-subnet",
            "service": "SAP",
            "severity": "Medium",
            "text": "While Azure does help you to create multiple delegated subnets in a VNet, only one delegated subnet can exist in a VNet for Azure NetApp Files. Attempts to create a new volume will fail if you use more than one delegated subnet for Azure NetApp Files.",
            "training": "https://learn.microsoft.com/azure/azure-netapp-files/azure-netapp-files-network-topologies?source=recommendations",
            "waf": "Operations"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "d8a03e97-7784-424d-9167-85d6fa96c96a",
            "link": "https://learn.microsoft.com/azure/well-architected/services/networking/azure-firewall?toc=%2Fazure%2Ffirewall%2Ftoc.json&bc=%2Fazure%2Ffirewall%2Fbreadcrumb%2Ftoc.json",
            "service": "SAP",
            "severity": "Medium",
            "text": "Use Azure Firewall to govern Azure outbound traffic to the internet, non-HTTP/S inbound connections, and East/West traffic filtering (if the organization requires it)",
            "training": "https://learn.microsoft.com/training/paths/secure-networking-infrastructure/",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "91a65e40-be90-45b3-9f73-f3edbf8dc324",
            "link": "https://learn.microsoft.com/azure/sap/workloads/expose-sap-process-orchestration-on-azure",
            "service": "SAP",
            "severity": "Medium",
            "text": "Application Gateway and Web Application Firewall have limitations when Application Gateway serves as a reverse proxy for SAP web apps, as shown in the comparison between Application Gateway, SAP Web Dispatcher, and other third-party services.",
            "training": "https://help.sap.com/docs/SUPPORT_CONTENT/si/3362959506.html",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "5e39e530-9ccc-4d97-a366-bcda2750ab1a",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "service": "SAP",
            "severity": "Medium",
            "text": "Use Azure Front Door and WAF policies to provide global protection across Azure regions for inbound HTTP/S connections to a landing zone.",
            "training": "https://learn.microsoft.com/training/paths/secure-application-delivery/",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "b039d95d-54c7-4c89-89cb-107d5325ae52",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/afds-overview",
            "service": "SAP",
            "severity": "Medium",
            "text": "Take advantage of Web Application Firewall policies in Azure Front Door when you're using Azure Front Door and Application Gateway to protect HTTP/S applications. Lock down Application Gateway to receive traffic only from Azure Front Door.",
            "training": "https://learn.microsoft.com/training/modules/introduction-azure-web-application-firewall/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "5ada4332-4e13-4811-9231-81aa41742694",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "service": "SAP",
            "severity": "Medium",
            "text": "Use a web application firewall to scan your traffic when it's exposed to the internet. Another option is to use it with your load balancer or with resources that have built-in firewall capabilities like Application Gateway or third-party solutions.",
            "training": "https://learn.microsoft.com/training/modules/introduction-azure-web-application-firewall/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "e73de7d5-6f36-4217-a526-e1a621ecddde",
            "link": "https://learn.microsoft.com/azure/frontdoor/front-door-overview",
            "service": "SAP",
            "severity": "Medium",
            "text": "Use Virtual WAN for Azure deployments in new, large, or global networks where you need global transit connectivity across Azure regions and on-premises locations. With this approach, you won't need to manually set up transitive routing for Azure networking, and you can follow a standard for SAP on Azure deployments.",
            "training": "https://learn.microsoft.com/training/modules/explore-azure-networking/10-explore-azure-front-door",
            "waf": "Performance"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "3c536a3e-1b6b-4e87-95ca-15edb47251c0",
            "link": "https://learn.microsoft.com/azure/virtual-network/vnet-integration-for-azure-services",
            "service": "SAP",
            "severity": "Medium",
            "text": "To prevent data leakage, use Azure Private Link to securely access platform as a service resources like Azure Blob Storage, Azure Files, Azure Data Lake Storage Gen2, Azure Data Factory, and more. Azure Private Endpoint can also help to secure traffic between VNets and services like Azure Storage, Azure Backup, and more. Traffic between your VNet and the Private Endpoint enabled service travels across the Microsoft global network, which prevents its exposure to the public internet.",
            "training": "https://learn.microsoft.com/training/modules/design-implement-private-access-to-azure-services/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "85e2213a-ce7b-4b12-8f7c-95f06e154e3a",
            "link": "https://learn.microsoft.com/azure/virtual-network/accelerated-networking-overview?tabs=redhat",
            "service": "SAP",
            "severity": "High",
            "text": "Make sure that Azure accelerated networking is enabled on the VMs used in the SAP application and DBMS layers.",
            "training": "https://learn.microsoft.com/training/paths/azure-fundamentals-describe-azure-architecture-services/?source=recommendations",
            "waf": "Performance"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "3ff8ae7d-7d47-4431-96c8-bcbf45bbe609",
            "link": "https://learn.microsoft.com/azure/load-balancer/load-balancer-multivip-overview",
            "service": "SAP",
            "severity": "Medium",
            "text": "Make sure that internal deployments for Azure Load Balancer are set up to use Direct Server Return (DSR). This setting (Enabling Floating IP) will reduce latency when internal load balancer configurations are used for high-availability configurations on the DBMS layer.",
            "training": "https://learn.microsoft.com/ja-jp/training/modules/load-balancing-non-https-traffic-azure/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "6791f893-5ada-4433-84e1-3811523181aa",
            "link": "https://learn.microsoft.com/azure/virtual-network/network-security-group-how-it-works",
            "service": "SAP",
            "severity": "Medium",
            "text": "You can use application security group (ASG) and NSG rules to define network security access-control lists between the SAP application and DBMS layers. ASGs group virtual machines to help manage their security.",
            "training": "https://learn.microsoft.com/training/modules/configure-network-security-groups/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "45bbe609-d8a0-43e9-9778-424d616785d6",
            "link": "https://me.sap.com/notes/2015553",
            "service": "SAP",
            "severity": "High",
            "text": "Placing of the SAP application layer and SAP DBMS in different Azure VNets that aren't peered isn't supported.",
            "training": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/sap/eslz-network-topology-and-connectivity",
            "waf": "Performance"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "fa96c96a-d885-418f-9827-34c886ba2802",
            "link": "https://learn.microsoft.com/azure/sap/workloads/proximity-placement-scenarios",
            "service": "SAP",
            "severity": "Medium",
            "text": "For optimal network latency with SAP applications, consider using Azure proximity placement groups.",
            "training": "https://learn.microsoft.com/azure/virtual-machines/co-location#planned-maintenance-and-proximity-placement-groups",
            "waf": "Performance"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "18c8b61c-855a-4405-b6ed-266455e4f4ce",
            "link": "https://me.sap.com/notes/2015553",
            "service": "SAP",
            "severity": "High",
            "text": "It is NOT supported at all to run an SAP Application Server layer and DBMS layer split between on-premise and Azure. Both layers need to completely reside either on-premise or in Azure.",
            "training": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/sap/eslz-network-topology-and-connectivity",
            "waf": "Performance"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "b65c878b-4b14-4f4e-92d8-d873936493f2",
            "link": "https://me.sap.com/notes/2015553",
            "service": "SAP",
            "severity": "High",
            "text": "It isn't recommended to host the database management system (DBMS) and application layers of SAP systems in different VNets and connect them with VNet peering because of the substantial costs that excessive network traffic between the layers can produce. Recommend using subnets within the Azure virtual network to separate the SAP application layer and DBMS layer.",
            "training": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/sap/eslz-network-topology-and-connectivity",
            "waf": "Cost"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "402a9846-d515-4061-aff8-cd30088693fa",
            "link": "https://learn.microsoft.com/azure/sap/workloads/high-availability-guide-rhel",
            "service": "SAP",
            "severity": "High",
            "text": "If using Load Balancer with Linux guest operating systems, check that the Linux network parameter net.ipv4.tcp_timestamps is set to 0.",
            "training": "https://learn.microsoft.com/training/modules/implement-ha-sap-netweaver-anydb/?source=recommendations",
            "waf": "Performance"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "87585797-5551-4d53-bb7d-a94ee415734d",
            "link": "https://learn.microsoft.com/azure/sap/workloads/rise-integration",
            "service": "SAP",
            "severity": "Medium",
            "text": "For SAP RISE/ECS deployments, virtual peering is the preferred way to establish connectivity with customer's existing Azure environment. Both the SAP vnet and customer vnet(s) are protected with network security groups (NSG), enabling communication on SAP and database ports through the vnet peering",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "ff5136bd-dcf1-4d2b-ae52-39333efdf45a",
            "link": "https://learn.microsoft.com/azure/backup/sap-hana-database-about",
            "service": "SAP",
            "severity": "High",
            "text": "Review SAP HANA database backups for Azure VMs.",
            "waf": "Cost"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "cafde29d-a0af-4bcd-87c0-0f299d63f0e8",
            "link": "https://learn.microsoft.com/azure/site-recovery/site-recovery-monitor-and-troubleshoot",
            "service": "SAP",
            "severity": "Medium",
            "text": "Review Site Recovery built-in monitoring, where used for SAP.",
            "waf": "Cost"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "82d7b8de-d3f1-44a0-830b-38e200e82acf",
            "link": "https://help.sap.com/docs/SAP_HANA_PLATFORM/c4d7c773af4a4e5dbebb6548d6e2d4f4/e3111d2ebb5710149510cc120646bf3f.html?locale=en-US",
            "service": "SAP",
            "severity": "High",
            "text": "Review the Monitoring the SAP HANA System Landscape guidance.",
            "waf": "Operations"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "c823873a-2bec-4c2a-b684-a1ce8ae80efd",
            "link": "https://learn.microsoft.com/azure/virtual-machines/workloads/oracle/oracle-database-backup-strategies",
            "service": "SAP",
            "severity": "Medium",
            "text": "Review Oracle Database in Azure Linux VM backup strategies.",
            "waf": "Operations"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "2943b6d8-1d31-4e19-ade7-78e6b26d1962",
            "link": "https://learn.microsoft.com/sql/relational-databases/tutorial-use-azure-blob-storage-service-with-sql-server-2016?view=sql-server-ver16",
            "service": "SAP",
            "severity": "Medium",
            "text": "Review the use of Azure Blob Storage with SQL Server 2016.",
            "waf": "Operations"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "b82e650f-676d-417d-994d-fc33ca54ec14",
            "link": "https://learn.microsoft.com/azure/azure-sql/virtual-machines/windows/automated-backup?view=azuresql",
            "service": "SAP",
            "severity": "Medium",
            "text": "Review the use of Automated Backup v2 for Azure VMs.",
            "waf": "Operations"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "347c2dcc-e6eb-4b04-80c5-628b171aa62d",
            "service": "SAP",
            "severity": "High",
            "text": "Enabling Write accelerator for M series when using premium disks(V1)",
            "waf": "Operations"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "b96512cf-996f-4b17-b9b8-6b16db1a2a94",
            "link": "https://github.com/Azure/SAP-on-Azure-Scripts-and-Utilities/tree/main/AvZone-Latency-Test",
            "service": "SAP",
            "severity": "Medium",
            "text": "Test availability zone latency.",
            "waf": "Performance"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "9fd7ffd4-da11-49f6-a374-8d03e94c511d",
            "link": "https://support.sap.com/en/offerings-programs/support-services/earlywatch-alert.html",
            "service": "SAP",
            "severity": "Medium",
            "text": "Activate SAP EarlyWatch Alert for all SAP components.",
            "training": "https://help.sap.com/docs/SUPPORT_CONTENT/techops/3362700736.html",
            "waf": "Performance"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "b9b140cf-413a-483d-aad2-8802c4e3c017",
            "link": "https://techcommunity.microsoft.com/t5/running-sap-applications-on-the/sap-on-azure-general-update-march-2019/ba-p/377456",
            "service": "SAP",
            "severity": "Medium",
            "text": "Review SAP application server to database server latency using SAP ABAPMeter report /SSA/CAT.",
            "training": "https://me.sap.com/notes/0002879613",
            "waf": "Performance"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "62fbf0f8-51db-49e1-a961-bb5df7a35f80",
            "service": "SAP",
            "severity": "Medium",
            "text": "Review SQL Server performance monitoring using CCMS.",
            "waf": "Performance"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "35709da7-fc7d-4efe-bb20-2e91547b7390",
            "link": "https://me.sap.com/notes/500235",
            "service": "SAP",
            "severity": "Medium",
            "text": "Test network latency between SAP application layer VMs and DBMS VMs (NIPING).",
            "training": "https://me.sap.com/notes/1100926/E",
            "waf": "Performance"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "9e9bb4c8-e934-4e4b-a13c-6f7c7c38eb43",
            "link": "https://learn.microsoft.com/en-us/azure/sap/large-instances/hana-monitor-troubleshoot",
            "service": "SAP",
            "severity": "Medium",
            "text": "Review SAP HANA studio alerts.",
            "waf": "Performance"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "f1a92ab5-9509-4b57-86ff-b0ade361b694",
            "link": "https://me.sap.com/notes/1969700",
            "service": "SAP",
            "severity": "Medium",
            "text": "Perform SAP HANA health checks using HANA_Configuration_Minichecks.",
            "waf": "Performance"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "18dffcf3-248c-4039-a67c-dec8e3a5f804",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/sap/sap-lza-security-operations",
            "service": "SAP",
            "severity": "Medium",
            "text": "If you run Windows and Linux VMs in Azure, on-premises, or in other cloud environments, you can use the Update management center in Azure Automation to manage operating system updates, including security patches.",
            "training": "https://learn.microsoft.com/azure/automation/update-management/overview",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "08951710-79a2-492a-adbc-06d7a401545b",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/sap/sap-lza-security-operations",
            "service": "SAP",
            "severity": "Medium",
            "text": "Routinely review the SAP security OSS notes because SAP releases highly critical security patches, or hot fixes, that require immediate action to protect your SAP systems.",
            "training": "https://support.sap.com/en/my-support/knowledge-base/security-notes-news.html",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "1b8b394e-ae64-4a74-8933-357b523ea0a0",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/sap/sap-lza-database-security",
            "service": "SAP",
            "severity": "Low",
            "text": "For SAP on SQL Server, you can disable the SQL Server system administrator account because the SAP systems on SQL Server don't use the account. Ensure that another user with system administrator rights can access the server before disabling the original system administrator account.",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "5a76a033-ced9-4eef-9a43-5e4f96634c8e",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/sap/sap-lza-database-security",
            "service": "SAP",
            "severity": "High",
            "text": "Disable xp_cmdshell. The SQL Server feature xp_cmdshell enables a SQL Server internal operating system command shell. It's a potential risk in security audits.",
            "training": "https://me.sap.com/notes/3019299/E",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "cf65de8e-1309-4ccc-b579-266bcca275fa",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/sap/eslz-security-governance-and-compliance",
            "service": "SAP",
            "severity": "High",
            "text": "Encrypting SAP HANA database servers on Azure uses SAP HANA native encryption technology. Additionally, if you are using SQL Server on Azure, use Transparent Data Encryption (TDE) to protect your data and log files and ensure that your backups are also encrypted.",
            "training": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/sap/sap-lza-database-security",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "a1abfe9d-55d0-44c3-a491-9cb1b3d1325a",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-service-encryption",
            "service": "SAP",
            "severity": "Medium",
            "text": "Azure Storage encryption is enabled for all Azure Resource Manager and classic storage accounts, and can't be disabled. Because your data is encrypted by default, you don't need to modify your code or applications to use Azure Storage encryption.",
            "training": "https://learn.microsoft.com/training/modules/encrypt-sector-data/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "ce9bd3bb-0cdb-43b5-9eb2-ec14eeaa3592",
            "link": "https://learn.microsoft.com/azure/key-vault/general/overview",
            "service": "SAP",
            "severity": "High",
            "text": "Use Azure Key Vault to store your secrets and credentials",
            "training": "https://learn.microsoft.com/training/modules/manage-secrets-with-azure-key-vault/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "829e2edb-2173-4676-aff6-691b4935ada4",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/lock-resources?tabs=json",
            "service": "SAP",
            "severity": "Medium",
            "text": "It is recommended to LOCK the Azure Resources post successful deployment to safeguard against unauthorized changes. You can also enforce LOCK constraints and rules on your per-subscription basis using customized Azure policies(Custome role).",
            "training": "https://learn.microsoft.com/training/modules/use-azure-resource-manager/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "2223ece8-1b12-4318-8a54-17415833fb4a",
            "link": "https://learn.microsoft.com/azure/key-vault/general/soft-delete-overview",
            "service": "SAP",
            "severity": "Medium",
            "text": "Provision Azure Key Vault with the soft delete and purge policies enabled to allow retention protection for deleted objects.",
            "training": "https://learn.microsoft.com/training/modules/manage-secrets-with-azure-key-vault/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "e3c2df74-3165-4c3a-abe0-5bbe209d490d",
            "link": "https://learn.microsoft.com/azure/role-based-access-control/security-controls-policy",
            "service": "SAP",
            "severity": "High",
            "text": "Based on existing requirements, regulatory and compliance controls (internal/external) - Determine what Azure Policies and Azure RBAC role are needed",
            "training": "https://learn.microsoft.com/training/paths/describe-azure-management-governance/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "a4777842-4d11-4678-9d2f-a56c56ad4840",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/sap/eslz-security-governance-and-compliance",
            "service": "SAP",
            "severity": "High",
            "text": "When enabling Microsoft Defender for Endpoint on SAP environment, recommend excluding data and log files on DBMS servers instead of targeting all servers. Follow your DBMS vendor's recommendations when excluding target files.",
            "training": "https://techcommunity.microsoft.com/t5/running-sap-applications-on-the/microsoft-defender-endpoint-mde-for-sap-applications-on-windows/ba-p/3912268",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "8fe72734-c486-4ba2-a0dc-0591cf65de8e",
            "link": "https://learn.microsoft.com/azure/defender-for-cloud/just-in-time-access-overview?tabs=defender-for-container-arch-aks",
            "service": "SAP",
            "severity": "High",
            "text": "Delegate an SAP admin custom role with just-in-time access of Microsoft Defender for Cloud.",
            "training": "https://learn.microsoft.com/training/modules/secure-vms-with-azure-security-center/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "1309cccd-5792-466b-aca2-75faa1abfe9d",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/sap/eslz-security-governance-and-compliance",
            "service": "SAP",
            "severity": "Low",
            "text": "encrypt data in transit by integrating the third-party security product with secure network communications (SNC) for DIAG (SAP GUI), RFC, and SPNEGO for HTTPS",
            "training": "https://learn.microsoft.com/azure/security/fundamentals/encryption-overview#encryption-of-data-in-transit",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "eeaa3592-829e-42ed-a217-3676aff6691b",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-encryption-key-model-get?tabs=portal",
            "service": "SAP",
            "severity": "Medium",
            "text": "Default to Microsoft-managed keys for principal encryption functionality and use customer-managed keys when required.",
            "training": "https://learn.microsoft.com/training/modules/manage-secrets-with-azure-key-vault/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "4935ada4-2223-4ece-a1b1-23181a541741",
            "link": "https://learn.microsoft.com/ja-jp/azure/key-vault/general/best-practices",
            "service": "SAP",
            "severity": "High",
            "text": "Use an Azure Key Vault per application per environment per region.",
            "training": "https://learn.microsoft.com/training/modules/manage-secrets-with-azure-key-vault/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "abc9634d-c44d-41e9-a530-e8444e16aa3c",
            "link": "https://learn.microsoft.com/azure/key-vault/certificates/certificate-scenarios",
            "service": "SAP",
            "severity": "High",
            "text": "To control and manage disk encryption keys and secrets for non-HANA Windows and non-Windows operating systems, use Azure Key Vault. SAP HANA isn't supported with Azure Key Vault, so you must use alternate methods like SAP ABAP or SSH keys.",
            "training": "https://learn.microsoft.com/training/modules/configure-and-manage-azure-key-vault/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "209d490d-a477-4784-84d1-16785d2fa56c",
            "link": "https://learn.microsoft.com/azure/role-based-access-control/built-in-roles",
            "service": "SAP",
            "severity": "High",
            "text": "Customize role-based access control (RBAC) roles for SAP on Azure spoke subscriptions to avoid accidental network-related changes",
            "training": "https://learn.microsoft.com/training/modules/secure-azure-resources-with-rbac/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "56ad4840-8fe7-4273-9c48-6ba280dc0591",
            "link": "https://blogs.sap.com/2019/07/21/sap-security-operations-on-azure/",
            "service": "SAP",
            "severity": "High",
            "text": "Isolate DMZs and NVAs from the rest of the SAP estate, configure Azure Private Link, and securely manage and control the SAP on Azure resources",
            "training": "https://learn.microsoft.com/azure/architecture/reference-architectures/dmz/secure-vnet-dmz?tabs=portal",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "e124ba34-df68-45ed-bce9-bd3bb0cdb3b5",
            "link": "https://learn.microsoft.com/en-us/training/modules/secure-vms-with-azure-security-center/?source=recommendations",
            "service": "SAP",
            "severity": "Low",
            "text": "Consider using Microsoft anti-malware software on Azure to protect your virtual machines from malicious files, adware, and other threats.",
            "training": "https://azure.microsoft.com/blog/deploying-antimalware-solutions-on-azure-virtual-machines/",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "5eb2ec14-eeaa-4359-8829-e2edb2173676",
            "link": "https://learn.microsoft.com/microsoft-365/security/defender-endpoint/microsoft-defender-endpoint?view=o365-worldwide",
            "service": "SAP",
            "severity": "Low",
            "text": "For even more powerful protection, consider using Microsoft Defender for Endpoint.",
            "training": "https://learn.microsoft.com/training/modules/implement-endpoint-protection-use-microsoft-defender/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "87a924c4-25c2-419f-a2f0-96c7c4fe4525",
            "link": "https://learn.microsoft.com/azure/architecture/guide/sap/sap-whole-landscape",
            "service": "SAP",
            "severity": "High",
            "text": "Isolate the SAP application and database servers from the internet or from the on-premises network by passing all traffic through the hub virtual network, which is connected to the spoke network by virtual network peering. The peered virtual networks guarantee that the SAP on Azure solution is isolated from the public internet.",
            "training": "https://learn.microsoft.com/training/modules/explore-azure-networking/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "491ca1c4-3d40-42c0-9d85-b8933999590b",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/sap/eslz-security-governance-and-compliance",
            "service": "SAP",
            "severity": "Low",
            "text": "For internet-facing applications like SAP Fiori, make sure to distribute load per application requirements while maintaining security levels. For Layer 7 security, you can use a third-party Web Application Firewall (WAF) available in the Azure Marketplace.",
            "training": "https://learn.microsoft.com/training/modules/simplify-cloud-procurement-governance-azure-marketplace/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "checklist": "SAP Checklist",
            "guid": "9fc945b9-0527-47af-8200-9d652fe02fcc",
            "link": "https://learn.microsoft.com/azure/sap/monitor/enable-tls-azure-monitor-sap-solutions",
            "service": "SAP",
            "severity": "Medium",
            "text": "To enable secure communication in Azure Monitor for SAP solutions, you can choose to use either a root certificate or a server certificate. We highly recommend that you use root certificates.",
            "training": "https://learn.microsoft.com/training/modules/implement-azure-monitoring-sap-workloads-azure-virtual-machines/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Search/searchServices",
            "checklist": "Cognitive Search Review Checklist",
            "guid": "41faa1ed-b7f0-447d-8cba-4a4905e5bb83",
            "link": "https://learn.microsoft.com/azure/search/search-reliability#high-availability",
            "service": "Cognitive Search",
            "severity": "High",
            "text": "Enable 2 replicas to have 99.9% availability for read operations",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Search/searchServices",
            "checklist": "Cognitive Search Review Checklist",
            "guid": "7d956fd9-788a-4845-9b9f-c0340972d810",
            "link": "https://learn.microsoft.com/azure/search/search-reliability#high-availability",
            "service": "Cognitive Search",
            "severity": "Medium",
            "text": "Enable 3 replicas to have 99.9% availability for read/write operations",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Search/searchServices",
            "checklist": "Cognitive Search Review Checklist",
            "guid": "44dc5f2b-a032-4d03-aae8-90c3f2c0a4c3",
            "link": "https://learn.microsoft.com/azure/search/search-reliability#availability-zone-support",
            "service": "Cognitive Search",
            "severity": "High",
            "text": "Leverage Availability Zones by enabling read and/or write replicas",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Search/searchServices",
            "checklist": "Cognitive Search Review Checklist",
            "guid": "cd0730f0-0ff1-4b77-9a2b-2a1f7dd5e291",
            "link": "https://learn.microsoft.com/azure/search/search-reliability#multiple-services-in-separate-geographic-regions",
            "service": "Cognitive Search",
            "severity": "Medium",
            "text": "For regional redudancy, Manually create services in 2 or more regions for Search as it doesn't provide an automated method of replicating search indexes across geographic regions",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Search/searchServices",
            "checklist": "Cognitive Search Review Checklist",
            "guid": "3c964882-aec9-4d44-9f68-4b5f2efbbdb6",
            "link": "https://learn.microsoft.com/azure/search/search-reliability#synchronize-data-across-multiple-services",
            "service": "Cognitive Search",
            "severity": "Medium",
            "text": "To synchronize data across multiple services either Use indexers for updating content on multiple services or Use REST APIs for pushing content updates on multiple services",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Search/searchServices",
            "checklist": "Cognitive Search Review Checklist",
            "guid": "85ee93c9-f53c-4803-be51-e6e4aa37ff4e",
            "link": "https://learn.microsoft.com/azure/search/search-reliability#use-azure-traffic-manager-to-coordinate-requests",
            "service": "Cognitive Search",
            "severity": "Medium",
            "text": "Use Azure Traffic Manager to coordinate requests",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Search/searchServices",
            "checklist": "Cognitive Search Review Checklist",
            "guid": "7be10278-57c1-4a61-8ee3-895aebfec5aa",
            "link": "https://learn.microsoft.com/azure/search/search-reliability#back-up-and-restore-alternatives",
            "service": "Cognitive Search",
            "severity": "High",
            "text": "Backup and Restore an Azure Cognitive Search Index. Use this sample code to back up index definition and snapshot to a series of Json files",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Insights/components",
            "checklist": "Cost Optimization Checklist",
            "guid": "a95b86ad-8840-48e3-9273-4b875ba18f20",
            "link": "https://learn.microsoft.com/azure/architecture/guide/multitenant/considerations/tenancy-models",
            "service": "Monitor",
            "severity": "Medium",
            "text": "Data collection rules in Azure Monitor -https://learn.microsoft.com/azure/azure-monitor/essentials/data-collection-rule-overview",
            "training": "https://azure.microsoft.com/pricing/reservations/",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.RecoveryServices/vaults",
            "checklist": "Cost Optimization Checklist",
            "guid": "45901365-d38e-443f-abcb-d868266abca2",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/multi-tenant/automation",
            "service": "Backup",
            "severity": "Medium",
            "text": "check backup instances with the underlying datasource not found",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "Cost Optimization Checklist",
            "guid": "64f9a19a-f29c-495d-94c6-c7919ca0f6c5",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/multi-tenant/lighthouse",
            "service": "VM",
            "severity": "Medium",
            "text": "Delete or archive unassociated services (disks, nics, ip addresses etc)",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.RecoveryServices/vaults",
            "checklist": "Cost Optimization Checklist",
            "guid": "69bad37a-ad53-4cc7-ae1d-76667357c449",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-microsoft-customer-agreement#design-recommendations",
            "service": "Backup",
            "severity": "Medium",
            "text": "Consider a good balance between site recovery storage and backup for non mission critical applications",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Insights/components",
            "checklist": "Cost Optimization Checklist",
            "guid": "674b5ed8-5a85-49c7-933b-e2a1a27b765a",
            "link": "https://learn.microsoft.com/azure/cost-management-billing/manage/direct-ea-administration#manage-notification-contacts",
            "service": "Monitor",
            "severity": "Medium",
            "text": "Check spending and savings opportunities among the 40 different log analytics workspaces- use different retention and data collection for nonprod workspaces-create daily cap for awareness and tier sizing -  If you do set a daily cap, in addition to creating an alert when the cap is reached,ensure that you also create an alert rule to be notified when some percentage has been reached (90% for example). - consider workspace transformation if possible - https://learn.microsoft.com/azure/azure-monitor/essentials/data-collection-transformations#workspace-transformation-dcr ",
            "training": "https://learn.microsoft.com/azure/cost-management-billing/costs/understand-work-scopes",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Insights/components",
            "checklist": "Cost Optimization Checklist",
            "guid": "91be1f38-8ef3-494c-8bd4-63cbbac75819",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-enterprise-agreement#design-considerations",
            "service": "Monitor",
            "severity": "Medium",
            "text": "Enforce a purging log policy and automation (if needed, logs can be moved to cold storage)",
            "training": "https://www.youtube.com/watch?v=nHQYcYGKuyw",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "Cost Optimization Checklist",
            "guid": "6aae01e6-a84d-4e5d-b36d-1d92881a1bd5",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-enterprise-agreement#design-considerations",
            "service": "VM",
            "severity": "Medium",
            "text": "Check that the disks are really needed, if not: delete. If they are needed, find lower storage tiers or use backup -",
            "training": "https://learn.microsoft.com/azure/cost-management-billing/costs/manage-automation",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "Cost Optimization Checklist",
            "guid": "d1e44a19-659d-4395-afd7-7289b835556d",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-enterprise-agreement#design-considerations",
            "service": "Storage",
            "severity": "Medium",
            "text": "Consider moving unused storage to lower tier, with customized rule - https://learn.microsoft.com/azure/storage/blobs/lifecycle-management-policy-configure  ",
            "training": "https://learn.microsoft.com/azure/cost-management-billing/costs/enable-tag-inheritance",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "Cost Optimization Checklist",
            "guid": "d0102cac-6aae-401e-9a84-de5de36d1d92",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "service": "VM",
            "severity": "Medium",
            "text": "Make sure advisor is configured for VM right sizing ",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "Cost Optimization Checklist",
            "description": "check by searching the Meter Category Licenses in the Cost analysys",
            "guid": "59ae568b-a38d-4498-9e22-13dbd7bb012f",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/manage/centralize-operations",
            "service": "VM",
            "severity": "Medium",
            "text": "run the script on all windows VMs https://learn.microsoft.com/azure/virtual-machines/windows/hybrid-use-benefit-licensing?ref=andrewmatveychuk.com#convert-an-existing-vm-using-azure-hybrid-benefit-for-windows-server- consider implementing a policy if windows VMs are created frequently",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "Cost Optimization Checklist",
            "guid": "7b95e06e-158e-42ea-9992-c2de6e2065b3",
            "link": "https://learn.microsoft.com/azure/active-directory/privileged-identity-management/pim-configure",
            "service": "VM",
            "severity": "Medium",
            "text": " this can be also put under AHUB if you already have licenses https://learn.microsoft.com/azure/virtual-machines/linux/azure-hybrid-benefit-linux?tabs=rhelpayg%2Crhelbyos%2CrhelEnablebyos%2Crhelcompliance",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "Cost Optimization Checklist",
            "guid": "75c1e945-b459-4837-bf7a-e7c6d3b475a5",
            "link": "https://learn.microsoft.com/azure/active-directory/fundamentals/active-directory-groups-create-azure-portal",
            "service": "VM",
            "severity": "Medium",
            "text": "Consolidate reserved VM families with flexibility option (no more than 4-5 families)",
            "training": "https://learn.microsoft.com/azure/automation/automation-solution-vm-management",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "Cost Optimization Checklist",
            "guid": "c7acbe49-bbe6-44dd-a9f2-e87778468d55",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/identity-access#prerequisites-for-a-landing-zone---design-recommendations",
            "service": "VM",
            "severity": "Medium",
            "text": "Utilize Azure Reserved Instances: This feature allows you to reserve VMs for a period of 1 or 3 years, providing significant cost savings compared to PAYG prices.",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "Cost Optimization Checklist",
            "guid": "a6bcca2b-4fea-41db-b3dd-95d48c7c891d",
            "link": "https://learn.microsoft.com/azure/active-directory-domain-services/overview",
            "service": "VM",
            "severity": "Medium",
            "text": "Only larger disks can be reserved => 1 TiB -",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "Cost Optimization Checklist",
            "guid": "cb1f7d57-59ae-4568-aa38-d4985e2213db",
            "link": "https://learn.microsoft.com/azure/architecture/reference-architectures/identity/adds-extend-domain",
            "service": "VM",
            "severity": "Medium",
            "text": "After the right-sizing optimization",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Sql/servers",
            "checklist": "Cost Optimization Checklist",
            "guid": "d7bb012f-7b95-4e06-b158-e2ea3992c2de",
            "link": "https://learn.microsoft.com/azure/active-directory/app-proxy/application-proxy",
            "service": "Azure SQL",
            "severity": "Medium",
            "text": "Check if applicable and enforce policy/change https://learn.microsoft.com/azure/azure-sql/azure-hybrid-benefit?view=azuresql&tabs=azure-portalhttps://learn.microsoft.com/azure/cost-management-billing/scope-level/create-sql-license-assignments?source=recommendations",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "Cost Optimization Checklist",
            "guid": "6e2065b3-a76a-4f4a-991e-8839ada46667",
            "link": "https://learn.microsoft.com/azure/active-directory/roles/best-practices",
            "service": "VM",
            "severity": "Medium",
            "text": "The VM + license part discount (ahub + 3YRI) is around 70% discount",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "Cost Optimization Checklist",
            "guid": "ccbd9792-a6bc-4ca2-a4fe-a1dbf3dd95d4",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#send-logs-to-microsoft-sentinel",
            "service": "VM",
            "severity": "Medium",
            "text": "Consider using a VMSS to match demand rather than flat sizing",
            "waf": "Cost"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Cost Optimization Checklist",
            "guid": "c1b1cd52-1e54-4a29-a9de-39ac0e7c28dc",
            "link": "https://learn.microsoft.com/azure/reliability/cross-region-replication-azure",
            "service": "AKS",
            "severity": "Medium",
            "text": "Use AKS autoscaler to match your clusters usage (make sure the pods requirements match the scaler)",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.RecoveryServices/vaults",
            "checklist": "Cost Optimization Checklist",
            "guid": "44be3b1a-27f8-4b9e-a1be-1f38df03a822",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/data-retention-archive?tabs=portal-1%2Cportal-2#how-retention-and-archiving-work",
            "service": "Backup",
            "severity": "Medium",
            "text": "Move recovery points to vault-archive where applicable (Validate)",
            "training": "https://azure.microsoft.com/pricing/reservations/",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Databricks/workspaces",
            "checklist": "Cost Optimization Checklist",
            "guid": "cd463cbb-bc8a-4c29-aebc-91a43da1dae2",
            "link": "https://learn.microsoft.com/azure/databricks/clusters/cluster-config-best-practices#automatic-termination",
            "service": "Databricks",
            "severity": "Medium",
            "text": "Consider using Spot VMs with fallback where possible. Consider autotermination of clusters.",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Web/sites",
            "checklist": "Cost Optimization Checklist",
            "guid": "cc881470-607c-41cc-a0e6-14658dd458e9",
            "link": "https://learn.microsoft.com/azure/governance/policy/how-to/guest-configuration-create",
            "service": "Functions",
            "severity": "Medium",
            "text": "Functions - Reuse connections",
            "training": "https://learn.microsoft.com/azure/cost-management-billing/reservations/reservation-apis?toc=%2Fazure%2Fcost-management-billing%2Ftoc.json",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Web/sites",
            "checklist": "Cost Optimization Checklist",
            "guid": "27139b82-1102-4dbd-9eaf-11e6f843e52f",
            "link": "https://learn.microsoft.com/azure/automation/update-management/overview",
            "service": "Functions",
            "severity": "Medium",
            "text": "Functions - Cache data locally",
            "training": "https://learn.microsoft.com/learn/paths/azure-administrator-manage-compute-resources/",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Web/sites",
            "checklist": "Cost Optimization Checklist",
            "guid": "4722d928-c1b1-4cd5-81e5-4a29b9de39ac",
            "link": "https://learn.microsoft.com/azure/network-watcher/network-watcher-monitoring-overview",
            "service": "Functions",
            "severity": "Medium",
            "text": "Functions - Cold starts-Use the 'Run from package' functionality. This way, the code is downloaded as a single zip file. This can, for example, result in significant improvements with Javascript functions, which have a lot of node modules.Use language specific tools to reduce the package size, for example, tree shaking Javascript applications.",
            "training": "https://learn.microsoft.com/learn/modules/configure-network-watcher/",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Web/sites",
            "checklist": "Cost Optimization Checklist",
            "guid": "0e7c28dc-9366-4572-82bf-f4564b0d934a",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/lock-resources?tabs=json",
            "service": "Functions",
            "severity": "Medium",
            "text": "Functions - Keep your functions warm",
            "training": "https://learn.microsoft.com/learn/paths/implement-resource-mgmt-security/",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Web/sites",
            "checklist": "Cost Optimization Checklist",
            "guid": "359c363e-7dd6-4162-9a36-4a907ebae38e",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "service": "Functions",
            "severity": "Medium",
            "text": "When using autoscale with different functions, there might be one driving all the autoscale for all the resources - consider moving it to a separate consumption plan (and consider higher plan for CPU)",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Web/sites",
            "checklist": "Cost Optimization Checklist",
            "guid": "ad53cc7d-e2e8-4aaa-a357-1549ab9153d8",
            "link": "https://learn.microsoft.com/azure/service-health/alerts-activity-log-service-notifications-portal",
            "service": "Functions",
            "severity": "Medium",
            "text": "Function apps in a given plan are all scaled together, so any issues with scaling can affect all apps in the plan.",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Web/sites",
            "checklist": "Cost Optimization Checklist",
            "guid": "9f89dc7b-44be-43b1-a27f-8b9e91be1f38",
            "link": "https://learn.microsoft.com/azure/azure-monitor/alerts/action-groups",
            "service": "Functions",
            "severity": "Medium",
            "text": "Am I billed for 'await time'? This question is typically asked in the context of a C# function that does an async operation and waits for the result, e.g. await Task.Delay(1000) or await client.GetAsync('http://google.com'). The answer is yes - the GB second calculation is based on the start and end time of the function and the memory usage over that period. What actually happens over that time in terms of CPU activity is not factored into the calculation.One exception to this rule is if you are using durable functions. You are not billed for time spent at awaits in orchestrator functions.apply demand shaping techinques where possible (dev environments?) https://github.com/Azure-Samples/functions-csharp-premium-scaler",
            "waf": "Cost"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "Cost Optimization Checklist",
            "guid": "3da1dae2-cc88-4147-8607-c1cca0e61465",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/design-logs-deployment",
            "service": "Front Door",
            "severity": "Medium",
            "text": "Frontdoor - Turn off the default homepageIn the application settings of your App, set AzureWebJobsDisableHomepage to true. This will return a 204 (No Content) to the PoP so only header data is returned.",
            "waf": "Cost"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "Cost Optimization Checklist",
            "guid": "8dd458e9-2713-49b8-8110-2dbd6eaf11e6",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-setup-guide/monitoring-reporting?tabs=AzureMonitor",
            "service": "Front Door",
            "severity": "Medium",
            "text": "Frontdoor - Route to something that returns nothing. Either set up a Function, Function Proxy, or add a route in your WebApp that returns 200 (OK) and sends no or minimal content. The advantage of this is you will be able to log out when it is called.",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "Cost Optimization Checklist",
            "guid": "7e31c67d-68cf-46a6-8a11-94956d697dc3",
            "link": "https://learn.microsoft.com/azure/architecture/best-practices/monitoring",
            "service": "Storage",
            "severity": "Medium",
            "text": "Consider archiving tiers for less used data",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "Cost Optimization Checklist",
            "guid": "a2ed27b2-d186-4f1a-8252-bddde68a487c",
            "link": "https://learn.microsoft.com/azure/automation/how-to/region-mappings",
            "service": "VM",
            "severity": "Medium",
            "text": "Check disk sizes where the size does not match the tier (i.e. A 513 GiB disk will pay a P30 (1TiB) and consider resizing",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "Cost Optimization Checklist",
            "guid": "dec4861b-c3bc-410a-b77e-26e4d5a3bec2",
            "link": "https://learn.microsoft.com/azure/governance/policy/concepts/guest-configuration",
            "service": "Storage",
            "severity": "Medium",
            "text": "Consider using standard SSD rather than Premium or Ultra where possible",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "Cost Optimization Checklist",
            "guid": "c4e2436b-1336-4db5-9f17-960eee0bdf5c",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/management-operational-compliance#monitoring-for-configuration-drift",
            "service": "Storage",
            "severity": "Medium",
            "text": "For storage accounts, make sure that the chosen tier is not adding up transaction charges (it might be cheaper to move to the next tier)",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.RecoveryServices/vaults",
            "checklist": "Cost Optimization Checklist",
            "guid": "c2efc5d7-61d4-41d2-900b-b47a393a040f",
            "link": "https://learn.microsoft.com/azure/site-recovery/site-recovery-overview",
            "service": "Site Recovery",
            "severity": "Medium",
            "text": "For ASR, consider using Standard SSD disks if the RPO/RTO and replication throughput allow it",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "Cost Optimization Checklist",
            "guid": "d3294798-b118-48b2-a5a4-6ceb544451e1",
            "link": "https://learn.microsoft.com/azure/architecture/framework/resiliency/backup-and-recovery",
            "service": "Storage",
            "severity": "Medium",
            "text": "Storage accounts: check hot tier and/or GRS necessary",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "Cost Optimization Checklist",
            "guid": "92d34429-3c76-4286-97a5-51c5b04e4f18",
            "link": "https://learn.microsoft.com/azure/backup/backup-center-overview",
            "service": "VM",
            "severity": "Medium",
            "text": "Disks - validate use of Premium SSD disks everywhere: for example, non-prod could swap to Standard SSD or on-demand Premium SSD  ",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Synapse/workspaces",
            "checklist": "Cost Optimization Checklist",
            "guid": "54387e5c-ed12-46cd-832a-f5b2fc6998a5",
            "link": "https://learn.microsoft.com/azure/reliability/availability-zones-overview",
            "service": "Synapse",
            "severity": "Medium",
            "text": "Create budgets to manage costs and create alerts that automatically notify stakeholders of spending anomalies and overspending risks.",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Synapse/workspaces",
            "checklist": "Cost Optimization Checklist",
            "guid": "35e33789-7e31-4c67-b68c-f6a62a119495",
            "link": "https://learn.microsoft.com/azure/virtual-machines/availability",
            "service": "Synapse",
            "severity": "Medium",
            "text": "Export cost data to a storage account for additional data analysis.",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Synapse/workspaces",
            "checklist": "Cost Optimization Checklist",
            "guid": "6d697dc3-a2ed-427b-8d18-6f1a1252bddd",
            "link": "https://learn.microsoft.com/azure/load-balancer/load-balancer-overview",
            "service": "Synapse",
            "severity": "Medium",
            "text": "Control costs for a dedicated SQL pool by pausing the resource when it is not in use.",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Synapse/workspaces",
            "checklist": "Cost Optimization Checklist",
            "guid": "e68a487c-dec4-4861-ac3b-c10ae77e26e4",
            "link": "https://learn.microsoft.com/azure/virtual-machine-scale-sets/overview",
            "service": "Synapse",
            "severity": "Medium",
            "text": "Enable the serverless Apache Spark automatic pause feature and set your timeout value accordingly.",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Synapse/workspaces",
            "checklist": "Cost Optimization Checklist",
            "guid": "d5a3bec2-c4e2-4436-a133-6db55f17960e",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-latest-version-for-customer-managed-certificates",
            "service": "Synapse",
            "severity": "Medium",
            "text": "Create multiple Apache Spark pool definitions of various sizes.",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Synapse/workspaces",
            "checklist": "Cost Optimization Checklist",
            "guid": "ee0bdf5c-c2ef-4c5d-961d-41d2500bb47a",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/resource-org-management-groups#management-groups-in-the-azure-landing-zone-accelerator",
            "service": "Synapse",
            "severity": "Medium",
            "text": "Purchase Azure Synapse commit units (SCU) for one year with a pre-purchase plan to save on your Azure Synapse Analytics costs.",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "Cost Optimization Checklist",
            "guid": "393a040f-d329-4479-ab11-88b2c5a46ceb",
            "link": "https://learn.microsoft.com/azure/application-gateway/overview-v2",
            "service": "VM",
            "severity": "Medium",
            "text": "Use Spot VMs for interruptible jobs: These are VMs that can be bid on and purchased at a discounted price, providing a cost-effective solution for non-critical workloads.",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "Cost Optimization Checklist",
            "guid": "544451e1-92d3-4442-a3c7-628637a551c5",
            "link": "https://learn.microsoft.com/azure/load-balancer/load-balancer-overview",
            "service": "VM",
            "severity": "Medium",
            "text": "Right-sizing all VMs",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "Cost Optimization Checklist",
            "guid": "b04e4f18-5438-47e5-aed1-26cd032af5b2",
            "link": "https://learn.microsoft.com/azure/application-gateway/configuration-infrastructure#size-of-the-subnet",
            "service": "VM",
            "severity": "Medium",
            "text": "Swap VM sized with normalized and most recent sizes",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "Cost Optimization Checklist",
            "guid": "fc6998a5-35e3-4378-a7e3-1c67d68cf6a6",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "service": "VM",
            "severity": "Medium",
            "text": "right-sizing VMs - start with monitoring usage below 5% and then work up to 40%",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "Cost Optimization Checklist",
            "guid": "2a119495-6d69-47dc-9a2e-d27b2d186f1a",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "service": "VM",
            "severity": "Medium",
            "text": "Containerizing an application can improve VM density and save money on scaling it",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "a85b86ad-884f-48e3-9273-4b875ba18f10",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/concepts/system-message#define-additional-safety-and-behavioral-guardrails",
            "service": "OpenAI",
            "severity": "High",
            "text": "Follow Metaprompting guardrails for resonsible AI",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "d4391898-cd28-48be-b6b1-7cb8245451e1",
            "link": "https://github.com/Azure-Samples/AI-Gateway",
            "service": "OpenAI",
            "severity": "High",
            "text": "Consider Gateway patterns with APIM  or solutions like AI central for better rate limiting, load balancing, authentication and logging",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "aed3453a-ec72-4392-97a1-52d6cc5e4029",
            "link": "https://techcommunity.microsoft.com/t5/fasttrack-for-azure/azure-openai-insights-monitoring-ai-with-confidence/ba-p/4026850",
            "service": "OpenAI",
            "severity": "High",
            "text": "Enable monitoring for your AOAI instances",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "697cb391-ed16-4b2d-886f-0a0241addde6",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/monitoring#set-up-alerts",
            "service": "OpenAI",
            "severity": "High",
            "text": "Create alerts to notify teams of events such as an entry in the activity log created by an action performed on the resource, such as regenerating its subscription keys or a metric threshold such as the number of errors exceeding 10 in an hour",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "8a477cde-b486-41bc-9bc1-0ae66e25d4d5",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/monitoring",
            "service": "OpenAI",
            "severity": "High",
            "text": "Monitor token usage to prevent service disruptions due to capacity",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "a3aec2c4-e243-46b0-936c-b45e17960eee",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/monitoring",
            "service": "OpenAI",
            "severity": "Medium",
            "text": "observe metrics like processed inference tokens, generated completion tokens monitor for rate limit",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "fbdf4cc2-eec4-4d76-8c31-d25ffbb46a39",
            "link": "https://techcommunity.microsoft.com/t5/apps-on-azure-blog/build-an-enterprise-ready-azure-openai-solution-with-azure-api/ba-p/3907562",
            "service": "OpenAI",
            "severity": "Low",
            "text": "Enable and configure Diagnostics for the Azure OpenAI Service. If not sufficient, consider using a gateway such as Azure API Managements in front of Azure OpenAI to log both incoming prompts and outgoing responses, where permitted",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "3af30ed3-2947-498b-8178-a2c5a46ceb54",
            "link": "https://github.com/Azure-Samples/openai-enterprise-iac",
            "service": "OpenAI",
            "severity": "High",
            "text": "Use Infrastructure as code to deploy the Azure OpenAI Service, model deployments, and all related resources",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "4350d092-d234-4292-a752-8537a551c5bf",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/managed-identity",
            "service": "OpenAI",
            "severity": "High",
            "text": "Use Microsoft Entra Authentication with Managed Identity instead of API Key",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "4e4f1854-287d-45cd-a126-cc031af5b1fc",
            "link": "https://learn.microsoft.com/azure/machine-learning/prompt-flow/how-to-bulk-test-evaluate-flow?view=azureml-api-2",
            "service": "OpenAI",
            "severity": "High",
            "text": "Evaluate the performance/accuracy of the system with a known golden dataset which has the inputs and the correct answers. Leverage capabilities in PromptFlow for Evaluation.",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "68889535-e327-4897-b31b-67d67be5962a",
            "link": "https://learn.microsoft.com/azure/architecture/ai-ml/architecture/baseline-openai-e2e-chat#azure-openai---performance-efficiency",
            "service": "OpenAI",
            "severity": "High",
            "text": "Evaluate usage of Provisioned throughput model ",
            "waf": "Performance"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "cd288bed-6b17-4cb8-8454-51e1aed3453a",
            "link": "https://learn.microsoft.com/azure/ai-services/content-safety/overview",
            "service": "OpenAI",
            "severity": "High",
            "text": "Review and implement Azure AI content safety",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "1193846d-697c-4b39-8ed1-6b2d186f0a02",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/latency#system-level-throughput",
            "service": "OpenAI",
            "severity": "High",
            "text": "Define and evaluate the throughput of the system based on tokens & response per minute and align with requirements",
            "waf": "Performance"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "41addde6-8a47-47cd-bb48-61bc3bc10ae6",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/latency#improve-performance",
            "service": "OpenAI",
            "severity": "Medium",
            "text": "Improve latency of the system by limiting token sizes, streaming options for applications like chatbots or conversational interfaces. Streaming can enhance the perceived performance of Azure OpenAI applications by delivering responses to users in an incremental manner",
            "waf": "Performance"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "6e25d4d5-a3ae-4c2c-9e24-36b0336cb45e",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/latency#batching",
            "service": "OpenAI",
            "severity": "Medium",
            "text": "Estimate elasticity demands to determine synchronous and batch request segregation based on priority. For high priority, use synchronous approach and for low priority, asynchronous batch processing with queue is preferred",
            "waf": "Performance"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "5bda4332-4f24-4811-9331-82ba51752694",
            "link": "https://github.com/Azure/azure-openai-benchmark/",
            "service": "OpenAI",
            "severity": "High",
            "text": "Benchmark token consumption requirements based on estimated demands from consumers. Consider using the Azure OpenAI benchmarking tool to help you validate the throughput if you are using Provisioned Throughput Unit deployments",
            "waf": "Performance"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "4008ae7d-7e47-4432-96d8-bdcf55bce619",
            "link": "https://techcommunity.microsoft.com/t5/fasttrack-for-azure/optimizing-azure-openai-a-guide-to-limits-quotas-and-best/ba-p/4076268",
            "service": "OpenAI",
            "severity": "Medium",
            "text": "If you are using Provisioned Throughput Units (PTUs), consider deploying a token-per-minute (TPM) deployment for overflow requests. Use a gateway to route requests to the TPM deployment when the PTU limits are reached.",
            "waf": "Performance"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "e8a13f98-8794-424d-9267-86d60b96c97b",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/concepts/models",
            "service": "OpenAI",
            "severity": "High",
            "text": "Choose the right model for the right task. Pick models with right tradeoff between speed, quality of response and output complexity",
            "waf": "Performance"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "e9951904-8384-45c9-a6cb-2912156a1147",
            "link": "https://github.com/Azure/azure-openai-benchmark/",
            "service": "OpenAI",
            "severity": "Medium",
            "text": "Have a baseline for performance without fine-tuning for knowing whether or not fine-tuning has improved model performance",
            "waf": "Performance"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "5e39f541-accc-4d97-a376-bcdb3750ab2a",
            "link": "https://learn.microsoft.com/azure/architecture/ai-ml/architecture/baseline-openai-e2e-chat#azure-openai---reliability",
            "service": "OpenAI",
            "severity": "Low",
            "text": "Deploy multiple OAI instances across regions",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "b039da6d-55d7-4c89-8adb-107d5325af62",
            "link": "https://learn.microsoft.com/azure/architecture/ai-ml/architecture/baseline-openai-e2e-chat#azure-openai---reliability",
            "service": "OpenAI",
            "severity": "High",
            "text": "Implement retry & healthchecks with Gateway pattern like APIM",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "5ca44e46-85e2-4223-ace8-bb12308ca5f1",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/quota?tabs=rest#introduction-to-quota",
            "service": "OpenAI",
            "severity": "Medium",
            "text": "Ensure having adequate quotas of TPM & RPM for the workload",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "ec723923-7a15-42d6-ac5e-402925387e5c",
            "link": "https://www.microsoft.com/research/project/guidelines-for-human-ai-interaction/",
            "service": "OpenAI",
            "severity": "Medium",
            "text": "Review the considerations in HAI toolkit guidance and apply those interaction practices for the slution",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "7f154e3a-a369-4282-ae7e-316183687a04",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/business-continuity-disaster-recovery",
            "service": "OpenAI",
            "severity": "Medium",
            "text": "Deploy separate fine tuned models across regions if finetuning is employed",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "77a1f893-5bda-4433-84f2-4811633182ba",
            "link": "https://learn.microsoft.com/azure/backup/backup-overview",
            "service": "OpenAI",
            "severity": "Medium",
            "text": "Regularly backup and replicate critical data to ensure data availability and recoverability in case of data loss or system failures. Leverage Azure's backup and disaster recovery services to protect your data.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "95b96ad8-844c-4e3b-8b38-b876ba2cf204",
            "link": "https://www.microsoft.com/licensing/docs/view/Service-Level-Agreements-SLA-for-Online-Services?lang=1",
            "service": "OpenAI",
            "severity": "High",
            "text": "Azure AI search service tiers should be choosen to have a SLA ",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "99013a5d-3ce4-474d-acbd-8682a6abca2a",
            "link": "https://learn.microsoft.com/purview/purview",
            "service": "OpenAI",
            "severity": "Low",
            "text": "Classify data and sensitivity, labeling with Microsoft Purview before generating the embeddings and make sure to treat the embeddings generated with same sensitivity and classification",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "4fda1dbf-3dd9-45d4-ac7c-891dca1f6d56",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/use-your-data-securely",
            "service": "OpenAI",
            "severity": "High",
            "text": "Encrypt data used for RAG with SSE/Disk encryption with optional BYOK",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "59ae558b-937d-4498-9e11-12dbd7ba012f",
            "link": "https://learn.microsoft.com/azure/search/search-security-overview",
            "service": "OpenAI",
            "severity": "High",
            "text": "Ensure TLS is enforced for data in transit across data sources, AI search used for Retrieval-Augmented Generation (RAG) and LLM communication",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "7b94ef6e-047d-42ea-8992-b1cd6e2054b2",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/role-based-access-control",
            "service": "OpenAI",
            "severity": "High",
            "text": "Use RBAC to manage access to Azure OpenAI services. Assign appropriate permissions to users and restrict access based on their roles and responsibilities",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "9769e4a6-91e8-4838-ac93-6667e13c0056",
            "link": "https://learn.microsoft.com/azure/security/fundamentals/data-encryption-best-practices",
            "service": "OpenAI",
            "severity": "Medium",
            "text": "Implement data encryption,  masking or redaction techniques to hide sensitive data or replace it with obfuscated values in non-production environments or when sharing data for testing or troubleshooting purposes",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "74b1e945-b459-4837-be7a-d6c6d3b375a5",
            "link": "https://learn.microsoft.com/azure/defender-for-cloud/defender-for-cloud-introduction",
            "service": "OpenAI",
            "severity": "High",
            "text": "Utilize Azure Defender to detect and respond to security threats and set up monitoring and alerting mechanisms to identify suspicious activities or breaches. Leverage Azure Sentinel for advanced threat detection and response",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "c7acbe48-abe5-44cd-99f2-e87768468c55",
            "link": "https://techcommunity.microsoft.com/t5/azure-storage-blog/managing-long-term-log-retention-or-any-business-data/ba-p/2494791",
            "service": "OpenAI",
            "severity": "Medium",
            "text": "Establish data retention and disposal policies to adhere to compliance regulations. Implement secure deletion methods for data that is no longer required and maintain an audit trail of data retention and disposal activities",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "a9c27d9c-42bb-46bd-8c69-99a246f3389a",
            "link": "https://learn.microsoft.com/azure/ai-services/content-safety/concepts/jailbreak-detection",
            "service": "OpenAI",
            "severity": "High",
            "text": "Implement Prompt shields and groundedness detection using Content Safety ",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "a775c6ee-95b9-46ad-a844-ce3b2b38b876",
            "link": "https://learn.microsoft.com/azure/compliance/",
            "service": "OpenAI",
            "severity": "High",
            "text": "Ensure compliance with relevant data protection regulations, such as GDPR or HIPAA, by implementing privacy controls and obtaining necessary consents or permissions for data processing activities.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "ba2cf204-9901-43a5-b3ce-474dccbd8682",
            "service": "OpenAI",
            "severity": "Medium",
            "text": "Educate your employees about data security best practices, the importance of handling data securely, and potential risks associated with data breaches. Encourage them to follow data security protocols diligently.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "eae01e6e-842e-452f-9721-d928c1b1cd52",
            "service": "OpenAI",
            "severity": "High",
            "text": "Keep production data separate from development and testing data. Only use real sensitive data in production and utilize anonymized or synthetic data in development and test environments.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "1e54a29a-9de3-499c-bd7b-28dc93555620",
            "service": "OpenAI",
            "severity": "Medium",
            "text": "If you have varying levels of data sensitivity, consider creating separate indexes for each level. For instance, you could have one index for general data and another for sensitive data, each governed by different access protocols",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "2bfe4564-b0d8-434a-948b-263e6dd60512",
            "service": "OpenAI",
            "severity": "Medium",
            "text": "Take segregation a step further by placing sensitive datasets in different instances of the service. Each instance can be controlled with its own specific set of RBAC policies",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "a36498f6-dbad-438e-ad53-cc7ce1d7aaab",
            "service": "OpenAI",
            "severity": "High",
            "text": "Recognize that embeddings and vectors generated from sensitive information are themselves sensitive. This data should be afforded the same protective measures as the source material",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "3571449a-b805-43d8-af89-dc7b33be2a1a",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/role-based-access-control",
            "service": "OpenAI",
            "severity": "High",
            "text": "Apply RBAC to th data stores having embeddings and vectors and scope access based on role's access requirements",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "27f7b9e9-1be1-4f38-aef3-9812bd463cbb",
            "link": "https://techcommunity.microsoft.com/t5/azure-architecture-blog/azure-openai-private-endpoints-connecting-across-vnet-s/ba-p/3913325",
            "service": "OpenAI",
            "severity": "High",
            "text": "Configure private endpoint for AI services to restrict service access within your network",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "ac8ac199-ebb9-41a3-9d90-cae2cc881370",
            "service": "OpenAI",
            "severity": "High",
            "text": "Enforce strict inbound and outbound traffic control with Azure Firewall and UDRs and limit the external integration points",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "6f7c0cba-fe51-4464-add4-57e927138b82",
            "service": "OpenAI",
            "severity": "High",
            "text": "Implement network segmentation and access controls to restrict access to the LLM application only to authorized users and systems and prevent lateral movement",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "7f42c78e-78cb-46a2-8ad1-90916e6a8d8f",
            "link": "https://www.microsoft.com/research/blog/llmlingua-innovating-llm-efficiency-with-prompt-compression/",
            "service": "OpenAI",
            "severity": "Medium",
            "text": "Use prompt compression tools like LLMLingua or gprtrim",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "1102cac6-eae0-41e6-b842-e52f4721d928",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/managed-identity",
            "service": "OpenAI",
            "severity": "High",
            "text": "Ensure that APIs and endpoints used by the LLM application are properly secured with authentication and authorization mechanisms, such as Managed identities,  API keys or OAuth, to prevent unauthorized access.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "c1b1cd52-1e54-4a29-a9de-399cfd7b28dc",
            "link": "https://techcommunity.microsoft.com/t5/azure-architecture-blog/security-best-practices-for-genai-applications-openai-in-azure/ba-p/4027885",
            "service": "OpenAI",
            "severity": "Medium",
            "text": "Enforce strong end user authentication mechanisms, such as multi-factor authentication, to prevent unauthorized access to the LLM application and associated network resources",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "93555620-2bfe-4456-9b0d-834a348b263e",
            "service": "OpenAI",
            "severity": "Medium",
            "text": "Implement network monitoring tools to detect and analyze network traffic for any suspicious or malicious activities. Enable logging to capture network events and facilitate forensic analysis in case of security incidents",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "6dd60512-a364-498f-9dba-d38ead53cc7c",
            "service": "OpenAI",
            "severity": "Medium",
            "text": "Conduct security audits and penetration testing to identify and address any network security weaknesses or vulnerabilities in the LLM application's network infrastructure",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "e1d7aaab-3571-4449-ab80-53d89f89dc7b",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/tag-resources?tabs=json",
            "service": "OpenAI",
            "severity": "Low",
            "text": "Azure AI Services are properly tagged for better management",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "77036e5e-6b4b-4ed3-b503-547c1347dc56",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/resource-abbreviations",
            "service": "OpenAI",
            "severity": "Low",
            "text": "Azure AI Service accounts follows organizational naming conventions",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "028a71ff-e1ce-415d-b3f0-d5e772d41e36",
            "link": "https://learn.microsoft.com/azure/ai-services/diagnostic-logging",
            "service": "OpenAI",
            "severity": "High",
            "text": "Diagnostic logs in Azure AI services resources should be enabled",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "11cc57b4-a4b1-4410-b439-58a8c2289b3d",
            "link": "https://learn.microsoft.com/azure/ai-services/authentication",
            "service": "OpenAI",
            "severity": "High",
            "text": "Key access (local authentication) is recommended to be disabled for security.  After disabling key based access, Microsoft Entra ID becomes the only access method, which allows maintaining minimum privilege principle and granular control. ",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "6b57cfc6-5546-41e1-a3e3-453a3c863964",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "OpenAI",
            "severity": "High",
            "text": "Store and manage keys securely using Azure Key Vault. Avoid hard-coding or embedding sensitive keys within your LLM application's code and retrieve them securely from Azure Key Vault using managed identities",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "8b652d6c-15f5-4129-9539-8e6ded227dd1",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "OpenAI",
            "severity": "High",
            "text": "Regularly rotate and expire keys stored in Azure Key Vault to minimize the risk of unauthorized access.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "adfe27be-e297-401a-a352-baaab79b088d",
            "link": "https://github.com/openai/tiktoken",
            "service": "OpenAI",
            "severity": "High",
            "text": "Use tiktoken to understand token sizes for token optimizations in conversational mode",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "42b06c21-d799-49a6-96f4-389a7f42c78e",
            "link": "https://learn.microsoft.com/azure/security/develop/secure-dev-overview",
            "service": "OpenAI",
            "severity": "High",
            "text": "Follow secure coding practices to prevent common vulnerabilities such as injection attacks, cross-site scripting (XSS), or security misconfigurations",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "78c06a73-a22a-4495-9e6a-8dc4a20e27c3",
            "link": "https://learn.microsoft.com/azure/devops/repos/security/github-advanced-security-dependency-scanning?view=azure-devops",
            "service": "OpenAI",
            "severity": "High",
            "text": "Setup a process to regularly update and patch the LLM libraries and other system components",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "e29711b1-352b-4eee-879b-588defc4972c",
            "link": "https://learn.microsoft.com/legal/cognitive-services/openai/code-of-conduct",
            "service": "OpenAI",
            "severity": "High",
            "text": "Adhere to Azure OpenAI or other LLMs terms of use, policies and guidance and allowed use cases",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "d3cd21bf-7703-46e5-b6b4-bed3d503547c",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/manage-costs#base-series-and-codex-series-fine-tuned-models",
            "service": "OpenAI",
            "severity": "Medium",
            "text": "Understand difference in cost of base models and fine tuned models and token step sizes",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "1347dc56-028a-471f-be1c-e15dd3f0d5e7",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/latency#batching",
            "service": "OpenAI",
            "severity": "High",
            "text": "Batch requests, where possible, to minimize the per-call overhead which can reduce overall costs. Ensure you optimize batch size",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "72d41e36-11cc-457b-9a4b-1410d43958a8",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/manage-costs",
            "service": "OpenAI",
            "severity": "Medium",
            "text": "Set up a cost tracking system that monitors model usage and use that information to help inform model choices and prompt sizes",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "166cd072-af9b-4141-a898-a535e737897e",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/quota?tabs=rest#understanding-rate-limits",
            "service": "OpenAI",
            "severity": "Medium",
            "text": "Set a maximum limit on the number of tokens per model response (max_tokens and the number of completions to generate). Optimize the size to ensure it is large enough for a valid response",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "71ca7da8-cfa9-462a-8594-946da97dc3a2",
            "link": "https://learn.microsoft.com/azure/search/search-reliability",
            "service": "OpenAI",
            "severity": "Medium",
            "text": "Review the guidance provided on setting up AI search for Reliability",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "3266b225-86f4-4a16-92bd-ddea8a487cde",
            "link": "https://learn.microsoft.com/azure/search/vector-search-index-size?tabs=portal-vector-quota",
            "service": "OpenAI",
            "severity": "Medium",
            "text": "Plan and manage AI Search Vector storage",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "b4861bc3-bc14-4aeb-9e66-e8d9a3aec218",
            "link": "https://learn.microsoft.com/azure/machine-learning/prompt-flow/how-to-end-to-end-llmops-with-prompt-flow?view=azureml-api-2",
            "service": "OpenAI",
            "severity": "Medium",
            "text": "Ensure deployment of Azure OpenAI instances across your various environments, such as development, test, and production supporting lrarning & experimentation. Apply LLMOps practices to automate the lifecycle management of your GenAI applications",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "aa80932c-8ec9-4d1b-a770-26e5e6beba9e",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/provisioned-throughput-onboarding#understanding-the-provisioned-throughput-purchase-model",
            "service": "OpenAI",
            "severity": "High",
            "text": "Evaluate usage of billing models - PAYG vs PTU. Start with PAYG and consider PTU when the usage is predictable in production since it offers dedicated memory and compute, reserved capacity, and consistent maximum latency for the specified model version",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "e6436b07-36db-455f-9796-03334bdf9cc2",
            "link": "https://techcommunity.microsoft.com/t5/ai-azure-ai-services-blog/how-to-control-azure-openai-models/ba-p/4146793",
            "service": "OpenAI",
            "severity": "Medium",
            "text": "Evaluate the quality of  prompts and applications when switching between model versions",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "3418db61-2712-4650-9bb4-7a393a080327",
            "link": "https://learn.microsoft.com/azure/machine-learning/prompt-flow/concept-model-monitoring-generative-ai-evaluation-metrics?view=azureml-api-2",
            "service": "OpenAI",
            "severity": "Medium",
            "text": "Evaluate, monitor and refine your GenAI apps for features like groundedness, relevance, accuracy, coherence and fluency",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "294798b1-578b-4219-a46c-eb5443513592",
            "service": "OpenAI",
            "severity": "Medium",
            "text": "Evaluate your Azure AI Search results based on different search parameters",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "2744293b-b628-4537-a551-19b08e8f5854",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/concepts/fine-tuning-considerations",
            "service": "OpenAI",
            "severity": "Medium",
            "text": "Look at fine tuning models as way of increasing accuracy only when you have tried other basic approaches like prompt engineering and RAG with your data",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "287d9cec-166c-4d07-8af9-b141a898a535",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/concepts/advanced-prompt-engineering?pivots=programming-language-chat-completions",
            "service": "OpenAI",
            "severity": "Medium",
            "text": "Use prompt engineering techniques to improve the accuracy of LLM responses",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "e737897e-71ca-47da-acfa-962a1594946d",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/concepts/red-teaming",
            "service": "OpenAI",
            "severity": "Medium",
            "text": "Red team your GenAI applications",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "edb117e6-76aa-4f66-aca4-8e5a95f2223e",
            "link": "https://www.microsoft.com/haxtoolkit/guideline/encourage-granular-feedback/",
            "service": "OpenAI",
            "severity": "Medium",
            "text": "Provide end users with scoring options for LLM responses and track these scores. ",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "d5f3547c-c346-4d81-9028-a71ffe1b9b5d",
            "link": "https://techcommunity.microsoft.com/t5/fasttrack-for-azure/optimizing-azure-openai-a-guide-to-limits-quotas-and-best/ba-p/4076268",
            "service": "OpenAI",
            "severity": "High",
            "text": "Consider Quota management practices. Use dynamic quota for certain use cases when your application can use extra capacity opportunistically or the application itself is driving the rate at which the Azure OpenAI API is called",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "9de0d5d7-31d4-41e3-911c-817bfafbc410",
            "link": "https://github.com/Azure/aoai-apim/blob/main/README.md",
            "service": "OpenAI",
            "severity": "Medium",
            "text": "Use Load balancer solutions like APIM based gateway for balancing load and capacity across services and regions",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "9de0d5d7-31d4-41e3-911c-817bfafbc411",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/fine-tuning?tabs=turbo%2Cpython-new&pivots=programming-language-studio#import-training-data-from-azure-blob-store",
            "service": "OpenAI",
            "severity": "Medium",
            "text": "Follow the guidance for fine-tuning with large data files and import the data from an Azure blob store. Large files, 100 MB or larger, can become unstable when uploaded through multipart forms because the requests are atomic and can't be retried or resumed",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "9de0d5d7-31d4-41e3-911c-817bfafbc412",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/quota?tabs=rest",
            "service": "OpenAI",
            "severity": "Medium",
            "text": "Manage rate limits for your model deployments and monitor usage of tokens per minute (TPM) and requests per minute (RPM) for pay-as-you-go deployments",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "9de0d5d7-31d4-41e3-911c-817bfafbc413",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/monitor-openai",
            "service": "OpenAI",
            "severity": "Medium",
            "text": "Monitor provision-managed utilization if you're using the provisioned throughput payment model",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "9de0d5d7-31d4-41e3-911c-817bfafbc414",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/content-filters",
            "service": "OpenAI",
            "severity": "Medium",
            "text": "Tune content filters to minimize false positives from overly aggressive filters",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "9de0d5d7-31d4-41e3-911c-817bfafbc415",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/encrypt-data-at-rest",
            "service": "OpenAI",
            "severity": "Medium",
            "text": "Use customer-managed keys for fine-tuned models and training data that's uploaded to Azure OpenAI",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "9de0d5d7-31d4-41e3-911c-817bfafbc416",
            "link": "https://learn.microsoft.com/azure/ai-services/content-safety/concepts/jailbreak-detection",
            "service": "OpenAI",
            "severity": "Medium",
            "text": "Implement jailbreak risk detection to safeguard your language model deployments against prompt injection attacks",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "9de0d5d7-31d4-41e3-911c-817bfafbc417",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/monitor-openai",
            "service": "OpenAI",
            "severity": "Medium",
            "text": "Use security controls like throttling, service isolation and gateway pattern to prevent attacks that might exhaust model usage quotas",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "72d41e36-11cc-457b-9a4b-1410d43958a9",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/manage-costs",
            "service": "OpenAI",
            "severity": "Medium",
            "text": "Develop your cost model, considering prompt sizes. Understanding prompt input and response sizes and how text translates into tokens helps you create a viable cost model",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "72d41e36-11cc-457b-9a4b-1410d43958a1",
            "link": "https://azure.microsoft.com/pricing/details/cognitive-services/openai-service/",
            "service": "OpenAI",
            "severity": "Medium",
            "text": "Consider model pricing and capabilities when you choose models. Start with less-costly models for less-complex tasks like text generation or completion tasks and for complex tasks like language translation or content understanding, consider using more advanced models. Optimize costs while still achieving the desired application performance",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "72d41e36-11cc-457b-9a4b-1410d43958a2",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/manage-costs",
            "service": "OpenAI",
            "severity": "Medium",
            "text": "Maximize Azure OpenAI price breakpoints like fine-tuning and model breakpoints like image generation to your advantage. Fine-tuning is charged per hour, use as much time as you have available per hour to improve results without slipping into the next billing period. The cost for generating 100 images is the same as the cost for 1 image",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "72d41e36-11cc-457b-9a4b-1410d43958a3",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/manage-costs",
            "service": "OpenAI",
            "severity": "Medium",
            "text": "Remove unused fine-tuned models when they're no longer being consumed to avoid incurring an ongoing hosting fee",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "7f42c78e-78cb-46a2-8ad1-90916e6a8d8g",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/manage-costs",
            "service": "OpenAI",
            "severity": "Medium",
            "text": "Create concise prompts that provide enough context for the model to generate a useful response. Also ensure that you optimize the limit of the response length.",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "b4861bc3-bc14-4aeb-9e66-e8d9a3aec219",
            "link": "https://learn.microsoft.com/azure/ai-services/create-account-bicep",
            "service": "OpenAI",
            "severity": "Medium",
            "text": "Use infrastructure as code (IaC) to deploy Azure OpenAI, model deployments, and other infrastructure required for fine-tuning models",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "Azure OpenAI Review",
            "guid": "2744293b-b628-4537-a551-19b08e8f5855",
            "link": "https://learn.microsoft.com/azure/architecture/guide/multitenant/service/openai",
            "service": "OpenAI",
            "severity": "Medium",
            "text": "Consider using dedicated model deployments per consumer group to provide per-model usage isolation that can help prevent noisy neighbors between your consumer groups",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "Azure API Management Review",
            "guid": "d7941d4a-7b6f-458f-8714-2f8f8c059ad4",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-error-handling-policies",
            "service": "APIM",
            "severity": "Medium",
            "text": "Implement an error handling policy at the global level",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "Azure API Management Review",
            "guid": "0b0c0765-ff37-4369-90bd-3eb23ce71b08",
            "link": "https://learn.microsoft.com/azure/api-management/set-edit-policies?tabs=form#use-base-element-to-set-policy-evaluation-order",
            "service": "APIM",
            "severity": "Medium",
            "text": "Ensure all APIs policies include a <base/> element.",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "Azure API Management Review",
            "guid": "a5c45b03-93b6-42fe-b16b-8fccb6a79902",
            "link": "https://learn.microsoft.com/azure/api-management/policy-fragments",
            "service": "APIM",
            "severity": "Medium",
            "text": "Use Policy Fragments to avoid repeating same policies definitions across multiple APIs",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "Azure API Management Review",
            "guid": "c3818a95-6ff3-4474-88dc-e809b46dad6a",
            "link": "https://learn.microsoft.com/azure/api-management/monetization-support",
            "service": "APIM",
            "severity": "Medium",
            "text": "If you are planning to monetize your APIs, review the 'monetization support' article for best practices",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "Azure API Management Review",
            "guid": "a7d0840a-c8c4-4e83-adec-5ca578eb4049",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-use-azure-monitor#resource-logs",
            "service": "APIM",
            "severity": "High",
            "text": "Enable Diagnostics Settings to export logs to Azure Monitor",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "Azure API Management Review",
            "guid": "8691fa38-45ed-4299-a247-fecd98d35deb",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-app-insights",
            "service": "APIM",
            "severity": "Medium",
            "text": "Enable Application Insights for more detailed telemetry",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "Azure API Management Review",
            "guid": "55fd27bb-76ac-4a91-bc37-049e885be6b7",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-use-azure-monitor",
            "service": "APIM",
            "severity": "High",
            "text": "Configure alerts on the most critical metrics",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "Azure API Management Review",
            "guid": "39460bdb-156f-4dc2-a87f-1e8c11ab0998",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/api-management-security-baseline?toc=%2Fazure%2Fapi-management%2F&bc=%2Fazure%2Fapi-management%2Fbreadcrumb%2Ftoc.json#certificate-management-in-azure-key-vault",
            "service": "APIM",
            "severity": "High",
            "text": "Ensure that custom SSL certificates are stored an Azure Key Vault so they can be securely accessed and updated",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "Azure API Management Review",
            "guid": "e9217997-5f6c-479d-8576-8f2adf706ec8",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/api-management-security-baseline?toc=%2Fazure%2Fapi-management%2F&bc=%2Fazure%2Fapi-management%2Fbreadcrumb%2Ftoc.json#azure-ad-authentication-required-for-data-plane-access",
            "service": "APIM",
            "severity": "High",
            "text": "Protect incoming requests to APIs (data plane) with Azure AD",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "Azure API Management Review",
            "guid": "5e5f64ba-c90e-480e-8888-398d96cf0bfb",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-aad",
            "service": "APIM",
            "severity": "Medium",
            "text": "Use Microsoft Entra ID to authenticate users in the Developer Portal",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "Azure API Management Review",
            "guid": "f8e574ce-280f-49c8-b2ef-68279b081cf3",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-create-groups",
            "service": "APIM",
            "severity": "Medium",
            "text": "Create appropriate groups to control the visibility of the products",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "Azure API Management Review",
            "guid": "06862505-2d9a-4874-9491-2837b00a3475",
            "link": "https://learn.microsoft.com/azure/api-management/backends",
            "service": "APIM",
            "severity": "Medium",
            "text": "Use Backends feature to eliminate redundant API backend configurations",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "Azure API Management Review",
            "guid": "03b125d5-b69b-4739-b7fd-84b86da4933e",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-properties?tabs=azure-portal",
            "service": "APIM",
            "severity": "Medium",
            "text": "Use Named Values to store common values that can be used in policies",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "Azure API Management Review",
            "guid": "beae759e-4ddb-4326-bf26-47f87d3454b6",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-deploy-multi-region",
            "service": "APIM",
            "severity": "Medium",
            "text": "For DR, leverage the premium tier with deployments scaled across two or more regions for 99.99% SLA",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "Azure API Management Review",
            "guid": "9c8d1664-dd9a-49d4-bd83-950af0af4044",
            "link": "https://learn.microsoft.com/azure/api-management/high-availability",
            "service": "APIM",
            "severity": "Medium",
            "text": "Deploy at least one unit in two or more availability zones for an increased SLA of 99.99%",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "Azure API Management Review",
            "guid": "8d2db6e8-85c6-4118-a52c-ae76a4f27934",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/api-management-security-baseline?toc=%2Fazure%2Fapi-management%2F&bc=%2Fazure%2Fapi-management%2Fbreadcrumb%2Ftoc.json#service-native-backup-capability",
            "service": "APIM",
            "severity": "High",
            "text": "Ensure there is an automated backup routine",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "Azure API Management Review",
            "guid": "43e60b94-7bca-43a2-aadf-efb04d63a485",
            "link": "https://learn.microsoft.com/azure/api-management/retry-policy",
            "service": "APIM",
            "severity": "Medium",
            "text": "Use Policies to add a fail-over backend URL and caching to reduce failing calls.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "Azure API Management Review",
            "guid": "8210699f-8d43-45c2-8f19-57e54134bd8f",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-log-event-hubs",
            "service": "APIM",
            "severity": "Low",
            "text": "If you need to log at high performance levels, consider Event Hubs policy",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "Azure API Management Review",
            "guid": "121bfc39-fa7b-4096-b93b-ab56c1bc0bed",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-sample-flexible-throttling",
            "service": "APIM",
            "severity": "Medium",
            "text": "Apply throttling policies to control the number of requests per second",
            "training": "https://learn.microsoft.com/training/modules/protect-apis-on-api-management/",
            "waf": "Performance"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "Azure API Management Review",
            "guid": "bb5f356b-3daf-47a2-a9ee-867a8100bbd5",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-autoscale",
            "service": "APIM",
            "severity": "Medium",
            "text": "Configure autoscaling to scale out the number of instances when the load increases",
            "waf": "Performance"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "Azure API Management Review",
            "guid": "84b94abb-59b6-4b9d-8587-3413669468e8",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-provision-self-hosted-gateway",
            "service": "APIM",
            "severity": "Medium",
            "text": "Deploy self-hosted gateways where Azure doesn't have a region close to the backend APIs.",
            "waf": "Performance"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "Azure API Management Review",
            "guid": "1fe8db45-a017-4888-8c4d-4422583cfae0",
            "link": "https://learn.microsoft.com/azure/api-management/upgrade-and-scale#upgrade-and-scale",
            "service": "APIM",
            "severity": "Medium",
            "text": "Use the premium tier for production workloads.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "Azure API Management Review",
            "guid": "1b8d68a4-66cd-44d5-ba94-3ee94440e8d6",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-deploy-multi-region#-route-api-calls-to-regional-backend-services",
            "service": "APIM",
            "severity": "Medium",
            "text": "In multi-region model, use Policies to route the requests to regional backends based on availability or latency.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "Azure API Management Review",
            "guid": "46f07d33-ef9a-44e8-8f98-67c097c5d8cd",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits#api-management-limits",
            "service": "APIM",
            "severity": "High",
            "text": "Be aware of APIM's limits",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "Azure API Management Review",
            "guid": "10f58602-f0f9-4d77-972a-956f6e0f2600",
            "link": "https://learn.microsoft.com/en-us/azure/api-management/self-hosted-gateway-overview",
            "service": "APIM",
            "severity": "High",
            "text": "Ensure that the self-hosted gateway deployments are resilient.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "Azure API Management Review",
            "guid": "7519e385-a88b-4d34-966b-6269d686e890",
            "link": "https://learn.microsoft.com/azure/api-management/front-door-api-management",
            "service": "APIM",
            "severity": "Medium",
            "text": "Use Azure Front Door in front of APIM for multi-region deployment",
            "waf": "Performance"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "Azure API Management Review",
            "guid": "cd45c90e-7690-4753-930b-bf290c69c074",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/api-management-security-baseline?toc=%2Fazure%2Fapi-management%2F&bc=%2Fazure%2Fapi-management%2Fbreadcrumb%2Ftoc.json#virtual-network-integration",
            "service": "APIM",
            "severity": "Medium",
            "text": "Deploy the service within a Virtual Network (VNet)",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "Azure API Management Review",
            "guid": "02661582-b3d1-48d1-9d7b-c6a918a0ca33",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/api-management-security-baseline?toc=%2Fazure%2Fapi-management%2F&bc=%2Fazure%2Fapi-management%2Fbreadcrumb%2Ftoc.json#network-security-group-support",
            "service": "APIM",
            "severity": "Medium",
            "text": "Deploy network security groups (NSG) to your subnets to restrict or monitor traffic to/from APIM.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "Azure API Management Review",
            "guid": "67437a28-2721-4a2c-becd-caa54c8237a5",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/api-management-security-baseline?toc=%2Fazure%2Fapi-management%2F&bc=%2Fazure%2Fapi-management%2Fbreadcrumb%2Ftoc.json#azure-private-link",
            "service": "APIM",
            "severity": "Medium",
            "text": "Deploy Private Endpoints to filter incoming traffic when APIM is not deployed to a VNet.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "Azure API Management Review",
            "guid": "d698adbd-3288-44cb-b10a-9b572da395ae",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/api-management-security-baseline?toc=%2Fazure%2Fapi-management%2F&bc=%2Fazure%2Fapi-management%2Fbreadcrumb%2Ftoc.json#disable-public-network-access",
            "service": "APIM",
            "severity": "High",
            "text": "Disable Public Network Access",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "Azure API Management Review",
            "guid": "0674d750-0c6f-4ac0-8717-ceec04d0bdbd",
            "link": "https://learn.microsoft.com/azure/api-management/automation-manage-api-management",
            "service": "APIM",
            "severity": "Medium",
            "text": "Simplify management with PowerShell automation scripts",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "Azure API Management Review",
            "guid": "c385bfcd-49fd-4786-81ba-cedbb4c57345",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/app-platform/api-management/platform-automation-and-devops#design-recommendations",
            "service": "APIM",
            "severity": "Medium",
            "text": "Configure APIM via Infrastructure-as-code. Review DevOps best practices from the Cloud Adaption Framework APIM Landing Zone Accelerator",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "Azure API Management Review",
            "guid": "6c3a27c0-197f-426c-9ffa-86fed51d9ab6",
            "link": "https://learn.microsoft.com/azure/api-management/visual-studio-code-tutorial",
            "service": "APIM",
            "severity": "Medium",
            "text": "Promote usage of Visual Studio Code APIM extension for faster API development",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "Azure API Management Review",
            "guid": "354f1c03-8112-4965-85ad-c0074bddf231",
            "link": "https://learn.microsoft.com/azure/api-management/devops-api-development-templates",
            "service": "APIM",
            "severity": "Medium",
            "text": "Implement DevOps and CI/CD in your workflow",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "Azure API Management Review",
            "guid": "b6439493-426a-45f3-9697-cf65baee208d",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-mutual-certificates-for-clients",
            "service": "APIM",
            "severity": "Medium",
            "text": "Secure APIs using client certificate authentication",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "Azure API Management Review",
            "guid": "2a67d143-1033-4c0a-8732-680896478f08",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-mutual-certificates",
            "service": "APIM",
            "severity": "Medium",
            "text": "Secure backend services using client certificate authentication",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "Azure API Management Review",
            "guid": "074435f5-4a46-41ac-b521-d6114cb5d845",
            "link": "https://learn.microsoft.com/azure/api-management/mitigate-owasp-api-threats",
            "service": "APIM",
            "severity": "Medium",
            "text": "Review 'Recommendations to mitigate OWASP API Security Top 10 threats' article and check what is applicable to your APIs",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "Azure API Management Review",
            "guid": "5507c4b8-a7f8-41d6-9661-418c987100c9",
            "link": "https://learn.microsoft.com/azure/api-management/authorizations-overview",
            "service": "APIM",
            "severity": "Medium",
            "text": "Use Authorizations feature to simplify management of OAuth 2.0 token for your backend APIs",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "Azure API Management Review",
            "guid": "2deee033-b906-4bc2-9f26-c8d3699fe091",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-manage-protocols-ciphers",
            "service": "APIM",
            "severity": "High",
            "text": "Use the latest TLS version when encrypting information in transit. Disable outdated and unnecessary protocols and ciphers when possible.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "Azure API Management Review",
            "guid": "f8af3d94-1d2b-4070-846f-849197524258",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/api-management-security-baseline?toc=%2Fazure%2Fapi-management%2F&bc=%2Fazure%2Fapi-management%2Fbreadcrumb%2Ftoc.json#im-8-restrict-the-exposure-of-credential-and-secrets",
            "service": "APIM",
            "severity": "High",
            "text": "Ensure that secrets (Named values) are stored an Azure Key Vault so they can be securely accessed and updated",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "Azure API Management Review",
            "guid": "791abd8b-7706-4e31-9569-afefde724be3",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/api-management-security-baseline?toc=%2Fazure%2Fapi-management%2F&bc=%2Fazure%2Fapi-management%2Fbreadcrumb%2Ftoc.json#managed-identities",
            "service": "APIM",
            "severity": "Medium",
            "text": "Use managed identities to authenticate to other Azure resources whenever possible",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "Azure API Management Review",
            "guid": "220c4ca6-6688-476b-b2b5-425a78e6fb87",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/api-management-security-baseline?toc=%2Fazure%2Fapi-management%2F&bc=%2Fazure%2Fapi-management%2Fbreadcrumb%2Ftoc.json#ns-6-deploy-web-application-firewall",
            "service": "APIM",
            "severity": "High",
            "text": "Use web application firewall (WAF) by deploying Application Gateway in front of APIM",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "Azure Application Delivery Networking",
            "graph": "cdnresources | where type =~ 'microsoft.Cdn/profiles/secrets' | extend frontDoorId = substring(id, 0, indexof(id, '/secrets')) | where properties.parameters.type =~ 'CustomerCertificate' | extend compliant = properties.parameters.useLatestVersion == true | project compliant, id=frontDoorId, certificateName = name | distinct id, certificateName, compliant",
            "guid": "f00a69de-7076-4734-a734-6e4552cad9e1",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-latest-version-for-customer-managed-certificates",
            "service": "Front Door",
            "severity": "Medium",
            "text": "If you use customer-managed TLS certificates with Azure Front Door, use the 'Latest' certificate version. Reduce the risk of outages caused by manual certificate renewal.",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "Azure Application Delivery Networking",
            "graph": "resources | where type =~ 'microsoft.cdn/profiles' and sku has 'AzureFrontDoor' | project name, cdnprofileid=tolower(id), tostring(tags), resourceGroup, subscriptionId,skuname=tostring(sku.name) | join kind= fullouter ( cdnresources | where type == 'microsoft.cdn/profiles/securitypolicies' | extend wafpolicyid=tostring(properties['parameters']['wafPolicy']['id']) | extend splitid=split(id, '/') | extend cdnprofileid=tolower(strcat_array(array_slice(splitid, 0, 8), '/')) | project secpolname=name, cdnprofileid, wafpolicyid ) on cdnprofileid | project name, cdnprofileid, secpolname, wafpolicyid,skuname | join kind = fullouter ( resources | where type == 'microsoft.network/frontdoorwebapplicationfirewallpolicies' | extend managedrulesenabled=iff(tostring(properties.managedRules.managedRuleSets) != '[]', true, false), enabledState = tostring(properties.policySettings.enabledState) | project afdwafname=name, managedrulesenabled, wafpolicyid=id, enabledState, tostring(tags) ) on wafpolicyid | where name != '' | summarize associatedsecuritypolicies=countif(secpolname != ''), wafswithmanagedrules=countif(managedrulesenabled == 1) by name, id=cdnprofileid, tags,skuname | extend compliant = (associatedsecuritypolicies > 0 and wafswithmanagedrules > 0) | project id, compliant",
            "guid": "e79d17b7-3b22-4a5a-97e7-a8ed4b30e38c",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "service": "Front Door",
            "severity": "Medium",
            "text": "Use Azure Front Door with WAF policies to deliver and help protect global HTTP/S apps that span multiple Azure regions.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "Azure Application Delivery Networking",
            "guid": "3f29812b-2363-4cef-b179-b599de0d5973",
            "link": "https://learn.microsoft.com/azure/frontdoor/origin-security?tabs=application-gateway&pivots=front-door-standard-premium#example-configuration",
            "service": "Front Door",
            "severity": "Medium",
            "text": "When using Front Door and Application Gateway to help protect HTTP/S apps, use WAF policies in Front Door. Lock down Application Gateway to receive traffic only from Front Door.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "Azure Application Delivery Networking",
            "graph": "resources | where type == 'microsoft.network/frontdoorwebapplicationfirewallpolicies' | project policyName=name, policyId=id,policySku=sku.name, links=properties.securityPolicyLinks, enabledState=properties.policySettings.enabledState, mode=properties.policySettings.mode | mvexpand links | extend securityPolicy=links.id | extend securityPolicyParts=split(securityPolicy, '/') | extend profileId=strcat_array(array_slice(securityPolicyParts, 0, -3), '/') | project id=profileId, compliant=((enabledState=='Enabled') and (mode=='Prevention')), enabledState, mode",
            "guid": "ae248989-b306-4591-9186-de482e3f0f0e",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-policy-settings",
            "service": "Front Door",
            "severity": "High",
            "text": "Deploy your WAF policy for Front Door in 'Prevention' mode' so that Web Application Firewall takes appropriate action to allow or deny traffic.",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "Azure Application Delivery Networking",
            "graph": "cdnresources | where type =~ 'microsoft.cdn/profiles/origingroups/origins' | extend frontDoorId = substring(id, 0, indexof(id, '/origingroups')) | extend compliant = properties['hostName'] !endswith '.trafficmanager.net' | project compliant, id=frontDoorId",
            "guid": "062d5839-4d36-402f-bfa4-02811eb936e9",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#avoid-combining-traffic-manager-and-front-door",
            "service": "Front Door",
            "severity": "High",
            "text": "Avoid placing Traffic Manager behind Front Door.",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "Azure Application Delivery Networking",
            "graph": "cdnresources | where type =~ 'microsoft.cdn/profiles/origingroups/origins' | extend frontDoorId = substring(id, 0, indexof(id, '/origins')) | extend compliant = isempty(properties.originHostHeader) or (tostring(properties.hostName) =~ tostring(properties.originHostHeader)) | project id=frontDoorId, originName = name, compliant",
            "guid": "5efeb96a-003f-4b18-8fcd-b4d84459c2b2",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-the-same-domain-name-on-front-door-and-your-origin",
            "service": "Front Door",
            "severity": "High",
            "text": "Use the same domain name on Azure Front Door and your origin. Mismatched host names can cause subtle bugs.",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "Azure Application Delivery Networking",
            "graph": "cdnresources | where type =~ 'microsoft.cdn/profiles/origingroups/origins' | extend frontDoorId = substring(id, 0, indexof(id, '/origingroups')) | extend originGroupId = substring(id, 0, indexof(id, '/origins')) | join kind=inner (cdnresources | where type =~ 'microsoft.cdn/profiles/origingroups' | extend originGroupName = name | extend hasHealthProbe = isnotnull(properties.healthProbeSettings)) on $left.originGroupId == $right.id | summarize numberOrigins = count() by originGroupId, subscriptionId, frontDoorId, hasHealthProbe, originGroupName | extend compliant = not(numberOrigins == 1 and hasHealthProbe) | project id = frontDoorId, compliant",
            "guid": "0b5a380c-4bfb-47bc-b1d7-dcfef363a61b",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#disable-health-probes-when-theres-only-one-origin-in-an-origin-group",
            "service": "Front Door",
            "severity": "Low",
            "text": "Disable health probes when there is only one origin in an Azure Front Door origin group.",
            "waf": "Performance"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "Azure Application Delivery Networking",
            "guid": "5567048e-e5d7-4206-9c55-b5ed45d2cc0c",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#select-good-health-probe-endpoints",
            "service": "Front Door",
            "severity": "Medium",
            "text": "Select good health probe endpoints for Azure Front Door. Consider building health endpoints that check all of your application's dependencies.",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "Azure Application Delivery Networking",
            "graph": "cdnresources | where type =~ 'microsoft.cdn/profiles/origingroups' | extend frontDoorId = substring(id, 0, indexof(id, '/origingroups/')) | extend compliant = (isnull(properties['healthProbeSettings']['probeRequestType']) or toupper(properties['healthProbeSettings']['probeRequestType']) == 'HEAD') | project compliant, id=frontDoorId",
            "guid": "a13f72f3-8f5c-4864-95e5-75bf37fbbeb1",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-head-health-probes",
            "service": "Front Door",
            "severity": "Low",
            "text": "Use HEAD health probes with Azure Front Door, to reduce the traffic that Front Door sends to your application.",
            "waf": "Performance"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "Azure Application Delivery Networking",
            "graph": "cdnresources | where type =~ 'microsoft.cdn/profiles/customdomains' | extend frontDoorId = substring(id, 0, indexof(id, '/customdomains')) | extend compliant = (isnull(properties['tlsSettings']['certificateType']) or tolower(properties['tlsSettings']['certificateType']) =~ 'customercertificate') | project compliant, id = frontDoorId",
            "guid": "af95c92d-d723-4f4a-98d7-8722324efd4d",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-managed-tls-certificates",
            "service": "Front Door",
            "severity": "High",
            "text": "Use managed TLS certificates with Azure Front Door. Reduce operational cost and risk of outages due to certificate renewals.",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "Azure Application Delivery Networking",
            "guid": "189ea962-3969-4863-8f5a-5ad808c2cf4b",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#define-your-waf-configuration-as-code",
            "service": "Front Door",
            "severity": "Medium",
            "text": "Define your Azure Front Door WAF configuration as code. By using code, you can more easily adopt new rule set version and gain additional protection.",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "Azure Application Delivery Networking",
            "graph": "cdnresources | where type == 'microsoft.cdn/profiles/afdendpoints/routes' | extend frontDoorId = substring(id, 0, indexof(id, '/afdendpoints')) | extend forwardingProtocol=tostring(properties.forwardingProtocol),supportedProtocols=properties.supportedProtocols,httpsRedirect=properties.httpsRedirect | extend compliant = forwardingProtocol =~ 'httpsonly' and (supportedProtocols has 'https' or httpsRedirect =~ 'enabled') | project id = frontDoorId, compliant",
            "guid": "2e30abab-5478-417c-81bf-bf1ad4ed1ed4",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-end-to-end-tls",
            "service": "Front Door",
            "severity": "High",
            "text": "Use end-to-end TLS with Azure Front Door. Use TLS for connections from your clients to Front Door, and from Front Door to your origin.",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "Azure Application Delivery Networking",
            "graph": "cdnresources | where type == 'microsoft.cdn/profiles/afdendpoints/routes' | extend frontDoorId = substring(id, 0, indexof(id, '/afdendpoints')) | extend forwardingProtocol=tostring(properties.forwardingProtocol),supportedProtocols=properties.supportedProtocols,httpsRedirect=properties.httpsRedirect | extend compliant = httpsRedirect =~ 'enabled' | project id = frontDoorId, compliant",
            "guid": "10aa45af-166f-44c4-9f36-b6d592dac2ca",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-http-to-https-redirection",
            "service": "Front Door",
            "severity": "Medium",
            "text": "Use HTTP to HTTPS redirection with Azure Front Door. Support older clients by redirecting them to an HTTPS request automatically.",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "Azure Application Delivery Networking",
            "guid": "28b9ee82-b2c7-45aa-bc98-6de6f59a095d",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#enable-the-waf",
            "service": "Front Door",
            "severity": "High",
            "text": "Enable the Azure Front Door WAF. Protect your application from a range of attacks.",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "Azure Application Delivery Networking",
            "guid": "2902d8cc-1b0c-4495-afad-624ab70f7bd6",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#tune-your-waf",
            "service": "Front Door",
            "severity": "High",
            "text": "Tune the Azure Front Door WAF for your workload by configuring the WAF in Detection mode to reduce and fix false positive detections.",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "Azure Application Delivery Networking",
            "guid": "17ba124b-127d-42b6-9322-388d5b2bbcfc",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/application-gateway-waf-request-size-limits#request-body-inspection",
            "service": "Front Door",
            "severity": "High",
            "text": "Enable request body inspection feature enabled in Azure Front Door WAF policy.",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "Azure Application Delivery Networking",
            "guid": "49a98f2b-ec22-4a87-9415-6a10b00d6555",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#enable-default-rule-sets",
            "service": "Front Door",
            "severity": "High",
            "text": "Enable the Azure Front Door WAF default rule sets. The default rule sets detect and block common attacks.",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "Azure Application Delivery Networking",
            "guid": "147a13d4-2a2f-4824-a524-f5855b52b946",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#enable-bot-management-rules",
            "service": "Front Door",
            "severity": "High",
            "text": "Enable the Azure Front Door WAF bot protection rule set. The bot rules detect good and bad bots.",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "Azure Application Delivery Networking",
            "guid": "d7dcdcb9-0d99-44b9-baab-ac7570ede79a",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#use-the-latest-ruleset-versions",
            "service": "Front Door",
            "severity": "Medium",
            "text": "Use the latest Azure Front Door WAF rule set version. Rule set updates are regularly updated to take account of the current threat landscape.",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "Azure Application Delivery Networking",
            "guid": "b9620385-1cde-418f-914b-a84a06982ffc",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#add-rate-limiting",
            "service": "Front Door",
            "severity": "Medium",
            "text": "Add rate limiting to the Azure Front Door WAF. Rate limiting blocks clients accidentally or intentionally sending large amounts of traffic in a short period of time.",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "Azure Application Delivery Networking",
            "guid": "6dc36c52-0124-4ffe-9eaf-23ec1282dedb",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#use-a-high-threshold-for-rate-limits",
            "service": "Front Door",
            "severity": "Medium",
            "text": "Use a high threshold for Azure Front Door WAF rate limits. High rate limit thresholds avoid blocking legitimate traffic, while still providing protection against extremely high numbers of requests that might overwhelm your infrastructure.",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "Azure Application Delivery Networking",
            "guid": "388a3d0e-0a43-4367-90b2-3dd2aeece5ee",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#geo-filter-traffic",
            "service": "Front Door",
            "severity": "Low",
            "text": "If you are not expecting traffic from all geographical regions, use geo-filters to block traffic from non-expected countries.",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "Azure Application Delivery Networking",
            "guid": "00acd8a9-6975-414f-8491-2be6309893b8",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#specify-the-unknown-zz-location",
            "service": "Front Door",
            "severity": "Medium",
            "text": "Specify the unknown (ZZ) location when geo-filtering traffic with the Azure Front Door WAF. Avoid accidentally blocking legitimate requests when IP addresses can't be geo-matched.",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "Azure Application Delivery Networking",
            "guid": "4cea4050-7946-4a7c-89e6-b021b73c352d",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#add-diagnostic-settings-to-save-your-wafs-logs",
            "service": "Front Door",
            "severity": "Medium",
            "text": "Capture logs and metrics by turning on Diagnostic Settings. Include resource activity logs, access logs, health probe logs, and WAF logs. Set up alerts.",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "Azure Application Delivery Networking",
            "guid": "845f5f91-9c21-4674-a725-5ce890850e20",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#send-logs-to-microsoft-sentinel",
            "service": "Front Door",
            "severity": "Medium",
            "text": "Send Azure Front Door WAF logs to Microsoft Sentinel.",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "Azure Application Delivery Networking",
            "guid": "3bb0a854-ea3d-4212-bd8e-3f0cb7792b02",
            "link": "https://learn.microsoft.com/azure/frontdoor/routing-methods",
            "service": "Front Door",
            "severity": "Medium",
            "text": "Choose a routing method that supports your deployment strategy. The weighted method, which distributes traffic based on the configured weight coefficient, supports active-active models. A priority-based value that configures the primary region to receive all traffic and send traffic to the secondary region as a backup supports active-passive models. Combine the preceding methods with latency so that the origin with the lowest latency receives traffic.",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "Azure Application Delivery Networking",
            "graph": "cdnresources | where type =~ 'microsoft.cdn/profiles/origingroups' | extend frontDoorId = substring(id, 0, indexof(id, '/origingroups')) | extend healthprobe=tostring(properties.healthProbeSettings) | project origingroupname=name, id, tags, resourceGroup, subscriptionId, healthprobe, frontDoorId | join ( cdnresources | where type =~ 'microsoft.cdn/profiles/origingroups/Origins' | extend origingroupname = tostring(properties.originGroupName) ) on origingroupname | summarize origincount=count(), enabledhealthprobecount=countif(healthprobe != '') by origingroupname, id, tostring(tags), resourceGroup, subscriptionId, frontDoorId | extend compliant = origincount > 1 | project id = frontDoorId, compliant",
            "guid": "c3a769e4-cc78-40a9-b36a-f9bcab19ec2d",
            "link": "https://learn.microsoft.com/azure/frontdoor/quickstart-create-front-door",
            "service": "Front Door",
            "severity": "High",
            "text": "Support redundancy by having multiple origins in one or more back-end pools. Always have redundant instances of your application and make sure each instance exposes an endpoint or origin. You can place those origins in one or more back-end pools.",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "Azure Application Delivery Networking",
            "guid": "999852be-2137-4179-8fc3-30d1df6fed1d",
            "link": "https://learn.microsoft.com/azure/frontdoor/troubleshoot-issues#troubleshooting-steps",
            "service": "Front Door",
            "severity": "Medium",
            "text": "Set a timeout on forwarding requests to the back end. Adjust the timeout setting according to your endpoints' needs. If you don't, Azure Front Door might close the connection before the origin sends the response. You can also lower the default timeout for Azure Front Door if all of your origins have a shorter timeout.",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "Azure Application Delivery Networking",
            "guid": "17bf6351-3e5e-41f1-87bb-d5ad0b4e3de6",
            "link": "https://learn.microsoft.com/azure/frontdoor/routing-methods#23session-affinity",
            "service": "Front Door",
            "severity": "Medium",
            "text": "Decide if your application requires session affinity. If you have high reliability requirements, we recommend that you disable session affinity.",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "Azure Application Delivery Networking",
            "guid": "425bfb31-94c4-4007-b9ae-46da9fe57cc7",
            "link": "https://learn.microsoft.com/azure/frontdoor/origin?pivots=front-door-standard-premium#origin-host-header",
            "service": "Front Door",
            "severity": "Medium",
            "text": "Send the host header to the back end. The back-end services should be aware of the host name so that they can create rules to accept traffic only from that host.",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "Azure Application Delivery Networking",
            "guid": "81a5398a-2414-450f-9fc3-e048bc65784c",
            "link": "https://learn.microsoft.com/azure/frontdoor/front-door-caching",
            "service": "Front Door",
            "severity": "Medium",
            "text": "Use caching for endpoints that support it.",
            "waf": "Cost"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "Azure Application Delivery Networking",
            "graph": "cdnresources | where type =~ 'microsoft.cdn/profiles/origingroups' | extend frontDoorId = substring(id, 0, indexof(id, '/origingroups')) | extend healthprobe=tostring(properties.healthProbeSettings) | project origingroupname=name, id, tags, resourceGroup, subscriptionId, healthprobe, frontDoorId | join ( cdnresources | where type =~ 'microsoft.cdn/profiles/origingroups/Origins' | extend origingroupname = tostring(properties.originGroupName) ) on origingroupname | summarize origincount=count(), enabledhealthprobecount=countif(healthprobe != '') by origingroupname, id, tostring(tags), resourceGroup, subscriptionId, frontDoorId | extend compliant = origincount > 1 or (origincount == 1 and enabledhealthprobecount == 0) | project id = frontDoorId, compliant",
            "guid": "34069d73-e4de-46c5-a36f-625f87575a56",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#disable-health-probes-when-theres-only-one-origin-in-an-origin-group",
            "service": "Front Door",
            "severity": "Low",
            "text": "Disable health checks in single back-end pools. If you have only one origin configured in your Azure Front Door origin group, these calls are unnecessary. This is only recommended if you can't have multiple origins in your endpoint.",
            "waf": "Cost"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "Azure Application Delivery Networking",
            "guid": "c92d6786-cdd1-444d-9cad-934a192a276a",
            "link": "https://learn.microsoft.com/azure/frontdoor/standard-premium/how-to-reports",
            "service": "Front Door",
            "severity": "Medium",
            "text": "We recommend using the Premium Tier for leveraging the Security reports while the Standard Azure Front Door Profile provides only traffic reports under built-in analytics/reports.",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "Azure Application Delivery Networking",
            "guid": "440cf7de-30a1-4550-ab50-c9f6eac140cd",
            "link": "https://learn.microsoft.com/azure/frontdoor/front-door-wildcard-domain",
            "service": "Front Door",
            "severity": "Medium",
            "text": "Use wildcard TLS certificates when possible.",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "Azure Application Delivery Networking",
            "guid": "556e2733-6ca9-4edd-9cc7-26de66d46c2e",
            "link": "https://learn.microsoft.com/azure/frontdoor/front-door-caching",
            "service": "Front Door",
            "severity": "Medium",
            "text": "Optimize your application query string for caching. For purely static content, ignore query strings to maximize your use of the cache. If your application uses query strings, consider including them in the cache key. Including the query strings in the cache key allows Azure Front Door to serve cached responses or other responses, based on your configuration.",
            "waf": "Performance"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "Azure Application Delivery Networking",
            "guid": "c0b7e55e-fcab-4e66-bdae-bd0290f6aece",
            "link": "https://learn.microsoft.com/azure/frontdoor/standard-premium/how-to-compression",
            "service": "Front Door",
            "severity": "Medium",
            "text": "Use file compression when you're accessing downloadable content.",
            "waf": "Performance"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "Azure Application Delivery Networking",
            "graph": "resources | where type =~ 'microsoft.network/frontdoors' and properties['resourceState'] !~ 'migrated' | extend compliant = false | project id, compliant",
            "guid": "cb8eb8c0-aa73-4a26-a495-6eba8dc4a243",
            "link": "https://learn.microsoft.com/azure/cdn/tier-migration",
            "service": "Front Door",
            "severity": "High",
            "text": "Consider migrating to Standard or Premium SKU if you are using Classic Azure Front Door currently as Classic Azure Front Door will be deprecated by March 2027.",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "Azure Application Delivery Networking",
            "guid": "67c33697-15b1-4752-aeee-0b9b588defc4",
            "link": "https://learn.microsoft.com/azure/architecture/guide/networking/global-web-applications/mission-critical-content-delivery",
            "service": "Front Door",
            "severity": "Medium",
            "text": "Consider using Traffic Manager load balancing Azure Front Door and a third party CDN provider CDN profile for mission critical high availability scenario. ",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "Azure Application Delivery Networking",
            "guid": "972cd4cd-25b0-4b70-96e9-eab4bfd32907",
            "link": "https://learn.microsoft.com/azure/app-service/app-service-ip-restrictions?tabs=azurecli#restrict-access-to-a-specific-azure-front-door-instance",
            "service": "Front Door",
            "severity": "High",
            "text": "When using Front Door with origin as App services, consider locking down the traffic to app services only through Azure Front Door using access restrictions. ",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.DBforMySQL/servers",
            "checklist": "MySQL Review Checklist",
            "guid": "388c3e25-e800-4ad2-9df3-f3d6ae1050b7",
            "link": "https://learn.microsoft.com/azure/mysql/flexible-server/overview",
            "service": "Azure MySQL",
            "severity": "Medium",
            "text": "Leverage Flexible Server",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.DBforMySQL/servers",
            "checklist": "MySQL Review Checklist",
            "guid": "de3aad1e-8c38-4ec9-9666-7313c005674b",
            "link": "https://learn.microsoft.com/azure/mysql/flexible-server/overview#high-availability-within-and-across-availability-zones",
            "service": "Azure MySQL",
            "severity": "High",
            "text": "Leverage Availability Zones where regionally applicable",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.DBforMySQL/servers",
            "checklist": "MySQL Review Checklist",
            "guid": "1e944a45-9c37-43e7-bd61-623b365a917e",
            "link": "https://learn.microsoft.com/azure/mysql/flexible-server/overview#setup-hybrid-or-multi-cloud-data-synchronization-with-data-in-replication",
            "service": "Azure MySQL",
            "severity": "Medium",
            "text": "Leverage Data-in replication for cross-region DR scenarios",
            "waf": "Reliability"
        },
        {
            "aprlGuid": "bb6deb9d-24fa-4ee8-bc23-ac3ebc7fdf8e",
            "automationAvailable": "arg",
            "category": "High Availability",
            "description": "You need to use a minimum of Enterprise SKU for your managed domain to support replica sets.\n",
            "graph": "// Azure Resource Graph Query\n// Gets Entry Domain Services that are using the Standard SKU\nresources\n| where type == \"microsoft.aad/domainservices\"\n| extend sku = properties.sku\n| where sku =~ 'Standard'\n| project recommendationId='bb6deb9d-24fa-4ee8-bc23-ac3ebc7fdf8e', name=name, id=id, tags=tags, param1=strcat('SKU:', sku)\n",
            "guid": "bb6deb9d-24fa-4ee8-bc23-ac3ebc7fdf8e",
            "learnMoreLink": [
                {
                    "name": "Create and use replica sets for resiliency or geolocation in Microsoft Entra Domain Services",
                    "url": "https://learn.microsoft.com/en-us/entra/identity/domain-services/tutorial-create-replica-set"
                }
            ],
            "longDescription": "You need to use a minimum of Enterprise SKU for your managed domain to support replica sets.\n",
            "pgVerified": false,
            "potentialBenefits": "The Enterprise SKU enables creation of replica sets.",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.AAD/domainServices",
            "recommendationTypeId": null,
            "service": "Microsoft.AAD/domainServices",
            "severity": "High",
            "source": "azure-resources/AAD/domainServices/recommendations.yaml",
            "tags": null,
            "text": "Use at least the Enterprise SKU"
        },
        {
            "aprlGuid": "a3058909-fcf8-4450-88b5-499f57449178",
            "automationAvailable": "arg",
            "category": "High Availability",
            "description": "To improve the resiliency of a Microsoft Entra Domain Services managed domain, or deploy to additional geographic locations close to your applications, you can use replica sets.\nYou can add a replica set to any peered virtual network in any Azure region that supports Domain Services.\n",
            "graph": "// Azure Resource Graph Query\n// Gets Entry Domain Services that are using only one replicaSet\nresources\n| where type == \"microsoft.aad/domainservices\"\n| extend replicaSets = properties.replicaSets\n| where array_length(replicaSets) < 2\n| project recommendationId='a3058909-fcf8-4450-88b5-499f57449178', name=name, id=id, tags=tags, param1=strcat('replicaSetLocation:', replicaSets[0].location)\n",
            "guid": "a3058909-fcf8-4450-88b5-499f57449178",
            "learnMoreLink": [
                {
                    "name": "Create and use replica sets for resiliency or geolocation in Microsoft Entra Domain Services",
                    "url": "https://learn.microsoft.com/en-us/entra/identity/domain-services/tutorial-create-replica-set"
                }
            ],
            "longDescription": "To improve the resiliency of a Microsoft Entra Domain Services managed domain, or deploy to additional geographic locations close to your applications, you can use replica sets.\nYou can add a replica set to any peered virtual network in any Azure region that supports Domain Services.\n",
            "pgVerified": false,
            "potentialBenefits": "The replica sets provide geographical resiliency.",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.AAD/domainServices",
            "recommendationTypeId": null,
            "service": "Microsoft.AAD/domainServices",
            "severity": "High",
            "source": "azure-resources/AAD/domainServices/recommendations.yaml",
            "tags": null,
            "text": "Use replica sets for resiliency or geolocation in Microsoft Entra Domain Services"
        },
        {
            "aprlGuid": "74fcb9f2-9a25-49a6-8c42-d32851c4afb7",
            "automationAvailable": "arg",
            "category": "Monitoring and Alerting",
            "description": "Ensure Azure Service Health notifications are set for Azure VMware Solution across all used regions and subscriptions. This communicates service/security issues and maintenance activities like host replacements and upgrades, reducing service request submissions.\n",
            "graph": "// Azure Resource Graph Query\n// Provides a list of Azure VMware Solution resources that don't have one or more service health alerts covering AVS private clouds in the deployed subscription and region pairs.\n//full list of private clouds\n(resources\n| where ['type'] == \"microsoft.avs/privateclouds\"\n| extend locale = tolower(location)\n| extend subscriptionId = tolower(subscriptionId)\n| project id, name, tags, subscriptionId, locale)\n| join kind=leftouter\n//Alert ID's that include all incident types filtered by AVS Service Health alerts\n((resources\n| where type == \"microsoft.insights/activitylogalerts\"\n| extend alertproperties = todynamic(properties)\n| where alertproperties.condition.allOf[0].field == \"category\" and alertproperties.condition.allOf[0].equals == \"ServiceHealth\"\n| where alertproperties.condition.allOf[1].field == \"properties.impactedServices[*].ServiceName\" and set_has_element(alertproperties.condition.allOf[1].containsAny, \"Azure VMware Solution\")\n| extend locale = strcat_array(split(tolower(alertproperties.condition.allOf[2].containsAny),' '), '')\n| mv-expand todynamic(locale)\n| where locale != \"global\"\n| project subscriptionId, tostring(locale) )\n| union\n//Alert ID's that include only some of the incident types after filtering by service health alerts covering AVS private clouds.\n(resources\n| where type == \"microsoft.insights/activitylogalerts\"\n| extend subscriptionId = tolower(subscriptionId)\n| extend alertproperties = todynamic(properties)\n| where alertproperties.condition.allOf[0].field == \"category\" and alertproperties.condition.allOf[0].equals == \"ServiceHealth\"\n| where alertproperties.condition.allOf[2].field == \"properties.impactedServices[*].ServiceName\" and set_has_element(alertproperties.condition.allOf[2].containsAny, \"Azure VMware Solution\")\n| extend locale = strcat_array(split(tolower(alertproperties.condition.allOf[3].containsAny),' '), '')\n| mv-expand todynamic(locale)\n| mv-expand alertproperties.condition.allOf[1].anyOf\n| extend incidentType = alertproperties_condition_allOf_1_anyOf.equals\n| where locale != \"global\"\n| project id, subscriptionId, locale, incidentType\n| distinct subscriptionId, tostring(locale), tostring(incidentType)\n| summarize incidentTypes=count() by subscriptionId, locale\n| where incidentTypes == 5 //only include this subscription, region pair if it includes all the incident types.\n| project subscriptionId, locale)) on subscriptionId, locale\n| where subscriptionId1 == \"\" or locale1 == \"\" or isnull(subscriptionId1) or isnull(locale1)\n| project recommendationId = \"74fcb9f2-9a25-49a6-8c42-d32851c4afb7\", name, id, tags, param1 = \"avsServiceHealthAlertsAllIncidentTypesConfigured: False\"\n\n",
            "guid": "74fcb9f2-9a25-49a6-8c42-d32851c4afb7",
            "learnMoreLink": [
                {
                    "name": "Learn More",
                    "url": "https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/scenarios/azure-vmware/eslz-management-and-monitoring#design-recommendations"
                }
            ],
            "longDescription": "Ensure Azure Service Health notifications are set for Azure VMware Solution across all used regions and subscriptions. This communicates service/security issues and maintenance activities like host replacements and upgrades, reducing service request submissions.\n",
            "pgVerified": true,
            "potentialBenefits": "Prompt mitigation of issues.",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Monitoring and Alerting",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.AVS/privateClouds",
            "recommendationTypeId": null,
            "service": "AVS",
            "severity": "High",
            "source": "azure-resources/AVS/privateClouds/recommendations.yaml",
            "tags": null,
            "text": "Configure Azure Service Health notifications and alerts for Azure VMware Solution"
        },
        {
            "aprlGuid": "29d7a115-dfb6-4df1-9205-04824109548f",
            "automationAvailable": false,
            "category": "Monitoring and Alerting",
            "description": "Set an alert for when the node count in Azure VMware Solution Private Cloud hits or exceeds 90 hosts, enabling timely planning for a new private cloud.\n",
            "graph": "// cannot-be-validated-with-arg\n",
            "guid": "29d7a115-dfb6-4df1-9205-04824109548f",
            "learnMoreLink": [
                {
                    "name": "Configure and streamline alerts",
                    "url": "https://learn.microsoft.com/en-us/azure/well-architected/azure-vmware/monitoring#configure-and-streamline-alerts"
                }
            ],
            "longDescription": "Set an alert for when the node count in Azure VMware Solution Private Cloud hits or exceeds 90 hosts, enabling timely planning for a new private cloud.\n",
            "pgVerified": true,
            "potentialBenefits": "Proactive capacity planning",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Monitoring and Alerting",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.AVS/privateClouds",
            "recommendationTypeId": null,
            "service": "AVS",
            "severity": "Medium",
            "source": "azure-resources/AVS/privateClouds/recommendations.yaml",
            "tags": null,
            "text": "Monitor when Azure VMware Solution Private Cloud is reaching the capacity limit"
        },
        {
            "aprlGuid": "f86355e3-de7c-4dad-8080-1b0b411e66c8",
            "automationAvailable": false,
            "category": "Monitoring and Alerting",
            "description": "Alert when the cluster size reaches 14 hosts. Set up periodic alerts for planning new clusters or datastores due to growth, especially from storage needs. Beyond 14 hosts, trigger alerts for each new host addition for proactive resource monitoring.\n",
            "graph": "// cannot-be-validated-with-arg\n",
            "guid": "f86355e3-de7c-4dad-8080-1b0b411e66c8",
            "learnMoreLink": [
                {
                    "name": "Learn More",
                    "url": "https://learn.microsoft.com/en-us/azure/well-architected/azure-vmware/monitoring#configure-and-streamline-alerts"
                }
            ],
            "longDescription": "Alert when the cluster size reaches 14 hosts. Set up periodic alerts for planning new clusters or datastores due to growth, especially from storage needs. Beyond 14 hosts, trigger alerts for each new host addition for proactive resource monitoring.\n",
            "pgVerified": true,
            "potentialBenefits": "Proactive resource management",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Monitoring and Alerting",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.AVS/privateClouds",
            "recommendationTypeId": null,
            "service": "AVS",
            "severity": "Medium",
            "source": "azure-resources/AVS/privateClouds/recommendations.yaml",
            "tags": null,
            "text": "Monitor when Azure VMware Solution Cluster Size is approaching the host limit"
        },
        {
            "aprlGuid": "9ec5b4c8-3dd8-473a-86ee-3273290331b9",
            "automationAvailable": "arg",
            "category": "High Availability",
            "description": "For Azure VMware Solution, enabling Stretched Clusters offers 99.99% SLA, synchronous storage replication (RPO=0), and spreads vSAN datastore across two AZs. Must be done at initial setup, needing double quota due to extension across AZs.\n",
            "graph": "// Azure Resource Graph Query\n// Provides a list of Azure VMware Solution resources that aren't configured as stretched clusters and in supported regions.\nresources\n| where ['type'] == \"microsoft.avs/privateclouds\"\n| extend avsproperties = todynamic(properties)\n| where avsproperties.availability.strategy != \"DualZone\"\n| where location in (\"uksouth\", \"westeurope\", \"germanywestcentral\", \"australiaeast\")\n| project recommendationId = \"9ec5b4c8-3dd8-473a-86ee-3273290331b9\", name, id, tags, param1 = \"stretchClusters: Disabled\"\n\n",
            "guid": "9ec5b4c8-3dd8-473a-86ee-3273290331b9",
            "learnMoreLink": [
                {
                    "name": "Learn More",
                    "url": "https://learn.microsoft.com/en-us/azure/well-architected/azure-vmware/infrastructure#implement-high-availability"
                },
                {
                    "name": "Stretched Clusters",
                    "url": "https://learn.microsoft.com/en-us/azure/azure-vmware/deploy-vsan-stretched-clusters"
                }
            ],
            "longDescription": "For Azure VMware Solution, enabling Stretched Clusters offers 99.99% SLA, synchronous storage replication (RPO=0), and spreads vSAN datastore across two AZs. Must be done at initial setup, needing double quota due to extension across AZs.\n",
            "pgVerified": true,
            "potentialBenefits": "99.99% SLA, 0 RPO, Multi-AZ",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "Low",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.AVS/privateClouds",
            "recommendationTypeId": null,
            "service": "AVS",
            "severity": "Low",
            "source": "azure-resources/AVS/privateClouds/recommendations.yaml",
            "tags": null,
            "text": "Enable Stretched Clusters for Multi-AZ Availability of the vSAN Datastore"
        },
        {
            "aprlGuid": "4232eb32-3241-4049-9e14-9b8005817b56",
            "automationAvailable": "arg",
            "category": "Monitoring and Alerting",
            "description": "Ensure VMware vSAN datastore slack space is maintained for SLA by monitoring storage utilization and setting alerts at 70% and 75% utilization to allow for capacity planning. To expand, add hosts or external storage like Azure Elastic SAN, Azure NetApp Files, if CPU and RAM requirements are met.\n",
            "graph": "// Azure Resource Graph Query\n// Provides a list of Azure VMware Solution resources that don't have a vSAN capacity critical alert with a threshold of 75% or a warning capacity of 70%.\n(\nresources\n| where ['type'] == \"microsoft.avs/privateclouds\"\n| extend scopeId = tolower(tostring(id))\n| project ['scopeId'], name, id, tags\n| join kind=leftouter (\nresources\n| where type == \"microsoft.insights/metricalerts\"\n| extend alertProperties = todynamic(properties)\n| mv-expand alertProperties.scopes\n| mv-expand alertProperties.criteria.allOf\n| extend scopeId = tolower(tostring(alertProperties_scopes))\n| extend metric = alertProperties_criteria_allOf.metricName\n| extend threshold = alertProperties_criteria_allOf.threshold\n| project scopeId, tostring(metric), toint(['threshold'])\n| where metric == \"DiskUsedPercentage\"\n| where threshold == 75\n) on scopeId\n| where isnull(['threshold'])\n| project recommendationId = \"4232eb32-3241-4049-9e14-9b8005817b56\", name, id, tags, param1 = \"vsanCapacityCriticalAlert: isNull or threshold != 75\"\n)\n| union (\nresources\n| where ['type'] == \"microsoft.avs/privateclouds\"\n| extend scopeId = tolower(tostring(id))\n| project ['scopeId'], name, id, tags\n| join kind=leftouter (\nresources\n| where type == \"microsoft.insights/metricalerts\"\n| extend alertProperties = todynamic(properties)\n| mv-expand alertProperties.scopes\n| mv-expand alertProperties.criteria.allOf\n| extend scopeId = tolower(tostring(alertProperties_scopes))\n| extend metric = alertProperties_criteria_allOf.metricName\n| extend threshold = alertProperties_criteria_allOf.threshold\n| project scopeId, tostring(metric), toint(['threshold'])\n| where metric == \"DiskUsedPercentage\"\n| where threshold == 70\n) on scopeId\n| where isnull(['threshold'])\n| project recommendationId = \"4232eb32-3241-4049-9e14-9b8005817b56\", name, id, tags, param1 = \"vsanCapacityWarningAlert: isNull or threshold != 70\"\n)\n\n",
            "guid": "4232eb32-3241-4049-9e14-9b8005817b56",
            "learnMoreLink": [
                {
                    "name": "Learn More",
                    "url": "https://learn.microsoft.com/en-us/azure/azure-vmware/configure-alerts-for-azure-vmware-solution#supported-metrics-and-activities"
                }
            ],
            "longDescription": "Ensure VMware vSAN datastore slack space is maintained for SLA by monitoring storage utilization and setting alerts at 70% and 75% utilization to allow for capacity planning. To expand, add hosts or external storage like Azure Elastic SAN, Azure NetApp Files, if CPU and RAM requirements are met.\n",
            "pgVerified": true,
            "potentialBenefits": "Optimized capacity planning for vSAN",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Monitoring and Alerting",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.AVS/privateClouds",
            "recommendationTypeId": null,
            "service": "AVS",
            "severity": "High",
            "source": "azure-resources/AVS/privateClouds/recommendations.yaml",
            "tags": null,
            "text": "Configure Azure Monitor Alert warning thresholds for vSAN datastore utilization"
        },
        {
            "aprlGuid": "fa4ab927-bced-429a-971a-53350de7f14b",
            "automationAvailable": false,
            "category": "Monitoring and Alerting",
            "description": "Ensure Diagnostic Settings are configured for each private cloud to send syslogs to external sources for analysis and/or archiving. Azure VMware Solution Syslogs contain data for troubleshooting and performance, aiding quicker issue resolution and early detection of issues.\n",
            "graph": "// cannot-be-validated-with-arg\n",
            "guid": "fa4ab927-bced-429a-971a-53350de7f14b",
            "learnMoreLink": [
                {
                    "name": "Learn More",
                    "url": "https://learn.microsoft.com/en-us/azure/well-architected/azure-vmware/monitoring#manage-logs-and-archives"
                }
            ],
            "longDescription": "Ensure Diagnostic Settings are configured for each private cloud to send syslogs to external sources for analysis and/or archiving. Azure VMware Solution Syslogs contain data for troubleshooting and performance, aiding quicker issue resolution and early detection of issues.\n",
            "pgVerified": true,
            "potentialBenefits": "Faster issue resolution, early detection",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Monitoring and Alerting",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.AVS/privateClouds",
            "recommendationTypeId": null,
            "service": "AVS",
            "severity": "High",
            "source": "azure-resources/AVS/privateClouds/recommendations.yaml",
            "tags": null,
            "text": "Configure Syslog in Diagnostic Settings for Azure VMware Solution"
        },
        {
            "aprlGuid": "4ee5d535-c47b-470a-9557-4a3dd297d62f",
            "automationAvailable": "arg",
            "category": "Monitoring and Alerting",
            "description": "Ensure sufficient compute resources to avoid host resource exhaustion in Azure VMware Solution, which utilizes vSphere DRS and HA for dynamic workload resource management. However, sustained CPU utilization over 95% may increase CPU Ready times, impacting workloads.\n",
            "graph": "// Azure Resource Graph Query\n// Provides a list of Azure VMware Solution resources that don't have a Cluster CPU capacity critical alert with a threshold of 95%.\nresources\n| where ['type'] == \"microsoft.avs/privateclouds\"\n| extend scopeId = tolower(tostring(id))\n| project ['scopeId'], name, id, tags\n| join kind=leftouter (\nresources\n| where type == \"microsoft.insights/metricalerts\"\n| extend alertProperties = todynamic(properties)\n| mv-expand alertProperties.scopes\n| mv-expand alertProperties.criteria.allOf\n| extend scopeId = tolower(tostring(alertProperties_scopes))\n| extend metric = alertProperties_criteria_allOf.metricName\n| extend threshold = alertProperties_criteria_allOf.threshold\n| project scopeId, tostring(metric), toint(['threshold'])\n| where metric == \"EffectiveCpuAverage\"\n| where threshold == 95\n) on scopeId\n| where isnull(['threshold'])\n| project recommendationId = \"4ee5d535-c47b-470a-9557-4a3dd297d62f\", name, id, tags, param1 = \"hostCpuCriticalAlert: isNull or threshold != 95\"\n\n",
            "guid": "4ee5d535-c47b-470a-9557-4a3dd297d62f",
            "learnMoreLink": [
                {
                    "name": "Learn More",
                    "url": "https://learn.microsoft.com/en-us/azure/well-architected/azure-vmware/monitoring#configure-and-streamline-alerts"
                }
            ],
            "longDescription": "Ensure sufficient compute resources to avoid host resource exhaustion in Azure VMware Solution, which utilizes vSphere DRS and HA for dynamic workload resource management. However, sustained CPU utilization over 95% may increase CPU Ready times, impacting workloads.\n",
            "pgVerified": true,
            "potentialBenefits": "Avoids resource exhaustion, optimizes performance",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Monitoring and Alerting",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.AVS/privateClouds",
            "recommendationTypeId": null,
            "service": "AVS",
            "severity": "Medium",
            "source": "azure-resources/AVS/privateClouds/recommendations.yaml",
            "tags": null,
            "text": "Monitor CPU Utilization to ensure sufficient resources for workloads"
        },
        {
            "aprlGuid": "029208c8-5186-4a76-8ee8-6e3445fef4dd",
            "automationAvailable": "arg",
            "category": "Monitoring and Alerting",
            "description": "Ensure sufficient memory resources to prevent host resource exhaustion in Azure VMware Solution. It uses vSphere DRS and vSphere HA for dynamic workload management. Yet, continuous memory use over 95% leads to disk swapping, affecting workloads.\n",
            "graph": "// Azure Resource Graph Query\n// Provides a list of Azure VMware Solution resources that don't have a cluster host memory critical alert with a threshold of 95%.\nresources\n| where ['type'] == \"microsoft.avs/privateclouds\"\n| extend scopeId = tolower(tostring(id))\n| project ['scopeId'], name, id, tags\n| join kind=leftouter (\nresources\n| where type == \"microsoft.insights/metricalerts\"\n| extend alertProperties = todynamic(properties)\n| mv-expand alertProperties.scopes\n| mv-expand alertProperties.criteria.allOf\n| extend scopeId = tolower(tostring(alertProperties_scopes))\n| extend metric = alertProperties_criteria_allOf.metricName\n| extend threshold = alertProperties_criteria_allOf.threshold\n| project scopeId, tostring(metric), toint(['threshold'])\n| where metric == \"UsageAverage\"\n| where threshold == 95\n) on scopeId\n| where isnull(['threshold'])\n| project recommendationId = \"029208c8-5186-4a76-8ee8-6e3445fef4dd\", name, id, tags, param1 = \"hostMemoryCriticalAlert: isNull or threshold != 95\"\n\n",
            "guid": "029208c8-5186-4a76-8ee8-6e3445fef4dd",
            "learnMoreLink": [
                {
                    "name": "Learn More",
                    "url": "https://learn.microsoft.com/en-us/azure/well-architected/azure-vmware/monitoring#configure-and-streamline-alerts"
                }
            ],
            "longDescription": "Ensure sufficient memory resources to prevent host resource exhaustion in Azure VMware Solution. It uses vSphere DRS and vSphere HA for dynamic workload management. Yet, continuous memory use over 95% leads to disk swapping, affecting workloads.\n",
            "pgVerified": true,
            "potentialBenefits": "Avoids host exhaustion and swapping",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Monitoring and Alerting",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.AVS/privateClouds",
            "recommendationTypeId": null,
            "service": "AVS",
            "severity": "Medium",
            "source": "azure-resources/AVS/privateClouds/recommendations.yaml",
            "tags": null,
            "text": "Monitor Memory Utilization to ensure sufficient resources for workloads"
        },
        {
            "aprlGuid": "a5ef7c05-c611-4842-9af5-11efdc99123a",
            "automationAvailable": false,
            "category": "Governance",
            "description": "Applying a resource delete lock to the Azure VMware Solution Private Cloud resource group prevents unauthorized or accidental deletion by anyone with contributor access, ensuring the protection and reliability of the Azure VMware Solution Private Cloud.\n",
            "graph": "// cannot-be-validated-with-arg\n",
            "guid": "a5ef7c05-c611-4842-9af5-11efdc99123a",
            "learnMoreLink": [
                {
                    "name": "Lock your resources to protect your infrastructure",
                    "url": "https://learn.microsoft.com/en-us/azure/azure-resource-manager/management/lock-resources"
                }
            ],
            "longDescription": "Applying a resource delete lock to the Azure VMware Solution Private Cloud resource group prevents unauthorized or accidental deletion by anyone with contributor access, ensuring the protection and reliability of the Azure VMware Solution Private Cloud.\n",
            "pgVerified": true,
            "potentialBenefits": "Prevents accidental deletion",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Governance",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.AVS/privateClouds",
            "recommendationTypeId": null,
            "service": "AVS",
            "severity": "High",
            "source": "azure-resources/AVS/privateClouds/recommendations.yaml",
            "tags": null,
            "text": "Apply Resource delete lock on the resource group hosting the private cloud"
        },
        {
            "aprlGuid": "e0ac2f57-c8c0-4b8c-a7c8-19e5797828b5",
            "automationAvailable": false,
            "category": "Security",
            "description": "When using customer-managed keys for encrypting vSAN datastores, leveraging Azure Key Vault for central management and accessing them via a managed identity linked to the private cloud is advised. The expiration of these keys can render the vSAN datastore and its associated workloads inaccessible.\n",
            "graph": "// cannot-be-validated-with-arg\n",
            "guid": "e0ac2f57-c8c0-4b8c-a7c8-19e5797828b5",
            "learnMoreLink": [
                {
                    "name": "Configure Customer Managed Keys",
                    "url": "https://learn.microsoft.com/en-us/azure/azure-vmware/configure-customer-managed-keys?tabs=azure-portal"
                }
            ],
            "longDescription": "When using customer-managed keys for encrypting vSAN datastores, leveraging Azure Key Vault for central management and accessing them via a managed identity linked to the private cloud is advised. The expiration of these keys can render the vSAN datastore and its associated workloads inaccessible.\n",
            "pgVerified": true,
            "potentialBenefits": "Avoid outages with key auto-rotation",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Security",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.AVS/privateClouds",
            "recommendationTypeId": null,
            "service": "AVS",
            "severity": "High",
            "source": "azure-resources/AVS/privateClouds/recommendations.yaml",
            "tags": null,
            "text": "Use key autorotation for vSAN datastore customer-managed keys"
        },
        {
            "aprlGuid": "fcc2e257-23af-4c68-aac8-9cc03033c939",
            "automationAvailable": false,
            "category": "High Availability",
            "description": "Azure VMware Solution private clouds support up to three DNS servers for a single FQDN, preventing a single DNS server from becoming a point of failure. It's crucial to use multiple DNS servers for on-premises FQDN resolution from each private cloud.\n",
            "graph": "// cannot-be-validated-with-arg\n",
            "guid": "fcc2e257-23af-4c68-aac8-9cc03033c939",
            "learnMoreLink": [
                {
                    "name": "Configure DNS forwarder",
                    "url": "https://learn.microsoft.com/en-us/azure/azure-vmware/configure-dns-azure-vmware-solution#configure-dns-forwarder"
                }
            ],
            "longDescription": "Azure VMware Solution private clouds support up to three DNS servers for a single FQDN, preventing a single DNS server from becoming a point of failure. It's crucial to use multiple DNS servers for on-premises FQDN resolution from each private cloud.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhances reliability and avoids failure",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.AVS/privateClouds",
            "recommendationTypeId": null,
            "service": "AVS",
            "severity": "High",
            "source": "azure-resources/AVS/privateClouds/recommendations.yaml",
            "tags": null,
            "text": "Use multiple DNS servers per private FQDN zone"
        },
        {
            "aprlGuid": "baf3bfc0-32a2-4c0c-926d-c9bf0b49808e",
            "automationAvailable": "arg",
            "category": "High Availability",
            "description": "Upgrading the API Management instance to the Premium SKU adds support for Availability Zones, enhancing availability and resilience by distributing services across physically separate locations within Azure regions.\n",
            "graph": "// Azure Resource Graph Query\n// Find all API Management instances that aren't Premium\nresources\n| where type =~ 'Microsoft.ApiManagement/service'\n| extend skuName = sku.name\n| where tolower(skuName) != tolower('premium')\n| project recommendationId = \"baf3bfc0-32a2-4c0c-926d-c9bf0b49808e\", name, id, tags, param1=strcat(\"SKU: \", skuName)\n\n",
            "guid": "baf3bfc0-32a2-4c0c-926d-c9bf0b49808e",
            "learnMoreLink": [
                {
                    "name": "Change your API Management service tier",
                    "url": "https://learn.microsoft.com/en-us/azure/api-management/upgrade-and-scale#change-your-api-management-service-tier"
                },
                {
                    "name": "Migrate Azure API Management to availability zone support",
                    "url": "https://learn.microsoft.com/en-us/azure/reliability/migrate-api-mgt"
                }
            ],
            "longDescription": "Upgrading the API Management instance to the Premium SKU adds support for Availability Zones, enhancing availability and resilience by distributing services across physically separate locations within Azure regions.\n",
            "pgVerified": false,
            "potentialBenefits": "Enhanced availability and resilience",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.ApiManagement/service",
            "recommendationTypeId": null,
            "service": "APIM",
            "severity": "High",
            "source": "azure-resources/ApiManagement/service/recommendations.yaml",
            "tags": null,
            "text": "Migrate API Management services to Premium SKU to support Availability Zones"
        },
        {
            "aprlGuid": "740f2c1c-8857-4648-80eb-47d2c56d5a50",
            "automationAvailable": "arg",
            "category": "High Availability",
            "description": "Zone redundancy for APIM instances ensures the gateway and control plane (Management API, developer portal, Git configuration) are replicated across datacenters in physically separated zones, boosting resilience to zone failures.\n",
            "graph": "// Azure Resource Graph Query\n// Find all Premium API Management instances that aren't zone redundant\nresources\n| where type =~ 'Microsoft.ApiManagement/service'\n| extend skuName = sku.name\n| where tolower(skuName) == tolower('premium')\n| where isnull(zones) or array_length(zones) < 2\n| extend zoneValue = iff((isnull(zones)), \"null\", zones)\n| project recommendationId = \"740f2c1c-8857-4648-80eb-47d2c56d5a50\", name, id, tags, param1=\"Zones: No Zone or Zonal\", param2=strcat(\"Zones value: \", zoneValue )\n\n",
            "guid": "740f2c1c-8857-4648-80eb-47d2c56d5a50",
            "learnMoreLink": [
                {
                    "name": "Ensure API Management availability and reliability",
                    "url": "https://learn.microsoft.com/en-us/azure/api-management/high-availability#availability-zones"
                },
                {
                    "name": "Migrate Azure API Management to availability zone support",
                    "url": "https://learn.microsoft.com/en-us/azure/reliability/migrate-api-mgt"
                }
            ],
            "longDescription": "Zone redundancy for APIM instances ensures the gateway and control plane (Management API, developer portal, Git configuration) are replicated across datacenters in physically separated zones, boosting resilience to zone failures.\n",
            "pgVerified": false,
            "potentialBenefits": "Improved resilience to zone failures",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.ApiManagement/service",
            "recommendationTypeId": null,
            "service": "APIM",
            "severity": "High",
            "source": "azure-resources/ApiManagement/service/recommendations.yaml",
            "tags": null,
            "text": "Enable Availability Zones on Premium API Management instances"
        },
        {
            "aprlGuid": "e35cf148-8eee-49d1-a1c9-956160f99e0b",
            "automationAvailable": "arg",
            "category": "High Availability",
            "description": "Upgrading to API Management stv2 is required as stv1 retires on 31 Aug 2024, offering enhanced capabilities with the new platform version.\n",
            "graph": "// Azure Resource Graph Query\n// Find all API Management instances that aren't upgraded to platform version stv2\nresources\n| where type =~ 'Microsoft.ApiManagement/service'\n| extend plat_version = properties.platformVersion\n| extend skuName = sku.name\n| where tolower(plat_version) != tolower('stv2')\n| project recommendationId = \"e35cf148-8eee-49d1-a1c9-956160f99e0b\", name, id, tags, param1=strcat(\"Platform Version: \", plat_version) , param2=strcat(\"SKU: \", skuName)\n\n",
            "guid": "e35cf148-8eee-49d1-a1c9-956160f99e0b",
            "learnMoreLink": [
                {
                    "name": "Azure API Management - stv1 platform retirement (August 2024)",
                    "url": "https://learn.microsoft.com/en-us/azure/api-management/breaking-changes/stv1-platform-retirement-august-2024"
                },
                {
                    "name": "Azure API Management compute platform",
                    "url": "https://learn.microsoft.com/en-us/azure/api-management/compute-infrastructure"
                }
            ],
            "longDescription": "Upgrading to API Management stv2 is required as stv1 retires on 31 Aug 2024, offering enhanced capabilities with the new platform version.\n",
            "pgVerified": false,
            "potentialBenefits": "Ensures service continuity",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.ApiManagement/service",
            "recommendationTypeId": "e5f60ef8-3fcc-4fb5-bee7-7aaeb44c1509",
            "service": "APIM",
            "severity": "High",
            "source": "azure-resources/ApiManagement/service/recommendations.yaml",
            "tags": null,
            "text": "Azure API Management platform version should be stv2"
        },
        {
            "aprlGuid": "c79680ea-de85-44fa-a596-f31fa17a952f",
            "automationAvailable": false,
            "category": "High Availability",
            "description": "Use API Management with auto-scale for high availability in workloads that experience variable traffic patterns. There are several limitations with auto-scale, so review the documentation to ensure it meets your requirements.\n",
            "graph": "// cannot-be-validated-with-arg\n",
            "guid": "c79680ea-de85-44fa-a596-f31fa17a952f",
            "learnMoreLink": [
                {
                    "name": "Setting up auto-scale for Azure API Management",
                    "url": "https://learn.microsoft.com/azure/api-management/api-management-howto-autoscale"
                }
            ],
            "longDescription": "Use API Management with auto-scale for high availability in workloads that experience variable traffic patterns. There are several limitations with auto-scale, so review the documentation to ensure it meets your requirements.\n",
            "pgVerified": false,
            "potentialBenefits": "Enhanced availability and resilience",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "Low",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.ApiManagement/service",
            "recommendationTypeId": null,
            "service": "APIM",
            "severity": "Low",
            "source": "azure-resources/ApiManagement/service/recommendations.yaml",
            "tags": null,
            "text": "Enable auto-scale for production workloads on API Management services"
        },
        {
            "aprlGuid": "8dbcd94b-0948-4df3-b608-1946726c3abf",
            "automationAvailable": false,
            "category": "High Availability",
            "description": "Enable container health probes to monitor the health of your container apps and ensure that unhealthy containers are restarted automatically.\n",
            "graph": "// cannot-be-validated-with-arg\n",
            "guid": "8dbcd94b-0948-4df3-b608-1946726c3abf",
            "learnMoreLink": [
                {
                    "name": "Health probes for Azure Container Apps",
                    "url": "https://learn.microsoft.com/azure/container-apps/health-probes?tabs=arm-template"
                }
            ],
            "longDescription": "Enable container health probes to monitor the health of your container apps and ensure that unhealthy containers are restarted automatically.\n",
            "pgVerified": false,
            "potentialBenefits": "Enhanced availability and resilience",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.App/containerApps",
            "recommendationTypeId": null,
            "service": "Container Apps",
            "severity": "High",
            "source": "azure-resources/App/containerApps/recommendations.yaml",
            "tags": null,
            "text": "Enable container health probes"
        },
        {
            "aprlGuid": "f4201965-a88d-449d-b3b4-021394719eb2",
            "automationAvailable": "arg",
            "category": "High Availability",
            "description": "To take advantage of availability zones, you must enable zone redundancy when you create a Container Apps environment. The environment must include a virtual network with an available subnet. To ensure proper distribution of replicas, set your app's minimum replica count to three.\n",
            "graph": "// Azure Resource Graph Query\n// The query filters the qualified Container app environments that do not have Zone Redundancy enabled.\nresources\n| where type =~ \"microsoft.app/managedenvironments\"\n| where tobool(properties.zoneRedundant) == false\n| project recommendationId = \"f4201965-a88d-449d-b3b4-021394719eb2\", name, id, tags, param1 = \"AvailabilityZones: Single Zone\"\n| order by id asc\n",
            "guid": "f4201965-a88d-449d-b3b4-021394719eb2",
            "learnMoreLink": [
                {
                    "name": "Reliability in Azure Container Apps",
                    "url": "https://learn.microsoft.com/en-us/azure/reliability/reliability-azure-container-apps"
                }
            ],
            "longDescription": "To take advantage of availability zones, you must enable zone redundancy when you create a Container Apps environment. The environment must include a virtual network with an available subnet. To ensure proper distribution of replicas, set your app's minimum replica count to three.\n",
            "pgVerified": false,
            "potentialBenefits": "Enhances app resiliency and reliability",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.App/managedenvironments",
            "recommendationTypeId": null,
            "service": "Microsoft.App/managedenvironments",
            "severity": "High",
            "source": "azure-resources/App/managedEnvironments/recommendations.yaml",
            "tags": null,
            "text": "Deploy zone redundant Container app environments"
        },
        {
            "aprlGuid": "bb4c8db4-f821-475b-b1ea-16e95358665e",
            "automationAvailable": "arg",
            "category": "Governance",
            "description": "With Purge protection enabled, soft deleted stores can't be purged in the retention period. If disabled, the soft deleted store can be purged before the retention period expires.\n",
            "graph": "// Azure Resource Graph Query\n// Purge protection should be enabled for App Configuration stores to prevent accidental deletion of configuration data.\nresources\n| where type =~ \"Microsoft.AppConfiguration/configurationStores\"\n| where sku.name <> \"free\"\n| where (properties.enablePurgeProtection <> true) or isnull(properties.enablePurgeProtection )\n| project recommendationId = \"bb4c8db4-f821-475b-b1ea-16e95358665e\", name, id, tags, param1 = \"Enable purge protection\"\n",
            "guid": "bb4c8db4-f821-475b-b1ea-16e95358665e",
            "learnMoreLink": [
                {
                    "name": "Purge protection",
                    "url": "https://learn.microsoft.com/en-us/azure/azure-app-configuration/concept-soft-delete#purge-protection"
                }
            ],
            "longDescription": "With Purge protection enabled, soft deleted stores can't be purged in the retention period. If disabled, the soft deleted store can be purged before the retention period expires.\n",
            "pgVerified": false,
            "potentialBenefits": "Prevent accidental deletion of configuration stores.",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Governance",
            "recommendationImpact": "Low",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.AppConfiguration/configurationStores",
            "recommendationTypeId": null,
            "service": "Microsoft.AppConfiguration/configurationStores",
            "severity": "Low",
            "source": "azure-resources/AppConfiguration/configurationStores/recommendations.yaml",
            "tags": null,
            "text": "Enable Purge protection for Azure App Configuration"
        },
        {
            "aprlGuid": "2102a57a-a056-4d5e-afe5-9df9f92177ca",
            "automationAvailable": "arg",
            "category": "High Availability",
            "description": "SLA is not available for Free tier. Upgrade to the Standard tier to get an SLA of 99.9%\n",
            "graph": "// Azure Resource Graph Query\n// Upgrade to App Configuration Standard tier\nresources\n| where type =~ \"Microsoft.AppConfiguration/configurationStores\"\n| where sku.name == \"free\"\n| project recommendationId = \"2102a57a-a056-4d5e-afe5-9df9f92177ca\", name, id, tags, param1 = \"Upgrade to Standard SKU\"\n",
            "guid": "2102a57a-a056-4d5e-afe5-9df9f92177ca",
            "learnMoreLink": [
                {
                    "name": "Choose App Configuration tier",
                    "url": "https://learn.microsoft.com/en-us/azure/azure-app-configuration/faq#which-app-configuration-tier-should-i-use"
                }
            ],
            "longDescription": "SLA is not available for Free tier. Upgrade to the Standard tier to get an SLA of 99.9%\n",
            "pgVerified": false,
            "potentialBenefits": "High availability, more storage, higher request quota.",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.AppConfiguration/configurationStores",
            "recommendationTypeId": null,
            "service": "Microsoft.AppConfiguration/configurationStores",
            "severity": "High",
            "source": "azure-resources/AppConfiguration/configurationStores/recommendations.yaml",
            "tags": null,
            "text": "Upgrade to App Configuration Standard tier"
        },
        {
            "aprlGuid": "67205887-0733-466e-b50e-b1cd7316c514",
            "automationAvailable": false,
            "category": "High Availability",
            "description": "Set up disaster recovery for Automation accounts and resources like Modules, Connections, Credentials, Certificates, Variables, and Schedules to deal with region or zone failures. A replica Automation account should be ready in a secondary region for failover.\n",
            "graph": "// cannot-be-validated-with-arg\n\n",
            "guid": "67205887-0733-466e-b50e-b1cd7316c514",
            "learnMoreLink": [
                {
                    "name": "Disaster recovery for Automation accounts",
                    "url": "https://learn.microsoft.com/en-us/azure/automation/automation-disaster-recovery?tabs=win-hrw%2Cps-script%2Coption-one"
                },
                {
                    "name": "Disaster recovery scenarios for cloud and hybrid jobs",
                    "url": "https://learn.microsoft.com/en-us/azure/automation/automation-disaster-recovery?tabs=win-hrw%2Cps-script%2Coption-one#scenarios-for-cloud-and-hybrid-jobs"
                }
            ],
            "longDescription": "Set up disaster recovery for Automation accounts and resources like Modules, Connections, Credentials, Certificates, Variables, and Schedules to deal with region or zone failures. A replica Automation account should be ready in a secondary region for failover.\n",
            "pgVerified": false,
            "potentialBenefits": "Ensures continuity during outages",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Automation/automationAccounts",
            "recommendationTypeId": null,
            "service": "Microsoft.Automation/automationAccounts",
            "severity": "High",
            "source": "azure-resources/Automation/automationAccounts/recommendations.yaml",
            "tags": null,
            "text": "Set up disaster recovery of Automation accounts and its dependent resources"
        },
        {
            "aprlGuid": "3464854d-6f75-4922-95e4-a2a308b53ce6",
            "automationAvailable": false,
            "category": "Monitoring and Alerting",
            "description": "To ensure cross-region disaster recovery and business continuity, set the right quotas for all Batch accounts to allocate necessary core numbers upfront, preventing execution interruptions from reaching quota limits.\n",
            "graph": "// cannot-be-validated-with-arg\n\n",
            "guid": "3464854d-6f75-4922-95e4-a2a308b53ce6",
            "learnMoreLink": [
                {
                    "name": "Learn More",
                    "url": "https://learn.microsoft.com/azure/reliability/reliability-batch#cross-region-disaster-recovery-and-business-continuity"
                }
            ],
            "longDescription": "To ensure cross-region disaster recovery and business continuity, set the right quotas for all Batch accounts to allocate necessary core numbers upfront, preventing execution interruptions from reaching quota limits.\n",
            "pgVerified": false,
            "potentialBenefits": "Ensures business continuity",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Monitoring and Alerting",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Batch/batchAccounts",
            "recommendationTypeId": null,
            "service": "Microsoft.Batch/batchAccounts",
            "severity": "Medium",
            "source": "azure-resources/Batch/batchAccounts/recommendations.yaml",
            "tags": null,
            "text": "Monitor Batch Account quota"
        },
        {
            "aprlGuid": "71cfab8f-d588-4742-b175-b6e07ae48dbd",
            "automationAvailable": false,
            "category": "High Availability",
            "description": "When using Virtual Machine Configuration for Azure Batch pools, opting to distribute your pool across Availability Zones bolsters your compute nodes against Azure datacenter failures.\n",
            "graph": "// under-development\n\n",
            "guid": "71cfab8f-d588-4742-b175-b6e07ae48dbd",
            "learnMoreLink": [
                {
                    "name": "Learn More",
                    "url": "https://learn.microsoft.com/azure/batch/create-pool-availability-zones"
                }
            ],
            "longDescription": "When using Virtual Machine Configuration for Azure Batch pools, opting to distribute your pool across Availability Zones bolsters your compute nodes against Azure datacenter failures.\n",
            "pgVerified": false,
            "potentialBenefits": "Enhanced reliability and failure protection",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Batch/batchAccounts",
            "recommendationTypeId": null,
            "service": "Microsoft.Batch/batchAccounts",
            "severity": "High",
            "source": "azure-resources/Batch/batchAccounts/recommendations.yaml",
            "tags": null,
            "text": "Create an Azure Batch pool across Availability Zones"
        },
        {
            "aprlGuid": "5a44bd30-ae6a-4b81-9b68-dc3a8ffca4d8",
            "automationAvailable": "arg",
            "category": "High Availability",
            "description": "Azure Cache for Redis offers zone redundancy in Premium and Enterprise tiers, using VMs across multiple Availability Zones to ensure greater resilience and availability.\n",
            "graph": "// Azure Resource Graph Query\n// Find Cache for Redis instances with one or no Zones selected\nresources\n| where type =~ \"microsoft.cache/redis\"\n| where array_length(zones) <= 1 or isnull(zones)\n| project recommendationId = \"5a44bd30-ae6a-4b81-9b68-dc3a8ffca4d8\", name, id, tags, param1 = \"AvailabilityZones: Single Zone\"\n| order by id asc\n\n",
            "guid": "5a44bd30-ae6a-4b81-9b68-dc3a8ffca4d8",
            "learnMoreLink": [
                {
                    "name": "Enable zone redundancy for Azure Cache for Redis",
                    "url": "https://learn.microsoft.com/azure/azure-cache-for-redis/cache-how-to-zone-redundancy"
                }
            ],
            "longDescription": "Azure Cache for Redis offers zone redundancy in Premium and Enterprise tiers, using VMs across multiple Availability Zones to ensure greater resilience and availability.\n",
            "pgVerified": false,
            "potentialBenefits": "Higher resilience and availability",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Cache/Redis",
            "recommendationTypeId": null,
            "service": "Microsoft.Cache/Redis",
            "severity": "High",
            "source": "azure-resources/Cache/Redis/recommendations.yaml",
            "tags": null,
            "text": "Enable zone redundancy for Azure Cache for Redis"
        },
        {
            "aprlGuid": "cabc1f98-c8a7-44f7-ab24-977982ef3f70",
            "automationAvailable": false,
            "category": "High Availability",
            "description": "Azure Cache for Redis allows for specifying maintenance windows. A maintenance window allows you to control the days and times of a week during which the VMs hosting your cache can be updated.\n",
            "graph": "// cannot-be-validated-with-arg\n",
            "guid": "cabc1f98-c8a7-44f7-ab24-977982ef3f70",
            "learnMoreLink": [
                {
                    "name": "Schedule Redis Updates",
                    "url": "https://learn.microsoft.com/en-us/azure/azure-cache-for-redis/cache-administration#update-channel-and-schedule-updates"
                }
            ],
            "longDescription": "Azure Cache for Redis allows for specifying maintenance windows. A maintenance window allows you to control the days and times of a week during which the VMs hosting your cache can be updated.\n",
            "pgVerified": false,
            "potentialBenefits": "Higher resilience and availability",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Cache/redis",
            "recommendationTypeId": null,
            "service": "Microsoft.Cache/redis",
            "severity": "Medium",
            "source": "azure-resources/Cache/Redis/recommendations.yaml",
            "tags": null,
            "text": "Schedule updates by setting a maintenance window"
        },
        {
            "aprlGuid": "c474fc96-4e6a-4fb0-95d0-a26b3f35933c",
            "automationAvailable": "arg",
            "category": "Security",
            "description": "Use private endpoints for secure connection to cache via a private link, avoiding the public internet.\n",
            "graph": "// Azure Resource Graph Query\n// Find all Azure Redis cache services not protected by private endpoints.\nResources\n| where type =~ \"microsoft.cache/redis\"\n| where properties['publicNetworkAccess'] == \"Enabled\"\n| project recommendationId = \"c474fc96-4e6a-4fb0-95d0-a26b3f35933c\", name, id, tags\n| order by id asc\n\n",
            "guid": "c474fc96-4e6a-4fb0-95d0-a26b3f35933c",
            "learnMoreLink": [
                {
                    "name": "Configure private endpoints for Azure Redis Cache",
                    "url": "https://learn.microsoft.com/azure/azure-cache-for-redis/cache-network-isolation"
                }
            ],
            "longDescription": "Use private endpoints for secure connection to cache via a private link, avoiding the public internet.\n",
            "pgVerified": false,
            "potentialBenefits": "Secure, private VNet ingress, efficient data transfer",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Security",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Cache/redis",
            "recommendationTypeId": null,
            "service": "Microsoft.Cache/redis",
            "severity": "Medium",
            "source": "azure-resources/Cache/Redis/recommendations.yaml",
            "tags": null,
            "text": "Configure Private Endpoints"
        },
        {
            "aprlGuid": "9437634c-d69e-2747-b13e-631c13182150",
            "automationAvailable": "arg",
            "category": "Business Continuity",
            "description": "For most solutions, choose either Azure Front Door for content caching, CDN, TLS termination, and WAF, or Traffic Manager for simple global load balancing.\n",
            "graph": "// Azure Resource Graph Query\n// Avoid combining Traffic Manager and Front Door\nresources\n| where type == \"microsoft.network/trafficmanagerprofiles\"\n| mvexpand(properties.endpoints)\n| extend endpoint=tostring(properties_endpoints.properties.target)\n| project name, trafficmanager=id, matchname=endpoint, tags\n| join (\n    resources\n    | where type =~ \"microsoft.cdn/profiles/afdendpoints\"\n    | extend matchname= tostring(properties.hostName)\n    | extend splitid=split(id, \"/\")\n    | extend frontdoorid=tolower(strcat_array(array_slice(splitid, 0, 8), \"/\"))\n    | project name, id, matchname, frontdoorid, type\n    | union\n        (cdnresources\n        | where type =~ \"Microsoft.Cdn/Profiles/CustomDomains\"\n        | extend matchname= tostring(properties.hostName)\n        | extend splitid=split(id, \"/\")\n        | extend frontdoorid=tolower(strcat_array(array_slice(splitid, 0, 8), \"/\"))\n        | project name, id, matchname, frontdoorid, type)\n    )\n    on matchname\n| project\n    recommendationId = \"9437634c-d69e-2747-b13e-631c13182150\",\n    name=split(trafficmanager, \"/\")[-1],\n    id=trafficmanager,\n    tags,\n    param1=strcat(\"hostname:\", matchname),\n    param2=strcat(\"frontdoorid:\", frontdoorid)\n\n",
            "guid": "9437634c-d69e-2747-b13e-631c13182150",
            "learnMoreLink": [
                {
                    "name": "Azure Load Balancing Options",
                    "url": "https://learn.microsoft.com/azure/architecture/guide/technology-choices/load-balancing-overview"
                },
                {
                    "name": "Azure Traffic Manager",
                    "url": "https://learn.microsoft.com/azure/traffic-manager/traffic-manager-overview"
                },
                {
                    "name": "Azure Front Door",
                    "url": "https://learn.microsoft.com/azure/frontdoor/front-door-overview"
                },
                {
                    "name": "Mission-critical global content delivery",
                    "url": "https://learn.microsoft.com/en-us/azure/architecture/guide/networking/global-web-applications/mission-critical-content-delivery"
                }
            ],
            "longDescription": "For most solutions, choose either Azure Front Door for content caching, CDN, TLS termination, and WAF, or Traffic Manager for simple global load balancing.\n",
            "pgVerified": true,
            "potentialBenefits": "Optimized network routing and security",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Business Continuity",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Cdn/profiles",
            "recommendationTypeId": null,
            "service": "Front Door",
            "severity": "High",
            "source": "azure-resources/Cdn/profiles/recommendations.yaml",
            "tags": null,
            "text": "Avoid combining Traffic Manager and Front Door"
        },
        {
            "aprlGuid": "6c40b7ae-2bea-5748-be1a-9e9e3b834649",
            "automationAvailable": false,
            "category": "Security",
            "description": "Front Door's features perform optimally when traffic exclusively comes through Front Door. It's advised to set up your origin to deny access to traffic that bypasses Front Door.\n",
            "graph": "// under-development\n\n",
            "guid": "6c40b7ae-2bea-5748-be1a-9e9e3b834649",
            "learnMoreLink": [
                {
                    "name": "Secure traffic to Azure Front Door origins",
                    "url": "https://learn.microsoft.com/azure/frontdoor/origin-security?tabs=app-service-functions&pivots=front-door-standard-premium"
                }
            ],
            "longDescription": "Front Door's features perform optimally when traffic exclusively comes through Front Door. It's advised to set up your origin to deny access to traffic that bypasses Front Door.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhances security and performance",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Security",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Cdn/profiles",
            "recommendationTypeId": null,
            "service": "Front Door",
            "severity": "High",
            "source": "azure-resources/Cdn/profiles/recommendations.yaml",
            "tags": null,
            "text": "Restrict traffic to your origins"
        },
        {
            "aprlGuid": "52bc9a7b-23c8-bc4c-9d2a-7bc43b50104a",
            "automationAvailable": false,
            "category": "Scalability",
            "description": "When working with Azure Front Door through APIs, ARM templates, Bicep, or SDKs, using the latest API or SDK version is crucial. Updates bring new functions, important security patches, and bug fixes.\n",
            "graph": "// under-development\n\n",
            "guid": "52bc9a7b-23c8-bc4c-9d2a-7bc43b50104a",
            "learnMoreLink": [
                {
                    "name": "REST API Reference",
                    "url": "https://learn.microsoft.com/rest/api/frontdoor/"
                },
                {
                    "name": "Client library for Java",
                    "url": "https://learn.microsoft.com/java/api/overview/azure/resourcemanager-frontdoor-readme?view=azure-java-preview"
                },
                {
                    "name": "SDK for Python",
                    "url": "https://learn.microsoft.com/python/api/overview/azure/front-door?view=azure-python"
                }
            ],
            "longDescription": "When working with Azure Front Door through APIs, ARM templates, Bicep, or SDKs, using the latest API or SDK version is crucial. Updates bring new functions, important security patches, and bug fixes.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhanced security and features",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Scalability",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Cdn/profiles",
            "recommendationTypeId": "e607041e-3194-42ad-9994-b6ea5ec12f5e",
            "service": "Front Door",
            "severity": "Medium",
            "source": "azure-resources/Cdn/profiles/recommendations.yaml",
            "tags": null,
            "text": "Use the latest API version and SDK version"
        },
        {
            "aprlGuid": "1ad74c3c-e3d7-0046-b83f-a2199974ef15",
            "automationAvailable": false,
            "category": "Monitoring and Alerting",
            "description": "Front Door logs offer comprehensive telemetry on each request, crucial for understanding your solution's performance and responses, especially when caching is enabled, as origin servers might not receive every request.\n",
            "graph": "// under-development\n\n",
            "guid": "1ad74c3c-e3d7-0046-b83f-a2199974ef15",
            "learnMoreLink": [
                {
                    "name": "Monitor metrics and logs in Azure Front Door",
                    "url": "https://learn.microsoft.com/azure/frontdoor/front-door-diagnostics?pivots=front-door-standard-premium"
                },
                {
                    "name": "WAF logs",
                    "url": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-monitor?pivots=front-door-standard-premium#waf-logs"
                },
                {
                    "name": "Configure Azure Front Door logs",
                    "url": "https://learn.microsoft.com/azure/frontdoor/standard-premium/how-to-logs"
                }
            ],
            "longDescription": "Front Door logs offer comprehensive telemetry on each request, crucial for understanding your solution's performance and responses, especially when caching is enabled, as origin servers might not receive every request.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhanced insights and solution monitoring",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Monitoring and Alerting",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Cdn/profiles",
            "recommendationTypeId": null,
            "service": "Front Door",
            "severity": "Medium",
            "source": "azure-resources/Cdn/profiles/recommendations.yaml",
            "tags": null,
            "text": "Configure logs"
        },
        {
            "aprlGuid": "d9bd6780-0d6f-cd4c-bc66-8ddcab12f3d1",
            "automationAvailable": "arg",
            "category": "Security",
            "description": "Front Door terminates TCP and TLS connections from clients and establishes new connections from each PoP to the origin. Securing these connections with TLS, even for Azure-hosted origins, ensures data is always encrypted during transit.\n",
            "graph": "// Azure Resource Graph Query\n// Use end-to-end TLS\ncdnresources\n| where type == \"microsoft.cdn/profiles/afdendpoints/routes\"\n| extend forwardingProtocol=tostring(properties.forwardingProtocol),supportedProtocols=properties.supportedProtocols\n| project id,name,forwardingProtocol,supportedProtocols,tags\n| where forwardingProtocol !~ \"httpsonly\" or supportedProtocols has \"http\"\n| project recommendationId= \"d9bd6780-0d6f-cd4c-bc66-8ddcab12f3d1\", name,id,tags,param1=strcat(\"forwardingProtocol:\",forwardingProtocol),param2=strcat(\"supportedProtocols:\",supportedProtocols)\n\n",
            "guid": "d9bd6780-0d6f-cd4c-bc66-8ddcab12f3d1",
            "learnMoreLink": [
                {
                    "name": "End-to-end TLS with Azure Front Door",
                    "url": "https://learn.microsoft.com/azure/frontdoor/end-to-end-tls?pivots=front-door-standard-premium"
                }
            ],
            "longDescription": "Front Door terminates TCP and TLS connections from clients and establishes new connections from each PoP to the origin. Securing these connections with TLS, even for Azure-hosted origins, ensures data is always encrypted during transit.\n",
            "pgVerified": true,
            "potentialBenefits": "Ensures data encryption in transit",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Security",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Cdn/profiles",
            "recommendationTypeId": null,
            "service": "Front Door",
            "severity": "High",
            "source": "azure-resources/Cdn/profiles/recommendations.yaml",
            "tags": null,
            "text": "Use end-to-end TLS"
        },
        {
            "aprlGuid": "24ab9f11-a3e4-3043-a985-22cf94c4933a",
            "automationAvailable": "arg",
            "category": "Security",
            "description": "Using HTTPS is ideal for secure connections. However, for compatibility with older clients, HTTP requests may be necessary. Azure Front Door enables auto redirection of HTTP to HTTPS, enhancing security without sacrificing accessibility.\n",
            "graph": "// Azure Resource Graph Query\n// Use HTTP to HTTPS redirection\ncdnresources\n| where type == \"microsoft.cdn/profiles/afdendpoints/routes\"\n| extend httpsRedirect=tostring(properties.httpsRedirect)\n| project id,name,httpsRedirect,tags\n| where httpsRedirect !~ \"enabled\"\n| project recommendationId= \"24ab9f11-a3e4-3043-a985-22cf94c4933a\", name,id,tags,param1=strcat(\"httpsRedirect:\",httpsRedirect)\n\n",
            "guid": "24ab9f11-a3e4-3043-a985-22cf94c4933a",
            "learnMoreLink": [
                {
                    "name": "Create HTTP to HTTPS redirect rule",
                    "url": "https://learn.microsoft.com/azure/frontdoor/front-door-how-to-redirect-https#create-http-to-https-redirect-rule"
                }
            ],
            "longDescription": "Using HTTPS is ideal for secure connections. However, for compatibility with older clients, HTTP requests may be necessary. Azure Front Door enables auto redirection of HTTP to HTTPS, enhancing security without sacrificing accessibility.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhances security and compliance",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Security",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Cdn/profiles",
            "recommendationTypeId": null,
            "service": "Front Door",
            "severity": "High",
            "source": "azure-resources/Cdn/profiles/recommendations.yaml",
            "tags": null,
            "text": "Use HTTP to HTTPS redirection"
        },
        {
            "aprlGuid": "29d65c41-2fad-d142-95eb-9eab95f6c0a5",
            "automationAvailable": false,
            "category": "Security",
            "description": "When Front Door manages your TLS certificates, it reduces your operational costs and helps you to avoid costly outages caused by forgetting to renew a certificate. Front Door automatically issues and rotates the managed TLS certificates.\n",
            "graph": "// under-development\n\n",
            "guid": "29d65c41-2fad-d142-95eb-9eab95f6c0a5",
            "learnMoreLink": [
                {
                    "name": "Configure HTTPS on an Azure Front Door custom domain using the Azure portal",
                    "url": "https://learn.microsoft.com/azure/frontdoor/standard-premium/how-to-configure-https-custom-domain?tabs=powershell"
                }
            ],
            "longDescription": "When Front Door manages your TLS certificates, it reduces your operational costs and helps you to avoid costly outages caused by forgetting to renew a certificate. Front Door automatically issues and rotates the managed TLS certificates.\n",
            "pgVerified": true,
            "potentialBenefits": "Lowers costs, avoids outages",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Security",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Cdn/profiles",
            "recommendationTypeId": null,
            "service": "Front Door",
            "severity": "High",
            "source": "azure-resources/Cdn/profiles/recommendations.yaml",
            "tags": null,
            "text": "Use managed TLS certificates"
        },
        {
            "aprlGuid": "4638c2c0-03de-6d42-9e09-82ee4478cbf3",
            "automationAvailable": false,
            "category": "High Availability",
            "description": "If you use your own TLS certificates, set the Key Vault certificate version to 'Latest' to avoid reconfiguring Azure Front Door for new certificate versions and waiting for deployment across Front Door's environments.\n",
            "graph": "// under-development\n\n",
            "guid": "4638c2c0-03de-6d42-9e09-82ee4478cbf3",
            "learnMoreLink": [
                {
                    "name": "Select the certificate for Azure Front Door to deploy",
                    "url": "https://learn.microsoft.com/azure/frontdoor/standard-premium/how-to-configure-https-custom-domain?tabs=powershell#select-the-certificate-for-azure-front-door-to-deploy"
                }
            ],
            "longDescription": "If you use your own TLS certificates, set the Key Vault certificate version to 'Latest' to avoid reconfiguring Azure Front Door for new certificate versions and waiting for deployment across Front Door's environments.\n",
            "pgVerified": true,
            "potentialBenefits": "Saves time and automates TLS updates",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Cdn/profiles",
            "recommendationTypeId": "2c057605-4707-4d3e-bbb0-a7fe9b6a626b",
            "service": "Front Door",
            "severity": "Medium",
            "source": "azure-resources/Cdn/profiles/recommendations.yaml",
            "tags": null,
            "text": "Use latest version for customer-managed certificates"
        },
        {
            "aprlGuid": "cd6a32af-747a-e649-82a7-a98f528ca842",
            "automationAvailable": false,
            "category": "Governance",
            "description": "Front Door can rewrite Host headers for custom domain names routing to a single origin, useful for avoiding custom domain configuration at both Front Door and the origin.\n",
            "graph": "// under-development\n\n",
            "guid": "cd6a32af-747a-e649-82a7-a98f528ca842",
            "learnMoreLink": [
                {
                    "name": "Preserve the original HTTP host name between a reverse proxy and its back-end web application",
                    "url": "https://learn.microsoft.com/azure/architecture/best-practices/host-name-preservation"
                }
            ],
            "longDescription": "Front Door can rewrite Host headers for custom domain names routing to a single origin, useful for avoiding custom domain configuration at both Front Door and the origin.\n",
            "pgVerified": true,
            "potentialBenefits": "Improves session/auth handling",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Governance",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Cdn/profiles",
            "recommendationTypeId": null,
            "service": "Front Door",
            "severity": "Medium",
            "source": "azure-resources/Cdn/profiles/recommendations.yaml",
            "tags": null,
            "text": "Use the same domain name on Front Door and your origin"
        },
        {
            "aprlGuid": "1bd2b7e8-400f-e64a-99a2-c572f7b08a62",
            "automationAvailable": "arg",
            "category": "Security",
            "description": "For internet-facing applications, enabling the Front Door web application firewall (WAF) and configuring it to use managed rules is recommended for protection against a wide range of attacks using Microsoft-managed rules.\n",
            "graph": "// Azure Resource Graph Query\n// Enable the WAF\n\nresources\n| where type =~ \"microsoft.cdn/profiles\" and sku has \"AzureFrontDoor\"\n| project name, cdnprofileid=tolower(id), tostring(tags), resourceGroup, subscriptionId,skuname=tostring(sku.name)\n| join kind= fullouter (\n    cdnresources\n    | where type == \"microsoft.cdn/profiles/securitypolicies\"\n    | extend wafpolicyid=tostring(properties['parameters']['wafPolicy']['id'])\n    | extend splitid=split(id, \"/\")\n    | extend cdnprofileid=tolower(strcat_array(array_slice(splitid, 0, 8), \"/\"))\n    | project secpolname=name, cdnprofileid, wafpolicyid\n    )\n    on cdnprofileid\n| project name, cdnprofileid, secpolname, wafpolicyid,skuname\n| join kind = fullouter (\n    resources\n    | where type == \"microsoft.network/frontdoorwebapplicationfirewallpolicies\"\n    | extend\n        managedrulesenabled=iff(tostring(properties.managedRules.managedRuleSets) != \"[]\", true, false),\n        enabledState = tostring(properties.policySettings.enabledState)\n    | project afdwafname=name, managedrulesenabled, wafpolicyid=id, enabledState, tostring(tags)\n    )\n    on wafpolicyid\n| where name != \"\"\n| summarize\n    associatedsecuritypolicies=countif(secpolname != \"\"),\n    wafswithmanagedrules=countif(managedrulesenabled == 1)\n    by name, id=cdnprofileid, tags,skuname\n| where associatedsecuritypolicies == 0 or wafswithmanagedrules  == 0\n| project\n    recommendationId = \"1bd2b7e8-400f-e64a-99a2-c572f7b08a62\",\n    name,\n    id,\n    todynamic(tags),\n    param1 = strcat(\"associatedsecuritypolicies:\", associatedsecuritypolicies),\n    param2 = strcat(\"wafswithmanagedrules:\", wafswithmanagedrules),\n    param3 = strcat(\"skuname:\",skuname)\n\n",
            "guid": "1bd2b7e8-400f-e64a-99a2-c572f7b08a62",
            "learnMoreLink": [
                {
                    "name": "Web Application Firewall on Azure Front Door",
                    "url": "https://learn.microsoft.com/azure/frontdoor/web-application-firewall"
                }
            ],
            "longDescription": "For internet-facing applications, enabling the Front Door web application firewall (WAF) and configuring it to use managed rules is recommended for protection against a wide range of attacks using Microsoft-managed rules.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhances web app security",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Security",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Cdn/profiles",
            "recommendationTypeId": null,
            "service": "Front Door",
            "severity": "Medium",
            "source": "azure-resources/Cdn/profiles/recommendations.yaml",
            "tags": null,
            "text": "Enable the WAF"
        },
        {
            "aprlGuid": "38f3d542-6de6-a44b-86c6-97e3be690281",
            "automationAvailable": "arg",
            "category": "High Availability",
            "description": "Front Door health probes help detect unavailable or unhealthy origins, directing traffic to alternate origins if needed.\n",
            "graph": "// Azure Resource Graph Query\n// Disable health probes when there is only one origin in an origin group\ncdnresources\n| where type =~ \"microsoft.cdn/profiles/origingroups\"\n| extend healthprobe=tostring(properties.healthProbeSettings)\n| project origingroupname=name, id, tags, resourceGroup, subscriptionId, healthprobe\n| join (\n    cdnresources\n    | where type =~ \"microsoft.cdn/profiles/origingroups/Origins\"\n    | extend origingroupname = tostring(properties.originGroupName)\n    )\n    on origingroupname\n| summarize origincount=count(), enabledhealthprobecount=countif(healthprobe != \"\") by origingroupname, id, tostring(tags), resourceGroup, subscriptionId\n| where origincount == 1 and enabledhealthprobecount != 0\n| project\n    recommendationId = \"38f3d542-6de6-a44b-86c6-97e3be690281\",\n    name=origingroupname,\n    id,\n    todynamic(tags),\n    param1 = strcat(\"origincount:\", origincount),\n    param2 = strcat(\"enabledhealthprobecount:\", enabledhealthprobecount)\n\n",
            "guid": "38f3d542-6de6-a44b-86c6-97e3be690281",
            "learnMoreLink": [
                {
                    "name": "Health probes",
                    "url": "https://learn.microsoft.com/azure/frontdoor/health-probes"
                }
            ],
            "longDescription": "Front Door health probes help detect unavailable or unhealthy origins, directing traffic to alternate origins if needed.\n",
            "pgVerified": true,
            "potentialBenefits": "Reduces unnecessary origin traffic",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "Low",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Cdn/profiles",
            "recommendationTypeId": null,
            "service": "Front Door",
            "severity": "Low",
            "source": "azure-resources/Cdn/profiles/recommendations.yaml",
            "tags": null,
            "text": "Disable health probes when there is only one origin in an origin group"
        },
        {
            "aprlGuid": "5225bba3-28ec-1e43-8986-7eedfd466d65",
            "automationAvailable": false,
            "category": "High Availability",
            "description": "Consider selecting a webpage or location specifically designed for health monitoring as the endpoint for Azure Front Door's health probes. This should encompass the status of critical components like application servers, databases, and caches to serve production traffic efficiently.\n",
            "graph": "// under-development\n\n",
            "guid": "5225bba3-28ec-1e43-8986-7eedfd466d65",
            "learnMoreLink": [
                {
                    "name": "Health Endpoint Monitoring pattern",
                    "url": "https://learn.microsoft.com/azure/architecture/patterns/health-endpoint-monitoring"
                }
            ],
            "longDescription": "Consider selecting a webpage or location specifically designed for health monitoring as the endpoint for Azure Front Door's health probes. This should encompass the status of critical components like application servers, databases, and caches to serve production traffic efficiently.\n",
            "pgVerified": true,
            "potentialBenefits": "Improves traffic routing and uptime",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Cdn/profiles",
            "recommendationTypeId": null,
            "service": "Front Door",
            "severity": "Medium",
            "source": "azure-resources/Cdn/profiles/recommendations.yaml",
            "tags": null,
            "text": "Select good health probe endpoints"
        },
        {
            "aprlGuid": "5783defe-b49e-d947-84f7-d8677593f324",
            "automationAvailable": false,
            "category": "Scalability",
            "description": "Health probes in Azure Front Door can use GET or HEAD HTTP methods. Using the HEAD method for health probes is a recommended practice because it reduces the traffic load on your origins, being less resource-intensive.\n",
            "graph": "// under-development\n\n",
            "guid": "5783defe-b49e-d947-84f7-d8677593f324",
            "learnMoreLink": [
                {
                    "name": "Supported HTTP methods for health probes",
                    "url": "https://learn.microsoft.com/azure/frontdoor/health-probes#supported-http-methods-for-health-probes"
                }
            ],
            "longDescription": "Health probes in Azure Front Door can use GET or HEAD HTTP methods. Using the HEAD method for health probes is a recommended practice because it reduces the traffic load on your origins, being less resource-intensive.\n",
            "pgVerified": true,
            "potentialBenefits": "Reduces traffic load on origins",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Scalability",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Cdn/profiles",
            "recommendationTypeId": null,
            "service": "Front Door",
            "severity": "Medium",
            "source": "azure-resources/Cdn/profiles/recommendations.yaml",
            "tags": null,
            "text": "Use HEAD health probes"
        },
        {
            "aprlGuid": "b515690d-3bf9-3a49-8d38-188e0fd45896",
            "automationAvailable": false,
            "category": "Security",
            "description": "Azure Front Door's geo-filtering through WAF enables defining custom access rules by country/region to restrict or allow web app access.\n",
            "graph": "// under-development\n\n",
            "guid": "b515690d-3bf9-3a49-8d38-188e0fd45896",
            "learnMoreLink": [
                {
                    "name": "Geo filter WAF policy - GeoMatch",
                    "url": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-geo-filtering"
                }
            ],
            "longDescription": "Azure Front Door's geo-filtering through WAF enables defining custom access rules by country/region to restrict or allow web app access.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhanced regional access control",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Security",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Cdn/profiles",
            "recommendationTypeId": null,
            "service": "Front Door",
            "severity": "Medium",
            "source": "azure-resources/Cdn/profiles/recommendations.yaml",
            "tags": null,
            "text": "Use geo-filtering in Azure Front Door"
        },
        {
            "aprlGuid": "1cfe7834-56ec-ff41-b11d-993734705dba",
            "automationAvailable": false,
            "category": "Security",
            "description": "Azure Private Link enables secure access to Azure PaaS and services over a private endpoint in your virtual network, ensuring traffic goes over the Microsoft backbone network, not the public internet.\n",
            "graph": "// under-development\n\n",
            "guid": "1cfe7834-56ec-ff41-b11d-993734705dba",
            "learnMoreLink": [
                {
                    "name": "Private link for Azure Front Door",
                    "url": "https://learn.microsoft.com/azure/frontdoor/private-link"
                }
            ],
            "longDescription": "Azure Private Link enables secure access to Azure PaaS and services over a private endpoint in your virtual network, ensuring traffic goes over the Microsoft backbone network, not the public internet.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhanced security and private connectivity",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Security",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Cdn/profiles",
            "recommendationTypeId": null,
            "service": "Front Door",
            "severity": "Medium",
            "source": "azure-resources/Cdn/profiles/recommendations.yaml",
            "tags": null,
            "text": "Secure your Origin with Private Link in Azure Front Door"
        },
        {
            "aprlGuid": "b49a39fd-f431-4b61-9062-f2157849d845",
            "automationAvailable": "arg",
            "category": "High Availability",
            "description": "Keeping a minimum of 3 replicas for production images in Azure's Compute Gallery ensures scalability and prevents throttling in multi-VM deployments by distributing VM deployments across different replicas. This reduces the risk of overloading a single replica.\n",
            "graph": "// Azure Resource Graph Query\n// Query to list all image versions,its associated image name and version replica configurations per region in a compute gallery whose version replicas is less than 3\nresources\n| where type =~ \"microsoft.compute/galleries/images/versions\"\n| extend GalleryName = tostring(split(tostring(id), \"/\")[8]), ImageName = tostring(split(tostring(id), \"/\")[10])\n| mv-expand VersionReplicas = properties.publishingProfile.targetRegions\n| project RecommendationId=\"b49a39fd-f431-4b61-9062-f2157849d845\",name,id,tags,param1=strcat(\"GalleryName: \",GalleryName),param2=strcat(\"ImageName: \",ImageName),param3=strcat(\"VersionReplicaRegionName: \",VersionReplicas.name),param4=strcat(\"VersionReplicationCount: \",VersionReplicas.regionalReplicaCount),rc=toint(VersionReplicas.regionalReplicaCount)\n| where rc < 3\n| project-away rc\n\n",
            "guid": "b49a39fd-f431-4b61-9062-f2157849d845",
            "learnMoreLink": [
                {
                    "name": "Compute Gallery best practices",
                    "url": "https://learn.microsoft.com/en-us/azure/virtual-machines/azure-compute-gallery#best-practices"
                }
            ],
            "longDescription": "Keeping a minimum of 3 replicas for production images in Azure's Compute Gallery ensures scalability and prevents throttling in multi-VM deployments by distributing VM deployments across different replicas. This reduces the risk of overloading a single replica.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhances scalability and avoids throttling",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Compute/galleries",
            "recommendationTypeId": null,
            "service": "Microsoft.Compute/galleries",
            "severity": "Medium",
            "source": "azure-resources/Compute/galleries/recommendations.yaml",
            "tags": null,
            "text": "A minimum of three replicas should be kept for production image versions"
        },
        {
            "aprlGuid": "488dcc8b-f2e3-40ce-bf95-73deb2db095f",
            "automationAvailable": "arg",
            "category": "High Availability",
            "description": "Use ZRS for high availability when creating image/VM versions in Azure Compute Gallery, offering resilience against Availability Zone failures. ZRS accounts are advisable in regions with Availability Zones, with the choice of Standard_ZRS recommended over Standard_LRS for these regions.\n",
            "graph": "// Azure Resource Graph Query\n// Query to list all image versions and its associated image and gallery name whose Storage account type is not using ZRS\nresources\n| where type =~ \"microsoft.compute/galleries/images/versions\"\n| extend GalleryName = tostring(split(tostring(id), \"/\")[8]), ImageName = tostring(split(tostring(id), \"/\")[10])\n| extend StorageAccountType = tostring(properties.publishingProfile.storageAccountType)\n| where StorageAccountType !has \"ZRS\"\n| project RecommendationId=\"488dcc8b-f2e3-40ce-bf95-73deb2db095f\",name,id,tags,param1=strcat(\"GalleryName: \",GalleryName),param2=strcat(\"ImageName: \",ImageName),param3=strcat(\"StorageAccountType: \",StorageAccountType)\n\n",
            "guid": "488dcc8b-f2e3-40ce-bf95-73deb2db095f",
            "learnMoreLink": [
                {
                    "name": "Compute Gallery best practices",
                    "url": "https://learn.microsoft.com/en-us/azure/virtual-machines/azure-compute-gallery#best-practices"
                },
                {
                    "name": "Zone-redundant storage",
                    "url": "https://learn.microsoft.com/en-us/azure/storage/common/storage-redundancy#zone-redundant-storage"
                }
            ],
            "longDescription": "Use ZRS for high availability when creating image/VM versions in Azure Compute Gallery, offering resilience against Availability Zone failures. ZRS accounts are advisable in regions with Availability Zones, with the choice of Standard_ZRS recommended over Standard_LRS for these regions.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhances image version availability",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Compute/galleries",
            "recommendationTypeId": null,
            "service": "Microsoft.Compute/galleries",
            "severity": "Medium",
            "source": "azure-resources/Compute/galleries/recommendations.yaml",
            "tags": null,
            "text": "Zone redundant storage should be used for image versions"
        },
        {
            "aprlGuid": "1c5e1e58-4e56-491c-8529-10f37af9d4ed",
            "automationAvailable": "arg",
            "category": "High Availability",
            "description": "We recommend creating Trusted Launch Supported Images for benefits like Secure Boot, vTPM, trusted launch VMs, large boot volume. These are Gen 2 Images by default and you cannot change a VM's generation after creation, so review the considerations first.\n",
            "graph": "// Azure Resource Graph Query\n// Query to list all images whose Hyper-V generation is not V2\nresources\n| where type =~ \"microsoft.compute/galleries/images\"\n| extend VMGeneration = properties.hyperVGeneration\n| where VMGeneration <> 'V2'\n| project RecommendationId=\"1c5e1e58-4e56-491c-8529-10f37af9d4ed\",name,id,tags,param1=strcat(\"VMGeneration: \",VMGeneration)\n\n",
            "guid": "1c5e1e58-4e56-491c-8529-10f37af9d4ed",
            "learnMoreLink": [
                {
                    "name": "Compute Gallery best practices",
                    "url": "https://learn.microsoft.com/en-us/azure/virtual-machines/azure-compute-gallery#best-practices"
                },
                {
                    "name": "Generation 1 vs Generation 2 in Hyper-V",
                    "url": "https://learn.microsoft.com/en-us/windows-server/virtualization/hyper-v/plan/should-i-create-a-generation-1-or-2-virtual-machine-in-hyper-v"
                },
                {
                    "name": "Images in Compute gallery",
                    "url": "https://learn.microsoft.com/en-us/azure/virtual-machines/shared-image-galleries?tabs=azure-cli"
                }
            ],
            "longDescription": "We recommend creating Trusted Launch Supported Images for benefits like Secure Boot, vTPM, trusted launch VMs, large boot volume. These are Gen 2 Images by default and you cannot change a VM's generation after creation, so review the considerations first.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhances VM security and features",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "Low",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Compute/galleries",
            "recommendationTypeId": null,
            "service": "Microsoft.Compute/galleries",
            "severity": "Low",
            "source": "azure-resources/Compute/galleries/recommendations.yaml",
            "tags": null,
            "text": "Consider creating TrustedLaunchSupported images where possible"
        },
        {
            "aprlGuid": "e7495e1c-0c75-0946-b266-b429b5c7f3bf",
            "automationAvailable": "arg",
            "category": "Scalability",
            "description": "Deploying even single instance VMs into a scale set with Flexible orchestration mode future-proofs applications for scaling and availability. This mode guarantees high availability (up to 1000 VMs) by distributing VMs across fault domains in a region or within an Availability Zone.\n",
            "graph": "// Azure Resource Graph Query\n// Find all zonal VMs that are NOT deployed with Flex orchestration mode\nresources\n| where type == \"microsoft.compute/virtualmachinescalesets\"\n| where properties.orchestrationMode != \"Flexible\"\n| project recommendationId = \"e7495e1c-0c75-0946-b266-b429b5c7f3bf\", name, id, tags, param1 = strcat(\"orchestrationMode: \", tostring(properties.orchestrationMode))\n\n",
            "guid": "e7495e1c-0c75-0946-b266-b429b5c7f3bf",
            "learnMoreLink": [
                {
                    "name": "When to use VMSS instead of VMs",
                    "url": "https://learn.microsoft.com/azure/virtual-machine-scale-sets/virtual-machine-scale-sets-design-overview#when-to-use-scale-sets-instead-of-virtual-machines"
                },
                {
                    "name": "Azure Well-Architected Framework review - Virtual Machines and Scale Sets",
                    "url": "https://learn.microsoft.com/azure/well-architected/services/compute/virtual-machines/virtual-machines-review"
                }
            ],
            "longDescription": "Deploying even single instance VMs into a scale set with Flexible orchestration mode future-proofs applications for scaling and availability. This mode guarantees high availability (up to 1000 VMs) by distributing VMs across fault domains in a region or within an Availability Zone.\n",
            "pgVerified": true,
            "potentialBenefits": "Higher scalability and availability",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Scalability",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Compute/virtualMachineScaleSets",
            "recommendationTypeId": null,
            "service": "VMSS",
            "severity": "Medium",
            "source": "azure-resources/Compute/virtualMachineScaleSets/recommendations.yaml",
            "tags": null,
            "text": "Deploy VMSS with Flex orchestration mode instead of Uniform"
        },
        {
            "aprlGuid": "94794d2a-eff0-2345-9b67-6f9349d0a627",
            "automationAvailable": "arg",
            "category": "Monitoring and Alerting",
            "description": "Monitoring application health in Azure Virtual Machine Scale Sets is crucial for deployment management. It supports rolling upgrades such as automatic OS-image upgrades and VM guest patching, leveraging health monitoring for upgrading.\n",
            "graph": "// Azure Resource Graph Query\n// Find all VMs that do NOT have health monitoring enabled\nresources\n| where type == \"microsoft.compute/virtualmachinescalesets\"\n| join kind=leftouter  (\n    resources\n    | where type == \"microsoft.compute/virtualmachinescalesets\"\n    | mv-expand extension=properties.virtualMachineProfile.extensionProfile.extensions\n    | where extension.properties.type in ( \"ApplicationHealthWindows\", \"ApplicationHealthLinux\" )\n    | project id\n) on id\n| where id1 == \"\"\n| project recommendationId = \"94794d2a-eff0-2345-9b67-6f9349d0a627\", name, id, tags, param1 = \"extension: null\"\n\n",
            "guid": "94794d2a-eff0-2345-9b67-6f9349d0a627",
            "learnMoreLink": [
                {
                    "name": "Using Application Health extension with Virtual Machine Scale Sets",
                    "url": "https://learn.microsoft.com/azure/virtual-machine-scale-sets/virtual-machine-scale-sets-health-extension?tabs=rest-api"
                }
            ],
            "longDescription": "Monitoring application health in Azure Virtual Machine Scale Sets is crucial for deployment management. It supports rolling upgrades such as automatic OS-image upgrades and VM guest patching, leveraging health monitoring for upgrading.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhances deployment management and upgrades",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Monitoring and Alerting",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Compute/virtualMachineScaleSets",
            "recommendationTypeId": "3b587048-b04b-4f81-aaed-e43793652b0f",
            "service": "VMSS",
            "severity": "Medium",
            "source": "azure-resources/Compute/virtualMachineScaleSets/recommendations.yaml",
            "tags": null,
            "text": "Enable Azure Virtual Machine Scale Set Application Health Monitoring"
        },
        {
            "aprlGuid": "820f4743-1f94-e946-ae0b-45efafd87962",
            "automationAvailable": "arg",
            "category": "High Availability",
            "description": "Enabling automatic instance repairs in Azure Virtual Machine Scale Sets enhances application availability through a continuous health check and maintenance process.\n",
            "graph": "// Azure Resource Graph Query\n// Find all VMs that do NOT have automatic repair policy enabled\nresources\n| where type == \"microsoft.compute/virtualmachinescalesets\"\n| where properties.automaticRepairsPolicy.enabled == false\n| project recommendationId = \"820f4743-1f94-e946-ae0b-45efafd87962\", name, id, tags, param1 = \"automaticRepairsPolicy: Disabled\"\n\n",
            "guid": "820f4743-1f94-e946-ae0b-45efafd87962",
            "learnMoreLink": [
                {
                    "name": "Automatic instance repairs for Azure Virtual Machine Scale Sets",
                    "url": "https://learn.microsoft.com/azure/virtual-machine-scale-sets/virtual-machine-scale-sets-automatic-instance-repairs#requirements-for-using-automatic-instance-repairs"
                }
            ],
            "longDescription": "Enabling automatic instance repairs in Azure Virtual Machine Scale Sets enhances application availability through a continuous health check and maintenance process.\n",
            "pgVerified": true,
            "potentialBenefits": "Boosts app availability by auto-repair",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Compute/virtualMachineScaleSets",
            "recommendationTypeId": "b4d988a9-85e6-4179-b69c-549bdd8a55bb",
            "service": "VMSS",
            "severity": "High",
            "source": "azure-resources/Compute/virtualMachineScaleSets/recommendations.yaml",
            "tags": null,
            "text": "Enable Automatic Repair Policy on Azure Virtual Machine Scale Sets"
        },
        {
            "aprlGuid": "ee66ff65-9aa3-2345-93c1-25827cf79f44",
            "automationAvailable": "arg",
            "category": "Scalability",
            "description": "Use custom autoscale for VMSS based on metrics and schedules to improve performance and cost effectiveness, adjusting instances as demand changes.\n",
            "graph": "// Azure Resource Graph Query\n// Find VMSS instances associated with autoscale settings when autoscale is disabled\nresources\n| where type == \"microsoft.compute/virtualmachinescalesets\"\n| project name, id, tags\n| join kind=leftouter  (\n    resources\n    | where type == \"microsoft.insights/autoscalesettings\"\n    | where tostring(properties.targetResourceUri) contains \"Microsoft.Compute/virtualMachineScaleSets\"\n    | project id = tostring(properties.targetResourceUri), autoscalesettings = properties\n) on id\n| where isnull(autoscalesettings) or autoscalesettings.enabled == \"false\"\n| project recommendationId = \"ee66ff65-9aa3-2345-93c1-25827cf79f44\", name, id, tags, param1 = \"autoscalesettings: Disabled\"\n| order by id asc\n\n",
            "guid": "ee66ff65-9aa3-2345-93c1-25827cf79f44",
            "learnMoreLink": [
                {
                    "name": "Get started with autoscale in Azure",
                    "url": "https://learn.microsoft.com/azure/azure-monitor/autoscale/autoscale-get-started?WT.mc_id=Portal-Microsoft_Azure_Monitoring"
                },
                {
                    "name": "Overview of autoscale in Azure",
                    "url": "https://learn.microsoft.com/azure/azure-monitor/autoscale/autoscale-overview"
                }
            ],
            "longDescription": "Use custom autoscale for VMSS based on metrics and schedules to improve performance and cost effectiveness, adjusting instances as demand changes.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhances performance and cost-efficiency",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Scalability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Compute/virtualMachineScaleSets",
            "recommendationTypeId": null,
            "service": "VMSS",
            "severity": "High",
            "source": "azure-resources/Compute/virtualMachineScaleSets/recommendations.yaml",
            "tags": null,
            "text": "Configure VMSS Autoscale to custom and configure the scaling metrics"
        },
        {
            "aprlGuid": "3f85a51c-e286-9f44-b4dc-51d00768696c",
            "automationAvailable": "arg",
            "category": "Scalability",
            "description": "Predictive autoscale utilizes machine learning to efficiently manage and scale Azure Virtual Machine Scale Sets by forecasting CPU load through historical usage analysis, ensuring timely scale-out to meet demand.\n",
            "graph": "// Azure Resource Graph Query\n// Find VMSS instances associated with autoscale settings when predictiveAutoscalePolicy_scaleMode is disabled\nresources\n| where type == \"microsoft.compute/virtualmachinescalesets\"\n| project name, id, tags\n| join kind=leftouter  (\n    resources\n    | where type == \"microsoft.insights/autoscalesettings\"\n    | where tostring(properties.targetResourceUri) contains \"Microsoft.Compute/virtualMachineScaleSets\"\n    | project id = tostring(properties.targetResourceUri), autoscalesettings = properties\n) on id\n| where autoscalesettings.enabled == \"true\" and autoscalesettings.predictiveAutoscalePolicy.scaleMode == \"Disabled\"\n| project recommendationId = \"3f85a51c-e286-9f44-b4dc-51d00768696c\", name, id, tags, param1 = \"predictiveAutoscalePolicy_scaleMode: Disabled\"\n| order by id asc\n\n",
            "guid": "3f85a51c-e286-9f44-b4dc-51d00768696c",
            "learnMoreLink": [
                {
                    "name": "Use predictive autoscale to scale out before load demands in virtual machine scale sets",
                    "url": "https://learn.microsoft.com/azure/azure-monitor/autoscale/autoscale-predictive"
                }
            ],
            "longDescription": "Predictive autoscale utilizes machine learning to efficiently manage and scale Azure Virtual Machine Scale Sets by forecasting CPU load through historical usage analysis, ensuring timely scale-out to meet demand.\n",
            "pgVerified": true,
            "potentialBenefits": "Optimizes scaling with ML predictions",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Scalability",
            "recommendationImpact": "Low",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Compute/virtualMachineScaleSets",
            "recommendationTypeId": null,
            "service": "VMSS",
            "severity": "Low",
            "source": "azure-resources/Compute/virtualMachineScaleSets/recommendations.yaml",
            "tags": null,
            "text": "Enable Predictive autoscale and configure at least for Forecast Only"
        },
        {
            "aprlGuid": "b5a63aa0-c58e-244f-b8a6-cbba0560a6db",
            "automationAvailable": "arg",
            "category": "High Availability",
            "description": "Microsoft advises disabling strictly even VM instance distribution across Availability Zones in VMSS to improve scalability and flexibility, noting that uneven distribution may better serve application load demands despite the potential trade-off in resilience.\n",
            "graph": "// Azure Resource Graph Query\n// Find VMSS instances where strictly zoneBalance is set to True\nresources\n| where type == \"microsoft.compute/virtualmachinescalesets\"\n| where properties.orchestrationMode == \"Uniform\" and properties.zoneBalance == true\n| project recommendationId = \"b5a63aa0-c58e-244f-b8a6-cbba0560a6db\", name, id, tags, param1 = \"strictly zoneBalance: Enabled\"\n| order by id asc\n\n",
            "guid": "b5a63aa0-c58e-244f-b8a6-cbba0560a6db",
            "learnMoreLink": [
                {
                    "name": "Use scale-in policies with Azure Virtual Machine Scale Sets",
                    "url": "https://learn.microsoft.com/azure/virtual-machine-scale-sets/virtual-machine-scale-sets-scale-in-policy"
                }
            ],
            "longDescription": "Microsoft advises disabling strictly even VM instance distribution across Availability Zones in VMSS to improve scalability and flexibility, noting that uneven distribution may better serve application load demands despite the potential trade-off in resilience.\n",
            "pgVerified": true,
            "potentialBenefits": "Improves scaling, reduces fail attempts",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Compute/virtualMachineScaleSets",
            "recommendationTypeId": null,
            "service": "VMSS",
            "severity": "High",
            "source": "azure-resources/Compute/virtualMachineScaleSets/recommendations.yaml",
            "tags": null,
            "text": "Disable Force strictly even balance across zones to avoid scale in and out fail attempts"
        },
        {
            "aprlGuid": "1422c567-782c-7148-ac7c-5fc14cf45adc",
            "automationAvailable": "arg",
            "category": "High Availability",
            "description": "When creating VMSS, implement availability zones as a protection measure for your applications and data against the rare event of datacenter failure.\n",
            "graph": "// Azure Resource Graph Query\n// Find VMSS instances with one or no Zones selected\nresources\n| where type == \"microsoft.compute/virtualmachinescalesets\"\n| where array_length(zones) <= 1 or isnull(zones)\n| project recommendationId = \"1422c567-782c-7148-ac7c-5fc14cf45adc\", name, id, tags, param1 = \"AvailabilityZones: Single Zone\"\n| order by id asc\n\n",
            "guid": "1422c567-782c-7148-ac7c-5fc14cf45adc",
            "learnMoreLink": [
                {
                    "name": "Create a Virtual Machine Scale Set that uses Availability Zones",
                    "url": "https://learn.microsoft.com/azure/virtual-machine-scale-sets/virtual-machine-scale-sets-use-availability-zones"
                },
                {
                    "name": "Update scale set to add availability zones",
                    "url": "https://learn.microsoft.com/azure/virtual-machine-scale-sets/virtual-machine-scale-sets-use-availability-zones?tabs=cli-1%2Cportal-2#update-scale-set-to-add-availability-zones"
                }
            ],
            "longDescription": "When creating VMSS, implement availability zones as a protection measure for your applications and data against the rare event of datacenter failure.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhances disaster resilience",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Compute/virtualMachineScaleSets",
            "recommendationTypeId": null,
            "service": "VMSS",
            "severity": "High",
            "source": "azure-resources/Compute/virtualMachineScaleSets/recommendations.yaml",
            "tags": null,
            "text": "Deploy VMSS across availability zones with VMSS Flex"
        },
        {
            "aprlGuid": "e4ffd7b0-ba24-c84e-9352-ba4819f908c0",
            "automationAvailable": "arg",
            "category": "Other Best Practices",
            "description": "Enabling automatic VM guest patching eases update management by safely, automatically patching virtual machines to maintain security compliance, while limiting blast radius of VMs. Note, the KQL will not return sets using Uniform orchestration.\n",
            "graph": "// Azure Resource Graph query\n// Identifies VMs and VMSS with manual patch settings, excluding automatic patch modes\nresources\n| where type == \"microsoft.compute/virtualmachinescalesets\"\n| join kind=inner (\n    resources\n    | where type == \"microsoft.compute/virtualmachines\"\n    | project id = tostring(properties.virtualMachineScaleSet.id), vmproperties = properties\n) on id\n| extend recommendationId = \"e4ffd7b0-ba24-c84e-9352-ba4819f908c0\", param1 = \"patchMode: Manual\", vmproperties.osProfile.linuxConfiguration.patchSettings.patchMode\n| where isnotnull(vmproperties.osProfile.linuxConfiguration) and vmproperties.osProfile.linuxConfiguration.patchSettings.patchMode !in (\"AutomaticByPlatform\", \"AutomaticByOS\")\n| distinct recommendationId, name, id, param1\n| union (resources\n| where type == \"microsoft.compute/virtualmachinescalesets\"\n| join kind=inner (\n    resources\n    | where type == \"microsoft.compute/virtualmachines\"\n    | project id = tostring(properties.virtualMachineScaleSet.id), vmproperties = properties\n) on id\n| extend recommendationId = \"e4ffd7b0-ba24-c84e-9352-ba4819f908c0\", param1 = \"patchMode: Manual\", vmproperties.osProfile.windowsConfiguration.patchSettings.patchMode\n| where isnotnull(vmproperties.osProfile.windowsConfiguration) and vmproperties.osProfile.windowsConfiguration.patchSettings.patchMode !in (\"AutomaticByPlatform\", \"AutomaticByOS\")\n| distinct recommendationId, name, id, param1)\n\n",
            "guid": "e4ffd7b0-ba24-c84e-9352-ba4819f908c0",
            "learnMoreLink": [
                {
                    "name": "Automatic VM Guest Patching for Azure VMs",
                    "url": "https://learn.microsoft.com/azure/virtual-machines/automatic-vm-guest-patching"
                },
                {
                    "name": "Auto OS Image Upgrades",
                    "url": "https://learn.microsoft.com/en-us/azure/virtual-machine-scale-sets/virtual-machine-scale-sets-automatic-upgrade"
                }
            ],
            "longDescription": "Enabling automatic VM guest patching eases update management by safely, automatically patching virtual machines to maintain security compliance, while limiting blast radius of VMs. Note, the KQL will not return sets using Uniform orchestration.\n",
            "pgVerified": true,
            "potentialBenefits": "Eases patch management, enhances security",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Other Best Practices",
            "recommendationImpact": "Low",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Compute/virtualMachineScaleSets",
            "recommendationTypeId": null,
            "service": "VMSS",
            "severity": "Low",
            "source": "azure-resources/Compute/virtualMachineScaleSets/recommendations.yaml",
            "tags": null,
            "text": "Set Patch orchestration options to Azure-orchestrated"
        },
        {
            "aprlGuid": "83d61669-7bd6-9642-a305-175db8adcdf4",
            "automationAvailable": false,
            "category": "Governance",
            "description": "Ensure current versions of images are in use to avoid disruption after image deprecation. Please review the publisher, offer, sku information of the VM to ensure you are running on a supported image. Enable Auto Guest Patching or Image Upgrades, to get notifications about image deprecation.\n",
            "graph": "//cannot-be-validated-with-arg\n\n",
            "guid": "83d61669-7bd6-9642-a305-175db8adcdf4",
            "learnMoreLink": [
                {
                    "name": "Deprecated Azure Marketplace images",
                    "url": "https://learn.microsoft.com/en-us/azure/virtual-machines/deprecated-images"
                }
            ],
            "longDescription": "Ensure current versions of images are in use to avoid disruption after image deprecation. Please review the publisher, offer, sku information of the VM to ensure you are running on a supported image. Enable Auto Guest Patching or Image Upgrades, to get notifications about image deprecation.\n",
            "pgVerified": true,
            "potentialBenefits": "Avoid disruptions by updating VMSS images.",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Governance",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Compute/virtualMachineScaleSets",
            "recommendationTypeId": "3b739bd1-c193-4bb6-a953-1362ee3b03b2",
            "service": "VMSS",
            "severity": "High",
            "source": "azure-resources/Compute/virtualMachineScaleSets/recommendations.yaml",
            "tags": null,
            "text": "Upgrade VMSS Image versions scheduled to be deprecated or already retired"
        },
        {
            "aprlGuid": "273f6b30-68e0-4241-85ea-acf15ffb60bf",
            "automationAvailable": "arg",
            "category": "High Availability",
            "description": "Production VM workloads should be deployed on multiple VMs and grouped in a VMSS Flex instance to intelligently distribute across the platform, minimizing the impact of platform faults and updates.\n",
            "graph": "// Azure Resource Graph Query\n// Find all VMs that are not associated with a VMSS Flex instance\nresources\n| where type =~ 'Microsoft.Compute/virtualMachines'\n| where isnull(properties.virtualMachineScaleSet.id)\n| project recommendationId=\"273f6b30-68e0-4241-85ea-acf15ffb60bf\", name, id, tags\n\n",
            "guid": "273f6b30-68e0-4241-85ea-acf15ffb60bf",
            "learnMoreLink": [
                {
                    "name": "What has changed with Flexible orchestration mode",
                    "url": "https://learn.microsoft.com/azure/virtual-machine-scale-sets/virtual-machine-scale-sets-orchestration-modes#what-has-changed-with-flexible-orchestration-mode"
                },
                {
                    "name": "Attach or detach a Virtual Machine to or from a Virtual Machine Scale Set",
                    "url": "https://learn.microsoft.com/azure/virtual-machine-scale-sets/virtual-machine-scale-sets-attach-detach-vm?branch=main&tabs=portal-1%2Cportal-2%2Cportal-3"
                }
            ],
            "longDescription": "Production VM workloads should be deployed on multiple VMs and grouped in a VMSS Flex instance to intelligently distribute across the platform, minimizing the impact of platform faults and updates.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhanced fault/update resilience",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Compute/virtualMachines",
            "recommendationTypeId": null,
            "service": "VM",
            "severity": "High",
            "source": "azure-resources/Compute/virtualMachines/recommendations.yaml",
            "tags": null,
            "text": "Run production workloads on two or more VMs using VMSS Flex"
        },
        {
            "aprlGuid": "2bd0be95-a825-6f47-a8c6-3db1fb5eb387",
            "automationAvailable": "arg",
            "category": "High Availability",
            "description": "Azure Availability Zones, within each Azure region, are tolerant to local failures, protecting applications and data against unlikely Datacenter failures by being physically separate.\n",
            "graph": "// Azure Resource Graph Query\n// Find all VMs that are not assigned to a Zone\nResources\n| where type =~ 'Microsoft.Compute/virtualMachines'\n| where isnull(zones)\n| project recommendationId=\"2bd0be95-a825-6f47-a8c6-3db1fb5eb387\", name, id, tags, param1=\"No Zone\"\n\n",
            "guid": "2bd0be95-a825-6f47-a8c6-3db1fb5eb387",
            "learnMoreLink": [
                {
                    "name": "Create virtual machines in an availability zone using the Azure portal",
                    "url": "https://learn.microsoft.com/azure/virtual-machines/create-portal-availability-zone?tabs=standard"
                }
            ],
            "longDescription": "Azure Availability Zones, within each Azure region, are tolerant to local failures, protecting applications and data against unlikely Datacenter failures by being physically separate.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhanced VM resilience to failures",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Compute/virtualMachines",
            "recommendationTypeId": "066a047a-9ace-45f4-ac50-6325840a6b00",
            "service": "VM",
            "severity": "High",
            "source": "azure-resources/Compute/virtualMachines/recommendations.yaml",
            "tags": null,
            "text": "Deploy VMs across Availability Zones"
        },
        {
            "aprlGuid": "a8d25876-7951-b646-b4e8-880c9031596b",
            "automationAvailable": "arg",
            "category": "High Availability",
            "description": "Availability sets will soon be retired. Migrate workloads from VMs to VMSS Flex for deployment across zones or within the same zone across different fault domains (FDs) and update domains (UDs) for better reliability.\n",
            "graph": "// Azure Resource Graph Query\n// Find all VMs using Availability Sets\nresources\n| where type =~ 'Microsoft.Compute/virtualMachines'\n| where isnotnull(properties.availabilitySet)\n| project recommendationId = \"a8d25876-7951-b646-b4e8-880c9031596b\", name, id, tags, param1=strcat(\"availabilitySet: \",properties.availabilitySet.id)\n\n",
            "guid": "a8d25876-7951-b646-b4e8-880c9031596b",
            "learnMoreLink": [
                {
                    "name": "Resiliency checklist for Virtual Machines",
                    "url": "https://learn.microsoft.com/azure/architecture/checklist/resiliency-per-service#virtual-machines"
                }
            ],
            "longDescription": "Availability sets will soon be retired. Migrate workloads from VMs to VMSS Flex for deployment across zones or within the same zone across different fault domains (FDs) and update domains (UDs) for better reliability.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhances reliability and future-proofs VMs",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Compute/virtualMachines",
            "recommendationTypeId": null,
            "service": "VM",
            "severity": "High",
            "source": "azure-resources/Compute/virtualMachines/recommendations.yaml",
            "tags": null,
            "text": "Migrate VMs using availability sets to VMSS Flex"
        },
        {
            "aprlGuid": "cfe22a65-b1db-fd41-9e8e-d573922709ae",
            "automationAvailable": "arg",
            "category": "Disaster Recovery",
            "description": "Replicating Azure VMs via Site Recovery entails continuous, asynchronous disk replication to a target region. Recovery points are generated every few minutes, ensuring a Recovery Point Objective (RPO) in minutes.\n",
            "graph": "// Azure Resource Graph Query\n// Find all VMs that do NOT have replication with ASR enabled\nresources\n| where type =~ \"Microsoft.Compute/virtualMachines\"\n| extend securityType = iif(isnull(properties.securityProfile.securityType), \"Standard\", properties.securityProfile.securityType)\n| where securityType !in~ (\"TrustedLaunch\", \"ConfidentialVM\")\n| project id, vmIdForJoin = tolower(id), name, tags\n| join kind = leftouter (\n    recoveryservicesresources\n    | where type =~ \"Microsoft.RecoveryServices/vaults/replicationFabrics/replicationProtectionContainers/replicationProtectedItems\"\n        and properties.providerSpecificDetails.dataSourceInfo.datasourceType =~ \"AzureVm\"\n    | project vmResourceId = tolower(properties.providerSpecificDetails.dataSourceInfo.resourceId)\n    )\n    on $left.vmIdForJoin == $right.vmResourceId\n| where isempty(vmResourceId)\n| project recommendationId = \"cfe22a65-b1db-fd41-9e8e-d573922709ae\", name, id, tags\n",
            "guid": "cfe22a65-b1db-fd41-9e8e-d573922709ae",
            "learnMoreLink": [
                {
                    "name": "Resiliency checklist for Virtual Machines",
                    "url": "https://learn.microsoft.com/azure/architecture/checklist/resiliency-per-service#virtual-machines"
                },
                {
                    "name": "Run a test failover (disaster recovery drill) to Azure",
                    "url": "https://learn.microsoft.com/azure/site-recovery/site-recovery-test-failover-to-azure"
                }
            ],
            "longDescription": "Replicating Azure VMs via Site Recovery entails continuous, asynchronous disk replication to a target region. Recovery points are generated every few minutes, ensuring a Recovery Point Objective (RPO) in minutes.\n",
            "pgVerified": true,
            "potentialBenefits": "Minimize downtime in disasters",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Disaster Recovery",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Compute/virtualMachines",
            "recommendationTypeId": "ed651749-cd37-4fd5-9897-01b416926745",
            "service": "VM",
            "severity": "Medium",
            "source": "azure-resources/Compute/virtualMachines/recommendations.yaml",
            "tags": null,
            "text": "Replicate VMs using Azure Site Recovery"
        },
        {
            "aprlGuid": "122d11d7-b91f-8747-a562-f56b79bcfbdc",
            "automationAvailable": "arg",
            "category": "High Availability",
            "description": "Azure is retiring unmanaged disks on September 30, 2025. Users should plan the migration to avoid disruptions and maintain service reliability.\n",
            "graph": "// Azure Resource Graph Query\n// Find all VMs that are not using Managed Disks\nResources\n| where type =~ 'Microsoft.Compute/virtualMachines'\n| where isnull(properties.storageProfile.osDisk.managedDisk)\n| project recommendationId = \"122d11d7-b91f-8747-a562-f56b79bcfbdc\", name, id, tags\n\n",
            "guid": "122d11d7-b91f-8747-a562-f56b79bcfbdc",
            "learnMoreLink": [
                {
                    "name": "Migrate your Azure unmanaged disks by Sep 30, 2025",
                    "url": "https://learn.microsoft.com/azure/virtual-machines/unmanaged-disks-deprecation"
                },
                {
                    "name": "Migrate Windows VM from unmanaged disks to managed disks",
                    "url": "https://learn.microsoft.com/azure/virtual-machines/windows/convert-unmanaged-to-managed-disks"
                },
                {
                    "name": "Migrate Linux VM from unmanaged disks to managed disks",
                    "url": "https://learn.microsoft.com/azure/virtual-machines/linux/convert-unmanaged-to-managed-disks"
                }
            ],
            "longDescription": "Azure is retiring unmanaged disks on September 30, 2025. Users should plan the migration to avoid disruptions and maintain service reliability.\n",
            "pgVerified": true,
            "potentialBenefits": "Avoid retirement disruption, enhance reliability",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Compute/virtualMachines",
            "recommendationTypeId": "57ecb3cd-f2b4-4cad-8b3a-232cca527a0b",
            "service": "VM",
            "severity": "High",
            "source": "azure-resources/Compute/virtualMachines/recommendations.yaml",
            "tags": null,
            "text": "Use Managed Disks for VM disks"
        },
        {
            "aprlGuid": "4ea2878f-0d69-8d4a-b715-afc10d1e538e",
            "automationAvailable": "arg",
            "category": "Scalability",
            "description": "A data disk is a managed disk attached to a virtual machine for storing database or other essential data. These disks are SCSI drives labeled as per choice.\n",
            "graph": "// Azure Resource Graph Query\n// Find all VMs that only have OS Disk\nResources\n| where type =~ 'Microsoft.Compute/virtualMachines'\n| where array_length(properties.storageProfile.dataDisks) < 1\n| project recommendationId = \"4ea2878f-0d69-8d4a-b715-afc10d1e538e\", name, id, tags\n\n",
            "guid": "4ea2878f-0d69-8d4a-b715-afc10d1e538e",
            "learnMoreLink": [
                {
                    "name": "Introduction to Azure managed disks - Data disks",
                    "url": "https://learn.microsoft.com/azure/virtual-machines/managed-disks-overview#data-disk"
                },
                {
                    "name": "Azure managed disk types",
                    "url": "https://learn.microsoft.com/azure/virtual-machines/disks-types"
                }
            ],
            "longDescription": "A data disk is a managed disk attached to a virtual machine for storing database or other essential data. These disks are SCSI drives labeled as per choice.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhances performance, recovery, migration flexibility",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Scalability",
            "recommendationImpact": "Low",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Compute/virtualMachines",
            "recommendationTypeId": null,
            "service": "VM",
            "severity": "Low",
            "source": "azure-resources/Compute/virtualMachines/recommendations.yaml",
            "tags": null,
            "text": "Host database data on a data disk"
        },
        {
            "aprlGuid": "1981f704-97b9-b645-9c57-33f8ded9261a",
            "automationAvailable": "arg",
            "category": "Disaster Recovery",
            "description": "Enable backups for your virtual machines with Azure Backup to secure and quickly recover your data. This service offers simple, secure, and cost-effective solutions for backing up and recovering data from the Microsoft Azure cloud.\n",
            "graph": "// Azure Resource Graph Query\n// Find all VMs that do NOT have Backup enabled\n// Run query to see results.\nresources\n| where type =~ 'Microsoft.Compute/virtualMachines'\n| project name, id, tags\n| join kind=leftouter (\n    recoveryservicesresources\n    | where type =~ 'Microsoft.RecoveryServices/vaults/backupFabrics/protectionContainers/protectedItems'\n    | where properties.dataSourceInfo.datasourceType =~ 'Microsoft.Compute/virtualMachines'\n    | project idBackupEnabled=properties.sourceResourceId\n    | extend name=strcat_array(array_slice(split(idBackupEnabled, '/'), 8, -1), '/')\n) on name\n| where isnull(idBackupEnabled)\n| project-away idBackupEnabled\n| project-away name1\n| project recommendationId = \"1981f704-97b9-b645-9c57-33f8ded9261a\", name, id, tags\n| order by id asc\n\n",
            "guid": "1981f704-97b9-b645-9c57-33f8ded9261a",
            "learnMoreLink": [
                {
                    "name": "What is the Azure Backup service?",
                    "url": "https://learn.microsoft.com/azure/backup/backup-overview"
                }
            ],
            "longDescription": "Enable backups for your virtual machines with Azure Backup to secure and quickly recover your data. This service offers simple, secure, and cost-effective solutions for backing up and recovering data from the Microsoft Azure cloud.\n",
            "pgVerified": true,
            "potentialBenefits": "Secure data recovery and backup",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Disaster Recovery",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Compute/virtualMachines",
            "recommendationTypeId": "651c7925-17a3-42e5-85cd-73bd095cf27f",
            "service": "VM",
            "severity": "Medium",
            "source": "azure-resources/Compute/virtualMachines/recommendations.yaml",
            "tags": null,
            "text": "Backup VMs with Azure Backup service"
        },
        {
            "aprlGuid": "98b334c0-8578-6046-9e43-b6e8fce6318e",
            "automationAvailable": "arg",
            "category": "Governance",
            "description": "Azure Virtual Machines (VM) instances have various states, like provisioning and power states. A non-running VM may indicate issues or it being unnecessary, suggesting removal could help cut costs.\n",
            "graph": "// Azure Resource Graph Query\n// Find all VMs that are NOT running\nResources\n| where type =~ 'Microsoft.Compute/virtualMachines'\n| where properties.extended.instanceView.powerState.displayStatus != 'VM running'\n| project recommendationId = \"98b334c0-8578-6046-9e43-b6e8fce6318e\", name, id, tags\n\n",
            "guid": "98b334c0-8578-6046-9e43-b6e8fce6318e",
            "learnMoreLink": [
                {
                    "name": "States and billing status of Azure Virtual Machines",
                    "url": "https://learn.microsoft.com/azure/virtual-machines/states-billing?context=%2Ftroubleshoot%2Fazure%2Fvirtual-machines%2Fcontext%2Fcontext#power-states-and-billing"
                }
            ],
            "longDescription": "Azure Virtual Machines (VM) instances have various states, like provisioning and power states. A non-running VM may indicate issues or it being unnecessary, suggesting removal could help cut costs.\n",
            "pgVerified": true,
            "potentialBenefits": "Reduce costs by removing unused VMs",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Governance",
            "recommendationImpact": "Low",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Compute/virtualMachines",
            "recommendationTypeId": null,
            "service": "VM",
            "severity": "Low",
            "source": "azure-resources/Compute/virtualMachines/recommendations.yaml",
            "tags": null,
            "text": "Review VMs in stopped state"
        },
        {
            "aprlGuid": "dfedbeb1-1519-fc47-86a5-52f96cf07105",
            "automationAvailable": "arg",
            "category": "Scalability",
            "description": "Accelerated networking enables SR-IOV to a VM, greatly improving its networking performance by bypassing the host from the data path, which reduces latency, jitter, and CPU utilization for demanding network workloads on supported VM types.\n",
            "graph": "// Azure Resource Graph Query\n// Find all VM NICs that do not have Accelerated Networking enabled\nresources\n| where type =~ 'Microsoft.Compute/virtualMachines'\n| mv-expand nic = properties.networkProfile.networkInterfaces\n| project name, id, tags, lowerCaseNicId = tolower(nic.id), vmSize = tostring(properties.hardwareProfile.vmSize)\n| join kind = inner (\n    resources\n    | where type =~ 'Microsoft.Network/networkInterfaces'\n    | where properties.enableAcceleratedNetworking == false\n    | project nicName = split(id, \"/\")[8], lowerCaseNicId = tolower(id)\n    )\n    on lowerCaseNicId\n| summarize nicNames = make_set(nicName) by name, id, tostring(tags), vmSize\n| extend param1 = strcat(\"NicName: \", strcat_array(nicNames, \", \")), param2 = strcat(\"VMSize: \", vmSize)\n| project recommendationId = \"dfedbeb1-1519-fc47-86a5-52f96cf07105\", name, id, tags, param1, param2\n| order by id asc\n\n",
            "guid": "dfedbeb1-1519-fc47-86a5-52f96cf07105",
            "learnMoreLink": [
                {
                    "name": "Accelerated Networking (AccelNet) overview",
                    "url": "https://learn.microsoft.com/azure/virtual-network/accelerated-networking-overview"
                }
            ],
            "longDescription": "Accelerated networking enables SR-IOV to a VM, greatly improving its networking performance by bypassing the host from the data path, which reduces latency, jitter, and CPU utilization for demanding network workloads on supported VM types.\n",
            "pgVerified": true,
            "potentialBenefits": "Reduces latency, jitter and CPU use",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Scalability",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Compute/virtualMachines",
            "recommendationTypeId": "3a3c1a2a-8597-4d3a-981a-0a24a0ee9de4",
            "service": "VM",
            "severity": "Medium",
            "source": "azure-resources/Compute/virtualMachines/recommendations.yaml",
            "tags": null,
            "text": "Enable Accelerated Networking (AccelNet)"
        },
        {
            "aprlGuid": "73d1bb04-7d3e-0d47-bc0d-63afe773b5fe",
            "automationAvailable": false,
            "category": "Governance",
            "description": "When Accelerated Networking is enabled, the default Azure VNet interface in GuestOS is swapped for a Mellanox, and its driver comes from a 3rd party. Marketplace images have the latest Mellanox drivers, but post-deployment, updating the driver is the user's responsibility.\n",
            "graph": "// cannot-be-validated-with-arg\n\n",
            "guid": "73d1bb04-7d3e-0d47-bc0d-63afe773b5fe",
            "learnMoreLink": [
                {
                    "name": "Accelerated Networking (AccelNet) overview",
                    "url": "https://learn.microsoft.com/azure/virtual-network/accelerated-networking-overview"
                }
            ],
            "longDescription": "When Accelerated Networking is enabled, the default Azure VNet interface in GuestOS is swapped for a Mellanox, and its driver comes from a 3rd party. Marketplace images have the latest Mellanox drivers, but post-deployment, updating the driver is the user's responsibility.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhanced VM network efficiency",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Governance",
            "recommendationImpact": "Low",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Compute/virtualMachines",
            "recommendationTypeId": null,
            "service": "VM",
            "severity": "Low",
            "source": "azure-resources/Compute/virtualMachines/recommendations.yaml",
            "tags": null,
            "text": "When AccelNet is enabled, you must manually update the GuestOS NIC driver"
        },
        {
            "aprlGuid": "1f629a30-c9d0-d241-82ee-6f2eb9d42cb4",
            "automationAvailable": "arg",
            "category": "Security",
            "description": "For outbound internet connectivity of Virtual Machines, using NAT Gateway or Azure Firewall is recommended to enhance security and service resilience, thanks to their higher availability and SNAT ports.\n",
            "graph": "// Azure Resource Graph Query\n// Find all VMs with PublicIPs directly associated with them\nResources\n| where type =~ 'Microsoft.Compute/virtualMachines'\n| where isnotnull(properties.networkProfile.networkInterfaces)\n| mv-expand nic=properties.networkProfile.networkInterfaces\n| project name, id, tags, nicId = nic.id\n| extend nicId = tostring(nicId)\n| join kind=inner (\n    Resources\n    | where type =~ 'Microsoft.Network/networkInterfaces'\n    | where isnotnull(properties.ipConfigurations)\n    | mv-expand ipconfig=properties.ipConfigurations\n    | extend publicIp = tostring(ipconfig.properties.publicIPAddress.id)\n    | where publicIp != \"\"\n    | project name, nicId = tostring(id), publicIp\n) on nicId\n| project recommendationId = \"1f629a30-c9d0-d241-82ee-6f2eb9d42cb4\", name, id, tags\n| order by id asc\n\n",
            "guid": "1f629a30-c9d0-d241-82ee-6f2eb9d42cb4",
            "learnMoreLink": [
                {
                    "name": "Use Source Network Address Translation (SNAT) for outbound connections",
                    "url": "https://learn.microsoft.com/azure/load-balancer/load-balancer-outbound-connections"
                }
            ],
            "longDescription": "For outbound internet connectivity of Virtual Machines, using NAT Gateway or Azure Firewall is recommended to enhance security and service resilience, thanks to their higher availability and SNAT ports.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhanced security and service resiliency",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Security",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Compute/virtualMachines",
            "recommendationTypeId": null,
            "service": "VM",
            "severity": "Medium",
            "source": "azure-resources/Compute/virtualMachines/recommendations.yaml",
            "tags": null,
            "text": "VMs should not have a Public IP directly associated"
        },
        {
            "aprlGuid": "82b3cf6b-9ae2-2e44-b193-10793213f676",
            "automationAvailable": "arg",
            "category": "Security",
            "description": "Unless you have a specific reason, it's advised to associate a network security group to a subnet or a network interface, but not both, to avoid unexpected communication issues and troubleshooting due to potential rule conflicts between the two associations.\n",
            "graph": "// Azure Resource Graph Query\n// Provides a list of virtual machines and associated NICs that do have an NSG associated to them and also an NSG associated to the subnet.\nResources\n| where type =~ 'Microsoft.Network/networkInterfaces'\n| where isnotnull(properties.networkSecurityGroup)\n| mv-expand ipConfigurations = properties.ipConfigurations, nsg = properties.networkSecurityGroup\n| project nicId = tostring(id), subnetId = tostring(ipConfigurations.properties.subnet.id), nsgName=split(nsg.id, '/')[8]\n| parse kind=regex subnetId with '/virtualNetworks/' virtualNetwork '/subnets/' subnet\n    | join kind=inner (\n        Resources\n        | where type =~ 'Microsoft.Network/NetworkSecurityGroups' and isnotnull(properties.subnets)\n        | project name, resourceGroup, subnet=properties.subnets\n        | mv-expand subnet\n        | project subnetId=tostring(subnet.id)\n    ) on subnetId\n    | project nicId\n| join kind=leftouter (\n    Resources\n    | where type =~ 'Microsoft.Compute/virtualMachines'\n    | where isnotnull(properties.networkProfile.networkInterfaces)\n    | mv-expand nic=properties.networkProfile.networkInterfaces\n    | project vmName = name, vmId = id, tags, nicId = nic.id, nicName=split(nic.id, '/')[8]\n    | extend nicId = tostring(nicId)\n) on nicId\n| project recommendationId = \"82b3cf6b-9ae2-2e44-b193-10793213f676\", name=vmName, id = vmId, tags, param1 = strcat(\"nic-name=\", nicName)\n\n",
            "guid": "82b3cf6b-9ae2-2e44-b193-10793213f676",
            "learnMoreLink": [
                {
                    "name": "How network security groups filter network traffic",
                    "url": "https://learn.microsoft.com/azure/virtual-network/network-security-group-how-it-works#intra-subnet-traffic"
                }
            ],
            "longDescription": "Unless you have a specific reason, it's advised to associate a network security group to a subnet or a network interface, but not both, to avoid unexpected communication issues and troubleshooting due to potential rule conflicts between the two associations.\n",
            "pgVerified": true,
            "potentialBenefits": "Reduces communication problems",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Security",
            "recommendationImpact": "Low",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Compute/virtualMachines",
            "recommendationTypeId": null,
            "service": "VM",
            "severity": "Low",
            "source": "azure-resources/Compute/virtualMachines/recommendations.yaml",
            "tags": null,
            "text": "VM network interfaces and associated subnets both have a Network Security Group associated"
        },
        {
            "aprlGuid": "41a22a5e-5e08-9647-92d0-2ffe9ef1bdad",
            "automationAvailable": "arg",
            "category": "Security",
            "description": "IP forwarding allows a virtual machine network interface to receive and send network traffic not destined for or originating from its assigned IP addresses.\n",
            "graph": "// Azure Resource Graph Query\n// Find all VM NICs that have IPForwarding enabled. This feature is usually only required for Network Virtual Appliances\nResources\n| where type =~ 'Microsoft.Compute/virtualMachines'\n| where isnotnull(properties.networkProfile.networkInterfaces)\n| mv-expand nic=properties.networkProfile.networkInterfaces\n| project name, id, tags, nicId = nic.id\n| extend nicId = tostring(nicId)\n| join kind=inner (\n    Resources\n    | where type =~ 'Microsoft.Network/networkInterfaces'\n    | where properties.enableIPForwarding == true\n    | project nicId = tostring(id)\n) on nicId\n| project recommendationId = \"41a22a5e-5e08-9647-92d0-2ffe9ef1bdad\", name, id, tags\n| order by id asc\n\n",
            "guid": "41a22a5e-5e08-9647-92d0-2ffe9ef1bdad",
            "learnMoreLink": [
                {
                    "name": "Enable or disable IP forwarding",
                    "url": "https://learn.microsoft.com/azure/virtual-network/virtual-network-network-interface?tabs=network-interface-portal#enable-or-disable-ip-forwarding"
                }
            ],
            "longDescription": "IP forwarding allows a virtual machine network interface to receive and send network traffic not destined for or originating from its assigned IP addresses.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhances network appliance function",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Security",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Compute/virtualMachines",
            "recommendationTypeId": "c3b51c94-588b-426b-a892-24696f9e54cc",
            "service": "VM",
            "severity": "Medium",
            "source": "azure-resources/Compute/virtualMachines/recommendations.yaml",
            "tags": null,
            "text": "IP Forwarding should only be enabled for Network Virtual Appliances"
        },
        {
            "aprlGuid": "1cf8fe21-9593-1e4e-966b-779a294c0d30",
            "automationAvailable": "arg",
            "category": "Other Best Practices",
            "description": "Configure the DNS Server at the Virtual Network level to prevent any inconsistency across the environment.\n",
            "graph": "// Azure Resource Graph Query\n// Find all VM NICs that have DNS Server settings configured in any of the NICs\nResources\n| where type =~ 'Microsoft.Compute/virtualMachines'\n| where isnotnull(properties.networkProfile.networkInterfaces)\n| mv-expand nic=properties.networkProfile.networkInterfaces\n| project name, id, tags, nicId = nic.id\n| extend nicId = tostring(nicId)\n| join kind=inner (\n    Resources\n    | where type =~ 'Microsoft.Network/networkInterfaces'\n    | project name, id, dnsServers = properties.dnsSettings.dnsServers\n    | extend hasDns = array_length(dnsServers) >= 1\n    | where hasDns != 0\n    | project name, nicId = tostring(id)\n) on nicId\n| project recommendationId = \"1cf8fe21-9593-1e4e-966b-779a294c0d30\", name, id, tags\n| order by id asc\n\n",
            "guid": "1cf8fe21-9593-1e4e-966b-779a294c0d30",
            "learnMoreLink": [
                {
                    "name": "Name resolution for resources in Azure virtual networks",
                    "url": "https://learn.microsoft.com/azure/virtual-network/virtual-networks-name-resolution-for-vms-and-role-instances"
                }
            ],
            "longDescription": "Configure the DNS Server at the Virtual Network level to prevent any inconsistency across the environment.\n",
            "pgVerified": true,
            "potentialBenefits": "Ensures DNS consistency",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Other Best Practices",
            "recommendationImpact": "Low",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Compute/virtualMachines",
            "recommendationTypeId": null,
            "service": "VM",
            "severity": "Low",
            "source": "azure-resources/Compute/virtualMachines/recommendations.yaml",
            "tags": null,
            "text": "Customer DNS Servers should be configured in the Virtual Network level"
        },
        {
            "aprlGuid": "3263a64a-c256-de48-9818-afd3cbc55c2a",
            "automationAvailable": "arg",
            "category": "Other Best Practices",
            "description": "Azure shared disks let you attach a disk to multiple VMs at once for deploying or migrating clustered applications, suitable only when a disk is shared among VM cluster members.\n",
            "graph": "// Azure Resource Graph Query\n// Find all Disks configured to be Shared. This is not an indication of an issue, but if a disk with this configuration is assigned to two or more VMs without a proper disk control mechanism (like a WSFC) it can lead to data loss\nresources\n| where type =~ 'Microsoft.Compute/disks'\n| where isnotnull(properties.maxShares) and properties.maxShares >= 2\n| project id, name, tags, lowerCaseDiskId = tolower(id), diskState = tostring(properties.diskState)\n| join kind = leftouter (\n    resources\n    | where type =~ 'Microsoft.Compute/virtualMachines'\n    | project osDiskVmName = name, lowerCaseOsDiskId = tolower(properties.storageProfile.osDisk.managedDisk.id)\n    | join kind = fullouter (\n        resources\n        | where type =~ 'Microsoft.Compute/virtualMachines'\n        | mv-expand dataDisks = properties.storageProfile.dataDisks\n        | project dataDiskVmName = name, lowerCaseDataDiskId = tolower(dataDisks.managedDisk.id)\n        )\n        on $left.lowerCaseOsDiskId == $right.lowerCaseDataDiskId\n    | project lowerCaseDiskId = coalesce(lowerCaseOsDiskId, lowerCaseDataDiskId), vmName = coalesce(osDiskVmName, dataDiskVmName)\n    )\n    on lowerCaseDiskId\n| summarize vmNames = make_set(vmName) by name, id, tostring(tags), diskState\n| extend param1 = strcat(\"DiskState: \", diskState), param2 = iif(isempty(vmNames[0]), \"VMName: n/a\", strcat(\"VMName: \", strcat_array(vmNames, \", \")))\n| project recommendationId = \"3263a64a-c256-de48-9818-afd3cbc55c2a\", name, id, tags, param1, param2\n| order by id asc\n\n",
            "guid": "3263a64a-c256-de48-9818-afd3cbc55c2a",
            "learnMoreLink": [
                {
                    "name": "Azure Shared Disk Introduction",
                    "url": "https://learn.microsoft.com/azure/virtual-machines/disks-shared"
                },
                {
                    "name": "Enable Shared Disks",
                    "url": "https://learn.microsoft.com/azure/virtual-machines/disks-shared-enable?tabs=azure-portal"
                }
            ],
            "longDescription": "Azure shared disks let you attach a disk to multiple VMs at once for deploying or migrating clustered applications, suitable only when a disk is shared among VM cluster members.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhances clustered server performance",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Other Best Practices",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Compute/virtualMachines",
            "recommendationTypeId": null,
            "service": "VM",
            "severity": "Medium",
            "source": "azure-resources/Compute/virtualMachines/recommendations.yaml",
            "tags": null,
            "text": "Shared disks should only be enabled in clustered servers"
        },
        {
            "aprlGuid": "70b1d2be-e6c4-b54e-9959-b1b690f9e485",
            "automationAvailable": "arg",
            "category": "Security",
            "description": "Recommended changing to \"Disable public access and enable private access\" and creating a Private Endpoint to improve security by restricting direct public access and ensuring connections are made privately, enhancing data protection and minimizing potential external threats.\n",
            "graph": "// Azure Resource Graph Query\n// Find all Disks with \"Enable public access from all networks\" enabled\nresources\n| where type =~ 'Microsoft.Compute/disks'\n| where properties.publicNetworkAccess == \"Enabled\"\n| project id, name, tags, lowerCaseDiskId = tolower(id)\n| join kind = leftouter (\n    resources\n    | where type =~ 'Microsoft.Compute/virtualMachines'\n    | project osDiskVmName = name, lowerCaseOsDiskId = tolower(properties.storageProfile.osDisk.managedDisk.id)\n    | join kind = fullouter (\n        resources\n        | where type =~ 'Microsoft.Compute/virtualMachines'\n        | mv-expand dataDisks = properties.storageProfile.dataDisks\n        | project dataDiskVmName = name, lowerCaseDataDiskId = tolower(dataDisks.managedDisk.id)\n        )\n        on $left.lowerCaseOsDiskId == $right.lowerCaseDataDiskId\n    | project lowerCaseDiskId = coalesce(lowerCaseOsDiskId, lowerCaseDataDiskId), vmName = coalesce(osDiskVmName, dataDiskVmName)\n    )\n    on lowerCaseDiskId\n| summarize vmNames = make_set(vmName) by name, id, tostring(tags)\n| extend param1 = iif(isempty(vmNames[0]), \"VMName: n/a\", strcat(\"VMName: \", strcat_array(vmNames, \", \")))\n| project recommendationId = \"70b1d2be-e6c4-b54e-9959-b1b690f9e485\", name, id, tags, param1\n| order by id asc\n\n",
            "guid": "70b1d2be-e6c4-b54e-9959-b1b690f9e485",
            "learnMoreLink": [
                {
                    "name": "Restrict import/export access for managed disks using Azure Private Link",
                    "url": "https://learn.microsoft.com/azure/virtual-machines/disks-enable-private-links-for-import-export-portal"
                }
            ],
            "longDescription": "Recommended changing to \"Disable public access and enable private access\" and creating a Private Endpoint to improve security by restricting direct public access and ensuring connections are made privately, enhancing data protection and minimizing potential external threats.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhances VM security and privacy",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Security",
            "recommendationImpact": "Low",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Compute/virtualMachines",
            "recommendationTypeId": null,
            "service": "VM",
            "severity": "Low",
            "source": "azure-resources/Compute/virtualMachines/recommendations.yaml",
            "tags": null,
            "text": "Network access to the VM disk should be set to Disable public access and enable private access"
        },
        {
            "aprlGuid": "c42343ae-2712-2843-a285-3437eb0b28a1",
            "automationAvailable": "arg",
            "category": "Governance",
            "description": "Keeping your virtual machine (VM) secure is crucial for the applications you run. This involves using various Azure services and features to ensure secure access to your VMs and the secure storage of your data, aiming for overall security of your VM and applications.\n",
            "graph": "// Azure Resource Graph Query\n// Find all VMs in \"Non-compliant\" state with Azure Policies\npolicyresources\n| where type =~ \"Microsoft.PolicyInsights/policyStates\" and properties.resourceType =~ \"Microsoft.Compute/virtualMachines\" and properties.complianceState =~ \"NonCompliant\"\n| project\n    policyDefinitionId = tolower(properties.policyDefinitionId),\n    policyAssignmentId = tolower(properties.policyAssignmentId),\n    targetResourceId = tolower(properties.resourceId)\n// Join the policy definition details\n| join kind = leftouter (\n    policyresources\n    | where type =~ \"Microsoft.Authorization/policyDefinitions\"\n    | project policyDefinitionId = tolower(id), policyDefinitionDisplayName = properties.displayName\n    )\n    on policyDefinitionId\n| project policyDefinitionId, policyDefinitionDisplayName, policyAssignmentId, targetResourceId\n// Join the policy assignment details\n| join kind = leftouter (\n    policyresources\n    | where type =~ \"Microsoft.Authorization/policyAssignments\"\n    | project policyAssignmentId = tolower(id), policyAssignmentDisplayName = properties.displayName\n    )\n    on policyAssignmentId\n| project policyDefinitionId, policyDefinitionDisplayName, policyAssignmentId, policyAssignmentDisplayName, targetResourceId\n// Join the target resource details\n| join kind = leftouter (\n    resources\n    | where type =~ \"Microsoft.Compute/virtualMachines\"\n    | project targetResourceId = tolower(id), targetResourceIdPreservedCase = id, targetResourceName = name, targetResourceTags = tags\n    )\n    on targetResourceId\n| project\n    recommendationId = \"c42343ae-2712-2843-a285-3437eb0b28a1\",\n    name = targetResourceName,\n    id = targetResourceIdPreservedCase,\n    tags = targetResourceTags,\n    param1 = strcat(\"DefinitionName: \", policyDefinitionDisplayName),\n    param2 = strcat(\"DefinitionID: \", policyDefinitionId),\n    param3 = strcat(\"AssignmentName: \", policyAssignmentDisplayName),\n    param4 = strcat(\"AssignmentID: \", policyAssignmentId)\n",
            "guid": "c42343ae-2712-2843-a285-3437eb0b28a1",
            "learnMoreLink": [
                {
                    "name": "Policy-driven governance",
                    "url": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-principles#policy-driven-governance"
                },
                {
                    "name": "Azure Policy Regulatory Compliance controls for Azure Virtual Machines",
                    "url": "https://learn.microsoft.com/azure/virtual-machines/security-policy"
                }
            ],
            "longDescription": "Keeping your virtual machine (VM) secure is crucial for the applications you run. This involves using various Azure services and features to ensure secure access to your VMs and the secure storage of your data, aiming for overall security of your VM and applications.\n",
            "pgVerified": true,
            "potentialBenefits": "Secure VMs and applications",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Governance",
            "recommendationImpact": "Low",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Compute/virtualMachines",
            "recommendationTypeId": null,
            "service": "VM",
            "severity": "Low",
            "source": "azure-resources/Compute/virtualMachines/recommendations.yaml",
            "tags": null,
            "text": "Ensure that your VMs are compliant with Azure Policies"
        },
        {
            "aprlGuid": "f0a97179-133a-6e4f-8a49-8a44da73ffce",
            "automationAvailable": "arg",
            "category": "Security",
            "description": "Consider enabling Azure Disk Encryption (ADE) for encrypting Azure VM disks using DM-Crypt (Linux) or BitLocker (Windows). Additionally, consider Encryption at host and Confidential disk encryption for enhanced data security.\n",
            "graph": "// Azure Resource Graph Query\n// Provides a list of Azure VM disks without Azure Disk Encryption or encryption at host enabled\nresources\n| where type =~ \"microsoft.compute/disks\"\n| project diskId = id, diskName = name, vmId = tolower(managedBy), azureDiskEncryption = iff(properties.encryptionSettingsCollection.enabled == true, true, false)\n| join kind=leftouter (resources\n| where type =~ \"microsoft.compute/virtualmachines\"\n| project vmId = tolower(id), vmName = name, encryptionAtHost = iff(properties.securityProfile.encryptionAtHost == true, true, false)) on vmId\n| where not(encryptionAtHost) and not(azureDiskEncryption)\n| project recommendationId = 'f0a97179-133a-6e4f-8a49-8a44da73ffce', name = vmName, id =vmId, param1 = strcat('diskName:',diskName), param2 = strcat('azureDiskEncryption:',iff(azureDiskEncryption, \"Enabled\", \"Disabled\")), param3 = strcat('encryptionAtHost:',iff(encryptionAtHost, \"Enabled\", \"Disabled\"))\n",
            "guid": "f0a97179-133a-6e4f-8a49-8a44da73ffce",
            "learnMoreLink": [
                {
                    "name": "Overview of managed disk encryption options",
                    "url": "https://learn.microsoft.com/azure/virtual-machines/disk-encryption-overview"
                }
            ],
            "longDescription": "Consider enabling Azure Disk Encryption (ADE) for encrypting Azure VM disks using DM-Crypt (Linux) or BitLocker (Windows). Additionally, consider Encryption at host and Confidential disk encryption for enhanced data security.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhances data security and integrity",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Security",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Compute/virtualMachines",
            "recommendationTypeId": "a40cc620-e72c-fdf4-c554-c6ca2cd705c0",
            "service": "VM",
            "severity": "High",
            "source": "azure-resources/Compute/virtualMachines/recommendations.yaml",
            "tags": null,
            "text": "Virtual Machines should have Azure Disk Encryption or EncryptionAtHost enabled"
        },
        {
            "aprlGuid": "b72214bb-e879-5f4b-b9cd-642db84f36f4",
            "automationAvailable": "arg",
            "category": "Monitoring and Alerting",
            "description": "VM Insights monitors VM and scale set performance, health, running processes, and dependencies. It enhances the predictability of application performance and availability by pinpointing performance bottlenecks and network issues, and it clarifies if problems are related to other dependencies.\n",
            "graph": "// Azure Resource Graph Query\n// Check for VMs without Azure Monitoring Agent extension installed, missing Data Collection Rule or Data Collection Rule without performance enabled.\nResources\n| where type == 'microsoft.compute/virtualmachines'\n| project idVm = tolower(id), name, tags\n| join kind=leftouter (\n    InsightsResources\n    | where type =~ \"Microsoft.Insights/dataCollectionRuleAssociations\" and id has \"Microsoft.Compute/virtualMachines\"\n    | project idDcr = tolower(properties.dataCollectionRuleId), idVmDcr = tolower(substring(id, 0, indexof(id, \"/providers/Microsoft.Insights/dataCollectionRuleAssociations/\"))))\non $left.idVm == $right.idVmDcr\n| join kind=leftouter (\n    Resources\n    | where type =~ \"Microsoft.Insights/dataCollectionRules\"\n    | extend\n        isPerformanceEnabled = iif(properties.dataSources.performanceCounters contains \"Microsoft-InsightsMetrics\" and properties.dataFlows contains \"Microsoft-InsightsMetrics\", true, false),\n        isMapEnabled = iif(properties.dataSources.extensions contains \"Microsoft-ServiceMap\" and properties.dataSources.extensions contains \"DependencyAgent\" and properties.dataFlows contains \"Microsoft-ServiceMap\", true, false)//,\n    | where isPerformanceEnabled or isMapEnabled\n    | project dcrName = name, isPerformanceEnabled, isMapEnabled, idDcr = tolower(id))\non $left.idDcr == $right.idDcr\n| join kind=leftouter (\n    Resources\n        | where type == 'microsoft.compute/virtualmachines/extensions' and (name contains 'AzureMonitorWindowsAgent' or name contains 'AzureMonitorLinuxAgent')\n        | extend idVmExtension = tolower(substring(id, 0, indexof(id, '/extensions'))), extensionName = name)\non $left.idVm == $right.idVmExtension\n| where isPerformanceEnabled != 1 or (extensionName != 'AzureMonitorWindowsAgent' and extensionName != 'AzureMonitorLinuxAgent')\n| project recommendationId = \"b72214bb-e879-5f4b-b9cd-642db84f36f4\", name, id = idVm, tags, param1 = strcat('MonitoringExtension:', extensionName), param2 = strcat('DataCollectionRuleId:', idDcr), param3 = strcat('isPerformanceEnabled:', isPerformanceEnabled)\n\n",
            "guid": "b72214bb-e879-5f4b-b9cd-642db84f36f4",
            "learnMoreLink": [
                {
                    "name": "Overview of VM insights",
                    "url": "https://learn.microsoft.com/azure/azure-monitor/vm/vminsights-overview"
                },
                {
                    "name": "Did the extension install properly?",
                    "url": "https://learn.microsoft.com/azure/azure-monitor/vm/vminsights-troubleshoot#did-the-extension-install-properly"
                }
            ],
            "longDescription": "VM Insights monitors VM and scale set performance, health, running processes, and dependencies. It enhances the predictability of application performance and availability by pinpointing performance bottlenecks and network issues, and it clarifies if problems are related to other dependencies.\n",
            "pgVerified": true,
            "potentialBenefits": "Improves VM performance and health",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Monitoring and Alerting",
            "recommendationImpact": "Low",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Compute/virtualMachines",
            "recommendationTypeId": null,
            "service": "VM",
            "severity": "Low",
            "source": "azure-resources/Compute/virtualMachines/recommendations.yaml",
            "tags": null,
            "text": "Enable VM Insights"
        },
        {
            "aprlGuid": "4a9d8973-6dba-0042-b3aa-07924877ebd5",
            "automationAvailable": "arg",
            "category": "Monitoring and Alerting",
            "description": "Azure Monitor Metrics automatically receives platform metrics, but platform logs, which offer detailed diagnostics and auditing for resources and their Azure platform, need to be manually routed for collection.\n",
            "graph": "// Azure Resource Graph Query\n// Find all Virtual Machines without diagnostic settings enabled/with diagnostic settings enabled but not configured both performance counters and event logs/syslogs.\nresources\n| where type =~ \"microsoft.compute/virtualmachines\"\n| project name, id, tags, lowerCaseVmId = tolower(id)\n| join kind = leftouter (\n    resources\n    | where type =~ \"Microsoft.Compute/virtualMachines/extensions\" and properties.publisher =~ \"Microsoft.Azure.Diagnostics\"\n    | project\n        lowerCaseVmIdOfExtension = tolower(substring(id, 0, indexof(id, \"/extensions/\"))),\n        extensionType = properties.type,\n        provisioningState = properties.provisioningState,\n        storageAccount = properties.settings.StorageAccount,\n        // Windows\n        wadPerfCounters = properties.settings.WadCfg.DiagnosticMonitorConfiguration.PerformanceCounters.PerformanceCounterConfiguration,\n        wadEventLogs = properties.settings.WadCfg.DiagnosticMonitorConfiguration.WindowsEventLog,\n        // Linux\n        ladPerfCounters = properties.settings.ladCfg.diagnosticMonitorConfiguration.performanceCounters.performanceCounterConfiguration,\n        ladSyslog = properties.settings.ladCfg.diagnosticMonitorConfiguration.syslogEvents\n    | extend\n        // Windows\n        isWadPerfCountersConfigured = iif(array_length(wadPerfCounters) > 0, true, false),\n        isWadEventLogsConfigured = iif(isnotnull(wadEventLogs) and array_length(wadEventLogs.DataSource) > 0, true, false),\n        // Linux\n        isLadPerfCountersConfigured = iif(array_length(ladPerfCounters) > 0, true, false),\n        isLadSyslogConfigured = isnotnull(ladSyslog)\n    | project\n        lowerCaseVmIdOfExtension,\n        extensionType,\n        provisioningState,\n        storageAccount,\n        isPerfCountersConfigured = case(extensionType =~ \"IaaSDiagnostics\", isWadPerfCountersConfigured, extensionType =~ \"LinuxDiagnostic\", isLadPerfCountersConfigured, false),\n        isEventLogsConfigured = case(extensionType =~ \"IaaSDiagnostics\", isWadEventLogsConfigured, extensionType =~ \"LinuxDiagnostic\", isLadSyslogConfigured, false)\n    )\n    on $left.lowerCaseVmId == $right.lowerCaseVmIdOfExtension\n| where isempty(lowerCaseVmIdOfExtension) or provisioningState !~ \"Succeeded\" or not(isPerfCountersConfigured and isEventLogsConfigured)\n| extend\n    param1 = strcat(\"DiagnosticSetting: \", iif(isnotnull(extensionType), strcat(\"Enabled, partially configured (\", extensionType, \")\"), \"Not enabled\")),\n    param2 = strcat(\"ProvisioningState: \", iif(isnotnull(provisioningState), provisioningState, \"n/a\")),\n    param3 = strcat(\"storageAccount: \", iif(isnotnull(storageAccount), storageAccount, \"n/a\")),\n    param4 = strcat(\"PerformanceCounters: \", case(isnull(isPerfCountersConfigured), \"n/a\", isPerfCountersConfigured, \"Configured\", \"Not configured\")),\n    param5 = strcat(\"EventLogs/Syslogs: \", case(isnull(isEventLogsConfigured), \"n/a\", isEventLogsConfigured, \"Configured\", \"Not configured\"))\n| project recommendationId = \"4a9d8973-6dba-0042-b3aa-07924877ebd5\", name, id, tags, param1, param2, param3, param4, param5\n\n",
            "guid": "4a9d8973-6dba-0042-b3aa-07924877ebd5",
            "learnMoreLink": [
                {
                    "name": "Azure Monitor Agent overview",
                    "url": "https://learn.microsoft.com/en-us/azure/azure-monitor/agents/agents-overview"
                }
            ],
            "longDescription": "Azure Monitor Metrics automatically receives platform metrics, but platform logs, which offer detailed diagnostics and auditing for resources and their Azure platform, need to be manually routed for collection.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhanced diagnostics and auditing capability",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Monitoring and Alerting",
            "recommendationImpact": "Low",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Compute/virtualMachines",
            "recommendationTypeId": null,
            "service": "VM",
            "severity": "Low",
            "source": "azure-resources/Compute/virtualMachines/recommendations.yaml",
            "tags": null,
            "text": "Configure monitoring for all Azure Virtual Machines"
        },
        {
            "aprlGuid": "52ab9e5c-eec0-3148-8bd7-b6dd9e1be870",
            "automationAvailable": "arg",
            "category": "High Availability",
            "description": "The maintenance configuration settings let users schedule and manage updates, making sure the updates or interruptions on the VM are performed within a planned timeframe.\n",
            "graph": "// Azure Resource Graph Query\n// Find VMS that do not have maintenance configuration assigned\nResources\n| extend resourceId = tolower(id)\n| project name, location, type, id, tags, resourceId, properties\n| where type =~ 'Microsoft.Compute/virtualMachines'\n| join kind=leftouter (\nmaintenanceresources\n| where type =~ \"microsoft.maintenance/configurationassignments\"\n| project planName = name, type, maintenanceProps = properties\n| extend resourceId = tostring(maintenanceProps.resourceId)\n) on resourceId\n| where isnull(maintenanceProps)\n| project recommendationId = \"52ab9e5c-eec0-3148-8bd7-b6dd9e1be870\",name, id, tags\n| order by id asc\n\n",
            "guid": "52ab9e5c-eec0-3148-8bd7-b6dd9e1be870",
            "learnMoreLink": [
                {
                    "name": "Use maintenance configurations to control and manage the VM updates",
                    "url": "https://learn.microsoft.com/azure/virtual-machines/maintenance-configurations"
                }
            ],
            "longDescription": "The maintenance configuration settings let users schedule and manage updates, making sure the updates or interruptions on the VM are performed within a planned timeframe.\n",
            "pgVerified": true,
            "potentialBenefits": "Scheduled updates for VMs",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Compute/virtualMachines",
            "recommendationTypeId": null,
            "service": "VM",
            "severity": "High",
            "source": "azure-resources/Compute/virtualMachines/recommendations.yaml",
            "tags": null,
            "text": "Use maintenance configurations for the VMs"
        },
        {
            "aprlGuid": "3201dba8-d1da-4826-98a4-104066545170",
            "automationAvailable": "arg",
            "category": "Scalability",
            "description": "A-series VMs are tailored for entry-level workloads like development and testing, including use cases such as development and test servers, low traffic web servers, and small to medium databases.\n",
            "graph": "// Azure Resource Graph Query\n// Find all VMs using A or B series families\nresources\n| where type == 'microsoft.compute/virtualmachines'\n| where properties.hardwareProfile.vmSize contains \"Standard_B\" or properties.hardwareProfile.vmSize contains \"Standard_A\"\n| project recommendationId = \"3201dba8-d1da-4826-98a4-104066545170\", name, id, tags, param1=strcat(\"vmSku: \" , properties.hardwareProfile.vmSize)\n\n",
            "guid": "3201dba8-d1da-4826-98a4-104066545170",
            "learnMoreLink": [
                {
                    "name": "B-series burstable virtual machine sizes",
                    "url": "https://learn.microsoft.com/en-us/azure/virtual-machines/sizes-b-series-burstable"
                }
            ],
            "longDescription": "A-series VMs are tailored for entry-level workloads like development and testing, including use cases such as development and test servers, low traffic web servers, and small to medium databases.\n",
            "pgVerified": true,
            "potentialBenefits": "Ensures full CPU usage for heavy tasks",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Scalability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Compute/virtualMachines",
            "recommendationTypeId": null,
            "service": "VM",
            "severity": "High",
            "source": "azure-resources/Compute/virtualMachines/recommendations.yaml",
            "tags": null,
            "text": "Don't use A or B-Series VMs for production needing constant full CPU performance"
        },
        {
            "aprlGuid": "df0ff862-814d-45a3-95e4-4fad5a244ba6",
            "automationAvailable": "arg",
            "category": "Scalability",
            "description": "Compared to Standard HDD and SSD, Premium SSD, SSDv2, and Ultra SSDs offer improved performance, configurability, and higher single-instance Virtual Machine uptime SLAs. The lowest SLA of all disks on a Virtual Machine applies, so it is best to use Premium or Ultra Disks for the highest uptime SLA.\n",
            "graph": "// Azure Resource Graph Query\n// Find all VMs that have an attached disk that is not in the Premium or Ultra sku tier.\n\nresources\n| where type =~ 'Microsoft.Compute/virtualMachines'\n| extend lname = tolower(name)\n| join kind=leftouter(resources\n    | where type =~ 'Microsoft.Compute/disks'\n    | where not(sku.tier =~ 'Premium') and not(sku.tier =~ 'Ultra')\n    | extend lname = tolower(tostring(split(managedBy, '/')[8]))\n    | project lname, name\n    | summarize disks = make_list(name) by lname) on lname\n| where isnotnull(disks)\n| project recommendationId = \"df0ff862-814d-45a3-95e4-4fad5a244ba6\", name, id, tags, param1=strcat(\"AffectedDisks: \", disks)\n\n",
            "guid": "df0ff862-814d-45a3-95e4-4fad5a244ba6",
            "learnMoreLink": [
                {
                    "name": "Disk type comparison and decision tree",
                    "url": "https://learn.microsoft.com/en-us/azure/virtual-machines/disks-types#disk-type-comparison"
                }
            ],
            "longDescription": "Compared to Standard HDD and SSD, Premium SSD, SSDv2, and Ultra SSDs offer improved performance, configurability, and higher single-instance Virtual Machine uptime SLAs. The lowest SLA of all disks on a Virtual Machine applies, so it is best to use Premium or Ultra Disks for the highest uptime SLA.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhanced performance, cost efficiency, and uptime SLA",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Scalability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Compute/virtualMachines",
            "recommendationTypeId": "58d6648d-32e8-4346-827c-4f288dd8ca24",
            "service": "VM",
            "severity": "High",
            "source": "azure-resources/Compute/virtualMachines/recommendations.yaml",
            "tags": null,
            "text": "Mission Critical Workloads should consider using Premium or Ultra Disks"
        },
        {
            "aprlGuid": "9ab499d8-8844-424d-a2d4-8f53690eb8f8",
            "automationAvailable": false,
            "category": "High Availability",
            "description": "If the workload is Maintenance sensitive, consider Azure Boost compatible VMs. Azure Boost is designed to lessen the impact on customers when Azure maintenance activities occur on the host, and the current list of compatible VM sizes are documented in the first link below.\n",
            "graph": "// under-development\n\n",
            "guid": "9ab499d8-8844-424d-a2d4-8f53690eb8f8",
            "learnMoreLink": [
                {
                    "name": "Microsoft Azure Boost",
                    "url": "https://learn.microsoft.com/azure/azure-boost/overview"
                },
                {
                    "name": "Announcing the general availability of Azure Boost",
                    "url": "https://aka.ms/AzureBoostGABlog"
                }
            ],
            "longDescription": "If the workload is Maintenance sensitive, consider Azure Boost compatible VMs. Azure Boost is designed to lessen the impact on customers when Azure maintenance activities occur on the host, and the current list of compatible VM sizes are documented in the first link below.\n",
            "pgVerified": true,
            "potentialBenefits": "Less maintenance impact",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Compute/virtualMachines",
            "recommendationTypeId": null,
            "service": "VM",
            "severity": "Medium",
            "source": "azure-resources/Compute/virtualMachines/recommendations.yaml",
            "tags": null,
            "text": "Use Azure Boost VMs for Maintenance sensitive workload"
        },
        {
            "aprlGuid": "2de8fa5e-14f4-4c4c-857f-1520f87a629f",
            "automationAvailable": false,
            "category": "High Availability",
            "description": "If your workload is Maintenance sensitive, enable Scheduled Events. This Azure Metadata Service lets your app prepare for virtual machine maintenance by providing information on upcoming events like reboots, reducing disruptions.\n",
            "graph": "// under-development\n\n",
            "guid": "2de8fa5e-14f4-4c4c-857f-1520f87a629f",
            "learnMoreLink": [
                {
                    "name": "Monitor scheduled events for your Azure VMs",
                    "url": "https://learn.microsoft.com/azure/virtual-machines/windows/scheduled-event-service"
                },
                {
                    "name": "Azure Metadata Service Scheduled Events for Linux VMs",
                    "url": "https://learn.microsoft.com/azure/virtual-machines/linux/scheduled-events"
                },
                {
                    "name": "Azure Metadata Service Scheduled Events for Windows VMs",
                    "url": "https://learn.microsoft.com/azure/virtual-machines/windows/scheduled-events"
                }
            ],
            "longDescription": "If your workload is Maintenance sensitive, enable Scheduled Events. This Azure Metadata Service lets your app prepare for virtual machine maintenance by providing information on upcoming events like reboots, reducing disruptions.\n",
            "pgVerified": true,
            "potentialBenefits": "Minimize downtime for VMs",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Compute/virtualMachines",
            "recommendationTypeId": null,
            "service": "VM",
            "severity": "Medium",
            "source": "azure-resources/Compute/virtualMachines/recommendations.yaml",
            "tags": null,
            "text": "Enable Scheduled Events for Maintenance sensitive workload VMs"
        },
        {
            "aprlGuid": "fa0cf4f5-0b21-47b7-89a9-ee936f193ce1",
            "automationAvailable": "arg",
            "category": "High Availability",
            "description": "Azure disks offers a zone-redundant storage (ZRS) option for workloads that need to be resilient to an entire zone being down. Due to the cross-zone data replication, ZRS disks have higher write latency when compared to the locally-redundant option (LRS), so make sure to benchmark your disks.\n",
            "graph": "// Azure Resource Graph Query\n// Find eligible Disks that are not zonal nor zone redundant\nresources\n| where type == 'microsoft.compute/disks'\n| where sku has \"Premium_LRS\" or sku has \"StandardSSD_LRS\"\n| where sku.name has_cs 'ZRS' or array_length(zones) > 0\n| project recommendationId=\"fa0cf4f5-0b21-47b7-89a9-ee936f193ce1\", name, id, tags, param1 = sku, param2 = sku.name\n",
            "guid": "fa0cf4f5-0b21-47b7-89a9-ee936f193ce1",
            "learnMoreLink": [
                {
                    "name": "Redundancy options for managed disks",
                    "url": "https://aka.ms/zrsdisksdoc"
                }
            ],
            "longDescription": "Azure disks offers a zone-redundant storage (ZRS) option for workloads that need to be resilient to an entire zone being down. Due to the cross-zone data replication, ZRS disks have higher write latency when compared to the locally-redundant option (LRS), so make sure to benchmark your disks.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhanced Disk resilience to failures",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Compute/virtualMachines",
            "recommendationTypeId": "d4102c0f-ebe3-4b22-8fe0-e488866a87af",
            "service": "VM",
            "severity": "Medium",
            "source": "azure-resources/Compute/virtualMachines/recommendations.yaml",
            "tags": null,
            "text": "Use Azure Disks with Zone Redundant Storage for higher resiliency and availability"
        },
        {
            "aprlGuid": "302fda08-ee65-4fbe-a916-6dc0b33169c4",
            "automationAvailable": "arg",
            "category": "High Availability",
            "description": "Azure Capacity Reservations ensure high availability for virtual machines by reserving compute capacity in advance within a specific region or availability zone. This guarantees that VMs will have the necessary resources during peak demand or maintenance events, enhancing reliability and uptime.\n",
            "graph": "// Azure Resource Graph Query\n// Find all Virtual Machines not associated with a Capacity Reservation, and provide details for Capacity Reservation like vmSize, location, and zone.\nresources\n| where type =~ 'Microsoft.Compute/virtualMachines'\n| where isnull(properties.capacityReservation)\n| extend zoneValue = iff(isnull(zones), \"null\", zones)\n| project recommendationId = \"302fda08-ee65-4fbe-a916-6dc0b33169c4\", name, id, tags, param1 = strcat(\"VmSize: \", properties.hardwareProfile.vmSize), param2 = strcat(\"Location: \", location), param3 = strcat(\"Zone: \", zoneValue)\n",
            "guid": "302fda08-ee65-4fbe-a916-6dc0b33169c4",
            "learnMoreLink": [
                {
                    "name": "On-demand Capacity Reservation",
                    "url": "https://aka.ms/on-demand-capacity-reservations-docs"
                }
            ],
            "longDescription": "Azure Capacity Reservations ensure high availability for virtual machines by reserving compute capacity in advance within a specific region or availability zone. This guarantees that VMs will have the necessary resources during peak demand or maintenance events, enhancing reliability and uptime.\n",
            "pgVerified": false,
            "potentialBenefits": "Guaranteed capacity in constrained regions/zones",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Compute/virtualMachines",
            "recommendationTypeId": null,
            "service": "VM",
            "severity": "High",
            "source": "azure-resources/Compute/virtualMachines/recommendations.yaml",
            "tags": null,
            "text": "Reserve Compute Capacity for critical workloads"
        },
        {
            "aprlGuid": "eb005943-40a8-194b-9db2-474d430046b7",
            "automationAvailable": "arg",
            "category": "Scalability",
            "description": "Choose a service tier of Azure Container Registry to meet your performance needs. Premium offers the most bandwidth and highest rate of read and write operations for high-volume deployments. Use Basic to start, Standard for production, and Premium for hyper-scale performance and geo-replication.\n",
            "graph": "// Azure Resource Graph Query\n// Find all Container Registries that are not using the Premium tier\nresources\n| where type =~ \"microsoft.containerregistry/registries\"\n| where sku.name != \"Premium\"\n| project recommendationId = \"eb005943-40a8-194b-9db2-474d430046b7\", name, id, tags, param1=strcat(\"SkuName: \", tostring(sku.name))\n| order by id asc\n\n",
            "guid": "eb005943-40a8-194b-9db2-474d430046b7",
            "learnMoreLink": [
                {
                    "name": "Container Registry Best Practices",
                    "url": "https://learn.microsoft.com/en-us/azure/container-registry/container-registry-best-practices"
                }
            ],
            "longDescription": "Choose a service tier of Azure Container Registry to meet your performance needs. Premium offers the most bandwidth and highest rate of read and write operations for high-volume deployments. Use Basic to start, Standard for production, and Premium for hyper-scale performance and geo-replication.\n",
            "pgVerified": false,
            "potentialBenefits": "High-volume support and geo-replication",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Scalability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.ContainerRegistry/registries",
            "recommendationTypeId": null,
            "service": "ACR",
            "severity": "High",
            "source": "azure-resources/ContainerRegistry/registries/recommendations.yaml",
            "tags": null,
            "text": "Use Premium tier for critical production workloads"
        },
        {
            "aprlGuid": "63491f70-22e4-3b4a-8b0c-845450e46fac",
            "automationAvailable": "arg",
            "category": "High Availability",
            "description": "Azure Container Registry's optional zone redundancy enhances resiliency and high availability for registries or replication resources in a specific region by distributing resources across multiple zones.\n",
            "graph": "// Azure Resource Graph Query\n// Find all Container Registries that do not have zone redundancy enabled\nresources\n| where type =~ \"microsoft.containerregistry/registries\"\n| where properties.zoneRedundancy != \"Enabled\"\n| project recommendationId = \"63491f70-22e4-3b4a-8b0c-845450e46fac\", name, id, tags, param1=strcat(\"zoneRedundancy: \", tostring(properties.zoneRedundancy))\n| order by id asc\n\n",
            "guid": "63491f70-22e4-3b4a-8b0c-845450e46fac",
            "learnMoreLink": [
                {
                    "name": "Registry best practices - Enable zone redundancy",
                    "url": "https://review.learn.microsoft.com/en-us/azure/container-registry/zone-redundancy?toc=%2Fazure%2Freliability%2Ftoc.json&bc=%2Fazure%2Freliability%2Fbreadcrumb%2Ftoc.json&branch=main"
                }
            ],
            "longDescription": "Azure Container Registry's optional zone redundancy enhances resiliency and high availability for registries or replication resources in a specific region by distributing resources across multiple zones.\n",
            "pgVerified": false,
            "potentialBenefits": "Enhances resiliency and high availability",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.ContainerRegistry/registries",
            "recommendationTypeId": null,
            "service": "ACR",
            "severity": "High",
            "source": "azure-resources/ContainerRegistry/registries/recommendations.yaml",
            "tags": null,
            "text": "Enable zone redundancy"
        },
        {
            "aprlGuid": "36ea6c09-ef6e-d743-9cfb-bd0c928a430b",
            "automationAvailable": "arg",
            "category": "Disaster Recovery",
            "description": "Use Azure Container Registry's geo-replication for multi-region deployments to simplify registry management and minimize latency. It enables serving global customers from local data centers and supports distributed development teams. Regional webhooks can notify of events in replicas.\n",
            "graph": "// Azure Resource Graph Query\n// Find all Container Registries that do not have geo-replication enabled\nresources\n| where type =~ \"microsoft.containerregistry/registries\"\n| project registryName = name, registryId = id, tags, primaryRegion = location\n| join kind=leftouter (\n    Resources\n    | where type =~ \"microsoft.containerregistry/registries/replications\"\n    | project replicationRegion=name, replicationId = id\n    | extend registryId=strcat_array(array_slice(split(replicationId, '/'), 0, -3), '/')\n    ) on registryId\n| project-away registryId1, replicationId\n| where isempty(replicationRegion)\n| project recommendationId = \"36ea6c09-ef6e-d743-9cfb-bd0c928a430b\", name=registryName, id=registryId, tags\n| order by id asc\n\n",
            "guid": "36ea6c09-ef6e-d743-9cfb-bd0c928a430b",
            "learnMoreLink": [
                {
                    "name": "Registry best practices - Enable geo-replication",
                    "url": "https://learn.microsoft.com/en-us/azure/container-registry/container-registry-best-practices#geo-replicate-multi-region-deployments"
                },
                {
                    "name": "Geo-Replicate Container Registry",
                    "url": "https://learn.microsoft.com/en-us/azure/container-registry/container-registry-geo-replication"
                }
            ],
            "longDescription": "Use Azure Container Registry's geo-replication for multi-region deployments to simplify registry management and minimize latency. It enables serving global customers from local data centers and supports distributed development teams. Regional webhooks can notify of events in replicas.\n",
            "pgVerified": false,
            "potentialBenefits": "Simplifies management, reduces latency",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Disaster Recovery",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.ContainerRegistry/registries",
            "recommendationTypeId": null,
            "service": "ACR",
            "severity": "High",
            "source": "azure-resources/ContainerRegistry/registries/recommendations.yaml",
            "tags": null,
            "text": "Enable geo-replication"
        },
        {
            "aprlGuid": "a5a0101a-a240-8742-90ba-81dbde9a0c0c",
            "automationAvailable": false,
            "category": "Security",
            "description": "Using repository namespaces allows a single registry to be shared across multiple groups and deployments within an organization, supporting nested namespaces for group isolation. However, repositories are managed independently, not hierarchically.\n",
            "graph": "// cannot-be-validated-with-arg\n\n",
            "guid": "a5a0101a-a240-8742-90ba-81dbde9a0c0c",
            "learnMoreLink": [
                {
                    "name": "Registry best practices - use repository namespaces",
                    "url": "https://learn.microsoft.com/en-us/azure/container-registry/container-registry-best-practices#repository-namespaces"
                }
            ],
            "longDescription": "Using repository namespaces allows a single registry to be shared across multiple groups and deployments within an organization, supporting nested namespaces for group isolation. However, repositories are managed independently, not hierarchically.\n",
            "pgVerified": false,
            "potentialBenefits": "Enables sharing and group isolation",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Security",
            "recommendationImpact": "Low",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.ContainerRegistry/registries",
            "recommendationTypeId": null,
            "service": "ACR",
            "severity": "Low",
            "source": "azure-resources/ContainerRegistry/registries/recommendations.yaml",
            "tags": null,
            "text": "Use Repository namespaces"
        },
        {
            "aprlGuid": "8e389532-5db5-7e4c-9d4d-443b3e55ae82",
            "automationAvailable": "arg",
            "category": "Governance",
            "description": "Container registries, used across multiple hosts, should be in their own resource group to prevent accidental deletion of images when container instances are deleted, preserving the image collection while experimenting with hosts.\n",
            "graph": "// Azure Resource Graph Query\n// List container registries that contain additional resources within the same resource group.\nresources\n| where type =~ \"microsoft.containerregistry/registries\"\n| project registryName=name, registryId=id, registryTags=tags, resourceGroupId=strcat('/subscriptions/', subscriptionId, '/resourceGroups/', resourceGroup), resourceGroup, subscriptionId\n| join kind=inner (\n    resources\n    | where not(type =~ \"microsoft.containerregistry/registries\")\n    | summarize recourceCount=count() by subscriptionId, resourceGroup\n    | where recourceCount != 0\n) on resourceGroup, subscriptionId\n| project recommendationId = \"8e389532-5db5-7e4c-9d4d-443b3e55ae82\", name=registryName, id=registryId, tags=registryTags, param1=strcat('resourceGroupName:',resourceGroup), param2=strcat('resourceGroupId:',resourceGroupId)\n\n",
            "guid": "8e389532-5db5-7e4c-9d4d-443b3e55ae82",
            "learnMoreLink": [
                {
                    "name": "Registry best practices - Use dedicated resource group",
                    "url": "https://learn.microsoft.com/en-us/azure/container-registry/container-registry-best-practices#dedicated-resource-group"
                }
            ],
            "longDescription": "Container registries, used across multiple hosts, should be in their own resource group to prevent accidental deletion of images when container instances are deleted, preserving the image collection while experimenting with hosts.\n",
            "pgVerified": false,
            "potentialBenefits": "Safeguards image collection",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Governance",
            "recommendationImpact": "Low",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.ContainerRegistry/registries",
            "recommendationTypeId": null,
            "service": "ACR",
            "severity": "Low",
            "source": "azure-resources/ContainerRegistry/registries/recommendations.yaml",
            "tags": null,
            "text": "Move Container Registry to a dedicated resource group"
        },
        {
            "aprlGuid": "3ef86f16-f65b-c645-9901-7830d6dc3a1b",
            "automationAvailable": "arg",
            "category": "Scalability",
            "description": "The storage constraints of Azure Container Registry's service tiers align with usage scenarios: Basic for starters, Standard for production, and Premium for high-scale performance and geo-replication.\n",
            "graph": "// Azure Resource Graph Query\n// Find all Container Registries that have their retention policy disabled\nresources\n| where type =~ \"microsoft.containerregistry/registries\"\n| where properties.policies.retentionPolicy.status == \"disabled\"\n| project recommendationId = \"3ef86f16-f65b-c645-9901-7830d6dc3a1b\", name, id, tags, param1='retentionPolicy:disabled'\n| order by id asc\n\n",
            "guid": "3ef86f16-f65b-c645-9901-7830d6dc3a1b",
            "learnMoreLink": [
                {
                    "name": "Registry best practices - Manage registry size",
                    "url": "https://learn.microsoft.com/en-us/azure/container-registry/container-registry-best-practices#manage-registry-size"
                },
                {
                    "name": "Retention Policy",
                    "url": "https://learn.microsoft.com/en-us/azure/container-registry/container-registry-retention-policy#about-the-retention-policy"
                }
            ],
            "longDescription": "The storage constraints of Azure Container Registry's service tiers align with usage scenarios: Basic for starters, Standard for production, and Premium for high-scale performance and geo-replication.\n",
            "pgVerified": false,
            "potentialBenefits": "Reduce costs, optimize storage",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Scalability",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.ContainerRegistry/registries",
            "recommendationTypeId": null,
            "service": "ACR",
            "severity": "Medium",
            "source": "azure-resources/ContainerRegistry/registries/recommendations.yaml",
            "tags": null,
            "text": "Manage registry size"
        },
        {
            "aprlGuid": "03f4a7d8-c5b4-7842-8e6e-14997a34842b",
            "automationAvailable": "arg",
            "category": "Security",
            "description": "By default, Azure container registry requires authentication for pull/push actions. Enabling anonymous pull access exposes all content for public read actions. This applies to all repositories, potentially allowing unrestricted access if repository-scoped tokens are used.\n",
            "graph": "// Azure Resource Graph Query\n// Find all Container Registries that have anonymous pull access enabled\nresources\n| where type =~ \"microsoft.containerregistry/registries\"\n| where properties.anonymousPullEnabled == \"true\"\n| project recommendationId = \"03f4a7d8-c5b4-7842-8e6e-14997a34842b\", name, id, tags\n| order by id asc\n\n",
            "guid": "03f4a7d8-c5b4-7842-8e6e-14997a34842b",
            "learnMoreLink": [
                {
                    "name": "Enable anonymous pull access",
                    "url": "https://learn.microsoft.com/en-us/azure/container-registry/anonymous-pull-access#about-anonymous-pull-access"
                }
            ],
            "longDescription": "By default, Azure container registry requires authentication for pull/push actions. Enabling anonymous pull access exposes all content for public read actions. This applies to all repositories, potentially allowing unrestricted access if repository-scoped tokens are used.\n",
            "pgVerified": false,
            "potentialBenefits": "Enhanced security and controlled access",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Security",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.ContainerRegistry/registries",
            "recommendationTypeId": null,
            "service": "ACR",
            "severity": "Medium",
            "source": "azure-resources/ContainerRegistry/registries/recommendations.yaml",
            "tags": null,
            "text": "Disable anonymous pull access"
        },
        {
            "aprlGuid": "44107155-7a32-9348-89f3-d5aa7e7c5a1d",
            "automationAvailable": false,
            "category": "Monitoring and Alerting",
            "description": "Resource Logs are not collected and stored until you create a diagnostic setting and route them to one or more locations.\n",
            "graph": "// cannot-be-validated-with-arg\n\n",
            "guid": "44107155-7a32-9348-89f3-d5aa7e7c5a1d",
            "learnMoreLink": [
                {
                    "name": "Monitoring Azure Container Registry data reference - Resource Logs",
                    "url": "https://learn.microsoft.com/en-us/azure/container-registry/monitor-service-reference#resource-logs"
                },
                {
                    "name": "Monitor Azure Container Registry - Enable diagnostic logs",
                    "url": "https://learn.microsoft.com/en-us/azure/container-registry/monitor-service#collection-and-routing"
                }
            ],
            "longDescription": "Resource Logs are not collected and stored until you create a diagnostic setting and route them to one or more locations.\n",
            "pgVerified": false,
            "potentialBenefits": "Enhanced tracking and debugging",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Monitoring and Alerting",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.ContainerRegistry/registries",
            "recommendationTypeId": null,
            "service": "ACR",
            "severity": "Medium",
            "source": "azure-resources/ContainerRegistry/registries/recommendations.yaml",
            "tags": null,
            "text": "Configure Diagnostic Settings for all Azure Container Registries"
        },
        {
            "aprlGuid": "d594cde6-4116-d143-a64a-25f63289a2f8",
            "automationAvailable": false,
            "category": "Monitoring and Alerting",
            "description": "Monitoring Azure resources using Azure Monitor enhances their availability, performance, and operation. Azure Container Registry, a full-stack monitoring service, provides features for Azure and other cloud and on-premises resources.\n",
            "graph": "// cannot-be-validated-with-arg\n\n",
            "guid": "d594cde6-4116-d143-a64a-25f63289a2f8",
            "learnMoreLink": [
                {
                    "name": "Monitoring Azure Container Registry data reference",
                    "url": "https://learn.microsoft.com/en-us/azure/container-registry/monitor-service-reference#metrics"
                },
                {
                    "name": "Monitor Azure Container Registry",
                    "url": "https://learn.microsoft.com/en-us/azure/container-registry/monitor-service"
                }
            ],
            "longDescription": "Monitoring Azure resources using Azure Monitor enhances their availability, performance, and operation. Azure Container Registry, a full-stack monitoring service, provides features for Azure and other cloud and on-premises resources.\n",
            "pgVerified": false,
            "potentialBenefits": "Enhanced monitoring and operation",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Monitoring and Alerting",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.ContainerRegistry/registries",
            "recommendationTypeId": null,
            "service": "ACR",
            "severity": "Medium",
            "source": "azure-resources/ContainerRegistry/registries/recommendations.yaml",
            "tags": null,
            "text": "Monitor Azure Container Registry with Azure Monitor"
        },
        {
            "aprlGuid": "e7f0fd54-fba0-054e-9ab8-e676f2851f88",
            "automationAvailable": "arg",
            "category": "Disaster Recovery",
            "description": "Enabling soft delete in Azure Container Registry (ACR) allows for the management of deleted artifacts with a specified retention period. Users can list, filter, and restore these artifacts until automatically purged post-retention.\n",
            "graph": "// Azure Resource Graph Query\n// Provides a list of Azure Container Registry resources that do not have soft delete enabled\nresources\n| where type =~ \"microsoft.containerregistry/registries\"\n| where properties.policies.softDeletePolicy.status == \"disabled\"\n| project recommendationId = \"e7f0fd54-fba0-054e-9ab8-e676f2851f88\", name, id, tags\n| order by id asc\n\n",
            "guid": "e7f0fd54-fba0-054e-9ab8-e676f2851f88",
            "learnMoreLink": [
                {
                    "name": "Enable soft delete policy",
                    "url": "https://learn.microsoft.com/en-us/azure/container-registry/container-registry-soft-delete-policy"
                }
            ],
            "longDescription": "Enabling soft delete in Azure Container Registry (ACR) allows for the management of deleted artifacts with a specified retention period. Users can list, filter, and restore these artifacts until automatically purged post-retention.\n",
            "pgVerified": false,
            "potentialBenefits": "Recovery of deleted artifacts",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Disaster Recovery",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.ContainerRegistry/registries",
            "recommendationTypeId": null,
            "service": "ACR",
            "severity": "Medium",
            "source": "azure-resources/ContainerRegistry/registries/recommendations.yaml",
            "tags": null,
            "text": "Enable soft delete policy"
        },
        {
            "aprlGuid": "4f63619f-5001-439c-bacb-8de891287727",
            "automationAvailable": "arg",
            "category": "High Availability",
            "description": "Azure Availability Zones ensure high availability by offering independent locations within regions, equipped with their own power, cooling, and networking to ensure applications and data are protected from datacenter-level failures.\n",
            "graph": "// Azure Resource Graph Query\n// Returns AKS clusters that do not have any availability zones enabled or only use a single zone\nresources\n| where type =~ \"Microsoft.ContainerService/managedClusters\"\n| project id, name, tags, location, pools = properties.agentPoolProfiles\n| mv-expand pool = pools\n| extend\n    numOfAvailabilityZones = iif(isnull(pool.availabilityZones), 0, array_length(pool.availabilityZones))\n| where numOfAvailabilityZones < 2\n| project\n    recommendationId = \"4f63619f-5001-439c-bacb-8de891287727\",\n    id,\n    name,\n    tags,\n    param1 = strcat(\"NodePoolName: \", pool.name),\n    param2 = strcat(\"Mode: \", pool.mode),\n    param3 = strcat(\"AvailabilityZones: \", iif(numOfAvailabilityZones == 0, \"None\", strcat(\"Zone \", strcat_array(pool.availabilityZones, \", \")))),\n    param4 = strcat(\"Location: \", location)\n",
            "guid": "4f63619f-5001-439c-bacb-8de891287727",
            "learnMoreLink": [
                {
                    "name": "AKS Availability Zones",
                    "url": "https://learn.microsoft.com/en-us/azure/aks/availability-zones"
                },
                {
                    "name": "Zone Balancing",
                    "url": "https://learn.microsoft.com/en-us/azure/virtual-machine-scale-sets/virtual-machine-scale-sets-use-availability-zones#zone-balancing"
                }
            ],
            "longDescription": "Azure Availability Zones ensure high availability by offering independent locations within regions, equipped with their own power, cooling, and networking to ensure applications and data are protected from datacenter-level failures.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhanced fault tolerance for AKS",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.ContainerService/managedClusters",
            "recommendationTypeId": null,
            "service": "AKS",
            "severity": "High",
            "source": "azure-resources/ContainerService/managedClusters/recommendations.yaml",
            "tags": null,
            "text": "Deploy AKS cluster across availability zones"
        },
        {
            "aprlGuid": "5ee083cd-6ac3-4a83-8913-9549dd36cf56",
            "automationAvailable": "arg",
            "category": "High Availability",
            "description": "AKS assigns the kubernetes.azure.com/mode: system label to nodes in system node pools signaling the preference for system pods should be scheduled there. The CriticalAddonsOnly=true:NoSchedule taint can be added to your system nodes to prohibit application pods from being scheduled on them.\n",
            "graph": "// Azure Resource Graph Query\n// Returns each AKS cluster with nodepools that do not have system pods labelled with CriticalAddonsOnly\nresources\n| where type == \"microsoft.containerservice/managedclusters\"\n| mv-expand agentPoolProfile = properties.agentPoolProfiles\n| where agentPoolProfile.mode =~ 'System' // system node pools\n| extend taint = tostring(parse_json(agentPoolProfile.nodeTaints))\n| extend hasCriticalAddonsTaint = agentPoolProfile.kubeletConfig has 'CriticalAddonsOnly'\n| extend hasNodeLabel = agentPoolProfile.customNodeLabels has 'CriticalAddonsOnly'\n| extend hasCriticalAddonsOnly = hasCriticalAddonsTaint or hasNodeLabel or isempty(taint)\n| extend nodePool = tostring(parse_json(agentPoolProfile.name))\n| where hasCriticalAddonsOnly\n| project\n    recommendationId=\"5ee083cd-6ac3-4a83-8913-9549dd36cf56\",\n    id,\n    name,\n    tags,\n    param1=strcat(\"nodepoolName: \", nodePool)\n",
            "guid": "5ee083cd-6ac3-4a83-8913-9549dd36cf56",
            "learnMoreLink": [
                {
                    "name": "System and user node pools",
                    "url": "https://learn.microsoft.com/en-us/azure/aks/use-system-pools?tabs=azure-cli#system-and-user-node-pools"
                }
            ],
            "longDescription": "AKS assigns the kubernetes.azure.com/mode: system label to nodes in system node pools signaling the preference for system pods should be scheduled there. The CriticalAddonsOnly=true:NoSchedule taint can be added to your system nodes to prohibit application pods from being scheduled on them.\n",
            "pgVerified": false,
            "potentialBenefits": "Enhanced reliability via pod isolation",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.ContainerService/managedClusters",
            "recommendationTypeId": null,
            "service": "AKS",
            "severity": "High",
            "source": "azure-resources/ContainerService/managedClusters/recommendations.yaml",
            "tags": null,
            "text": "Isolate system and application pods"
        },
        {
            "aprlGuid": "ca324d71-54b0-4a3e-b9e4-10e767daa9fc",
            "automationAvailable": "arg",
            "category": "Security",
            "description": "Local Kubernetes accounts in AKS, being non-auditable and legacy, are discouraged. Microsoft Entra's integration offers centralized management, multi-factor authentication, RBAC for detailed access, and a secure, scalable authentication system compatible with Azure and external identity providers.\n",
            "graph": "// Azure Resource Graph Query\n// Returns a list of AKS clusters not using AAD enabled\nresources\n| where type == \"microsoft.containerservice/managedclusters\"\n| extend aadProfile = tostring (parse_json(properties.aadProfile))\n| extend disablelocalAdmin = tostring(parse_json(properties.disableLocalAccounts))\n| extend RBAC = tostring(parse_json(properties.enableRBAC))\n| where RBAC == \"false\"\n| project recommendationId=\"ca324d71-54b0-4a3e-b9e4-10e767daa9fc\", name, id, tags, param1=strcat(\"aadProfile: \", aadProfile), param2=strcat(\"disablelocalAdmin: \",disablelocalAdmin), param3=strcat(\"RBAC: \", RBAC)\n\n",
            "guid": "ca324d71-54b0-4a3e-b9e4-10e767daa9fc",
            "learnMoreLink": [
                {
                    "name": "Entra integration",
                    "url": "https://learn.microsoft.com/en-us/azure/aks/concepts-identity#azure-ad-integration"
                },
                {
                    "name": "Use Azure role-based access control for AKS",
                    "url": "https://learn.microsoft.com/en-us/azure/aks/manage-azure-rbac?source=recommendations"
                },
                {
                    "name": "Manage AKS local accounts",
                    "url": "https://learn.microsoft.com/en-us/azure/aks/manage-local-accounts-managed-azure-ad?source=recommendations"
                }
            ],
            "longDescription": "Local Kubernetes accounts in AKS, being non-auditable and legacy, are discouraged. Microsoft Entra's integration offers centralized management, multi-factor authentication, RBAC for detailed access, and a secure, scalable authentication system compatible with Azure and external identity providers.\n",
            "pgVerified": false,
            "potentialBenefits": "Enhanced security and access control",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Security",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.ContainerService/managedClusters",
            "recommendationTypeId": null,
            "service": "AKS",
            "severity": "High",
            "source": "azure-resources/ContainerService/managedClusters/recommendations.yaml",
            "tags": null,
            "text": "Disable local accounts"
        },
        {
            "aprlGuid": "c22db132-399b-4e7c-995d-577a60881be8",
            "automationAvailable": "arg",
            "category": "Scalability",
            "description": "Azure CNI enhances cluster IP and network management, allowing dynamic IP allocation, scalable subnets, direct pod-VNET connectivity, and supports diverse network policies for pods and nodes with Azure Network Policies and Calico, optimizing network efficiency and security\n",
            "graph": "// Azure Resource Graph Query\n// Check AKS Clusters using kubenet network profile\nresources\n| where type == \"microsoft.containerservice/managedclusters\"\n| extend networkProfile = tostring (parse_json(properties.networkProfile.networkPlugin))\n| where networkProfile ==\"kubenet\"\n| project recommendationId=\"c22db132-399b-4e7c-995d-577a60881be8\", name, id, tags, param1=strcat(\"networkProfile :\",networkProfile)\n\n",
            "guid": "c22db132-399b-4e7c-995d-577a60881be8",
            "learnMoreLink": [
                {
                    "name": "Configure Azure CNI networking",
                    "url": "https://learn.microsoft.com/en-us/azure/aks/configure-azure-cni-dynamic-ip-allocation"
                },
                {
                    "name": "Configure Azure CNI Overlay networking",
                    "url": "https://learn.microsoft.com/en-us/azure/aks/azure-cni-overlay"
                }
            ],
            "longDescription": "Azure CNI enhances cluster IP and network management, allowing dynamic IP allocation, scalable subnets, direct pod-VNET connectivity, and supports diverse network policies for pods and nodes with Azure Network Policies and Calico, optimizing network efficiency and security\n",
            "pgVerified": false,
            "potentialBenefits": "Dynamic IP allocation, scalable subnets, direct VNET access",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Scalability",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.ContainerService/managedClusters",
            "recommendationTypeId": null,
            "service": "AKS",
            "severity": "Medium",
            "source": "azure-resources/ContainerService/managedClusters/recommendations.yaml",
            "tags": null,
            "text": "Configure Azure CNI networking for dynamic allocation of IPs"
        },
        {
            "aprlGuid": "902c82ff-4910-4b61-942d-0d6ef7f39b67",
            "automationAvailable": "arg",
            "category": "Scalability",
            "description": "The cluster auto-scaler in AKS adjusts node counts based on pod resource needs and available capacity, enabling scaling as per demand to prevent outages.\n",
            "graph": "// Azure Resource Graph Query\n// Find AKS clusters with auto-scaling disabled\nResources\n| where type == \"microsoft.containerservice/managedclusters\"\n| extend autoScaling = tostring (parse_json(properties.agentPoolProfiles.[0].enableAutoScaling))\n| where autoScaling == \"false\"\n| project recommendationId=\"902c82ff-4910-4b61-942d-0d6ef7f39b67\", name, id, tags, param1=strcat(\"autoScaling :\", autoScaling)\n\n",
            "guid": "902c82ff-4910-4b61-942d-0d6ef7f39b67",
            "learnMoreLink": [
                {
                    "name": "Use the Cluster Autoscaler on AKS",
                    "url": "https://learn.microsoft.com/azure/aks/cluster-autoscaler?tabs=azure-cli"
                },
                {
                    "name": "Best practices for advanced scheduler features",
                    "url": "https://learn.microsoft.com/azure/aks/operator-best-practices-advanced-scheduler"
                },
                {
                    "name": "Node pool scaling considerations and best practices",
                    "url": "https://learn.microsoft.com/azure/aks/best-practices-performance-scale-large#node-pool-scaling"
                },
                {
                    "name": "Best practices for basic scheduler features",
                    "url": "https://learn.microsoft.com/azure/aks/operator-best-practices-scheduler"
                }
            ],
            "longDescription": "The cluster auto-scaler in AKS adjusts node counts based on pod resource needs and available capacity, enabling scaling as per demand to prevent outages.\n",
            "pgVerified": true,
            "potentialBenefits": "Optimizes scaling and prevents outages",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Scalability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.ContainerService/managedClusters",
            "recommendationTypeId": null,
            "service": "AKS",
            "severity": "High",
            "source": "azure-resources/ContainerService/managedClusters/recommendations.yaml",
            "tags": null,
            "text": "Enable the cluster auto-scaler on an existing cluster"
        },
        {
            "aprlGuid": "269a9f1a-6675-460a-831e-b05a887a8c4b",
            "automationAvailable": "arg",
            "category": "Disaster Recovery",
            "description": "AKS, popular for stateful apps needing backups, can now use Azure Backup to secure clusters and attached volumes through an installed Backup Extension, enabling backup and restore operations via a Backup Vault.\n",
            "graph": "// Azure Resource Graph Query\n// Find AKS clusters that do not have backup enabled\n\nresources\n| where type =~ 'Microsoft.ContainerService/managedClusters'\n| extend lname = tolower(name)\n| join kind=leftouter(recoveryservicesresources\n    | where type =~ 'microsoft.dataprotection/backupvaults/backupinstances'\n    | extend lname = tolower(tostring(split(properties.dataSourceInfo.resourceID, '/')[8]))\n    | extend protectionState = properties.currentProtectionState\n    | project lname, protectionState) on lname\n| where protectionState != 'ProtectionConfigured'\n| extend param1 = iif(isnull(protectionState), 'Protection Not Configured', strcat('Protection State: ', protectionState))\n| project recommendationId = \"269a9f1a-6675-460a-831e-b05a887a8c4b\", name, id, tags, param1\n\n",
            "guid": "269a9f1a-6675-460a-831e-b05a887a8c4b",
            "learnMoreLink": [
                {
                    "name": "AKS Backups",
                    "url": "https://learn.microsoft.com/en-us/azure/backup/azure-kubernetes-service-cluster-backup"
                },
                {
                    "name": "Best Practices for AKS Backups",
                    "url": "https://learn.microsoft.com/en-us/azure/aks/operator-best-practices-storage"
                }
            ],
            "longDescription": "AKS, popular for stateful apps needing backups, can now use Azure Backup to secure clusters and attached volumes through an installed Backup Extension, enabling backup and restore operations via a Backup Vault.\n",
            "pgVerified": true,
            "potentialBenefits": "Ensures data safety for AKS",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Disaster Recovery",
            "recommendationImpact": "Low",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.ContainerService/managedClusters",
            "recommendationTypeId": null,
            "service": "AKS",
            "severity": "Low",
            "source": "azure-resources/ContainerService/managedClusters/recommendations.yaml",
            "tags": null,
            "text": "Back up Azure Kubernetes Service"
        },
        {
            "aprlGuid": "d3111036-355d-431b-ab49-8ddad042800b",
            "automationAvailable": false,
            "category": "High Availability",
            "description": "ZRS ensures data replication across three zones, protecting against zonal outages. It's available for Azure Disks, Container Storage, Files, and Blob by setting the SKU to ZRS in storage classes, enhancing multi-zone AKS clusters from v1.29.\n",
            "graph": "// cannot-be-validated-with-arg\n\n",
            "guid": "d3111036-355d-431b-ab49-8ddad042800b",
            "learnMoreLink": [
                {
                    "name": "Availability zones overview",
                    "url": "https://learn.microsoft.com/azure/reliability/availability-zones-overview?tabs=azure-cli"
                },
                {
                    "name": "Zone-redundant storage",
                    "url": "https://learn.microsoft.com/azure/storage/common/storage-redundancy#zone-redundant-storage"
                },
                {
                    "name": "ZRS disks",
                    "url": "https://learn.microsoft.com/azure/virtual-machines/disks-redundancy#zone-redundant-storage-for-managed-disks"
                },
                {
                    "name": "Convert a disk from LRS to ZRS",
                    "url": "https://learn.microsoft.com/azure/virtual-machines/disks-migrate-lrs-zrs"
                },
                {
                    "name": "Enable multi-zone storage redundancy in Azure Container Storage",
                    "url": "https://learn.microsoft.com/azure/storage/container-storage/enable-multi-zone-redundancy"
                }
            ],
            "longDescription": "ZRS ensures data replication across three zones, protecting against zonal outages. It's available for Azure Disks, Container Storage, Files, and Blob by setting the SKU to ZRS in storage classes, enhancing multi-zone AKS clusters from v1.29.\n",
            "pgVerified": true,
            "potentialBenefits": "Increases data durability and availability",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.ContainerService/managedClusters",
            "recommendationTypeId": null,
            "service": "AKS",
            "severity": "Medium",
            "source": "azure-resources/ContainerService/managedClusters/recommendations.yaml",
            "tags": null,
            "text": "Use zone-redundant storage for persistent volumes when running multi-zone AKS"
        },
        {
            "aprlGuid": "b002c030-72e6-4a37-8217-1cb276c43169",
            "automationAvailable": false,
            "category": "Governance",
            "description": "From Kubernetes 1.26, Azure Disk and Azure File in-tree drivers are deprecated in favor of CSI drivers. Existing deployments remain operational but untested; users should switch to CSI drivers for new features and SKUs.\n",
            "graph": "// cannot-be-validated-with-arg\n\n",
            "guid": "b002c030-72e6-4a37-8217-1cb276c43169",
            "learnMoreLink": [
                {
                    "name": "CSI Storage Drivers",
                    "url": "https://learn.microsoft.com/azure/aks/csi-storage-drivers"
                },
                {
                    "name": "CSI Migrate in Tree Volumes",
                    "url": "https://learn.microsoft.com/azure/aks/csi-migrate-in-tree-volumes"
                }
            ],
            "longDescription": "From Kubernetes 1.26, Azure Disk and Azure File in-tree drivers are deprecated in favor of CSI drivers. Existing deployments remain operational but untested; users should switch to CSI drivers for new features and SKUs.\n",
            "pgVerified": true,
            "potentialBenefits": "Ensures future compatibility",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Governance",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.ContainerService/managedClusters",
            "recommendationTypeId": null,
            "service": "AKS",
            "severity": "High",
            "source": "azure-resources/ContainerService/managedClusters/recommendations.yaml",
            "tags": null,
            "text": "Upgrade Persistent Volumes using in-tree drivers to Azure CSI drivers"
        },
        {
            "aprlGuid": "9a1c17e5-c9a0-43db-b920-adaf54d1bcb7",
            "automationAvailable": false,
            "category": "Scalability",
            "description": "A ResourceQuota object sets limits on resource use per namespace, controlling the number and type of objects created, and the total compute resources available.\n",
            "graph": "// cannot-be-validated-with-arg\n\n",
            "guid": "9a1c17e5-c9a0-43db-b920-adaf54d1bcb7",
            "learnMoreLink": [
                {
                    "name": "Resource Quotas",
                    "url": "https://kubernetes.io/docs/concepts/policy/resource-quotas/"
                }
            ],
            "longDescription": "A ResourceQuota object sets limits on resource use per namespace, controlling the number and type of objects created, and the total compute resources available.\n",
            "pgVerified": false,
            "potentialBenefits": "Limits AKS resource usage per namespace",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Scalability",
            "recommendationImpact": "Low",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.ContainerService/managedClusters",
            "recommendationTypeId": null,
            "service": "AKS",
            "severity": "Low",
            "source": "azure-resources/ContainerService/managedClusters/recommendations.yaml",
            "tags": null,
            "text": "Implement Resource Quota to ensure that Kubernetes resources do not exceed hard resource limits"
        },
        {
            "aprlGuid": "b4639ca7-6308-429a-8b98-92f0bf9bf813",
            "automationAvailable": false,
            "category": "Scalability",
            "description": "To rapidly scale AKS workloads, utilize virtual nodes for quick pod provisioning, unlike Kubernetes auto-scaler. For clusters with availability zones, ensure one nodepool per AZ due to persistent volumes not working across AZs, preventing auto-scaler pod creation failures if lacking access.\n",
            "graph": "// cannot-be-validated-with-arg\n\n",
            "guid": "b4639ca7-6308-429a-8b98-92f0bf9bf813",
            "learnMoreLink": [
                {
                    "name": "Virtual Nodes",
                    "url": "https://learn.microsoft.com/azure/aks/virtual-nodes"
                },
                {
                    "name": "Azure Container Instances",
                    "url": "https://learn.microsoft.com/azure/container-instances/container-instances-overview"
                }
            ],
            "longDescription": "To rapidly scale AKS workloads, utilize virtual nodes for quick pod provisioning, unlike Kubernetes auto-scaler. For clusters with availability zones, ensure one nodepool per AZ due to persistent volumes not working across AZs, preventing auto-scaler pod creation failures if lacking access.\n",
            "pgVerified": false,
            "potentialBenefits": "Faster scaling with virtual nodes",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Scalability",
            "recommendationImpact": "Low",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.ContainerService/managedClusters",
            "recommendationTypeId": null,
            "service": "AKS",
            "severity": "Low",
            "source": "azure-resources/ContainerService/managedClusters/recommendations.yaml",
            "tags": null,
            "text": "Attach Virtual Nodes (ACI) to the AKS cluster"
        },
        {
            "aprlGuid": "0611251f-e70f-4243-8ddd-cfe894bec2e7",
            "automationAvailable": "arg",
            "category": "High Availability",
            "description": "Production AKS clusters require the Standard tier for a financially backed SLA and enhanced node scalability, as the free service lacks these features.\n",
            "graph": "// Azure Resource Graph Query\n// Returns all AKS clusters not running on the Standard tier\nresources\n| where type == \"microsoft.containerservice/managedclusters\"\n| where sku.tier != \"Standard\"\n| project recommendationId=\"0611251f-e70f-4243-8ddd-cfe894bec2e7\", id, name, tags, param1=strcat(\"skuName: \", sku.name), param2=strcat(\"skuTier: \", sku.tier)\n\n",
            "guid": "0611251f-e70f-4243-8ddd-cfe894bec2e7",
            "learnMoreLink": [
                {
                    "name": "Pricing Tiers",
                    "url": "https://learn.microsoft.com/en-us/azure/aks/free-standard-pricing-tiers"
                },
                {
                    "name": "AKS Baseline Architecture",
                    "url": "https://learn.microsoft.com/en-us/azure/architecture/reference-architectures/containers/aks/baseline-aks?toc=https%3A%2F%2Flearn.microsoft.com%2Fen-us%2Fazure%2Faks%2Ftoc.json&bc=https%3A%2F%2Flearn.microsoft.com%2Fen-us%2Fazure%2Fbread%2Ftoc.json#kubernetes-api-server-sla"
                }
            ],
            "longDescription": "Production AKS clusters require the Standard tier for a financially backed SLA and enhanced node scalability, as the free service lacks these features.\n",
            "pgVerified": true,
            "potentialBenefits": "SLA guarantee and better scalability",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.ContainerService/managedClusters",
            "recommendationTypeId": null,
            "service": "AKS",
            "severity": "High",
            "source": "azure-resources/ContainerService/managedClusters/recommendations.yaml",
            "tags": null,
            "text": "Update AKS tier to Standard"
        },
        {
            "aprlGuid": "dcaf8128-94bd-4d53-9235-3a0371df6b74",
            "automationAvailable": "arg",
            "category": "Monitoring and Alerting",
            "description": "Azure Monitor enables real-time health and performance insights for AKS by collecting events, capturing container logs, and gathering CPU/Memory data from the Metrics API. It allows data visualization using Azure Monitor Container Insights, Prometheus, Grafana, or others.\n",
            "graph": "// Azure Resource Graph Query\n// Returns AKS clusters where either Azure Monitor is not enabled and/or Container Insights is not enabled\nresources\n|  where type == \"microsoft.containerservice/managedclusters\"\n|  extend azureMonitor = tostring(parse_json(properties.azureMonitorProfile.metrics.enabled))\n|  extend insights = tostring(parse_json(properties.addonProfiles.omsagent.enabled))\n|  where isempty(azureMonitor) or isempty(insights)\n|  project recommendationId=\"dcaf8128-94bd-4d53-9235-3a0371df6b74\",id, name, tags, param1=strcat(\"azureMonitorProfileEnabled: \", iff(isempty(azureMonitor), \"false\", azureMonitor)), param2=strcat(\"containerInsightsEnabled: \", iff(isempty(insights), \"false\", insights))\n\n",
            "guid": "dcaf8128-94bd-4d53-9235-3a0371df6b74",
            "learnMoreLink": [
                {
                    "name": "Monitor AKS",
                    "url": "https://learn.microsoft.com/azure/aks/monitor-aks"
                }
            ],
            "longDescription": "Azure Monitor enables real-time health and performance insights for AKS by collecting events, capturing container logs, and gathering CPU/Memory data from the Metrics API. It allows data visualization using Azure Monitor Container Insights, Prometheus, Grafana, or others.\n",
            "pgVerified": true,
            "potentialBenefits": "Real-time AKS health/performance insights",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Monitoring and Alerting",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.ContainerService/managedClusters",
            "recommendationTypeId": null,
            "service": "AKS",
            "severity": "High",
            "source": "azure-resources/ContainerService/managedClusters/recommendations.yaml",
            "tags": null,
            "text": "Enable AKS Monitoring"
        },
        {
            "aprlGuid": "a7bfcc18-b0d8-4d37-81f3-8131ed8bead5",
            "automationAvailable": "arg",
            "category": "Scalability",
            "description": "Ephemeral OS disks on AKS offer lower read/write latency due to local attachment, eliminating the need for replication seen with managed disks. This enhances performance and speeds up cluster operations such as scaling or upgrading due to quicker re-imaging and boot times.\n",
            "graph": "// Azure Resource Graph Query\n// Returns any AKS cluster nodepools that do not have Ephemeral Disks\nresources\n| where type == \"microsoft.containerservice/managedclusters\"\n| mv-expand agentPoolProfile = properties.agentPoolProfiles\n| extend type = tostring(agentPoolProfile.osDiskType)\n| where type != 'Ephemeral'\n| project recommendationId=\"a7bfcc18-b0d8-4d37-81f3-8131ed8bead5\", name, id, param1=strcat(\"osDiskType: \", type)\n",
            "guid": "a7bfcc18-b0d8-4d37-81f3-8131ed8bead5",
            "learnMoreLink": [
                {
                    "name": "Ephemeral OS disk",
                    "url": "https://learn.microsoft.com/azure/aks/concepts-storage#ephemeral-os-disk"
                },
                {
                    "name": "Configure an AKS cluster",
                    "url": "https://learn.microsoft.com/azure/aks/cluster-configuration"
                },
                {
                    "name": "Everything you want to know about ephemeral OS disks and AKS",
                    "url": "https://learn.microsoft.com/samples/azure-samples/aks-ephemeral-os-disk/aks-ephemeral-os-disk/"
                }
            ],
            "longDescription": "Ephemeral OS disks on AKS offer lower read/write latency due to local attachment, eliminating the need for replication seen with managed disks. This enhances performance and speeds up cluster operations such as scaling or upgrading due to quicker re-imaging and boot times.\n",
            "pgVerified": true,
            "potentialBenefits": "Lower latency, faster re-imaging and booting",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Scalability",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.ContainerService/managedClusters",
            "recommendationTypeId": null,
            "service": "AKS",
            "severity": "Medium",
            "source": "azure-resources/ContainerService/managedClusters/recommendations.yaml",
            "tags": null,
            "text": "Use Ephemeral OS disks on AKS clusters"
        },
        {
            "aprlGuid": "26ebaf1f-c70d-4ebd-8641-4b60a0ce0094",
            "automationAvailable": "arg",
            "category": "Governance",
            "description": "Azure Policies in AKS clusters help enforce governance best practices concerning security, authentication, provisioning, networking, and more, ensuring a robust and secure environment for operations.\n",
            "graph": "// Azure Resource Graph Query\n// Returns a count of non-compliant policy items per AKS cluster\nPolicyResources\n| where type =~ 'Microsoft.PolicyInsights/PolicyStates'\n| extend complianceState = tostring(properties.complianceState)\n| where complianceState == 'NonCompliant'\n| where properties.resourceType =~ 'Microsoft.ContainerService/managedClusters'\n| extend\n    id = tostring(properties.resourceId)\n| summarize count() by id\n| join kind=inner (\n    resources\n    | where type =~ 'Microsoft.ContainerService/managedClusters'\n    | project id, name\n) on id\n| project recommendationId=\"26ebaf1f-c70d-4ebd-8641-4b60a0ce0094\", id, name, param1=strcat(\"numNonCompliantAlerts: \", count_)\n",
            "guid": "26ebaf1f-c70d-4ebd-8641-4b60a0ce0094",
            "learnMoreLink": [
                {
                    "name": "AKS Baseline - Policy Management",
                    "url": "https://learn.microsoft.com/en-us/azure/architecture/reference-architectures/containers/aks/baseline-aks?toc=https%3A%2F%2Flearn.microsoft.com%2Fen-us%2Fazure%2Faks%2Ftoc.json&bc=https%3A%2F%2Flearn.microsoft.com%2Fen-us%2Fazure%2Fbread%2Ftoc.json#policy-management"
                },
                {
                    "name": "Built-in Policy Definitions for AKS",
                    "url": "https://learn.microsoft.com/en-us/azure/aks/policy-reference"
                }
            ],
            "longDescription": "Azure Policies in AKS clusters help enforce governance best practices concerning security, authentication, provisioning, networking, and more, ensuring a robust and secure environment for operations.\n",
            "pgVerified": false,
            "potentialBenefits": "Enhanced AKS governance and security",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Governance",
            "recommendationImpact": "Low",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.ContainerService/managedClusters",
            "recommendationTypeId": null,
            "service": "AKS",
            "severity": "Low",
            "source": "azure-resources/ContainerService/managedClusters/recommendations.yaml",
            "tags": null,
            "text": "Enable and remediate Azure Policies configured for AKS"
        },
        {
            "aprlGuid": "5f3cbd68-692a-4121-988c-9770914859a9",
            "automationAvailable": "arg",
            "category": "Other Best Practices",
            "description": "GitOps, an operating model for cloud-native apps, uses Git for storing application and infrastructure code as a source of truth for continuous delivery.\n",
            "graph": "// Azure Resource Graph Query\n// Returns AKS clusters where GitOps is not enabled\nresources\n|  where type == \"microsoft.containerservice/managedclusters\"\n|  extend gitops = tostring (parse_json(properties.addOnProfiles.gitops.enabled))\n|  where isempty(gitops)\n|  project recommendationId=\"5f3cbd68-692a-4121-988c-9770914859a9\", id, name, tags, param1=strcat(\"gitopsEnabled: \", \"false\")\n\n",
            "guid": "5f3cbd68-692a-4121-988c-9770914859a9",
            "learnMoreLink": [
                {
                    "name": "GitOps with AKS",
                    "url": "https://learn.microsoft.com/en-us/azure/architecture/guide/aks/aks-cicd-github-actions-and-gitops"
                },
                {
                    "name": "GitOps for AKS - Reference Architecture",
                    "url": "https://learn.microsoft.com/en-us/azure/architecture/example-scenario/gitops-aks/gitops-blueprint-aks"
                }
            ],
            "longDescription": "GitOps, an operating model for cloud-native apps, uses Git for storing application and infrastructure code as a source of truth for continuous delivery.\n",
            "pgVerified": false,
            "potentialBenefits": "Ensures AKS config consistency",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Other Best Practices",
            "recommendationImpact": "Low",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.ContainerService/managedClusters",
            "recommendationTypeId": null,
            "service": "AKS",
            "severity": "Low",
            "source": "azure-resources/ContainerService/managedClusters/recommendations.yaml",
            "tags": null,
            "text": "Enable GitOps when using DevOps frameworks"
        },
        {
            "aprlGuid": "928fcc6f-5e9a-42d9-9bd4-260af42de2e5",
            "automationAvailable": false,
            "category": "High Availability",
            "description": "Enhance availability and reliability by using pod topology spread constraints to control pod distribution based on node or zone topology, ensuring pods are spread across your cluster.\n",
            "graph": "// cannot-be-validated-with-arg\n\n",
            "guid": "928fcc6f-5e9a-42d9-9bd4-260af42de2e5",
            "learnMoreLink": [
                {
                    "name": "Topology Spread Constraints",
                    "url": "https://kubernetes.io/docs/concepts/scheduling-eviction/topology-spread-constraints/"
                },
                {
                    "name": "Assign Pod Node",
                    "url": "https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/"
                }
            ],
            "longDescription": "Enhance availability and reliability by using pod topology spread constraints to control pod distribution based on node or zone topology, ensuring pods are spread across your cluster.\n",
            "pgVerified": true,
            "potentialBenefits": "Ensures high availability and efficient use",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.ContainerService/managedClusters",
            "recommendationTypeId": null,
            "service": "AKS",
            "severity": "High",
            "source": "azure-resources/ContainerService/managedClusters/recommendations.yaml",
            "tags": null,
            "text": "Use pod topology spread constraints to ensure that pods are spread across different nodes or zones"
        },
        {
            "aprlGuid": "cd6791b1-c60e-4b37-ac98-9897b1e6f4b8",
            "automationAvailable": false,
            "category": "High Availability",
            "description": "AKS kubelet controller uses liveness probes to validate containers and applications health, ensuring the system knows when to restart a container based on its health status.\n",
            "graph": "// cannot-be-validated-with-arg\n\n",
            "guid": "cd6791b1-c60e-4b37-ac98-9897b1e6f4b8",
            "learnMoreLink": [
                {
                    "name": "Configure probes",
                    "url": "https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/"
                },
                {
                    "name": "Assign Pod Node",
                    "url": "https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/"
                }
            ],
            "longDescription": "AKS kubelet controller uses liveness probes to validate containers and applications health, ensuring the system knows when to restart a container based on its health status.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhances container health monitoring",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.ContainerService/managedClusters",
            "recommendationTypeId": null,
            "service": "AKS",
            "severity": "High",
            "source": "azure-resources/ContainerService/managedClusters/recommendations.yaml",
            "tags": null,
            "text": "Configures Pods Liveness, Readiness, and Startup Probes"
        },
        {
            "aprlGuid": "bcfe71f1-ebed-49e5-a84a-193b81ad5d27",
            "automationAvailable": false,
            "category": "High Availability",
            "description": "Configuring multiple replicas in Pod or Deployment manifests stabilizes the number of replica Pods, ensuring that a specified number of identical Pods are always available, thereby guaranteeing their availability.\n",
            "graph": "// cannot-be-validated-with-arg\n\n",
            "guid": "bcfe71f1-ebed-49e5-a84a-193b81ad5d27",
            "learnMoreLink": [
                {
                    "name": "Replica Sets",
                    "url": "https://kubernetes.io/docs/concepts/workloads/controllers/replicaset/"
                }
            ],
            "longDescription": "Configuring multiple replicas in Pod or Deployment manifests stabilizes the number of replica Pods, ensuring that a specified number of identical Pods are always available, thereby guaranteeing their availability.\n",
            "pgVerified": true,
            "potentialBenefits": "Ensures stable pod availability",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.ContainerService/managedClusters",
            "recommendationTypeId": null,
            "service": "AKS",
            "severity": "High",
            "source": "azure-resources/ContainerService/managedClusters/recommendations.yaml",
            "tags": null,
            "text": "Use deployments with multiple replicas in production applications to guarantee availability"
        },
        {
            "aprlGuid": "7f7ae535-a5ba-4665-b7e0-c451dbdda01f",
            "automationAvailable": "arg",
            "category": "High Availability",
            "description": "The system node pool should be configured with a minimum node count of two to ensure critical system pods are resilient to node outages.\n",
            "graph": "// Azure Resource Graph Query\n// Returns each AKS cluster with nodepools that have system nodepools with less than 2 nodes\nresources\n| where type == \"microsoft.containerservice/managedclusters\"\n| mv-expand agentPoolProfile = properties.agentPoolProfiles\n| extend taints = tostring(parse_json(agentPoolProfile.nodeTaints))\n| extend nodePool = tostring(parse_json(agentPoolProfile.name))\n| where taints has \"CriticalAddonsOnly=true:NoSchedule\" and  agentPoolProfile.minCount < 2\n| project recommendationId=\"7f7ae535-a5ba-4665-b7e0-c451dbdda01f\", id, name, param1=strcat(\"nodePoolName: \", nodePool), param2=strcat(\"nodePoolMinNodeCount: \", agentPoolProfile.minCount)\n\n",
            "guid": "7f7ae535-a5ba-4665-b7e0-c451dbdda01f",
            "learnMoreLink": [
                {
                    "name": "System nodepools",
                    "url": "https://learn.microsoft.com/azure/aks/use-system-pools?tabs=azure-cli"
                }
            ],
            "longDescription": "The system node pool should be configured with a minimum node count of two to ensure critical system pods are resilient to node outages.\n",
            "pgVerified": true,
            "potentialBenefits": "Ensures pod resilience",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.ContainerService/managedClusters",
            "recommendationTypeId": null,
            "service": "AKS",
            "severity": "High",
            "source": "azure-resources/ContainerService/managedClusters/recommendations.yaml",
            "tags": null,
            "text": "Configure system nodepool count"
        },
        {
            "aprlGuid": "005ccbbd-aeab-46ef-80bd-9bd4479412ec",
            "automationAvailable": "arg",
            "category": "High Availability",
            "description": "Configuring the user node pool with at least two nodes is essential for applications needing high availability, ensuring they remain operational and accessible without interruption.\n",
            "graph": "// Azure Resource Graph Query\n// Returns each AKS cluster with nodepools that have user nodepools with less than 2 nodes\nresources\n| where type == \"microsoft.containerservice/managedclusters\"\n| mv-expand agentPoolProfile = properties.agentPoolProfiles\n| extend taints = tostring(parse_json(agentPoolProfile.nodeTaints))\n| extend nodePool = tostring(parse_json(agentPoolProfile.name))\n| where taints !has \"CriticalAddonsOnly=true:NoSchedule\" and  agentPoolProfile.minCount < 2\n| project recommendationId=\"005ccbbd-aeab-46ef-80bd-9bd4479412ec\", id, name, param1=strcat(\"nodePoolName: \", nodePool), param2=strcat(\"nodePoolMinNodeCount: \", agentPoolProfile.minCount)\n\n",
            "guid": "005ccbbd-aeab-46ef-80bd-9bd4479412ec",
            "learnMoreLink": [
                {
                    "name": "Azure Well-Architected Framework review for Azure Kubernetes Service (AKS)",
                    "url": "https://learn.microsoft.com/azure/well-architected/service-guides/azure-kubernetes-service#design-checklist"
                }
            ],
            "longDescription": "Configuring the user node pool with at least two nodes is essential for applications needing high availability, ensuring they remain operational and accessible without interruption.\n",
            "pgVerified": true,
            "potentialBenefits": "Ensures high app availability",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.ContainerService/managedClusters",
            "recommendationTypeId": null,
            "service": "AKS",
            "severity": "High",
            "source": "azure-resources/ContainerService/managedClusters/recommendations.yaml",
            "tags": null,
            "text": "Configure user nodepool count"
        },
        {
            "aprlGuid": "a08a06a0-e41a-4b99-83bb-69ce8bca54cb",
            "automationAvailable": false,
            "category": "High Availability",
            "description": "A Pod Disruption Budget is a Kubernetes resource configuring the minimum number or percentage of pods that should remain available during disruptions like maintenance or scaling, ensuring a minimum number of pods are always available in the cluster.\n",
            "graph": "// cannot-be-validated-with-arg\n\n",
            "guid": "a08a06a0-e41a-4b99-83bb-69ce8bca54cb",
            "learnMoreLink": [
                {
                    "name": "Configure PDBs",
                    "url": "https://kubernetes.io/docs/tasks/run-application/configure-pdb/"
                },
                {
                    "name": "Plan availability using PDBs",
                    "url": "https://learn.microsoft.com/azure/aks/operator-best-practices-scheduler#plan-for-availability-using-pod-disruption-budgets"
                }
            ],
            "longDescription": "A Pod Disruption Budget is a Kubernetes resource configuring the minimum number or percentage of pods that should remain available during disruptions like maintenance or scaling, ensuring a minimum number of pods are always available in the cluster.\n",
            "pgVerified": true,
            "potentialBenefits": "Ensures cluster resiliency during disruptions",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.ContainerService/managedClusters",
            "recommendationTypeId": null,
            "service": "AKS",
            "severity": "Medium",
            "source": "azure-resources/ContainerService/managedClusters/recommendations.yaml",
            "tags": null,
            "text": "Configure pod disruption budgets (PDBs)"
        },
        {
            "aprlGuid": "e620fa98-7a40-41a0-bfc9-b4407297fb58",
            "automationAvailable": "arg",
            "category": "High Availability",
            "description": "Nodepool subnets sized for max auto-scale settings enable AKS to efficiently scale out nodes, meeting increased demand while reducing resource constraints and potential service disruptions.\n",
            "graph": "// Azure Resource Graph Query\n// Returns each AKS cluster with nodepools that have user nodepools with a subnetmask that does not match autoscale configured max-nodes\n// Subtracting the network address, broadcast address, and default 3 addresses Azure reserves within each subnet\n\nresources\n| where type == \"microsoft.containerservice/managedclusters\"\n| extend nodePools = properties['agentPoolProfiles']\n| mv-expand nodePools = properties.agentPoolProfiles\n| where nodePools.enableAutoScaling == true\n| extend nodePoolName=nodePools.name, maxNodes = nodePools.maxCount, subnetId = tostring(nodePools.vnetSubnetID)\n| project clusterId = id, clusterName=name, nodePoolName=nodePools.name, toint(maxNodes), subnetId\n| join kind = leftouter (\n    resources\n    | where type == 'microsoft.network/virtualnetworks'\n    | extend subnets = properties.subnets\n    | mv-expand subnets\n    | project id = tostring(subnets.id), addressPrefix = tostring(subnets.properties['addressPrefix'])\n    | extend subnetmask = toint(substring(addressPrefix, indexof(addressPrefix, '/')+1, string_size(addressPrefix)))\n    | extend possibleMaxNodeCount = toint(exp2(32-subnetmask) - 5)\n) on $left.subnetId == $right.id\n| project-away id, subnetmask\n| where possibleMaxNodeCount <= maxNodes\n| extend param1 = strcat(nodePoolName, \" autoscaler upper limit: \", maxNodes)\n| extend param2 = strcat(\"ip addresses on subnet: \", possibleMaxNodeCount)\n| project recommendationId=\"e620fa98-7a40-41a0-bfc9-b4407297fb58\", name=clusterName, id=clusterId, param1, param2\n\n",
            "guid": "e620fa98-7a40-41a0-bfc9-b4407297fb58",
            "learnMoreLink": [
                {
                    "name": "Azure CNI Dynamic IP Allocation",
                    "url": "https://learn.microsoft.com/azure/aks/configure-azure-cni-dynamic-ip-allocation"
                }
            ],
            "longDescription": "Nodepool subnets sized for max auto-scale settings enable AKS to efficiently scale out nodes, meeting increased demand while reducing resource constraints and potential service disruptions.\n",
            "pgVerified": false,
            "potentialBenefits": "Efficient scaling, reduced disruptions",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.ContainerService/managedClusters",
            "recommendationTypeId": null,
            "service": "AKS",
            "severity": "High",
            "source": "azure-resources/ContainerService/managedClusters/recommendations.yaml",
            "tags": null,
            "text": "Nodepool subnet size needs to accommodate maximum auto-scale settings"
        },
        {
            "aprlGuid": "a01afc4c-7439-4919-b2da-3565992ea2a7",
            "automationAvailable": false,
            "category": "High Availability",
            "description": "Node pool settings should not exceed the subscription core quota to ensure AKS can scale out nodes efficiently, meeting increased demand while reducing resource constraints and potential service disruptions.\n",
            "graph": "// cannot-be-validated-with-arg\n",
            "guid": "a01afc4c-7439-4919-b2da-3565992ea2a7",
            "learnMoreLink": [
                {
                    "name": "Azure Quotas",
                    "url": "https://learn.microsoft.com/azure/quotas/quotas-overview"
                }
            ],
            "longDescription": "Node pool settings should not exceed the subscription core quota to ensure AKS can scale out nodes efficiently, meeting increased demand while reducing resource constraints and potential service disruptions.\n",
            "pgVerified": false,
            "potentialBenefits": "Reduced disruptions",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.ContainerService/managedClusters",
            "recommendationTypeId": null,
            "service": "AKS",
            "severity": "High",
            "source": "azure-resources/ContainerService/managedClusters/recommendations.yaml",
            "tags": null,
            "text": "Node pool auto-scale settings should not exceed subscription core quota"
        },
        {
            "aprlGuid": "f46b0d1d-56ef-4795-b98a-f6ee00cb341a",
            "automationAvailable": "arg",
            "category": "High Availability",
            "description": "Azure Linux on AKS boosts resiliency with a native image using validated, source-built components. It's lightweight, reducing the attack surface and maintenance. A Microsoft-hardened kernel, optimized for Azure, enhances stability and security for container workloads.\n",
            "graph": "// Azure Resource Graph Query\n// Returns each AKS cluster with nodepools that have Linux nodepools not using Azure Linux\nresources\n| where type == \"microsoft.containerservice/managedclusters\"\n| mv-expand agentPoolProfile = properties.agentPoolProfiles\n| where agentPoolProfile.osType == 'Linux' and agentPoolProfile.osSKU != 'AzureLinux'\n| project recommendationid=\"f46b0d1d-56ef-4795-b98a-f6ee00cb341a\", name, id, param1=strcat(\"nodePoolName: \", agentPoolProfile.name)\n",
            "guid": "f46b0d1d-56ef-4795-b98a-f6ee00cb341a",
            "learnMoreLink": [
                {
                    "name": "Azure Linux",
                    "url": "https://learn.microsoft.com/azure/aks/use-azure-linux"
                }
            ],
            "longDescription": "Azure Linux on AKS boosts resiliency with a native image using validated, source-built components. It's lightweight, reducing the attack surface and maintenance. A Microsoft-hardened kernel, optimized for Azure, enhances stability and security for container workloads.\n",
            "pgVerified": false,
            "potentialBenefits": "Reduced disruptions",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.ContainerService/managedClusters",
            "recommendationTypeId": null,
            "service": "AKS",
            "severity": "High",
            "source": "azure-resources/ContainerService/managedClusters/recommendations.yaml",
            "tags": null,
            "text": "Use Azure Linux for Linux nodepools"
        },
        {
            "aprlGuid": "9200aca6-0e83-4749-a5eb-e3939367bdc2",
            "automationAvailable": false,
            "category": "High Availability",
            "description": "Deploying at least two replicas of your application ensures that your application is highly available and can tolerate node failures.\n",
            "graph": "// cannot-be-validated-with-arg\n",
            "guid": "9200aca6-0e83-4749-a5eb-e3939367bdc2",
            "learnMoreLink": [
                {
                    "name": "Multi-replica apps",
                    "url": "https://learn.microsoft.com/azure/aks/best-practices-app-cluster-reliability#multi-replica-applications"
                }
            ],
            "longDescription": "Deploying at least two replicas of your application ensures that your application is highly available and can tolerate node failures.\n",
            "pgVerified": false,
            "potentialBenefits": "Ensures high app availability",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.ContainerService/managedClusters",
            "recommendationTypeId": null,
            "service": "AKS",
            "severity": "High",
            "source": "azure-resources/ContainerService/managedClusters/recommendations.yaml",
            "tags": null,
            "text": "Deploy at least two replicas of your application"
        },
        {
            "aprlGuid": "88856605-53d8-4bbd-a75b-4a7b14939d32",
            "automationAvailable": "arg",
            "category": "High Availability",
            "description": "Enable HA with zone redundancy on flexible server instances to deploy a standby replica in a different zone, offering automatic failover capability for improved reliability and disaster recovery.\n",
            "graph": "// Azure Resource Graph Query\n// Find Database for MySQL instances that are not zone redundant\nresources\n| where type == \"microsoft.dbformysql/flexibleservers\"\n| where properties.highAvailability.mode != \"ZoneRedundant\"\n| project recommendationId = \"88856605-53d8-4bbd-a75b-4a7b14939d32\", name, id, tags, param1 = \"ZoneRedundant: False\"\n",
            "guid": "88856605-53d8-4bbd-a75b-4a7b14939d32",
            "learnMoreLink": [
                {
                    "name": "High availability concepts in Azure Database for MySQL - Flexible Server",
                    "url": "https://learn.microsoft.com/azure/mysql/flexible-server/concepts-high-availability"
                }
            ],
            "longDescription": "Enable HA with zone redundancy on flexible server instances to deploy a standby replica in a different zone, offering automatic failover capability for improved reliability and disaster recovery.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhanced uptime and data protection",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.DBforMySQL/flexibleServers",
            "recommendationTypeId": null,
            "service": "Azure MySQL",
            "severity": "High",
            "source": "azure-resources/DBforMySQL/flexibleServers/recommendations.yaml",
            "tags": null,
            "text": "Enable HA with zone redundancy"
        },
        {
            "aprlGuid": "82a9a0f2-24ee-496f-9ad2-25f81710942d",
            "automationAvailable": "arg",
            "category": "Scalability",
            "description": "Use custom maintenance schedule on flexible server instances to select a preferred time for service updates to be applied.\n",
            "graph": "// Azure Resource Graph Query\n// Find Database for MySQL instances that do not have a custom maintenance window\nresources\n| where type =~ \"microsoft.dbformysql/flexibleservers\"\n| where properties.maintenanceWindow.customWindow != \"Enabled\"\n| project recommendationId = \"82a9a0f2-24ee-496f-9ad2-25f81710942d\", name, id, tags, param1 = strcat(\"customWindow:\", properties['maintenanceWindow']['customWindow'])\n",
            "guid": "82a9a0f2-24ee-496f-9ad2-25f81710942d",
            "learnMoreLink": [
                {
                    "name": "Scheduled maintenance in Azure Database for MySQL - Flexible Server",
                    "url": "https://learn.microsoft.com/azure/mysql/flexible-server/concepts-maintenance"
                }
            ],
            "longDescription": "Use custom maintenance schedule on flexible server instances to select a preferred time for service updates to be applied.\n",
            "pgVerified": true,
            "potentialBenefits": "Control update timings",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Scalability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.DBforMySQL/flexibleServers",
            "recommendationTypeId": null,
            "service": "Azure MySQL",
            "severity": "High",
            "source": "azure-resources/DBforMySQL/flexibleServers/recommendations.yaml",
            "tags": null,
            "text": "Enable custom maintenance schedule"
        },
        {
            "aprlGuid": "5c96afc3-7d2e-46ff-a4c7-9c32850c441b",
            "automationAvailable": "arg",
            "category": "Disaster Recovery",
            "description": "Configure GRS to ensure that your database meets its availability and durability targets even in the face of failures or disasters.\n",
            "graph": "// Azure Resource Graph Query\n// Find Database for MySQL instances that do not have geo redundant backup storage enabled\nresources\n| where type =~ \"microsoft.dbformysql/flexibleservers\"\n| where properties.backup.geoRedundantBackup != \"Enabled\"\n| project recommendationId = \"5c96afc3-7d2e-46ff-a4c7-9c32850c441b\", name, id, tags, param1 = strcat(\"geoRedundantBackup:\", properties['backup']['geoRedundantBackup'])\n",
            "guid": "5c96afc3-7d2e-46ff-a4c7-9c32850c441b",
            "learnMoreLink": [
                {
                    "name": "Backup and restore in Azure Database for MySQL - Flexible Server",
                    "url": "https://learn.microsoft.com/en-us/azure/mysql/flexible-server/concepts-backup-restore"
                }
            ],
            "longDescription": "Configure GRS to ensure that your database meets its availability and durability targets even in the face of failures or disasters.\n",
            "pgVerified": true,
            "potentialBenefits": "Recover from regional failure and/or disaster",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Disaster Recovery",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.DBforMySQL/flexibleServers",
            "recommendationTypeId": null,
            "service": "Azure MySQL",
            "severity": "High",
            "source": "azure-resources/DBforMySQL/flexibleServers/recommendations.yaml",
            "tags": null,
            "text": "Configure geo redundant backup storage"
        },
        {
            "aprlGuid": "b49a8653-cc43-48c9-8513-a2d2e3f14dd1",
            "automationAvailable": "arg",
            "category": "Disaster Recovery",
            "description": "Configure one or more read replicas to ensure that your database meets its availability and durability targets even in the face of failures or disasters.\n",
            "graph": "// Azure Resource Graph Query\n// Find Database for MySQL instances that do not have a read replica configured\nresources\n| where type =~ \"microsoft.dbformysql/flexibleservers\"\n| where properties.replicationRole == \"None\"\n| project recommendationId = \"b49a8653-cc43-48c9-8513-a2d2e3f14dd1\", name, id, tags, param1 = strcat(\"replicationRole:\", properties['replicationRole'])\n",
            "guid": "b49a8653-cc43-48c9-8513-a2d2e3f14dd1",
            "learnMoreLink": [
                {
                    "name": "Read replicas in Azure Database for MySQL - Flexible Server",
                    "url": "https://learn.microsoft.com/en-us/azure/mysql/flexible-server/concepts-read-replicas"
                }
            ],
            "longDescription": "Configure one or more read replicas to ensure that your database meets its availability and durability targets even in the face of failures or disasters.\n",
            "pgVerified": true,
            "potentialBenefits": "Recover from regional failure and/or disaster",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Disaster Recovery",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.DBforMySQL/flexibleServers",
            "recommendationTypeId": null,
            "service": "Azure MySQL",
            "severity": "High",
            "source": "azure-resources/DBforMySQL/flexibleServers/recommendations.yaml",
            "tags": null,
            "text": "Configure one or more read replicas"
        },
        {
            "aprlGuid": "8176a79d-8645-4e52-96be-a10fc0204fe5",
            "automationAvailable": "arg",
            "category": "Scalability",
            "description": "Configure storage auto-grow to prevent the server from running out of storage and becoming read-only.\n",
            "graph": "// Azure Resource Graph Query\n// Find Database for MySQL instances that do not have a storage auto-grow\nresources\n| where type =~ \"microsoft.dbformysql/flexibleservers\"\n| where properties.storage.autoGrow != \"Enabled\"\n| project recommendationId = \"8176a79d-8645-4e52-96be-a10fc0204fe5\", name, id, tags, param1 = strcat(\"autoGrow:\", properties['storage']['autoGrow'])\n",
            "guid": "8176a79d-8645-4e52-96be-a10fc0204fe5",
            "learnMoreLink": [
                {
                    "name": "Azure Database for MySQL - Flexible Server service tiers - Storage auto grow",
                    "url": "https://learn.microsoft.com/en-us/azure/mysql/flexible-server/concepts-service-tiers-storage#storage-auto-grow"
                }
            ],
            "longDescription": "Configure storage auto-grow to prevent the server from running out of storage and becoming read-only.\n",
            "pgVerified": true,
            "potentialBenefits": "Scale storage automatically to meet increasing demand",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Scalability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.DBforMySQL/flexibleServers",
            "recommendationTypeId": null,
            "service": "Azure MySQL",
            "severity": "High",
            "source": "azure-resources/DBforMySQL/flexibleServers/recommendations.yaml",
            "tags": null,
            "text": "Configure storage auto-grow"
        },
        {
            "aprlGuid": "ca87914f-aac4-4783-ab67-82a6f936f194",
            "automationAvailable": "arg",
            "category": "High Availability",
            "description": "Enable HA with zone redundancy on flexible server instances to deploy a standby replica in a different zone, offering automatic failover capability for improved reliability and disaster recovery.\n",
            "graph": "// Azure Resource Graph Query\n// Find Database for PostgreSQL instances that are not zone redundant\nresources\n| where type == \"microsoft.dbforpostgresql/flexibleservers\"\n| where properties.highAvailability.mode != \"ZoneRedundant\"\n| project recommendationId = \"ca87914f-aac4-4783-ab67-82a6f936f194\", name, id, tags, param1 = \"ZoneRedundant: False\"\n",
            "guid": "ca87914f-aac4-4783-ab67-82a6f936f194",
            "learnMoreLink": [
                {
                    "name": "Overview of high availability with Azure Database for PostgreSQL",
                    "url": "https://learn.microsoft.com/azure/postgresql/flexible-server/concepts-high-availability"
                }
            ],
            "longDescription": "Enable HA with zone redundancy on flexible server instances to deploy a standby replica in a different zone, offering automatic failover capability for improved reliability and disaster recovery.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhanced uptime and data protection",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.DBforPostgreSQL/flexibleServers",
            "recommendationTypeId": null,
            "service": "PostgreSQL",
            "severity": "High",
            "source": "azure-resources/DBforPostgreSQL/flexibleServers/recommendations.yaml",
            "tags": null,
            "text": "Enable HA with zone redundancy"
        },
        {
            "aprlGuid": "b2bad57d-7e03-4c0f-9024-597c9eb295bb",
            "automationAvailable": "arg",
            "category": "Scalability",
            "description": "Use custom maintenance schedule on flexible server instances to select a preferred time for service updates to be applied.\n",
            "graph": "// Azure Resource Graph Query\n// Find Database for PostgreSQL instances that do not have a custom maintenance window\nresources\n| where type == \"microsoft.dbforpostgresql/flexibleservers\"\n| where properties.maintenanceWindow.customWindow != \"Enabled\"\n| project recommendationId = \"b2bad57d-7e03-4c0f-9024-597c9eb295bb\", name, id, tags, param1 = strcat(\"customWindow:\", properties['maintenanceWindow']['customWindow'])\n",
            "guid": "b2bad57d-7e03-4c0f-9024-597c9eb295bb",
            "learnMoreLink": [
                {
                    "name": "Scheduled maintenance in Azure Database for PostgreSQL - Flexible Server",
                    "url": "https://learn.microsoft.com/azure/postgresql/flexible-server/concepts-maintenance"
                }
            ],
            "longDescription": "Use custom maintenance schedule on flexible server instances to select a preferred time for service updates to be applied.\n",
            "pgVerified": true,
            "potentialBenefits": "Control update timings",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Scalability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.DBforPostgreSQL/flexibleServers",
            "recommendationTypeId": null,
            "service": "PostgreSQL",
            "severity": "High",
            "source": "azure-resources/DBforPostgreSQL/flexibleServers/recommendations.yaml",
            "tags": null,
            "text": "Enable custom maintenance schedule"
        },
        {
            "aprlGuid": "31f4ac4b-29cb-4588-8de2-d8fe6f13ceb3",
            "automationAvailable": "arg",
            "category": "Disaster Recovery",
            "description": "Configure GRS to ensure that your database meets its availability and durability targets even in the face of failures or disasters.\n",
            "graph": "// Azure Resource Graph Query\n// Find Database for PostgreSQL instances that do not have geo redundant backup storage configured\nresources\n| where type == \"microsoft.dbforpostgresql/flexibleservers\"\n| where properties.backup.geoRedundantBackup != \"Enabled\"\n| project recommendationId = \"31f4ac4b-29cb-4588-8de2-d8fe6f13ceb3\", name, id, tags, param1 = strcat(\"geoRedundantBackup:\", properties['backup']['geoRedundantBackup'])\n",
            "guid": "31f4ac4b-29cb-4588-8de2-d8fe6f13ceb3",
            "learnMoreLink": [
                {
                    "name": "Backup and restore in Azure Database for PostgreSQL - Flexible Server",
                    "url": "https://learn.microsoft.com/en-us/azure/postgresql/flexible-server/concepts-backup-restore"
                }
            ],
            "longDescription": "Configure GRS to ensure that your database meets its availability and durability targets even in the face of failures or disasters.\n",
            "pgVerified": true,
            "potentialBenefits": "Recover from regional failure and/or disaster",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Disaster Recovery",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.DBforPostgreSQL/flexibleServers",
            "recommendationTypeId": null,
            "service": "PostgreSQL",
            "severity": "High",
            "source": "azure-resources/DBforPostgreSQL/flexibleServers/recommendations.yaml",
            "tags": null,
            "text": "Configure geo redundant backup storage"
        },
        {
            "aprlGuid": "2ab85a67-26be-4ed2-a0bb-101b2513ec63",
            "automationAvailable": "arg",
            "category": "Disaster Recovery",
            "description": "Configure one or more read replicas to ensure that your database meets its availability and durability targets even in the face of failures or disasters.\n",
            "graph": "// Azure Resource Graph Query\n// Find Database for PostgreSQL instances that are read replicas\nresources\n| where type == \"microsoft.dbforpostgresql/flexibleservers\"\n| where properties.replicationRole == \"AsyncReplica\"\n| project recommendationId = \"2ab85a67-26be-4ed2-a0bb-101b2513ec63\", name, id, tags, param1 = strcat(\"replicationRole:\", properties['replicationRole'])\n",
            "guid": "2ab85a67-26be-4ed2-a0bb-101b2513ec63",
            "learnMoreLink": [
                {
                    "name": "Read replicas in Azure Database for PostgreSQL - Flexible Server",
                    "url": "https://learn.microsoft.com/en-us/azure/postgresql/flexible-server/concepts-read-replicas"
                }
            ],
            "longDescription": "Configure one or more read replicas to ensure that your database meets its availability and durability targets even in the face of failures or disasters.\n",
            "pgVerified": true,
            "potentialBenefits": "Recover from regional failure and/or disaster",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Disaster Recovery",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.DBforPostgreSQL/flexibleServers",
            "recommendationTypeId": null,
            "service": "PostgreSQL",
            "severity": "High",
            "source": "azure-resources/DBforPostgreSQL/flexibleServers/recommendations.yaml",
            "tags": null,
            "text": "Configure one or more read replicas"
        },
        {
            "aprlGuid": "6293a3cc-6b4a-4c0f-9ea7-b8ae8d7dd3d5",
            "automationAvailable": false,
            "category": "Scalability",
            "description": "Configure storage auto-grow to prevent the server from running out of storage and becoming read-only.\n",
            "graph": "// cannot-be-validated-with-arg\n",
            "guid": "6293a3cc-6b4a-4c0f-9ea7-b8ae8d7dd3d5",
            "learnMoreLink": [
                {
                    "name": "Storage autogrow using Azure portal in Azure Database for PostgreSQL - Flexible Server",
                    "url": "https://learn.microsoft.com/en-us/azure/postgresql/flexible-server/how-to-auto-grow-storage-portal"
                }
            ],
            "longDescription": "Configure storage auto-grow to prevent the server from running out of storage and becoming read-only.\n",
            "pgVerified": false,
            "potentialBenefits": "Scale storage automatically to meet increasing demand",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Scalability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.DBforPostgreSQL/flexibleServers",
            "recommendationTypeId": null,
            "service": "PostgreSQL",
            "severity": "High",
            "source": "azure-resources/DBforPostgreSQL/flexibleServers/recommendations.yaml",
            "tags": null,
            "text": "Configure storage auto-grow"
        },
        {
            "aprlGuid": "0e835cc2-2551-a247-b1f1-3c5f25c9cb70",
            "automationAvailable": false,
            "category": "Governance",
            "description": "Databricks recommends migrating workloads to the latest or LTS version of its runtime for enhanced stability and support. If on Runtime 11.3 LTS or above, move directly to the latest 12.x version. If below, first migrate to 11.3 LTS, then to the latest 12.x version as per the migration guide.\n",
            "graph": "// under-development\n\n",
            "guid": "0e835cc2-2551-a247-b1f1-3c5f25c9cb70",
            "learnMoreLink": [
                {
                    "name": "Databricks runtime support lifecycles",
                    "url": "https://learn.microsoft.com/en-us/azure/databricks/release-notes/runtime/databricks-runtime-ver"
                }
            ],
            "longDescription": "Databricks recommends migrating workloads to the latest or LTS version of its runtime for enhanced stability and support. If on Runtime 11.3 LTS or above, move directly to the latest 12.x version. If below, first migrate to 11.3 LTS, then to the latest 12.x version as per the migration guide.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhanced stability and support",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Governance",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Databricks/workspaces",
            "recommendationTypeId": null,
            "service": "Databricks",
            "severity": "Medium",
            "source": "azure-resources/Databricks/workspaces/recommendations.yaml",
            "tags": null,
            "text": "Databricks runtime version is not latest or is not LTS version"
        },
        {
            "aprlGuid": "c166602e-0804-e34b-be8f-09b4d56e1fcd",
            "automationAvailable": false,
            "category": "Scalability",
            "description": "Databricks pools pre-provision VMs, reducing risks of provisioning errors during cluster start or scale, enhancing reliability.\n",
            "graph": "// under-development\n\n",
            "guid": "c166602e-0804-e34b-be8f-09b4d56e1fcd",
            "learnMoreLink": [
                {
                    "name": "Best practices for reliability",
                    "url": "https://learn.microsoft.com/en-us/azure/databricks/lakehouse-architecture/reliability/best-practices"
                }
            ],
            "longDescription": "Databricks pools pre-provision VMs, reducing risks of provisioning errors during cluster start or scale, enhancing reliability.\n",
            "pgVerified": true,
            "potentialBenefits": "Reduces provisioning errors",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Scalability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Databricks/workspaces",
            "recommendationTypeId": null,
            "service": "Databricks",
            "severity": "High",
            "source": "azure-resources/Databricks/workspaces/recommendations.yaml",
            "tags": null,
            "text": "Use Databricks Pools"
        },
        {
            "aprlGuid": "5877a510-8444-7a4c-8412-a8dab8662f7e",
            "automationAvailable": false,
            "category": "Scalability",
            "description": "Upgrade HDDs in premium VMs to SSDs for better speed and reliability. Premium SSDs boost IO-heavy apps; Standard SSDs balance cost and performance. Ideal for critical workloads, upgrading improves connectivity with brief reboot. Consider for vital VMs\n",
            "graph": "// under-development\n\n",
            "guid": "5877a510-8444-7a4c-8412-a8dab8662f7e",
            "learnMoreLink": [
                {
                    "name": "Azure managed disk types",
                    "url": "https://learn.microsoft.com/azure/virtual-machines/disks-types#premium-ssd"
                }
            ],
            "longDescription": "Upgrade HDDs in premium VMs to SSDs for better speed and reliability. Premium SSDs boost IO-heavy apps; Standard SSDs balance cost and performance. Ideal for critical workloads, upgrading improves connectivity with brief reboot. Consider for vital VMs\n",
            "pgVerified": true,
            "potentialBenefits": "Faster, reliable VM performance",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Scalability",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Databricks/workspaces",
            "recommendationTypeId": null,
            "service": "Databricks",
            "severity": "Medium",
            "source": "azure-resources/Databricks/workspaces/recommendations.yaml",
            "tags": null,
            "text": "Use SSD backed VMs for Worker VM Type and Driver type"
        },
        {
            "aprlGuid": "5c72f0d6-55ec-d941-be84-36c194fa78c0",
            "automationAvailable": false,
            "category": "Scalability",
            "description": "Autoscaling adjusts cluster sizes automatically based on workload demands, offering benefits for many use cases in terms of costs and performance. It includes guidance on when and how to best utilize Autoscaling. For streaming, Delta Live Tables with autoscaling is advised.\n",
            "graph": "// under-development\n\n",
            "guid": "5c72f0d6-55ec-d941-be84-36c194fa78c0",
            "learnMoreLink": [
                {
                    "name": "Best practices for reliability",
                    "url": "https://learn.microsoft.com/en-us/azure/databricks/lakehouse-architecture/reliability/best-practices#enable-autoscaling-for-batch-workloadss"
                }
            ],
            "longDescription": "Autoscaling adjusts cluster sizes automatically based on workload demands, offering benefits for many use cases in terms of costs and performance. It includes guidance on when and how to best utilize Autoscaling. For streaming, Delta Live Tables with autoscaling is advised.\n",
            "pgVerified": true,
            "potentialBenefits": "Cost and performance optimization",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Scalability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Databricks/workspaces",
            "recommendationTypeId": null,
            "service": "Databricks",
            "severity": "High",
            "source": "azure-resources/Databricks/workspaces/recommendations.yaml",
            "tags": null,
            "text": "Enable autoscaling for batch workloads"
        },
        {
            "aprlGuid": "362ad2b6-b92c-414f-980a-0cf69467ccce",
            "automationAvailable": false,
            "category": "Scalability",
            "description": "The scaling parameter of a SQL warehouse defines the min and max number of clusters for distributing queries. By default, it's set to one. Increasing the cluster count can accommodate more concurrent users effectively.\n",
            "graph": "// under-development\n\n",
            "guid": "362ad2b6-b92c-414f-980a-0cf69467ccce",
            "learnMoreLink": [
                {
                    "name": "Best practices for reliability",
                    "url": "https://learn.microsoft.com/en-us/azure/databricks/lakehouse-architecture/reliability/best-practices#enable-autoscaling-for-sql-warehouse"
                }
            ],
            "longDescription": "The scaling parameter of a SQL warehouse defines the min and max number of clusters for distributing queries. By default, it's set to one. Increasing the cluster count can accommodate more concurrent users effectively.\n",
            "pgVerified": true,
            "potentialBenefits": "Improves concurrency and efficiency",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Scalability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Databricks/workspaces",
            "recommendationTypeId": null,
            "service": "Databricks",
            "severity": "High",
            "source": "azure-resources/Databricks/workspaces/recommendations.yaml",
            "tags": null,
            "text": "Enable autoscaling for SQL warehouse"
        },
        {
            "aprlGuid": "cd77db98-9b13-6e4b-bd2b-74c2cb538628",
            "automationAvailable": false,
            "category": "Scalability",
            "description": "Databricks enhanced autoscaling optimizes cluster utilization by automatically allocating cluster resources based on workload volume, with minimal impact on the data processing latency of your pipelines.\n",
            "graph": "// under-development\n\n",
            "guid": "cd77db98-9b13-6e4b-bd2b-74c2cb538628",
            "learnMoreLink": [
                {
                    "name": "Best practices for reliability",
                    "url": "https://learn.microsoft.com/azure/databricks/lakehouse-architecture/reliability/best-practices"
                },
                {
                    "name": "Databricks enhanced autoscaling",
                    "url": "https://learn.microsoft.com/azure/databricks/delta-live-tables/settings#use-autoscaling-to-increase-efficiency-and-reduce-resource-usage"
                }
            ],
            "longDescription": "Databricks enhanced autoscaling optimizes cluster utilization by automatically allocating cluster resources based on workload volume, with minimal impact on the data processing latency of your pipelines.\n",
            "pgVerified": true,
            "potentialBenefits": "Optimized resource use and minimal latency",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Scalability",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Databricks/workspaces",
            "recommendationTypeId": null,
            "service": "Databricks",
            "severity": "Medium",
            "source": "azure-resources/Databricks/workspaces/recommendations.yaml",
            "tags": null,
            "text": "Use Delta Live Tables enhanced autoscaling"
        },
        {
            "aprlGuid": "3d3e53b5-ebd1-db42-b43b-d4fad74824ec",
            "automationAvailable": false,
            "category": "High Availability",
            "description": "To conserve cluster resources, you can terminate a cluster to store its configuration for future reuse or autostart jobs. Clusters can auto-terminate after inactivity, but this only tracks Spark jobs, not local processes, which might still be running even after Spark jobs end.\n",
            "graph": "// under-development\n\n",
            "guid": "3d3e53b5-ebd1-db42-b43b-d4fad74824ec",
            "learnMoreLink": [
                {
                    "name": "Best practices for reliability?",
                    "url": "https://learn.microsoft.com/en-us/azure/databricks/lakehouse-architecture/reliability/best-practices"
                }
            ],
            "longDescription": "To conserve cluster resources, you can terminate a cluster to store its configuration for future reuse or autostart jobs. Clusters can auto-terminate after inactivity, but this only tracks Spark jobs, not local processes, which might still be running even after Spark jobs end.\n",
            "pgVerified": true,
            "potentialBenefits": "Saves cluster resources, avoids idle use",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Databricks/workspaces",
            "recommendationTypeId": null,
            "service": "Databricks",
            "severity": "Medium",
            "source": "azure-resources/Databricks/workspaces/recommendations.yaml",
            "tags": null,
            "text": "Automatic Job Termination is enabled, ensure there are no user-defined local processes"
        },
        {
            "aprlGuid": "7fb90127-5364-bb4d-86fa-30778ed713fb",
            "automationAvailable": false,
            "category": "Monitoring and Alerting",
            "description": "When creating a Databricks cluster, you can set a log delivery location for the Spark driver, worker nodes, and events. Logs are delivered every 5 mins and archived hourly. Upon cluster termination, all generated logs until that point are guaranteed to be delivered.\n",
            "graph": "// under-development\n\n",
            "guid": "7fb90127-5364-bb4d-86fa-30778ed713fb",
            "learnMoreLink": [
                {
                    "name": "Create a cluster",
                    "url": "https://learn.microsoft.com/en-us/azure/databricks/clusters/configure#cluster-log-delivery"
                }
            ],
            "longDescription": "When creating a Databricks cluster, you can set a log delivery location for the Spark driver, worker nodes, and events. Logs are delivered every 5 mins and archived hourly. Upon cluster termination, all generated logs until that point are guaranteed to be delivered.\n",
            "pgVerified": true,
            "potentialBenefits": "Improved troubleshooting and audit",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Monitoring and Alerting",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Databricks/workspaces",
            "recommendationTypeId": null,
            "service": "Databricks",
            "severity": "Medium",
            "source": "azure-resources/Databricks/workspaces/recommendations.yaml",
            "tags": null,
            "text": "Enable Logging-Cluster log delivery"
        },
        {
            "aprlGuid": "da4ea916-4df3-8c4d-8060-17b49da45977",
            "automationAvailable": false,
            "category": "High Availability",
            "description": "Delta Lake is an open source storage format enhancing data lakes' reliability with ACID transactions, schema enforcement, and scalable metadata handling.\n",
            "graph": "// under-development\n\n",
            "guid": "da4ea916-4df3-8c4d-8060-17b49da45977",
            "learnMoreLink": [
                {
                    "name": "Best practices for reliability",
                    "url": "https://learn.microsoft.com/en-us/azure/databricks/lakehouse-architecture/reliability/best-practices"
                }
            ],
            "longDescription": "Delta Lake is an open source storage format enhancing data lakes' reliability with ACID transactions, schema enforcement, and scalable metadata handling.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhances data reliability and processing",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Databricks/workspaces",
            "recommendationTypeId": null,
            "service": "Databricks",
            "severity": "High",
            "source": "azure-resources/Databricks/workspaces/recommendations.yaml",
            "tags": null,
            "text": "Use Delta Lake for higher reliability"
        },
        {
            "aprlGuid": "892ca809-e2b5-9a47-924a-71132bf6f902",
            "automationAvailable": false,
            "category": "High Availability",
            "description": "Apache Spark in Databricks Lakehouse ensures resilient distributed data processing by automatically rescheduling failed tasks, aiding in overcoming external issues like network problems or revoked VMs.\n",
            "graph": "// under-development\n\n",
            "guid": "892ca809-e2b5-9a47-924a-71132bf6f902",
            "learnMoreLink": [
                {
                    "name": "Best practices for reliability",
                    "url": "https://learn.microsoft.com/en-us/azure/databricks/lakehouse-architecture/reliability/best-practices#use-apache-spark-or-photon-for-distributed-compute"
                }
            ],
            "longDescription": "Apache Spark in Databricks Lakehouse ensures resilient distributed data processing by automatically rescheduling failed tasks, aiding in overcoming external issues like network problems or revoked VMs.\n",
            "pgVerified": true,
            "potentialBenefits": "Boosts speed and reliability for Spark tasks",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "Low",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Databricks/workspaces",
            "recommendationTypeId": null,
            "service": "Databricks",
            "severity": "Low",
            "source": "azure-resources/Databricks/workspaces/recommendations.yaml",
            "tags": null,
            "text": "Use Photon Acceleration"
        },
        {
            "aprlGuid": "7e52d64d-8cc0-8548-a593-eb49ab45630d",
            "automationAvailable": false,
            "category": "Business Continuity",
            "description": "Invalid or nonconforming data can crash workloads dependent on specific data formats. Best practices recommend filtering such data at ingestion to improve end-to-end resilience, ensuring no data is lost or missed.\n",
            "graph": "// under-development\n\n",
            "guid": "7e52d64d-8cc0-8548-a593-eb49ab45630d",
            "learnMoreLink": [
                {
                    "name": "Best practices for reliability",
                    "url": "https://learn.microsoft.com/en-us/azure/databricks/lakehouse-architecture/reliability/best-practices"
                }
            ],
            "longDescription": "Invalid or nonconforming data can crash workloads dependent on specific data formats. Best practices recommend filtering such data at ingestion to improve end-to-end resilience, ensuring no data is lost or missed.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhanced data resilience and integrity",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Business Continuity",
            "recommendationImpact": "Low",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Databricks/workspaces",
            "recommendationTypeId": null,
            "service": "Databricks",
            "severity": "Low",
            "source": "azure-resources/Databricks/workspaces/recommendations.yaml",
            "tags": null,
            "text": "Automatically rescue invalid or nonconforming data with Databricks Auto Loader or Delta Live Tables"
        },
        {
            "aprlGuid": "84e44da6-8cd7-b349-b02c-c8bf72cf587c",
            "automationAvailable": false,
            "category": "High Availability",
            "description": "Use Databricks and MLflow for deploying models as Spark UDFs for job scheduling, retries, autoscaling. Model serving offers scalable infrastructure, processes models using MLflow, and serves them via REST API using serverless compute managed in Databricks cloud.\n",
            "graph": "// under-development\n\n",
            "guid": "84e44da6-8cd7-b349-b02c-c8bf72cf587c",
            "learnMoreLink": [
                {
                    "name": "Best practices for reliability",
                    "url": "https://learn.microsoft.com/en-us/azure/databricks/lakehouse-architecture/reliability/best-practices"
                }
            ],
            "longDescription": "Use Databricks and MLflow for deploying models as Spark UDFs for job scheduling, retries, autoscaling. Model serving offers scalable infrastructure, processes models using MLflow, and serves them via REST API using serverless compute managed in Databricks cloud.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhanced reliability and autoscaling",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Databricks/workspaces",
            "recommendationTypeId": null,
            "service": "Databricks",
            "severity": "High",
            "source": "azure-resources/Databricks/workspaces/recommendations.yaml",
            "tags": null,
            "text": "Configure jobs for automatic retries and termination"
        },
        {
            "aprlGuid": "4cbb7744-ff3d-0447-badb-baf068c95696",
            "automationAvailable": false,
            "category": "Scalability",
            "description": "Use Databricks and MLflow for deploying models as Apache Spark UDFs, benefiting from job scheduling, retries, autoscaling, etc.\n",
            "graph": "// under-development\n\n",
            "guid": "4cbb7744-ff3d-0447-badb-baf068c95696",
            "learnMoreLink": [
                {
                    "name": "Best practices for reliability",
                    "url": "https://learn.microsoft.com/en-us/azure/databricks/lakehouse-architecture/reliability/best-practices"
                }
            ],
            "longDescription": "Use Databricks and MLflow for deploying models as Apache Spark UDFs, benefiting from job scheduling, retries, autoscaling, etc.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhances scalability and reliability",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Scalability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Databricks/workspaces",
            "recommendationTypeId": null,
            "service": "Databricks",
            "severity": "High",
            "source": "azure-resources/Databricks/workspaces/recommendations.yaml",
            "tags": null,
            "text": "Use a scalable and production-grade model serving infrastructure"
        },
        {
            "aprlGuid": "1b0d0893-bf0e-8f4c-9dc6-f18f145c1ecf",
            "automationAvailable": false,
            "category": "High Availability",
            "description": "Curate data by creating a layered architecture to increase data quality across layers. Start with a raw layer for ingested source data, continue with a curated layer for cleansed and refined data, and finish with a final layer catered to business needs, focusing on security and performance.\n",
            "graph": "// under-development\n\n",
            "guid": "1b0d0893-bf0e-8f4c-9dc6-f18f145c1ecf",
            "learnMoreLink": [
                {
                    "name": "Best practices for reliability",
                    "url": "https://learn.microsoft.com/en-us/azure/databricks/lakehouse-architecture/reliability/best-practices"
                }
            ],
            "longDescription": "Curate data by creating a layered architecture to increase data quality across layers. Start with a raw layer for ingested source data, continue with a curated layer for cleansed and refined data, and finish with a final layer catered to business needs, focusing on security and performance.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhances data quality and trust",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Databricks/workspaces",
            "recommendationTypeId": null,
            "service": "Databricks",
            "severity": "Medium",
            "source": "azure-resources/Databricks/workspaces/recommendations.yaml",
            "tags": null,
            "text": "Use a layered storage architecture"
        },
        {
            "aprlGuid": "e93fe702-e385-d741-ba37-1f1656482ecd",
            "automationAvailable": false,
            "category": "Business Continuity",
            "description": "Copying data leads to redundancy, lost integrity, lineage, and access issues, affecting lakehouse data quality. Temporary copies are useful for agility and innovation but can become problematic operational data silos, questioning data's master status and currency.\n",
            "graph": "// under-development\n\n",
            "guid": "e93fe702-e385-d741-ba37-1f1656482ecd",
            "learnMoreLink": [
                {
                    "name": "Best practices for reliability",
                    "url": "https://learn.microsoft.com/en-us/azure/databricks/lakehouse-architecture/reliability/best-practices"
                }
            ],
            "longDescription": "Copying data leads to redundancy, lost integrity, lineage, and access issues, affecting lakehouse data quality. Temporary copies are useful for agility and innovation but can become problematic operational data silos, questioning data's master status and currency.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhanced data integrity and quality",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Business Continuity",
            "recommendationImpact": "Low",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Databricks/workspaces",
            "recommendationTypeId": null,
            "service": "Databricks",
            "severity": "Low",
            "source": "azure-resources/Databricks/workspaces/recommendations.yaml",
            "tags": null,
            "text": "Improve data integrity by reducing data redundancy"
        },
        {
            "aprlGuid": "b7e1d13f-54c9-1648-8a52-34c0abe8ce16",
            "automationAvailable": false,
            "category": "Other Best Practices",
            "description": "Uncontrolled schema changes can lead to invalid data and failing jobs. Databricks validates and enforces schema through Delta Lake, which prevents bad records during ingestion, and Auto Loader, which detects new columns and supports schema evolution to maintain data integrity.\n",
            "graph": "// under-development\n\n",
            "guid": "b7e1d13f-54c9-1648-8a52-34c0abe8ce16",
            "learnMoreLink": [
                {
                    "name": "Best practices for reliability",
                    "url": "https://learn.microsoft.com/en-us/azure/databricks/lakehouse-architecture/reliability/best-practices"
                }
            ],
            "longDescription": "Uncontrolled schema changes can lead to invalid data and failing jobs. Databricks validates and enforces schema through Delta Lake, which prevents bad records during ingestion, and Auto Loader, which detects new columns and supports schema evolution to maintain data integrity.\n",
            "pgVerified": true,
            "potentialBenefits": "Prevents invalid data and job failures",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Other Best Practices",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Databricks/workspaces",
            "recommendationTypeId": null,
            "service": "Databricks",
            "severity": "Medium",
            "source": "azure-resources/Databricks/workspaces/recommendations.yaml",
            "tags": null,
            "text": "Actively manage schemas"
        },
        {
            "aprlGuid": "a42297c4-7e4f-8b41-8d4b-114033263f0e",
            "automationAvailable": false,
            "category": "Business Continuity",
            "description": "Delta tables verify data quality automatically with SQL constraints, triggering an error for violations. Delta Live Tables enhance this by defining expectations for data quality, utilizing Python or SQL, to manage actions for record failures, ensuring data integrity and compliance.\n",
            "graph": "// under-development\n\n",
            "guid": "a42297c4-7e4f-8b41-8d4b-114033263f0e",
            "learnMoreLink": [
                {
                    "name": "Best practices for reliability",
                    "url": "https://learn.microsoft.com/en-us/azure/databricks/lakehouse-architecture/reliability/best-practices#use-constraints-and-data-expectations"
                }
            ],
            "longDescription": "Delta tables verify data quality automatically with SQL constraints, triggering an error for violations. Delta Live Tables enhance this by defining expectations for data quality, utilizing Python or SQL, to manage actions for record failures, ensuring data integrity and compliance.\n",
            "pgVerified": true,
            "potentialBenefits": "Ensures data quality and integrity",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Business Continuity",
            "recommendationImpact": "Low",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Databricks/workspaces",
            "recommendationTypeId": null,
            "service": "Databricks",
            "severity": "Low",
            "source": "azure-resources/Databricks/workspaces/recommendations.yaml",
            "tags": null,
            "text": "Use constraints and data expectations"
        },
        {
            "aprlGuid": "932d45d6-b46d-e341-abfb-d97bce832f1f",
            "automationAvailable": false,
            "category": "Disaster Recovery",
            "description": "To recover from a failure, regular backups are needed. The Databricks Labs project migrate lets admins create backups by exporting workspace assets using the Databricks CLI/API. These backups help in restoring or migrating workspaces.\n",
            "graph": "// under-development\n\n",
            "guid": "932d45d6-b46d-e341-abfb-d97bce832f1f",
            "learnMoreLink": [
                {
                    "name": "Best practices for reliability",
                    "url": "https://learn.microsoft.com/en-us/azure/databricks/lakehouse-architecture/reliability/best-practices#create-regular-backups"
                }
            ],
            "longDescription": "To recover from a failure, regular backups are needed. The Databricks Labs project migrate lets admins create backups by exporting workspace assets using the Databricks CLI/API. These backups help in restoring or migrating workspaces.\n",
            "pgVerified": true,
            "potentialBenefits": "Ensures data recovery and migration",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Disaster Recovery",
            "recommendationImpact": "Low",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Databricks/workspaces",
            "recommendationTypeId": null,
            "service": "Databricks",
            "severity": "Low",
            "source": "azure-resources/Databricks/workspaces/recommendations.yaml",
            "tags": null,
            "text": "Create regular backups"
        },
        {
            "aprlGuid": "12e9d852-5cdc-2743-bffe-ee21f2ef7781",
            "automationAvailable": false,
            "category": "High Availability",
            "description": "Structured Streaming ensures fault-tolerance and data consistency in streaming queries. With Azure Databricks workflows, you can set up your queries to automatically restart after failure, picking up precisely where they left off.\n",
            "graph": "// under-development\n\n",
            "guid": "12e9d852-5cdc-2743-bffe-ee21f2ef7781",
            "learnMoreLink": [
                {
                    "name": "Best practices for reliability",
                    "url": "https://learn.microsoft.com/en-us/azure/databricks/lakehouse-architecture/reliability/best-practices#recover-from-structured-streaming-query-failures"
                }
            ],
            "longDescription": "Structured Streaming ensures fault-tolerance and data consistency in streaming queries. With Azure Databricks workflows, you can set up your queries to automatically restart after failure, picking up precisely where they left off.\n",
            "pgVerified": true,
            "potentialBenefits": "Fault-tolerance and auto-restart for queries",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Databricks/workspaces",
            "recommendationTypeId": null,
            "service": "Databricks",
            "severity": "High",
            "source": "azure-resources/Databricks/workspaces/recommendations.yaml",
            "tags": null,
            "text": "Recover from Structured Streaming query failures"
        },
        {
            "aprlGuid": "a18d60f8-c98c-ba4e-ad6e-2fac72879df1",
            "automationAvailable": false,
            "category": "Disaster Recovery",
            "description": "Despite thorough testing, a production job can fail or yield unexpected data. Sometimes, repairs are done by adding jobs post-issue identification and pipeline correction.\n",
            "graph": "// under-development\n\n",
            "guid": "a18d60f8-c98c-ba4e-ad6e-2fac72879df1",
            "learnMoreLink": [
                {
                    "name": "Best practices for reliability",
                    "url": "https://learn.microsoft.com/en-us/azure/databricks/lakehouse-architecture/reliability/best-practices#recover-etl-jobs-based-on-delta-time-travel"
                }
            ],
            "longDescription": "Despite thorough testing, a production job can fail or yield unexpected data. Sometimes, repairs are done by adding jobs post-issue identification and pipeline correction.\n",
            "pgVerified": true,
            "potentialBenefits": "Easy rollback and fix for ETL jobs",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Disaster Recovery",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Databricks/workspaces",
            "recommendationTypeId": null,
            "service": "Databricks",
            "severity": "Medium",
            "source": "azure-resources/Databricks/workspaces/recommendations.yaml",
            "tags": null,
            "text": "Recover ETL jobs based on Delta time travel"
        },
        {
            "aprlGuid": "c0e22580-3819-444d-8546-a80e4ed85c83",
            "automationAvailable": false,
            "category": "Disaster Recovery",
            "description": "Databricks Workflows enable efficient error recovery in multi-task jobs by offering a matrix view for issue examination. Fixes can be applied to initiate repair runs targeting only failed and dependent tasks, preserving successful outcomes and thereby saving time and money.\n",
            "graph": "// under-development\n\n",
            "guid": "c0e22580-3819-444d-8546-a80e4ed85c83",
            "learnMoreLink": [
                {
                    "name": "Best practices for reliability",
                    "url": "https://learn.microsoft.com/en-us/azure/databricks/lakehouse-architecture/reliability/best-practices"
                }
            ],
            "longDescription": "Databricks Workflows enable efficient error recovery in multi-task jobs by offering a matrix view for issue examination. Fixes can be applied to initiate repair runs targeting only failed and dependent tasks, preserving successful outcomes and thereby saving time and money.\n",
            "pgVerified": true,
            "potentialBenefits": "Saves time and money with smart recovery",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Disaster Recovery",
            "recommendationImpact": "Low",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Databricks/workspaces",
            "recommendationTypeId": null,
            "service": "Databricks",
            "severity": "Low",
            "source": "azure-resources/Databricks/workspaces/recommendations.yaml",
            "tags": null,
            "text": "Use Databricks Workflows and built-in recovery"
        },
        {
            "aprlGuid": "4fdb7112-4531-6f48-b60e-c917a6068d9b",
            "automationAvailable": false,
            "category": "Disaster Recovery",
            "description": "Implementing a disaster recovery pattern is vital for Azure Databricks, ensuring data teams' access even during rare regional outages.\n\nIt is important to note that the Azure Databricks service is not entirely zone redudant and does support zonal failover.\n",
            "graph": "// under-development\n\n",
            "guid": "4fdb7112-4531-6f48-b60e-c917a6068d9b",
            "learnMoreLink": [
                {
                    "name": "Azure Databricks Best Practices",
                    "url": "https://github.com/Azure/AzureDatabricksBestPractices/tree/master"
                }
            ],
            "longDescription": "Implementing a disaster recovery pattern is vital for Azure Databricks, ensuring data teams' access even during rare regional outages.\n\nIt is important to note that the Azure Databricks service is not entirely zone redudant and does support zonal failover.\n",
            "pgVerified": false,
            "potentialBenefits": "Ensures service continuity during disasters",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Disaster Recovery",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Databricks/workspaces",
            "recommendationTypeId": null,
            "service": "Databricks",
            "severity": "High",
            "source": "azure-resources/Databricks/workspaces/recommendations.yaml",
            "tags": null,
            "text": "Configure a disaster recovery pattern"
        },
        {
            "aprlGuid": "42aedaa8-6151-424d-b782-b8666c779969",
            "automationAvailable": false,
            "category": "Other Best Practices",
            "description": "The Databricks Terraform provider manages Azure Databricks workspaces and cloud infrastructure flexibly and powerfully.\n",
            "graph": "// under-development\n\n",
            "guid": "42aedaa8-6151-424d-b782-b8666c779969",
            "learnMoreLink": [
                {
                    "name": "Best practices for operational excellence",
                    "url": "https://learn.microsoft.com/en-us/azure/databricks/lakehouse-architecture/operational-excellence/best-practices#2-automate-deployments-and-workloads"
                }
            ],
            "longDescription": "The Databricks Terraform provider manages Azure Databricks workspaces and cloud infrastructure flexibly and powerfully.\n",
            "pgVerified": false,
            "potentialBenefits": "Efficient, reliable automation",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Other Best Practices",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Databricks/workspaces",
            "recommendationTypeId": null,
            "service": "Databricks",
            "severity": "High",
            "source": "azure-resources/Databricks/workspaces/recommendations.yaml",
            "tags": null,
            "text": "Automate deployments and workloads"
        },
        {
            "aprlGuid": "20193ff9-dbcd-a74e-b197-71d7d9d3c1e6",
            "automationAvailable": false,
            "category": "Monitoring and Alerting",
            "description": "The Databricks Terraform provider is a flexible, powerful tool for managing Azure Databricks workspaces and cloud infrastructure.\n",
            "graph": "// under-development\n\n",
            "guid": "20193ff9-dbcd-a74e-b197-71d7d9d3c1e6",
            "learnMoreLink": [
                {
                    "name": "Best practices for operational excellence",
                    "url": "https://learn.microsoft.com/en-us/azure/databricks/lakehouse-architecture/operational-excellence/best-practices#system-monitoring"
                }
            ],
            "longDescription": "The Databricks Terraform provider is a flexible, powerful tool for managing Azure Databricks workspaces and cloud infrastructure.\n",
            "pgVerified": false,
            "potentialBenefits": "Enhanced reliability and automation",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Monitoring and Alerting",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Databricks/workspaces",
            "recommendationTypeId": null,
            "service": "Databricks",
            "severity": "High",
            "source": "azure-resources/Databricks/workspaces/recommendations.yaml",
            "tags": null,
            "text": "Set up monitoring, alerting, and logging"
        },
        {
            "aprlGuid": "397cdebb-9d6e-ab4f-83a1-8c481de0a3a7",
            "automationAvailable": false,
            "category": "Scalability",
            "description": "Customers often naturally divide workspaces by teams or departments. However, it's crucial to also consider Azure Subscription and ADB Workspace limits when partitioning.\n",
            "graph": "// under-development\n\n",
            "guid": "397cdebb-9d6e-ab4f-83a1-8c481de0a3a7",
            "learnMoreLink": [
                {
                    "name": "Azure Databricks Best Practices",
                    "url": "https://github.com/Azure/AzureDatabricksBestPractices/blob/master/toc.md#deploy-workspaces-in-multiple-subscriptions-to-honor-azure-capacity-limits"
                }
            ],
            "longDescription": "Customers often naturally divide workspaces by teams or departments. However, it's crucial to also consider Azure Subscription and ADB Workspace limits when partitioning.\n",
            "pgVerified": false,
            "potentialBenefits": "Enhanced limits management, team separation",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Scalability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Databricks/workspaces",
            "recommendationTypeId": null,
            "service": "Databricks",
            "severity": "High",
            "source": "azure-resources/Databricks/workspaces/recommendations.yaml",
            "tags": null,
            "text": "Deploy workspaces in separate Subscriptions"
        },
        {
            "aprlGuid": "5e722c4f-415a-9b4c-bd4c-96b74dce29ad",
            "automationAvailable": false,
            "category": "Scalability",
            "description": "Deploying only one Databricks Workspace per VNet aligns with ADB's isolation model.\n",
            "graph": "// under-development\n\n",
            "guid": "5e722c4f-415a-9b4c-bd4c-96b74dce29ad",
            "learnMoreLink": [
                {
                    "name": "Azure Databricks Best Practices",
                    "url": "https://github.com/Azure/AzureDatabricksBestPractices/blob/master/toc.md#consider-isolating-each-workspace-in-its-own-vnet"
                }
            ],
            "longDescription": "Deploying only one Databricks Workspace per VNet aligns with ADB's isolation model.\n",
            "pgVerified": false,
            "potentialBenefits": "Enhanced security and resource isolation",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Scalability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Databricks/workspaces",
            "recommendationTypeId": null,
            "service": "Databricks",
            "severity": "High",
            "source": "azure-resources/Databricks/workspaces/recommendations.yaml",
            "tags": null,
            "text": "Isolate each workspace in its own Vnet"
        },
        {
            "aprlGuid": "14310ba6-77ad-3641-a2db-57a2218b9bc7",
            "automationAvailable": false,
            "category": "High Availability",
            "description": "Driven by security and data availability concerns, each Azure Databricks Workspace comes with a default DBFS designed for system-level artifacts like libraries and Init scripts, not for production data.\n",
            "graph": "// under-development\n\n",
            "guid": "14310ba6-77ad-3641-a2db-57a2218b9bc7",
            "learnMoreLink": [
                {
                    "name": "Azure Databricks Best Practices",
                    "url": "https://github.com/Azure/AzureDatabricksBestPractices/blob/master/toc.md#do-not-store-any-production-data-in-default-dbfs-foldersr"
                }
            ],
            "longDescription": "Driven by security and data availability concerns, each Azure Databricks Workspace comes with a default DBFS designed for system-level artifacts like libraries and Init scripts, not for production data.\n",
            "pgVerified": false,
            "potentialBenefits": "Enhanced security, data protection",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Databricks/workspaces",
            "recommendationTypeId": null,
            "service": "Databricks",
            "severity": "High",
            "source": "azure-resources/Databricks/workspaces/recommendations.yaml",
            "tags": null,
            "text": "Do not Store any Production Data in Default DBFS Folders"
        },
        {
            "aprlGuid": "b5af7e26-3939-1b48-8fba-f8d4a475c67a",
            "automationAvailable": false,
            "category": "High Availability",
            "description": "Azure Spot VMs are not suitable for critical production workloads needing high availability and reliability. They are meant for fault-tolerant tasks and can be evicted with 30-seconds notice if Azure needs the capacity, with no SLA guarantees.\n",
            "graph": "// under-development\n\n",
            "guid": "b5af7e26-3939-1b48-8fba-f8d4a475c67a",
            "learnMoreLink": [
                {
                    "name": "Use Azure Spot Virtual Machines",
                    "url": "https://learn.microsoft.com/en-us/azure/virtual-machines/spot-vms"
                }
            ],
            "longDescription": "Azure Spot VMs are not suitable for critical production workloads needing high availability and reliability. They are meant for fault-tolerant tasks and can be evicted with 30-seconds notice if Azure needs the capacity, with no SLA guarantees.\n",
            "pgVerified": false,
            "potentialBenefits": "Ensures high reliability for production",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Databricks/workspaces",
            "recommendationTypeId": null,
            "service": "Databricks",
            "severity": "High",
            "source": "azure-resources/Databricks/workspaces/recommendations.yaml",
            "tags": null,
            "text": "Do not use Azure Spot VMs for critical Production workloads"
        },
        {
            "aprlGuid": "8aa63c34-dd9d-49bd-9582-21ec310dfbdd",
            "automationAvailable": false,
            "category": "High Availability",
            "description": "Move workspaces to in-region control plane for increased regional isolation. Identify current control plane region using the workspace URL and nslookup. When region from CNAME differs from workspace region and an in-region control is available, consider migration using tools provided below.\n",
            "graph": "// cannot-be-validated-with-arg\n",
            "guid": "8aa63c34-dd9d-49bd-9582-21ec310dfbdd",
            "learnMoreLink": [
                {
                    "name": "Azure Databricks control plane addresses",
                    "url": "https://learn.microsoft.com/azure/databricks/resources/supported-regions#--azure-databricks-control-plane-addresses"
                },
                {
                    "name": "Migrate - maintained by Databricks Inc.",
                    "url": "https://github.com/databrickslabs/migrate"
                },
                {
                    "name": "Databricks Terraform Exporter - maintained by Databricks Inc. (Experimental)",
                    "url": "https://registry.terraform.io/providers/databricks/databricks/latest/docs/guides/experimental-exporter"
                }
            ],
            "longDescription": "Move workspaces to in-region control plane for increased regional isolation. Identify current control plane region using the workspace URL and nslookup. When region from CNAME differs from workspace region and an in-region control is available, consider migration using tools provided below.\n",
            "pgVerified": false,
            "potentialBenefits": "Improves resilience and data sovereignty",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Databricks/workspaces",
            "recommendationTypeId": null,
            "service": "Databricks",
            "severity": "High",
            "source": "azure-resources/Databricks/workspaces/recommendations.yaml",
            "tags": null,
            "text": "Evaluate regional isolation for workspaces"
        },
        {
            "aprlGuid": "028593be-956e-4736-bccf-074cb10b92f4",
            "automationAvailable": false,
            "category": "Personalized",
            "description": "Azure Databricks planning should include VM SKU swap strategies for capacity issues. VMs are regional, and allocation failures may occur, shown by a \"CLOUD PROVIDER\" error.\n",
            "graph": "// under-development\n\n",
            "guid": "028593be-956e-4736-bccf-074cb10b92f4",
            "learnMoreLink": [
                {
                    "name": "Compute configuration best practices",
                    "url": "https://learn.microsoft.com/azure/databricks/compute/cluster-config-best-practices"
                },
                {
                    "name": "GPU-enabled compute",
                    "url": "https://learn.microsoft.com/azure/databricks/compute/gpu"
                }
            ],
            "longDescription": "Azure Databricks planning should include VM SKU swap strategies for capacity issues. VMs are regional, and allocation failures may occur, shown by a \"CLOUD PROVIDER\" error.\n",
            "pgVerified": false,
            "potentialBenefits": "Ensures service availability",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Personalized",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Databricks/workspaces",
            "recommendationTypeId": null,
            "service": "Databricks",
            "severity": "Medium",
            "source": "azure-resources/Databricks/workspaces/recommendations.yaml",
            "tags": null,
            "text": "Define alternate VM SKUs"
        },
        {
            "aprlGuid": "013ac34e-7c4b-425f-9e0c-216f0cc06181",
            "automationAvailable": false,
            "category": "Governance",
            "description": "Create a Validation Pool for early issue detection with planned AVD updates. Adjust limits based on needs. Scale by adding multiple host pools for more users. Regularly test updates on host pools. Validate changes before applying to main environment to avoid downtime.\n",
            "graph": "// under-development\n",
            "guid": "013ac34e-7c4b-425f-9e0c-216f0cc06181",
            "learnMoreLink": [
                {
                    "name": "Learn More",
                    "url": "https://learn.microsoft.com/azure/virtual-desktop/configure-validation-environment?tabs=azure-portal"
                }
            ],
            "longDescription": "Create a Validation Pool for early issue detection with planned AVD updates. Adjust limits based on needs. Scale by adding multiple host pools for more users. Regularly test updates on host pools. Validate changes before applying to main environment to avoid downtime.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhanced environment stability",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Governance",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.DesktopVirtualization/hostPools",
            "recommendationTypeId": null,
            "service": "AVD",
            "severity": "Medium",
            "source": "azure-resources/DesktopVirtualization/hostPools/recommendations.yaml",
            "tags": null,
            "text": "Create a validation host pool for testing of planned updates"
        },
        {
            "aprlGuid": "979ff8be-5f3a-4d8e-9aa3-407ecdd6d6f7",
            "automationAvailable": false,
            "category": "Governance",
            "description": "Create maintenance schedules for AVD agent updates to avoid disruptions. Use Scheduled Agent Updates to set maintenance windows for updating Azure Virtual Desktop agent, side-by-side stack, and Geneva Monitoring agent.\n",
            "graph": "// Azure Resource Graph Query\n// This resource graph query will return all AVD host pools that does not have scheduled agent updates configured\nresources\n| where type =~ \"Microsoft.DesktopVirtualization/hostpools\"\n| where isnull(properties.agentUpdate)\n| project recommendationId = \"979ff8be-5f3a-4d8e-9aa3-407ecdd6d6f7\", name, id, tags, param1 = 'No scheduled agent updates'\n",
            "guid": "979ff8be-5f3a-4d8e-9aa3-407ecdd6d6f7",
            "learnMoreLink": [
                {
                    "name": "Learn More",
                    "url": "https://learn.microsoft.com/azure/virtual-desktop/scheduled-agent-updates"
                }
            ],
            "longDescription": "Create maintenance schedules for AVD agent updates to avoid disruptions. Use Scheduled Agent Updates to set maintenance windows for updating Azure Virtual Desktop agent, side-by-side stack, and Geneva Monitoring agent.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhanced environment stability",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Governance",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.DesktopVirtualization/hostPools",
            "recommendationTypeId": null,
            "service": "AVD",
            "severity": "Medium",
            "source": "azure-resources/DesktopVirtualization/hostPools/recommendations.yaml",
            "tags": null,
            "text": "Configure host pool scheduled agent updates"
        },
        {
            "aprlGuid": "939cb85c-102a-4e0a-ab82-5c92116d3778",
            "automationAvailable": false,
            "category": "Governance",
            "description": "For optimized AVD configuration, place Hybrid VMs in unique OUs. Segregate Prod and DR units for environment-specific settings. This ensures targeted configurations for session hosts, including Fslogix, timeouts, and session controls.\n",
            "graph": "// under-development\n\n",
            "guid": "939cb85c-102a-4e0a-ab82-5c92116d3778",
            "learnMoreLink": [
                {
                    "name": "Learn More",
                    "url": "https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/deploy/virtual-dc/adds-on-azure-vm#configure-the-vms-and-install-active-directory-domain-services"
                }
            ],
            "longDescription": "For optimized AVD configuration, place Hybrid VMs in unique OUs. Segregate Prod and DR units for environment-specific settings. This ensures targeted configurations for session hosts, including Fslogix, timeouts, and session controls.\n",
            "pgVerified": true,
            "potentialBenefits": "Improved AVD hostpool config & segmentation",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Governance",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.DesktopVirtualization/hostPools",
            "recommendationTypeId": null,
            "service": "AVD",
            "severity": "Medium",
            "source": "azure-resources/DesktopVirtualization/hostPools/recommendations.yaml",
            "tags": null,
            "text": "Ensure a unique OU is used when deploying host pools with domain joined session hosts"
        },
        {
            "aprlGuid": "38721758-2cc2-4d6b-b7b7-8b47dadbf7df",
            "automationAvailable": false,
            "category": "Disaster Recovery",
            "description": "Implement Azure Site Recovery (ASR) or Azure Backup for personal host pools to enable seamless failover and failback. This replicates VMs supporting personal desktops to a secondary Azure region, ensuring recovery from a known state in case of a disaster or outage.\n",
            "graph": "// under-development\n\n",
            "guid": "38721758-2cc2-4d6b-b7b7-8b47dadbf7df",
            "learnMoreLink": [
                {
                    "name": "Learn More",
                    "url": "https://learn.microsoft.com/en-us/azure/site-recovery/site-recovery-overview"
                }
            ],
            "longDescription": "Implement Azure Site Recovery (ASR) or Azure Backup for personal host pools to enable seamless failover and failback. This replicates VMs supporting personal desktops to a secondary Azure region, ensuring recovery from a known state in case of a disaster or outage.\n",
            "pgVerified": true,
            "potentialBenefits": "Ensures VM recovery & failover",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Disaster Recovery",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Compute/virtualMachines",
            "recommendationTypeId": null,
            "service": "VM",
            "severity": "Medium",
            "source": "azure-resources/DesktopVirtualization/hostPools/recommendations.yaml",
            "tags": null,
            "text": "Use Azure Site Recovery or backups to protect VMs supporting personal desktops"
        },
        {
            "aprlGuid": "499769ae-67c9-492e-9ca5-cfd4cece5209",
            "automationAvailable": false,
            "category": "Scalability",
            "description": "Each region has its own scaling plans assigned to host pools within that region. However, these plans can become inaccessible if there's a regional failure. To mitigate this risk, it's advisable to create a secondary scaling plan in another region.\n",
            "graph": "// under-development\n",
            "guid": "499769ae-67c9-492e-9ca5-cfd4cece5209",
            "learnMoreLink": [
                {
                    "name": "Learn More",
                    "url": "https://learn.microsoft.com/azure/virtual-desktop/autoscale-scaling-plan?tabs=portal"
                }
            ],
            "longDescription": "Each region has its own scaling plans assigned to host pools within that region. However, these plans can become inaccessible if there's a regional failure. To mitigate this risk, it's advisable to create a secondary scaling plan in another region.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhanced scaling",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Scalability",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.DesktopVirtualization/scalingPlans",
            "recommendationTypeId": null,
            "service": "Microsoft.DesktopVirtualization/scalingPlans",
            "severity": "Medium",
            "source": "azure-resources/DesktopVirtualization/scalingPlans/recommendations.yaml",
            "tags": null,
            "text": "Scaling plans should be created per region and not scaled across regions"
        },
        {
            "aprlGuid": "783c6c18-760b-4867-9ced-3010a0bc5aa3",
            "automationAvailable": false,
            "category": "Disaster Recovery",
            "description": "Device Identities should be copied to the failover region IoT-Hub for all IoT devices to ensure connectivity in case of a failover. Manual Failover to another region is quicker (RTO), suitable for mission critical workloads.\n",
            "graph": "// cannot-be-validated-with-arg\n\n",
            "guid": "783c6c18-760b-4867-9ced-3010a0bc5aa3",
            "learnMoreLink": [
                {
                    "name": "Import and export IoT Hub device identities in bulk",
                    "url": "https://learn.microsoft.com/en-us/azure/iot-hub/iot-hub-bulk-identity-mgmt"
                },
                {
                    "name": "IoT Hub high availability and disaster recovery",
                    "url": "https://learn.microsoft.com/en-us/azure/iot-hub/iot-hub-ha-dr#manual-failover"
                }
            ],
            "longDescription": "Device Identities should be copied to the failover region IoT-Hub for all IoT devices to ensure connectivity in case of a failover. Manual Failover to another region is quicker (RTO), suitable for mission critical workloads.\n",
            "pgVerified": false,
            "potentialBenefits": "Faster failover; Ensures device connectivity",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Disaster Recovery",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Devices/IotHubs",
            "recommendationTypeId": null,
            "service": "IoT Hub",
            "severity": "High",
            "source": "azure-resources/Devices/iotHubs/recommendations.yaml",
            "tags": null,
            "text": "Device Identities are exported to a secondary region"
        },
        {
            "aprlGuid": "eeba3a49-fef0-481f-a471-7ff01139b474",
            "automationAvailable": "arg",
            "category": "High Availability",
            "description": "In a production scenario, the IoT Hub tier should not be Free because the Free tier does not provide the necessary Service Level Agreement.\n",
            "graph": "// Azure Resource Graph Query\n// list all IoT Hubs that are using the Free tier\nresources\n| where type =~ \"microsoft.devices/iothubs\" and\n    tostring(sku.tier) =~ 'Free'\n| project recommendationId=\"eeba3a49-fef0-481f-a471-7ff01139b474\", name, id, tags, param1=strcat(\"tier:\", tostring(sku.tier))\n\n",
            "guid": "eeba3a49-fef0-481f-a471-7ff01139b474",
            "learnMoreLink": [
                {
                    "name": "Choose the right IoT Hub tier and size for your solution",
                    "url": "https://learn.microsoft.com/en-us/azure/iot-hub/iot-hub-scaling"
                }
            ],
            "longDescription": "In a production scenario, the IoT Hub tier should not be Free because the Free tier does not provide the necessary Service Level Agreement.\n",
            "pgVerified": false,
            "potentialBenefits": "Ensures SLA for production",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Devices/IotHubs",
            "recommendationTypeId": null,
            "service": "IoT Hub",
            "severity": "High",
            "source": "azure-resources/Devices/iotHubs/recommendations.yaml",
            "tags": null,
            "text": "Do not use free tier"
        },
        {
            "aprlGuid": "214cbc46-747e-4354-af6e-6bf0054196a5",
            "automationAvailable": false,
            "category": "High Availability",
            "description": "In regions supporting Availability Zones for IoT Hub, using these zones boosts availability. They're automatically activated for new IoT Hubs in supported areas.\n",
            "graph": "// cannot-be-validated-with-arg\n\n",
            "guid": "214cbc46-747e-4354-af6e-6bf0054196a5",
            "learnMoreLink": [
                {
                    "name": "Azure IoT Hub high availability and disaster recovery",
                    "url": "https://learn.microsoft.com/en-us/azure/iot-hub/iot-hub-ha-dr#availability-zones"
                }
            ],
            "longDescription": "In regions supporting Availability Zones for IoT Hub, using these zones boosts availability. They're automatically activated for new IoT Hubs in supported areas.\n",
            "pgVerified": false,
            "potentialBenefits": "Boosts IoT Hub availability",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Devices/IotHubs",
            "recommendationTypeId": null,
            "service": "IoT Hub",
            "severity": "High",
            "source": "azure-resources/Devices/iotHubs/recommendations.yaml",
            "tags": null,
            "text": "Use Availability Zones"
        },
        {
            "aprlGuid": "b1e1378d-4572-4414-bebd-b8872a6d4d1c",
            "automationAvailable": "arg",
            "category": "Scalability",
            "description": "Device Provisioning Service (DPS) enables easy redistribution of IoT devices for scaling and availability, allowing devices to be reassigned and not bound to specific IoT Hub instances. Devices in IoT Hubs using DPS should be verified for DPS utilization.\n",
            "graph": "// Azure Resource Graph Query\n// list all IoT Hubs that do not have a linked IoT Hub Device Provisioning Service (DPS)\nresources\n| where type =~ \"microsoft.devices/iothubs\"\n| project id, iotHubName=tostring(properties.hostName), tags, resourceGroup\n| join kind=fullouter (\n    resources\n    | where type == \"microsoft.devices/provisioningservices\"\n    | mv-expand iotHubs=properties.iotHubs\n    | project iotHubName = tostring(iotHubs.name), dpsName = name, name=iotHubs.name\n) on iotHubName\n| where dpsName == ''\n| project recommendationId=\"b1e1378d-4572-4414-bebd-b8872a6d4d1c\", name=iotHubName, id, tags, param1='DPS:none'\n\n",
            "guid": "b1e1378d-4572-4414-bebd-b8872a6d4d1c",
            "learnMoreLink": [
                {
                    "name": "IoT Hub Device Provisioning Service (DPS) terminology",
                    "url": "https://learn.microsoft.com/en-us/azure/iot-dps/concepts-service"
                },
                {
                    "name": "Best practices for large-scale IoT device deployments",
                    "url": "https://learn.microsoft.com/en-us/azure/iot-dps/concepts-deploy-at-scale"
                },
                {
                    "name": "IoT Hub Device Provisioning Service high availability and disaster recovery",
                    "url": "https://learn.microsoft.com/en-us/azure/iot-dps/iot-dps-ha-dr"
                }
            ],
            "longDescription": "Device Provisioning Service (DPS) enables easy redistribution of IoT devices for scaling and availability, allowing devices to be reassigned and not bound to specific IoT Hub instances. Devices in IoT Hubs using DPS should be verified for DPS utilization.\n",
            "pgVerified": false,
            "potentialBenefits": "Enhances scalability and availability",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Scalability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Devices/IotHubs",
            "recommendationTypeId": null,
            "service": "IoT Hub",
            "severity": "High",
            "source": "azure-resources/Devices/iotHubs/recommendations.yaml",
            "tags": null,
            "text": "Use Device Provisioning Service"
        },
        {
            "aprlGuid": "02568a5d-335e-4e51-9f7c-fe2ada977300",
            "automationAvailable": false,
            "category": "High Availability",
            "description": "In case of a regional failure, an IoT Hub can failover to a second region, automatically or manually, to ensure your application continues working.\n",
            "graph": "// cannot-be-validated-with-arg\n\n",
            "guid": "02568a5d-335e-4e51-9f7c-fe2ada977300",
            "learnMoreLink": [
                {
                    "name": "IoT Hub high availability and disaster recovery",
                    "url": "https://learn.microsoft.com/en-us/azure/iot-hub/iot-hub-ha-dr"
                }
            ],
            "longDescription": "In case of a regional failure, an IoT Hub can failover to a second region, automatically or manually, to ensure your application continues working.\n",
            "pgVerified": false,
            "potentialBenefits": "Ensures business continuity",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Devices/IotHubs",
            "recommendationTypeId": null,
            "service": "IoT Hub",
            "severity": "High",
            "source": "azure-resources/Devices/iotHubs/recommendations.yaml",
            "tags": null,
            "text": "Define Failover Guidelines"
        },
        {
            "aprlGuid": "e7dbd21f-b27a-4b8c-a901-cedb1e6d8e1e",
            "automationAvailable": "arg",
            "category": "Monitoring and Alerting",
            "description": "Using message routing for custom endpoints in IoT Hub, messages might not reach these destinations if specific conditions are unmet. A default route ensures all messages are received, but disabling this safety net risks leaving some messages undelivered.\n",
            "graph": "// Azure Resource Graph Query\n// list all IoT Hubs that have the fallback route disabled\nresources\n| where type == \"microsoft.devices/iothubs\"\n| extend fallbackEnabled=properties.routing.fallbackRoute.isEnabled\n| where fallbackEnabled == false\n| project recommendationId=\"e7dbd21f-b27a-4b8c-a901-cedb1e6d8e1e\", name, id, tags, param1='FallbackRouteEnabled:false'\n\n",
            "guid": "e7dbd21f-b27a-4b8c-a901-cedb1e6d8e1e",
            "learnMoreLink": [
                {
                    "name": "Use message routing - Fallback route",
                    "url": "https://learn.microsoft.com/en-us/azure/iot-hub/iot-hub-devguide-messages-d2c#fallback-route"
                }
            ],
            "longDescription": "Using message routing for custom endpoints in IoT Hub, messages might not reach these destinations if specific conditions are unmet. A default route ensures all messages are received, but disabling this safety net risks leaving some messages undelivered.\n",
            "pgVerified": false,
            "potentialBenefits": "Prevents undelivered messages",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Monitoring and Alerting",
            "recommendationImpact": "Low",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Devices/IotHubs",
            "recommendationTypeId": null,
            "service": "IoT Hub",
            "severity": "Low",
            "source": "azure-resources/Devices/iotHubs/recommendations.yaml",
            "tags": null,
            "text": "Disabled Fallback Route"
        },
        {
            "aprlGuid": "43663217-a1d3-844b-80ea-571a2ce37c6c",
            "automationAvailable": "arg",
            "category": "High Availability",
            "description": "Enable a secondary region in Cosmos DB for higher SLA without downtime. Simple as pinning a location on a map. For Strong consistency, configure at least three regions for write availability in case of failure.\n",
            "graph": "// Azure Resource Graph Query\n// Query to find Azure Cosmos DB accounts that have less than 2 regions or less than 3 regions with strong consistency level\nResources\n| where type =~ 'Microsoft.DocumentDb/databaseAccounts'\n| where\n    array_length(properties.locations) < 2 or\n    (array_length(properties.locations) < 3 and properties.consistencyPolicy.defaultConsistencyLevel == 'Strong')\n| project recommendationId='43663217-a1d3-844b-80ea-571a2ce37c6c', name, id, tags\n\n",
            "guid": "43663217-a1d3-844b-80ea-571a2ce37c6c",
            "learnMoreLink": [
                {
                    "name": "Distribute data globally with Azure Cosmos DB | Microsoft Learn",
                    "url": "https://learn.microsoft.com/azure/cosmos-db/distribute-data-globally"
                },
                {
                    "name": "Tips for building highly available applications | Microsoft Learn",
                    "url": "https://learn.microsoft.com/azure/cosmos-db/high-availability#tips-for-building-highly-available-applications"
                }
            ],
            "longDescription": "Enable a secondary region in Cosmos DB for higher SLA without downtime. Simple as pinning a location on a map. For Strong consistency, configure at least three regions for write availability in case of failure.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhances SLA and resilience",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.DocumentDB/databaseAccounts",
            "recommendationTypeId": "b57f7a29-dcc8-43de-86fa-18d3f9d3764d",
            "service": "CosmosDB",
            "severity": "High",
            "source": "azure-resources/DocumentDB/databaseAccounts/recommendations.yaml",
            "tags": null,
            "text": "Configure at least two regions for high availability"
        },
        {
            "aprlGuid": "9cabded7-a1fc-6e4a-944b-d7dd98ea31a2",
            "automationAvailable": "arg",
            "category": "Disaster Recovery",
            "description": "Cosmos DB boasts high uptime and resiliency. Even so, issues may arise. With Service-Managed failover, if a region is down, Cosmos DB automatically switches to the next available region, requiring no user action.\n",
            "graph": "// Azure Resource Graph Query\n// Query to list all Azure Cosmos DB accounts that do not have multiple write locations or automatic failover enabled\nResources\n| where type =~ 'Microsoft.DocumentDb/databaseAccounts'\n| where\n    array_length(properties.locations) > 1 and\n    tobool(properties.enableAutomaticFailover) == false and\n    tobool(properties.enableMultipleWriteLocations) == false\n| project recommendationId='9cabded7-a1fc-6e4a-944b-d7dd98ea31a2', name, id, tags\n",
            "guid": "9cabded7-a1fc-6e4a-944b-d7dd98ea31a2",
            "learnMoreLink": [
                {
                    "name": "Manage an Azure Cosmos DB account by using the Azure portal | Microsoft Learn",
                    "url": "https://learn.microsoft.com/azure/cosmos-db/how-to-manage-database-account#automatic-failover"
                }
            ],
            "longDescription": "Cosmos DB boasts high uptime and resiliency. Even so, issues may arise. With Service-Managed failover, if a region is down, Cosmos DB automatically switches to the next available region, requiring no user action.\n",
            "pgVerified": true,
            "potentialBenefits": "Auto failover for high uptime",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Disaster Recovery",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.DocumentDB/databaseAccounts",
            "recommendationTypeId": "5de9f2e6-087e-40da-863a-34b7943beed4",
            "service": "CosmosDB",
            "severity": "High",
            "source": "azure-resources/DocumentDB/databaseAccounts/recommendations.yaml",
            "tags": null,
            "text": "Enable service-managed failover for multi-region accounts with single write region"
        },
        {
            "aprlGuid": "9ce78192-74a0-104c-b5bb-9a443f941649",
            "automationAvailable": "arg",
            "category": "High Availability",
            "description": "Multi-region write capability allows for designing applications that are highly available across multiple regions, though it demands careful attention to consistency requirements and conflict resolution. Improper setup may decrease availability and cause data corruption due to unhandled conflicts.\n",
            "graph": "// Azure Resource Graph Query\n// Query to find Azure Cosmos DB accounts that have multiple read locations but do not have multiple write locations enabled\nResources\n| where type =~ 'Microsoft.DocumentDb/databaseAccounts'\n| where\n    array_length(properties.locations) > 1 and\n    properties.enableMultipleWriteLocations == false\n| project recommendationId='9ce78192-74a0-104c-b5bb-9a443f941649', name, id, tags\n\n",
            "guid": "9ce78192-74a0-104c-b5bb-9a443f941649",
            "learnMoreLink": [
                {
                    "name": "Distribute data globally with Azure Cosmos DB | Microsoft Learn",
                    "url": "https://learn.microsoft.com/azure/cosmos-db/distribute-data-globally"
                },
                {
                    "name": "Conflict resolution types and resolution policies in Azure Cosmos DB | Microsoft Learn",
                    "url": "https://learn.microsoft.com/azure/cosmos-db/conflict-resolution-policies"
                }
            ],
            "longDescription": "Multi-region write capability allows for designing applications that are highly available across multiple regions, though it demands careful attention to consistency requirements and conflict resolution. Improper setup may decrease availability and cause data corruption due to unhandled conflicts.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhances high availability",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.DocumentDB/databaseAccounts",
            "recommendationTypeId": null,
            "service": "CosmosDB",
            "severity": "High",
            "source": "azure-resources/DocumentDB/databaseAccounts/recommendations.yaml",
            "tags": null,
            "text": "Evaluate multi-region write capability"
        },
        {
            "aprlGuid": "e544520b-8505-7841-9e77-1f1974ee86ec",
            "automationAvailable": "arg",
            "category": "Disaster Recovery",
            "description": "Cosmos DB's backup is always on, offering protection against data mishaps. Continuous mode allows for self-serve restoration to a pre-mishap point, unlike periodic mode which requires contacting Microsoft support, leading to longer restore times.\n",
            "graph": "// Azure Resource Graph Query\n// Query all Azure Cosmos DB accounts that do not have continuous backup mode configured\nResources\n| where type =~ 'Microsoft.DocumentDb/databaseAccounts'\n| where\n    properties.backupPolicy.type == 'Periodic' and\n    properties.enableMultipleWriteLocations == false and\n    properties.enableAnalyticalStorage == false\n| project recommendationId='e544520b-8505-7841-9e77-1f1974ee86ec', name, id, tags\n",
            "guid": "e544520b-8505-7841-9e77-1f1974ee86ec",
            "learnMoreLink": [
                {
                    "name": "Continuous backup with point in time restore feature in Azure Cosmos DB | Microsoft Learn",
                    "url": "https://learn.microsoft.com/azure/cosmos-db/continuous-backup-restore-introduction"
                }
            ],
            "longDescription": "Cosmos DB's backup is always on, offering protection against data mishaps. Continuous mode allows for self-serve restoration to a pre-mishap point, unlike periodic mode which requires contacting Microsoft support, leading to longer restore times.\n",
            "pgVerified": true,
            "potentialBenefits": "Faster self-serve data restore",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Disaster Recovery",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.DocumentDB/databaseAccounts",
            "recommendationTypeId": "52fef986-5897-4359-8b92-0f22749f0d73",
            "service": "CosmosDB",
            "severity": "High",
            "source": "azure-resources/DocumentDB/databaseAccounts/recommendations.yaml",
            "tags": null,
            "text": "Configure continuous backup mode"
        },
        {
            "aprlGuid": "c006604a-0d29-684c-99f0-9729cb40dac5",
            "automationAvailable": false,
            "category": "Scalability",
            "description": "Cosmos DB has a 4 MB response limit, leading to paginated results for large or partition-spanning queries. Each page shows availability and provides a continuation token for the next. A while loop in code is necessary to traverse all pages until completion.\n",
            "graph": "// under-development\n",
            "guid": "c006604a-0d29-684c-99f0-9729cb40dac5",
            "learnMoreLink": [
                {
                    "name": "Pagination in Azure Cosmos DB | Microsoft Learn",
                    "url": "https://learn.microsoft.com/azure/cosmos-db/nosql/query/pagination#handling-multiple-pages-of-results"
                }
            ],
            "longDescription": "Cosmos DB has a 4 MB response limit, leading to paginated results for large or partition-spanning queries. Each page shows availability and provides a continuation token for the next. A while loop in code is necessary to traverse all pages until completion.\n",
            "pgVerified": true,
            "potentialBenefits": "Maximizes data retrieval efficiency",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Scalability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.DocumentDB/databaseAccounts",
            "recommendationTypeId": null,
            "service": "CosmosDB",
            "severity": "High",
            "source": "azure-resources/DocumentDB/databaseAccounts/recommendations.yaml",
            "tags": null,
            "text": "Ensure query results are fully drained"
        },
        {
            "aprlGuid": "7eb32cf9-9a42-1540-acf8-597cbba8a418",
            "automationAvailable": false,
            "category": "Scalability",
            "description": "Using a single instance of the SDK client for each account and application is crucial as connections are tied to the client. Compute environments have a limit on open connections, affecting connectivity when exceeded.\n",
            "graph": "// under-development\n",
            "guid": "7eb32cf9-9a42-1540-acf8-597cbba8a418",
            "learnMoreLink": [
                {
                    "name": "Designing resilient applications with Azure Cosmos DB SDKs | Microsoft Learn",
                    "url": "https://learn.microsoft.com/azure/cosmos-db/nosql/conceptual-resilient-sdk-applications"
                }
            ],
            "longDescription": "Using a single instance of the SDK client for each account and application is crucial as connections are tied to the client. Compute environments have a limit on open connections, affecting connectivity when exceeded.\n",
            "pgVerified": true,
            "potentialBenefits": "Optimizes connections and efficiency",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Scalability",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.DocumentDB/databaseAccounts",
            "recommendationTypeId": null,
            "service": "CosmosDB",
            "severity": "Medium",
            "source": "azure-resources/DocumentDB/databaseAccounts/recommendations.yaml",
            "tags": null,
            "text": "Maintain singleton pattern in your client"
        },
        {
            "aprlGuid": "fa6ac22f-0584-bb4b-80e4-80f4755d1a97",
            "automationAvailable": false,
            "category": "High Availability",
            "description": "Cosmos DB SDKs automatically manage many transient errors through retries. Despite this, it's crucial for applications to implement additional retry policies targeting specific cases that the SDKs can't generically address, ensuring more robust error handling.\n",
            "graph": "// under-development\n",
            "guid": "fa6ac22f-0584-bb4b-80e4-80f4755d1a97",
            "learnMoreLink": [
                {
                    "name": "Designing resilient applications with Azure Cosmos DB SDKs | Microsoft Learn",
                    "url": "https://learn.microsoft.com/azure/cosmos-db/nosql/conceptual-resilient-sdk-applications"
                }
            ],
            "longDescription": "Cosmos DB SDKs automatically manage many transient errors through retries. Despite this, it's crucial for applications to implement additional retry policies targeting specific cases that the SDKs can't generically address, ensuring more robust error handling.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhances error handling resilience",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.DocumentDB/databaseAccounts",
            "recommendationTypeId": null,
            "service": "CosmosDB",
            "severity": "Medium",
            "source": "azure-resources/DocumentDB/databaseAccounts/recommendations.yaml",
            "tags": null,
            "text": "Implement retry logic in your client"
        },
        {
            "aprlGuid": "deaea200-013c-414b-ac9f-bfa7a7fb13f0",
            "automationAvailable": false,
            "category": "Monitoring and Alerting",
            "description": "Monitoring the availability and responsiveness of Azure Cosmos DB resources and having alerts set up for your workload is a good practice. This ensures you stay proactive in handling unforeseen events.\n",
            "graph": "// under-development\n",
            "guid": "deaea200-013c-414b-ac9f-bfa7a7fb13f0",
            "learnMoreLink": [
                {
                    "name": "Create alerts for Azure Cosmos DB using Azure Monitor | Microsoft Learn",
                    "url": "https://learn.microsoft.com/azure/cosmos-db/create-alerts"
                }
            ],
            "longDescription": "Monitoring the availability and responsiveness of Azure Cosmos DB resources and having alerts set up for your workload is a good practice. This ensures you stay proactive in handling unforeseen events.\n",
            "pgVerified": true,
            "potentialBenefits": "Proactive issue management",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Monitoring and Alerting",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.DocumentDB/databaseAccounts",
            "recommendationTypeId": null,
            "service": "CosmosDB",
            "severity": "Medium",
            "source": "azure-resources/DocumentDB/databaseAccounts/recommendations.yaml",
            "tags": null,
            "text": "Monitor Cosmos DB health and set up alerts"
        },
        {
            "aprlGuid": "54c3191b-b535-1946-bba9-b754f44060f6",
            "automationAvailable": false,
            "category": "Monitoring and Alerting",
            "description": "Enabling diagnostic settings on Azure Event Grid resources like custom topics, system topics, and domains lets you capture and view diagnostic information to troubleshoot failures effectively.\n",
            "graph": "// under-development\n\n",
            "guid": "54c3191b-b535-1946-bba9-b754f44060f6",
            "learnMoreLink": [
                {
                    "name": "Azure Event Grid - Enable diagnostic logs for Event Grid resources",
                    "url": "https://learn.microsoft.com/en-us/azure/event-grid/enable-diagnostic-logs-topic"
                }
            ],
            "longDescription": "Enabling diagnostic settings on Azure Event Grid resources like custom topics, system topics, and domains lets you capture and view diagnostic information to troubleshoot failures effectively.\n",
            "pgVerified": false,
            "potentialBenefits": "Enhanced troubleshooting for Event Grid",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Monitoring and Alerting",
            "recommendationImpact": "Low",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.EventGrid/topics",
            "recommendationTypeId": null,
            "service": "EventGrid",
            "severity": "Low",
            "source": "azure-resources/EventGrid/topics/recommendations.yaml",
            "tags": null,
            "text": "Configure Diagnostic Settings for all Azure Event Grid resources"
        },
        {
            "aprlGuid": "92162eb5-4323-3145-8a6c-525ce2f0700e",
            "automationAvailable": false,
            "category": "Personalized",
            "description": "Event Grid may not deliver an event within a specific time or after several attempts, leading to dead-lettering where undelivered events are sent to a storage account.\n",
            "graph": "// under-development\n\n",
            "guid": "92162eb5-4323-3145-8a6c-525ce2f0700e",
            "learnMoreLink": [
                {
                    "name": "Azure Event Grid delivery and retry",
                    "url": "https://learn.microsoft.com/en-us/azure/event-grid/delivery-and-retry#dead-letter-events"
                }
            ],
            "longDescription": "Event Grid may not deliver an event within a specific time or after several attempts, leading to dead-lettering where undelivered events are sent to a storage account.\n",
            "pgVerified": false,
            "potentialBenefits": "Saves undelivered events",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Personalized",
            "recommendationImpact": "Low",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.EventGrid/topics",
            "recommendationTypeId": null,
            "service": "EventGrid",
            "severity": "Low",
            "source": "azure-resources/EventGrid/topics/recommendations.yaml",
            "tags": null,
            "text": "Configure Dead-letter to save events that cannot be delivered"
        },
        {
            "aprlGuid": "b2069f64-4741-3d4a-a71d-50c8b03f5ab7",
            "automationAvailable": "arg",
            "category": "Security",
            "description": "Use private endpoints for secure event ingress to custom topics/domains via a private link, avoiding the public internet. It employs an IP from the VNet space for your topic/domain.\n",
            "graph": "// Azure Resource Graph Query\n// Find all eventgrid services not protected by private endpoints.\nResources\n| where type contains \"eventgrid\"\n| where properties['publicNetworkAccess'] == \"Enabled\"\n| project recommendationId = \"b2069f64-4741-3d4a-a71d-50c8b03f5ab7\", name, id, tags\n| order by id asc\n\n",
            "guid": "b2069f64-4741-3d4a-a71d-50c8b03f5ab7",
            "learnMoreLink": [
                {
                    "name": "Configure private endpoints for Azure Event Grid topics or domains",
                    "url": "https://learn.microsoft.com/en-us/azure/event-grid/configure-private-endpoints"
                }
            ],
            "longDescription": "Use private endpoints for secure event ingress to custom topics/domains via a private link, avoiding the public internet. It employs an IP from the VNet space for your topic/domain.\n",
            "pgVerified": false,
            "potentialBenefits": "Secure, private VNet ingress",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Security",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.EventGrid/topics",
            "recommendationTypeId": "bdac9c7b-b9b8-f572-0450-f161c430861c",
            "service": "EventGrid",
            "severity": "Medium",
            "source": "azure-resources/EventGrid/topics/recommendations.yaml",
            "tags": null,
            "text": "Azure Event Grid topics should use Private Link Private Endpoints"
        },
        {
            "aprlGuid": "84636c6c-b317-4722-b603-7b1ffc16384b",
            "automationAvailable": "arg",
            "category": "High Availability",
            "description": "When using the Azure portal, zone redundancy is automatically enabled. However, some Infrastructure as Code (IaC) tools may default this to false. To ensure replication of metadata and events across data centers in an availability zone, always verify that zone redundancy is enabled.\n",
            "guid": "84636c6c-b317-4722-b603-7b1ffc16384b",
            "learnMoreLink": [
                {
                    "name": "Azure Event Hubs - Geo-disaster recovery",
                    "url": "https://learn.microsoft.com/azure/event-hubs/event-hubs-geo-dr?tabs=portal#availability-zones"
                }
            ],
            "longDescription": "When using the Azure portal, zone redundancy is automatically enabled. However, some Infrastructure as Code (IaC) tools may default this to false. To ensure replication of metadata and events across data centers in an availability zone, always verify that zone redundancy is enabled.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhanced fault tolerance for Event Hub",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.EventHub/namespaces",
            "recommendationTypeId": null,
            "service": "Event Hubs",
            "severity": "High",
            "source": "azure-resources/EventHub/namespaces/recommendations.yaml",
            "tags": null,
            "text": "Ensure zone redundancy is enabled in supported regions"
        },
        {
            "aprlGuid": "fbfef3df-04a5-41b2-a8fd-b8541eb04956",
            "automationAvailable": "arg",
            "category": "Scalability",
            "description": "Enable auto-inflate on Event Hub Standard tier namespaces to automatically scale up TUs, meeting usage needs and preventing data ingress or egress throttle scenarios by adjusting to allowed rates.\n",
            "graph": "// Azure Resource Graph Query\n// Find Event Hub namespace instances that are Standard tier and do not have Auto Inflate enabled\nresources\n| where type == \"microsoft.eventhub/namespaces\"\n| where sku.tier == \"Standard\"\n| where properties.isAutoInflateEnabled == \"false\"\n| project recommendationId = \"fbfef3df-04a5-41b2-a8fd-b8541eb04956\", name, id, tags, param1 = \"AutoInflateEnabled: False\"\n\n",
            "guid": "fbfef3df-04a5-41b2-a8fd-b8541eb04956",
            "learnMoreLink": [
                {
                    "name": "Azure Event Hubs - Automatically scale throughput units",
                    "url": "https://learn.microsoft.com/azure/event-hubs/event-hubs-auto-inflate"
                }
            ],
            "longDescription": "Enable auto-inflate on Event Hub Standard tier namespaces to automatically scale up TUs, meeting usage needs and preventing data ingress or egress throttle scenarios by adjusting to allowed rates.\n",
            "pgVerified": true,
            "potentialBenefits": "Prevents throttling by autoscaling TUs",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Scalability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.EventHub/namespaces",
            "recommendationTypeId": null,
            "service": "Event Hubs",
            "severity": "High",
            "source": "azure-resources/EventHub/namespaces/recommendations.yaml",
            "tags": null,
            "text": "Enable auto-inflate on Event Hub Standard tier"
        },
        {
            "aprlGuid": "be448849-0d7d-49ba-9c94-9573ee533d5d",
            "automationAvailable": false,
            "category": "Monitoring and Alerting",
            "description": "Configure Resource Health Alerts for all applicable resources to stay informed about the current and historical health status of your Azure resources. They notify you when these resources have a change in their health status.\n",
            "graph": "// cannot-be-validated-with-arg\n\n",
            "guid": "be448849-0d7d-49ba-9c94-9573ee533d5d",
            "learnMoreLink": [
                {
                    "name": "Resource Health",
                    "url": "https://learn.microsoft.com/en-us/azure/service-health/resource-health-overview"
                },
                {
                    "name": "Configure Resource Health alerts in the Azure portal",
                    "url": "https://learn.microsoft.com/en-us/azure/service-health/resource-health-alert-monitor-guide#create-a-resource-health-alert-rule-in-the-azure-portal"
                },
                {
                    "name": "Alerts Health",
                    "url": "https://learn.microsoft.com/en-us/azure/service-health/alerts-activity-log-service-notifications-portal"
                }
            ],
            "longDescription": "Configure Resource Health Alerts for all applicable resources to stay informed about the current and historical health status of your Azure resources. They notify you when these resources have a change in their health status.\n",
            "pgVerified": true,
            "potentialBenefits": "Stay informed on resource status",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Monitoring and Alerting",
            "recommendationImpact": "Low",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Insights/activityLogAlerts",
            "recommendationTypeId": null,
            "service": "Microsoft.Insights/activityLogAlerts",
            "severity": "Low",
            "source": "azure-resources/Insights/activityLogAlerts/recommendations.yaml",
            "tags": null,
            "text": "Configure Resource Health Alerts"
        },
        {
            "aprlGuid": "9729c89d-8118-41b4-a39b-e12468fa872b",
            "automationAvailable": "arg",
            "category": "Monitoring and Alerting",
            "description": "Service health gives a personalized health view of Azure services and regions used, offering the best place for notifications on outages, planned maintenance, and health advisories by knowing the services used.\n",
            "graph": "// Azure Resource Graph Query\n// This resource graph query will return all subscriptions without Service Health alerts configured.\n\nresourcecontainers\n| where type == 'microsoft.resources/subscriptions'\n| project subscriptionAlerts=tostring(id),name,tags\n| join kind=leftouter (\n  resources\n  | where type == 'microsoft.insights/activitylogalerts' and properties.condition contains \"ServiceHealth\"\n  | extend subscriptions = properties.scopes\n  | project subscriptions\n  | mv-expand subscriptions\n  | project subscriptionAlerts = tostring(subscriptions)\n) on subscriptionAlerts\n| where isempty(subscriptionAlerts1)\n| project-away subscriptionAlerts1\n| project recommendationId = \"9729c89d-8118-41b4-a39b-e12468fa872b\",id=subscriptionAlerts,name,tags\n\n",
            "guid": "9729c89d-8118-41b4-a39b-e12468fa872b",
            "learnMoreLink": [
                {
                    "name": "What is Azure Service Health?",
                    "url": "https://learn.microsoft.com/azure/service-health/overview"
                },
                {
                    "name": "Configure alerts for service health events",
                    "url": "https://learn.microsoft.com/azure/service-health/alerts-activity-log-service-notifications-portal"
                }
            ],
            "longDescription": "Service health gives a personalized health view of Azure services and regions used, offering the best place for notifications on outages, planned maintenance, and health advisories by knowing the services used.\n",
            "pgVerified": true,
            "potentialBenefits": "Proactive outage and maintenance alerts",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Monitoring and Alerting",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Insights/activityLogAlerts",
            "recommendationTypeId": null,
            "service": "Microsoft.Insights/activityLogAlerts",
            "severity": "High",
            "source": "azure-resources/Insights/activityLogAlerts/recommendations.yaml",
            "tags": null,
            "text": "Configure Service Health Alerts"
        },
        {
            "aprlGuid": "dac421ec-2832-4c37-839e-b6dc5a38f2fa",
            "automationAvailable": "arg",
            "category": "Service Upgrade and Retirement",
            "description": "Classic Application Insights retires in February 2024. To minimize disruption to existing application monitoring scenarios, transition to workspace-based Application Insights before 29 February 2024.\n",
            "graph": "// Azure Resource Graph query\n// Filters Application Insights resources with ‘Classic’ deployment type\nresources\n| where type =~ \"microsoft.insights/components\"\n| extend IngestionMode = properties.IngestionMode\n| where IngestionMode =~ 'ApplicationInsights'\n| project recommendationId= \"dac421ec-2832-4c37-839e-b6dc5a38f2fa\", name, id, tags, param1=\"ApplicationInsightsDeploymentType: Classic\"\n\n",
            "guid": "dac421ec-2832-4c37-839e-b6dc5a38f2fa",
            "learnMoreLink": [
                {
                    "name": "Migrate an Application Insights classic resource to a workspace-based resource",
                    "url": "https://learn.microsoft.com/en-us/azure/azure-monitor/app/convert-classic-resource"
                }
            ],
            "longDescription": "Classic Application Insights retires in February 2024. To minimize disruption to existing application monitoring scenarios, transition to workspace-based Application Insights before 29 February 2024.\n",
            "pgVerified": false,
            "potentialBenefits": "Avoid service disruption post-Feb 2024",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Service Upgrade and Retirement",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Insights/components",
            "recommendationTypeId": null,
            "service": "Monitor",
            "severity": "Medium",
            "source": "azure-resources/Insights/components/recommendations.yaml",
            "tags": null,
            "text": "Convert Classic Deployments"
        },
        {
            "aprlGuid": "1cca00d2-d9ab-8e42-a788-5d40f49405cb",
            "automationAvailable": "arg",
            "category": "Disaster Recovery",
            "description": "Key Vault's soft-delete feature enables recovery of deleted vaults and objects like keys, secrets, and certificates. When enabled, marked resources are retained for 90 days, allowing for their recovery, essentially undoing deletion.\n",
            "graph": "// Azure Resource Graph Query\n// This Resource Graph query will return all Key Vaults that do not have soft delete enabled.\nresources\n| where type == \"microsoft.keyvault/vaults\"\n| where isnull(properties.enableSoftDelete) or properties.enableSoftDelete != \"true\"\n| project recommendationId = \"1cca00d2-d9ab-8e42-a788-5d40f49405cb\", name, id, tags, param1 = \"EnableSoftDelete: Disabled\"\n\n",
            "guid": "1cca00d2-d9ab-8e42-a788-5d40f49405cb",
            "learnMoreLink": [
                {
                    "name": "Azure Key Vault soft-delete overview",
                    "url": "https://learn.microsoft.com/azure/key-vault/general/soft-delete-overview"
                }
            ],
            "longDescription": "Key Vault's soft-delete feature enables recovery of deleted vaults and objects like keys, secrets, and certificates. When enabled, marked resources are retained for 90 days, allowing for their recovery, essentially undoing deletion.\n",
            "pgVerified": false,
            "potentialBenefits": "Enables recovery of deleted items",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Disaster Recovery",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.KeyVault/vaults",
            "recommendationTypeId": "78211c00-15a9-336e-17c4-0b48613dadf4",
            "service": "Key Vault",
            "severity": "High",
            "source": "azure-resources/KeyVault/vaults/recommendations.yaml",
            "tags": null,
            "text": "Key vaults should have soft delete enabled"
        },
        {
            "aprlGuid": "70fcfe6d-00e9-5544-a63a-fff42b9f2edb",
            "automationAvailable": "arg",
            "category": "Disaster Recovery",
            "description": "Purge protection secures against malicious deletions by enforcing a retention period for soft deleted key vaults, ensuring no one, not even insiders or Microsoft, can purge your key vaults during this period, preventing permanent data loss.\n",
            "graph": "// Azure Resource Graph Query\n// This resource graph query will return all Key Vaults that do not have Purge Protection enabled.\nresources\n| where type == \"microsoft.keyvault/vaults\"\n| where isnull(properties.enablePurgeProtection) or properties.enablePurgeProtection != \"true\"\n| project recommendationId = \"70fcfe6d-00e9-5544-a63a-fff42b9f2edb\", name, id, tags, param1 = \"EnablePurgeProtection: Disabled\"\n\n",
            "guid": "70fcfe6d-00e9-5544-a63a-fff42b9f2edb",
            "learnMoreLink": [
                {
                    "name": "Azure Key Vault purge-protection overview",
                    "url": "https://learn.microsoft.com/azure/key-vault/general/soft-delete-overview#purge-protection"
                }
            ],
            "longDescription": "Purge protection secures against malicious deletions by enforcing a retention period for soft deleted key vaults, ensuring no one, not even insiders or Microsoft, can purge your key vaults during this period, preventing permanent data loss.\n",
            "pgVerified": false,
            "potentialBenefits": "Protects from insider attacks, avoids data loss",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Disaster Recovery",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.KeyVault/vaults",
            "recommendationTypeId": "4ed62ae4-5072-f9e7-8d94-51c76c48159a",
            "service": "Key Vault",
            "severity": "Medium",
            "source": "azure-resources/KeyVault/vaults/recommendations.yaml",
            "tags": null,
            "text": "Key vaults should have purge protection enabled"
        },
        {
            "aprlGuid": "00c3d2b0-ea6e-4c4b-89be-b78a35caeb51",
            "automationAvailable": "arg",
            "category": "Security",
            "description": "Azure Private Link Service lets you securely and privately connect to Azure Key Vault via a Private Endpoint in your VNet, using a private IP and eliminating public Internet exposure.\n",
            "graph": "// Azure Resource Graph Query\n// This resource graph query will return all Key Vaults that does not have a Private Endpoint Connection or where a private endpoint exists but public access is enabled\n\nresources\n| where type == \"microsoft.keyvault/vaults\"\n| where isnull(properties.privateEndpointConnections) or properties.privateEndpointConnections[0].properties.provisioningState != (\"Succeeded\") or (isnull(properties.networkAcls) and properties.publicNetworkAccess == 'Enabled')\n| extend param1 = strcat('Private Endpoint: ', iif(isnotnull(properties.privateEndpointConnections),split(properties.privateEndpointConnections[0].properties.privateEndpoint.id,'/')[8],'No Private Endpoint'))\n| extend param2 = strcat('Access: ', iif(properties.publicNetworkAccess == 'Disabled', 'Public Access Disabled', iif(isnotnull(properties.networkAcls), 'NetworkACLs in place','Public Access Enabled')))\n| project recommendationId = \"00c3d2b0-ea6e-4c4b-89be-b78a35caeb51\", name, id, tags, param1, param2\n\n",
            "guid": "00c3d2b0-ea6e-4c4b-89be-b78a35caeb51",
            "learnMoreLink": [
                {
                    "name": "Azure Key Vault Private Link Service overview",
                    "url": "https://learn.microsoft.com/azure/key-vault/general/security-features#network-security"
                }
            ],
            "longDescription": "Azure Private Link Service lets you securely and privately connect to Azure Key Vault via a Private Endpoint in your VNet, using a private IP and eliminating public Internet exposure.\n",
            "pgVerified": false,
            "potentialBenefits": "Secure Key Vault with Private Link",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Security",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.KeyVault/vaults",
            "recommendationTypeId": "2e96bc2f-1972-e471-9e70-ae58d41e9d2a",
            "service": "Key Vault",
            "severity": "Medium",
            "source": "azure-resources/KeyVault/vaults/recommendations.yaml",
            "tags": null,
            "text": "Private endpoint should be configured for Key Vault"
        },
        {
            "aprlGuid": "e7091145-3642-bd41-bb58-66502e64d2cd",
            "automationAvailable": false,
            "category": "Governance",
            "description": "Key vaults are security boundaries for secret storage. Grouping secrets together increases risk during a security event, as attacks could access multiple secrets.\n",
            "graph": "// under-development\n\n",
            "guid": "e7091145-3642-bd41-bb58-66502e64d2cd",
            "learnMoreLink": [
                {
                    "name": "Azure Key Vault best practices overview",
                    "url": "https://learn.microsoft.com/azure/key-vault/general/best-practices#why-we-recommend-separate-key-vaults"
                }
            ],
            "longDescription": "Key vaults are security boundaries for secret storage. Grouping secrets together increases risk during a security event, as attacks could access multiple secrets.\n",
            "pgVerified": false,
            "potentialBenefits": "Enhanced security, Reduced risk",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Governance",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.KeyVault/vaults",
            "recommendationTypeId": null,
            "service": "Key Vault",
            "severity": "High",
            "source": "azure-resources/KeyVault/vaults/recommendations.yaml",
            "tags": null,
            "text": "Use separate key vaults per application per environment"
        },
        {
            "aprlGuid": "1dc0821d-4f14-7644-bab4-ba208ff5f7fa",
            "automationAvailable": false,
            "category": "Monitoring and Alerting",
            "description": "Enable logs, set up alerts, and adhere to retention requirements for improved monitoring and security of Key Vault access, detailing the frequency and identity of users.\n",
            "graph": "// cannot-be-validated-with-arg\n",
            "guid": "1dc0821d-4f14-7644-bab4-ba208ff5f7fa",
            "learnMoreLink": [
                {
                    "name": "Azure Key Vault logging overview",
                    "url": "https://learn.microsoft.com/azure/key-vault/general/logging?tabs=Vault"
                }
            ],
            "longDescription": "Enable logs, set up alerts, and adhere to retention requirements for improved monitoring and security of Key Vault access, detailing the frequency and identity of users.\n",
            "pgVerified": false,
            "potentialBenefits": "Enhanced monitoring and security compliance",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Monitoring and Alerting",
            "recommendationImpact": "Low",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.KeyVault/vaults",
            "recommendationTypeId": "88bbc99c-e5af-ddd7-6105-6150b2bfa519",
            "service": "Key Vault",
            "severity": "Low",
            "source": "azure-resources/KeyVault/vaults/recommendations.yaml",
            "tags": null,
            "text": "Diagnostic logs in Key Vault should be enabled"
        },
        {
            "aprlGuid": "af426a99-62a6-6b4c-9662-42d220b413b8",
            "automationAvailable": false,
            "category": "Scalability",
            "description": "Service levels, part of capacity pool attributes, determine the maximum throughput per volume quota in Azure NetApp Files. It combines read and write speed, offering three levels: Standard (16 MiB/s per 1TiB), Premium (64 MiB/s per 1TiB), and Ultra (128 MiB/s per 1TiB) throughput.\n",
            "graph": "// cannot-be-validated-with-arg\n\n",
            "guid": "af426a99-62a6-6b4c-9662-42d220b413b8",
            "learnMoreLink": [
                {
                    "name": "Service levels for Azure NetApp Files | Microsoft Learn",
                    "url": "https://learn.microsoft.com/azure/azure-netapp-files/azure-netapp-files-service-levels"
                }
            ],
            "longDescription": "Service levels, part of capacity pool attributes, determine the maximum throughput per volume quota in Azure NetApp Files. It combines read and write speed, offering three levels: Standard (16 MiB/s per 1TiB), Premium (64 MiB/s per 1TiB), and Ultra (128 MiB/s per 1TiB) throughput.\n",
            "pgVerified": true,
            "potentialBenefits": "Optimized performance and cost efficiency",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Scalability",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.NetApp/netAppAccounts",
            "recommendationTypeId": null,
            "service": "ANF",
            "severity": "Medium",
            "source": "azure-resources/NetApp/netAppAccounts/recommendations.yaml",
            "tags": null,
            "text": "Use the correct service level and volume quota size for the expected performance level"
        },
        {
            "aprlGuid": "ab984130-c57b-6c4a-8d04-6723b4e1bdb6",
            "automationAvailable": "arg",
            "category": "Scalability",
            "description": "Standard network feature in Azure NetApp Files enhances IP limits and VNet capabilities, including network security groups, user-defined routes on subnets, and diverse connectivity options.\n",
            "graph": "// Azure Resource Graph Query\n// This Resource Graph query will return all Azure NetApp Files volumes without standard network features.\nresources\n| where type =~ \"microsoft.netapp/netappaccounts/capacitypools/volumes\"\n| where properties.networkFeatures != \"Standard\"\n| project recommendationId = \"ab984130-c57b-6c4a-8d04-6723b4e1bdb6\", name, id, tags\n\n",
            "guid": "ab984130-c57b-6c4a-8d04-6723b4e1bdb6",
            "learnMoreLink": [
                {
                    "name": "Guidelines for Azure NetApp Files network planning | Microsoft Learn",
                    "url": "https://learn.microsoft.com/azure/azure-netapp-files/azure-netapp-files-network-topologies"
                }
            ],
            "longDescription": "Standard network feature in Azure NetApp Files enhances IP limits and VNet capabilities, including network security groups, user-defined routes on subnets, and diverse connectivity options.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhanced connectivity and security",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Scalability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.NetApp/netAppAccounts",
            "recommendationTypeId": null,
            "service": "ANF",
            "severity": "High",
            "source": "azure-resources/NetApp/netAppAccounts/recommendations.yaml",
            "tags": null,
            "text": "Use standard network features for production in Azure NetApp Files"
        },
        {
            "aprlGuid": "47d100a5-7f85-5742-967a-67eb5081240a",
            "automationAvailable": "arg",
            "category": "High Availability",
            "description": "Availability zones are distinct locations within an Azure region to withstand local failures. Deploy your workload in multiple availability zones and use application-based replication or Azure NetApp Files cross-zone replication to achieve high availability. Note that failover is a manual process.\n",
            "graph": "// Azure Resource Graph Query\n// This Resource Graph query will return all Azure NetApp Files volumes without an availability zone defined.\nResources\n| where type =~ \"Microsoft.NetApp/netAppAccounts/capacityPools/volumes\"\n| where array_length(zones) == 0 or isnull(zones)\n| project recommendationId = \"47d100a5-7f85-5742-967a-67eb5081240a\", name, id, tags\n\n",
            "guid": "47d100a5-7f85-5742-967a-67eb5081240a",
            "learnMoreLink": [
                {
                    "name": "Use availability zones for high availability in Azure NetApp Files | Microsoft Learn",
                    "url": "https://learn.microsoft.com/azure/azure-netapp-files/use-availability-zones"
                }
            ],
            "longDescription": "Availability zones are distinct locations within an Azure region to withstand local failures. Deploy your workload in multiple availability zones and use application-based replication or Azure NetApp Files cross-zone replication to achieve high availability. Note that failover is a manual process.\n",
            "pgVerified": true,
            "potentialBenefits": "High Availability across availability zones",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.NetApp/netAppAccounts",
            "recommendationTypeId": null,
            "service": "ANF",
            "severity": "High",
            "source": "azure-resources/NetApp/netAppAccounts/recommendations.yaml",
            "tags": null,
            "text": "Use availability zones for high availability in Azure NetApp Files"
        },
        {
            "aprlGuid": "8bb690e8-64d5-4838-8703-9ee3dbac688f",
            "automationAvailable": false,
            "category": "Other Best Practices",
            "description": "Azure NetApp Files' availability zone (AZ) volume placement feature lets you deploy volumes in the same AZ with Azure compute and other services to have within AZ latency and share the same AZ failure domain.\n",
            "graph": "// cannot-be-validated-with-arg\n",
            "guid": "8bb690e8-64d5-4838-8703-9ee3dbac688f",
            "learnMoreLink": [
                {
                    "name": "Manage availability zone volume placement for Azure NetApp Files | Microsoft Learn",
                    "url": "https://learn.microsoft.com/azure/azure-netapp-files/manage-availability-zone-volume-placement"
                }
            ],
            "longDescription": "Azure NetApp Files' availability zone (AZ) volume placement feature lets you deploy volumes in the same AZ with Azure compute and other services to have within AZ latency and share the same AZ failure domain.\n",
            "pgVerified": true,
            "potentialBenefits": "Within AZ latency and tolerate failure of other AZ",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Other Best Practices",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.NetApp/netAppAccounts",
            "recommendationTypeId": null,
            "service": "ANF",
            "severity": "High",
            "source": "azure-resources/NetApp/netAppAccounts/recommendations.yaml",
            "tags": null,
            "text": "Deploy ANF volumes in the same availability zone with Azure compute and other services"
        },
        {
            "aprlGuid": "72827434-c773-4345-9493-34848ddf5803",
            "automationAvailable": "arg",
            "category": "High Availability",
            "description": "Azure NetApp Files snapshot technology ensures stability, scalability, and swift data recoverability without affecting performance. It supports automatic snapshot creation via policies for Azure NetApp Files data.\n",
            "graph": "// Azure Resource Graph Query\n// This Resource Graph query will return all Azure NetApp Files volumes without a snapshot policy defined.\nresources\n| where type == \"microsoft.netapp/netappaccounts/capacitypools/volumes\"\n| where properties.dataProtection.snapshot.snapshotPolicyId == \"\"\n| project recommendationId = \"72827434-c773-4345-9493-34848ddf5803\", name, id, tags\n\n",
            "guid": "72827434-c773-4345-9493-34848ddf5803",
            "learnMoreLink": [
                {
                    "name": "How Azure NetApp Files snapshots work | Microsoft Learn",
                    "url": "https://learn.microsoft.com/azure/azure-netapp-files/snapshots-introduction"
                }
            ],
            "longDescription": "Azure NetApp Files snapshot technology ensures stability, scalability, and swift data recoverability without affecting performance. It supports automatic snapshot creation via policies for Azure NetApp Files data.\n",
            "pgVerified": true,
            "potentialBenefits": "Stable, scalable, swift recovery, no perf impact",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.NetApp/netAppAccounts",
            "recommendationTypeId": null,
            "service": "ANF",
            "severity": "High",
            "source": "azure-resources/NetApp/netAppAccounts/recommendations.yaml",
            "tags": null,
            "text": "Use snapshots for data protection in Azure NetApp Files"
        },
        {
            "aprlGuid": "b2fb3e60-97ec-e34d-af29-b16a0d61c2ac",
            "automationAvailable": "arg",
            "category": "Disaster Recovery",
            "description": "Azure NetApp Files offers a fully managed backup solution enhancing long-term recovery, archiving, and compliance.\n",
            "graph": "// Azure Resource Graph Query\n// This Resource Graph query will return all Azure NetApp Files volumes without a backup policy defined.\nresources\n| where type == \"microsoft.netapp/netappaccounts/capacitypools/volumes\"\n| where properties.dataProtection.backup.backupPolicyId == \"\"\n| project recommendationId = \"b2fb3e60-97ec-e34d-af29-b16a0d61c2ac\", name, id, tags\n",
            "guid": "b2fb3e60-97ec-e34d-af29-b16a0d61c2ac",
            "learnMoreLink": [
                {
                    "name": "Understand Azure NetApp Files backup | Microsoft Learn",
                    "url": "https://learn.microsoft.com/azure/azure-netapp-files/backup-introduction"
                }
            ],
            "longDescription": "Azure NetApp Files offers a fully managed backup solution enhancing long-term recovery, archiving, and compliance.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhances data recovery and compliance",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Disaster Recovery",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.NetApp/netAppAccounts",
            "recommendationTypeId": null,
            "service": "ANF",
            "severity": "High",
            "source": "azure-resources/NetApp/netAppAccounts/recommendations.yaml",
            "tags": null,
            "text": "Enable backup for data protection in Azure NetApp Files"
        },
        {
            "aprlGuid": "e30317d2-c502-4dfe-a2d3-0a737cc79545",
            "automationAvailable": "arg",
            "category": "Disaster Recovery",
            "description": "Azure NetApp Files replication offers data protection by allowing asynchronous cross-region volume replication for application failover in case of regional outages. Volumes can be replicated across regions, not concurrently with cross-zone replication. Note that failover is a manual process.\n",
            "graph": "// Azure Resource Graph Query\n// This Resource Graph query will return all Azure NetApp Files volumes without cross-region replication.\nresources\n| where type == \"microsoft.netapp/netappaccounts/capacitypools/volumes\"\n| extend remoteVolumeRegion = properties.dataProtection.replication.remoteVolumeRegion\n| extend volumeType = properties.volumeType\n| extend replicationType = iff((remoteVolumeRegion == location), \"CZR\", iff((remoteVolumeRegion == \"\"),\"n/a\",\"CRR\"))\n| where replicationType != \"CRR\" and volumeType != \"DataProtection\"\n| project recommendationId = \"e30317d2-c502-4dfe-a2d3-0a737cc79545\", name, id, tags\n\n",
            "guid": "e30317d2-c502-4dfe-a2d3-0a737cc79545",
            "learnMoreLink": [
                {
                    "name": "Cross-region replication of Azure NetApp Files volumes",
                    "url": "https://learn.microsoft.com/en-us/azure/azure-netapp-files/cross-region-replication-introduction"
                }
            ],
            "longDescription": "Azure NetApp Files replication offers data protection by allowing asynchronous cross-region volume replication for application failover in case of regional outages. Volumes can be replicated across regions, not concurrently with cross-zone replication. Note that failover is a manual process.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhanced data protection and disaster recovery",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Disaster Recovery",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.NetApp/netAppAccounts",
            "recommendationTypeId": null,
            "service": "ANF",
            "severity": "High",
            "source": "azure-resources/NetApp/netAppAccounts/recommendations.yaml",
            "tags": null,
            "text": "Enable Cross-region replication of Azure NetApp Files volumes"
        },
        {
            "aprlGuid": "e3d742e1-dacd-9b48-b6b1-510ec9f87c96",
            "automationAvailable": "arg",
            "category": "Disaster Recovery",
            "description": "The cross-zone replication (CZR) feature enables asynchronous data replication between Azure NetApp Files volumes across different availability zones, ensuring data protection and critical application failover in case of zone-wide disasters. Note that failover is a manual process.\n",
            "graph": "// Azure Resource Graph Query\n// This Resource Graph query will return all Azure NetApp Files volumes without cross-zone replication.\nresources\n| where type == \"microsoft.netapp/netappaccounts/capacitypools/volumes\"\n| extend remoteVolumeRegion = properties.dataProtection.replication.remoteVolumeRegion\n| extend volumeType = properties.volumeType\n| extend replicationType = iff((remoteVolumeRegion == location), \"CZR\", iff((remoteVolumeRegion == \"\"),\"n/a\",\"CRR\"))\n| where replicationType != \"CZR\" and volumeType != \"DataProtection\"\n| project recommendationId = \"e3d742e1-dacd-9b48-b6b1-510ec9f87c96\", name, id, tags\n\n",
            "guid": "e3d742e1-dacd-9b48-b6b1-510ec9f87c96",
            "learnMoreLink": [
                {
                    "name": "Cross-zone replication of Azure NetApp Files volumes | Microsoft Learn",
                    "url": "https://learn.microsoft.com/azure/azure-netapp-files/cross-zone-replication-introduction"
                }
            ],
            "longDescription": "The cross-zone replication (CZR) feature enables asynchronous data replication between Azure NetApp Files volumes across different availability zones, ensuring data protection and critical application failover in case of zone-wide disasters. Note that failover is a manual process.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhances disaster recovery across availability zones",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Disaster Recovery",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.NetApp/netAppAccounts",
            "recommendationTypeId": null,
            "service": "ANF",
            "severity": "High",
            "source": "azure-resources/NetApp/netAppAccounts/recommendations.yaml",
            "tags": null,
            "text": "Enable Cross-zone replication of Azure NetApp Files volumes"
        },
        {
            "aprlGuid": "2f579fc9-e599-0d44-8b97-254f50ae04d8",
            "automationAvailable": false,
            "category": "Monitoring and Alerting",
            "description": "Azure NetApp Files offers metrics like allocated storage, actual usage, volume IOPS, and latency, enabling a better understanding of usage patterns and volume performance for NetApp accounts.\n",
            "graph": "// cannot-be-validated-with-arg\n\n",
            "guid": "2f579fc9-e599-0d44-8b97-254f50ae04d8",
            "learnMoreLink": [
                {
                    "name": "Ways to monitor Azure NetApp Files | Microsoft Learn",
                    "url": "https://learn.microsoft.com/azure/azure-netapp-files/monitor-azure-netapp-files"
                }
            ],
            "longDescription": "Azure NetApp Files offers metrics like allocated storage, actual usage, volume IOPS, and latency, enabling a better understanding of usage patterns and volume performance for NetApp accounts.\n",
            "pgVerified": true,
            "potentialBenefits": "Optimize usage and performance",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Monitoring and Alerting",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.NetApp/netAppAccounts",
            "recommendationTypeId": null,
            "service": "ANF",
            "severity": "Medium",
            "source": "azure-resources/NetApp/netAppAccounts/recommendations.yaml",
            "tags": null,
            "text": "Monitor Azure NetApp Files metrics to better understand usage pattern and performance"
        },
        {
            "aprlGuid": "687ae58f-517f-ca43-90fe-922497e61283",
            "automationAvailable": false,
            "category": "Governance",
            "description": "Azure NetApp Files supports Azure policy integration using either built-in policy definitions or by creating custom ones to maintain organizational standards and compliance.\n",
            "graph": "// cannot-be-validated-with-arg\n\n",
            "guid": "687ae58f-517f-ca43-90fe-922497e61283",
            "learnMoreLink": [
                {
                    "name": "Azure Policy definitions for Azure NetApp Files | Microsoft Learn",
                    "url": "https://learn.microsoft.com/azure/azure-netapp-files/azure-policy-definitions"
                },
                {
                    "name": "Creating custom policy definitions | Microsoft Learn",
                    "url": "https://learn.microsoft.com/azure/governance/policy/tutorials/create-custom-policy-definition"
                }
            ],
            "longDescription": "Azure NetApp Files supports Azure policy integration using either built-in policy definitions or by creating custom ones to maintain organizational standards and compliance.\n",
            "pgVerified": true,
            "potentialBenefits": "Enforce standards and assess compliance",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Governance",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.NetApp/netAppAccounts",
            "recommendationTypeId": null,
            "service": "ANF",
            "severity": "Medium",
            "source": "azure-resources/NetApp/netAppAccounts/recommendations.yaml",
            "tags": null,
            "text": "Enforce standards and assess compliance in Azure NetApp Files with Azure policy"
        },
        {
            "aprlGuid": "cfa2244b-5436-47de-8287-b217875d3b0a",
            "automationAvailable": false,
            "category": "Security",
            "description": "Access to the delegated subnet should be limited to specific Azure Virtual Networks. SMB-enabled volumes' share permissions should move away from 'Everyone/Full control'. NFS-enabled volumes' access needs to be controlled via export policies and/or NFSv4.1 ACLs.\n",
            "graph": "// cannot-be-validated-with-arg\n\n",
            "guid": "cfa2244b-5436-47de-8287-b217875d3b0a",
            "learnMoreLink": [
                {
                    "name": "Configure network features for an Azure NetApp Files volume",
                    "url": "https://learn.microsoft.com/azure/azure-netapp-files/configure-network-features"
                },
                {
                    "name": "Manage SMB share ACLs in Azure NetApp Files",
                    "url": "https://learn.microsoft.com/azure/azure-netapp-files/manage-smb-share-access-control-lists"
                },
                {
                    "name": "Configure export policy for NFS or dual-protocol volumes",
                    "url": "https://learn.microsoft.com/azure/azure-netapp-files/azure-netapp-files-configure-export-policy"
                },
                {
                    "name": "Configure access control lists on NFSv4.1 volumes for Azure NetApp Files",
                    "url": "https://learn.microsoft.com/azure/azure-netapp-files/configure-access-control-lists"
                },
                {
                    "name": "Configure Unix permissions and change ownership mode for NFS and dual-protocol volumes",
                    "url": "https://learn.microsoft.com/azure/azure-netapp-files/configure-unix-permissions-change-ownership-mode"
                }
            ],
            "longDescription": "Access to the delegated subnet should be limited to specific Azure Virtual Networks. SMB-enabled volumes' share permissions should move away from 'Everyone/Full control'. NFS-enabled volumes' access needs to be controlled via export policies and/or NFSv4.1 ACLs.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhanced security, Reduced data breach risk",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Security",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.NetApp/netAppAccounts",
            "recommendationTypeId": null,
            "service": "ANF",
            "severity": "Medium",
            "source": "azure-resources/NetApp/netAppAccounts/recommendations.yaml",
            "tags": null,
            "text": "Restrict default access to Azure NetApp Files volumes"
        },
        {
            "aprlGuid": "d1e7ccc3-e6c1-40e9-a36e-fd134711c808",
            "automationAvailable": false,
            "category": "High Availability",
            "description": "Certain SMB applications need SMB Transparent Failover for maintenance without interrupting server connectivity. Azure NetApp Files provides this through SMB Continuous Availability for applications like Citrix App Layering, FSLogix user/profile containers, Microsoft SQL Server, MSIX app attach.\n",
            "graph": "// cannot-be-validated-with-arg\n\n",
            "guid": "d1e7ccc3-e6c1-40e9-a36e-fd134711c808",
            "learnMoreLink": [
                {
                    "name": "Do I need to take special precautions for SMB-based applications? | Microsoft Learn",
                    "url": "https://learn.microsoft.com/azure/azure-netapp-files/faq-application-resilience#do-i-need-to-take-special-precautions-for-smb-based-applications"
                }
            ],
            "longDescription": "Certain SMB applications need SMB Transparent Failover for maintenance without interrupting server connectivity. Azure NetApp Files provides this through SMB Continuous Availability for applications like Citrix App Layering, FSLogix user/profile containers, Microsoft SQL Server, MSIX app attach.\n",
            "pgVerified": true,
            "potentialBenefits": "Zero downtime for SMB apps",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.NetApp/netAppAccounts",
            "recommendationTypeId": "e4bebd74-387a-4a74-b757-475d2d1b4e3e",
            "service": "ANF",
            "severity": "High",
            "source": "azure-resources/NetApp/netAppAccounts/recommendations.yaml",
            "tags": null,
            "text": "Make use of SMB continuous availability for supported applications"
        },
        {
            "aprlGuid": "60f36f9b-fac9-4160-bbf5-57af04da4f53",
            "automationAvailable": false,
            "category": "High Availability",
            "description": "Azure NetApp Files might undergo occasional planned maintenance such as platform updates or service and software upgrades. It's important to be aware of the application's resiliency settings to cope with these storage service maintenance events.\n",
            "graph": "// cannot-be-validated-with-arg\n\n",
            "guid": "60f36f9b-fac9-4160-bbf5-57af04da4f53",
            "learnMoreLink": [
                {
                    "name": "What do you recommend for handling potential application disruptions due to storage service maintenance events? | Microsoft Learn",
                    "url": "https://learn.microsoft.com/azure/azure-netapp-files/faq-application-resilience#what-do-you-recommend-for-handling-potential-application-disruptions-due-to-storage-service-maintenance-events"
                }
            ],
            "longDescription": "Azure NetApp Files might undergo occasional planned maintenance such as platform updates or service and software upgrades. It's important to be aware of the application's resiliency settings to cope with these storage service maintenance events.\n",
            "pgVerified": true,
            "potentialBenefits": "Minimizes downtime during maintenance",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.NetApp/netAppAccounts",
            "recommendationTypeId": null,
            "service": "ANF",
            "severity": "Medium",
            "source": "azure-resources/NetApp/netAppAccounts/recommendations.yaml",
            "tags": null,
            "text": "Ensure application resilience for service maintenance events"
        },
        {
            "aprlGuid": "823b0cff-05c0-2e4e-a1e7-9965e1cfa16f",
            "automationAvailable": "arg",
            "category": "Scalability",
            "description": "Azure Application Gateways v2 are always deployed in a highly available fashion with multiple instances by default. Enabling autoscale ensures the service is not reliant on manual intervention for scaling.\n",
            "graph": "// Azure Resource Graph Query\n// This query will return all Application Gateways that do not have autoscale enabled or have a min capacity of 1\nresources\n| where type =~ \"microsoft.network/applicationGateways\"\n| where isnull(properties.autoscaleConfiguration) or properties.autoscaleConfiguration.minCapacity <= 1\n| project recommendationId = \"823b0cff-05c0-2e4e-a1e7-9965e1cfa16f\", name, id, tags, param1 = \"autoScaleConfiguration: isNull or MinCapacity <= 1\"\n| order by id asc\n\n\n",
            "guid": "823b0cff-05c0-2e4e-a1e7-9965e1cfa16f",
            "learnMoreLink": [
                {
                    "name": "Application Gateway Autoscaling Zone-Redundant",
                    "url": "https://learn.microsoft.com/azure/application-gateway/application-gateway-autoscaling-zone-redundant#autoscaling-and-high-availability"
                }
            ],
            "longDescription": "Azure Application Gateways v2 are always deployed in a highly available fashion with multiple instances by default. Enabling autoscale ensures the service is not reliant on manual intervention for scaling.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhances uptime and enables autoscaling",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Scalability",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/applicationGateways",
            "recommendationTypeId": "c9c9750b-9ddb-436f-b19a-9c725539a0b5",
            "service": "AppGW",
            "severity": "Medium",
            "source": "azure-resources/Network/applicationGateways/recommendations.yaml",
            "tags": null,
            "text": "Ensure Autoscale feature has been enabled"
        },
        {
            "aprlGuid": "233a7008-71e9-e745-923e-1a1c7a0b92f3",
            "automationAvailable": "arg",
            "category": "Security",
            "description": "Secure all incoming connections using HTTPS for production services with end-to-end SSL/TLS or SSL/TLS termination at the Application Gateway to protect against attacks and ensure data remains private and encrypted between the web server and browsers.\n",
            "graph": "// Azure Resource Graph Query\n// You can use the following Azure Resource Graph query to check if an HTTP rule is using an SSL certificate or is using Azure Key Vault to store the certificates\nresources\n| where type =~ \"microsoft.network/applicationGateways\"\n| mv-expand frontendPorts = properties.frontendPorts\n| mv-expand httpListeners = properties.httpListeners\n| where isnull(parse_json(httpListeners.properties.sslCertificate))\n| project recommendationId=\"233a7008-71e9-e745-923e-1a1c7a0b92f3\", name, id, tags, param1=strcat(\"frontendPort: \", frontendPorts.properties.port), param2=\"tls: false\"\n\n",
            "guid": "233a7008-71e9-e745-923e-1a1c7a0b92f3",
            "learnMoreLink": [
                {
                    "name": "Application Gateway Security",
                    "url": "https://learn.microsoft.com/azure/well-architected/services/networking/azure-application-gateway#security"
                },
                {
                    "name": "Application Gateway SSL Overview",
                    "url": "https://learn.microsoft.com/azure/application-gateway/ssl-overview"
                },
                {
                    "name": "Application Gateway SSL Policy Overview",
                    "url": "https://learn.microsoft.com/azure/application-gateway/application-gateway-ssl-policy-overview"
                },
                {
                    "name": "Application Gateway KeyVault Certs",
                    "url": "https://learn.microsoft.com/azure/application-gateway/key-vault-certs"
                },
                {
                    "name": "Application Gateway SSL Cert Management",
                    "url": "https://learn.microsoft.com/azure/application-gateway/ssl-certificate-management"
                }
            ],
            "longDescription": "Secure all incoming connections using HTTPS for production services with end-to-end SSL/TLS or SSL/TLS termination at the Application Gateway to protect against attacks and ensure data remains private and encrypted between the web server and browsers.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhanced security and privacy",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Security",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/applicationGateways",
            "recommendationTypeId": null,
            "service": "AppGW",
            "severity": "High",
            "source": "azure-resources/Network/applicationGateways/recommendations.yaml",
            "tags": null,
            "text": "Secure all incoming connections with SSL"
        },
        {
            "aprlGuid": "8d9223c4-730d-ca47-af88-a9a024c37270",
            "automationAvailable": "arg",
            "category": "Security",
            "description": "Use Application Gateway with Web Application Firewall (WAF) in an application virtual network to safeguard inbound HTTP/S internet traffic. WAF offers centralized defense against potential exploits through OWASP core rule sets-based rules.\n",
            "graph": "// Azure Resource Graph Query\n// This query will return all Application Gateways that do not have WAF enabled\nResources\n| where type =~ \"microsoft.network/applicationGateways\"\n| where properties.firewallpolicy != \"\"\n| project recommendationId = \"8d9223c4-730d-ca47-af88-a9a024c37270\", name, id, tags, param1 = \"webApplicationFirewallConfiguration: isNull\"\n| order by id asc\n\n\n",
            "guid": "8d9223c4-730d-ca47-af88-a9a024c37270",
            "learnMoreLink": [
                {
                    "name": "Well-Architected Framework Application Gateway Overview",
                    "url": "https://learn.microsoft.com/azure/well-architected/services/networking/azure-application-gateway"
                },
                {
                    "name": "Application Gateway - Web Application Firewall",
                    "url": "https://learn.microsoft.com/azure/application-gateway/features#web-application-firewall"
                }
            ],
            "longDescription": "Use Application Gateway with Web Application Firewall (WAF) in an application virtual network to safeguard inbound HTTP/S internet traffic. WAF offers centralized defense against potential exploits through OWASP core rule sets-based rules.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhanced security for HTTP/S traffic",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Security",
            "recommendationImpact": "Low",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/applicationGateways",
            "recommendationTypeId": "efe75f01-6fff-5d9d-08e6-092b98d3fb3f",
            "service": "AppGW",
            "severity": "Low",
            "source": "azure-resources/Network/applicationGateways/recommendations.yaml",
            "tags": null,
            "text": "Enable Web Application Firewall policies"
        },
        {
            "aprlGuid": "7893f0b3-8622-1d47-beed-4b50a19f7895",
            "automationAvailable": "arg",
            "category": "Scalability",
            "description": "Use Application Gateway v2 for built-in features like autoscaling, static VIPs, Azure KeyVault integration for better traffic management and performance, unless v1 is necessary.\n",
            "graph": "// Azure Resource Graph Query\n// Get all Application Gateways, which are using the deprecated V1 SKU\nresources\n| where type =~ 'microsoft.network/applicationgateways'\n| extend tier = properties.sku.tier\n| where tier == 'Standard' or tier == 'WAF'\n| project recommendationId = \"7893f0b3-8622-1d47-beed-4b50a19f7895\", name, id, tags\n\n",
            "guid": "7893f0b3-8622-1d47-beed-4b50a19f7895",
            "learnMoreLink": [
                {
                    "name": "Application Gateway Overview V2",
                    "url": "https://learn.microsoft.com/azure/application-gateway/overview-v2"
                },
                {
                    "name": "Application Gateway Feature Comparison Between V1 and V2",
                    "url": "https://learn.microsoft.com/azure/application-gateway/overview-v2#feature-comparison-between-v1-sku-and-v2-sku"
                },
                {
                    "name": "Application Gateway V1 Retirement",
                    "url": "https://azure.microsoft.com/updates/application-gateway-v1-will-be-retired-on-28-april-2026-transition-to-application-gateway-v2/"
                }
            ],
            "longDescription": "Use Application Gateway v2 for built-in features like autoscaling, static VIPs, Azure KeyVault integration for better traffic management and performance, unless v1 is necessary.\n",
            "pgVerified": true,
            "potentialBenefits": "Better performance, autoscaling, more features",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Scalability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/applicationGateways",
            "recommendationTypeId": "0e19257e-dcef-4d00-8de1-5fe1ae0fd948",
            "service": "AppGW",
            "severity": "High",
            "source": "azure-resources/Network/applicationGateways/recommendations.yaml",
            "tags": null,
            "text": "Migrate to Application Gateway v2"
        },
        {
            "aprlGuid": "5d035919-898d-a047-8d5d-454e199692e5",
            "automationAvailable": false,
            "category": "Monitoring and Alerting",
            "description": "Enable logging in storage accounts, Log Analytics, and monitoring services for auditing and insights. If using NSGs, enable NSG flow logs to be stored, providing in-depth traffic analysis into Azure Cloud.\n",
            "graph": "// cannot-be-validated-with-arg\n\n",
            "guid": "5d035919-898d-a047-8d5d-454e199692e5",
            "learnMoreLink": [
                {
                    "name": "Application Gateway Metrics",
                    "url": "https://learn.microsoft.com/azure/application-gateway/application-gateway-metrics"
                },
                {
                    "name": "Application Gateway Diagnostics",
                    "url": "https://learn.microsoft.com/azure/application-gateway/application-gateway-diagnostics"
                }
            ],
            "longDescription": "Enable logging in storage accounts, Log Analytics, and monitoring services for auditing and insights. If using NSGs, enable NSG flow logs to be stored, providing in-depth traffic analysis into Azure Cloud.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhanced traffic insight and audit",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Monitoring and Alerting",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/applicationGateways",
            "recommendationTypeId": null,
            "service": "AppGW",
            "severity": "High",
            "source": "azure-resources/Network/applicationGateways/recommendations.yaml",
            "tags": null,
            "text": "Monitor and Log the configurations and traffic"
        },
        {
            "aprlGuid": "847a8d88-21c4-bc48-a94e-562206edd767",
            "automationAvailable": "arg",
            "category": "Monitoring and Alerting",
            "description": "Using custom health probes enhances understanding of backend availability and facilitates monitoring of backend services for any impact.\n",
            "graph": "// Azure Resource Graph Query\n// Application Gateways are not using health probes to monitor the availability of the backend systems\nresources\n| where type =~ \"microsoft.network/applicationGateways\"\n| where array_length(properties.probes) == 0\n| project recommendationId=\"847a8d88-21c4-bc48-a94e-562206edd767\", name, id, tags, param1=\"customHealthProbeUsed: false\"\n\n",
            "guid": "847a8d88-21c4-bc48-a94e-562206edd767",
            "learnMoreLink": [
                {
                    "name": "Application Gateway Probe Overview",
                    "url": "https://learn.microsoft.com/azure/application-gateway/application-gateway-probe-overview"
                },
                {
                    "name": "Well-Architected Framework Application Gateway Overview",
                    "url": "https://learn.microsoft.com/azure/well-architected/services/networking/azure-application-gateway"
                }
            ],
            "longDescription": "Using custom health probes enhances understanding of backend availability and facilitates monitoring of backend services for any impact.\n",
            "pgVerified": true,
            "potentialBenefits": "Ensures backend uptime monitoring.",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Monitoring and Alerting",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/applicationGateways",
            "recommendationTypeId": null,
            "service": "AppGW",
            "severity": "High",
            "source": "azure-resources/Network/applicationGateways/recommendations.yaml",
            "tags": null,
            "text": "Use Health Probes to detect backend availability"
        },
        {
            "aprlGuid": "c9c00f2a-3888-714b-a72b-b4c9e8fcffb2",
            "automationAvailable": "arg",
            "category": "High Availability",
            "description": "Deploying Application Gateway in a zone-aware configuration ensures continued customer access to services even if a specific zone goes down, as services in other zones remain available.\n",
            "graph": "// Azure Resource Graph Query\n// list Application Gateways that are not configured to use at least 2 Availability Zones\nresources\n| where type =~ \"microsoft.network/applicationGateways\"\n| where isnull(zones) or array_length(zones) < 2\n| extend zoneValue = iff((isnull(zones)), \"null\", zones)\n| project recommendationId = \"c9c00f2a-3888-714b-a72b-b4c9e8fcffb2\", name, id, tags, param1=\"Zones: No Zone or Zonal\", param2=strcat(\"Zones value: \", zoneValue )\n\n",
            "guid": "c9c00f2a-3888-714b-a72b-b4c9e8fcffb2",
            "learnMoreLink": [
                {
                    "name": "Well-Architected Framework Application Gateway Reliability",
                    "url": "https://learn.microsoft.com/azure/well-architected/services/networking/azure-application-gateway#reliability"
                },
                {
                    "name": "Application Gateway V2 Overview",
                    "url": "https://learn.microsoft.com/azure/application-gateway/overview-v2"
                }
            ],
            "longDescription": "Deploying Application Gateway in a zone-aware configuration ensures continued customer access to services even if a specific zone goes down, as services in other zones remain available.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhanced uptime and customer access",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/applicationGateways",
            "recommendationTypeId": "5c488377-be3e-4365-92e8-09d1e8d9038c",
            "service": "AppGW",
            "severity": "High",
            "source": "azure-resources/Network/applicationGateways/recommendations.yaml",
            "tags": null,
            "text": "Deploy Application Gateway in a zone-redundant configuration"
        },
        {
            "aprlGuid": "10f02bc6-e2e7-004d-a2c2-f9bf9f16b915",
            "automationAvailable": "arg",
            "category": "High Availability",
            "description": "Using connection draining for backend maintenance ensures graceful removal of backend pool members during updates or health issues. It's enabled via Backend Setting and applies to all members during rule creation.\n",
            "graph": "// Azure Resource Graph Query\n// This query will check if connection draining is enabled\nresources\n| where type =~ \"microsoft.network/applicationGateways\"\n| mv-expand backendHttpSettings = properties.backendHttpSettingsCollection\n| extend connectionDrainingEnabled = backendHttpSettings.properties.connectionDraining.enabled\n| where connectionDrainingEnabled != true\n| extend backendPoolName = backendHttpSettings.name\n| project recommendationId = \"10f02bc6-e2e7-004d-a2c2-f9bf9f16b915\", name, id, tags, param1 = \"connectionDraining: Disabled\", param2 = strcat(\"backendSettingsName: \", backendPoolName)\n\n",
            "guid": "10f02bc6-e2e7-004d-a2c2-f9bf9f16b915",
            "learnMoreLink": [
                {
                    "name": "Application Gateway Connection Draining",
                    "url": "https://learn.microsoft.com/azure/application-gateway/features#connection-draining"
                },
                {
                    "name": "Application Gateway Connection Draining HTTP Settings",
                    "url": "https://learn.microsoft.com/azure/application-gateway/configuration-http-settings#connection-draining"
                }
            ],
            "longDescription": "Using connection draining for backend maintenance ensures graceful removal of backend pool members during updates or health issues. It's enabled via Backend Setting and applies to all members during rule creation.\n",
            "pgVerified": true,
            "potentialBenefits": "Smooth updates, no dropped users",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/applicationGateways",
            "recommendationTypeId": null,
            "service": "AppGW",
            "severity": "Medium",
            "source": "azure-resources/Network/applicationGateways/recommendations.yaml",
            "tags": null,
            "text": "Plan for backend maintenance by using connection draining"
        },
        {
            "aprlGuid": "8364fd0a-7c0e-e240-9d95-4bf965aec243",
            "automationAvailable": "arg",
            "category": "Other Best Practices",
            "description": "Application Gateway v2 (Standard_v2 or WAF_v2 SKU) can support up to 125 instances. A /24 subnet isn't mandatory for deployment but is advised to provide enough space for autoscaling and maintenance upgrades.\n",
            "graph": "// Azure Resource Graph Query\n// This query will validate the subnet id for an appGW ends with a /24\n\nresources\n| where type =~ 'Microsoft.Network/applicationGateways'\n| extend subnetid = tostring(properties.gatewayIPConfigurations[0].properties.subnet.id)\n| join kind=leftouter(resources\n    | where type == \"microsoft.network/virtualnetworks\"\n    | mv-expand properties.subnets\n    | extend subnetid = tostring(properties_subnets.id)\n    | extend addressprefix = tostring(properties_subnets.properties.addressPrefix)\n    | project subnetid, addressprefix) on subnetid\n| where addressprefix !endswith '/24'\n| project recommendationId = \"8364fd0a-7c0e-e240-9d95-4bf965aec243\", name, id, tags, param1 = strcat('AppGW subnet prefix: ', addressprefix)\n\n",
            "guid": "8364fd0a-7c0e-e240-9d95-4bf965aec243",
            "learnMoreLink": [
                {
                    "name": "Azure Application Gateway infrastructure configuration | Microsoft Learn",
                    "url": "https://learn.microsoft.com/en-us/azure/application-gateway/configuration-infrastructure#size-of-the-subnet"
                }
            ],
            "longDescription": "Application Gateway v2 (Standard_v2 or WAF_v2 SKU) can support up to 125 instances. A /24 subnet isn't mandatory for deployment but is advised to provide enough space for autoscaling and maintenance upgrades.\n",
            "pgVerified": true,
            "potentialBenefits": "Allows autoscaling and maintenance",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Other Best Practices",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/applicationGateways",
            "recommendationTypeId": "ef4da732-f541-4109-bc0e-465c68b6c7eb",
            "service": "AppGW",
            "severity": "High",
            "source": "azure-resources/Network/applicationGateways/recommendations.yaml",
            "tags": null,
            "text": "Ensure Application Gateway Subnet is using a /24 subnet mask"
        },
        {
            "aprlGuid": "c72b7fee-1fa0-5b4b-98e5-54bcae95bb74",
            "automationAvailable": "arg",
            "category": "High Availability",
            "description": "Azure Firewall offers different SLAs depending on its deployment; in a single availability zone or across multiple, potentially improving reliability and performance.\n",
            "graph": "// Azure Resource Graph Query\n// List all Azure Firewalls that are not configured with multiple availability zones or deployed without a zone\nresources\n| where type == 'microsoft.network/azurefirewalls'\n| where array_length(zones) <= 1 or isnull(zones)\n| where isempty(properties.virtualHub.id) or isnull(properties.virtualHub.id)\n| project recommendationId = \"c72b7fee-1fa0-5b4b-98e5-54bcae95bb74\", name, id, tags, param1=\"multipleZones:false\"\n\n",
            "guid": "c72b7fee-1fa0-5b4b-98e5-54bcae95bb74",
            "learnMoreLink": [
                {
                    "name": "Azure Well Architected Framework - Azure Firewall",
                    "url": "https://learn.microsoft.com/azure/architecture/framework/services/networking/azure-firewall"
                },
                {
                    "name": "Deploy Azure Firewall across multiple availability zones",
                    "url": "https://learn.microsoft.com/azure/firewall/deploy-availability-zone-powershell"
                }
            ],
            "longDescription": "Azure Firewall offers different SLAs depending on its deployment; in a single availability zone or across multiple, potentially improving reliability and performance.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhanced SLA and reliability",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/azureFirewalls",
            "recommendationTypeId": null,
            "service": "Firewall",
            "severity": "High",
            "source": "azure-resources/Network/azureFirewalls/recommendations.yaml",
            "tags": null,
            "text": "Deploy Azure Firewall across multiple availability zones"
        },
        {
            "aprlGuid": "3c8fa7c6-6b78-a24a-a63f-348a7c71acb9",
            "automationAvailable": "arg",
            "category": "Monitoring and Alerting",
            "description": "Monitor Azure Firewall for overall health, processed throughput, and outbound SNAT port usage. Get alerted before limits impact services. Consider NAT gateway integration with zonal deployments; note limitations with zone redundant firewalls and secure virtual hub networks.\n",
            "graph": "// Azure Resource Graph Query\n// List all Azure Firewalls resources in-scope, along with any metrics associated to Azure Monitor alert rules, that are not fully configured.\nresources\n| where type == \"microsoft.network/azurefirewalls\"\n| project firewallId = tolower(id), name, tags\n| join kind = leftouter (\n    resources\n    | where type == \"microsoft.insights/metricalerts\"\n    | mv-expand properties.scopes\n    | mv-expand properties.criteria.allOf\n    | where properties_scopes contains \"azureFirewalls\"\n    | project metricId = tolower(properties_scopes), monitoredMetric = properties_criteria_allOf.metricName, tags\n    | summarize monitoredMetrics = make_list(monitoredMetric) by tostring(metricId)\n    | project\n        metricId,\n        monitoredMetrics,\n        allAlertsConfigured = monitoredMetrics contains(\"FirewallHealth\") and monitoredMetrics contains (\"Throughput\") and monitoredMetrics contains (\"SNATPortUtilization\")\n) on $left.firewallId == $right.metricId\n| extend alertsNotFullyConfigured = isnull(allAlertsConfigured) or not(allAlertsConfigured)\n| where alertsNotFullyConfigured\n| project recommendationId = \"c8fa7c6-6b78-a24a-a63f-348a7c71acb9\", name, id = firewallId, tags, param1 = strcat(\"MetricsAlerts:\", monitoredMetrics)\n\n",
            "guid": "3c8fa7c6-6b78-a24a-a63f-348a7c71acb9",
            "learnMoreLink": [
                {
                    "name": "Azure Firewall metrics supported in Azure Monitor",
                    "url": "https://learn.microsoft.com/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkazurefirewalls"
                },
                {
                    "name": "Azure Firewall performance",
                    "url": "https://learn.microsoft.com/azure/firewall/firewall-performance"
                }
            ],
            "longDescription": "Monitor Azure Firewall for overall health, processed throughput, and outbound SNAT port usage. Get alerted before limits impact services. Consider NAT gateway integration with zonal deployments; note limitations with zone redundant firewalls and secure virtual hub networks.\n",
            "pgVerified": true,
            "potentialBenefits": "Improve health and performance monitoring",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Monitoring and Alerting",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/azureFirewalls",
            "recommendationTypeId": null,
            "service": "Firewall",
            "severity": "High",
            "source": "azure-resources/Network/azureFirewalls/recommendations.yaml",
            "tags": null,
            "text": "Monitor Azure Firewall metrics"
        },
        {
            "aprlGuid": "1b2dbf4a-8a0b-5e4b-8f4e-3f758188910d",
            "automationAvailable": "arg",
            "category": "Security",
            "description": "Associate a DDoS protection plan with the virtual network hosting Azure Firewall to provide enhanced mitigation against DDoS attacks. Azure Firewall Manager integrates the creation of firewall infrastructure and DDoS protection plans.\n",
            "graph": "// Azure Resource Graph Query\n// List all in-scope Azure Firewall resources, where the VNet is not associated to a DDoS Protection Plan\nresources\n| where type =~ \"Microsoft.Network/azureFirewalls\"\n| where isempty(properties.virtualHub.id) or isnull(properties.virtualHub.id)\n| mv-expand ipConfig = properties.ipConfigurations\n| project\n    name,\n    firewallId = id,\n    tags,\n    vNetName = split(ipConfig.properties.subnet.id, \"/\", 8)[0],\n    vNetId = tolower(substring(ipConfig.properties.subnet.id, 0, indexof(ipConfig.properties.subnet.id, \"/subnet\")))\n| join kind=fullouter (\n    resources\n    | where type =~ \"Microsoft.Network/ddosProtectionPlans\"\n    | mv-expand vNet = properties.virtualNetworks\n    | project ddosProtectionPlanId = id, vNetId = tolower(vNet.id)\n    )\n    on vNetId\n| where isempty(ddosProtectionPlanId)\n| project recommendationId = \"1b2dbf4a-8a0b-5e4b-8f4e-3f758188910d\", name, id = firewallId, tags, param1 = strcat(\"vNet: \", vNetName), param2 = \"ddosProtection: Disabled\"\n",
            "guid": "1b2dbf4a-8a0b-5e4b-8f4e-3f758188910d",
            "learnMoreLink": [
                {
                    "name": "Azure DDoS Protection overview",
                    "url": "https://learn.microsoft.com/azure/ddos-protection/ddos-protection-overview"
                }
            ],
            "longDescription": "Associate a DDoS protection plan with the virtual network hosting Azure Firewall to provide enhanced mitigation against DDoS attacks. Azure Firewall Manager integrates the creation of firewall infrastructure and DDoS protection plans.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhanced DDoS attack defense",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Security",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/azureFirewalls",
            "recommendationTypeId": null,
            "service": "Firewall",
            "severity": "High",
            "source": "azure-resources/Network/azureFirewalls/recommendations.yaml",
            "tags": null,
            "text": "Configure DDoS Protection on the Azure Firewall VNet"
        },
        {
            "aprlGuid": "3a63560a-1ed3-6140-acd1-d1d23f9a2e12",
            "automationAvailable": false,
            "category": "Governance",
            "description": "Azure Firewall policy supports rule hierarchies for compliance enforcement, using a central base policy with higher priority over child policies, and employs Azure custom roles to safeguard base policy and manage access within subscriptions or groups.\n",
            "graph": "// under-development\n\n",
            "guid": "3a63560a-1ed3-6140-acd1-d1d23f9a2e12",
            "learnMoreLink": [
                {
                    "name": "Azure Firewall Policy hierarchy",
                    "url": "https://learn.microsoft.com/azure/firewall-manager/rule-hierarchy"
                }
            ],
            "longDescription": "Azure Firewall policy supports rule hierarchies for compliance enforcement, using a central base policy with higher priority over child policies, and employs Azure custom roles to safeguard base policy and manage access within subscriptions or groups.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhanced compliance and rule hierarchy",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Governance",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/azureFirewalls",
            "recommendationTypeId": null,
            "service": "Firewall",
            "severity": "Medium",
            "source": "azure-resources/Network/azureFirewalls/recommendations.yaml",
            "tags": null,
            "text": "Leverage Azure Firewall policy inheritance model"
        },
        {
            "aprlGuid": "d2e4a38e-2307-4299-a217-4c0cebc9a7f6",
            "automationAvailable": false,
            "category": "High Availability",
            "description": "Configure a minimum of two to four public IP addresses per Azure Firewall to avoid SNAT exhaustion. Azure Firewall offers SNAT for all outbound traffic to public IPs, providing 2,496 SNAT ports for each additional PIP.\n",
            "graph": "// under development\n\n",
            "guid": "d2e4a38e-2307-4299-a217-4c0cebc9a7f6",
            "learnMoreLink": [
                {
                    "name": "Azure Well-Architected Framework review - Azure Firewall",
                    "url": "https://learn.microsoft.com/en-us/azure/well-architected/service-guides/azure-firewall#recommendations"
                }
            ],
            "longDescription": "Configure a minimum of two to four public IP addresses per Azure Firewall to avoid SNAT exhaustion. Azure Firewall offers SNAT for all outbound traffic to public IPs, providing 2,496 SNAT ports for each additional PIP.\n",
            "pgVerified": false,
            "potentialBenefits": "Avoids SNAT exhaustion.",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/azureFirewalls",
            "recommendationTypeId": null,
            "service": "Firewall",
            "severity": "Medium",
            "source": "azure-resources/Network/azureFirewalls/recommendations.yaml",
            "tags": null,
            "text": "Configure 2-4 PIPs for SNAT Port utilization"
        },
        {
            "aprlGuid": "8faace2d-a36e-425c-aa58-2ad99e3e0b7a",
            "automationAvailable": false,
            "category": "Monitoring and Alerting",
            "description": "Creating a metric to monitor latency probes over 20ms for periods longer than 30ms helps identify when firewall instance CPUs are stressed, potentially indicating issues.\n",
            "graph": "// under development\n\n",
            "guid": "8faace2d-a36e-425c-aa58-2ad99e3e0b7a",
            "learnMoreLink": [
                {
                    "name": "Azure Well-Architected Framework review - Azure Firewall",
                    "url": "https://learn.microsoft.com/azure/well-architected/service-guides/azure-firewall#recommendations"
                },
                {
                    "name": "Azure Firewall metrics overview",
                    "url": "https://learn.microsoft.com/azure/firewall/metrics"
                }
            ],
            "longDescription": "Creating a metric to monitor latency probes over 20ms for periods longer than 30ms helps identify when firewall instance CPUs are stressed, potentially indicating issues.\n",
            "pgVerified": false,
            "potentialBenefits": "Improved CPU stress detection",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Monitoring and Alerting",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/azureFirewalls",
            "recommendationTypeId": null,
            "service": "Firewall",
            "severity": "High",
            "source": "azure-resources/Network/azureFirewalls/recommendations.yaml",
            "tags": null,
            "text": "Monitor \"AZFW Latency Probe\" metric"
        },
        {
            "aprlGuid": "f6a14b32-a727-4ace-b5fa-7b1c6bdff402",
            "automationAvailable": false,
            "category": "Scalability",
            "description": "ExpressRoute gateways facilitate network traffic and route exchanges. FastPath enhances on-premises to virtual network data path performance by directing traffic straight to virtual machines, bypassing the gateway for improved resiliency through reduced gateway utilization.\n",
            "graph": "// under-development\n\n",
            "guid": "f6a14b32-a727-4ace-b5fa-7b1c6bdff402",
            "learnMoreLink": [
                {
                    "name": "About ExpressRoute FastPath",
                    "url": "https://learn.microsoft.com/en-us/azure/expressroute/about-fastpath"
                }
            ],
            "longDescription": "ExpressRoute gateways facilitate network traffic and route exchanges. FastPath enhances on-premises to virtual network data path performance by directing traffic straight to virtual machines, bypassing the gateway for improved resiliency through reduced gateway utilization.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhances speed and resiliency",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Scalability",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/connections",
            "recommendationTypeId": null,
            "service": "Microsoft.Network/connections",
            "severity": "Medium",
            "source": "azure-resources/Network/connections/recommendations.yaml",
            "tags": null,
            "text": "For better data path performance enable FastPath on ExpressRoute Direct and Gateway"
        },
        {
            "aprlGuid": "a5f3a4bd-4cf1-4196-a3cb-f5a0876198b2",
            "automationAvailable": false,
            "category": "High Availability",
            "description": "Configure an Azure Resource lock for Gateway Connection resources to prevent accidental deletion and maintain connectivity between on-premises networks and Azure workloads.\n",
            "graph": "// under-development\n\n",
            "guid": "a5f3a4bd-4cf1-4196-a3cb-f5a0876198b2",
            "learnMoreLink": [
                {
                    "name": "Protect your Azure resources with a lock - Azure Resource Manager | Microsoft Learn",
                    "url": "https://learn.microsoft.com/en-us/azure/azure-resource-manager/management/lock-resources?tabs=json"
                }
            ],
            "longDescription": "Configure an Azure Resource lock for Gateway Connection resources to prevent accidental deletion and maintain connectivity between on-premises networks and Azure workloads.\n",
            "pgVerified": true,
            "potentialBenefits": "Prevents accidental deletion of connections",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/connections",
            "recommendationTypeId": null,
            "service": "Microsoft.Network/connections",
            "severity": "High",
            "source": "azure-resources/Network/connections/recommendations.yaml",
            "tags": null,
            "text": "Configure an Azure Resource Lock on connections to prevent accidental deletion"
        },
        {
            "aprlGuid": "ae054bf2-aefa-cf4a-8282-741194cef8da",
            "automationAvailable": false,
            "category": "Security",
            "description": "Azure DDoS Plan metrics differentiate packets and bytes by tags: Dropped (packets scrubbed by DDoS), Forwarded (packets to VIP not filtered), and No tag (total packets, sum of dropped and forwarded).\n",
            "graph": "// under-development\n\n",
            "guid": "ae054bf2-aefa-cf4a-8282-741194cef8da",
            "learnMoreLink": [
                {
                    "name": "Monitoring Azure DDoS Protection",
                    "url": "https://learn.microsoft.com/en-us/azure/ddos-protection/monitor-ddos-protection-reference"
                }
            ],
            "longDescription": "Azure DDoS Plan metrics differentiate packets and bytes by tags: Dropped (packets scrubbed by DDoS), Forwarded (packets to VIP not filtered), and No tag (total packets, sum of dropped and forwarded).\n",
            "pgVerified": true,
            "potentialBenefits": "Enhanced security and traffic insight",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Security",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/ddosProtectionPlans",
            "recommendationTypeId": null,
            "service": "VNet",
            "severity": "Medium",
            "source": "azure-resources/Network/ddosProtectionPlans/recommendations.yaml",
            "tags": null,
            "text": "Monitor Azure DDoS Protection Plan metrics"
        },
        {
            "aprlGuid": "4d703025-dafc-f840-a183-5dc440456134",
            "automationAvailable": false,
            "category": "High Availability",
            "description": "Connecting each ExpressRoute Gateway to a minimum of two circuits in different peering locations enhances redundancy and reliability by ensuring alternate pathways for data in case one circuit fails.\n",
            "graph": "// under-development\n",
            "guid": "4d703025-dafc-f840-a183-5dc440456134",
            "learnMoreLink": [
                {
                    "name": "Designing for disaster recovery with ExpressRoute private peering",
                    "url": "https://learn.microsoft.com/azure/expressroute/designing-for-disaster-recovery-with-expressroute-privatepeering"
                }
            ],
            "longDescription": "Connecting each ExpressRoute Gateway to a minimum of two circuits in different peering locations enhances redundancy and reliability by ensuring alternate pathways for data in case one circuit fails.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhanced reliability and redundancy",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/expressRouteCircuits",
            "recommendationTypeId": null,
            "service": "ExpressRoute",
            "severity": "High",
            "source": "azure-resources/Network/expressRouteCircuits/recommendations.yaml",
            "tags": null,
            "text": "Connect on-prem networks to Azure critical workloads via multiple ExpressRoutes"
        },
        {
            "aprlGuid": "0e19cc41-8274-1342-b0db-0e4146eacef8",
            "automationAvailable": false,
            "category": "High Availability",
            "description": "Microsoft or the ExpressRoute provider always ensures physical redundancy in their services. It's essential to maintain this level of physical redundancy (two devices, two links) from the ExpressRoute peering location to your network for optimal performance and reliability.\n",
            "graph": "// cannot-be-validated-with-arg\n\n",
            "guid": "0e19cc41-8274-1342-b0db-0e4146eacef8",
            "learnMoreLink": [
                {
                    "name": "Designing for high availability with ExpressRoute",
                    "url": "https://learn.microsoft.com/en-us/azure/expressroute/designing-for-high-availability-with-expressroute"
                },
                {
                    "name": "Azure Well-Architected Framework review - Azure ExpressRoute - Design Checklist",
                    "url": "https://learn.microsoft.com/azure/well-architected/services/networking/azure-expressroute#recommendations"
                }
            ],
            "longDescription": "Microsoft or the ExpressRoute provider always ensures physical redundancy in their services. It's essential to maintain this level of physical redundancy (two devices, two links) from the ExpressRoute peering location to your network for optimal performance and reliability.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhanced reliability and fault tolerance",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/expressRouteCircuits",
            "recommendationTypeId": null,
            "service": "ExpressRoute",
            "severity": "High",
            "source": "azure-resources/Network/expressRouteCircuits/recommendations.yaml",
            "tags": null,
            "text": "Ensure ExpressRoute's physical links connect to distinct network edge devices"
        },
        {
            "aprlGuid": "f06a2bbe-5839-d447-9f39-fc3d20562d88",
            "automationAvailable": false,
            "category": "High Availability",
            "description": "Operating both connections of an ExpressRoute circuit in active-active mode enhances high availability as the Microsoft network will load balance the traffic across the connections on a per-flow basis.\n",
            "graph": "// cannot-be-validated-with-arg\n\n",
            "guid": "f06a2bbe-5839-d447-9f39-fc3d20562d88",
            "learnMoreLink": [
                {
                    "name": "Designing for high availability with ExpressRoute - Active-active connections",
                    "url": "https://learn.microsoft.com/azure/expressroute/designing-for-high-availability-with-expressroute#active-active-connections"
                }
            ],
            "longDescription": "Operating both connections of an ExpressRoute circuit in active-active mode enhances high availability as the Microsoft network will load balance the traffic across the connections on a per-flow basis.\n",
            "pgVerified": true,
            "potentialBenefits": "Improved high availability and load balancing",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/expressRouteCircuits",
            "recommendationTypeId": null,
            "service": "ExpressRoute",
            "severity": "High",
            "source": "azure-resources/Network/expressRouteCircuits/recommendations.yaml",
            "tags": null,
            "text": "Ensure both connections of an ExpressRoute circuit are configured in active-active mode"
        },
        {
            "aprlGuid": "2a5bf650-586d-db4c-a292-d922be7d3e0e",
            "automationAvailable": false,
            "category": "High Availability",
            "description": "Enabling BFD over ExpressRoute speeds up link failure detection between MSEE devices and routers configured for ExpressRoute (CE/PE), applicable over both customer and Partner Edge routing devices with managed Layer 3 service.\n",
            "graph": "// cannot-be-validated-with-arg\n\n",
            "guid": "2a5bf650-586d-db4c-a292-d922be7d3e0e",
            "learnMoreLink": [
                {
                    "name": "Configure BFD over ExpressRoute",
                    "url": "https://learn.microsoft.com/azure/expressroute/expressroute-bfd"
                }
            ],
            "longDescription": "Enabling BFD over ExpressRoute speeds up link failure detection between MSEE devices and routers configured for ExpressRoute (CE/PE), applicable over both customer and Partner Edge routing devices with managed Layer 3 service.\n",
            "pgVerified": true,
            "potentialBenefits": "Faster link failure detection",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/expressRouteCircuits",
            "recommendationTypeId": null,
            "service": "ExpressRoute",
            "severity": "High",
            "source": "azure-resources/Network/expressRouteCircuits/recommendations.yaml",
            "tags": null,
            "text": "Activate Bidirectional Forwarding Detection on edge devices for faster failover"
        },
        {
            "aprlGuid": "9771a435-d031-814e-9827-9b5fdafc0f87",
            "automationAvailable": false,
            "category": "Monitoring and Alerting",
            "description": "Use Network Insights for monitoring ExpressRoute circuit availability, QoS, and throughput. Set alerts based on Azure Monitor Baseline Alerts for availability, QoS metrics, and throughput metrics exceeding specific thresholds.\n",
            "graph": "// under-development\n\n",
            "guid": "9771a435-d031-814e-9827-9b5fdafc0f87",
            "learnMoreLink": [
                {
                    "name": "Azure Monitor Baseline Alerts - expressRouteCircuits",
                    "url": "https://azure.github.io/azure-monitor-baseline-alerts/services/Network/expressRouteCircuits/"
                }
            ],
            "longDescription": "Use Network Insights for monitoring ExpressRoute circuit availability, QoS, and throughput. Set alerts based on Azure Monitor Baseline Alerts for availability, QoS metrics, and throughput metrics exceeding specific thresholds.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhanced network performance and health",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Monitoring and Alerting",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/expressRouteCircuits",
            "recommendationTypeId": null,
            "service": "ExpressRoute",
            "severity": "High",
            "source": "azure-resources/Network/expressRouteCircuits/recommendations.yaml",
            "tags": null,
            "text": "Configure monitoring and alerting for ExpressRoute circuits"
        },
        {
            "aprlGuid": "26cb547f-aabc-dc40-be02-d0a9b6b04b1a",
            "automationAvailable": false,
            "category": "Monitoring and Alerting",
            "description": "ExpressRoute leverages service health for notifications on both planned and unplanned maintenance, ensuring users are informed about any changes to their ExpressRoute circuits.\n",
            "graph": "// under-development\n\n",
            "guid": "26cb547f-aabc-dc40-be02-d0a9b6b04b1a",
            "learnMoreLink": [
                {
                    "name": "How to view and configure alerts for Azure ExpressRoute circuit maintenance",
                    "url": "https://learn.microsoft.com/azure/expressroute/maintenance-alerts"
                }
            ],
            "longDescription": "ExpressRoute leverages service health for notifications on both planned and unplanned maintenance, ensuring users are informed about any changes to their ExpressRoute circuits.\n",
            "pgVerified": true,
            "potentialBenefits": "Stay informed on circuit updates",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Monitoring and Alerting",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/expressRouteCircuits",
            "recommendationTypeId": null,
            "service": "ExpressRoute",
            "severity": "High",
            "source": "azure-resources/Network/expressRouteCircuits/recommendations.yaml",
            "tags": null,
            "text": "Configure service health to receive ExpressRoute circuit maintenance notification"
        },
        {
            "aprlGuid": "f902cf86-2b53-2942-abc2-781f4fb62be6",
            "automationAvailable": false,
            "category": "Disaster Recovery",
            "description": "If you haven't added a second ExpressRoute circuit, use a site-to-site VPN as a temporary solution until the second circuit is available. This ensures network reliability and continuity of service.\n",
            "graph": "// under-development\n\n",
            "guid": "f902cf86-2b53-2942-abc2-781f4fb62be6",
            "learnMoreLink": [
                {
                    "name": "Using S2S VPN as a backup for ExpressRoute private peering",
                    "url": "https://learn.microsoft.com/azure/expressroute/use-s2s-vpn-as-backup-for-expressroute-privatepeering"
                }
            ],
            "longDescription": "If you haven't added a second ExpressRoute circuit, use a site-to-site VPN as a temporary solution until the second circuit is available. This ensures network reliability and continuity of service.\n",
            "pgVerified": true,
            "potentialBenefits": "Ensures continuity and reliability",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Disaster Recovery",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/expressRouteCircuits",
            "recommendationTypeId": null,
            "service": "ExpressRoute",
            "severity": "Medium",
            "source": "azure-resources/Network/expressRouteCircuits/recommendations.yaml",
            "tags": null,
            "text": "Use a site-to-site VPN as an interim backup solution for a single ExpressRoute circuit"
        },
        {
            "aprlGuid": "d40c769d-2f08-4980-8d8f-a386946276e6",
            "automationAvailable": "arg",
            "category": "Scalability",
            "description": "Rate limiting controls traffic volume between on-premises networks and Azure via ExpressRoute Direct, applying to private or Microsoft peering. It distributes port bandwidth, ensures stability, and prevents congestion, with steps outlined for enabling on circuits.\n",
            "graph": "// Azure Resource Graph Query\n// This query will return all the ExpressRoute circuits (Direct Based) that have Direct Port Rate Limiting disabled\nresources\n| where type =~ \"microsoft.network/expressroutecircuits\"\n| where properties.expressRoutePort != \"\" or isnotnull(properties.expressRoutePort)\n| where properties.enableDirectPortRateLimit == false\n| project recommendationId = \"d40c769d-2f08-4980-8d8f-a386946276e6\", name, id, tags, param1=strcat(\"enableDirectPortRateLimit: \",properties.enableDirectPortRateLimit)\n",
            "guid": "d40c769d-2f08-4980-8d8f-a386946276e6",
            "learnMoreLink": [
                {
                    "name": "Rate limiting for ExpressRoute Direct circuits (Preview)",
                    "url": "https://learn.microsoft.com/en-us/azure/expressroute/rate-limit"
                }
            ],
            "longDescription": "Rate limiting controls traffic volume between on-premises networks and Azure via ExpressRoute Direct, applying to private or Microsoft peering. It distributes port bandwidth, ensures stability, and prevents congestion, with steps outlined for enabling on circuits.\n",
            "pgVerified": true,
            "potentialBenefits": "Optimizes network, prevents congestion",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Scalability",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/expressRouteCircuits",
            "recommendationTypeId": null,
            "service": "ExpressRoute",
            "severity": "Medium",
            "source": "azure-resources/Network/expressRouteCircuits/recommendations.yaml",
            "tags": null,
            "text": "Implement rate-limiting across ExpressRoute Direct Circuits to optimize network flow"
        },
        {
            "aprlGuid": "60077378-7cb1-4b35-89bb-393884d9921d",
            "automationAvailable": "arg",
            "category": "High Availability",
            "description": "In Azure ExpressRoute Direct, the \"Admin State\" indicates the administrative status of layer 1 links, showing if a link is enabled or disabled, effectively turning the physical port on or off.\n",
            "graph": "// Azure Resource Graph Query\n// Find all Express Route Directs that do not have Admin State of both Links Enabled\nresources\n| where type == \"microsoft.network/expressrouteports\"\n| where properties['links'][0]['properties']['adminState'] == \"Disabled\" or properties['links'][1]['properties']['adminState'] == \"Disabled\"\n| project recommendationId = \"60077378-7cb1-4b35-89bb-393884d9921d\", name, id, tags, param1 = strcat(\"Link1AdminState: \", properties['links'][0]['properties']['adminState']), param2 = strcat(\"Link2AdminState: \", properties['links'][1]['properties']['adminState'])\n\n",
            "guid": "60077378-7cb1-4b35-89bb-393884d9921d",
            "learnMoreLink": [
                {
                    "name": "How to configure ExpressRoute Direct Change Admin State of links",
                    "url": "https://learn.microsoft.com/en-us/azure/expressroute/expressroute-howto-erdirect#state"
                }
            ],
            "longDescription": "In Azure ExpressRoute Direct, the \"Admin State\" indicates the administrative status of layer 1 links, showing if a link is enabled or disabled, effectively turning the physical port on or off.\n",
            "pgVerified": true,
            "potentialBenefits": "Ensures optimal connectivity.",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/ExpressRoutePorts",
            "recommendationTypeId": null,
            "service": "ExpressRoute",
            "severity": "High",
            "source": "azure-resources/Network/expressRoutePorts/recommendations.yaml",
            "tags": null,
            "text": "The Admin State of both Links of an ExpressRoute Direct should be in Enabled state"
        },
        {
            "aprlGuid": "0bee356b-7348-4799-8cab-0c71ffe13018",
            "automationAvailable": "arg",
            "category": "Scalability",
            "description": "Provisioning ExpressRoute circuits on a 10-Gbps or 100-Gbps ExpressRoute Direct resource up to 20-Gbps or 200-Gbps is possible but not recommended for resiliency. If an ExpressRoute Direct port fails, and circuits are using full capacity, the remaining port won't handle the extra load.\n",
            "graph": "// Azure Resource Graph Query\n// Find all Express Route Directs that are over subscribed\nresources\n| where type == \"microsoft.network/expressrouteports\"\n| where toint(properties['provisionedBandwidthInGbps']) > toint(properties['bandwidthInGbps'])\n| project recommendationId = \"0bee356b-7348-4799-8cab-0c71ffe13018\", name, id, tags, param1 = strcat(\"provisionedBandwidthInGbps: \", properties['provisionedBandwidthInGbps']), param2 = strcat(\"bandwidthInGbps: \", properties['bandwidthInGbps'])\n\n",
            "guid": "0bee356b-7348-4799-8cab-0c71ffe13018",
            "learnMoreLink": [
                {
                    "name": "About ExpressRoute Direct Circuit Sizes",
                    "url": "https://learn.microsoft.com/en-us/azure/expressroute/expressroute-erdirect-about?source=recommendations#circuit-sizes"
                }
            ],
            "longDescription": "Provisioning ExpressRoute circuits on a 10-Gbps or 100-Gbps ExpressRoute Direct resource up to 20-Gbps or 200-Gbps is possible but not recommended for resiliency. If an ExpressRoute Direct port fails, and circuits are using full capacity, the remaining port won't handle the extra load.\n",
            "pgVerified": true,
            "potentialBenefits": "Improves resilience during port failures",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Scalability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/ExpressRoutePorts",
            "recommendationTypeId": null,
            "service": "ExpressRoute",
            "severity": "High",
            "source": "azure-resources/Network/expressRoutePorts/recommendations.yaml",
            "tags": null,
            "text": "Ensure you do not over-subscribe an ExpressRoute Direct"
        },
        {
            "aprlGuid": "55815823-d588-4cb7-a5b8-ae581837356e",
            "automationAvailable": false,
            "category": "Monitoring and Alerting",
            "description": "Use Network Insights for monitoring ExpressRoute Port light levels, bits per second in/out, and line protocol. Set alerts based on Azure Monitor Baseline Alerts for light levels, bits per second in/out, and line protocol exceeding specific thresholds.\n",
            "graph": "// under-development\n",
            "guid": "55815823-d588-4cb7-a5b8-ae581837356e",
            "learnMoreLink": [
                {
                    "name": "Azure Monitor Baseline Alerts - expressRoutePorts",
                    "url": "https://azure.github.io/azure-monitor-baseline-alerts/services/Network/expressRoutePorts/"
                }
            ],
            "longDescription": "Use Network Insights for monitoring ExpressRoute Port light levels, bits per second in/out, and line protocol. Set alerts based on Azure Monitor Baseline Alerts for light levels, bits per second in/out, and line protocol exceeding specific thresholds.\n",
            "pgVerified": false,
            "potentialBenefits": "Enhanced network performance and health",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Monitoring and Alerting",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/expressRoutePorts",
            "recommendationTypeId": null,
            "service": "ExpressRoute",
            "severity": "High",
            "source": "azure-resources/Network/expressRoutePorts/recommendations.yaml",
            "tags": null,
            "text": "Configure monitoring and alerting for ExpressRoute Ports"
        },
        {
            "aprlGuid": "d0cfe47f-686b-5043-bf83-5a3868acb80a",
            "automationAvailable": false,
            "category": "Monitoring and Alerting",
            "description": "WAF may mistakenly block legitimate requests (false positives). These can be identified by examining the last 24 hours of blocked requests in Log Analytics.\n",
            "graph": "// cannot-be-validated-with-arg\n\n",
            "guid": "d0cfe47f-686b-5043-bf83-5a3868acb80a",
            "learnMoreLink": [
                {
                    "name": "Azure Web Application Firewall monitoring and logging - Access Log",
                    "url": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-monitor?pivots=front-door-standard-premium#access-logs"
                },
                {
                    "name": "Understanding WAF logs",
                    "url": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-tuning?pivots=front-door-standard-premium#understanding-waf-logs"
                },
                {
                    "name": "Web Application Firewall exclusion lists",
                    "url": "https://learn.microsoft.com/azure/web-application-firewall/ag/application-gateway-waf-configuration?tabs=portal"
                },
                {
                    "name": "Fixing a false positive",
                    "url": "https://learn.microsoft.com/azure/web-application-firewall/ag/web-application-firewall-troubleshoot#fixing-false-positives"
                }
            ],
            "longDescription": "WAF may mistakenly block legitimate requests (false positives). These can be identified by examining the last 24 hours of blocked requests in Log Analytics.\n",
            "pgVerified": true,
            "potentialBenefits": "Reduces false positives, improves access",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Monitoring and Alerting",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/frontdoorWebApplicationFirewallPolicies",
            "recommendationTypeId": null,
            "service": "WAF",
            "severity": "High",
            "source": "azure-resources/Network/frontDoorWebApplicationFirewallPolicies/recommendations.yaml",
            "tags": null,
            "text": "Inspect Azure Front Door WAF logs for wrongfully blocked legitimate requests"
        },
        {
            "aprlGuid": "537b4d94-edd1-4041-b13d-8217dfa485f0",
            "automationAvailable": false,
            "category": "Monitoring and Alerting",
            "description": "WAF may block legitimate requests as false positives. Identifying blocked requests within the last 24 hours through Log Analytics can help manage and mitigate these incorrect blockages efficiently.\n",
            "graph": "// cannot-be-validated-with-arg\n\n",
            "guid": "537b4d94-edd1-4041-b13d-8217dfa485f0",
            "learnMoreLink": [
                {
                    "name": "Azure Web Application Firewall Monitoring and Logging",
                    "url": "https://learn.microsoft.com/azure/web-application-firewall/ag/application-gateway-waf-metrics#logs-and-diagnostics"
                },
                {
                    "name": "Diagnostic logs",
                    "url": "https://learn.microsoft.com/azure/web-application-firewall/ag/web-application-firewall-logs#diagnostic-logs"
                }
            ],
            "longDescription": "WAF may block legitimate requests as false positives. Identifying blocked requests within the last 24 hours through Log Analytics can help manage and mitigate these incorrect blockages efficiently.\n",
            "pgVerified": true,
            "potentialBenefits": "Improve false positive identification",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Monitoring and Alerting",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/frontdoorWebApplicationFirewallPolicies",
            "recommendationTypeId": null,
            "service": "WAF",
            "severity": "High",
            "source": "azure-resources/Network/frontDoorWebApplicationFirewallPolicies/recommendations.yaml",
            "tags": null,
            "text": "Check Azure Application Gateway WAF logs for mistakenly blocked valid requests"
        },
        {
            "aprlGuid": "5357ae22-0f52-1a49-9fd4-1f00ace6add0",
            "automationAvailable": false,
            "category": "Monitoring and Alerting",
            "description": "Monitoring the health of your Web Application Firewall and the applications it protects is crucial. This can be achieved through integration with Microsoft Defender for Cloud, Azure Monitor, and Azure Monitor logs, ensuring optimal performance and security.\n",
            "graph": "// cannot-be-validated-with-arg\n\n",
            "guid": "5357ae22-0f52-1a49-9fd4-1f00ace6add0",
            "learnMoreLink": [
                {
                    "name": "WAF monitoring",
                    "url": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview#waf-monitoring"
                },
                {
                    "name": "Azure Monitor Workbook for WAF",
                    "url": "https://github.com/Azure/Azure-Network-Security/tree/master/Azure%20WAF/Workbook%20-%20WAF%20Monitor%20Workbook"
                }
            ],
            "longDescription": "Monitoring the health of your Web Application Firewall and the applications it protects is crucial. This can be achieved through integration with Microsoft Defender for Cloud, Azure Monitor, and Azure Monitor logs, ensuring optimal performance and security.\n",
            "pgVerified": false,
            "potentialBenefits": "Enhanced security and health insight",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Monitoring and Alerting",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/frontdoorWebApplicationFirewallPolicies",
            "recommendationTypeId": null,
            "service": "WAF",
            "severity": "High",
            "source": "azure-resources/Network/frontDoorWebApplicationFirewallPolicies/recommendations.yaml",
            "tags": null,
            "text": "Monitor Web Application Firewall"
        },
        {
            "aprlGuid": "38c3bca1-97a1-eb42-8cd3-838b243f35ba",
            "automationAvailable": "arg",
            "category": "High Availability",
            "description": "Selecting Standard SKU Load Balancer enhances reliability through availability zones and zone resiliency, ensuring deployments withstand zone and region failures. Unlike Basic, it supports global load balancing and offers an SLA.\n",
            "graph": "// Azure Resource Graph Query\n// Find all LoadBalancers using Basic SKU\nresources\n| where type =~ 'Microsoft.Network/loadBalancers'\n| where sku.name == 'Basic'\n| project recommendationId = \"38c3bca1-97a1-eb42-8cd3-838b243f35ba\", name, id, tags, Param1=strcat(\"sku-tier: basic\")\n\n",
            "guid": "38c3bca1-97a1-eb42-8cd3-838b243f35ba",
            "learnMoreLink": [
                {
                    "name": "Reliability and Azure Load Balancer",
                    "url": "https://learn.microsoft.com/azure/architecture/framework/services/networking/azure-load-balancer/reliability"
                },
                {
                    "name": "Resiliency checklist for specific Azure services- Azure Load Balancer",
                    "url": "https://learn.microsoft.com/azure/architecture/checklist/resiliency-per-service#azure-load-balancer"
                }
            ],
            "longDescription": "Selecting Standard SKU Load Balancer enhances reliability through availability zones and zone resiliency, ensuring deployments withstand zone and region failures. Unlike Basic, it supports global load balancing and offers an SLA.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhanced reliability and SLA support",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/loadBalancers",
            "recommendationTypeId": null,
            "service": "Load Balancer",
            "severity": "High",
            "source": "azure-resources/Network/loadBalancers/recommendations.yaml",
            "tags": null,
            "text": "Use Standard Load Balancer SKU"
        },
        {
            "aprlGuid": "6d82d042-6d61-ad49-86f0-6a5455398081",
            "automationAvailable": "arg",
            "category": "High Availability",
            "description": "Deploying Azure Load Balancers with at least two instances in the backend prevents a single point of failure and supports scalability. Pairing with Virtual Machine Scale Sets is advised for optimal scale building.\n",
            "graph": "// Azure Resource Graph Query\n// Find all LoadBalancers which only have 1 backend pool defined or only 1 VM in the backend pool\nresources\n| where type =~ 'Microsoft.Network/loadBalancers'\n| extend bep = properties.backendAddressPools\n| extend BackEndPools = array_length(bep)\n| where BackEndPools == 0\n| project recommendationId = \"6d82d042-6d61-ad49-86f0-6a5455398081\", name, id, Param1=\"backendPools\", Param2=toint(0), tags\n| union (resources\n  | where type =~ 'Microsoft.Network/loadBalancers'\n  | where sku.name == \"Standard\"\n  | extend bep = properties.backendAddressPools\n  | extend BackEndPools = toint(array_length(bep))\n  | mv-expand bip = properties.backendAddressPools\n  | extend BackendAddresses = array_length(bip.properties.loadBalancerBackendAddresses)\n  | where toint(BackendAddresses) <= 1\n  | project recommendationId = \"6d82d042-6d61-ad49-86f0-6a5455398081\", name, id, tags, Param1=\"backendAddresses\", Param2=toint(BackendAddresses))\n| union (\n  resources\n  | where type =~ 'Microsoft.Network/loadBalancers'\n  | where sku.name == \"Basic\"\n  | mv-expand properties.backendAddressPools\n  | extend backendPoolId = properties_backendAddressPools.id\n  | project id, name, tags, tostring(backendPoolId), recommendationId = \"6d82d042-6d61-ad49-86f0-6a5455398081\", Param1=\"BackEndPools\"\n  | join kind = leftouter (\n  resources\n  | where type =~ \"Microsoft.Network/networkInterfaces\"\n  | mv-expand properties.ipConfigurations\n  | mv-expand properties_ipConfigurations.properties.loadBalancerBackendAddressPools\n  | extend backendPoolId = tostring(properties_ipConfigurations_properties_loadBalancerBackendAddressPools.id)\n  | summarize poolMembers = count() by backendPoolId\n  | project tostring(backendPoolId), poolMembers ) on backendPoolId\n  | where toint(poolMembers) <= 1\n  | extend BackendAddresses = poolMembers\n  | project id, name, tags, recommendationId, Param1=\"backendAddresses\", Param2=toint(BackendAddresses))\n",
            "guid": "6d82d042-6d61-ad49-86f0-6a5455398081",
            "learnMoreLink": [
                {
                    "name": "Resiliency checklist for specific Azure services- Azure Load Balancer",
                    "url": "https://learn.microsoft.com/azure/architecture/checklist/resiliency-per-service#azure-load-balancer"
                }
            ],
            "longDescription": "Deploying Azure Load Balancers with at least two instances in the backend prevents a single point of failure and supports scalability. Pairing with Virtual Machine Scale Sets is advised for optimal scale building.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhances reliability and scalability",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/loadBalancers",
            "recommendationTypeId": null,
            "service": "Load Balancer",
            "severity": "High",
            "source": "azure-resources/Network/loadBalancers/recommendations.yaml",
            "tags": null,
            "text": "Ensure the Backend Pool contains at least two instances"
        },
        {
            "aprlGuid": "8d319a05-677b-944f-b9b4-ca0fb42e883c",
            "automationAvailable": "arg",
            "category": "High Availability",
            "description": "Outbound rules for Standard Public Load Balancer involve manual port allocation for backend pools, limiting scalability and risk of SNAT port exhaustion. NAT Gateway is recommended for its dynamic scaling and secure internet connectivity.\n",
            "graph": "// Azure Resource Graph Query\n// Find all LoadBalancers with Outbound rules configured\nresources\n| where type =~ 'Microsoft.Network/loadBalancers'\n| extend outboundRules = array_length(properties.outboundRules)\n| where outboundRules > 0\n| project recommendationId = \"8d319a05-677b-944f-b9b4-ca0fb42e883c\", name, id, tags, Param1 = \"outboundRules: >=1\"\n\n",
            "guid": "8d319a05-677b-944f-b9b4-ca0fb42e883c",
            "learnMoreLink": [
                {
                    "name": "Resiliency checklist for specific Azure services- Azure Load Balancer",
                    "url": "https://learn.microsoft.com/azure/architecture/checklist/resiliency-per-service#azure-load-balancer"
                }
            ],
            "longDescription": "Outbound rules for Standard Public Load Balancer involve manual port allocation for backend pools, limiting scalability and risk of SNAT port exhaustion. NAT Gateway is recommended for its dynamic scaling and secure internet connectivity.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhanced scalability and reliability",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/loadBalancers",
            "recommendationTypeId": null,
            "service": "Load Balancer",
            "severity": "Medium",
            "source": "azure-resources/Network/loadBalancers/recommendations.yaml",
            "tags": null,
            "text": "Use NAT Gateway instead of Outbound Rules for Production Workloads"
        },
        {
            "aprlGuid": "621dbc78-3745-4d32-8eac-9e65b27b7512",
            "automationAvailable": "arg",
            "category": "High Availability",
            "description": "In regions with Availability Zones, assigning a zone-redundant frontend IP to a Standard Load Balancer ensures continuous traffic distribution even if one availability zone fails, provided other healthy zones and backend instances are available to receive the traffic.\n",
            "graph": "// Azure Resource Graph Query\n// Find all LoadBalancers with with regional or zonal public IP Addresses\nresources\n| where type == \"microsoft.network/loadbalancers\"\n| where tolower(sku.name) != 'basic'\n| mv-expand feIPconfigs = properties.frontendIPConfigurations\n| extend\n    feConfigName = (feIPconfigs.name),\n    PrivateSubnetId = toupper(feIPconfigs.properties.subnet.id),\n    PrivateIPZones = feIPconfigs.zones,\n    PIPid = toupper(feIPconfigs.properties.publicIPAddress.id),\n    JoinID = toupper(id)\n| where isnotempty(PrivateSubnetId)\n| where isnull(PrivateIPZones) or array_length(PrivateIPZones) < 2\n| project name, feConfigName, id\n| union (resources\n    | where type == \"microsoft.network/loadbalancers\"\n    | where tolower(sku.name) != 'basic'\n    | mv-expand feIPconfigs = properties.frontendIPConfigurations\n    | extend\n        feConfigName = (feIPconfigs.name),\n        PIPid = toupper(feIPconfigs.properties.publicIPAddress.id),\n        JoinID = toupper(id)\n    | where isnotempty(PIPid)\n    | join kind=innerunique (\n        resources\n        | where type == \"microsoft.network/publicipaddresses\"\n        | where isnull(zones) or array_length(zones) < 2\n        | extend\n            LBid = toupper(substring(properties.ipConfiguration.id, 0, indexof(properties.ipConfiguration.id, '/frontendIPConfigurations'))),\n            InnerID = toupper(id)\n    ) on $left.PIPid == $right.InnerID)\n| project recommendationId = \"621dbc78-3745-4d32-8eac-9e65b27b7512\", name, id, tags, param1=\"Zones: No Zone or Zonal\", param2=strcat(\"Frontend IP Configuration:\", \" \", feConfigName)\n\n",
            "guid": "621dbc78-3745-4d32-8eac-9e65b27b7512",
            "learnMoreLink": [
                {
                    "name": "Load Balancer and Availability Zones",
                    "url": "https://learn.microsoft.com/en-us/azure/load-balancer/load-balancer-standard-availability-zones#zone-redundant"
                }
            ],
            "longDescription": "In regions with Availability Zones, assigning a zone-redundant frontend IP to a Standard Load Balancer ensures continuous traffic distribution even if one availability zone fails, provided other healthy zones and backend instances are available to receive the traffic.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhances uptime and resilience",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/loadBalancers",
            "recommendationTypeId": null,
            "service": "Load Balancer",
            "severity": "High",
            "source": "azure-resources/Network/loadBalancers/recommendations.yaml",
            "tags": null,
            "text": "Ensure Standard Load Balancer is zone-redundant"
        },
        {
            "aprlGuid": "e5f5fcea-f925-4578-8599-9a391e888a60",
            "automationAvailable": "arg",
            "category": "Monitoring and Alerting",
            "description": "Health probes are used by Azure Load Balancers to determine the status of backend endpoints. Using custom health probes that are aligned with vendor recommendations enhances understanding of backend availability and facilitates monitoring of backend services for any impact.\n",
            "graph": "// Azure Resource Graph Query\n// List the load balancers which don't have health probe configured\nresources\n| where type =~ \"microsoft.network/loadbalancers\"\n| where array_length(properties.probes) == 0\n| project recommendationId=\"e5f5fcea-f925-4578-8599-9a391e888a60\", name, id, tags, param1=\"customHealthProbeUsed: false\"\n",
            "guid": "e5f5fcea-f925-4578-8599-9a391e888a60",
            "learnMoreLink": [
                {
                    "name": "Load Balancer Health Probe Overview",
                    "url": "https://learn.microsoft.com/en-us/azure/load-balancer/load-balancer-custom-probe-overview"
                }
            ],
            "longDescription": "Health probes are used by Azure Load Balancers to determine the status of backend endpoints. Using custom health probes that are aligned with vendor recommendations enhances understanding of backend availability and facilitates monitoring of backend services for any impact.\n",
            "pgVerified": true,
            "potentialBenefits": "Ensures backend uptime monitoring.",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Monitoring and Alerting",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/loadBalancers",
            "recommendationTypeId": null,
            "service": "Load Balancer",
            "severity": "High",
            "source": "azure-resources/Network/loadBalancers/recommendations.yaml",
            "tags": null,
            "text": "Use Health Probes to detect backend instances availability"
        },
        {
            "aprlGuid": "4281631c-3d19-4994-8d96-084c2a51a534",
            "automationAvailable": false,
            "category": "Scalability",
            "description": "NAT Gateway provides 64,512 SNAT ports per public IP address and supports up to 16 public IP addresses. Monitor \"Total SNAT connection count\" metric to determine if you're nearing the connection limit of NAT gateway. You can scale the NAT gateway by adding more public IP addresses.\n",
            "graph": "// under-development\n\n",
            "guid": "4281631c-3d19-4994-8d96-084c2a51a534",
            "learnMoreLink": [
                {
                    "name": "Scale a NAT gateway to meet the demand of a dynamic workload",
                    "url": "https://learn.microsoft.com/en-us/azure/nat-gateway/nat-gateway-design#scale-a-nat-gateway-to-meet-the-demand-of-a-dynamic-workload"
                },
                {
                    "name": "Total SNAT Connection Count",
                    "url": "https://learn.microsoft.com/en-us/azure/nat-gateway/nat-metrics#total-snat-connection-count"
                }
            ],
            "longDescription": "NAT Gateway provides 64,512 SNAT ports per public IP address and supports up to 16 public IP addresses. Monitor \"Total SNAT connection count\" metric to determine if you're nearing the connection limit of NAT gateway. You can scale the NAT gateway by adding more public IP addresses.\n",
            "pgVerified": false,
            "potentialBenefits": "Enhances reliability and scalability",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Scalability",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/natGateways",
            "recommendationTypeId": null,
            "service": "VNet",
            "severity": "Medium",
            "source": "azure-resources/Network/natGateways/recommendations.yaml",
            "tags": null,
            "text": "Scale a NAT gateway to meet the demand of a dynamic workload"
        },
        {
            "aprlGuid": "babf75d6-6407-4d90-b01e-5a1768e621f5",
            "automationAvailable": false,
            "category": "Monitoring and Alerting",
            "description": "Use Network Insights for monitoring and alerting on your NAT gateway.Use Total SNAT connection count metric to determine if you're nearing the connection limit of NAT gateway. Set alerts based on Azure Monitor Baseline Alerts (AMBA) thresholds for NAT Gateway\n",
            "graph": "// under-development\n\n",
            "guid": "babf75d6-6407-4d90-b01e-5a1768e621f5",
            "learnMoreLink": [
                {
                    "name": "What is Azure NAT Gateway metrics and alerts?",
                    "url": "https://learn.microsoft.com/en-us/azure/nat-gateway/nat-metrics"
                },
                {
                    "name": "AMBA - NAT Gateway",
                    "url": "https://azure.github.io/azure-monitor-baseline-alerts/services/Network/natGateways/"
                }
            ],
            "longDescription": "Use Network Insights for monitoring and alerting on your NAT gateway.Use Total SNAT connection count metric to determine if you're nearing the connection limit of NAT gateway. Set alerts based on Azure Monitor Baseline Alerts (AMBA) thresholds for NAT Gateway\n",
            "pgVerified": false,
            "potentialBenefits": "Enhanced network performance and health",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Monitoring and Alerting",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/natGateways",
            "recommendationTypeId": null,
            "service": "VNet",
            "severity": "High",
            "source": "azure-resources/Network/natGateways/recommendations.yaml",
            "tags": null,
            "text": "Configure monitoring and alerting for NAT gateway"
        },
        {
            "aprlGuid": "419df1ea-336b-460a-b6b2-fefe2588fcef",
            "automationAvailable": false,
            "category": "High Availability",
            "description": "A zonal promise for zone isolation scenarios exists when a virtual machine instance using a NAT gateway resource is in the same zone as the NAT gateway resource and its public IP addresses. The pattern you want to use for zone isolation is creating a \"zonal stack\" per availability zone.\n",
            "graph": "// under-development\n\n",
            "guid": "419df1ea-336b-460a-b6b2-fefe2588fcef",
            "learnMoreLink": [
                {
                    "name": "Zonal NAT gateway resource for each zone in a region to create zone-resiliency",
                    "url": "https://learn.microsoft.com/en-us/azure/nat-gateway/nat-availability-zones#zonal-nat-gateway-resource-for-each-zone-in-a-region-to-create-zone-resiliency"
                }
            ],
            "longDescription": "A zonal promise for zone isolation scenarios exists when a virtual machine instance using a NAT gateway resource is in the same zone as the NAT gateway resource and its public IP addresses. The pattern you want to use for zone isolation is creating a \"zonal stack\" per availability zone.\n",
            "pgVerified": false,
            "potentialBenefits": "Enhances reliability and scalability",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/natGateways",
            "recommendationTypeId": null,
            "service": "VNet",
            "severity": "Medium",
            "source": "azure-resources/Network/natGateways/recommendations.yaml",
            "tags": null,
            "text": "Consider zonal NAT gateway deployment for zone isolation scenarios"
        },
        {
            "aprlGuid": "d2976d3e-294b-4b49-a1f0-c42566a3758f",
            "automationAvailable": false,
            "category": "Monitoring and Alerting",
            "description": "Resource Logs are not collected and stored until you create a diagnostic setting and route them to one or more locations.\n",
            "graph": "// under-development\n\n",
            "guid": "d2976d3e-294b-4b49-a1f0-c42566a3758f",
            "learnMoreLink": [
                {
                    "name": "Diagnostic settings in Azure Monitor",
                    "url": "https://learn.microsoft.com/azure/azure-monitor/essentials/diagnostic-settings"
                }
            ],
            "longDescription": "Resource Logs are not collected and stored until you create a diagnostic setting and route them to one or more locations.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhanced monitoring and security insights",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Monitoring and Alerting",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/networkSecurityGroups",
            "recommendationTypeId": null,
            "service": "NSG",
            "severity": "Medium",
            "source": "azure-resources/Network/networkSecurityGroups/recommendations.yaml",
            "tags": null,
            "text": "Configure Diagnostic Settings for all network security groups"
        },
        {
            "aprlGuid": "8bb4a57b-55e4-d24e-9c19-2679d8bc779f",
            "automationAvailable": "arg",
            "category": "Monitoring and Alerting",
            "description": "Create Alerts with Azure Monitor for operations like creating or updating Network Security Group rules to catch unauthorized/undesired changes to resources and spot attempts to bypass firewalls or access resources from the outside.\n",
            "graph": "// Azure Resource Graph Query\n// Find all Network Security Groups without alerts for modification configured.\nresources\n| where type =~ \"Microsoft.Network/networkSecurityGroups\"\n| project name, id, tags, lowerCaseNsgId = tolower(id)\n| join kind = leftouter (\n    resources\n    | where type =~ \"Microsoft.Insights/activityLogAlerts\" and properties.enabled == true\n    | mv-expand scope = properties.scopes\n    | where scope has \"Microsoft.Network/networkSecurityGroups\"\n    | project alertName = name, conditionJson = dynamic_to_json(properties.condition.allOf), scope\n    | where conditionJson has '\"Administrative\"' and (\n        // Create or Update Network Security Group\n        (conditionJson has '\"Microsoft.Network/networkSecurityGroups/write\"') or\n        // All administrative operations\n        (conditionJson !has '\"Microsoft.Network/networkSecurityGroups/write\"' and conditionJson !has '\"Microsoft.Network/networkSecurityGroups/delete\"' and conditionJson !has '\"Microsoft.Network/networkSecurityGroups/join/action\"')\n        )\n    | project lowerCaseNsgIdOfScope = tolower(scope)\n    )\n    on $left.lowerCaseNsgId == $right.lowerCaseNsgIdOfScope\n| where isempty(lowerCaseNsgIdOfScope)\n| project recommendationId = \"8bb4a57b-55e4-d24e-9c19-2679d8bc779f\", name, id, tags, param1 = \"ModificationAlert: Not configured/Disabled\"\n\n",
            "guid": "8bb4a57b-55e4-d24e-9c19-2679d8bc779f",
            "learnMoreLink": [
                {
                    "name": "Azure Monitor activity log",
                    "url": "https://learn.microsoft.com/azure/azure-monitor/essentials/activity-log?tabs=powershell"
                }
            ],
            "longDescription": "Create Alerts with Azure Monitor for operations like creating or updating Network Security Group rules to catch unauthorized/undesired changes to resources and spot attempts to bypass firewalls or access resources from the outside.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhanced security and change monitoring",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Monitoring and Alerting",
            "recommendationImpact": "Low",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/networkSecurityGroups",
            "recommendationTypeId": null,
            "service": "NSG",
            "severity": "Low",
            "source": "azure-resources/Network/networkSecurityGroups/recommendations.yaml",
            "tags": null,
            "text": "Monitor changes in Network Security Groups with Azure Monitor"
        },
        {
            "aprlGuid": "52ac35e8-9c3e-f84d-8ce8-2fab955333d3",
            "automationAvailable": false,
            "category": "Governance",
            "description": "As an administrator, you can lock an Azure subscription, resource group, or resource to protect them from accidental deletions and modifications. The lock overrides user permissions. Locks can prevent either deletions or modifications and are known as Delete and Read-only in the portal.\n",
            "graph": "// under-development\n\n",
            "guid": "52ac35e8-9c3e-f84d-8ce8-2fab955333d3",
            "learnMoreLink": [
                {
                    "name": "Lock your resources to protect your infrastructure",
                    "url": "https://learn.microsoft.com/azure/azure-resource-manager/management/lock-resources?toc=%2Fazure%2Fvirtual-network%2Ftoc.json&tabs=json"
                }
            ],
            "longDescription": "As an administrator, you can lock an Azure subscription, resource group, or resource to protect them from accidental deletions and modifications. The lock overrides user permissions. Locks can prevent either deletions or modifications and are known as Delete and Read-only in the portal.\n",
            "pgVerified": true,
            "potentialBenefits": "Prevents accidental edits/deletions",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Governance",
            "recommendationImpact": "Low",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/networkSecurityGroups",
            "recommendationTypeId": null,
            "service": "NSG",
            "severity": "Low",
            "source": "azure-resources/Network/networkSecurityGroups/recommendations.yaml",
            "tags": null,
            "text": "Configure locks for Network Security Groups to avoid accidental changes and/or deletion"
        },
        {
            "aprlGuid": "da1a3c06-d1d5-a940-9a99-fcc05966fe7c",
            "automationAvailable": "arg",
            "category": "Monitoring and Alerting",
            "description": "Monitoring, managing, and understanding your network is crucial for protection and optimization. Knowing the current state, who and from where connections are made, open internet ports, expected and irregular behavior, and traffic spikes is essential.\n",
            "graph": "// Azure Resource Graph Query\n// Find all Network Security Groups without NSG Flow logs configured or disabled.\nresources\n| where type =~ \"Microsoft.Network/networkSecurityGroups\"\n| project name, id, tags, lowerCaseNsgId = tolower(id)\n| join kind = leftouter (\n    resources\n    | where type == \"microsoft.network/networkwatchers/flowlogs\" and properties.enabled == true\n    | project flowLogName = name, lowerCaseTargetNsgId = tolower(properties.targetResourceId)\n    )\n    on $left.lowerCaseNsgId == $right.lowerCaseTargetNsgId\n| where isempty(lowerCaseTargetNsgId)\n| project recommendationId = \"da1a3c06-d1d5-a940-9a99-fcc05966fe7c\", name, id, tags, param1 = \"NSGFlowLog: Not configured/Disabled\"\n\n",
            "guid": "da1a3c06-d1d5-a940-9a99-fcc05966fe7c",
            "learnMoreLink": [
                {
                    "name": "Flow logging for network security groups",
                    "url": "https://learn.microsoft.com/azure/network-watcher/network-watcher-nsg-flow-logging-overview"
                }
            ],
            "longDescription": "Monitoring, managing, and understanding your network is crucial for protection and optimization. Knowing the current state, who and from where connections are made, open internet ports, expected and irregular behavior, and traffic spikes is essential.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhances security and optimizes network",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Monitoring and Alerting",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/networkSecurityGroups",
            "recommendationTypeId": null,
            "service": "NSG",
            "severity": "Medium",
            "source": "azure-resources/Network/networkSecurityGroups/recommendations.yaml",
            "tags": null,
            "text": "Configure NSG Flow Logs"
        },
        {
            "aprlGuid": "8291c1fa-650c-b44b-b008-4deb7465919d",
            "automationAvailable": "arg",
            "category": "Security",
            "description": "Azure network security groups filter network traffic between resources in a virtual network, using security rules to allow or deny inbound or outbound traffic based on source, destination, port, and protocol.\n",
            "graph": "// Azure Resource Graph Query\n// This query will return all NSGs that have NO security rules\nresources\n| where type =~ \"microsoft.network/networksecuritygroups\"\n| extend sr = string_size(properties.securityRules)\n| where sr <=2 or isnull(properties.securityRules)\n| project recommendationId = \"8291c1fa-650c-b44b-b008-4deb7465919d\", name, id\n\n",
            "guid": "8291c1fa-650c-b44b-b008-4deb7465919d",
            "learnMoreLink": [
                {
                    "name": "Security rules",
                    "url": "https://learn.microsoft.com/azure/virtual-network/network-security-groups-overview#security-rules"
                }
            ],
            "longDescription": "Azure network security groups filter network traffic between resources in a virtual network, using security rules to allow or deny inbound or outbound traffic based on source, destination, port, and protocol.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhanced traffic control and security",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Security",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/networkSecurityGroups",
            "recommendationTypeId": null,
            "service": "NSG",
            "severity": "Medium",
            "source": "azure-resources/Network/networkSecurityGroups/recommendations.yaml",
            "tags": null,
            "text": "The NSG only has Default Security Rules, make sure to configure the necessary rules"
        },
        {
            "aprlGuid": "4e133bd0-8762-bc40-a95b-b29142427d73",
            "automationAvailable": "arg",
            "category": "Monitoring and Alerting",
            "description": "Azure Network Watcher offers tools for monitoring, diagnosing, viewing metrics, and managing logs for IaaS resources. It helps maintain the health of VMs, VNets, application gateways, load balancers, but not for PaaS or Web analytics.\n",
            "graph": "// Azure Resource Graph Query\n// This query will return all locations that do not have a Network Watcher deployed\nresources\n| where location != \"global\"\n| union (Resources\n    | where type =~ \"microsoft.network/networkwatchers\")\n| summarize NetworkWatcherCount = countif(type =~ 'Microsoft.Network/networkWatchers') by location\n| where NetworkWatcherCount == 0\n| project recommendationId = \"4e133bd0-8762-bc40-a95b-b29142427d73\", name=location, id=\"n/a\", param1 = strcat(\"LocationMisingNetworkWatcher:\", location)\n\n",
            "guid": "4e133bd0-8762-bc40-a95b-b29142427d73",
            "learnMoreLink": [
                {
                    "name": "What is Azure Network Watcher?",
                    "url": "https://learn.microsoft.com/azure/network-watcher/network-watcher-overview"
                }
            ],
            "longDescription": "Azure Network Watcher offers tools for monitoring, diagnosing, viewing metrics, and managing logs for IaaS resources. It helps maintain the health of VMs, VNets, application gateways, load balancers, but not for PaaS or Web analytics.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhanced monitoring and diagnostics for Azure IaaS",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Monitoring and Alerting",
            "recommendationImpact": "Low",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/networkWatchers",
            "recommendationTypeId": null,
            "service": "Network Watcher",
            "severity": "Low",
            "source": "azure-resources/Network/networkWatchers/recommendations.yaml",
            "tags": null,
            "text": "Deploy Network Watcher in all regions where you have networking services"
        },
        {
            "aprlGuid": "22a769ed-0ecb-8b49-bafe-8f52e6373d9c",
            "automationAvailable": "arg",
            "category": "Monitoring and Alerting",
            "description": "Network security group flow logging is a feature of Azure Network Watcher that logs IP traffic info through a network security group. If in Failed state, monitoring data from the associated resource is not collected.\n",
            "graph": "// Azure Resource Graph Query\n// This query will return all Network Watcher Flow Logs that are not enabled or in a succeeded state\nresources\n| where type =~ \"microsoft.network/networkwatchers/flowlogs\" and isnotnull(properties)\n| extend targetResourceId = tostring(properties.targetResourceId)\n| extend status = iff(properties.enabled =~ 'true', \"Enabled\", \"Disabled\")\n| extend provisioningState = tostring(properties.provisioningState)\n| extend flowLogType = iff(properties.targetResourceId contains \"Microsoft.Network/virtualNetworks\", 'Virtual network', 'Network security group')\n| where provisioningState != \"Succeeded\" or status != \"Enabled\"\n| project recommendationId = \"22a769ed-0ecb-8b49-bafe-8f52e6373d9c\", name, id, tags, param1 = strcat(\"provisioningState:\", provisioningState), param2=strcat(\"Status:\", status), param3=strcat(\"targetResourceId:\",targetResourceId), param4=strcat(\"flowLogType:\",flowLogType)\n\n",
            "guid": "22a769ed-0ecb-8b49-bafe-8f52e6373d9c",
            "learnMoreLink": [
                {
                    "name": "Manage NSG flow logs using the Azure portal",
                    "url": "https://learn.microsoft.com/azure/network-watcher/nsg-flow-logging"
                }
            ],
            "longDescription": "Network security group flow logging is a feature of Azure Network Watcher that logs IP traffic info through a network security group. If in Failed state, monitoring data from the associated resource is not collected.\n",
            "pgVerified": true,
            "potentialBenefits": "Ensures IP traffic logging",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Monitoring and Alerting",
            "recommendationImpact": "Low",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/networkWatchers",
            "recommendationTypeId": null,
            "service": "Network Watcher",
            "severity": "Low",
            "source": "azure-resources/Network/networkWatchers/recommendations.yaml",
            "tags": null,
            "text": "Fix Flow Log configurations in Failed state or Disabled Status"
        },
        {
            "aprlGuid": "2820f6d6-a23c-7a40-aec5-506f3bd1aeb6",
            "automationAvailable": false,
            "category": "Security",
            "description": "Private DNS zones and records are critical and their deletion can cause service outages. To protect against unauthorized or accidental changes, the Private DNS Zone Contributor role, a built-in role for managing these resources, should be assigned to specific users or groups.\n",
            "graph": "// under-development\n\n",
            "guid": "2820f6d6-a23c-7a40-aec5-506f3bd1aeb6",
            "learnMoreLink": [
                {
                    "name": "Protecting private DNS Zones and Records - Azure DNS",
                    "url": "https://learn.microsoft.com/en-us/azure/dns/dns-protect-private-zones-recordsets"
                }
            ],
            "longDescription": "Private DNS zones and records are critical and their deletion can cause service outages. To protect against unauthorized or accidental changes, the Private DNS Zone Contributor role, a built-in role for managing these resources, should be assigned to specific users or groups.\n",
            "pgVerified": true,
            "potentialBenefits": "Prevents DNS outages",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Security",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/privateDnsZones",
            "recommendationTypeId": null,
            "service": "DNS",
            "severity": "Medium",
            "source": "azure-resources/Network/privateDnsZones/recommendations.yaml",
            "tags": null,
            "text": "Protect private DNS zones and records"
        },
        {
            "aprlGuid": "ab896e8c-49b9-2c44-adec-98339aff7821",
            "automationAvailable": false,
            "category": "Monitoring and Alerting",
            "description": "The records in a private DNS zone are only resolvable from linked virtual networks. You can link a private DNS zone to multiple networks and enable autoregistration to manage DNS records for virtual machines automatically.\n",
            "graph": "// under-development\n\n",
            "guid": "ab896e8c-49b9-2c44-adec-98339aff7821",
            "learnMoreLink": [
                {
                    "name": "Supported metrics for Microsoft.Network/privateDnsZones",
                    "url": "https://learn.microsoft.com/en-us/azure/azure-monitor/reference/supported-metrics/microsoft-network-privatednszones-metrics"
                }
            ],
            "longDescription": "The records in a private DNS zone are only resolvable from linked virtual networks. You can link a private DNS zone to multiple networks and enable autoregistration to manage DNS records for virtual machines automatically.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhanced DNS reliability and alerting",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Monitoring and Alerting",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/privateDnsZones",
            "recommendationTypeId": null,
            "service": "DNS",
            "severity": "High",
            "source": "azure-resources/Network/privateDnsZones/recommendations.yaml",
            "tags": null,
            "text": "Monitor Private DNS Zones health and set up alerts"
        },
        {
            "aprlGuid": "1e02335c-1f90-fd4e-a5a5-d359c7b22d70",
            "automationAvailable": false,
            "category": "Governance",
            "description": "Azure Private DNS offers a reliable, secure way to handle domain names within virtual networks, using custom domains instead of default Azure names. Records in these zones aren't internet-accessible, only resolvable within linked virtual networks.\n",
            "graph": "// under-development\n\n",
            "guid": "1e02335c-1f90-fd4e-a5a5-d359c7b22d70",
            "learnMoreLink": [
                {
                    "name": "Scenarios for Azure Private DNS zones",
                    "url": "https://learn.microsoft.com/en-us/azure/dns/private-dns-scenarios"
                }
            ],
            "longDescription": "Azure Private DNS offers a reliable, secure way to handle domain names within virtual networks, using custom domains instead of default Azure names. Records in these zones aren't internet-accessible, only resolvable within linked virtual networks.\n",
            "pgVerified": true,
            "potentialBenefits": "Ensures seamless failover for DNS",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Governance",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/privateDnsZones",
            "recommendationTypeId": null,
            "service": "DNS",
            "severity": "Medium",
            "source": "azure-resources/Network/privateDnsZones/recommendations.yaml",
            "tags": null,
            "text": "Align Production and DR zones with identical workload and resource failover entries"
        },
        {
            "aprlGuid": "b89c9acc-0aba-fb44-9ff2-3dbfcf97dce7",
            "automationAvailable": "arg",
            "category": "High Availability",
            "description": "A private endpoint has two custom properties, static IP address and the network interface name, which must be set at creation. If not in Succeeded state, there may be issues with the endpoint or associated resource.\n",
            "graph": "// Azure Resource Graph Query\n// This query will return all Private Endpoints that are not in a Succeeded state\nresources\n| where type =~ \"microsoft.network/privateendpoints\"\n| where (properties.provisioningState =~ \"Succeeded\" and (properties.privateLinkServiceConnections[0].properties.provisioningState =~ \"Succeeded\" or properties.manualPrivateLinkServiceConnections[0].properties.provisioningState =~ \"Succeeded\")) == false\n| project recommendationId = \"b89c9acc-0aba-fb44-9ff2-3dbfcf97dce7\", name, id, tags, param1 = strcat(\"provisioningState: \", tostring(properties.provisioningState)), param2 = strcat(\"provisioningState: \", tostring(properties.privateLinkServiceConnections[0].properties.provisioningState)), param3 = strcat(\"manualProvisioningState: \", tostring(properties.manualPrivateLinkServiceConnections[0].properties.provisioningState))\n",
            "guid": "b89c9acc-0aba-fb44-9ff2-3dbfcf97dce7",
            "learnMoreLink": [
                {
                    "name": "Private endpoint connections",
                    "url": "https://learn.microsoft.com/azure/private-link/manage-private-endpoint?tabs=manage-private-link-powershell#private-endpoint-connections"
                }
            ],
            "longDescription": "A private endpoint has two custom properties, static IP address and the network interface name, which must be set at creation. If not in Succeeded state, there may be issues with the endpoint or associated resource.\n",
            "pgVerified": true,
            "potentialBenefits": "Ensure connection availability",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/privateEndpoints",
            "recommendationTypeId": null,
            "service": "PrivateLink",
            "severity": "Medium",
            "source": "azure-resources/Network/privateEndpoints/recommendations.yaml",
            "tags": null,
            "text": "Resolve issues with Private Endpoints in non Succeeded connection state"
        },
        {
            "aprlGuid": "c63b81fb-7afc-894c-a840-91bb8a8dcfaf",
            "automationAvailable": "arg",
            "category": "High Availability",
            "description": "Public IP addresses in Azure can be of standard SKU, available as non-zonal, zonal, or zone-redundant. Zone-redundant IPs are accessible across all zones, resisting any single zone failure, thereby providing higher resilience.\n",
            "graph": "// Azure Resource Graph query\n// List public IP addresses that are not Zone-Redundant\nResources\n| where type =~ \"Microsoft.Network/publicIPAddresses\" and sku.tier =~ \"Regional\"\n| where isempty(zones) or array_length(zones) <= 1\n| extend az = case(isempty(zones), \"Non-zonal\", array_length(zones) <= 1, strcat(\"Zonal (\", strcat_array(zones, \",\"), \")\"), zones)\n| project recommendationId = \"c63b81fb-7afc-894c-a840-91bb8a8dcfaf\", name, id, tags, param1 = strcat(\"sku: \", sku.name), param2 = strcat(\"availabilityZone: \", az)\n\n",
            "guid": "c63b81fb-7afc-894c-a840-91bb8a8dcfaf",
            "learnMoreLink": [
                {
                    "name": "Public IP addresses - Availability Zones",
                    "url": "https://learn.microsoft.com/azure/virtual-network/ip-services/public-ip-addresses#availability-zone"
                },
                {
                    "name": "Upgrading a basic public IP address to Standard SKU",
                    "url": "https://learn.microsoft.com/en-us/azure/virtual-network/ip-services/public-ip-basic-upgrade-guidance#steps-to-complete-the-upgrade"
                }
            ],
            "longDescription": "Public IP addresses in Azure can be of standard SKU, available as non-zonal, zonal, or zone-redundant. Zone-redundant IPs are accessible across all zones, resisting any single zone failure, thereby providing higher resilience.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhanced resilience with zone redundancy",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/publicIPAddresses",
            "recommendationTypeId": null,
            "service": "VNet",
            "severity": "High",
            "source": "azure-resources/Network/publicIPAddresses/recommendations.yaml",
            "tags": null,
            "text": "Use Standard SKU and Zone-Redundant IPs when applicable"
        },
        {
            "aprlGuid": "1adba190-5c4c-e646-8527-dd1b2a6d8b15",
            "automationAvailable": "arg",
            "category": "High Availability",
            "description": "Prevent connectivity failures due to SNAT port exhaustion by employing NAT gateway for outbound traffic from virtual networks, ensuring dynamic scaling and secure internet connections.\n",
            "graph": "// Azure Resource Graph query\n// Lists VMs with PIPs\nresources\n| where type =~ 'Microsoft.Network/publicIPAddresses'\n| where tostring(properties.ipConfiguration.id) contains \"microsoft.network/networkinterfaces\"\n| project recommendationId=\"1adba190-5c4c-e646-8527-dd1b2a6d8b15\", name, id, tags, param1=strcat(\"Migrate from instance IP to NAT Gateway\")\n\n",
            "guid": "1adba190-5c4c-e646-8527-dd1b2a6d8b15",
            "learnMoreLink": [
                {
                    "name": "Use NAT GW for outbound connectivity",
                    "url": "https://learn.microsoft.com/azure/advisor/advisor-reference-reliability-recommendations#use-nat-gateway-for-outbound-connectivity"
                },
                {
                    "name": "TCP and SNAT Ports",
                    "url": "https://learn.microsoft.com/azure/architecture/framework/services/compute/azure-app-service/reliability#tcp-and-snat-ports"
                }
            ],
            "longDescription": "Prevent connectivity failures due to SNAT port exhaustion by employing NAT gateway for outbound traffic from virtual networks, ensuring dynamic scaling and secure internet connections.\n",
            "pgVerified": true,
            "potentialBenefits": "Avoids SNAT port exhaustion risks",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/publicIPAddresses",
            "recommendationTypeId": null,
            "service": "VNet",
            "severity": "Medium",
            "source": "azure-resources/Network/publicIPAddresses/recommendations.yaml",
            "tags": null,
            "text": "Use NAT gateway for outbound connectivity to avoid SNAT Exhaustion"
        },
        {
            "aprlGuid": "5cea1501-6fe4-4ec4-ac8f-f72320eb18d3",
            "automationAvailable": "arg",
            "category": "High Availability",
            "description": "Basic SKU public IP addresses will be retired on September 30, 2025. Users are advised to upgrade to Standard SKU public IP addresses before this date to avoid service disruptions.\n",
            "graph": "// Azure Resource Graph query\n// List Basic SKU public IP addresses\nResources\n| where type =~ \"Microsoft.Network/publicIPAddresses\"\n| where sku.name =~ \"Basic\"\n| project recommendationId = \"5cea1501-6fe4-4ec4-ac8f-f72320eb18d3\", name, id, tags, param1 = strcat(\"sku: \", sku.name)\n\n",
            "guid": "5cea1501-6fe4-4ec4-ac8f-f72320eb18d3",
            "learnMoreLink": [
                {
                    "name": "Upgrading a basic public IP address to Standard SKU - Guidance",
                    "url": "https://learn.microsoft.com/en-us/azure/virtual-network/ip-services/public-ip-basic-upgrade-guidance"
                },
                {
                    "name": "Upgrade to Standard SKU public IP addresses in Azure by 30 September 2025 as Basic SKU will be retired",
                    "url": "https://azure.microsoft.com/en-us/updates/upgrade-to-standard-sku-public-ip-addresses-in-azure-by-30-september-2025-basic-sku-will-be-retired/"
                }
            ],
            "longDescription": "Basic SKU public IP addresses will be retired on September 30, 2025. Users are advised to upgrade to Standard SKU public IP addresses before this date to avoid service disruptions.\n",
            "pgVerified": true,
            "potentialBenefits": "Avoids service disruption",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/publicIPAddresses",
            "recommendationTypeId": null,
            "service": "VNet",
            "severity": "Medium",
            "source": "azure-resources/Network/publicIPAddresses/recommendations.yaml",
            "tags": null,
            "text": "Upgrade Basic SKU public IP addresses to Standard SKU"
        },
        {
            "aprlGuid": "c4254c66-b8a5-47aa-82f6-e7d7fb418f47",
            "automationAvailable": "arg",
            "category": "Security",
            "description": "DDoS attacks can be targeted at any endpoint that is publicly reachable through the internet.\n",
            "graph": "// Azure Resource Graph query\n// Public IP addresses should have DDoS protection enabled\nresources\n| where type =~ 'Microsoft.Network/publicIPAddresses'\n| where properties.ddosSettings.protectionMode !in~ (\"Enabled\", \"VirtualNetworkInherited\")\n| project recommendationId=\"c4254c66-b8a5-47aa-82f6-e7d7fb418f47\", name, id, tags, param1=strcat(\"Apply either DDoS Network protection or DDoS IP Protrection to the public IP address.\")\n",
            "guid": "c4254c66-b8a5-47aa-82f6-e7d7fb418f47",
            "learnMoreLink": [
                {
                    "name": "Azure DDoS Protection",
                    "url": "https://learn.microsoft.com/en-us/azure/ddos-protection/ddos-protection-overview"
                }
            ],
            "longDescription": "DDoS attacks can be targeted at any endpoint that is publicly reachable through the internet.\n",
            "pgVerified": true,
            "potentialBenefits": "Avoids service disruption",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Security",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/publicIPAddresses",
            "recommendationTypeId": null,
            "service": "VNet",
            "severity": "Medium",
            "source": "azure-resources/Network/publicIPAddresses/recommendations.yaml",
            "tags": null,
            "text": "Public IP addresses should have DDoS protection enabled"
        },
        {
            "aprlGuid": "23b2dfc7-7e5d-9443-9f62-980ca621b561",
            "automationAvailable": "arg",
            "category": "Monitoring and Alerting",
            "description": "Create Alerts with Azure Monitor for operations like Create or Update Route Table to spot unauthorized/undesired changes in production resources. This setup aids in identifying improper routing changes, including efforts to evade firewalls or access resources from outside.\n",
            "graph": "// Azure Resource Graph Query\n// Find all Route Tables without alerts for modification configured.\nresources\n| where type =~ \"Microsoft.Network/routeTables\"\n| project name, id, tags, lowerCaseRouteTableId = tolower(id)\n| join kind = leftouter (\n    resources\n    | where type =~ \"Microsoft.Insights/activityLogAlerts\" and properties.enabled == true\n    | mv-expand scope = properties.scopes\n    | where scope has \"Microsoft.Network/routeTables\"\n    | project alertName = name, conditionJson = dynamic_to_json(properties.condition.allOf), scope\n    | where conditionJson has '\"Administrative\"' and (\n        // Create or Update Route Table\n        (conditionJson has '\"Microsoft.Network/routeTables/write\"') or\n        // All Administrative operations\n        (conditionJson !has '\"Microsoft.Network/routeTables/write\"' and conditionJson !has '\"Microsoft.Network/routeTables/delete\"' and conditionJson !has '\"Microsoft.Network/routeTables/join/action\"')\n        )\n    | project lowerCaseRouteTableIdOfScope = tolower(scope)\n    )\n    on $left.lowerCaseRouteTableId == $right.lowerCaseRouteTableIdOfScope\n| where isempty(lowerCaseRouteTableIdOfScope)\n| project recommendationId = \"23b2dfc7-7e5d-9443-9f62-980ca621b561\", name, id, tags, param1 = \"ModificationAlert: Not configured/Disabled\"\n\n",
            "guid": "23b2dfc7-7e5d-9443-9f62-980ca621b561",
            "learnMoreLink": [
                {
                    "name": "Azure activity log - Azure Monitor | Microsoft Learn",
                    "url": "https://learn.microsoft.com/en-us/azure/azure-monitor/essentials/activity-log?tabs=powershell"
                }
            ],
            "longDescription": "Create Alerts with Azure Monitor for operations like Create or Update Route Table to spot unauthorized/undesired changes in production resources. This setup aids in identifying improper routing changes, including efforts to evade firewalls or access resources from outside.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhanced security and change detection",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Monitoring and Alerting",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/routeTables",
            "recommendationTypeId": null,
            "service": "VNet",
            "severity": "High",
            "source": "azure-resources/Network/routeTables/recommendations.yaml",
            "tags": null,
            "text": "Monitor changes in Route Tables with Azure Monitor"
        },
        {
            "aprlGuid": "89d1166a-1a20-0f46-acc8-3194387bf127",
            "automationAvailable": false,
            "category": "Governance",
            "description": "As an administrator, you can protect Azure subscriptions, resource groups, or resources from accidental deletions and modifications by setting locks.\n",
            "graph": "// under-development\n\n",
            "guid": "89d1166a-1a20-0f46-acc8-3194387bf127",
            "learnMoreLink": [
                {
                    "name": "Protect your Azure resources with a lock - Azure Resource Manager | Microsoft Learn",
                    "url": "https://learn.microsoft.com/en-us/azure/azure-resource-manager/management/lock-resources?toc=%2Fazure%2Fvirtual-network%2Ftoc.json&tabs=json"
                }
            ],
            "longDescription": "As an administrator, you can protect Azure subscriptions, resource groups, or resources from accidental deletions and modifications by setting locks.\n",
            "pgVerified": true,
            "potentialBenefits": "Prevents accidental edits/deletions",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Governance",
            "recommendationImpact": "Low",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/routeTables",
            "recommendationTypeId": null,
            "service": "VNet",
            "severity": "Low",
            "source": "azure-resources/Network/routeTables/recommendations.yaml",
            "tags": null,
            "text": "Configure locks for Route Tables to avoid accidental changes or deletion"
        },
        {
            "aprlGuid": "f05a3e6d-49db-2740-88e2-2b13706c1f67",
            "automationAvailable": "arg",
            "category": "High Availability",
            "description": "Monitor status should be online to ensure failover for application workload. If Traffic Manager's health shows Degraded, one or more endpoints may also be Degraded.\n",
            "graph": "// Azure Resource Graph Query\n// Find traffic manager profiles that have an endpoint monitor status of not 'Online'\nresources\n| where type == \"microsoft.network/trafficmanagerprofiles\"\n| mv-expand properties.endpoints\n| where properties_endpoints.properties.endpointMonitorStatus != \"Online\"\n| project recommendationId = \"f05a3e6d-49db-2740-88e2-2b13706c1f67\", name, id, tags, param1 = strcat('Profile name: ',properties_endpoints.name), param2 = strcat('endpointMonitorStatus: ', properties_endpoints.properties.endpointMonitorStatus)\n\n",
            "guid": "f05a3e6d-49db-2740-88e2-2b13706c1f67",
            "learnMoreLink": [
                {
                    "name": "Azure Traffic Manager endpoint monitoring",
                    "url": "https://learn.microsoft.com/azure/traffic-manager/traffic-manager-monitoring"
                },
                {
                    "name": "Enable or disable health checks",
                    "url": "https://learn.microsoft.com/azure/traffic-manager/traffic-manager-monitoring#enable-or-disable-health-checks-preview"
                },
                {
                    "name": "Troubleshooting degraded state on Azure Traffic Manager",
                    "url": "https://learn.microsoft.com/azure/traffic-manager/traffic-manager-troubleshooting-degraded"
                }
            ],
            "longDescription": "Monitor status should be online to ensure failover for application workload. If Traffic Manager's health shows Degraded, one or more endpoints may also be Degraded.\n",
            "pgVerified": true,
            "potentialBenefits": "Ensures failover functionality",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/trafficManagerProfiles",
            "recommendationTypeId": null,
            "service": "Traffic Manager",
            "severity": "High",
            "source": "azure-resources/Network/trafficManagerProfiles/recommendations.yaml",
            "tags": null,
            "text": "Traffic Manager Monitor Status Should be Online"
        },
        {
            "aprlGuid": "5b422a7f-8caa-3d48-becb-511599e5bba9",
            "automationAvailable": "arg",
            "category": "High Availability",
            "description": "When configuring the Azure traffic manager, provision at least two endpoints to ensure workloads can fail-over to another instance, enhancing reliability and availability.\n",
            "graph": "// Azure Resource Graph Query\n// Find traffic manager profiles that have less than 2 endpoints\nresources\n| where type == \"microsoft.network/trafficmanagerprofiles\"\n| where array_length(properties.endpoints) < 2\n| project recommendationId = \"5b422a7f-8caa-3d48-becb-511599e5bba9\", name, id, tags, param1 = strcat('EndpointCount: ', array_length(properties.endpoints))\n\n",
            "guid": "5b422a7f-8caa-3d48-becb-511599e5bba9",
            "learnMoreLink": [
                {
                    "name": "Traffic Manager Endpoint Types",
                    "url": "https://learn.microsoft.com/azure/traffic-manager/traffic-manager-endpoint-types"
                }
            ],
            "longDescription": "When configuring the Azure traffic manager, provision at least two endpoints to ensure workloads can fail-over to another instance, enhancing reliability and availability.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhances failover capabilities",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/trafficManagerProfiles",
            "recommendationTypeId": "6cd70072-c45c-4716-bf7b-b35c18e46e72",
            "service": "Traffic Manager",
            "severity": "Medium",
            "source": "azure-resources/Network/trafficManagerProfiles/recommendations.yaml",
            "tags": null,
            "text": "Traffic manager profiles should have more than one endpoint"
        },
        {
            "aprlGuid": "1ad9d7b7-9692-1441-a8f4-93792efbe97a",
            "automationAvailable": false,
            "category": "Disaster Recovery",
            "description": "Profiles should have multiple endpoints to ensure availability in case an endpoint fails. It's also advised to distribute these endpoints across different regions for enhanced reliability.\n",
            "graph": "// cannot-be-validated-with-arg\n\n",
            "guid": "1ad9d7b7-9692-1441-a8f4-93792efbe97a",
            "learnMoreLink": [
                {
                    "name": "Reliability recommendations",
                    "url": "https://learn.microsoft.com/azure/advisor/advisor-reference-reliability-recommendations#add-at-least-one-more-endpoint-to-the-profile-preferably-in-another-azure-region"
                }
            ],
            "longDescription": "Profiles should have multiple endpoints to ensure availability in case an endpoint fails. It's also advised to distribute these endpoints across different regions for enhanced reliability.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhances availability across regions",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Disaster Recovery",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/trafficManagerProfiles",
            "recommendationTypeId": "0db76759-6d22-4262-93f0-2f989ba2b58e",
            "service": "Traffic Manager",
            "severity": "Medium",
            "source": "azure-resources/Network/trafficManagerProfiles/recommendations.yaml",
            "tags": null,
            "text": "Configure at least one endpoint within a another region"
        },
        {
            "aprlGuid": "c31f76a0-48cd-9f44-aa43-99ee904db9bc",
            "automationAvailable": "arg",
            "category": "Disaster Recovery",
            "description": "For geographic routing, traffic is directed to endpoints based on specific regions. If a region fails, without a predefined failover, configuring an endpoint to \"All (World)\" for geographic profiles can prevent traffic black holes, ensuring service remains available.\n",
            "graph": "// Azure Resource Graph Query\n// Provides a list of Traffic Manager resources that are not confirgured for all-World access\nResources\n| where type == 'microsoft.network/trafficmanagerprofiles'\n| where properties.trafficRoutingMethod =~ \"Geographic\"\n| extend endpoints = properties.endpoints\n| mv-expand endpoint = endpoints\n| where endpoint.properties.geoMapping !contains \"WORLD\"\n| extend endpointName = endpoint.name\n| project recommendationId=\"c31f76a0-48cd-9f44-aa43-99ee904db9bc\", name, id, tags, param1=strcat(\"endpointName:\",endpointName), param2=strcat(\"GeoMapping:\", tostring(endpoint.properties.geoMapping))\n",
            "guid": "c31f76a0-48cd-9f44-aa43-99ee904db9bc",
            "learnMoreLink": [
                {
                    "name": "Add an endpoint configured to \"All (World)\"",
                    "url": "https://learn.microsoft.com/azure/advisor/advisor-reference-reliability-recommendations#add-an-endpoint-configured-to-all-world"
                },
                {
                    "name": "Traffic Manager profile - GeographicProfile (Add an endpoint configured to \"\"All (World)\"\").",
                    "url": "https://aka.ms/Rf7vc5"
                }
            ],
            "longDescription": "For geographic routing, traffic is directed to endpoints based on specific regions. If a region fails, without a predefined failover, configuring an endpoint to \"All (World)\" for geographic profiles can prevent traffic black holes, ensuring service remains available.\n",
            "pgVerified": true,
            "potentialBenefits": "Avoids traffic black holing, ensures availability",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Disaster Recovery",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/trafficManagerProfiles",
            "recommendationTypeId": "0bbe0a49-3c63-49d3-ab4a-aa24198f03f7",
            "service": "Traffic Manager",
            "severity": "High",
            "source": "azure-resources/Network/trafficManagerProfiles/recommendations.yaml",
            "tags": null,
            "text": "Ensure endpoint configured to (All World) for geographic profiles"
        },
        {
            "aprlGuid": "d37db635-157f-584d-9bce-4f6fc8c65ce5",
            "automationAvailable": "arg",
            "category": "High Availability",
            "description": "To increase reliability, it's advised that each ExpressRoute gateway connects to at least two circuits, with each circuit originating from a different peering location than the other, ensuring diverse connectivity paths for enhanced resilience.\n",
            "graph": "// Azure Resource Graph Query\n// Provides a list of ExpressRoute Gateways that are not connected to two or more ExpressRoute Circuits. Baremetal circuits are excluded from consideration\n//This query assumes that the running entity has visibilty to the gateway, connection, and circuit scopes.\n//Start with a full list of gateways\n(resources\n| where type == \"microsoft.network/virtualnetworkgateways\"\n| where properties.gatewayType == \"ExpressRoute\"\n| extend exrGatewayId = tolower(tostring(id))\n| join kind=inner(\nresources\n| where type == \"microsoft.network/virtualnetworkgateways\"\n| where properties.gatewayType == \"ExpressRoute\"\n| extend exrGatewayId = tolower(tostring(id))\n| join kind=leftouter(\n//connections joined with circuit peer info\nresources\n| where type == \"microsoft.network/connections\"\n| extend connectionType = properties.connectionType\n| extend exrGatewayId = tolower(tostring(properties.virtualNetworkGateway1.id))\n| extend peerId = tolower(tostring(properties.peer.id))\n| extend connectionId = tolower(tostring(id))\n| where connectionType == \"ExpressRoute\"\n| join kind=leftouter(\n  resources\n  | where type == \"microsoft.network/expressroutecircuits\"\n    //should this be location instead of peeringLocation\n  | extend circuitId = tolower(tostring(id))\n  | extend peeringLocation = tostring(properties.serviceProviderProperties.peeringLocation)\n  | extend peerId = tolower(id)\n) on peerId ) on exrGatewayId\n//remove bare metal services connections/circuits\n| where not(isnotnull(connectionId) and isnull(sku1))\n//group by gateway ID's and peering locations\n| summarize by exrGatewayId, peeringLocation\n//summarize to connections with fewer than two unique connections\n| summarize connCount = count() by exrGatewayId\n| where connCount < 2) on exrGatewayId\n| project recommendationId = \"d37db635-157f-584d-9bce-4f6fc8c65ce5\", name, id, tags, param1 = \"twoOrMoreCircuitsConnectedFromDifferentPeeringLocations: false\")\n| union\n(\nresources\n| where type == \"microsoft.network/virtualnetworkgateways\"\n| where properties.gatewayType == \"ExpressRoute\"\n| extend exrGatewayId = tolower(tostring(id))\n| join kind=leftouter(\n//connections joined with circuit peer info\nresources\n| where type == \"microsoft.network/connections\"\n| extend connectionType = properties.connectionType\n| extend exrGatewayId = tolower(tostring(properties.virtualNetworkGateway1.id))\n| extend peerId = tolower(tostring(properties.peer.id))\n| extend connectionId = tolower(tostring(id))\n| where connectionType == \"ExpressRoute\") on exrGatewayId\n| where isnull(connectionType)\n| project recommendationId = \"d37db635-157f-584d-9bce-4f6fc8c65ce5\", name, id, tags, param1 = \"twoOrMoreCircuitsConnectedFromDifferentPeeringLocations: false\", param2 = \"noConnectionsOnGateway: true\"\n)\n\n",
            "guid": "d37db635-157f-584d-9bce-4f6fc8c65ce5",
            "learnMoreLink": [
                {
                    "name": "Designing for disaster recovery with ExpressRoute private peering",
                    "url": "https://learn.microsoft.com/azure/expressroute/designing-for-disaster-recovery-with-expressroute-privatepeering"
                }
            ],
            "longDescription": "To increase reliability, it's advised that each ExpressRoute gateway connects to at least two circuits, with each circuit originating from a different peering location than the other, ensuring diverse connectivity paths for enhanced resilience.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhanced resiliency for Azure service",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/virtualNetworkGateways",
            "recommendationTypeId": "8d61a7d4-5405-4f43-81e3-8c6239b844a6",
            "service": "VPN",
            "severity": "High",
            "source": "azure-resources/Network/virtualNetworkGateways/recommendations.yaml",
            "tags": null,
            "text": "Connect ExpressRoute gateway with circuits from diverse peering locations for resilience"
        },
        {
            "aprlGuid": "bbe668b7-eb5c-c746-8b82-70afdedf0cae",
            "automationAvailable": "arg",
            "category": "High Availability",
            "description": "Azure ExpressRoute gateway offers variable SLAs based on deployment in single or multiple availability zones. To deploy virtual network gateways across zones automatically, use zone-redundant gateways for accessing critical, scalable services with increased resilience.\n",
            "graph": "// Azure Resource Graph Query\n// For all VNGs of type ExpressRoute, show any that do not have AZ in the SKU tier\nresources\n| where type =~ \"Microsoft.Network/virtualNetworkGateways\"\n| where properties.gatewayType == \"ExpressRoute\"\n| where properties.sku.tier !contains 'AZ'\n| project recommendationId = \"bbe668b7-eb5c-c746-8b82-70afdedf0cae\", name, id, tags, param1= strcat(\"sku-tier: \" , properties.sku.tier), param2=location\n| order by id asc\n\n",
            "guid": "bbe668b7-eb5c-c746-8b82-70afdedf0cae",
            "learnMoreLink": [
                {
                    "name": "About ExpressRoute virtual network gateways - Zone-redundant gateway SKUs",
                    "url": "https://learn.microsoft.com/azure/expressroute/expressroute-about-virtual-network-gateways#zrgw"
                },
                {
                    "name": "About zone-redundant virtual network gateway in Azure availability zones",
                    "url": "https://learn.microsoft.com/azure/vpn-gateway/about-zone-redundant-vnet-gateways"
                },
                {
                    "name": "Create a zone-redundant virtual network gateway in Azure Availability Zones",
                    "url": "https://learn.microsoft.com/azure/vpn-gateway/create-zone-redundant-vnet-gateway"
                }
            ],
            "longDescription": "Azure ExpressRoute gateway offers variable SLAs based on deployment in single or multiple availability zones. To deploy virtual network gateways across zones automatically, use zone-redundant gateways for accessing critical, scalable services with increased resilience.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhanced SLA and resilience",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/virtualNetworkGateways",
            "recommendationTypeId": "c9af1ef6-55bc-48af-bfe4-2c80490159f8",
            "service": "VPN",
            "severity": "High",
            "source": "azure-resources/Network/virtualNetworkGateways/recommendations.yaml",
            "tags": null,
            "text": "Use Zone-redundant ExpressRoute gateway SKUs"
        },
        {
            "aprlGuid": "c0f23a92-d322-4d4d-97e9-a238b5e3bbb8",
            "automationAvailable": false,
            "category": "High Availability",
            "description": "Configuring an Azure Resource lock for ExpressRoute gateway prevents accidental deletion by enabling administrators to lock an Azure subscription, resource group, or resource, thereby protecting them from unintended user deletions and modifications, with the lock overriding all user permissions.\n",
            "graph": "// under-development\n\n",
            "guid": "c0f23a92-d322-4d4d-97e9-a238b5e3bbb8",
            "learnMoreLink": [
                {
                    "name": "Protect your Azure resources with a lock - Azure Resource Manager | Microsoft Learn",
                    "url": "https://learn.microsoft.com/en-us/azure/azure-resource-manager/management/lock-resources?tabs=json"
                }
            ],
            "longDescription": "Configuring an Azure Resource lock for ExpressRoute gateway prevents accidental deletion by enabling administrators to lock an Azure subscription, resource group, or resource, thereby protecting them from unintended user deletions and modifications, with the lock overriding all user permissions.\n",
            "pgVerified": true,
            "potentialBenefits": "Prevents accidental deletions",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/virtualNetworkGateways",
            "recommendationTypeId": null,
            "service": "VPN",
            "severity": "Medium",
            "source": "azure-resources/Network/virtualNetworkGateways/recommendations.yaml",
            "tags": null,
            "text": "Configure an Azure Resource lock for ExpressRoute gateway to prevent accidental deletion"
        },
        {
            "aprlGuid": "1c34faa8-8b99-974c-adbf-71922eae943c",
            "automationAvailable": false,
            "category": "Monitoring and Alerting",
            "description": "Use Network Insights for monitoring ExpressRoute Gateway's health, including availability, performance, and scalability.\n",
            "graph": "// under-development\n\n\n",
            "guid": "1c34faa8-8b99-974c-adbf-71922eae943c",
            "learnMoreLink": [
                {
                    "name": "ExpressRoute monitoring, metrics, and alerts | ExpressRoute gateways",
                    "url": "https://learn.microsoft.com/azure/expressroute/expressroute-monitoring-metrics-alerts#expressroute-gateways"
                },
                {
                    "name": "Azure ExpressRoute Insights using Network Insights",
                    "url": "https://learn.microsoft.com/en-us/azure/expressroute/expressroute-network-insights"
                }
            ],
            "longDescription": "Use Network Insights for monitoring ExpressRoute Gateway's health, including availability, performance, and scalability.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhanced monitoring and alerting",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Monitoring and Alerting",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/virtualNetworkGateways",
            "recommendationTypeId": null,
            "service": "VPN",
            "severity": "High",
            "source": "azure-resources/Network/virtualNetworkGateways/recommendations.yaml",
            "tags": null,
            "text": "Monitor gateway health for ExpressRoute gateways"
        },
        {
            "aprlGuid": "194c14ac-0d7a-5a48-ae32-75fa450ee564",
            "automationAvailable": false,
            "category": "High Availability",
            "description": "While multiple VNets can connect via the same ExpressRoute gateway, Microsoft recommends using alternatives like VNet peering, Azure Firewall, NVA, Azure Route Server, site-to-site VPN, virtual WAN, or SD-WAN for VNet-to-VNet communication to optimize network performance and management.\n",
            "graph": "// under-development\n\n",
            "guid": "194c14ac-0d7a-5a48-ae32-75fa450ee564",
            "learnMoreLink": [
                {
                    "name": "About ExpressRoute virtual network gateways - VNet-to-VNet connectivity",
                    "url": "https://learn.microsoft.com/azure/expressroute/expressroute-about-virtual-network-gateways#vnet-to-vnet-connectivity"
                }
            ],
            "longDescription": "While multiple VNets can connect via the same ExpressRoute gateway, Microsoft recommends using alternatives like VNet peering, Azure Firewall, NVA, Azure Route Server, site-to-site VPN, virtual WAN, or SD-WAN for VNet-to-VNet communication to optimize network performance and management.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhanced VNet integration efficiency",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/virtualNetworkGateways",
            "recommendationTypeId": null,
            "service": "VPN",
            "severity": "Medium",
            "source": "azure-resources/Network/virtualNetworkGateways/recommendations.yaml",
            "tags": null,
            "text": "Avoid using ExpressRoute circuits for VNet to VNet communication"
        },
        {
            "aprlGuid": "3e115044-a3aa-433e-be01-ce17d67e50da",
            "automationAvailable": "arg",
            "category": "High Availability",
            "description": "ExpressRoute gateways are updated for improved functionality, reliability, performance, and security. Customer-controlled maintenance configuration and scheduling minimize update impact and align with your maintenance windows.\n",
            "graph": "// Azure Resource Graph Query\n// Find all Virtual Network Gateways without Maintenance Configurations\n\nresources\n| where type =~ \"Microsoft.Network/virtualNetworkGateways\"\n| extend resourceId = tolower(id)\n| join kind=leftouter  (\n    maintenanceresources\n    | where type =~ \"Microsoft.Maintenance/configurationAssignments\"\n    | project JsonData = parse_json(properties)\n    | extend maintenanceConfigurationId = tolower(tostring(JsonData.maintenanceConfigurationId))\n    | join kind=inner (\n        resources\n        | where type =~ \"Microsoft.Maintenance/maintenanceConfigurations\"\n        | project maintenanceConfigurationId=tolower(id)\n    ) on maintenanceConfigurationId\n    | project maintenanceConfigurationId, resourceId=tolower(tostring(JsonData.resourceId))\n) on resourceId\n| where isempty(maintenanceConfigurationId)\n| project recommendationId = \"3e115044-a3aa-433e-be01-ce17d67e50da\", name, id, tags, param1= strcat(\"sku-tier: \" , properties.sku.tier), param2=location\n\n",
            "guid": "3e115044-a3aa-433e-be01-ce17d67e50da",
            "learnMoreLink": [
                {
                    "name": "Configure customer-controlled maintenance for your virtual network gateway - ExpressRoute | Microsoft Learn",
                    "url": "https://learn.microsoft.com/en-us/azure/expressroute/customer-controlled-gateway-maintenance#azure-portal-steps"
                }
            ],
            "longDescription": "ExpressRoute gateways are updated for improved functionality, reliability, performance, and security. Customer-controlled maintenance configuration and scheduling minimize update impact and align with your maintenance windows.\n",
            "pgVerified": true,
            "potentialBenefits": "Minimizes update impact",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/virtualNetworkGateways",
            "recommendationTypeId": null,
            "service": "VPN",
            "severity": "High",
            "source": "azure-resources/Network/virtualNetworkGateways/recommendations.yaml",
            "tags": null,
            "text": "Configure customer-controlled ExpressRoute gateway maintenance"
        },
        {
            "aprlGuid": "5b1933a6-90e4-f642-a01f-e58594e5aab2",
            "automationAvailable": "arg",
            "category": "High Availability",
            "description": "Azure VPN gateway offers variable SLAs based on deployment in one or two availability zones. Deploying zone-redundant virtual network gateways across availability zones ensures zone-resiliency, improving access to mission-critical, scalable services on Azure.\n",
            "graph": "// Azure Resource Graph Query\n// For all VNGs of type Vpn, show any that do not have AZ in the SKU tier\nresources\n| where type =~ \"Microsoft.Network/virtualNetworkGateways\"\n| where properties.gatewayType == \"Vpn\"\n| where properties.sku.tier !contains 'AZ'\n| project recommendationId = \"5b1933a6-90e4-f642-a01f-e58594e5aab2\", name, id, tags, param1= strcat(\"sku-tier: \" , properties.sku.tier), param2=location\n| order by id asc\n\n",
            "guid": "5b1933a6-90e4-f642-a01f-e58594e5aab2",
            "learnMoreLink": [
                {
                    "name": "Zone redundant Virtual network gateway in availability zone",
                    "url": "https://learn.microsoft.com/azure/vpn-gateway/about-zone-redundant-vnet-gateways"
                },
                {
                    "name": "Gateway SKU",
                    "url": "https://learn.microsoft.com/azure/vpn-gateway/about-zone-redundant-vnet-gateways#gwskus"
                },
                {
                    "name": "SLA summary for Azure services",
                    "url": "https://www.microsoft.com/licensing/docs/view/Service-Level-Agreements-SLA-for-Online-Services?lang=1"
                }
            ],
            "longDescription": "Azure VPN gateway offers variable SLAs based on deployment in one or two availability zones. Deploying zone-redundant virtual network gateways across availability zones ensures zone-resiliency, improving access to mission-critical, scalable services on Azure.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhanced reliability and scalability",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/virtualNetworkGateways",
            "recommendationTypeId": null,
            "service": "VPN",
            "severity": "High",
            "source": "azure-resources/Network/virtualNetworkGateways/recommendations.yaml",
            "tags": null,
            "text": "Choose a Zone-redundant VPN gateway"
        },
        {
            "aprlGuid": "281a2713-c0e0-3c48-b596-19f590c46671",
            "automationAvailable": "arg",
            "category": "High Availability",
            "description": "The active-active mode is available for all SKUs except Basic, allowing for two Gateway IP configurations and two public IP addresses, enhancing redundancy and traffic handling.\n",
            "graph": "// Azure Resource Graph Query\n// Identifies non-active-active VPN type virtual network gateways\nresources\n| where type =~ 'Microsoft.Network/virtualNetworkGateways'\n| where properties.gatewayType =~ \"vpn\"\n| extend gatewayType = properties.gatewayType, vpnType = properties.vpnType, connections = properties.connections, activeactive=properties.activeActive\n| where activeactive == false\n| project recommendationId = \"281a2713-c0e0-3c48-b596-19f590c46671\", name, id, tags\n\n\n",
            "guid": "281a2713-c0e0-3c48-b596-19f590c46671",
            "learnMoreLink": [
                {
                    "name": "Active-active VPN gateway",
                    "url": "https://learn.microsoft.com/azure/vpn-gateway/active-active-portal#gateway"
                },
                {
                    "name": "Gateway SKU",
                    "url": "https://learn.microsoft.com/azure/vpn-gateway/vpn-gateway-about-vpn-gateway-settings#gwsku"
                }
            ],
            "longDescription": "The active-active mode is available for all SKUs except Basic, allowing for two Gateway IP configurations and two public IP addresses, enhancing redundancy and traffic handling.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhanced reliability and network capacity",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/virtualNetworkGateways",
            "recommendationTypeId": "c249dc0e-9a17-423e-838a-d72719e8c5dd",
            "service": "VPN",
            "severity": "Medium",
            "source": "azure-resources/Network/virtualNetworkGateways/recommendations.yaml",
            "tags": null,
            "text": "Enable Active-Active VPN Gateways for redundancy"
        },
        {
            "aprlGuid": "af11fc4c-c06c-4f4c-b98d-6eee6d5c4c70",
            "automationAvailable": false,
            "category": "Disaster Recovery",
            "description": "Deploying active-active VPN concentrators and Azure VPN Gateways maximizes resilience and availability using a fully-meshed topology with four IPSec tunnels.\n",
            "graph": "// under-development\n\n\n",
            "guid": "af11fc4c-c06c-4f4c-b98d-6eee6d5c4c70",
            "learnMoreLink": [
                {
                    "name": "Dual-redundancy active-active VPN gateways for both Azure and on-premises networks",
                    "url": "https://learn.microsoft.com/azure/vpn-gateway/vpn-gateway-highlyavailable#dual-redundancy-active-active-vpn-gateways-for-both-azure-and-on-premises-networks"
                }
            ],
            "longDescription": "Deploying active-active VPN concentrators and Azure VPN Gateways maximizes resilience and availability using a fully-meshed topology with four IPSec tunnels.\n",
            "pgVerified": true,
            "potentialBenefits": "Maximizes resilience and availability",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Disaster Recovery",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/virtualNetworkGateways",
            "recommendationTypeId": null,
            "service": "VPN",
            "severity": "High",
            "source": "azure-resources/Network/virtualNetworkGateways/recommendations.yaml",
            "tags": null,
            "text": "Deploy active-active VPN concentrators on your premises for maximum resiliency with VPN gateways"
        },
        {
            "aprlGuid": "9eab120e-f6d3-ee49-ba0d-766562ce7df1",
            "automationAvailable": false,
            "category": "Monitoring and Alerting",
            "description": "Set up monitoring and alerts for Virtual Network Gateway health to utilize a variety of metrics for ensuring operational efficiency and prompt response to any disruptions.\n",
            "graph": "// under-development\n\n",
            "guid": "9eab120e-f6d3-ee49-ba0d-766562ce7df1",
            "learnMoreLink": [
                {
                    "name": "VPN gateway data reference",
                    "url": "https://learn.microsoft.com/azure/vpn-gateway/monitor-vpn-gateway-reference"
                }
            ],
            "longDescription": "Set up monitoring and alerts for Virtual Network Gateway health to utilize a variety of metrics for ensuring operational efficiency and prompt response to any disruptions.\n",
            "pgVerified": true,
            "potentialBenefits": "Improved uptime and issue awareness",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Monitoring and Alerting",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/virtualNetworkGateways",
            "recommendationTypeId": null,
            "service": "VPN",
            "severity": "High",
            "source": "azure-resources/Network/virtualNetworkGateways/recommendations.yaml",
            "tags": null,
            "text": "Monitor VPN gateway connections and health"
        },
        {
            "aprlGuid": "9186dae0-7ddc-8f4b-bea5-55538cea4893",
            "automationAvailable": false,
            "category": "Monitoring and Alerting",
            "description": "VPN gateway leverages service health to inform users about both planned and unplanned maintenance, ensuring they are notified about modifications to their VPN connectivity.\n",
            "graph": "// under-development\n\n\n",
            "guid": "9186dae0-7ddc-8f4b-bea5-55538cea4893",
            "learnMoreLink": [
                {
                    "name": "Getting started with Azure Metrics Explorer",
                    "url": "https://learn.microsoft.com/azure/azure-monitor/essentials/metrics-getting-started"
                },
                {
                    "name": "Monitor VPN gateway",
                    "url": "https://learn.microsoft.com/azure/vpn-gateway/monitor-vpn-gateway-reference#metrics"
                }
            ],
            "longDescription": "VPN gateway leverages service health to inform users about both planned and unplanned maintenance, ensuring they are notified about modifications to their VPN connectivity.\n",
            "pgVerified": true,
            "potentialBenefits": "Improves VPN maintenance alerts",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Monitoring and Alerting",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/virtualNetworkGateways",
            "recommendationTypeId": null,
            "service": "VPN",
            "severity": "High",
            "source": "azure-resources/Network/virtualNetworkGateways/recommendations.yaml",
            "tags": null,
            "text": "Enable VPN gateway service health"
        },
        {
            "aprlGuid": "4bae5a28-5cf4-40d9-bcf1-623d28f6d917",
            "automationAvailable": "arg",
            "category": "High Availability",
            "description": "For zone-redundant VPN gateways, always use zone-redundant Standard SKU public IPs to avoid deploying all instances in one zone. This ensures the gateway's reliability, applying to both active-passive (single IP) and active-active (dual IP) setups.\n",
            "graph": "// Azure Resource Graph Query\n// Provides a list of zone-redundant Azure VPN gateways associated with non-zone-redundant Public IPs\nresources\n| where type =~ \"Microsoft.Network/virtualNetworkGateways\"\n| where properties.gatewayType == \"Vpn\"\n| where properties.sku.tier contains 'AZ'\n| mv-expand ipconfig = properties.ipConfigurations\n| extend pipId = tostring(ipconfig.properties.publicIPAddress.id)\n| join kind=inner (\n    resources\n    | where type == \"microsoft.network/publicipaddresses\"\n    | where isnull(zones) or array_length(zones) < 3   )\n    on $left.pipId == $right.id\n| project recommendationId = \"4bae5a28-5cf4-40d9-bcf1-623d28f6d917\", name, id, tags, param1 = strcat(\"PublicIpAddressName: \", name1), param2 = strcat (\"PublicIpAddressId: \",id1), param3 = strcat (\"PublicIpAddressTags: \",tags1)\n\n",
            "guid": "4bae5a28-5cf4-40d9-bcf1-623d28f6d917",
            "learnMoreLink": [
                {
                    "name": "About zone-redundant virtual network gateway in Azure availability zones",
                    "url": "https://learn.microsoft.com/azure/vpn-gateway/about-zone-redundant-vnet-gateways"
                }
            ],
            "longDescription": "For zone-redundant VPN gateways, always use zone-redundant Standard SKU public IPs to avoid deploying all instances in one zone. This ensures the gateway's reliability, applying to both active-passive (single IP) and active-active (dual IP) setups.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhanced reliability and disaster recovery",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/virtualNetworkGateways",
            "recommendationTypeId": null,
            "service": "VPN",
            "severity": "High",
            "source": "azure-resources/Network/virtualNetworkGateways/recommendations.yaml",
            "tags": null,
            "text": "Deploy zone-redundant VPN gateways with zone-redundant Public IP(s)"
        },
        {
            "aprlGuid": "f0bf9ae6-25a5-974d-87d5-025abec73539",
            "automationAvailable": "arg",
            "category": "Security",
            "description": "Network security groups and application security groups allow filtering of inbound and outbound traffic by IP, port, and protocol, adding a security layer at the Subnet level.\n",
            "graph": "// Azure Resource Graph Query\n// Find Subnets without NSG associated\nresources\n| where type =~ 'Microsoft.Network/virtualnetworks'\n| mv-expand subnets = properties.subnets\n| extend sn = string_size(subnets.properties.networkSecurityGroup)\n| where sn == 0 and subnets.name !in (\"GatewaySubnet\", \"AzureFirewallSubnet\", \"AzureFirewallManagementSubnet\", \"RouteServerSubnet\")\n| project recommendationId = \"f0bf9ae6-25a5-974d-87d5-025abec73539\", name, id, tags, param1 = strcat(\"SubnetName: \", subnets.name), param2 = \"NSG: False\"\n\n",
            "guid": "f0bf9ae6-25a5-974d-87d5-025abec73539",
            "learnMoreLink": [
                {
                    "name": "Azure Virtual Network - Concepts and best practices | Microsoft Learn",
                    "url": "https://learn.microsoft.com/azure/virtual-network/concepts-and-best-practices"
                },
                {
                    "name": "GatewaySUbnet",
                    "url": "https://learn.microsoft.com/en-us/azure/vpn-gateway/vpn-gateway-about-vpn-gateway-settings#gwsub"
                },
                {
                    "name": "Can I associate a network security group (NSG) to the RouteServerSubnet?",
                    "url": "https://learn.microsoft.com/en-us/azure/route-server/route-server-faq#can-i-associate-a-network-security-group-nsg-to-the-routeserversubnet"
                },
                {
                    "name": "Are Network Security Groups (NSGs) supported on the AzureFirewallSubnet?",
                    "url": "https://learn.microsoft.com/en-us/azure/firewall/firewall-faq#are-network-security-groups--nsgs--supported-on-the-azurefirewallsubnet"
                }
            ],
            "longDescription": "Network security groups and application security groups allow filtering of inbound and outbound traffic by IP, port, and protocol, adding a security layer at the Subnet level.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhanced subnet security and traffic control",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Security",
            "recommendationImpact": "Low",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/virtualNetworks",
            "recommendationTypeId": "eade5b56-eefd-444f-95c8-23f29e5d93cb",
            "service": "VNet",
            "severity": "Low",
            "source": "azure-resources/Network/virtualNetworks/recommendations.yaml",
            "tags": null,
            "text": "All Subnets should have a Network Security Group associated"
        },
        {
            "aprlGuid": "69ea1185-19b7-de40-9da1-9e8493547a5c",
            "automationAvailable": "arg",
            "category": "Security",
            "description": "Azure DDoS Protection offers enhanced mitigation features against DDoS attacks and is auto-tuned to protect specific resources in a virtual network, combined with application design best practices.\n",
            "graph": "// Azure Resource Graph Query\n// Find virtual networks without DDoS Protection\nresources\n| where type =~ 'Microsoft.Network/virtualNetworks'\n| where isnull(properties.enableDdosProtection) or properties.enableDdosProtection contains \"false\"\n| project recommendationId = \"69ea1185-19b7-de40-9da1-9e8493547a5c\", name, id, tags, param1 = strcat(\"EnableDdosProtection: \", properties.enableDdosProtection)\n\n",
            "guid": "69ea1185-19b7-de40-9da1-9e8493547a5c",
            "learnMoreLink": [
                {
                    "name": "Reliability and Azure Virtual Network - Microsoft Azure Well-Architected Framework | Microsoft Learn",
                    "url": "https://learn.microsoft.com/azure/architecture/framework/services/networking/azure-virtual-network/reliability"
                }
            ],
            "longDescription": "Azure DDoS Protection offers enhanced mitigation features against DDoS attacks and is auto-tuned to protect specific resources in a virtual network, combined with application design best practices.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhanced DDoS attack mitigation",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Security",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/virtualNetworks",
            "recommendationTypeId": null,
            "service": "VNet",
            "severity": "High",
            "source": "azure-resources/Network/virtualNetworks/recommendations.yaml",
            "tags": null,
            "text": "Shield public endpoints in Azure VNets with Azure DDoS Standard Protection Plans"
        },
        {
            "aprlGuid": "24ae3773-cc2c-3649-88de-c9788e25b463",
            "automationAvailable": "arg",
            "category": "Security",
            "description": "Use VNet service endpoints only if Private Link isn't available and no data movement concerns. This feature restricts Azure service access to specified VNet and subnet, enhancing network security and isolating service traffic.\n",
            "graph": "// Azure Resource Graph Query\n// Find Subnets with Service Endpoint enabled for services that offer Private Link\nresources\n| where type =~ 'Microsoft.Network/virtualnetworks'\n| mv-expand subnets = properties.subnets\n| extend se = array_length(subnets.properties.serviceEndpoints)\n| where se >= 1\n| project name, id, tags, subnets, serviceEndpoints=todynamic(subnets.properties.serviceEndpoints)\n| mv-expand serviceEndpoints\n| project name, id, tags, subnetName=subnets.name, serviceName=tostring(serviceEndpoints.service)\n| where serviceName in (parse_json('[\"Microsoft.CognitiveServices\",\"Microsoft.AzureCosmosDB\",\"Microsoft.DBforMariaDB\",\"Microsoft.DBforMySQL\",\"Microsoft.DBforPostgreSQL\",\"Microsoft.EventHub\",\"Microsoft.KeyVault\",\"Microsoft.ServiceBus\",\"Microsoft.Sql\", \"Microsoft.Storage\",\"Microsoft.StorageSync\",\"Microsoft.Synapse\",\"Microsoft.Web\"]'))\n| project recommendationId = \"24ae3773-cc2c-3649-88de-c9788e25b463\", name, id, tags, param1 = strcat(\"subnet=\", subnetName), param2=strcat(\"serviceName=\",serviceName), param3=\"ServiceEndpoints=true\"\n\n",
            "guid": "24ae3773-cc2c-3649-88de-c9788e25b463",
            "learnMoreLink": [
                {
                    "name": "Azure Virtual Network FAQ | Microsoft Learn",
                    "url": "https://learn.microsoft.com/azure/virtual-network/virtual-networks-faq"
                },
                {
                    "name": "Reliability and Network connectivity - Microsoft Azure Well-Architected Framework | Microsoft LearnNetworking Reliability",
                    "url": "https://learn.microsoft.com/azure/architecture/framework/services/networking/network-connectivity/reliability"
                },
                {
                    "name": "Azure Private Link availability",
                    "url": "https://learn.microsoft.com/en-us/azure/private-link/availability"
                }
            ],
            "longDescription": "Use VNet service endpoints only if Private Link isn't available and no data movement concerns. This feature restricts Azure service access to specified VNet and subnet, enhancing network security and isolating service traffic.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhanced security and data isolation",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Security",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Network/virtualNetworks",
            "recommendationTypeId": null,
            "service": "VNet",
            "severity": "Medium",
            "source": "azure-resources/Network/virtualNetworks/recommendations.yaml",
            "tags": null,
            "text": "When available, use Private Endpoints instead of Service Endpoints for PaaS Services"
        },
        {
            "aprlGuid": "1ceea4b5-1d8b-4be0-9bbe-9594557be51a",
            "automationAvailable": false,
            "category": "Monitoring and Alerting",
            "description": "ExpressRoute Traffic Collector samples network flows over ExpressRoute Direct circuits, sending flow logs to a Log Analytics workspace for analysis or export to visualization tools/SIEM.\n",
            "graph": "// under-development\n\n",
            "guid": "1ceea4b5-1d8b-4be0-9bbe-9594557be51a",
            "learnMoreLink": [
                {
                    "name": "Azure ExpressRoute Traffic Collector",
                    "url": "https://learn.microsoft.com/en-us/azure/expressroute/traffic-collector"
                }
            ],
            "longDescription": "ExpressRoute Traffic Collector samples network flows over ExpressRoute Direct circuits, sending flow logs to a Log Analytics workspace for analysis or export to visualization tools/SIEM.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhanced network flow analysis and DR readiness",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Monitoring and Alerting",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.NetworkFunction/azureTrafficCollectors",
            "recommendationTypeId": null,
            "service": "ExpressRoute Traffic Collector",
            "severity": "Medium",
            "source": "azure-resources/NetworkFunction/azureTrafficCollectors/recommendations.yaml",
            "tags": null,
            "text": "Ensure ExpressRoute Traffic Collector is enabled and configured for ExpressRoute Direct circuits"
        },
        {
            "aprlGuid": "b36fd2ac-dd83-664a-ab48-ff7b8d3b189d",
            "automationAvailable": false,
            "category": "Governance",
            "description": "Data export in a Log Analytics workspace to an Azure Storage account enhances data protection against regional failures by using geo-redundant (GRS) or geo-zone-redundant storage (GZRS), mainly for compliance and integration with other Azure services and tools.\n",
            "graph": "// cannot-be-validated-with-arg\n\n",
            "guid": "b36fd2ac-dd83-664a-ab48-ff7b8d3b189d",
            "learnMoreLink": [
                {
                    "name": "Log Analytics workspace data export in Azure Monitor",
                    "url": "https://learn.microsoft.com/azure/azure-monitor/logs/logs-data-export"
                },
                {
                    "name": "Azure Monitor configuration recommendations",
                    "url": "https://learn.microsoft.com/azure/azure-monitor/best-practices-logs#configuration-recommendations"
                }
            ],
            "longDescription": "Data export in a Log Analytics workspace to an Azure Storage account enhances data protection against regional failures by using geo-redundant (GRS) or geo-zone-redundant storage (GZRS), mainly for compliance and integration with other Azure services and tools.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhances compliance and regional fault tolerance",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Governance",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.OperationalInsights/workspaces",
            "recommendationTypeId": null,
            "service": "Microsoft.OperationalInsights/workspaces",
            "severity": "Medium",
            "source": "azure-resources/OperationalInsights/workspaces/recommendations.yaml",
            "tags": null,
            "text": "Enable Log Analytics data export to GRS or GZRS"
        },
        {
            "aprlGuid": "4b77191c-cc3c-8c4e-844b-0f56d0927890",
            "automationAvailable": false,
            "category": "Monitoring and Alerting",
            "description": "A health status alert will proactively notify you if a workspace becomes unavailable because of a datacenter or regional failure.\n",
            "graph": "// cannot-be-validated-with-arg\n\n",
            "guid": "4b77191c-cc3c-8c4e-844b-0f56d0927890",
            "learnMoreLink": [
                {
                    "name": "Monitor Log Analytics workspace health",
                    "url": "https://learn.microsoft.com/azure/azure-monitor/logs/log-analytics-workspace-health"
                },
                {
                    "name": "Azure Monitor configuration recommendations",
                    "url": "https://learn.microsoft.com/azure/azure-monitor/best-practices-logs#configuration-recommendations"
                }
            ],
            "longDescription": "A health status alert will proactively notify you if a workspace becomes unavailable because of a datacenter or regional failure.\n",
            "pgVerified": true,
            "potentialBenefits": "Early alert for workspace failure",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Monitoring and Alerting",
            "recommendationImpact": "Low",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.OperationalInsights/workspaces",
            "recommendationTypeId": null,
            "service": "Microsoft.OperationalInsights/workspaces",
            "severity": "Low",
            "source": "azure-resources/OperationalInsights/workspaces/recommendations.yaml",
            "tags": null,
            "text": "Create a health status alert rule for your Log Analytics workspace"
        },
        {
            "aprlGuid": "e93bb813-b356-48f3-9bdf-a06a0a6ba039",
            "automationAvailable": false,
            "category": "Disaster Recovery",
            "description": "Ensure VM failover settings' static IP addresses are available in the failover subnet to maintain consistent IP assignment during failover, with the target VM receiving the same static IP if it's available or the next available IP otherwise. IP adjustments can be made in VM Network settings.\n",
            "graph": "// cannot-be-validated-with-arg\n\n",
            "guid": "e93bb813-b356-48f3-9bdf-a06a0a6ba039",
            "learnMoreLink": [
                {
                    "name": "Setup network mapping for site recovery",
                    "url": "https://learn.microsoft.com/en-us/azure/site-recovery/azure-to-azure-network-mapping#set-up-ip-addressing-for-target-vms"
                }
            ],
            "longDescription": "Ensure VM failover settings' static IP addresses are available in the failover subnet to maintain consistent IP assignment during failover, with the target VM receiving the same static IP if it's available or the next available IP otherwise. IP adjustments can be made in VM Network settings.\n",
            "pgVerified": true,
            "potentialBenefits": "Smooth failover IP management",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Disaster Recovery",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.RecoveryServices/vaults",
            "recommendationTypeId": null,
            "service": "Site Recovery",
            "severity": "High",
            "source": "azure-resources/RecoveryServices/vaults/recommendations.yaml",
            "tags": null,
            "text": "Ensure static IP addresses in Site Recovery VM failover settings are available in failover subnet"
        },
        {
            "aprlGuid": "17e877f7-3a89-4205-8a24-0670de54ddcd",
            "automationAvailable": "arg",
            "category": "Disaster Recovery",
            "description": "Perform a test failover to validate your BCDR strategy and ensure that your applications are functioning correctly in the target region without impacting your production environment. Test your Disaster Recovery plan periodically without any data loss or downtime, using test failovers.\n",
            "graph": "// Azure Resource Graph Query\n// Find all VMs where replication has been enabled but Test Failover was never performed\nrecoveryservicesresources\n| where type == \"microsoft.recoveryservices/vaults/replicationfabrics/replicationprotectioncontainers/replicationprotecteditems\"\n| where properties.providerSpecificDetails.dataSourceInfo.datasourceType == 'AzureVm' and isnull(properties.lastSuccessfulTestFailoverTime)\n| project recommendationId=\"17e877f7-3a89-4205-8a24-0670de54ddcd\" , name = properties.providerSpecificDetails.recoveryAzureVMName, id=properties.providerSpecificDetails.dataSourceInfo.resourceId\n\n",
            "guid": "17e877f7-3a89-4205-8a24-0670de54ddcd",
            "learnMoreLink": [
                {
                    "name": "Run a test failover",
                    "url": "https://learn.microsoft.com/en-us/azure/site-recovery/azure-to-azure-tutorial-dr-drill#run-a-test-failover"
                }
            ],
            "longDescription": "Perform a test failover to validate your BCDR strategy and ensure that your applications are functioning correctly in the target region without impacting your production environment. Test your Disaster Recovery plan periodically without any data loss or downtime, using test failovers.\n",
            "pgVerified": true,
            "potentialBenefits": "Ensures BCDR plan accuracy and VM performance",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Disaster Recovery",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.RecoveryServices/vaults",
            "recommendationTypeId": null,
            "service": "Site Recovery",
            "severity": "High",
            "source": "azure-resources/RecoveryServices/vaults/recommendations.yaml",
            "tags": null,
            "text": "Validate VM functionality with a Site Recovery test failover to check performance at target"
        },
        {
            "aprlGuid": "2912472d-0198-4bdc-aa90-37f145790edc",
            "automationAvailable": "arg",
            "category": "Monitoring and Alerting",
            "description": "Classic alerts for Recovery Services vaults in Azure Backup will be retired on 31 March 2026.\n",
            "graph": "// Azure Resource Graph Query\n// This Resource Graph query will return all Recovery services vault with Classic alerts enabled.\nresources\n| where type in~ ('microsoft.recoveryservices/vaults')\n| extend monitoringSettings = parse_json(properties).monitoringSettings\n| extend isUsingClassicAlerts = case(isnull(monitoringSettings),'Enabled',monitoringSettings.classicAlertSettings.alertsForCriticalOperations)\n| extend isUsingJobsAlerts = case(isnull(monitoringSettings), 'Enabled', monitoringSettings.azureMonitorAlertSettings.alertsForAllJobFailures)\n| where isUsingClassicAlerts == 'Enabled'\n| project recommendationId = \"2912472d-0198-4bdc-aa90-37f145790edc\", name, id, tags, param1=strcat(\"isUsingClassicAlerts: \", isUsingClassicAlerts), param2=strcat(\"isUsingJobsAlerts: \", isUsingJobsAlerts)\n\n",
            "guid": "2912472d-0198-4bdc-aa90-37f145790edc",
            "learnMoreLink": [
                {
                    "name": "Move to Azure monitor Alerts",
                    "url": "https://learn.microsoft.com/azure/backup/move-to-azure-monitor-alerts"
                },
                {
                    "name": "Classic alerts retirement announcement",
                    "url": "https://azure.microsoft.com/updates/transition-to-builtin-azure-monitor-alerts-for-recovery-services-vaults-in-azure-backup-by-31-march-2026/"
                }
            ],
            "longDescription": "Classic alerts for Recovery Services vaults in Azure Backup will be retired on 31 March 2026.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhanced, scalable, and consistent alerting.",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Monitoring and Alerting",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.RecoveryServices/vaults",
            "recommendationTypeId": "06578866-1877-41e6-9d22-3ea5122e8048",
            "service": "Site Recovery",
            "severity": "Medium",
            "source": "azure-resources/RecoveryServices/vaults/recommendations.yaml",
            "tags": null,
            "text": "Migrate from classic alerts to built-in Azure Monitor alerts for Azure Recovery Services Vaults"
        },
        {
            "aprlGuid": "1549b91f-2ea0-4d4f-ba2a-4596becbe3de",
            "automationAvailable": "arg",
            "category": "Disaster Recovery",
            "description": "Cross Region Restore enables the restoration of Azure VMs in a secondary, Azure paired region, facilitating drills for audit or compliance and allowing recovery of VMs or disks in the event of a primary region disaster. It is an opt-in feature available exclusively for GRS vaults.\n",
            "graph": "// Azure Resource Graph Query\n// Displays all recovery services vaults that do not have cross region restore enabled\nresources\n| where type =~ \"Microsoft.RecoveryServices/vaults\" and\n    properties.redundancySettings.standardTierStorageRedundancy =~ \"GeoRedundant\" and\n    properties.redundancySettings.crossRegionRestore !~ \"Enabled\"\n| extend\n    param1 = strcat(\"CrossRegionRestore: \", properties.redundancySettings.crossRegionRestore),\n    param2 = strcat(\"StorageReplicationType: \", properties.redundancySettings.standardTierStorageRedundancy)\n| project recommendationId = \"1549b91f-2ea0-4d4f-ba2a-4596becbe3de\", name, id, tags, param1, param2\n",
            "guid": "1549b91f-2ea0-4d4f-ba2a-4596becbe3de",
            "learnMoreLink": [
                {
                    "name": "Set Cross Region Restore",
                    "url": "https://learn.microsoft.com/azure/backup/backup-create-recovery-services-vault#set-cross-region-restore"
                },
                {
                    "name": "Azure Backup Best Practices",
                    "url": "https://learn.microsoft.com/azure/backup/guidance-best-practices"
                },
                {
                    "name": "Minimum Role Requirements for Cross Region Restore",
                    "url": "https://learn.microsoft.com/azure/backup/backup-rbac-rs-vault#minimum-role-requirements-for-azure-vm-backup"
                },
                {
                    "name": "Recovery Services Vault",
                    "url": "https://learn.microsoft.com/azure/backup/backup-azure-arm-vms-prepare"
                }
            ],
            "longDescription": "Cross Region Restore enables the restoration of Azure VMs in a secondary, Azure paired region, facilitating drills for audit or compliance and allowing recovery of VMs or disks in the event of a primary region disaster. It is an opt-in feature available exclusively for GRS vaults.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhances disaster recovery capabilities",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Disaster Recovery",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.RecoveryServices/vaults",
            "recommendationTypeId": "9b1308f1-4c25-4347-a061-7cc5cd6a44ab",
            "service": "Site Recovery",
            "severity": "Medium",
            "source": "azure-resources/RecoveryServices/vaults/recommendations.yaml",
            "tags": null,
            "text": "Enable Cross Region Restore for your GRS Recovery Services Vault"
        },
        {
            "aprlGuid": "9e39919b-78af-4a0b-b70f-c548dae97c25",
            "automationAvailable": "arg",
            "category": "Disaster Recovery",
            "description": "With soft delete, if backup data is deleted, the backup data is retained for 14 additional days, allowing the recovery of that backup item with no data loss with no cost to you. Soft delete is enabled by default. Disabling this feature isn't recommended.\n",
            "graph": "// Azure Resource Graph Query\n// Find all Azure Recovery Services vaults that do not have soft delete  enabled\nresources\n| where type == \"microsoft.recoveryservices/vaults\"\n| mv-expand issoftDelete=properties.securitySettings.softDeleteSettings.softDeleteState\n| where issoftDelete == 'Disabled'\n| project recommendationId = \"9e39919b-78af-4a0b-b70f-c548dae97c25\", name, id, tags, param1=strcat(\"Soft Delete: \",issoftDelete)\n",
            "guid": "9e39919b-78af-4a0b-b70f-c548dae97c25",
            "learnMoreLink": [
                {
                    "name": "Soft Delete for Azure Backup",
                    "url": "https://learn.microsoft.com/azure/backup/backup-azure-security-feature-cloud?tabs=azure-portal"
                }
            ],
            "longDescription": "With soft delete, if backup data is deleted, the backup data is retained for 14 additional days, allowing the recovery of that backup item with no data loss with no cost to you. Soft delete is enabled by default. Disabling this feature isn't recommended.\n",
            "pgVerified": false,
            "potentialBenefits": "Enhances disaster recovery capabilities",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Disaster Recovery",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.RecoveryServices/vaults",
            "recommendationTypeId": null,
            "service": "Site Recovery",
            "severity": "Medium",
            "source": "azure-resources/RecoveryServices/vaults/recommendations.yaml",
            "tags": null,
            "text": "Enable Soft Delete for Recovery Services Vaults in Azure Backup"
        },
        {
            "aprlGuid": "98bd7098-49d6-491b-86f1-b143d6b1a0ff",
            "automationAvailable": "arg",
            "category": "Disaster Recovery",
            "description": "Ensure resource locations align with their resource group to manage resources during regional outages. ARM stores resource data, which if in an unavailable region, could halt updates, rendering resources read-only.\n",
            "graph": "// Azure Resource Graph Query\n// Provides a list of Azure Resource Groups that have resources deployed in a region different than the Resource Group region\nresources\n| project id, name, tags, resourceGroup, location\n| where location != \"global\"                                                                                                          // exclude global resources\n| where resourceGroup != \"networkwatcherrg\"                                                                                           // exclude networkwatcherrg\n| where split(id, \"/\", 3)[0] =~ \"resourceGroups\"                                                                                      // resource is in a resource group\n| extend resourceGroupId = strcat_array(array_slice(split(id, \"/\"),0,4), \"/\")                                                         // create resource group resource id\n| join (resourcecontainers | project containerid=id, containerlocation=location ) on $left.resourceGroupId == $right.['containerid']  // join to resourcecontainers table\n| where  location != containerlocation\n| project recommendationId=\"98bd7098-49d6-491b-86f1-b143d6b1a0ff\", name, id, tags\n| order by id asc\n\n",
            "guid": "98bd7098-49d6-491b-86f1-b143d6b1a0ff",
            "learnMoreLink": [
                {
                    "name": "Azure Resource Manager Overview",
                    "url": "https://learn.microsoft.com/en-us/azure/azure-resource-manager/management/overview#resource-group-location-alignment"
                }
            ],
            "longDescription": "Ensure resource locations align with their resource group to manage resources during regional outages. ARM stores resource data, which if in an unavailable region, could halt updates, rendering resources read-only.\n",
            "pgVerified": true,
            "potentialBenefits": "Improves outage management",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Disaster Recovery",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Resources/resourceGroups",
            "recommendationTypeId": null,
            "service": "Microsoft.Resources/resourceGroups",
            "severity": "High",
            "source": "azure-resources/Resources/resourceGroups/recommendations.yaml",
            "tags": null,
            "text": "Ensure Resource Group and its Resources are located in the same Region"
        },
        {
            "aprlGuid": "20057905-262c-49fe-a9be-49f423afb359",
            "automationAvailable": "arg",
            "category": "High Availability",
            "description": "Use Service Bus with zone redundancy for high availability. The Premium SKU supports availability zones, ensuring isolation within the same region. It manages 3 copies of the messaging store, kept in sync.\n",
            "graph": "// Azure Resource Graph Query\n// Returns Service Bus namespaces that do not have any availability zones enabled\nresources\n| where type =~ 'Microsoft.ServiceBus/namespaces'\n| where properties.zoneRedundant == 'false'\n| project recommendationId = \"20057905-262c-49fe-a9be-49f423afb359\", name, id, tags, param1=strcat(\"zoneRedundant: \", properties.zoneRedundant), param2=strcat(\"SKU: \", sku.name), param3=iff(tolower(sku.name) == 'premium', 'Move Service Bus namespace to a region that supports Availability Zones', 'Migrate to Premium SKU in a region that supports Availability Zones')\n\n",
            "guid": "20057905-262c-49fe-a9be-49f423afb359",
            "learnMoreLink": [
                {
                    "name": "Service Bus and reliability",
                    "url": "https://learn.microsoft.com/en-us/azure/well-architected/services/messaging/service-bus/reliability"
                },
                {
                    "name": "Azure Service Bus Geo-disaster recovery",
                    "url": "https://learn.microsoft.com/en-us/azure/service-bus-messaging/service-bus-geo-dr#availability-zones"
                },
                {
                    "name": "Insulate Azure Service Bus applications against outages and disasters",
                    "url": "https://learn.microsoft.com/en-us/azure/service-bus-messaging/service-bus-outages-disasters"
                }
            ],
            "longDescription": "Use Service Bus with zone redundancy for high availability. The Premium SKU supports availability zones, ensuring isolation within the same region. It manages 3 copies of the messaging store, kept in sync.\n",
            "pgVerified": false,
            "potentialBenefits": "Enhances fault tolerance and uptime",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.ServiceBus/namespaces",
            "recommendationTypeId": null,
            "service": "Service Bus",
            "severity": "High",
            "source": "azure-resources/ServiceBus/namespaces/recommendations.yaml",
            "tags": null,
            "text": "Enable Availability Zones for Service Bus namespaces"
        },
        {
            "aprlGuid": "d810e3a8-600f-4be1-895b-1a93e61d37fd",
            "automationAvailable": false,
            "category": "High Availability",
            "description": "Use Service Bus with auto-scale for high availability. The Premium SKU supports auto-scale, ensuring that the resources are automatically scaled based on the load.\n",
            "graph": "// cannot-be-validated-with-arg\n",
            "guid": "d810e3a8-600f-4be1-895b-1a93e61d37fd",
            "learnMoreLink": [
                {
                    "name": "Service Bus auto-scaling",
                    "url": "https://learn.microsoft.com/azure/service-bus-messaging/automate-update-messaging-units"
                }
            ],
            "longDescription": "Use Service Bus with auto-scale for high availability. The Premium SKU supports auto-scale, ensuring that the resources are automatically scaled based on the load.\n",
            "pgVerified": false,
            "potentialBenefits": "Ensures high availability and performance",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.ServiceBus/namespaces",
            "recommendationTypeId": null,
            "service": "Service Bus",
            "severity": "High",
            "source": "azure-resources/ServiceBus/namespaces/recommendations.yaml",
            "tags": null,
            "text": "Enable auto-scale for production workloads on Service Bus namespaces"
        },
        {
            "aprlGuid": "6a8b3db9-5773-413a-a127-4f7032f34bbd",
            "automationAvailable": "arg",
            "category": "High Availability",
            "description": "Use SignalR with zone redundancy for production to improve uptime. This feature, available in the Premium tier, is activated upon creating or upgrading to Premium. Standard can upgrade to Premium without downtime.\n",
            "graph": "// Azure Resource Graph Query\n// Find SignalR instances that are not configured with the Premium tier\nresources\n| where type == \"microsoft.signalrservice/signalr\"\n| where sku.tier != \"Premium\"\n| project recommendationId = \"6a8b3db9-5773-413a-a127-4f7032f34bbd\", name, id, tags, param1 = \"AvailabilityZones: Single Zone\"\n| order by id asc\n\n",
            "guid": "6a8b3db9-5773-413a-a127-4f7032f34bbd",
            "learnMoreLink": [
                {
                    "name": "Availability zones support in Azure SignalR Service",
                    "url": "https://learn.microsoft.com/azure/azure-signalr/availability-zones"
                }
            ],
            "longDescription": "Use SignalR with zone redundancy for production to improve uptime. This feature, available in the Premium tier, is activated upon creating or upgrading to Premium. Standard can upgrade to Premium without downtime.\n",
            "pgVerified": false,
            "potentialBenefits": "Enhances reliability and uptime",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.SignalRService/SignalR",
            "recommendationTypeId": null,
            "service": "Microsoft.SignalRService/SignalR",
            "severity": "High",
            "source": "azure-resources/SignalRService/signalR/recommendations.yaml",
            "tags": null,
            "text": "Enable zone redundancy for SignalR"
        },
        {
            "aprlGuid": "74c2491d-048b-0041-a140-935960220e20",
            "automationAvailable": "arg",
            "category": "Disaster Recovery",
            "description": "Active Geo Replication ensures business continuity by utilizing readable secondary database replicas. In case of primary database failure, manually failover to secondary database. Secondaries, up to four, can be in same/different regions, used for read-only access.\n",
            "graph": "// Azure Resource Graph Query\n// Provides a list of SQL databases that are not part of Geo Replication.\nresources\n| where type == \"microsoft.sql/servers/databases\"\n| summarize secondaryTypeCount = countif(isnotempty(properties.secondaryType)) by name\n| where secondaryTypeCount == 0\n| join kind=inner (\n    Resources\n    | where type == \"microsoft.sql/servers/databases\"\n) on name\n| extend param1 = \"Not part of Geo Replication\"\n| project recommendationId = \"74c2491d-048b-0041-a140-935960220e20\", name, id, tags, param1\n",
            "guid": "74c2491d-048b-0041-a140-935960220e20",
            "learnMoreLink": [
                {
                    "name": "Active Geo Replication",
                    "url": "https://learn.microsoft.com/en-us/azure/azure-sql/database/active-geo-replication-overview"
                }
            ],
            "longDescription": "Active Geo Replication ensures business continuity by utilizing readable secondary database replicas. In case of primary database failure, manually failover to secondary database. Secondaries, up to four, can be in same/different regions, used for read-only access.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhanced disaster recovery and read scalability",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Disaster Recovery",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Sql/servers",
            "recommendationTypeId": "2ea11bcb-dfd0-48dc-96f0-beba578b989a",
            "service": "Azure SQL",
            "severity": "High",
            "source": "azure-resources/Sql/servers/recommendations.yaml",
            "tags": null,
            "text": "Use Active Geo Replication to Create a Readable Secondary in Another Region"
        },
        {
            "aprlGuid": "943c168a-2ec2-a94c-8015-85732a1b4859",
            "automationAvailable": "arg",
            "category": "Disaster Recovery",
            "description": "Failover Groups facilitate disaster recovery by configuring databases on one logical server to replicate to another region's logical server. This streamlines geo-replicated database management, offering a single endpoint for connection routing to replicated databases if the primary server fails.\n",
            "graph": "// Azure Resource Graph Query\n// Provides a list of SQL databases that are not configured to use a failover-group.\nresources\n| where type =~'microsoft.sql/servers/databases'\n| where isnull(properties['failoverGroupId'])\n| project recommendationId = \"943c168a-2ec2-a94c-8015-85732a1b4859\", name, id, tags, param1= strcat(\"databaseId=\", properties['databaseId'])\n",
            "guid": "943c168a-2ec2-a94c-8015-85732a1b4859",
            "learnMoreLink": [
                {
                    "name": "AutoFailover Groups",
                    "url": "https://learn.microsoft.com/en-us/azure/azure-sql/database/auto-failover-group-overview?tabs=azure-powershell"
                },
                {
                    "name": "DR Design",
                    "url": "https://learn.microsoft.com/en-us/azure/azure-sql/database/designing-cloud-solutions-for-disaster-recovery"
                }
            ],
            "longDescription": "Failover Groups facilitate disaster recovery by configuring databases on one logical server to replicate to another region's logical server. This streamlines geo-replicated database management, offering a single endpoint for connection routing to replicated databases if the primary server fails.\n",
            "pgVerified": true,
            "potentialBenefits": "Improves load balancing and disaster recovery",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Disaster Recovery",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Sql/servers",
            "recommendationTypeId": null,
            "service": "Azure SQL",
            "severity": "High",
            "source": "azure-resources/Sql/servers/recommendations.yaml",
            "tags": null,
            "text": "Auto Failover Groups can encompass one or multiple databases, usually used by the same app."
        },
        {
            "aprlGuid": "c0085c32-84c0-c247-bfa9-e70977cbf108",
            "automationAvailable": "arg",
            "category": "High Availability",
            "description": "By default, Azure SQL Database premium tier provisions multiple copies within the same region. For geo redundancy, databases can be set as Zone Redundant, distributing copies across Azure Availability Zones to maintain availability during regional outages.\n",
            "graph": "// Azure Resource Graph Query\n// Finds non-zone redundant SQL databases and lists them\nResources\n| where type =~ 'microsoft.sql/servers/databases'\n| where tolower(tostring(properties.zoneRedundant))=~'false'\n|project recommendationId = \"c0085c32-84c0-c247-bfa9-e70977cbf108\", name, id, tags\n\n\n",
            "guid": "c0085c32-84c0-c247-bfa9-e70977cbf108",
            "learnMoreLink": [
                {
                    "name": "Zone Redundant Databases",
                    "url": "https://learn.microsoft.com/en-us/azure/azure-sql/database/high-availability-sla"
                }
            ],
            "longDescription": "By default, Azure SQL Database premium tier provisions multiple copies within the same region. For geo redundancy, databases can be set as Zone Redundant, distributing copies across Azure Availability Zones to maintain availability during regional outages.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhanced reliability, no extra cost",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Sql/servers",
            "recommendationTypeId": "807e58d0-e385-41ad-987b-4a4b3e3fb563",
            "service": "Azure SQL",
            "severity": "Medium",
            "source": "azure-resources/Sql/servers/recommendations.yaml",
            "tags": null,
            "text": "Enable zone redundancy for Azure SQL Database to achieve high availability and resiliency"
        },
        {
            "aprlGuid": "cbb17a29-64fb-c943-95d0-8df814a37c40",
            "automationAvailable": false,
            "category": "High Availability",
            "description": "During transient failures, the application should handle connection retries effectively with Azure SQL Database. No Database layer configuration is needed; instead, the application must be set up for graceful retrying.\n",
            "graph": "// cannot-be-validated-with-arg\n\n",
            "guid": "cbb17a29-64fb-c943-95d0-8df814a37c40",
            "learnMoreLink": [
                {
                    "name": "How to Implement Retry Logic",
                    "url": "https://learn.microsoft.com/en-us/azure/azure-sql/database/troubleshoot-common-connectivity-issues"
                }
            ],
            "longDescription": "During transient failures, the application should handle connection retries effectively with Azure SQL Database. No Database layer configuration is needed; instead, the application must be set up for graceful retrying.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhanced connectivity stability",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Sql/servers",
            "recommendationTypeId": null,
            "service": "Azure SQL",
            "severity": "High",
            "source": "azure-resources/Sql/servers/recommendations.yaml",
            "tags": null,
            "text": "Implement Retry Logic"
        },
        {
            "aprlGuid": "7e7daec9-6a81-3546-a4cc-9aef72fec1f7",
            "automationAvailable": "arg",
            "category": "Monitoring and Alerting",
            "description": "Monitoring and alerting are an important part of database operations. When working with Azure SQL Database, make use of Azure Monitor and SQL Insights to ensure that you capture relevant database metrics.\n",
            "graph": "// Azure Resource Graph Query\n// Provides a list of SQL databases that are not configured for monitoring.\nresources\n| where type == \"microsoft.insights/metricalerts\"\n| mv-expand properties.scopes\n| mv-expand properties.criteria.allOf\n| project databaseid = properties_scopes, monitoredMetric = properties_criteria_allOf.metricName\n| where databaseid contains 'databases'\n| summarize monitoredMetrics=make_list(monitoredMetric) by databaseid=tolower(tostring(databaseid))\n| join kind=fullouter   (\n  resources\n  | where type =~ 'microsoft.sql/servers/databases'\n  | project databaseid = tolower(id), name, tags\n) on databaseid\n| where isnull(monitoredMetrics)\n| project recommendationId = \"7e7daec9-6a81-3546-a4cc-9aef72fec1f7\", name, id=databaseid1, tags, param1=strcat(\"MonitoringMetrics=false\" )\n\n",
            "guid": "7e7daec9-6a81-3546-a4cc-9aef72fec1f7",
            "learnMoreLink": [
                {
                    "name": "Azure Monitor",
                    "url": "https://learn.microsoft.com/en-us/azure/azure-monitor/insights/azure-sql#analyze-data-and-create-alerts"
                },
                {
                    "name": "Azure SQL Database Monitoring",
                    "url": "https://learn.microsoft.com/en-us/azure/azure-sql/database/monitoring-sql-database-azure-monitor"
                },
                {
                    "name": "Monitoring SQL Database Reference",
                    "url": "https://learn.microsoft.com/en-us/azure/azure-sql/database/monitoring-sql-database-azure-monitor-reference"
                }
            ],
            "longDescription": "Monitoring and alerting are an important part of database operations. When working with Azure SQL Database, make use of Azure Monitor and SQL Insights to ensure that you capture relevant database metrics.\n",
            "pgVerified": true,
            "potentialBenefits": "Quick incident detection and response",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Monitoring and Alerting",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Sql/servers",
            "recommendationTypeId": null,
            "service": "Azure SQL",
            "severity": "High",
            "source": "azure-resources/Sql/servers/recommendations.yaml",
            "tags": null,
            "text": "Monitor your Azure SQL Database in Near Real-Time to Detect Reliability Incidents"
        },
        {
            "aprlGuid": "d6ef87aa-574e-584e-a955-3e6bb8b5425b",
            "automationAvailable": false,
            "category": "Disaster Recovery",
            "description": "It is highly recommended to use Azure Key Vault (AKV) to store encryption keys related to Always Encrypted configurations, however it is not required. If you are not using AKV, then ensure that your keys are properly backed up and stored in a secure manner.\n",
            "graph": "// cannot-be-validated-with-arg\n\n",
            "guid": "d6ef87aa-574e-584e-a955-3e6bb8b5425b",
            "learnMoreLink": [
                {
                    "name": "Azure Key Vault",
                    "url": "https://learn.microsoft.com/en-us/azure/key-vault/general/overview"
                },
                {
                    "name": "Getting Started with Always Encrypted",
                    "url": "https://learn.microsoft.com/en-us/azure/azure-sql/database/always-encrypted-landing?view=azuresql"
                }
            ],
            "longDescription": "It is highly recommended to use Azure Key Vault (AKV) to store encryption keys related to Always Encrypted configurations, however it is not required. If you are not using AKV, then ensure that your keys are properly backed up and stored in a secure manner.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhanced security and data recovery",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Disaster Recovery",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Sql/servers",
            "recommendationTypeId": null,
            "service": "Azure SQL",
            "severity": "Medium",
            "source": "azure-resources/Sql/servers/recommendations.yaml",
            "tags": null,
            "text": "Back Up Your Keys"
        },
        {
            "aprlGuid": "e6c7e1cc-2f47-264d-aa50-1da421314472",
            "automationAvailable": "arg",
            "category": "High Availability",
            "description": "Redundancy ensures storage accounts meet availability and durability targets amidst failures, weighing lower costs against higher availability. Locally redundant storage offers the least durability at the lowest cost.\n",
            "graph": "// Azure Resource Graph Query\n// This query will return all storage accounts that are not using Zone or Region replication\nResources\n| where type =~ \"Microsoft.Storage/storageAccounts\"\n| where sku.name in~ (\"Standard_LRS\", \"Premium_LRS\")\n| project recommendationId = \"e6c7e1cc-2f47-264d-aa50-1da421314472\", name, id, tags, param1 = strcat(\"sku: \", sku.name)\n\n",
            "guid": "e6c7e1cc-2f47-264d-aa50-1da421314472",
            "learnMoreLink": [
                {
                    "name": "Azure Storage redundancy",
                    "url": "https://learn.microsoft.com/azure/storage/common/storage-redundancy"
                },
                {
                    "name": "Change the redundancy configuration for a storage account",
                    "url": "https://learn.microsoft.com/azure/storage/common/redundancy-migration"
                }
            ],
            "longDescription": "Redundancy ensures storage accounts meet availability and durability targets amidst failures, weighing lower costs against higher availability. Locally redundant storage offers the least durability at the lowest cost.\n",
            "pgVerified": true,
            "potentialBenefits": "High availability and durability for storage",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Storage/storageAccounts",
            "recommendationTypeId": null,
            "service": "Storage",
            "severity": "High",
            "source": "azure-resources/Storage/storageAccounts/recommendations.yaml",
            "tags": null,
            "text": "Ensure that storage accounts are zone or region redundant"
        },
        {
            "aprlGuid": "63ad027e-611c-294b-acc5-8e3234db9a40",
            "automationAvailable": "arg",
            "category": "Service Upgrade and Retirement",
            "description": "Classic storage accounts will be fully retired on August 31, 2024. If you have classic storage accounts, start planning your migration now.\n",
            "graph": "// Azure Resource Graph Query\n// Find all Azure classic Storage Account\nresources\n| where type =~ 'microsoft.classicstorage/storageaccounts'\n| project recommendationId = '63ad027e-611c-294b-acc5-8e3234db9a40', name, id, tags, param1=type\n\n",
            "guid": "63ad027e-611c-294b-acc5-8e3234db9a40",
            "learnMoreLink": [
                {
                    "name": "Azure classic storage accounts retirement announcement",
                    "url": "https://azure.microsoft.com/updates/classic-azure-storage-accounts-will-be-retired-on-31-august-2024/"
                },
                {
                    "name": "Migrate your classic storage accounts to Azure Resource Manager",
                    "url": "https://learn.microsoft.com/azure/storage/common/classic-account-migration-overview"
                }
            ],
            "longDescription": "Classic storage accounts will be fully retired on August 31, 2024. If you have classic storage accounts, start planning your migration now.\n",
            "pgVerified": true,
            "potentialBenefits": "Avoids service retirement issues",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Service Upgrade and Retirement",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Storage/storageAccounts",
            "recommendationTypeId": "47bb383c-8e25-95f0-c2aa-437add1d87d3",
            "service": "Storage",
            "severity": "High",
            "source": "azure-resources/Storage/storageAccounts/recommendations.yaml",
            "tags": null,
            "text": "Classic Storage Accounts must be migrated to new Azure Resource Manager resources"
        },
        {
            "aprlGuid": "5587ef77-7a05-a74d-9c6e-449547a12f27",
            "automationAvailable": false,
            "category": "Scalability",
            "description": "Use premium performance block blob storage instead of standard performance storage for workloads that require fast storage response times and/or high transaction rates.\n",
            "graph": "// cannot-be-validated-with-arg\n\n",
            "guid": "5587ef77-7a05-a74d-9c6e-449547a12f27",
            "learnMoreLink": [
                {
                    "name": "Types of storage accounts",
                    "url": "https://learn.microsoft.com/azure/storage/common/storage-account-overview#types-of-storage-accounts"
                },
                {
                    "name": "Scalability and performance targets for standard storage accounts",
                    "url": "https://learn.microsoft.com/azure/storage/common/scalability-targets-standard-account"
                },
                {
                    "name": "Performance and scalability checklist for Blob storage",
                    "url": "https://learn.microsoft.com/azure/storage/blobs/storage-performance-checklist"
                },
                {
                    "name": "Scalability and performance targets for Blob storage",
                    "url": "https://learn.microsoft.com/azure/storage/blobs/scalability-targets"
                },
                {
                    "name": "Premium block blob storage accounts",
                    "url": "https://learn.microsoft.com/azure/storage/blobs/storage-blob-block-blob-premium"
                }
            ],
            "longDescription": "Use premium performance block blob storage instead of standard performance storage for workloads that require fast storage response times and/or high transaction rates.\n",
            "pgVerified": true,
            "potentialBenefits": "Optimized cost and performance",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Scalability",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Storage/storageAccounts",
            "recommendationTypeId": "c6b94711-f1f5-4e7e-9c89-c17ed4190969",
            "service": "Storage",
            "severity": "Medium",
            "source": "azure-resources/Storage/storageAccounts/recommendations.yaml",
            "tags": null,
            "text": "Use premium performance block blob storage for high performance workloads"
        },
        {
            "aprlGuid": "03263c57-c869-3841-9e0a-3dbb9ef3e28d",
            "automationAvailable": false,
            "category": "Disaster Recovery",
            "description": "The soft delete option enables data recovery if mistakenly deleted, while the Lock feature prevents the accidental deletion of the storage account itself, ensuring additional security and data integrity measures.\n",
            "graph": "// under-development\n\n",
            "guid": "03263c57-c869-3841-9e0a-3dbb9ef3e28d",
            "learnMoreLink": [
                {
                    "name": "Soft delete detail docs",
                    "url": "https://learn.microsoft.com//azure/storage/blobs/soft-delete-blob-enable?tabs=azure-portal "
                }
            ],
            "longDescription": "The soft delete option enables data recovery if mistakenly deleted, while the Lock feature prevents the accidental deletion of the storage account itself, ensuring additional security and data integrity measures.\n",
            "pgVerified": true,
            "potentialBenefits": "Prevents accidental data/account loss",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Disaster Recovery",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Storage/storageAccounts",
            "recommendationTypeId": "42dbf883-9e4b-4f84-9da4-232b87c4b5e9",
            "service": "Storage",
            "severity": "Medium",
            "source": "azure-resources/Storage/storageAccounts/recommendations.yaml",
            "tags": null,
            "text": "Enable Soft Delete to protect your data"
        },
        {
            "aprlGuid": "8ebda7c0-e0e1-ed45-af59-2d7ea9a1c05d",
            "automationAvailable": false,
            "category": "Disaster Recovery",
            "description": "Consider enabling versioning for Azure Storage Accounts to recover from accidental modifications or deletions and manage blob operation latency. Microsoft advises maintaining fewer than 1000 versions per blob to optimize performance. Lifecycle management can help delete old versions automatically.\n",
            "graph": "// under-development\n\n",
            "guid": "8ebda7c0-e0e1-ed45-af59-2d7ea9a1c05d",
            "learnMoreLink": [
                {
                    "name": "Blob versioning",
                    "url": "https://learn.microsoft.com/azure/storage/blobs/versioning-overview "
                }
            ],
            "longDescription": "Consider enabling versioning for Azure Storage Accounts to recover from accidental modifications or deletions and manage blob operation latency. Microsoft advises maintaining fewer than 1000 versions per blob to optimize performance. Lifecycle management can help delete old versions automatically.\n",
            "pgVerified": true,
            "potentialBenefits": "Recover data, manage latency",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Disaster Recovery",
            "recommendationImpact": "Low",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Storage/storageAccounts",
            "recommendationTypeId": null,
            "service": "Storage",
            "severity": "Low",
            "source": "azure-resources/Storage/storageAccounts/recommendations.yaml",
            "tags": null,
            "text": "Enable versioning for accidental modification and keep the number of versions below 1000"
        },
        {
            "aprlGuid": "1b965cb9-7629-214e-b682-6bf6e450a100",
            "automationAvailable": false,
            "category": "Disaster Recovery",
            "description": "Consider enabling point-in-time restore for standard general purpose v2 accounts with flat namespace to protect against accidental deletion or corruption by restoring block blob data to an earlier state.\n",
            "graph": "// under-development\n\n",
            "guid": "1b965cb9-7629-214e-b682-6bf6e450a100",
            "learnMoreLink": [
                {
                    "name": "Point-in-time restore for block blobs",
                    "url": "https://learn.microsoft.com/azure/storage/blobs/point-in-time-restore-overview"
                },
                {
                    "name": "Perform a point-in-time restore on block blob data",
                    "url": "https://learn.microsoft.com/azure/storage/blobs/point-in-time-restore-manage?tabs=portal"
                }
            ],
            "longDescription": "Consider enabling point-in-time restore for standard general purpose v2 accounts with flat namespace to protect against accidental deletion or corruption by restoring block blob data to an earlier state.\n",
            "pgVerified": true,
            "potentialBenefits": "Protects data from loss/corruption",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Disaster Recovery",
            "recommendationImpact": "Low",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Storage/storageAccounts",
            "recommendationTypeId": null,
            "service": "Storage",
            "severity": "Low",
            "source": "azure-resources/Storage/storageAccounts/recommendations.yaml",
            "tags": null,
            "text": "Enable point-in-time restore for GPv2 accounts to safeguard against data loss"
        },
        {
            "aprlGuid": "96cb8331-6b06-8242-8ce8-4e2f665dc679",
            "automationAvailable": false,
            "category": "Monitoring and Alerting",
            "description": "For critical applications and business processes relying on Azure, monitoring and alerts are crucial. Resource logs are only stored after creating a diagnostic setting to route logs to specified locations, requiring selection of log categories to collect.\n",
            "graph": "// under-development\n\n",
            "guid": "96cb8331-6b06-8242-8ce8-4e2f665dc679",
            "learnMoreLink": [
                {
                    "name": "Monitor Azure Blob Storage",
                    "url": "https://learn.microsoft.com/azure/storage/blobs/monitor-blob-storage"
                },
                {
                    "name": "Best practices for monitoring Azure Blob Storage",
                    "url": "https://learn.microsoft.com/azure/storage/blobs/blob-storage-monitoring-scenarios"
                }
            ],
            "longDescription": "For critical applications and business processes relying on Azure, monitoring and alerts are crucial. Resource logs are only stored after creating a diagnostic setting to route logs to specified locations, requiring selection of log categories to collect.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhanced alerting and log analysis",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Monitoring and Alerting",
            "recommendationImpact": "Low",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Storage/storageAccounts",
            "recommendationTypeId": null,
            "service": "Storage",
            "severity": "Low",
            "source": "azure-resources/Storage/storageAccounts/recommendations.yaml",
            "tags": null,
            "text": "Monitor all blob storage accounts"
        },
        {
            "aprlGuid": "2ad78dec-5a4d-4a30-8fd1-8584335ad781",
            "automationAvailable": "arg",
            "category": "Scalability",
            "description": "General-purpose v2 accounts are recommended for most storage scenarios offering the latest features or the lowest per-gigabyte pricing. Legacy accounts like Standard general-purpose v1 and Blob Storage aren't advised by Microsoft but may fit specific scenarios.\n",
            "graph": "// Azure Resource Graph Query\n// Find all Azure Storage Accounts, that upgradeable to General purpose v2.\nResources\n| where type =~ \"Microsoft.Storage/storageAccounts\" and kind in~ (\"Storage\", \"BlobStorage\")\n| extend\n    param1 = strcat(\"AccountKind: \", case(kind =~ \"Storage\", \"Storage (general purpose v1)\", kind =~ \"BlobStorage\", \"BlobStorage\", kind)),\n    param2 = strcat(\"Performance: \", sku.tier),\n    param3 = strcat(\"Replication: \", sku.name)\n| project recommendationId = \"2ad78dec-5a4d-4a30-8fd1-8584335ad781\", name, id, tags, param1, param2, param3\n\n",
            "guid": "2ad78dec-5a4d-4a30-8fd1-8584335ad781",
            "learnMoreLink": [
                {
                    "name": "Legacy storage account types",
                    "url": "https://learn.microsoft.com/azure/storage/common/storage-account-overview#legacy-storage-account-types"
                },
                {
                    "name": "Upgrade to a general-purpose v2 storage account",
                    "url": "https://learn.microsoft.com/azure/storage/common/storage-account-upgrade"
                }
            ],
            "longDescription": "General-purpose v2 accounts are recommended for most storage scenarios offering the latest features or the lowest per-gigabyte pricing. Legacy accounts like Standard general-purpose v1 and Blob Storage aren't advised by Microsoft but may fit specific scenarios.\n",
            "pgVerified": true,
            "potentialBenefits": "Latest features, lowest cost",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Scalability",
            "recommendationImpact": "Low",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Storage/storageAccounts",
            "recommendationTypeId": null,
            "service": "Storage",
            "severity": "Low",
            "source": "azure-resources/Storage/storageAccounts/recommendations.yaml",
            "tags": null,
            "text": "Consider upgrading legacy storage accounts to v2 storage accounts"
        },
        {
            "aprlGuid": "dc55be60-6f8c-461e-a9d5-a3c7686ed94e",
            "automationAvailable": "arg",
            "category": "Security",
            "description": "Leverage Azure Private Link Service for secure access to Azure Storage and services via Private Endpoint in your VNet. Eliminate the need for public IPs, ensuring data privacy. Enjoy granular access control for enhanced security.\n",
            "graph": "// Azure Resource Graph Query\n// This resource graph query will return all storage accounts that does not have a Private Endpoint Connection or where a private endpoint exists but public access is enabled\nresources\n| where type =~ \"Microsoft.Storage/StorageAccounts\"\n| where isnull(properties.privateEndpointConnections) or properties.privateEndpointConnections[0].properties.provisioningState != (\"Succeeded\") or (isnull(properties.networkAcls) and properties.publicNetworkAccess == 'Enabled')\n| extend param1 = strcat('Private Endpoint: ', iif(isnotnull(properties.privateEndpointConnections),split(properties.privateEndpointConnections[0].properties.privateEndpoint.id,'/')[8],'No Private Endpoint'))\n| extend param2 = strcat('Access: ', iif(properties.publicNetworkAccess == 'Disabled', 'Public Access Disabled', iif(isnotnull(properties.networkAcls), 'NetworkACLs in place','Public Access Enabled')))\n| project recommendationId = \"dc55be60-6f8c-461e-a9d5-a3c7686ed94e\", name, id, tags, param1, param2\n",
            "guid": "dc55be60-6f8c-461e-a9d5-a3c7686ed94e",
            "learnMoreLink": [
                {
                    "name": "Learn More",
                    "url": "https://learn.microsoft.com/en-us/azure/architecture/example-scenario/wvd/windows-virtual-desktop#azure-virtual-desktop-limitations"
                },
                {
                    "name": "Private Link",
                    "url": "https://learn.microsoft.com/en-us/azure/well-architected/azure-virtual-desktop/networking#private-endpoints-private-link"
                }
            ],
            "longDescription": "Leverage Azure Private Link Service for secure access to Azure Storage and services via Private Endpoint in your VNet. Eliminate the need for public IPs, ensuring data privacy. Enjoy granular access control for enhanced security.\n",
            "pgVerified": true,
            "potentialBenefits": "Secure, private access to storage with no public IPs",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Security",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Storage/storageAccounts",
            "recommendationTypeId": null,
            "service": "Storage",
            "severity": "Medium",
            "source": "azure-resources/Storage/storageAccounts/recommendations.yaml",
            "tags": null,
            "text": "Enable Azure Private Link service for storage accounts"
        },
        {
            "aprlGuid": "c041d596-6c97-4c5f-b4b3-9cd37628f2e2",
            "automationAvailable": "arg",
            "category": "Governance",
            "description": "A Citrix Managed Azure subscription supports VMs with VDA for app/desktop delivery, excluding other machines like Cloud Connectors. When close to the limit, signaled by a dashboard notification, and with sufficient licenses, request another subscription. Can't exceed the given limits for catalogs.\n",
            "graph": "// Azure Resource Graph Query\n// Count VM instances with a tag that contains \"Citrix VDA\" and create output if that count is >2000 for each subscription.\n// The Citrix published limit is 2500. This query runs an 80% check.\n\nresources\n| where type == 'microsoft.compute/virtualmachines'\n| where tags contains 'Citrix VDA'\n| summarize VMs=count() by subscriptionId\n| where VMs > 2000\n| join (resourcecontainers| where type =='microsoft.resources/subscriptions' | project subname=name, subscriptionId) on subscriptionId\n| project recommendationId='c041d596-6c97-4c5f-b4b3-9cd37628f2e2', name= subname, id = subscriptionId, param1='Too many instances.', param2= VMs\n\n",
            "guid": "c041d596-6c97-4c5f-b4b3-9cd37628f2e2",
            "learnMoreLink": [
                {
                    "name": "Citrix Limits",
                    "url": "https://docs.citrix.com/en-us/citrix-daas-azure/limits"
                }
            ],
            "longDescription": "A Citrix Managed Azure subscription supports VMs with VDA for app/desktop delivery, excluding other machines like Cloud Connectors. When close to the limit, signaled by a dashboard notification, and with sufficient licenses, request another subscription. Can't exceed the given limits for catalogs.\n",
            "pgVerified": true,
            "potentialBenefits": "Avoids hitting limit, ensures reliability",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Governance",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Subscription/Subscriptions",
            "recommendationTypeId": null,
            "service": "Microsoft.Subscription/Subscriptions",
            "severity": "High",
            "source": "azure-resources/Subscription/subscriptions/recommendations.yaml",
            "tags": null,
            "text": "Do not create more than 2000 Citrix VDA servers per subscription"
        },
        {
            "aprlGuid": "5ada5ffa-7149-4e49-9fbf-e67be7c2594c",
            "automationAvailable": "arg",
            "category": "Governance",
            "description": "The root management group in Azure is designed for organizational hierarchy, allowing for all management groups and subscriptions to fold into it.\n",
            "graph": "// Azure Resource Graph Query\n// Provides a list of Azure Subscriptions that are placed under the Tenant Root Management Group\nresourcecontainers\n| where type == 'microsoft.resources/subscriptions'\n| extend mgParentSize = array_length(properties.managementGroupAncestorsChain)\n| where mgParentSize == 1\n| project recommendationId=\"5ada5ffa-7149-4e49-9fbf-e67be7c2594c\", name, id, tags\n\n",
            "guid": "5ada5ffa-7149-4e49-9fbf-e67be7c2594c",
            "learnMoreLink": [
                {
                    "name": "Management group recommendations",
                    "url": "https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/ready/landing-zone/design-area/resource-org-management-groups#management-group-recommendations"
                },
                {
                    "name": "Root management group for each directory",
                    "url": "https://learn.microsoft.com/en-us/azure/governance/management-groups/overview#root-management-group-for-each-directory"
                }
            ],
            "longDescription": "The root management group in Azure is designed for organizational hierarchy, allowing for all management groups and subscriptions to fold into it.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhanced security, compliance, and management",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Governance",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Subscription/Subscriptions",
            "recommendationTypeId": null,
            "service": "Microsoft.Subscription/Subscriptions",
            "severity": "Medium",
            "source": "azure-resources/Subscription/subscriptions/recommendations.yaml",
            "tags": null,
            "text": "Subscriptions should not be placed under the Tenant Root Management Group"
        },
        {
            "aprlGuid": "19b6df57-f6b5-3e4f-843a-273daa087cb0",
            "automationAvailable": false,
            "category": "High Availability",
            "description": "When building Image Templates, use sources for gen 2 VMs. Gen 2 offers more memory, supports >2TB disks, uses UEFI for faster boot/installation, has Intel SGX, and virtualized persistent memory (vPMEM), unlike gen 1's BIOS-based architecture.\n",
            "graph": "// under-development\n\n",
            "guid": "19b6df57-f6b5-3e4f-843a-273daa087cb0",
            "learnMoreLink": [
                {
                    "name": "Generation 1 vs generation 2 virtual machines",
                    "url": "https://learn.microsoft.com/en-us/azure/virtual-machines/generation-2#features-and-capabilities"
                }
            ],
            "longDescription": "When building Image Templates, use sources for gen 2 VMs. Gen 2 offers more memory, supports >2TB disks, uses UEFI for faster boot/installation, has Intel SGX, and virtualized persistent memory (vPMEM), unlike gen 1's BIOS-based architecture.\n",
            "pgVerified": true,
            "potentialBenefits": "More memory, supports >2TB disks, faster boot",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "Low",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.VirtualMachineImages/imageTemplates",
            "recommendationTypeId": null,
            "service": "VM",
            "severity": "Low",
            "source": "azure-resources/VirtualMachineImages/imageTemplates/recommendations.yaml",
            "tags": null,
            "text": "Use Generation 2 virtual machine source image"
        },
        {
            "aprlGuid": "21fb841b-ba70-1f4e-a460-1f72fb41aa51",
            "automationAvailable": "arg",
            "category": "Disaster Recovery",
            "description": "The Azure Image Builder service, used for deploying Image Templates, lacks availability zones support. By replicating Image Templates to a secondary, preferably paired, region, quick recovery from a region failure is enabled, ensuring continuous virtual machine deployment from these templates.\n",
            "graph": "// Azure Resource Graph Query\n// List all Image Templates that are not replicated to another region\nresources\n| where type =~ \"microsoft.virtualmachineimages/imagetemplates\"\n| mv-expand distribution=properties.distribute\n| where array_length(parse_json(distribution).replicationRegions) == 1\n| project recommendationId = \"21fb841b-ba70-1f4e-a460-1f72fb41aa51\", name, id, param1=strcat(\"replicationRegions:\",parse_json(distribution).replicationRegions)\n\n",
            "guid": "21fb841b-ba70-1f4e-a460-1f72fb41aa51",
            "learnMoreLink": [
                {
                    "name": "Image Template resiliency",
                    "url": "https://learn.microsoft.com/en-us/azure/reliability/reliability-image-builder?toc=%2Fazure%2Fvirtual-machines%2Ftoc.json&bc=%2Fazure%2Fvirtual-machines%2Fbreadcrumb%2Ftoc.json#capacity-and-proactive-disaster-recovery-resiliency"
                },
                {
                    "name": "Azure Image Builder Supported Regions",
                    "url": "https://learn.microsoft.com/en-us/azure/virtual-machines/image-builder-overview?tabs=azure-powershell#regions"
                }
            ],
            "longDescription": "The Azure Image Builder service, used for deploying Image Templates, lacks availability zones support. By replicating Image Templates to a secondary, preferably paired, region, quick recovery from a region failure is enabled, ensuring continuous virtual machine deployment from these templates.\n",
            "pgVerified": true,
            "potentialBenefits": "Enhances disaster recovery capability",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Disaster Recovery",
            "recommendationImpact": "Low",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.VirtualMachineImages/imageTemplates",
            "recommendationTypeId": null,
            "service": "VM",
            "severity": "Low",
            "source": "azure-resources/VirtualMachineImages/imageTemplates/recommendations.yaml",
            "tags": null,
            "text": "Replicate your Image Templates to a secondary region"
        },
        {
            "aprlGuid": "88cb90c2-3b99-814b-9820-821a63f600dd",
            "automationAvailable": "arg",
            "category": "High Availability",
            "description": "Azure's feature of deploying App Service plans across availability zones enhances resiliency and reliability by ensuring operation during datacenter failures, providing redundancy without needing different regions, thus minimizing downtime and maintaining uninterrupted services.\n",
            "graph": "// Azure Resource Graph Query\n// The query filters the qualified App Service Plans that do not have Zone Redundancy enabled.\n// Its important to check regions that support availability zones for Azure App Services running on multi-tenant and App Service Environments https://learn.microsoft.com/en-us/azure/reliability/reliability-app-service?tabs=graph%2Ccli#:~:text=The%20following%20regions%20support%20Azure%20App%20Services%20running%20on%20multi%2Dtenant%20environments%3A\n\nresources\n| where type =~ 'microsoft.web/serverfarms'\n| extend zoneRedundant = tobool(properties.zoneRedundant)\n| extend sku_tier = tostring(sku.tier)\n| where (tolower(sku_tier) contains \"isolated\" or tolower(sku_tier) contains \"premium\") and zoneRedundant == false\n| project recommendationId=\"88cb90c2-3b99-814b-9820-821a63f600dd\", name, id, tags, param1=sku_tier, param2=\"Not Zone Redundant\"\n\n",
            "guid": "88cb90c2-3b99-814b-9820-821a63f600dd",
            "learnMoreLink": [
                {
                    "name": "Migrate App Service to availability zone support",
                    "url": "https://learn.microsoft.com/en-us/azure/reliability/migrate-app-service"
                },
                {
                    "name": "High availability enterprise deployment using App Service Environment",
                    "url": "https://learn.microsoft.com/en-us/azure/architecture/reference-architectures/enterprise-integration/ase-high-availability-deployment"
                }
            ],
            "longDescription": "Azure's feature of deploying App Service plans across availability zones enhances resiliency and reliability by ensuring operation during datacenter failures, providing redundancy without needing different regions, thus minimizing downtime and maintaining uninterrupted services.\n",
            "pgVerified": false,
            "potentialBenefits": "Enhances app resiliency and reliability",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Web/serverFarms",
            "recommendationTypeId": null,
            "service": "Web Apps",
            "severity": "High",
            "source": "azure-resources/Web/serverFarms/recommendations.yaml",
            "tags": null,
            "text": "Migrate App Service to availability Zone Support"
        },
        {
            "aprlGuid": "b2113023-a553-2e41-9789-597e2fb54c31",
            "automationAvailable": "arg",
            "category": "High Availability",
            "description": "Choose Standard/Premium Azure App Service Plan for robust apps with advanced scaling, high availability, better performance, and multiple slots, ensuring resilience and continuous operation.\n",
            "graph": "// Azure Resource Graph Query\n// Provides a list of Azure App Service Plans that are not in the \"Standard\", \"Premium\", or \"IsolatedV2\" SKU tiers.\n\nresources\n| where type =~ 'microsoft.web/serverfarms'\n| extend sku_tier = tostring(sku.tier)\n| where tolower(sku_tier) !contains \"standard\" and\n        tolower(sku_tier) !contains \"premium\" and\n        tolower(sku_tier) !contains \"isolatedv2\"\n| project recommendationId=\"b2113023-a553-2e41-9789-597e2fb54c31\", name, id, tags, param1= strcat(\"SKU=\",sku_tier)\n\n",
            "guid": "b2113023-a553-2e41-9789-597e2fb54c31",
            "learnMoreLink": [
                {
                    "name": "Resiliency checklist for specific Azure services",
                    "url": "https://learn.microsoft.com/en-us/azure/architecture/checklist/resiliency-per-service#app-service"
                }
            ],
            "longDescription": "Choose Standard/Premium Azure App Service Plan for robust apps with advanced scaling, high availability, better performance, and multiple slots, ensuring resilience and continuous operation.\n",
            "pgVerified": false,
            "potentialBenefits": "Enhanced scaling and reliability",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Web/serverFarms",
            "recommendationTypeId": null,
            "service": "Web Apps",
            "severity": "High",
            "source": "azure-resources/Web/serverFarms/recommendations.yaml",
            "tags": null,
            "text": "Use Standard or Premium tier"
        },
        {
            "aprlGuid": "07243659-4643-d44c-a1c6-07ac21635072",
            "automationAvailable": "arg",
            "category": "Scalability",
            "description": "Avoid frequent scaling up/down of Azure App Service instances to prevent service disruptions. Choose the right tier and size for the workload and scale out for traffic changes, as scaling adjustments can trigger application restarts.\n",
            "graph": "// Azure Resource Graph Query\n// Provides a list of Azure App Service Plans and the number of changes that was made to the pricing tier, if the count is higher that 3 it means you need to avoid scaling up and down that often\n\nresourcechanges\n| extend changeTime = todatetime(properties.changeAttributes.timestamp), targetResourceId = tostring(properties.targetResourceId),\nchangeType = tostring(properties.changeType), correlationId = properties.changeAttributes.correlationId,\nchangedProperties = properties.changes, changeCount = properties.changeAttributes.changesCount\n| where changeTime > ago(14d)\n| join kind=inner (resources | project resources_Name = name, resources_Type = type, resources_Subscription= subscriptionId, resources_ResourceGroup= resourceGroup, id) on $left.targetResourceId == $right.id\n| where resources_Type contains \"microsoft.web/serverfarms\"\n| where changedProperties['sku.name'].propertyChangeType == 'Update' or changedProperties['sku.tier'].propertyChangeType == 'Update'\n| summarize count() by targetResourceId, resources_Name  ,tostring(changedProperties['sku.name'].previousValue), tostring(changedProperties['sku.tier'].newValue)\n| project recommendationId=\"07243659-4643-d44c-a1c6-07ac21635072\", name=resources_Name, id=targetResourceId, tags=\"\", param1=['changedProperties_sku.name_previousValue'], param2=['changedProperties_sku.tier_newValue'], param3=count_\n\n",
            "guid": "07243659-4643-d44c-a1c6-07ac21635072",
            "learnMoreLink": [
                {
                    "name": "Resiliency checklist for specific Azure services",
                    "url": "https://learn.microsoft.com/en-us/azure/architecture/checklist/resiliency-per-service#app-service"
                }
            ],
            "longDescription": "Avoid frequent scaling up/down of Azure App Service instances to prevent service disruptions. Choose the right tier and size for the workload and scale out for traffic changes, as scaling adjustments can trigger application restarts.\n",
            "pgVerified": false,
            "potentialBenefits": "Minimizes restarts, enhances stability",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Scalability",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Web/serverFarms",
            "recommendationTypeId": null,
            "service": "Web Apps",
            "severity": "Medium",
            "source": "azure-resources/Web/serverFarms/recommendations.yaml",
            "tags": null,
            "text": "Avoid scaling up or down"
        },
        {
            "aprlGuid": "dbe3fd66-fb2a-9d46-b162-1791e21da236",
            "automationAvailable": false,
            "category": "Governance",
            "description": "It is strongly recommended to create separate App Service plans for production and test environments to avoid using slots within your production deployment for testing purposes.\n",
            "graph": "// cannot-be-validated-with-arg\n\n",
            "guid": "dbe3fd66-fb2a-9d46-b162-1791e21da236",
            "learnMoreLink": [
                {
                    "name": "Resiliency checklist for specific Azure services",
                    "url": "https://learn.microsoft.com/en-us/azure/architecture/checklist/resiliency-per-service#app-service"
                }
            ],
            "longDescription": "It is strongly recommended to create separate App Service plans for production and test environments to avoid using slots within your production deployment for testing purposes.\n",
            "pgVerified": false,
            "potentialBenefits": "Protects prod performance; avoids test impact",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Governance",
            "recommendationImpact": "High",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Web/serverFarms",
            "recommendationTypeId": null,
            "service": "Web Apps",
            "severity": "High",
            "source": "azure-resources/Web/serverFarms/recommendations.yaml",
            "tags": null,
            "text": "Create separate App Service plans for production and test"
        },
        {
            "aprlGuid": "6320abf6-f917-1843-b2ae-4779c35985ae",
            "automationAvailable": false,
            "category": "Scalability",
            "description": "Enabling Autoscale/Automatic Scaling for your Azure App Service ensures sufficient resources for incoming requests. Autoscaling is rule-based, whereas Automatic Scaling, a newer feature, automatically adjusts resources based on HTTP traffic.\n",
            "graph": "// under-development\n\n",
            "guid": "6320abf6-f917-1843-b2ae-4779c35985ae",
            "learnMoreLink": [
                {
                    "name": "Automatic scaling in Azure App Service",
                    "url": "https://learn.microsoft.com/en-us/azure/app-service/manage-automatic-scaling?tabs=azure-portal"
                },
                {
                    "name": "Auto Scale Web Apps",
                    "url": "https://learn.microsoft.com/en-us/azure/azure-monitor/autoscale/autoscale-get-started"
                }
            ],
            "longDescription": "Enabling Autoscale/Automatic Scaling for your Azure App Service ensures sufficient resources for incoming requests. Autoscaling is rule-based, whereas Automatic Scaling, a newer feature, automatically adjusts resources based on HTTP traffic.\n",
            "pgVerified": false,
            "potentialBenefits": "Optimizes resources for traffic",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Scalability",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Web/serverFarms",
            "recommendationTypeId": null,
            "service": "Web Apps",
            "severity": "Medium",
            "source": "azure-resources/Web/serverFarms/recommendations.yaml",
            "tags": null,
            "text": "Enable Autoscale/Automatic scaling to ensure adequate resources are available to service requests"
        },
        {
            "aprlGuid": "493f6079-3bb6-4a56-96ba-ab3248474cb1",
            "automationAvailable": false,
            "category": "Monitoring and Alerting",
            "description": "Enabling diagnostics logging for your Azure App Service is crucial for monitoring and diagnostics, including both application logging and web server logging.\n",
            "graph": "// cannot-be-validated-with-arg\n\n\n",
            "guid": "493f6079-3bb6-4a56-96ba-ab3248474cb1",
            "learnMoreLink": [
                {
                    "name": "Enable diagnostics logging for apps in Azure App Service",
                    "url": "https://learn.microsoft.com/azure/app-service/troubleshoot-diagnostic-logs"
                }
            ],
            "longDescription": "Enabling diagnostics logging for your Azure App Service is crucial for monitoring and diagnostics, including both application logging and web server logging.\n",
            "pgVerified": false,
            "potentialBenefits": "Monitoring and Alerting",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Monitoring and Alerting",
            "recommendationImpact": "Low",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Web/sites",
            "recommendationTypeId": null,
            "service": "App Service",
            "severity": "Low",
            "source": "azure-resources/Web/sites/recommendations.yaml",
            "tags": null,
            "text": "Enable diagnostics logging"
        },
        {
            "aprlGuid": "a7e8bb3d-8ceb-442d-b26f-007cd63f9ffc",
            "automationAvailable": false,
            "category": "Monitoring and Alerting",
            "description": "Use Application Insights to monitor app performance and load behavior, offering real-time insights, issue diagnosis, and root-cause analysis. It supports ASP.NET, ASP.NET Core, Java, and Node.js on Azure App Service, now with built-in monitoring.\n",
            "graph": "// cannot-be-validated-with-arg\n\n\n",
            "guid": "a7e8bb3d-8ceb-442d-b26f-007cd63f9ffc",
            "learnMoreLink": [
                {
                    "name": "Application Insights",
                    "url": "https://learn.microsoft.com/azure/application-insights/app-insights-overview"
                },
                {
                    "name": "Application monitoring for Azure App Service",
                    "url": "https://learn.microsoft.com/azure/azure-monitor/app/azure-web-apps"
                }
            ],
            "longDescription": "Use Application Insights to monitor app performance and load behavior, offering real-time insights, issue diagnosis, and root-cause analysis. It supports ASP.NET, ASP.NET Core, Java, and Node.js on Azure App Service, now with built-in monitoring.\n",
            "pgVerified": false,
            "potentialBenefits": "Real-time insights and issue diagnosis",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Monitoring and Alerting",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Web/sites",
            "recommendationTypeId": null,
            "service": "App Service",
            "severity": "Medium",
            "source": "azure-resources/Web/sites/recommendations.yaml",
            "tags": null,
            "text": "Monitor Performance"
        },
        {
            "aprlGuid": "78a5c033-ff51-4332-8a71-83464c34494b",
            "automationAvailable": false,
            "category": "Scalability",
            "description": "If your solution includes both a web front end and a web API, decomposing them into separate App Service apps facilitates solution decomposition by workload, allowing for independent scaling. Initially, you can deploy both in the same plan and separate them for independent scaling when necessary.\n",
            "graph": "// cannot-be-validated-with-arg\n\n",
            "guid": "78a5c033-ff51-4332-8a71-83464c34494b",
            "learnMoreLink": [
                {
                    "name": "Resiliency checklist for specific Azure services",
                    "url": "https://learn.microsoft.com/azure/architecture/checklist/resiliency-per-service#app-service"
                }
            ],
            "longDescription": "If your solution includes both a web front end and a web API, decomposing them into separate App Service apps facilitates solution decomposition by workload, allowing for independent scaling. Initially, you can deploy both in the same plan and separate them for independent scaling when necessary.\n",
            "pgVerified": false,
            "potentialBenefits": "Independent scaling, easier management",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Scalability",
            "recommendationImpact": "Low",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Web/sites",
            "recommendationTypeId": null,
            "service": "App Service",
            "severity": "Low",
            "source": "azure-resources/Web/sites/recommendations.yaml",
            "tags": null,
            "text": "Separate web apps from web APIs"
        },
        {
            "aprlGuid": "3f9ddb59-0bb3-4acb-9c9b-99aa1776f0ab",
            "automationAvailable": false,
            "category": "Scalability",
            "description": "Creating a separate storage account for logs and not using the same one for application data prevents logging activities from reducing application performance by ensuring that the resources dedicated to handling application data are not burdened by logging processes.\n",
            "graph": "// cannot-be-validated-with-arg\n\n",
            "guid": "3f9ddb59-0bb3-4acb-9c9b-99aa1776f0ab",
            "learnMoreLink": [
                {
                    "name": "Resiliency checklist",
                    "url": "https://learn.microsoft.com/azure/architecture/checklist/resiliency-per-service#app-service"
                }
            ],
            "longDescription": "Creating a separate storage account for logs and not using the same one for application data prevents logging activities from reducing application performance by ensuring that the resources dedicated to handling application data are not burdened by logging processes.\n",
            "pgVerified": false,
            "potentialBenefits": "Improves app performance",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Scalability",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Web/sites",
            "recommendationTypeId": null,
            "service": "App Service",
            "severity": "Medium",
            "source": "azure-resources/Web/sites/recommendations.yaml",
            "tags": null,
            "text": "Create a separate storage account for logs"
        },
        {
            "aprlGuid": "a1d91661-32d4-430b-b3b6-5adeb0975df7",
            "automationAvailable": "arg",
            "category": "Governance",
            "description": "Create a deployment slot for staging to deploy updates, verify them, and ensure all instances are warmed up before production swap, reducing bad update chances. An LKG slot allows easy rollback to a previous good deployment if issues arise later, enhancing reliability.\n",
            "graph": "// Azure Resource Graph Query\n// Display App Service with the count of deployment slots for Apps under eligible App service plans and it shows if deployment slot is enabled or not\n\nresources\n| where type =~ 'microsoft.web/sites' or type =~ 'microsoft.web/sites/slots'\n| extend isSlot = iff(type =~ 'microsoft.web/sites/slots', 1, 0)\n| extend AspName = iff(isSlot == 1, split(name, '/')[0], name)\n| extend Sku = tostring(properties.sku)\n| where tolower(Sku) contains \"standard\" or tolower(Sku) contains \"premium\" or tolower(Sku) contains \"isolatedv2\"\n| project id, name, AspName, isSlot, Sku\n| summarize Slots = countif(isSlot == 1) by id, name, AspName, Sku\n| extend DeploymentSlotEnabled = iff(Slots > 1, true, false)\n| where DeploymentSlotEnabled = false\n| project recommendationId=\"a1d91661-32d4-430b-b3b6-5adeb0975df7\", name, id, tags=\"\", param1=Sku, param2=Slots, param3=\"DeploymentSlotEnabled=false\"\n\n",
            "guid": "a1d91661-32d4-430b-b3b6-5adeb0975df7",
            "learnMoreLink": [
                {
                    "name": "Set up staging environments in Azure App Service",
                    "url": "https://learn.microsoft.com/azure/app-service-web/web-sites-staged-publishing"
                }
            ],
            "longDescription": "Create a deployment slot for staging to deploy updates, verify them, and ensure all instances are warmed up before production swap, reducing bad update chances. An LKG slot allows easy rollback to a previous good deployment if issues arise later, enhancing reliability.\n",
            "pgVerified": false,
            "potentialBenefits": "Safer updates and easy rollback",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Governance",
            "recommendationImpact": "Low",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Web/sites",
            "recommendationTypeId": "1d3b5a51-62d4-4b77-96f6-40ed0a3aa21f",
            "service": "App Service",
            "severity": "Low",
            "source": "azure-resources/Web/sites/recommendations.yaml",
            "tags": null,
            "text": "Deploy to a staging slot"
        },
        {
            "aprlGuid": "0b80b67c-afbe-4988-ad58-a85a146b681e",
            "automationAvailable": "arg",
            "category": "Other Best Practices",
            "description": "Use app settings for configuration and define them in Resource Manager templates or via PowerShell to facilitate part of an automated deployment/update process for improved reliability.\n",
            "graph": "// Azure Resource Graph Query\n// Provides a list of Azure App Service resources that don't have App Settings configured\n\nappserviceresources\n| where type == \"microsoft.web/sites/config\"\n| extend AppSettings = iif(isempty(properties.AppSettings), true, false)\n| where AppSettings == false\n| project  recommendationId=\"0b80b67c-afbe-4988-ad58-a85a146b681e\", id, name, tags=\"\", param1=\"AppSettings is not configured\"\n\n",
            "guid": "0b80b67c-afbe-4988-ad58-a85a146b681e",
            "learnMoreLink": [
                {
                    "name": "Configure web apps in Azure App Service",
                    "url": "https://learn.microsoft.com/azure/app-service-web/web-sites-configure"
                }
            ],
            "longDescription": "Use app settings for configuration and define them in Resource Manager templates or via PowerShell to facilitate part of an automated deployment/update process for improved reliability.\n",
            "pgVerified": false,
            "potentialBenefits": "Enhanced reliability via automation",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Other Best Practices",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Web/sites",
            "recommendationTypeId": null,
            "service": "App Service",
            "severity": "Medium",
            "source": "azure-resources/Web/sites/recommendations.yaml",
            "tags": null,
            "text": "Store configuration as app settings"
        },
        {
            "aprlGuid": "fd049c28-ae6d-48f0-a641-cc3ba1a3fe1d",
            "automationAvailable": "arg",
            "category": "Other Best Practices",
            "description": "Use Health Check for production workloads. Health check increases your application's availability by rerouting requests away from unhealthy instances, and replacing instances if they remain unhealthy. The Health check path should check critical components of your application.\n",
            "graph": "// Azure Resource Graph Query\n// Check if Health Check is enabled for App Service\n\nresources\n| where type =~ 'microsoft.web/sites'\n| where properties.kind has 'app'\n| join kind = inner\n    (\n    appserviceresources\n    | where isnull(properties.HealthCheckPath) == true\n    | project  name\n    ) on name\n| project recommendationId = \"fd049c28-ae6d-48f0-a641-cc3ba1a3fe1d\", name, id, tags, param1 = \"Healthcheckpath = not set\"\n",
            "guid": "fd049c28-ae6d-48f0-a641-cc3ba1a3fe1d",
            "learnMoreLink": [
                {
                    "name": "Monitor the health of App Service instances",
                    "url": "https://learn.microsoft.com/en-us/azure/app-service/monitor-instances-health-check?tabs=dotnet#enable-health-check"
                }
            ],
            "longDescription": "Use Health Check for production workloads. Health check increases your application's availability by rerouting requests away from unhealthy instances, and replacing instances if they remain unhealthy. The Health check path should check critical components of your application.\n",
            "pgVerified": false,
            "potentialBenefits": "Enhanced reliability via automation",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Other Best Practices",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Web/sites",
            "recommendationTypeId": null,
            "service": "App Service",
            "severity": "Medium",
            "source": "azure-resources/Web/sites/recommendations.yaml",
            "tags": null,
            "text": "Enable Health check for App Services"
        },
        {
            "aprlGuid": "aab6b4a4-9981-43a4-8728-35c7ecbb746d",
            "automationAvailable": "arg",
            "category": "Governance",
            "description": "Use network access restrictions to define a priority-ordered allow/deny list that controls network access to your app. Web application firewalls, such as the one available in Application Gateway, are recommended for protection of public-facing web applications.\n",
            "graph": "// Azure Resource Graph Query\n// Check if Network access restrictions defined for App service\n\nresources\n| where type =~ 'microsoft.web/sites'\n| where properties.kind has 'app'\n| join kind = inner\n    (\n    appserviceresources\n    | mv-expand IpSecurityRestrictions = properties.IpSecurityRestrictions\n    | where isnotnull(IpSecurityRestrictions) == true\n    | project name\n    ) on name\n| project recommendationId = \"aab6b4a4-9981-43a4-8728-35c7ecbb746d\", name, id, tags, param1 = \"No network restrictions set\"\n",
            "guid": "aab6b4a4-9981-43a4-8728-35c7ecbb746d",
            "learnMoreLink": [
                {
                    "name": "Set up Azure App Service access restrictions",
                    "url": "https://learn.microsoft.com/en-us/azure/app-service/app-service-ip-restrictions?tabs=azurecli"
                }
            ],
            "longDescription": "Use network access restrictions to define a priority-ordered allow/deny list that controls network access to your app. Web application firewalls, such as the one available in Application Gateway, are recommended for protection of public-facing web applications.\n",
            "pgVerified": false,
            "potentialBenefits": "Enhanced security",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Governance",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Web/sites",
            "recommendationTypeId": null,
            "service": "App Service",
            "severity": "Medium",
            "source": "azure-resources/Web/sites/recommendations.yaml",
            "tags": null,
            "text": "Configure network access restrictions"
        },
        {
            "aprlGuid": "9e6682ac-31bc-4635-9959-ab74b52454e6",
            "automationAvailable": "arg",
            "category": "Scalability",
            "description": "App Service should be configured with a minimum of two instances for production workloads. If apps have a longer warmup time a minimum of three instances should be used.\n",
            "graph": "// Azure Resource Graph Query\n// Provides a list of App services that do not have minimum instance count of 2\n\nresources\n| where type =~ 'microsoft.web/sites'\n| where properties.kind has 'app'\n| join kind = inner\n    (\n    appserviceresources\n    | where properties.PreWarmedInstanceCount < 2\n    | project name\n    ) on name\n| project recommendationId = \"9e6682ac-31bc-4635-9959-ab74b52454e6\", name, id, tags, param1 = \"PreWarmedInstanceCount is less than 2\"\n",
            "guid": "9e6682ac-31bc-4635-9959-ab74b52454e6",
            "learnMoreLink": [
                {
                    "name": "Ultimate guide to running healthy apps in the cloud",
                    "url": "https://azure.github.io/AppService/2020/05/15/Robust-Apps-for-the-cloud.html"
                }
            ],
            "longDescription": "App Service should be configured with a minimum of two instances for production workloads. If apps have a longer warmup time a minimum of three instances should be used.\n",
            "pgVerified": false,
            "potentialBenefits": "Improves app performace",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Scalability",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Web/sites",
            "recommendationTypeId": null,
            "service": "App Service",
            "severity": "Medium",
            "source": "azure-resources/Web/sites/recommendations.yaml",
            "tags": null,
            "text": "Set minimum instance count to 2 for app service"
        },
        {
            "aprlGuid": "c6c4b962-5af4-447a-9d74-7b9c53a5dff5",
            "automationAvailable": "arg",
            "category": "High Availability",
            "description": "Auto Heal allows you to mitigate your apps when it runs into unexpected situations like HTTP server errors, resource exhaustion, etc. You can configure different triggers based on your need and choose to recycle the app to recover it from a bad state.\n",
            "graph": "// Azure Resource Graph Query\n// Provides a list of Azure Function App resources that do not have auto heal enabled\n\nResources\n| where type =~ 'microsoft.web/sites'\n| where properties.kind contains 'functionapp'\n| join kind=inner\n    (appserviceresources\n    | where type == \"microsoft.web/sites/config\"\n    | where properties.AutoHealEnabled == 'false'\n    | project id, name, tenantId, location, resourceGroup, properties.AutoHealEnabled\n    ) on name\n| project recommendationID = \"c6c4b962-5af4-447a-9d74-7b9c53a5dff5\", name, id, type, kind, param1=\"AutoHealEnabled =false\"\n",
            "guid": "c6c4b962-5af4-447a-9d74-7b9c53a5dff5",
            "learnMoreLink": [
                {
                    "name": "Announcing the New Auto Healing Experience in App Service Diagnostics - Azure App Service",
                    "url": "https://azure.github.io/AppService/2018/09/10/Announcing-the-New-Auto-Healing-Experience-in-App-Service-Diagnostics.html"
                }
            ],
            "longDescription": "Auto Heal allows you to mitigate your apps when it runs into unexpected situations like HTTP server errors, resource exhaustion, etc. You can configure different triggers based on your need and choose to recycle the app to recover it from a bad state.\n",
            "pgVerified": false,
            "potentialBenefits": "Improved app availability",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "High Availability",
            "recommendationImpact": "Low",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Web/sites",
            "recommendationTypeId": null,
            "service": "App Service",
            "severity": "Low",
            "source": "azure-resources/Web/sites/recommendations.yaml",
            "tags": null,
            "text": "Enable auto heal for Functions App"
        },
        {
            "aprlGuid": "52f368ee-1d77-4b34-92db-64be269642d0",
            "automationAvailable": false,
            "category": "Monitoring and Alerting",
            "description": "Add a warmup trigger to pre-load custom dependencies during the pre-warming process so that your functions are ready to start processing requests immediately.\n",
            "graph": "// cannot-be-validated-with-arg\n",
            "guid": "52f368ee-1d77-4b34-92db-64be269642d0",
            "learnMoreLink": [
                {
                    "name": "Azure Functions Warmup Trigger",
                    "url": "https://learn.microsoft.com/en-us/azure/azure-functions/functions-bindings-warmup?tabs=in-process%2Cnodejs-v4&pivots=programming-language-csharp#trigger"
                }
            ],
            "longDescription": "Add a warmup trigger to pre-load custom dependencies during the pre-warming process so that your functions are ready to start processing requests immediately.\n",
            "pgVerified": false,
            "potentialBenefits": "Improved app availability",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Monitoring and Alerting",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Web/sites",
            "recommendationTypeId": null,
            "service": "App Service",
            "severity": "Medium",
            "source": "azure-resources/Web/sites/recommendations.yaml",
            "tags": null,
            "text": "No warmup trigger added to Function App"
        },
        {
            "aprlGuid": "0b06a688-0dd6-4d73-9f72-6666ff853ca9",
            "automationAvailable": false,
            "category": "Governance",
            "description": "A host ID must be between 1 and 32 characters, contain only lowercase letters, numbers, and dashes, not start or end with a dash, and not contain consecutive dashes. The host ID value should be unique for all apps/slots you're running.\n",
            "graph": "// cannot-be-validated-with-arg\n",
            "guid": "0b06a688-0dd6-4d73-9f72-6666ff853ca9",
            "learnMoreLink": [
                {
                    "name": "Resource naming restrictions - Azure Resource Manager",
                    "url": "https://learn.microsoft.com/en-us/azure/azure-resource-manager/management/resource-name-rules"
                }
            ],
            "longDescription": "A host ID must be between 1 and 32 characters, contain only lowercase letters, numbers, and dashes, not start or end with a dash, and not contain consecutive dashes. The host ID value should be unique for all apps/slots you're running.\n",
            "pgVerified": false,
            "potentialBenefits": "Easier management",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Governance",
            "recommendationImpact": "Low",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Web/sites",
            "recommendationTypeId": null,
            "service": "App Service",
            "severity": "Low",
            "source": "azure-resources/Web/sites/recommendations.yaml",
            "tags": null,
            "text": "Ensure unique hostid set for Function App"
        },
        {
            "aprlGuid": "c9a278b7-024b-454b-bd54-41587c512b74",
            "automationAvailable": false,
            "category": "Governance",
            "description": "Beginning on December 13, 2022, function apps running on versions 2.x and 3.x of the Azure Functions runtime have reached the end of life (EOL) of extended support. We highly recommend you migrating your function apps to version 4.x of the Functions runtime.\n",
            "graph": "// cannot-be-validated-with-arg\n",
            "guid": "c9a278b7-024b-454b-bd54-41587c512b74",
            "learnMoreLink": [
                {
                    "name": "Migrate version 3.x to 4.x",
                    "url": "https://learn.microsoft.com/en-us/azure/azure-functions/migrate-version-3-version-4?tabs=net6-in-proc%2Cazure-cli%2Cwindows&pivots=programming-language-csharp"
                }
            ],
            "longDescription": "Beginning on December 13, 2022, function apps running on versions 2.x and 3.x of the Azure Functions runtime have reached the end of life (EOL) of extended support. We highly recommend you migrating your function apps to version 4.x of the Functions runtime.\n",
            "pgVerified": false,
            "potentialBenefits": "Better governance",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Governance",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Web/sites",
            "recommendationTypeId": null,
            "service": "App Service",
            "severity": "Medium",
            "source": "azure-resources/Web/sites/recommendations.yaml",
            "tags": null,
            "text": "Ensure Function App runs a supported version"
        },
        {
            "aprlGuid": "7c608f46-46b2-4cc0-bbd6-1d457c16671c",
            "automationAvailable": false,
            "category": "Governance",
            "description": "The FUNCTIONS_WORKER_RUNTIME setting in the Function App configuration should be set to the appropriate value based on the language you are using. This setting is used to determine the language worker that will be used to execute your functions.\n",
            "graph": "// cannot-be-validated-with-arg\n",
            "guid": "7c608f46-46b2-4cc0-bbd6-1d457c16671c",
            "learnMoreLink": [
                {
                    "name": "FUNCTIONS_WORKER_RUNTIME",
                    "url": "https://learn.microsoft.com/en-us/azure/azure-functions/functions-app-settings#functions_worker_runtime"
                }
            ],
            "longDescription": "The FUNCTIONS_WORKER_RUNTIME setting in the Function App configuration should be set to the appropriate value based on the language you are using. This setting is used to determine the language worker that will be used to execute your functions.\n",
            "pgVerified": false,
            "potentialBenefits": "Better governance",
            "publishedToAdvisor": false,
            "publishedToLearn": false,
            "recommendationControl": "Governance",
            "recommendationImpact": "Medium",
            "recommendationMetadataState": "Active",
            "recommendationResourceType": "Microsoft.Web/sites",
            "recommendationTypeId": null,
            "service": "App Service",
            "severity": "Medium",
            "source": "azure-resources/Web/sites/recommendations.yaml",
            "tags": null,
            "text": "Ensure FUNCTIONS_WORKER_RUNTIME is set properly"
        },
        {
            "description": "",
            "guid": "a549f1f2-55ec-4094-b8c5-1be6fd4f4d38",
            "service": "Web Apps",
            "text": "Prioritize user flows: Not all flows are equally critical. Assign priorities to each flow to guide your design decisions. User flow design can influence which service tiers and number of instances that you choose for an App Service plan and configuration.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "a67a6739-c1af-48d6-a3d1-001fb5105139",
            "service": "Web Apps",
            "text": "Anticipate potential failures: Plan mitigation strategies for potential failures. The following table shows examples of failure mode analysis.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "b47d664a-75c8-4739-80d8-6cf9f60abb56",
            "service": "Web Apps",
            "text": "Build redundancy: Build redundancy in the application and supporting infrastructure. Spread instances across availability zones to improve fault tolerance. Traffic is routed to other zones if one zone fails. Deploy your application across multiple regions to ensure that your app remains available, even if an entire region experiences an outage.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "6b8fa1ed-cfa0-4435-9146-b3d1a8edb432",
            "service": "Web Apps",
            "text": "Have a reliable scaling strategy: Unexpected load on an application can make it unreliable. Consider the right scaling approach based on your workload characteristics. You can sometimes scale up to handle the load. However, if the load continues to increase, scale out to new instances. Prefer automatic scaling over manual approaches. Always maintain a buffer of extra capacity during scaling operations to prevent performance degradation.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "ac7f205b-9117-4b49-8f22-9f31528dfdbd",
            "service": "Web Apps",
            "text": "Plan your recoverability: Redundancy is crucial for business continuity. Fail over to another instance if one instance is unreachable. Explore automatic healing capabilities in App Service, such as automatic repair of instances.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "55917a7d-4410-45fc-bba7-42e64d85c9cd",
            "service": "Web Apps",
            "text": "Conduct reliability testing: Conduct load testing to evaluate your application's reliability and performance under load. Test plans should include scenarios that validate your automated recovery operations.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "dcceb232-19d6-48dc-a91f-5b4907cc3dda",
            "service": "Web Apps",
            "text": "Use health probes to identify unresponsive workers: App Service has built-in capabilities that periodically ping a specific path of your web application. Unresponsive instances are removed from the load balancer and replaced with a new instance.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "A premium App Service plan offers advanced scaling features and ensures redundancy if failures occur.",
            "guid": "696fd187-e2a8-45e8-bbe7-a6d3cb1fca62",
            "service": "Web Apps",
            "text": "(App Service plan) Choose the Premium tier of an App Service plan for production workloads.  Set the maximum and minimum number of workers according to your capacity planning. For more information, see App Service plan overview.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Your application can withstand failures in a single zone when multiple instances are spread across zones. Traffic automatically shifts to healthy instances in other zones and maintains application reliability if one zone is unavailable.",
            "guid": "830faa5e-7767-4526-8550-547a345dd398",
            "service": "Web Apps",
            "text": "(App Service plan) Enable zone redundancy. Consider provisioning more than three instances to enhance fault tolerance.  Check regional support for zone redundancy because not all regions offer this feature.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Incoming requests are evenly distributed across all available nodes when you disable ARR affinity. Evenly distributed requests prevent traffic from overwhelming any single node. Requests can be seamlessly redirected to other healthy nodes if a node is unavailable.  Avoid session affinity to ensure that your App Service instance remains stateless. A stateless App Service reduces complexity and ensures consistent behavior across nodes.  Remove sticky sessions so that App Service can add or remove instances to scale horizontally.",
            "guid": "3551bbd4-1f44-4bca-b25c-53e16f79cafe",
            "service": "Web Apps",
            "text": "(App Service) Consider disabling the application request routing (ARR) affinity feature. ARR affinity creates sticky sessions that redirect users to the node that handled their previous requests.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Automatic healing rules help your application recover automatically from unexpected problems. The configured rules trigger healing actions when thresholds are breached.  Automatic healing enables automatic proactive maintenance.",
            "guid": "2a428ce1-dc25-4a1b-baf4-5edc909369fe",
            "service": "Web Apps",
            "text": "(App Service) Define automatic healing rules based on request count, slow requests, memory limits, and other indicators that are part of your performance baseline. Consider this configuration as part of your scaling strategy.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Health checks can detect problems early. Then the system can automatically take corrective actions when a health check request fails.  The load balancer routes traffic away from unhealthy instances, which directs users to healthy nodes.",
            "guid": "4dd04acd-7d69-45b8-aa22-223c4ecc0a8c",
            "service": "Web Apps",
            "text": "(App Service) Enable the health check feature and provide a path that responds to the health check requests.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "e13358d7-cf1a-4356-a8eb-afe901ca3b36",
            "service": "Web Apps",
            "text": "Review security baselines: To enhance the security posture of your application that's hosted on an App Service plan, review the security baseline for App Service.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "cedf41d1-6f8a-4898-9cbd-064e66931bfa",
            "service": "Web Apps",
            "text": "Use the latest runtime and libraries: Thoroughly test your application builds before you do updates to catch problems early and ensure a smooth transition to the new version. App Service supports the language runtime support policy for updating existing stacks and retiring end-of-support stacks.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "469151fd-f51c-43ab-84f7-5d6c01e99fba",
            "service": "Web Apps",
            "text": "Create segmentation through isolation boundaries to contain breach: Apply identity segmentation. For example, implement role-based access control (RBAC) to assign specific permissions based on roles. Follow the principle of least privilege to limit access rights to only what's necessary. Also create segmentation at the network level. Inject App Service apps in an Azure virtual network for isolation and define network security groups (NSGs) to filter traffic.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "794e1680-facc-4258-89cb-a07f1fa6e4d0",
            "service": "Web Apps",
            "text": "Apply access controls on identities: Restrict both inward access to the web app and outward access from the web app to other resources. This configuration applies access controls on identities and helps maintain the workload's overall security posture.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "0ff3e194-df50-4856-b798-7487e5fc4d34",
            "service": "Web Apps",
            "text": "Control network traffic to and from the application: Don't expose application endpoints to the public internet. Instead, add a private endpoint on the web app that's placed in a dedicated subnet. Front your application with a reverse proxy that communicates with that private endpoint. Consider using Application Gateway or Azure Front Door for that purpose.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "a6fcbd07-0da4-4386-902d-6708c5a5cc23",
            "service": "Web Apps",
            "text": "Encrypt data: Protect data in transit with end-to-end Transport Layer Security (TLS). Use your customer-managed keys for full encryption of data at rest. For more information, see Encryption at rest using customer-managed keys.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "410bf979-2e37-4dfc-82ba-33dc8e9fbbf0",
            "service": "Web Apps",
            "text": "Reduce the attack surface: Remove default configurations that you don't need. For example, disable remote debugging, local authentication for Source Control Manager (SCM) sites, and basic authentication. Disable unsecure protocols like HTTP and File Transfer Protocol (FTP). Enforce configurations through Azure policies. For more information, see Azure policies.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "7157fe29-fe06-4c84-965d-8d450ac4bfe0",
            "service": "Web Apps",
            "text": "Protect application secrets: You need to handle sensitive information, like API keys or authentication tokens. Instead of hardcoding these secrets directly into your application code or configuration files, you can use Azure Key Vault references in app settings. When the application starts, App Service automatically retrieves the secret values from Key Vault by using the app's managed identity.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "ae9e2e30-a31e-4459-ae31-fbcb8307016e",
            "service": "Web Apps",
            "text": "Enable resource logs for your application: Enable resource logs for your application to create comprehensive activity trails that provide valuable data during investigations that follow security incidents.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "The application retrieves secrets from Key Vault to authenticate outward communication from the application. Azure manages the identity and doesn't require you to provision or rotate any secrets.  You have distinct identities for granularity of control. Distinct identities make revocation easy if an identity is compromised.",
            "guid": "8f1a9e86-9309-4e41-bde5-0828c15daebf",
            "service": "Web Apps",
            "text": "(App Service) Assign managed identities to the web app. To maintain isolation boundaries, don't share or reuse identities across applications.  Make sure that you securely connect to your container registry if you use containers for your deployment.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Custom domains enable secure communication through HTTPS using Transport Layer Security (TLS) protocol, which ensures the protection of sensitive data and builds user trust.",
            "guid": "cb4271e8-40e1-4cd3-ad1e-5d4584c485d7",
            "service": "Web Apps",
            "text": "(App Service) Configure custom domains for applications.  Disable HTTP and only accept HTTPS requests.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "When you use this feature, you don't have to use authentication libraries in application code, which reduces complexity. The user is already authenticated when a request reaches the application.",
            "guid": "0e19e111-ccad-457f-94b5-ee2deebc553c",
            "service": "Web Apps",
            "text": "(App Service) valuate whether App Service built-in authentication is the right mechanism to authenticate users that access your application. App Service built-in authentication integrates with Microsoft Entra ID. This feature handles token validation and user identity management across multiple sign-in providers and supports OpenID Connect. With this feature, you don't have authorization at a granular level, and you don't have a mechanism to test authentication.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Get the security benefits of using an Azure virtual network. For example, the application can securely access resources within the network.   Add a private endpoint to help protect your application. Private endpoints limit direct exposure to the public network and allow controlled access through the reverse proxy.",
            "guid": "1835b31e-37b4-431a-b783-eb28fec46518",
            "service": "Web Apps",
            "text": "(App Service) Configure the application for virtual network integration.  Use private endpoints for App Service apps. Block all public traffic.  Route the container image pull through the virtual network integration. All outgoing traffic from the application passes through the virtual network.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "We don't recommend basic authentication as a secure deployment method. Microsoft Entra ID employs OAuth 2.0 token-based authentication, which offers numerous advantages and enhancements that address the limitations that are associated with basic authentication.  Policies restrict access to application resources, only allow requests from specific domains, and secure cross-region requests.",
            "guid": "07adcdee-eecc-43c4-9cf8-40e06efa96cc",
            "service": "Web Apps",
            "text": "(App Service) To implement hardening:  - Disable basic authentication that uses a username and password in favor of Microsoft Entra ID-based authentication.  - Turn off remote debugging so that inbound ports aren't opened. - Enable CORS policies to tighten incoming requests.  - Disable protocols, such as FTP.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Secrets are kept separate from your app's configuration. App settings are encrypted at rest. App Service also manages secret rotations.",
            "guid": "298db56c-a733-4a8c-a009-224a1417de53",
            "service": "Web Apps",
            "text": "(App Service) Always use Key Vault references as app settings.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Get real-time protection for resources that run in an App Service plan. Guard against threats and enhance your overall security posture.",
            "guid": "6cd4ee41-8ebd-4a7e-9da4-793705575ea0",
            "service": "Web Apps",
            "text": "(App Service plan) Enable Microsoft Defender for Cloud for App Service.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Logging captures access patterns. It records relevant events that provide valuable insights into how users interact with an application or platform. This information is crucial for accountability, compliance, and security purposes.",
            "guid": "93a4781a-8e68-4ad4-af67-4ae28d534e6e",
            "service": "Web Apps",
            "text": "(App Service plan) Enable diagnostic logging and add instrumentation to your app. The logs are sent to Azure Storage accounts, Azure Event Hubs, and Log Analytics. For more information about audit log types, see Supported log types.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "bb84a1f1-7f43-4656-bc0d-70abc288979b",
            "service": "Web Apps",
            "text": "Estimate the initial cost: As part of your cost modeling exercise, use the Azure pricing calculator to evaluate the approximate costs associated with various tiers based on the number of instances that you plan to run. Each App Service tier offers different compute options.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "8616b469-c0d7-4da8-afe4-28a9c55941b5",
            "service": "Web Apps",
            "text": "Evaluate the discounted options: Higher tiers include dedicated compute instances. You can apply a reservation discount if your workload has a predictable and consistent usage pattern. Make sure that you analyze usage data to determine the type of reservation that suits your workload. For more information, see Save costs with App Service reserved instances.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "08ccd533-7d3f-438e-8274-a30d3e10d81e",
            "service": "Web Apps",
            "text": "Understand usage meters: Azure charges an hourly rate, prorated to the second, based on your App Service plan's pricing tier. Charges apply to each scaled-out instance in your plan, based on the time that you allocate the VM instance. Pay attention to underused compute resources that might increase your costs as a result of overallocation due to suboptimal SKU selection, or poorly configured scale-in configuration.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "9d33583d-156b-4a49-b361-1eae39f5d6df",
            "service": "Web Apps",
            "text": "Consider the tradeoffs between density and isolation: You can use App Service plans to host multiple applications on the same compute, which saves costs with shared environments. For more information, see Tradeoffs.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "19d66260-5bfe-466e-89b0-f2573223acf9",
            "service": "Web Apps",
            "text": "Evaluate the effect of your scaling strategy on cost: You must properly design, test, and configure for scaling out and for scaling in when you implement autoscaling. Establish precise maximum and minimum limits on autoscaling.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "b4798bde-d65a-4c44-a75e-e7c8c05df60e",
            "service": "Web Apps",
            "text": "Optimize environment costs: Consider the Basic or Free tier to run pre-production environments. These tiers are low performance and low cost. If you use the Basic or Free tier, use governance to enforce the tier, constrain the number of instances and CPUs, restrict scaling, and limit log retention.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "0cfc5cbc-61b7-4b64-a2eb-52e15c243cad",
            "service": "Web Apps",
            "text": "Implement design patterns: This strategy reduces the volume of requests that your workload generates. Consider using patterns like the Backends for Frontends pattern and the Gateway Aggregation pattern, which can minimize the number of requests and reduce costs.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "300e19c7-7406-47ca-aeca-bca5032f2b8a",
            "service": "Web Apps",
            "text": "Regularly check data-related costs: Extended data retention periods or expensive storage tiers can lead to high storage costs. More expenses can accumulate due to both bandwidth usage and prolonged retention of logging data.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "085263b2-cffe-4537-9ecb-75ef967c2985",
            "service": "Web Apps",
            "text": "Optimize deployment costs: Take advantage of deployment slots to optimize costs. The slot runs in the same compute environment as the production instance. Use them strategically for scenarios like blue-green deployments that switch between slots. This approach minimizes downtime and ensures smooth transitions.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "The Free and Basic tiers are budget-friendly compared to higher tiers. They provide a cost-effective solution for nonproduction environments that don't need the full features and performance of premium plans.",
            "guid": "df7294a6-460e-4d50-b4a9-66141caada1d",
            "service": "Web Apps",
            "text": "(App Service plan) Choose Free or Basic tiers for lower environments. We recommend these tiers for experimental use. Remove the tiers when you no longer need them.",
            "type": "recommendation",
            "waf": "Cost"
        },
        {
            "description": "Dev/test plans provide reduced rates for Azure services, which makes them cost-effective for nonproduction environments.  Use reserved instances to prepay for compute resources and get significant discounts.",
            "guid": "a4bd3bc2-554f-483f-9707-dcf9f1b7cdd2",
            "service": "Web Apps",
            "text": "(App Service plan) Take advantage of discounts and explore preferred pricing for:  - Lower environments with dev/test plans.  - Azure reservations and Azure savings plans for dedicated compute that you provision in the Premium V3 tier and App Service Environment.  Use reserved instances for stable workloads that have predictable usage patterns.",
            "type": "recommendation",
            "waf": "Cost"
        },
        {
            "description": "You can identify cost spikes, inefficiencies, or unexpected expenses early on. This proactive approach helps you to provide budgetary controls to prevent overspending.",
            "guid": "12f02b69-d400-403d-9e8a-1a67ed102764",
            "service": "Web Apps",
            "text": "(App Service) Monitor costs that App Service resources incur. Run the cost analysis tool in the Azure portal.  Create budgets and alerts to notify stakeholders.",
            "type": "recommendation",
            "waf": "Cost"
        },
        {
            "description": "Prevent wastage and reduce unnecessary expenses.",
            "guid": "e48373a3-b551-4715-853c-dee4f114466e",
            "service": "Web Apps",
            "text": "(App Service plan) Scale in when demand decreases. To scale in, define scale rules to reduce the number of instances in Azure Monitor.",
            "type": "recommendation",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "3aa6c22d-807b-4efd-9ebe-b290c995d0b3",
            "service": "Web Apps",
            "text": "Manage releases: Use deployment slots to manage releases effectively. You can deploy your application to a slot, perform testing, and validate its functionality. After verification, you can seamlessly move the app to production. This process doesn't incur extra costs because the slot runs in the same virtual machine (VM) environment as the production instance.",
            "type": "checklist",
            "waf": "Operations"
        },
        {
            "description": "",
            "guid": "751098a9-7103-4250-bd52-f48a5fbe8b73",
            "service": "Web Apps",
            "text": "Run automated tests: Before you promote a release of your web app, thoroughly test its performance, functionality, and integration with other components. Use Azure Load Testing, which integrates with Apache JMeter, a popular tool for performance testing. Explore automated tools for other types of testing, such as Phantom for functional testing.",
            "type": "checklist",
            "waf": "Operations"
        },
        {
            "description": "",
            "guid": "0de22a93-9404-4512-b374-6c753628943e",
            "service": "Web Apps",
            "text": "Deploy immutable units: Implement the Deployment Stamps pattern to compartmentalize App Service into an immutable stamp. App Service supports the use of containers, which are inherently immutable. Consider custom containers for your App Service web app.",
            "type": "checklist",
            "waf": "Operations"
        },
        {
            "description": "",
            "guid": "3175ebdb-2846-4f48-b450-278df163c188",
            "service": "Web Apps",
            "text": "Keep production environments safe: Create separate App Service plans to run production and pre-production environments. Don't make changes directly in the production environment to ensure stability and reliability. Separate instances allow flexibility in development and testing before you promote changes to production.",
            "type": "checklist",
            "waf": "Operations"
        },
        {
            "description": "",
            "guid": "b883e190-a830-4bf4-8c08-ee3b85248abf",
            "service": "Web Apps",
            "text": "Manage certificates: For custom domains, you need to manage TLS certificates.",
            "type": "checklist",
            "waf": "Operations"
        },
        {
            "description": "You can detect problems promptly and take necessary actions to maintain availability and performance.",
            "guid": "75f6aad9-2abc-4171-9715-ba708928d39a",
            "service": "Web Apps",
            "text": "(App Service) Monitor the health of your instances and activate instance health probes. Set up a specific path for handling health probe requests.",
            "type": "recommendation",
            "waf": "Operations"
        },
        {
            "description": "Diagnostic logs provide valuable insights into your app's behavior. Monitor traffic patterns and identify anomalies.",
            "guid": "91d861ad-a4ae-462e-8775-56cbecb31951",
            "service": "Web Apps",
            "text": "(App Service) Enable diagnostics logs for the application and the instance.  Frequent logging can slow down the performance of the system, add to storage costs, and introduce risk if you have unsecure access to logs. Follow these best practices:  - Log the right level of information.  - Set retention policies.  - Keep an audit trail of authorized access and unauthorized attempts. - Treat logs as data and apply data-protection controls.",
            "type": "recommendation",
            "waf": "Operations"
        },
        {
            "description": "App Service automatically handles processes like certificate procurement, certificate verification, certificate renewal, and importing certificates from Key Vault. Alternatively, upload your certificate to Key Vault and authorize the App Service resource provider to access it.",
            "guid": "70e24ecc-5113-4d7d-8a79-8ac24fe1f838",
            "service": "Web Apps",
            "text": "(App Service) Take advantage of App Service managed certificates to offload certification management to Azure.",
            "type": "recommendation",
            "waf": "Operations"
        },
        {
            "description": "Avoid downtime and errors.  Quickly revert to the last-known good state if you detect a problem after a swap.",
            "guid": "7a592a00-a940-4d2e-a919-56ad3237092e",
            "service": "Web Apps",
            "text": "(App Service plan) Validate app changes in the staging slot before you swap it with the production slot.",
            "type": "recommendation",
            "waf": "Operations"
        },
        {
            "description": "",
            "guid": "018624c9-6396-4e1c-8b0c-83d39b40c2a1",
            "service": "Web Apps",
            "text": "Identify and monitor performance indicators: Set targets for the key indicators for the application, such as the volume of incoming requests, time that the application takes to respond to requests, pending requests, and errors in HTTP responses. Consider key indicators as part of the performance baseline for the workload.",
            "type": "checklist",
            "waf": "Performance"
        },
        {
            "description": "",
            "guid": "c66aabbd-8b2a-4295-9492-78cd5aea690a",
            "service": "Web Apps",
            "text": "Assess capacity: Simulate various user scenarios to determine the optimal capacity that you need to handle expected traffic. Use Load Testing to understand how your application behaves under different levels of load.",
            "type": "checklist",
            "waf": "Performance"
        },
        {
            "description": "",
            "guid": "7e11019e-4329-458a-b84a-9233aa8de1a5",
            "service": "Web Apps",
            "text": "Select the right tier: Use dedicated compute for production workloads. Premium tiers offer larger SKUs with increased memory and CPU capacity, more instances, and more features, such as zone redundancy. For more information, see Premium V3 pricing tier.",
            "type": "checklist",
            "waf": "Performance"
        },
        {
            "description": "",
            "guid": "97fdfb16-a73b-497a-853a-fe608cfc1750",
            "service": "Web Apps",
            "text": "Optimize your scaling strategy: When possible, use autoscaling instead of manually adjusting the number of instances as application load changes. With autoscaling, App Service adjusts server capacity based on predefined rules or triggers. Make sure you do adequate performance testing and set the right rules for the right triggers.",
            "type": "checklist",
            "waf": "Performance"
        },
        {
            "description": "",
            "guid": "45d7e1a5-2b7e-4b6b-8925-bf0b760a9d7e",
            "service": "Web Apps",
            "text": "Use caching: Retrieving information from a resource that doesn't change frequently and is expensive to access affects performance. Complex queries, including joins and multiple lookups, contribute to runtime. Perform caching to minimize the processing time and latency. Cache query results to avoid repeated round trips to the database or back end and reduce processing time for subsequent requests.",
            "type": "checklist",
            "waf": "Performance"
        },
        {
            "description": "",
            "guid": "c8094d1c-6371-4984-98c1-ca5d72a7732d",
            "service": "Web Apps",
            "text": "Review the performance antipatterns: To make sure the web application performs and scales in accordance with your business requirements, avoid the typical antipatterns. Here are some antipatterns that App Service corrects.",
            "type": "checklist",
            "waf": "Performance"
        },
        {
            "description": "The application is never unloaded with Always On enabled.",
            "guid": "2c97ff90-e7cd-4888-a0c9-c21ea287071c",
            "service": "Web Apps",
            "text": "Enable the Always On setting when applications share a single App Service plan. App Service apps automatically unload when idle to save resources. The next request triggers a cold start, which can cause request timeouts.",
            "type": "recommendation",
            "waf": "Performance"
        },
        {
            "description": "Choose HTTP/2 over HTTP/1.1 because HTTP/2 fully multiplexes connections, reuses connections to reduce overhead, and compresses headers to minimize data transfer.",
            "guid": "d735fb9e-9e87-415c-93d0-4918b5cf104e",
            "service": "Web Apps",
            "text": "Consider using HTTP/2 for applications to improve protocol efficiency.",
            "type": "recommendation",
            "waf": "Performance"
        },
        {
            "description": "",
            "guid": "ee4fab35-3fcf-469c-aa4a-baaa7ea46a76",
            "service": "AppGW",
            "text": "Deploy the instances in a zone-aware configuration, where available.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "897c9b7a-c56c-4390-9938-71ed0ee875d8",
            "service": "AppGW",
            "text": "Use Application Gateway with Web Application Firewall (WAF) within a virtual network to protect inbound `HTTP/S` traffic from the Internet.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "9d1d0113-dcc3-4309-bf89-57f43eff537c",
            "service": "AppGW",
            "text": "In new deployments, use Azure Application Gateway v2 unless there is a compelling reason to use Azure Application Gateway v1.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "f6991e25-5c9d-4b36-9df6-d4cd17d6d7cc",
            "service": "AppGW",
            "text": "Plan for rule updates",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "93d5c5fc-95da-40dc-a935-bcdf72bb49bc",
            "service": "AppGW",
            "text": "Use health probes to detect backend unavailability",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "e4a0745d-0b8a-459b-8fc0-0399061a6425",
            "service": "AppGW",
            "text": "Review the impact of the interval and threshold settings on health probes",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "4d7b12c2-d9bb-4547-8238-c2c93491afed",
            "service": "AppGW",
            "text": "Verify downstream dependencies through health endpoints",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "Plan enough time for updates before accessing Application Gateway or making further changes. For example, removing servers from backend pool might take some time because they have to drain existing connections.",
            "guid": "f6991e25-5c9d-4b36-9df6-d4cd17d6d7cc",
            "service": "AppGW",
            "text": "Plan for rule updates",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "If Application Gateway is used to load balance incoming traffic over multiple backend instances, we recommend the use of health probes. These will ensure that traffic is not routed to backends that are unable to handle the traffic.",
            "guid": "93d5c5fc-95da-40dc-a935-bcdf72bb49bc",
            "service": "AppGW",
            "text": "Use health probes to detect backend unavailability",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "The health probe sends requests to the configured endpoint at a set interval. Also, there's a threshold of failed requests that will be tolerated before the backend is marked unhealthy. These numbers present a trade-off.- Setting a higher interval puts a higher load on your service. Each Application Gateway instance sends its own health probes, so 100 instances every 30 seconds means 100 requests per 30 seconds.- Setting a lower interval leaves more time before an outage is detected.- Setting a low unhealthy threshold might mean that short, transient failures might take down a backend. - Setting a high threshold it can take longer to take a backend out of rotation.",
            "guid": "e4a0745d-0b8a-459b-8fc0-0399061a6425",
            "service": "AppGW",
            "text": "Review the impact of the interval and threshold settings on health probes",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Suppose each backend has its own dependencies to ensure failures are isolated. For example, an application hosted behind Application Gateway might have multiple backends, each connected to a different database (replica). When such a dependency fails, the application might be working but won't return valid results. For that reason, the health endpoint should ideally validate all dependencies. Keep in mind that if each call to the health endpoint has a direct dependency call, that database would receive 100 queries every 30 seconds instead of 1. To avoid this, the health endpoint should cache the state of the dependencies for a short period of time.",
            "guid": "4d7b12c2-d9bb-4547-8238-c2c93491afed",
            "service": "AppGW",
            "text": "Verify downstream dependencies through health endpoints",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Certain scenarios can force you to implement rules specifically on Application Gateway. For example, if ModSec CRS 2.2.9, CRS 3.0 or CRS 3.1 rules are required, these rules can be only implemented on Application Gateway. Conversely, rate-limiting and geo-filtering are available only on Azure Front Door, not on AppGateway.",
            "guid": "2cc68719-238d-40f1-9eda-37a4b77cabc2",
            "service": "AppGW",
            "text": "When using Azure Front Door and Application Gateway to protect `HTTP/S` applications, use WAF policies in Front Door and lock down Application Gateway to receive traffic only from Azure Front Door.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "c394ed0c-ddb2-4efa-b4eb-deb2f11cff32",
            "service": "AppGW",
            "text": "Set up a TLS policy for enhanced security",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "f2c0a397-56bb-45f1-ac4d-b1837045db05",
            "service": "AppGW",
            "text": "Use AppGateway for TLS termination",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "db6594c5-00d9-42e3-9190-0da310bd8af5",
            "service": "AppGW",
            "text": "Use Azure Key Vault to store TLS certificates",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "79778b7d-1a8d-47bf-9000-cfe8f28007ed",
            "service": "AppGW",
            "text": "When re-encrypting backend traffic, ensure the backend server certificate contains both the root and intermediate Certificate Authorities (CAs)",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "32630271-62af-4005-933b-36e73b3d6c43",
            "service": "AppGW",
            "text": "Use an appropriate DNS server for backend pool resources",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "5644f4cb-0c54-41d6-9aff-27357089743c",
            "service": "AppGW",
            "text": "Comply with all NSG restrictions for Application Gateway",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "5ff5e810-ac1d-42ef-9a30-812c15c42be8",
            "service": "AppGW",
            "text": "Refrain from using UDRs on the Application Gateway subnet",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "3ac67acb-dcca-413d-b0f9-50441d51675f",
            "service": "AppGW",
            "text": "Be aware of Application Gateway capacity changes when enabling WAF",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "Set up a TLS policy for extra security. Ensure you're always using the latest TLS policy version available. This enforces TLS 1.2 and stronger ciphers.",
            "guid": "c394ed0c-ddb2-4efa-b4eb-deb2f11cff32",
            "service": "AppGW",
            "text": "Set up a TLS policy for enhanced security",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "There are advantages of using Application Gateway for TLS termination:- Performance improves because requests going to different backends to have to re-authenticate to each backend.- Better utilization of backend servers because they don't have to perform TLS processing- Intelligent routing by accessing the request content.- Easier certificate management because the certificate only needs to be installed on Application Gateway.",
            "guid": "f2c0a397-56bb-45f1-ac4d-b1837045db05",
            "service": "AppGW",
            "text": "Use AppGateway for TLS termination",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Application Gateway can be integrated with Key Vault. This provides stronger security, easier separation of roles and responsibilities, support for managed certificates, and an easier certificate renewal and rotation process.",
            "guid": "db6594c5-00d9-42e3-9190-0da310bd8af5",
            "service": "AppGW",
            "text": "Use Azure Key Vault to store TLS certificates",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "A TLS certificate of the backend server must be issued by a well-known CA. If the certificate was not issued by a trusted CA, the Application Gateway checks if the certificate was issued by a trusted CA, and so on, until a trusted CA certificate is found. Only then a secure connection is established. Otherwise, Application Gateway marks the backend as unhealthy.",
            "guid": "79778b7d-1a8d-47bf-9000-cfe8f28007ed",
            "service": "AppGW",
            "text": "When re-encrypting backend traffic, ensure the backend server certificate contains both the root and intermediate Certificate Authorities (CAs)",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "When the backend pool contains a resolvable FQDN, the DNS resolution is based on a private DNS zone or custom DNS server (if configured on the VNet), or it uses the default Azure-provided DNS.",
            "guid": "32630271-62af-4005-933b-36e73b3d6c43",
            "service": "AppGW",
            "text": "Use an appropriate DNS server for backend pool resources",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "NSGs are supported on Application Gateway subnet, but there are some restrictions. For instance, some communication with certain port ranges is prohibited. Make sure you understand the implications of those restrictions. For details, see Network security groups.",
            "guid": "5644f4cb-0c54-41d6-9aff-27357089743c",
            "service": "AppGW",
            "text": "Comply with all NSG restrictions for Application Gateway",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Using User Defined Routes (UDR) on the Application Gateway subnet can cause some issues. Health status in the back-end might be unknown. Application Gateway logs and metrics might not get generated. We recommend that you don't use UDRs on the Application Gateway subnet so that you can view the back-end health, logs, and metrics. If your organizations require to use UDR in the Application Gateway subnet, please ensure you review the supported scenarios. For more information, see Supported user-defined routes.",
            "guid": "96ac0266-6e5d-4944-bccb-0c6b3bd00b89",
            "service": "AppGW",
            "text": "Refrain from using UDRs on the Application gateway subnet",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "When WAF is enabled, every request must be buffered by the Application Gateway until it fully arrives, checks if the request matches with any rule violation in its core rule set, and then forwards the packet to the backend instances. When there are large file uploads (30MB+ in size), it can result in a significant latency. Because Application Gateway capacity requirements are different with WAF, we do not recommend enabling WAF on Application Gateway without proper testing and validation.",
            "guid": "3ac67acb-dcca-413d-b0f9-50441d51675f",
            "service": "AppGW",
            "text": "Be aware of Application Gateway capacity changes when enabling WAF",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "dc1995b1-dcc3-4864-a862-0c5ceeb3452c",
            "service": "AppGW",
            "text": "Familiarize yourself with Application Gateway pricing",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "baadcfab-050c-4d30-a79a-a235e775836a",
            "service": "AppGW",
            "text": "Review underutilized resources",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "03e1fbfa-86c2-4550-a6aa-e111d6ab895d",
            "service": "AppGW",
            "text": "Stop Application Gateway instances that are not in use",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "a63e6bb7-8040-4b43-9d0e-6ca8a3413315",
            "service": "AppGW",
            "text": "Have a scale-in and scale-out policy",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "352664a9-dea7-4e45-9f4a-b1160768ac1b",
            "service": "AppGW",
            "text": "Review consumption metrics across different parameters",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "For information about Application Gateway pricing, see Understanding Pricing for Azure Application Gateway and Web Application Firewall. You can also leverage the Pricing calculator.Ensure that the options are adequately sized to meet the capacity demand and deliver expected performance without wasting resources.",
            "guid": "dc1995b1-dcc3-4864-a862-0c5ceeb3452c",
            "service": "AppGW",
            "text": "Familiarize yourself with Application Gateway pricing",
            "type": "recommendation",
            "waf": "Cost"
        },
        {
            "description": "Identify and delete Application Gateway instances with empty backend pools to avoid unnecessary costs.",
            "guid": "baadcfab-050c-4d30-a79a-a235e775836a",
            "service": "AppGW",
            "text": "Review underutilized resources",
            "type": "recommendation",
            "waf": "Cost"
        },
        {
            "description": "You aren't billed when Application Gateway is in the stopped state. Continuously running Application Gateway instances can incur extraneous costs. Evaluate usage patterns and stop instances when you don't need them. For example, usage after business hours in Dev/Test environments is expected to be low.See these articles for information about how to stop and start instances.- Stop-AzApplicationGateway- Start-AzApplicationGateway",
            "guid": "6af81413-0516-4067-9e26-8aad8d2d06ca",
            "service": "AppGW",
            "text": "Stop Application Gateway instances when not in use",
            "type": "recommendation",
            "waf": "Cost"
        },
        {
            "description": "A scale-out policy ensures that there will be enough instances to handle incoming traffic and spikes. Also, have a scale-in policy that makes sure the number of instances are reduced when demand drops. Consider the choice of instance size. The size can significantly impact the cost. Some considerations are described in the Estimate the Application Gateway instance count.For more information, see What is Azure Application Gateway v2?",
            "guid": "a63e6bb7-8040-4b43-9d0e-6ca8a3413315",
            "service": "AppGW",
            "text": "Have a scale-in and scale-out policy",
            "type": "recommendation",
            "waf": "Cost"
        },
        {
            "description": "You're billed based on metered instances of Application Gateway based on the metrics tracked by Azure. Evaluate the various metrics and capacity units and determine the cost drivers. For more information, see Microsoft Cost Management and Billing. The following metrics are key for Application Gateway. This information can be used to validate that the provisioned instance count matches the amount of incoming traffic.- Estimated Billed Capacity Units- Fixed Billable Capacity Units- Current Capacity UnitsFor more information, see Application Gateway metrics.Make sure you account for bandwidth costs.",
            "guid": "352664a9-dea7-4e45-9f4a-b1160768ac1b",
            "service": "AppGW",
            "text": "Review consumption metrics across different parameters",
            "type": "recommendation",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "2aeef441-2f0c-4f28-b3fe-85bb210e70d4",
            "service": "AppGW",
            "text": "Monitor capacity metrics",
            "type": "checklist",
            "waf": "Operations"
        },
        {
            "description": "",
            "guid": "2a3d27da-fdb8-49b0-95ed-7f9b32b4f7ca",
            "service": "AppGW",
            "text": "Enable diagnostics on Application Gateway and Web Application Firewall (WAF)",
            "type": "checklist",
            "waf": "Operations"
        },
        {
            "description": "",
            "guid": "69a9c288-6a98-447b-92f8-68c84adc85cd",
            "service": "AppGW",
            "text": "Use Azure Monitor Network Insights",
            "type": "checklist",
            "waf": "Operations"
        },
        {
            "description": "",
            "guid": "82f522dd-25e0-4e7c-a547-bc23577f7f1c",
            "service": "AppGW",
            "text": "Match timeout settings with the backend application",
            "type": "checklist",
            "waf": "Operations"
        },
        {
            "description": "",
            "guid": "6f9954fb-dff1-4d54-8672-0c1245908dca",
            "service": "AppGW",
            "text": "Monitor Key Vault configuration issues using Azure Advisor",
            "type": "checklist",
            "waf": "Operations"
        },
        {
            "description": "",
            "guid": "78bbcbf2-30c3-4c77-8e8f-8faf4c4b817d",
            "service": "AppGW",
            "text": "Configure and monitor SNAT port limitations",
            "type": "checklist",
            "waf": "Operations"
        },
        {
            "description": "",
            "guid": "ca428415-6120-410f-9a91-c1baeb6c0084",
            "service": "AppGW",
            "text": "Consider SNAT port limitations in your design",
            "type": "checklist",
            "waf": "Operations"
        },
        {
            "description": "Use these metrics as indicators of utilization of the provisioned Application Gateway capacity. We strongly recommend setting up alerts on capacity. For details, see Application Gateway high traffic support.",
            "guid": "2aeef441-2f0c-4f28-b3fe-85bb210e70d4",
            "service": "AppGW",
            "text": "Monitor capacity metrics",
            "type": "recommendation",
            "waf": "Operations"
        },
        {
            "description": "There are other metrics that can indicate issues either at Application Gateway or the backend. We recommend evaluating the following alerts:- Unhealthy Host Count- Response Status (dimension 4xx and 5xx)- Backend Response Status (dimension 4xx and 5xx)- Backend Last Byte Response Time- Application Gateway Total TimeFor more information, see Metrics for Application Gateway.",
            "guid": "af883a3e-1ece-4f8a-9732-95a461fe244c",
            "service": "AppGW",
            "text": "Troubleshoot using metrics",
            "type": "recommendation",
            "waf": "Operations"
        },
        {
            "description": "Diagnostic logs allow you to view firewall logs, performance logs, and access logs. Use these logs to manage and troubleshoot issues with Application Gateway instances. For more information, see Back-end health and diagnostic logs for Application Gateway.",
            "guid": "2a3d27da-fdb8-49b0-95ed-7f9b32b4f7ca",
            "service": "AppGW",
            "text": "Enable diagnostics on Application Gateway and Web Application Firewall (WAF)",
            "type": "recommendation",
            "waf": "Operations"
        },
        {
            "description": "Azure Monitor Network Insights provides a comprehensive view of health and metrics for network resources, including Application Gateway. For additional details and supported capabilities for Application Gateway, see Azure Monitor Network insights.",
            "guid": "69a9c288-6a98-447b-92f8-68c84adc85cd",
            "service": "AppGW",
            "text": "Use Azure Monitor Network Insights",
            "type": "recommendation",
            "waf": "Operations"
        },
        {
            "description": "Ensure you have configured the IdleTimeout settings to match the listener and traffic characteristics of the backend application. The default value is set to four minutes and can be configured to a maximum of 30. For more information, see Load Balancer TCP Reset and Idle Timeout.For workload considerations, see Monitoring application health for reliability.",
            "guid": "82f522dd-25e0-4e7c-a547-bc23577f7f1c",
            "service": "AppGW",
            "text": "Match timeout settings with the backend application",
            "type": "recommendation",
            "waf": "Operations"
        },
        {
            "description": "Application Gateway checks for the renewed certificate version in the linked Key Vault at every 4-hour interval. If it is inaccessible due to any incorrect Key Vault configuration, it logs that error and pushes a corresponding Advisor recommendation. You must configure the Advisor alerts to stay updated and fix such issues immediately to avoid any Control or Data plane related problems. For more information, see Investigating and resolving key vault errors. To set an alert for this specific case, use the Recommendation Type as Resolve Azure Key Vault issue for your Application Gateway.",
            "guid": "6f9954fb-dff1-4d54-8672-0c1245908dca",
            "service": "AppGW",
            "text": "Monitor Key Vault configuration issues using Azure Advisor",
            "type": "recommendation",
            "waf": "Operations"
        },
        {
            "description": "SNAT port limitations are important for backend connections on the Application Gateway. There are separate factors that affect how Application Gateway reaches the SNAT port limit. For example, if the backend is a public IP address, it will require its own SNAT port. In order to avoid SNAT port limitations, you can increase the number of instances per Application Gateway, scale out the backends to have more IP addresses, or move your backends into the same virtual network and use private IP addresses for the backends.Requests per second (RPS) on the Application Gateway will be affected if the SNAT port limit is reached. For example, if an Application Gateway reaches the SNAT port limit, then it won't be able to open a new connection to the backend, and the request will fail.",
            "guid": "ca428415-6120-410f-9a91-c1baeb6c0084",
            "service": "AppGW",
            "text": "Consider SNAT port limitations in your design",
            "type": "recommendation",
            "waf": "Operations"
        },
        {
            "description": "",
            "guid": "261fdf60-ce3b-4abd-8a85-b39ebb208df9",
            "service": "AppGW",
            "text": "Estimate the Application Gateway instance count",
            "type": "checklist",
            "waf": "Performance"
        },
        {
            "description": "",
            "guid": "895dcecb-9895-4a39-bafd-4df574353366",
            "service": "AppGW",
            "text": "Define the maximum instance count",
            "type": "checklist",
            "waf": "Performance"
        },
        {
            "description": "",
            "guid": "4d24ceaf-6ff5-4b88-96e2-851546c368c1",
            "service": "AppGW",
            "text": "Define the minimum instance count",
            "type": "checklist",
            "waf": "Performance"
        },
        {
            "description": "",
            "guid": "57675336-826b-4523-b248-bfe3c324c38a",
            "service": "AppGW",
            "text": "Define Application Gateway subnet size",
            "type": "checklist",
            "waf": "Performance"
        },
        {
            "description": "",
            "guid": "958240c8-23f1-447d-9cb7-ce9edb5aa606",
            "service": "AppGW",
            "text": "Take advantage of Application Gateway V2 features for autoscaling and performance benefits",
            "type": "checklist",
            "waf": "Performance"
        },
        {
            "description": "For Application Gateway v2 SKU, autoscaling takes some time (approximately six to seven minutes) before the additional set of instances is ready to serve traffic. During that time, if there are short spikes in traffic, expect transient latency or loss of traffic.We recommend that you set your minimum instance count to an optimal level. After you estimate the average instance count and determine your Application Gateway autoscaling trends, define the minimum instance count based on your application patterns. For information, see Application Gateway high traffic support.Check the Current Compute Units for the past one month. This metric represents the gateway's CPU utilization. To define the minimum instance count, divide the peak usage by 10. For example, if your average Current Compute Units in the past month is 50, set the minimum instance count to five.",
            "guid": "4d24ceaf-6ff5-4b88-96e2-851546c368c1",
            "service": "AppGW",
            "text": "Define the minimum instance count",
            "type": "recommendation",
            "waf": "Performance"
        },
        {
            "description": "We recommend 125 as the maximum autoscale instance count. Make sure the subnet that has the Application Gateway has sufficient available IP addresses to support the scale-up set of instances.Setting the maximum instance count to 125 has no cost implications because you're billed only for the consumed capacity.",
            "guid": "895dcecb-9895-4a39-bafd-4df574353366",
            "service": "AppGW",
            "text": "Define the maximum instance count",
            "type": "recommendation",
            "waf": "Performance"
        },
        {
            "description": "Application Gateway needs a dedicated subnet within a virtual network. The subnet can have multiple instances of the deployed Application Gateway resource. You can also deploy other Application Gateway resources in that subnet, v1 or v2 SKU.Here are some considerations for defining the subnet size:- Application Gateway uses one private IP address per instance and another private IP address if a private front-end IP is configured.- Azure reserves five IP addresses in each subnet for internal use.- Application Gateway (Standard or WAF SKU) can support up to 32 instances. Taking 32 instance IP addresses + 1 private front-end IP + 5 Azure reserved, a minimum subnet size of /26 is recommended. Because the Standard_v2 or WAF_v2 SKU can support up to 125 instances, using the same calculation, a subnet size of /24 is recommended.- If you want to deploy additional Application Gateway resources in the same subnet, consider the additional IP addresses that will be required for their maximum instance count for both, Standard and Standard v2.",
            "guid": "57675336-826b-4523-b248-bfe3c324c38a",
            "service": "AppGW",
            "text": "Define Application Gateway subnet size",
            "type": "recommendation",
            "waf": "Performance"
        },
        {
            "description": "The v2 SKU offers autoscaling to ensure that your Application Gateway can scale up as traffic increases. When compared to v1 SKU, v2 has capabilities that enhance the performance of the workload. For example, better TLS offload performance, quicker deployment and update times, zone redundancy, and more. For more information about autoscaling features, see Scaling Application Gateway v2 and WAF v2.If you are running v1 SKU Application gateway, consider migrating to the Application gateway v2 SKU. For more information, see Migrate Azure Application Gateway and Web Application Firewall from v1 to v2.",
            "guid": "508791c8-897f-4490-8590-fc33a9df8f73",
            "service": "AppGW",
            "text": "Take advantage of features for autoscaling and performance benefits",
            "type": "recommendation",
            "waf": "Performance"
        },
        {
            "description": "",
            "guid": "d68b4fc0-fd9c-499a-9fd4-2c572735bd36",
            "service": "Blob Storage",
            "text": "Use failure mode analysis: Minimize points of failure by considering internal dependencies such as the availability of virtual networks, Azure Key Vault, or Azure Content Delivery Network or Azure Front Door endpoints. Failures can occur if credentials required by workloads to access Blob Storage go missing from Key Vault, or if workloads use an endpoint based on a content delivery network that's removed. In these cases, workloads might need to use an alternative endpoint to connect. For general information about failure mode analysis, see Recommendations for performing failure mode analysis.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "817f9103-607a-4e3d-ba94-1a3adffaff8f",
            "service": "Blob Storage",
            "text": "Define reliability and recovery targets: Review the Azure service-level agreements (SLAs). Derive the service-level objective (SLO) for the storage account. For example, the SLO might be affected by the redundancy configuration that you chose. Consider the effect of a regional outage, the potential for data loss, and the time required to restore access after an outage. Also consider the availability of any internal dependencies that you identified as part of your failure mode analysis.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "f9c07c6b-c5ab-4e57-83f7-9455042e2e23",
            "service": "Blob Storage",
            "text": "Configure data redundancy: For maximum durability, choose a configuration that copies data across availability zones or global regions. For maximum availability, choose a configuration that allows clients to read data from the secondary region during an outage of the primary region.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "e71dbbd7-5e50-4ade-b5e5-4b9e59d10706",
            "service": "Blob Storage",
            "text": "Design applications: Design applications to seamlessly shift to reading data from the secondary region if the primary region becomes unavailable for any reason. This only applies to geo-redundant storage (GRS) and geo-zone-redundant storage (GZRS) configurations. Designing applications to handle outages reduces downtime for end users.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "2243ff8e-7ce3-4999-9eee-3b3377f4df8b",
            "service": "Blob Storage",
            "text": "Explore features to help you meet your recovery targets: Make blobs restorable so that they can be recovered if they're corrupted, edited, or deleted by mistake.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "3a9677e5-9506-4aaa-bac6-48b5002070c1",
            "service": "Blob Storage",
            "text": "Create a recovery plan: Consider data protection features, backup and restore operations, or failover procedures. Prepare for potential data loss and data inconsistencies and the time and cost of failing over. For more information, see Recommendations for designing a disaster recovery strategy.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "ffdb383d-6a9a-4ebb-b902-12320390dd84",
            "service": "Blob Storage",
            "text": "Monitor potential availability problems: Subscribe to the Azure Service Health dashboard to monitor potential availability problems. Use storage metrics in Azure Monitor and diagnostic logs to investigate alerts.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "Redundancy protects your data against unexpected failures. The ZRS and GZRS configuration options replicate across different availability zones and enable applications to continue reading data during an outage. For more information, see Durability and availability by outage scenario and Durability and availability parameters.",
            "guid": "e426149f-841f-4865-878e-311cfe914db9",
            "service": "Blob Storage",
            "text": "Configure your account for redundancy. For maximum availability and durability, configure your account by using zone-redundant storage (ZRS) or GZRS.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "This property helps you estimate how much data you might lose by initiating an account failover. All data and metadata written before the last synchronization time is available on the secondary region, but data and metadata written after the last synchronization time might be lost because it's not written to the secondary region.",
            "guid": "f42e13de-f6f3-4fad-97f3-f657b8aa1f6c",
            "service": "Blob Storage",
            "text": "Before initiating a failover or failback, evaluate the potential for data loss by checking the value of the last synchronization time property. This recommendation applies only to GRS and GZRS configurations.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "The soft delete option enables a storage account to recover deleted containers and blobs. The versioning option automatically tracks changes made to blobs. This option lets you restore a blob to a previous state.The point-in-time restore option protects against accidental blob deletion or corruption and lets you restore block blob data to an earlier state. For more information, see Data protection overview.",
            "guid": "6ba14c6a-6f37-46a3-a2a8-e38373925d6f",
            "service": "Blob Storage",
            "text": "As a part of your backup and recovery strategy, enable the container soft delete, blob soft delete, versioning, and point-in-time restore options.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "5738d99e-ae27-47ca-959c-0dabef735931",
            "service": "Blob Storage",
            "text": "Review the security baseline for Azure Storage: To get started, first review the security baseline for Storage.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "54dc05f5-631d-41ac-8ad7-40a451e48efd",
            "service": "Blob Storage",
            "text": "Use network controls to restrict ingress and egress traffic: Disable all public traffic to the storage account. Use account network controls to grant the minimal level of access required by users and applications. For more information, see How to approach network security for your storage account.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "3d39bc4a-58c1-4d69-8116-751252d03104",
            "service": "Blob Storage",
            "text": "Reduce the attack surface: Preventing anonymous access, account key access, or access over non-secure (HTTP) connections can reduce the attack surface. Require clients to send and receive data by using the latest version of the Transport Layer Security (TLS) protocol.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "b0e33ead-c6ca-4386-acee-30e929390ca0",
            "service": "Blob Storage",
            "text": "Authorize access without using passwords or keys: Microsoft Entra ID provides superior security and ease of use compared to shared keys and shared access signatures. Grant security principals only those permissions that are necessary for them to do their tasks.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "c2d96110-7950-4f81-8c41-34e1fa015631",
            "service": "Blob Storage",
            "text": "Protect sensitive information: Protect sensitive information such as account keys and shared access signature tokens. While these forms of authorization are generally not recommended, you should make sure to rotate, expire, and store them securely.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "cd6916c2-09f8-4269-971d-60a07e57cbbd",
            "service": "Blob Storage",
            "text": "Enable the secure transfer required option: Enabling this setting for all your storage accounts ensures that all requests made against the storage account must take place over secure connections. Any requests made over HTTP fail.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "f944c199-636d-46b4-bc23-ee8bdfefa7a5",
            "service": "Blob Storage",
            "text": "Protect critical objects: Apply immutability policies to protect critical objects. Policies protect blobs that are stored for legal, compliance, or other business purposes from being modified or deleted. Configure holds for set time periods or until restrictions are lifted by an administrator.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "80a10cbe-93f3-410a-b7ad-d7b5234add61",
            "service": "Blob Storage",
            "text": "Detect threats: Enable Microsoft Defender for Storage to detect threats. Security alerts are triggered when anomalies in activity occur. The alerts notify subscription administrators via email with details of suspicious activity and recommendations on how to investigate and remediate threats.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "When anonymous access is allowed for a storage account, a user that has the appropriate permissions can modify a container's anonymous access setting to enable anonymous access to the data in that container.",
            "guid": "4380d8e1-fdb6-45da-a1e1-109e162f43d3",
            "service": "Blob Storage",
            "text": "Disable anonymous read access to containers and blob.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Locking an account prevents it from being deleted and causing data loss.",
            "guid": "09543d14-a0c7-49dc-89d1-74b1913c3b03",
            "service": "Blob Storage",
            "text": "Apply an Azure Resource Manager lock on the storage account.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Start with zero access and then incrementally authorize the lowest levels of access required for clients and services to minimize the risk of creating unnecessary openings for attackers.",
            "guid": "1b8c4090-6b15-45e0-8833-ee5285ebd444",
            "service": "Blob Storage",
            "text": "Disable traffic to the public endpoints of your storage account. Create private endpoints for clients that run in Azure. Enable the public endpoint only if clients and services external to Azure require direct access to your storage account. Enable firewall rules that limit access to specific virtual networks.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "With RBAC, there are no passwords or keys that can be compromised. The security principal (user, group, managed identity, or service principal) is authenticated by Microsoft Entra ID to return an OAuth 2.0 token. The token is used to authorize a request against the Blob Storage service.",
            "guid": "2ecbd38b-7ae5-4858-916a-0554e8f2d41d",
            "service": "Blob Storage",
            "text": "Authorize access by using Azure role-based access control (RBAC).",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Only secured requests that are authorized with Microsoft Entra ID are permitted.",
            "guid": "4d731629-d6d3-4aa9-b46f-6259451f08f0",
            "service": "Blob Storage",
            "text": "Disallow shared key authorization. This disables not only account key access but also service and account shared access signature tokens because they're based on account keys.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Key Vault lets you retrieve keys at runtime, instead of saving them by using your application. Key Vault also makes it easy to rotate your keys without interruption to your applications. Rotating the account keys periodically reduces the risk of exposing your data to malicious attacks.",
            "guid": "62ae35d2-7f0b-4c63-b0ff-1a1f85d39b89",
            "service": "Blob Storage",
            "text": "We recommend that you don't use an account key. If you must use account keys, then store them in Key Vault, and make sure that you regenerate them periodically.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Best practices can help you prevent a shared access signature token from being leaked and quickly recover if a leak does occur.",
            "guid": "e2163930-a35e-415f-bea3-a019e5c2a5c7",
            "service": "Blob Storage",
            "text": "We recommend that you don't use shared access signature tokens. Evaluate whether you need shared access signature tokens to secure access to Blob Storage resources. If you must create one, then review this list of shared access signature best practices before you create and distribute it.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "TLS 1.2 is more secure and faster than TLS 1.0 and 1.1, which don't support modern cryptographic algorithms and cipher suites.",
            "guid": "d586222d-d9d1-4f51-ba29-58021c0ee0ae",
            "service": "Blob Storage",
            "text": "Configure your storage account so clients can send and receive data by using the minimum version of TLS 1.2.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Customer-managed keys provide greater flexibility and control. For example, you can store encryption keys in Key Vault and automatically rotate them.",
            "guid": "33303cd1-5b9c-4688-aa24-50cb53f5caac",
            "service": "Blob Storage",
            "text": "Consider using your own encryption key to protect the data in your storage account. For more information, see Customer-managed keys for Azure Storage encryption.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "6f7ce98b-ec2c-4535-9e6a-11c077c9bd3f",
            "service": "Blob Storage",
            "text": "Identify the meters that are used to calculate your bill: Meters are used to track the amount of data stored in the account (data capacity) and the number and type of operations that are performed to write and read data. There are also meters associated with the use of optional features such as blob index tags, blob inventory, change feed support, encryption scopes, and SSH File Transfer Protocol (SFTP) support. For more information, see How you're charged for Blob Storage.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "0c2e2825-34c7-4ad5-ad21-a270b1b402c0",
            "service": "Blob Storage",
            "text": "Understand the price of each meter: Make sure to use the appropriate pricing page and apply the appropriate settings in that page. For more information, see Finding the unit price for each meter. Consider the number of operations associated with each price. For example, the price associated with write and read operations applies to 10,000 operations. To determine the price of an individual operation, divide the listed price by 10,000.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "31b047a5-abfe-4452-ad3e-a4b99cad0e4b",
            "service": "Blob Storage",
            "text": "Estimate the cost of capacity and operations: You can model the costs associated with data storage, ingress, and egress by using the Azure pricing calculator. Use fields to compare the cost associated with various regions, account types, namespace types, and redundancy configurations. For certain scenarios, you can use sample calculations and worksheets available in Microsoft documentation. For example, you can estimate the cost of archiving data or estimate the cost of using the AzCopy command to transfer blobs.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "51e5c8d4-4794-4514-bb01-54a517927a05",
            "service": "Blob Storage",
            "text": "Choose a billing model for capacity: Evaluate whether using a commitment-based model is more cost-efficient than using a consumption-based model. If you're unsure about how much capacity you need, you can start with a consumption-based model, monitor the capacity metrics, and then evaluate later.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "8a5b488c-2b97-4e55-8997-659d64c62030",
            "service": "Blob Storage",
            "text": "Choose an account type, a redundancy level, and a default access tier: You must select a value for each of these settings when you create a storage account. All the values affect transaction charges and capacity charges. All these settings except for the account type can be changed after the account is created.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "b675b5be-352c-4a06-94ed-8457e3d5db8c",
            "service": "Blob Storage",
            "text": "Choose the most cost-effective default access tier: Unless a tier is specified with each blob upload, blobs infer their access tier from the default access tier setting. A change to the default access tier setting of a storage account applies to all blobs in the account for which an access tier hasn't been explicitly set. This cost could be significant if you've collected a large number of blobs. For more information about how a tier change affects each existing blob, see Changing a blob's access tier.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "fbf53f6f-f5af-47ef-8e28-e471bf173884",
            "service": "Blob Storage",
            "text": "Upload data directly to the most cost-efficient access tier: For example, if the default access tier setting of your account is hot, but you're uploading files for archiving purposes, specify a cooler tier as the archive or a cold tier as part of your upload operation. After uploading blobs, use lifecycle management policies to move blobs to the most cost-efficient tiers based on usage metrics such as the last accessed time. Choosing the most optimal tier up front can reduce costs. If you change the tier of a block blob that you already uploaded, then you pay the cost of writing to the initial tier when you first upload the blob, and then pay the cost of writing to the desired tier.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "3549725f-8de2-4431-a8e2-fb88c2def5b4",
            "service": "Blob Storage",
            "text": "Have a plan for managing the data lifecycle: Optimize transaction and capacity costs by taking advantage of access tiers and lifecycle management. Data used less often should be placed in cooler access tiers while data that's accessed often should be placed in warmer access tiers.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "df99152b-4af1-4cea-b2bd-b06fd2425c57",
            "service": "Blob Storage",
            "text": "Decide which features you need: Some features such as versioning and blob soft delete incur additional transaction and capacity costs as well as other charges. Make sure to review the pricing and billing sections in articles that describe those capabilities when you choose which capabilities to add to your account.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "b69e35ad-ee70-4787-bcb2-9cde1aa2600c",
            "service": "Blob Storage",
            "text": "Create guardrails: Create budgets based on subscriptions and resource groups. Use governance policies to restrict resource types, configurations, and locations. Additionally, use RBAC to block actions that can lead to overspending.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "41cc33cd-773d-463f-b9e3-07256ea9e3f0",
            "service": "Blob Storage",
            "text": "Monitor costs: Ensure costs stay within budgets, compare costs against forecasts, and see where overspending occurs. You can use the cost analysis pane in the Azure portal to monitor costs. You also can export cost data to a storage account and analyze that data by using Excel or Power BI.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "94b3fa52-a17f-44ec-b4ba-9801c2764632",
            "service": "Blob Storage",
            "text": "Monitor usage: Continuously monitor usage patterns and detect unused or underutilized accounts and containers. Use Storage insights to identity accounts with no or low use. Enable blob inventory reports, and use tools such as Azure Databricks or Azure Synapse Analytics and Power BI to analyze cost data. Watch out for unexpected increases in capacity, which might indicate that you're collecting numerous log files, blob versions, or soft-deleted blobs. Develop a strategy for expiring or transitioning objects to more cost-effective access tiers.Have a plan for expiring objects or moving objects to more affordable access tiers.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "Cooler tiers have higher data transfer costs. By having fewer large files, you can reduce the number of operations required to transfer data.",
            "guid": "7eb7a0d4-912b-4d5c-af98-31200e20cc63",
            "service": "Blob Storage",
            "text": "Pack small files into larger files before moving them to cooler tiers. You can use file formats such as TAR or ZIP.",
            "type": "recommendation",
            "waf": "Cost"
        },
        {
            "description": "High-priority rehydration from the archive tier can lead to higher-than-normal bills.",
            "guid": "8d3e7da9-3091-4daf-8a07-37116d9e3f7e",
            "service": "Blob Storage",
            "text": "Use standard-priority rehydration when rehydrating blobs from archive storage. Use high-priority rehydration only for emergency data restoration situations. For more information, see Rehydrate an archived blob to an online tier",
            "type": "recommendation",
            "waf": "Cost"
        },
        {
            "description": "Storing resource logs in a storage account for later analysis can be a cheaper option. Using lifecycle management policies to manage log retention in a storage account prevents large numbers of logs files building up over time, which can lead to unnecessary capacity charges.",
            "guid": "f29291b5-d170-453b-bdbb-379f229fdc5b",
            "service": "Blob Storage",
            "text": "Reduce the cost of using resource logs by choosing the appropriate log storage location and by managing log-retention periods. If you only plan to query logs occasionally (for example, querying logs for compliance auditing), consider sending resource logs to a storage account instead of sending them to an Azure Monitor Logs workspace. You can use a serverless query solution such as Azure Synapse Analytics to analyze logs. For more information, see Optimize cost for infrequent queries. Use lifecycle management policies to delete or archive logs.",
            "type": "recommendation",
            "waf": "Cost"
        },
        {
            "description": "Every write operation to a blob creates a new version. This increases capacity costs. You can keep costs in check by removing versions that you no longer need.",
            "guid": "496e994f-ae82-40c2-90cb-eb03a9e2205c",
            "service": "Blob Storage",
            "text": "If you enable versioning, use a lifecycle management policy to automatically delete old blob versions.",
            "type": "recommendation",
            "waf": "Cost"
        },
        {
            "description": "Every time a blob is overwritten, a new version is added which leads to increased storage capacity charges. To reduce capacity charges, store frequently overwritten data in a separate storage account with versioning disabled.",
            "guid": "91514322-4007-4a99-85f0-e73c181d95fa",
            "service": "Blob Storage",
            "text": "If you enable versioning, then place blobs that are frequently overwritten into an account that doesn't have versioning enabled.",
            "type": "recommendation",
            "waf": "Cost"
        },
        {
            "description": "Every time a blob is overwritten, a new snapshot is created. The cause of increased capacity charges might be difficult to access because the creation of these snapshots doesn't appear in logs. To reduce capacity charges, store frequently overwritten data in a separate storage account with soft delete disabled. A retention period keeps soft-deleted blobs from piling up and adding to the cost of capacity.",
            "guid": "7041f493-74f4-42e8-bbd2-15602763dc40",
            "service": "Blob Storage",
            "text": "If you enable soft delete, then place blobs that are frequently overwritten into an account that doesn't have soft delete enabled. Set retention periods. Consider starting with a short retention period to better understand how the feature affects your bill. The minimum recommended retention period is seven days.",
            "type": "recommendation",
            "waf": "Cost"
        },
        {
            "description": "Enabling the SFTP endpoint incurs an hourly cost. By thoughtfully disabling SFTP support, and then enabling it as needed, you can avoid passive charges from accruing in your account.",
            "guid": "c1d10494-a396-4add-aae2-aaf5aa5aa0da",
            "service": "Blob Storage",
            "text": "Enable SFTP support only when it's used to transfer data.",
            "type": "recommendation",
            "waf": "Cost"
        },
        {
            "description": "Encryptions scopes incur a per month charge.",
            "guid": "b71aeb26-fc96-486c-8bed-c5c616c1d0b1",
            "service": "Blob Storage",
            "text": "Disable any encryption scopes that aren't needed to avoid unnecessary charges.",
            "type": "recommendation",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "ab85e732-c3b0-47d2-ae0c-fa0ccf3ee4d1",
            "service": "Blob Storage",
            "text": "Create maintenance and emergency recovery plans: Consider data protection features, backup and restore operations, and failover procedures. Prepare for potential data loss and data inconsistencies and the time and cost of failing over.",
            "type": "checklist",
            "waf": "Operations"
        },
        {
            "description": "",
            "guid": "bdd60136-85dd-45cc-ac07-37d69124d9ab",
            "service": "Blob Storage",
            "text": "Monitor the health of your storage account: Create Storage insights dashboards to monitor availability, performance, and resilience metrics. Set up alerts to identify and address problems in your system before your customers notice them. Use diagnostic settings to route resource logs to an Azure Monitor Logs workspace. Then you can query logs to investigate alerts more deeply.",
            "type": "checklist",
            "waf": "Operations"
        },
        {
            "description": "",
            "guid": "b842f2e7-9ac7-4d2e-9c9a-a3fb2ddc2441",
            "service": "Blob Storage",
            "text": "Enable blob inventory reports: Enable blob inventory reports to review the retention, legal hold, or encryption status of your storage account contents. You can also use blob inventory reports to understand the total data size, age, tier distribution, or other attributes of your data. Use tools such as Azure Databricks or Azure Synapse Analytics and Power BI to better visualize inventory data and to create reports for stakeholders.",
            "type": "checklist",
            "waf": "Operations"
        },
        {
            "description": "",
            "guid": "b54e930b-e9fe-4b7b-adc2-b0f0d0b0f05c",
            "service": "Blob Storage",
            "text": "Set up policies that delete blobs or move them to cost-efficient access tiers: Create a lifecycle management policy with an initial set of conditions. Policy runs automatically delete or set the access tier of blobs based on the conditions you define. Periodically analyze container use by using Monitor metrics and blob inventory reports so that you can refine conditions to optimize cost efficiency.",
            "type": "checklist",
            "waf": "Operations"
        },
        {
            "description": "You can use your existing DevOps processes to deploy new storage accounts, and use Azure Policy to enforce their configuration.",
            "guid": "d069785a-7a9f-4a12-9642-3987b04328d1",
            "service": "Blob Storage",
            "text": "Use infrastructure as code (IaC) to define the details of your storage accounts in Azure Resource Manager templates (ARM templates), Bicep, or Terraform.",
            "type": "recommendation",
            "waf": "Operations"
        },
        {
            "description": "You can track the health and operation of each of your accounts. Easily create dashboards and reports that stakeholders can use to track the health of your storage accounts.",
            "guid": "9475eb5c-afb9-446a-bcb1-85ecc26112a9",
            "service": "Blob Storage",
            "text": "Use Storage insights to track the health and performance of your storage accounts. Storage insights provides a unified view of the failures, performance, availability, and capacity for all your storage accounts.",
            "type": "recommendation",
            "waf": "Operations"
        },
        {
            "description": "",
            "guid": "61755535-55a0-4064-8537-e9cdf07e1baa",
            "service": "Blob Storage",
            "text": "Plan for scale: Understand the scale targets for storage accounts.",
            "type": "checklist",
            "waf": "Performance"
        },
        {
            "description": "",
            "guid": "bd64ef47-64e7-4c7e-b19f-ccfd451083e0",
            "service": "Blob Storage",
            "text": "Choose the optimal storage account type: If your workload requires high transaction rates, smaller objects, and a consistently low transaction latency, then consider using premium block blob storage accounts. A standard general-purpose v2 account is most appropriate in most cases.",
            "type": "checklist",
            "waf": "Performance"
        },
        {
            "description": "",
            "guid": "b21b6a75-b065-43f1-8298-5778460e2ba0",
            "service": "Blob Storage",
            "text": "Reduce travel distance between the client and server: Place data in regions nearest to connecting clients (ideally in the same region). Optimize for clients in regions far away by using object replication or a content delivery network. Default network configurations provide the best performance. Modify network settings only to improve security. In general, network settings don't decrease travel distance and don't improve performance.",
            "type": "checklist",
            "waf": "Performance"
        },
        {
            "description": "",
            "guid": "ef4063df-4ac9-4e8b-9391-cf99ea520f3a",
            "service": "Blob Storage",
            "text": "Choose an efficient naming scheme: Decrease the latency of listing, list, query, and read operations by using hash tag prefixes nearest the beginning of the blob partition key (account, container, virtual directory, or blob name). This scheme benefits mostly accounts that have a flat namespace.",
            "type": "checklist",
            "waf": "Performance"
        },
        {
            "description": "",
            "guid": "45c2db00-baf4-4e7a-8ceb-871abc5f5d64",
            "service": "Blob Storage",
            "text": "Optimize the performance of data clients: Choose a data transfer tool that's most appropriate for the data size, transfer frequency, and bandwidth of your workloads. Some tools such as AzCopy are optimized for performance and require little intervention. Consider the factors that influence latency, and fine-tune performance by reviewing the performance optimization guidance that's published with each tool.",
            "type": "checklist",
            "waf": "Performance"
        },
        {
            "description": "",
            "guid": "97486b6a-ea0c-4100-86e0-319ce0c8ad21",
            "service": "Blob Storage",
            "text": "Optimize the performance of custom code: Consider using Storage SDKs instead of creating your own wrappers for blob REST operations. Azure SDKs are optimized for performance and provide mechanisms to fine-tune performance. Before creating an application, review the performance and scalability checklist for Blob Storage. Consider using query acceleration to filter out unwanted data during the storage request and keep clients from needlessly transferring data across the network.",
            "type": "checklist",
            "waf": "Performance"
        },
        {
            "description": "",
            "guid": "0b2ed074-7dcb-460a-8455-144171d2fe8f",
            "service": "Blob Storage",
            "text": "Collect performance data: Monitor your storage account to identify performance bottlenecks that occur from throttling. For more information, see Monitoring your storage service with Monitor Storage insights. Use both metrics and logs. Metrics provide numbers such as throttling errors. Logs describe activity. If you see throttling metrics, you can use logs to identity which clients are receiving throttling errors. For more information, see Auditing data plane operations.",
            "type": "checklist",
            "waf": "Performance"
        },
        {
            "description": "Reducing the physical distance between the storage account and VMs, services, and on-premises clients can improve performance and reduce network latency. Reducing the physical distance also reduces cost for applications hosted in Azure because bandwidth usage within a single region is free.",
            "guid": "1a37ef87-aa18-44a6-9877-6665fb1dc486",
            "service": "Blob Storage",
            "text": "Provision storage accounts in the same region where dependent resources are placed. For applications that aren't hosted on Azure, such as mobile device apps or on-premises enterprise services, locate the storage account in a region nearer to those clients. For more information, see Azure geographies.If clients from a different region don't require the same data, then create a separate account in each region.If clients from a different region require only some data, consider using an object-replication policy to asynchronously copy relevant objects to a storage account in the other region.",
            "type": "recommendation",
            "waf": "Performance"
        },
        {
            "description": "Content is delivered to clients faster because it uses the Microsoft global edge network with hundreds of global and local points of presence around the world.",
            "guid": "7ee0dea0-804f-457c-9660-1fe756011d25",
            "service": "Blob Storage",
            "text": "For broad consumption by web clients (streaming video, audio, or static website content), consider using a content delivery network through Azure Front Door.",
            "type": "recommendation",
            "waf": "Performance"
        },
        {
            "description": "Using a hash code or seconds value nearest the beginning of a partition key reduces the time required to list query and read blobs.",
            "guid": "36fc9ddc-5d24-4ecc-a67e-3fd7bc0c4373",
            "service": "Blob Storage",
            "text": "Add a hash character sequence (such as three digits) as early as possible in the partition key of a blob. The partition key is the account name, container name, virtual directory name, and blob name. If you plan to use timestamps in names, then consider adding a seconds value to the beginning of that stamp. For more information, see Partitioning.",
            "type": "recommendation",
            "waf": "Performance"
        },
        {
            "description": "Blob or block sizes above 256 KiB takes advantage of performance enhancements in the platform made specifically for larger blobs and block sizes.",
            "guid": "78872d9e-216b-4cc3-8686-0471d46a1acd",
            "service": "Blob Storage",
            "text": "When uploading blobs or blocks, use a blob or block size that's greater than 256 KiB.",
            "type": "recommendation",
            "waf": "Performance"
        },
        {
            "description": "",
            "guid": "473b3683-6d53-4521-89c4-d8aa1d1df633",
            "service": "ExpressRoute",
            "text": "Select between ExpressRoute circuit or ExpressRoute Direct for business requirements.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "e58c1767-6db4-4b40-a26e-1ab8967517f4",
            "service": "ExpressRoute",
            "text": "Configure ExpressRoute circuits with Maximum or High Resiliency for production workloads.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "b356e60e-cb41-4ee6-a8d5-290b429619f7",
            "service": "ExpressRoute",
            "text": "Configure Active-Active ExpressRoute connections between on-premises and Azure.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "877b9a2d-8171-441b-ba7f-b8c6191f12bc",
            "service": "ExpressRoute",
            "text": "Set up availability zone aware ExpressRoute Virtual Network Gateways.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "64ad6a67-7f17-4d55-a365-0ec8716fb135",
            "service": "ExpressRoute",
            "text": "Configure ExpressRoute Virtual Network Gateways in different regions.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "20bbf3a5-e3d8-42eb-9b88-9c4a811a483a",
            "service": "ExpressRoute",
            "text": "Configure site-to-site VPN as a backup to ExpressRoute private peering.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "da08260d-363c-4fcb-a555-ed4448d0be3a",
            "service": "ExpressRoute",
            "text": "Configure service health to receive ExpressRoute circuit maintenance notifications.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "During the initial planning phase, you want to decide whether you want to configure an ExpressRoute circuit or an ExpressRoute Direct connection. An ExpressRoute circuit allows a private dedicated connection into Azure with the help of a connectivity provider. ExpressRoute Direct allows you to extend the on-premises network directly into the Microsoft network at a peering location. You also need to identify the bandwidth requirement and the SKU type requirement for your business needs.",
            "guid": "09e0dd1a-b1f7-46c3-8df1-48e841f53dca",
            "service": "ExpressRoute",
            "text": "Plan for ExpressRoute circuit or ExpressRoute Direct",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "To plan for disaster recovery, set up ExpressRoute circuits in more than one peering locations. You can create circuits in peering locations in the same metro or different metro and choose to work with different service providers for diverse paths through each circuit. For more information, see  Designing for disaster recovery and Designing for high availability.",
            "guid": "257031a8-f034-436c-9f54-e82aab53c559",
            "service": "ExpressRoute",
            "text": "Plan for geo-redundant circuits",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "This mode provides higher availability of your Expressroute connections. It's also recommended to configure BFD for faster failover if there's a link failure on a connection.",
            "guid": "068037d8-673f-4e86-bc9d-bf83fbe61d12",
            "service": "ExpressRoute",
            "text": "Plan for Active-Active connectivity",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Create availability zone aware Virtual Network Gateway for higher resiliency and plan for Virtual Network Gateways in different regions for resiliency, disaster recovery, and high availability.",
            "guid": "21f65e89-ffe2-489f-89f2-16cbc2e257d9",
            "service": "ExpressRoute",
            "text": "Planning for Virtual Network Gateways",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Set up monitoring and alerts for ExpressRoute circuits and Virtual Network Gateway health based on various metrics available.",
            "guid": "0f875bf3-de86-41b5-80d2-477de2f769a2",
            "service": "ExpressRoute",
            "text": "Monitor circuits and gateway health",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "ExpressRoute uses service health to notify about planned and unplanned maintenance. Configuring service health will notify you about changes made to your ExpressRoute circuits.",
            "guid": "c84ca8b2-74f8-4d25-8fc3-5b30c9969b5f",
            "service": "ExpressRoute",
            "text": "Enable service health",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "ca1c5676-1b0a-426e-baaf-da74ab806cb4",
            "service": "ExpressRoute",
            "text": "Configure Activity log to send logs to archive.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "ef124dcd-17e6-4b4e-9bdd-511ef1959a05",
            "service": "ExpressRoute",
            "text": "Maintain an inventory of administrative accounts with access to ExpressRoute resources.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "23fbb2f6-a269-4fb5-a3a0-04aae0516c91",
            "service": "ExpressRoute",
            "text": "Configure MD5 hash on ExpressRoute circuit.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "8e02b876-d810-498b-b9a5-e50730fb10d6",
            "service": "ExpressRoute",
            "text": "Configure MACSec for ExpressRoute Direct resources.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "946a3e3d-bbaf-4b4a-ab80-2ef0a4631f30",
            "service": "ExpressRoute",
            "text": "Encrypt traffic over private peering and Microsoft peering for virtual network traffic.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "Activity logs provide insights into operations that were performed at the subscription level for ExpressRoute resources. With Activity logs, you can determine who and when an operation was performed at the control plane. Data retention is only 90 days and required to be stored in Log Analytics, Event Hubs or a storage account for archive.",
            "guid": "9631d7ef-657c-4b07-9c75-96b2dcc5c5d2",
            "service": "ExpressRoute",
            "text": "Configure Activity log to send logs to archive",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Use Azure RBAC to configure roles to limit user accounts that can add, update, or delete peering configuration on an ExpressRoute circuit.",
            "guid": "42b91c75-909f-4366-b014-48ab48639faf",
            "service": "ExpressRoute",
            "text": "Maintain inventory of administrative accounts",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "During configuration of private peering or Microsoft peering, apply an MD5 hash to secure messages between the on-premises route and the MSEE routers.",
            "guid": "78f7d298-53bf-49ae-8ed7-994d46ccf2dd",
            "service": "ExpressRoute",
            "text": "Configure MD5 hash on ExpressRoute circuit",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Media Access Control security is a point-to-point security at the data link layer. ExpressRoute Direct supports configuring MACSec to prevent security threats to protocols such as ARP, DHCP, LACP not normally secured on the Ethernet link. For more information on how to configure MACSec, see MACSec for ExpressRoute Direct ports.",
            "guid": "d495a140-702d-4e08-bb86-7ceac8141df2",
            "service": "ExpressRoute",
            "text": "Configure MACSec for ExpressRoute Direct resources",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Configure a Site-to-site VPN tunnel over your ExpressRoute circuit to encrypt data transferring between your on-premises network and Azure virtual network. You can configure a tunnel using private peering or using Microsoft peering.",
            "guid": "7729c230-dbdf-4aec-9295-fcb0a0c365f2",
            "service": "ExpressRoute",
            "text": "Encrypt traffic using IPsec",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "43d6df90-c15b-494c-8d35-c4fc9180fbdb",
            "service": "ExpressRoute",
            "text": "Familiarize yourself with ExpressRoute pricing.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "92065590-2f1a-4a81-a6a6-2b102f66f9e3",
            "service": "ExpressRoute",
            "text": "Determine the ExpressRoute circuit SKU and bandwidth required.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "f6e0770f-fa13-450e-8c81-baf51ba1b550",
            "service": "ExpressRoute",
            "text": "Determine the ExpressRoute virtual network gateway size required.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "07d0ba21-7eef-47d1-8ba0-26fefa26c733",
            "service": "ExpressRoute",
            "text": "Monitor cost and create budget alerts.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "d7be65f4-6500-49ea-92e3-3121fca4a076",
            "service": "ExpressRoute",
            "text": "Deprovision ExpressRoute circuits no longer in use.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "For information about ExpressRoute pricing, see Understand pricing for Azure ExpressRoute. You can also use the Pricing calculator.Ensure that the options are adequately sized to meet the capacity demand and deliver expected performance without wasting resources.",
            "guid": "f230ac81-7590-4300-9b9f-95d784e60ab2",
            "service": "ExpressRoute",
            "text": "Familiarize yourself with ExpressRoute pricing",
            "type": "recommendation",
            "waf": "Cost"
        },
        {
            "description": "The way you're charged for your ExpressRoute usage varies between the three different SKU types. With Local SKU, you're automatically charged with an Unlimited data plan. With Standard and Premium SKU, you can select between a Metered or an Unlimited data plan. All ingress data are free of charge except when using the Global Reach add-on. It's important to understand which SKU types and data plan works best for your workload to best optimize cost and budget. For more information resizing ExpressRoute circuit, see upgrading ExpressRoute circuit bandwidth.",
            "guid": "3d8a5d49-af34-431f-b47f-ee8cf05479b5",
            "service": "ExpressRoute",
            "text": "Determine SKU and bandwidth required",
            "type": "recommendation",
            "waf": "Cost"
        },
        {
            "description": "ExpressRoute virtual network gateways are used to pass traffic into a virtual network over private peering. Review the performance and scale needs of your preferred Virtual Network Gateway SKU. Select the appropriate gateway SKU on your on-premises to Azure workload.",
            "guid": "82224292-a5a6-4b85-9b2f-b617117c4285",
            "service": "ExpressRoute",
            "text": "Determine the ExpressRoute virtual network gateway size",
            "type": "recommendation",
            "waf": "Cost"
        },
        {
            "description": "Monitor the cost of your ExpressRoute circuit and create alerts for spending anomalies and overspending risks. For more information, see Monitoring ExpressRoute costs.",
            "guid": "e2e81918-e05e-49e1-a37c-cb65840c8699",
            "service": "ExpressRoute",
            "text": "Monitor cost and create budget alerts",
            "type": "recommendation",
            "waf": "Cost"
        },
        {
            "description": "ExpressRoute circuits are charged from the moment they're created. To reduce unnecessary cost, deprovision the circuit with the service provider and delete the ExpressRoute circuit from your subscription. For steps on how to remove an ExpressRoute circuit, see Deprovisioning an ExpressRoute circuit.",
            "guid": "131104a1-a17f-4b6b-9384-0b636a5d5265",
            "service": "ExpressRoute",
            "text": "Deprovision and delete ExpressRoute circuits no longer in use.",
            "type": "recommendation",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "4c7d0c83-02a0-4535-a378-c2ab4c13469c",
            "service": "ExpressRoute",
            "text": "Configure connection monitoring between your on-premises and Azure network.",
            "type": "checklist",
            "waf": "Operations"
        },
        {
            "description": "",
            "guid": "69c4fb71-4d2c-4534-a4db-5e3146a31e1d",
            "service": "ExpressRoute",
            "text": "Configure Service Health for receiving notification.",
            "type": "checklist",
            "waf": "Operations"
        },
        {
            "description": "",
            "guid": "33b4fca5-1f90-4947-8091-6c23aba0651a",
            "service": "ExpressRoute",
            "text": "Review metrics and dashboards available through ExpressRoute Insights using Network Insights.",
            "type": "checklist",
            "waf": "Operations"
        },
        {
            "description": "",
            "guid": "638c050d-7555-4575-bb8d-a4f2b613fa87",
            "service": "ExpressRoute",
            "text": "Review ExpressRoute resource metrics.",
            "type": "checklist",
            "waf": "Operations"
        },
        {
            "description": "Connection monitoring allows you to monitor connectivity between your on-premises resources and Azure over the ExpressRoute private peering and Microsoft peering connection. Connection monitor can detect networking issues by identifying where along the network path the problem is and help you quickly resolve configuration or hardware failures.",
            "guid": "c6766a4e-7531-4335-af44-4fd1a3c706f4",
            "service": "ExpressRoute",
            "text": "Configure connection monitoring",
            "type": "recommendation",
            "waf": "Operations"
        },
        {
            "description": "Set up Service Health notifications to alert when planned and upcoming maintenance is happening to all ExpressRoute circuits in your subscription. Service Health also displays past maintenance along with RCA if an unplanned maintenance were to occur.",
            "guid": "5ff3a7b5-974a-466d-ab01-ad90c143969d",
            "service": "ExpressRoute",
            "text": "Configure Service Health",
            "type": "recommendation",
            "waf": "Operations"
        },
        {
            "description": "ExpressRoute Insights with Network Insights allow you to review and analyze ExpressRoute circuits, gateways, connections metrics and health dashboards. ExpressRoute Insights also provide a topology view of your ExpressRoute connections where you can view details of your peering components all in a single place.Metrics available:- Availability- Throughput- Gateway metrics",
            "guid": "210546e8-29e3-40d9-869f-6236fddaadd0",
            "service": "ExpressRoute",
            "text": "Review metrics with Network Insights",
            "type": "recommendation",
            "waf": "Operations"
        },
        {
            "description": "ExpressRoute uses Azure Monitor to collect metrics and create alerts base on your configuration. Metrics are collected for ExpressRoute circuits, ExpressRoute gateways, ExpressRoute gateway connections, and ExpressRoute Direct. These metrics are useful for diagnosing connectivity problems and understanding the performance of your ExpressRoute connection.",
            "guid": "8031ed87-7573-469a-9b05-01f4ff4d9231",
            "service": "ExpressRoute",
            "text": "Review ExpressRoute resource metrics",
            "type": "recommendation",
            "waf": "Operations"
        },
        {
            "description": "",
            "guid": "256753af-fb4b-49b2-a965-4b65265ee8dd",
            "service": "ExpressRoute",
            "text": "Test ExpressRoute gateway performance to meet work load requirements.",
            "type": "checklist",
            "waf": "Performance"
        },
        {
            "description": "",
            "guid": "9bc85bda-be71-4df0-924c-2604ef7f05fa",
            "service": "ExpressRoute",
            "text": "Increase the size of the ExpressRoute gateway.",
            "type": "checklist",
            "waf": "Performance"
        },
        {
            "description": "",
            "guid": "102ee202-4b37-498a-8826-d698d11e3b03",
            "service": "ExpressRoute",
            "text": "Upgrade the ExpressRoute circuit bandwidth.",
            "type": "checklist",
            "waf": "Performance"
        },
        {
            "description": "",
            "guid": "627c2d5f-e638-41fd-be98-9ba1bf195ce3",
            "service": "ExpressRoute",
            "text": "Enable ExpressRoute FastPath for higher throughput.",
            "type": "checklist",
            "waf": "Performance"
        },
        {
            "description": "",
            "guid": "040f4b75-2706-42f3-9a9c-cee611032d91",
            "service": "ExpressRoute",
            "text": "Monitor the ExpressRoute circuit and gateway metrics.",
            "type": "checklist",
            "waf": "Performance"
        },
        {
            "description": "Use Azure Connectivity Toolkit to test performance across your ExpressRoute circuit to understand bandwidth capacity and latency of your network connection.",
            "guid": "256753af-fb4b-49b2-a965-4b65265ee8dd",
            "service": "ExpressRoute",
            "text": "Test ExpressRoute gateway performance to meet work load requirements.",
            "type": "recommendation",
            "waf": "Performance"
        },
        {
            "description": "Upgrade to a higher gateway SKU for improved throughput performance between on-premises and Azure environment.",
            "guid": "9bc85bda-be71-4df0-924c-2604ef7f05fa",
            "service": "ExpressRoute",
            "text": "Increase the size of the ExpressRoute gateway.",
            "type": "recommendation",
            "waf": "Performance"
        },
        {
            "description": "Upgrade your circuit bandwidth to meet your work load requirements. Circuit bandwidth is shared between all virtual networks connected to the ExpressRoute circuit. Depending on your work load, one or more virtual networks can use up all the bandwidth on the circuit.",
            "guid": "db8f8202-db07-497f-be72-17db8bda90c5",
            "service": "ExpressRoute",
            "text": "Upgrade ExpressRoute circuit bandwidth",
            "type": "recommendation",
            "waf": "Performance"
        },
        {
            "description": "If you're using an Ultra performance or an ErGW3AZ virtual network gateway, you can enable FastPath to improve the data path performance between your on-premises network and Azure virtual network.",
            "guid": "01566559-f881-409b-b04e-7d79a71f18e4",
            "service": "ExpressRoute",
            "text": "Enable ExpressRoute FastPath for higher throughput",
            "type": "recommendation",
            "waf": "Performance"
        },
        {
            "description": "Set up alerts base on ExpressRoute metrics to proactively notify you when a certain threshold is met. These metrics are useful to understand anomalies that can happen with your ExpressRoute connection such as outages and maintenance happening to your ExpressRoute circuits.",
            "guid": "6440df71-d371-4190-920f-01c1815446db",
            "service": "ExpressRoute",
            "text": "Monitor ExpressRoute circuit and gateway metrics",
            "type": "recommendation",
            "waf": "Performance"
        },
        {
            "description": "",
            "guid": "94d626bf-3509-4311-8700-696d8d18617e",
            "service": "File Storage",
            "text": "Use failure mode analysis: Minimize points of failure by considering internal dependencies such as the availability of virtual networks, Azure Key Vault, or Azure Content Delivery Network or Azure Front Door endpoints. Failures can occur if you need credentials to access Azure Files, and the credentials go missing from Key Vault. Or you might have a failure if your workloads use an endpoint that's based on a missing content delivery network. In these cases, you might need to configure your workloads to connect to an alternative endpoint. For general information about failure mode analysis, see Recommendations for performing failure mode analysis.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "bedde06b-f58a-43ab-b6cc-76e41503e72a",
            "service": "File Storage",
            "text": "Define reliability and recovery targets: Review the Azure service-level agreements (SLAs). Derive the service-level objective (SLO) for the storage account. For example, the redundancy configuration that you chose might affect the SLO. Consider the effect of a regional outage, the potential for data loss, and the time required to restore access after an outage. Also consider the availability of internal dependencies that you identified as part of your failure mode analysis.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "f9c07c6b-c5ab-4e57-83f7-9455042e2e23",
            "service": "File Storage",
            "text": "Configure data redundancy: For maximum durability, choose a configuration that copies data across availability zones or global regions. For maximum availability, choose a configuration that allows clients to read data from the secondary region during an outage of the primary region.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "61e937b4-1989-496a-af6f-5df76d352ed8",
            "service": "File Storage",
            "text": "Design applications: Design your applications to seamlessly shift so that they read data from a secondary region if the primary region is unavailable. This design consideration only applies to geo-redundant storage (GRS) and geo-zone-redundant storage (GZRS) configurations. Design your applications to properly handle outages, which reduces downtime for customers.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "cb1c49d6-9cdb-48f6-a3f8-c35c2037fc92",
            "service": "File Storage",
            "text": "Explore features to help you meet your recovery targets: Make files restorable so that you can recover corrupted, edited, or deleted files.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "3a9677e5-9506-4aaa-bac6-48b5002070c1",
            "service": "File Storage",
            "text": "Create a recovery plan: Consider data protection features, backup and restore operations, or failover procedures. Prepare for potential data loss and data inconsistencies and the time and cost of failing over. For more information, see Recommendations for designing a disaster recovery strategy.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "8b151d5d-630d-438e-b7ad-aa487d6c5561",
            "service": "File Storage",
            "text": "Monitor potential availability problems: Subscribe to the Azure Service Health dashboard to monitor potential availability problems. Use storage metrics and diagnostic logs in Azure Monitor to investigate alerts.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "Redundancy protects your data against unexpected failures. The ZRS and GZRS configuration options replicate across various availability zones and enable applications to continue reading data during an outage. For more information, see Durability and availability by outage scenario and Durability and availability parameters.",
            "guid": "5596d241-a342-4c47-b8db-29f7a519bf36",
            "service": "File Storage",
            "text": "Configure your storage account for redundancy. For maximum availability and durability, configure your account with zone-redundant storage (ZRS), GRS, or GZRS. Limited Azure regions support ZRS for standard and premium file shares. Only standard SMB accounts support GRS and GZRS. Premium SMB shares and NFS shares don't support GRS and GZRS. Azure Files doesn't support read-access geo-redundant storage (RA-GRS) or read-access geo-zone-redundant storage (RA-GZRS). If you configure a storage account to use RA-GRS or RA-GZRS, the file shares are configured and billed as GRS or GZRS.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "This property helps you estimate how much data you might lose if you initiate an account failover. All data and metadata that's written before the last synchronization time is available on the secondary region, but you might lose data and metadata that's written after the last synchronization time because it's not written to the secondary region.",
            "guid": "9fc3b4c1-257d-4bab-b373-1938930410a5",
            "service": "File Storage",
            "text": "Before you initiate a failover or failback, check the value of the last synchronization time property to evaluate the potential for data loss. This recommendation applies only to GRS and GZRS configurations.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Soft delete works on a file share level to protect Azure file shares against accidental deletion. Point-in-time restore protects against accidental deletion or corruption because you can restore file shares to an earlier state. For more information, see Data protection overview.",
            "guid": "8bcb6fde-bf94-4f36-8eae-347e5d4f0dea",
            "service": "File Storage",
            "text": "As a part of your backup and recovery strategy, enable soft delete and use snapshots for point-in-time restore. You can use Azure Backup to back up your SMB file shares. You can also use Azure File Sync to back up on-premises SMB file shares to an Azure file share.  Azure Backup also allows you to do a vaulted backup (preview) of Azure Files to protect your data from ransomware attacks or source data loss due to a malicious actor or rogue admin. By using vaulted backup, Azure Backup copies and stores data in the Recovery Services vault. This creates an offsite copy of data that you can retain for up to 99 years. Azure Backup creates and manages the recovery points as per the schedule and retention defined in the backup policy. Learn more.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "2548e433-aeab-4738-bec1-0a3587ac4d15",
            "service": "File Storage",
            "text": "Review the security baseline for Azure Storage: To get started, review the security baseline for Storage.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "6121894c-398e-479f-b386-309e7cf3caa0",
            "service": "File Storage",
            "text": "Consider using network controls to restrict ingress and egress traffic: You might be comfortable exposing your storage account to the public internet under certain conditions, like if you use identity-based authentication to grant access to file shares. But we recommend that you use network controls to grant the minimum required level of access to users and applications. For more information, see How to approach network security for your storage account.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "8395a636-8c19-4b22-a175-2a0f0d83f44f",
            "service": "File Storage",
            "text": "Reduce the attack surface: Use encryption in transit and prevent access over non-secure (HTTP) connections to reduce the attack surface. Require clients to send and receive data by using the latest version of the Transport Layer Security (TLS) protocol.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "62e5154f-98cb-4dc2-8e62-dd5c546d6a6d",
            "service": "File Storage",
            "text": "Minimize the use of storage account keys: Identity-based authentication provides superior security compared to using a storage account key. But you must use a storage account key to get full administrative control of a file share, including the ability to take ownership of a file. Grant security principals only the necessary permissions that they need to perform their tasks.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "dd5352d4-faa0-4a85-83db-00395c1a9df8",
            "service": "File Storage",
            "text": "Protect sensitive information: Protect sensitive information, such as storage account keys and passwords. We don't recommend that you use these forms of authorization, but if you do, you should make sure to rotate, expire, and store them securely.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "1edd34b4-610b-483a-83a0-d8bcb5915558",
            "service": "File Storage",
            "text": "Detect threats: Enable Microsoft Defender for Storage to detect potentially harmful attempts to access or exploit your Azure file shares over SMB or FileREST protocols. Subscription administrators get email alerts with details of suspicious activity and recommendations about how to investigate and remediate threats. Defender for Storage doesn't support antivirus capabilities for Azure file shares. If you use Defender for Storage, transaction-heavy file shares incur significant costs, so consider opting out of Defender for Storage for specific storage accounts.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "Lock the account to prevent accidental or malicious deletion of the storage account, which can cause data loss.",
            "guid": "e125f557-f42e-4462-b680-0e7375d89a99",
            "service": "File Storage",
            "text": "Apply an Azure Resource Manager lock  on the storage account.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "SMB 3.x is an internet-safe protocol, but you might not have the ability to change organizational or ISP policies. You can use a VPN gateway or an ExpressRoute connection as an alternative option.",
            "guid": "14cda8e5-c05a-4c69-9352-2f7b39b5d423",
            "service": "File Storage",
            "text": "Open TCP port 445 outbound or set up a VPN gateway or Azure ExpressRoute connection for clients outside of Azure to access the file share.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "SMB 1 is an outdated, inefficient, and insecure protocol. Disable it on clients to improve your security posture.",
            "guid": "e2ef284e-804b-4592-866f-5d577069b823",
            "service": "File Storage",
            "text": "If you open port 445, be sure to disable SMBv1 on Windows and Linux clients. Azure Files doesn't support SMB 1, but you should still disable it on your clients.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Network traffic travels over the Microsoft backbone network instead of the public internet, which eliminates risk exposure from the public internet.",
            "guid": "19d4b509-167c-4144-9705-9d65c48ec279",
            "service": "File Storage",
            "text": "Consider disabling public network access to your storage account. Enable public network access only if SMB clients and services that are external to Azure require access to your storage account. If you disable public network access,create a private endpoint for your storage account. Standard data processing rates for private endpoints apply. A private endpoint doesn't block connections to the public endpoint. You should still disable public network access as previously described. If you don't require a static IP address for your file share and want to avoid the cost of private endpoints, you can instead restrict public endpoint access to specific virtual networks and IP addresses.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Minimize the risk of creating openings for attackers.",
            "guid": "105c5f3d-dfc6-459b-93f0-c5046972f1ba",
            "service": "File Storage",
            "text": "Enable firewall rules that limit access to specific virtual networks. Start with zero access, and then methodically and incrementally provide the least amount of access required for clients and services.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Use identity-based authentication to decrease the possibility of an attacker using a storage account key to access file shares.",
            "guid": "1ba283cb-62bf-4ee8-9657-ba59ddd6bccd",
            "service": "File Storage",
            "text": "When possible, use identity-based authentication with AES-256 Kerberos ticket encryption to authorize access to SMB Azure file shares.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Use Key Vault to retrieve keys at runtime instead of saving them with your application. Key Vault also makes it easy to rotate your keys without interruption to your applications. Periodically rotate the account keys to reduce the risk of exposing your data to malicious attacks.",
            "guid": "7cf01b2b-1e7d-47fe-94e1-a65cc7750063",
            "service": "File Storage",
            "text": "If you use storage account keys, store them in Key Vault, and make sure to regenerate them periodically. You can completely disallow storage account key access to the file share by removing NTLMv2 from the share's SMB security settings. But you generally shouldn't remove NTLMv2 from the share's SMB security settings because administrators still need to use the account key for some tasks.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "This setting ensures that all requests that are made against the storage account take place over secure connections (HTTPS). Any requests made over HTTP will fail.",
            "guid": "4fbd14ad-9bf1-491f-b621-35f086b48ccd",
            "service": "File Storage",
            "text": "In most cases, you should enable the Secure transfer required option on all your storage accounts to enable encryption in transit for SMB file shares. Don't enable this option if you need to allow very old clients to access the share. If you disable secure transfer, be sure to use network controls to restrict traffic.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "TLS 1.2 is more secure and faster than TLS 1.0 and 1.1, which don't support modern cryptographic algorithms and cipher suites.",
            "guid": "65d8332d-6657-4466-9dc1-5d1497d14041",
            "service": "File Storage",
            "text": "Configure your storage account so that TLS 1.2 is the minimum version for clients to send and receive data.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "SMB 3.1.1, released with Windows 10, contains important security and performance updates. AES-256-GCM offers more secure channel encryption.",
            "guid": "010a5a8d-db30-4c97-975e-db80658bdb4d",
            "service": "File Storage",
            "text": "Use only the most recent supported SMB protocol version (currently 3.1.1.), and use only AES-256-GCM for SMB channel encryption. Azure Files exposes settings that you can use to toggle the SMB protocol and make it more compatible or more secure, depending on your organization's requirements. By default, all SMB versions are allowed. However, SMB 2.1 is disallowed if you enable Require secure transfer because SMB 2.1 doesn't support encryption of data in transit. If you restrict these settings to a high level of security, some clients might not be able to connect to the file share.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "04493486-a5be-4bb2-8940-cea321db8380",
            "service": "File Storage",
            "text": "Review the security baseline for Storage: To get started, review the security baseline for Storage.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "85f4e9b5-aa91-4d96-ad22-9132f7412718",
            "service": "File Storage",
            "text": "Understand your organization's security requirements: NFS Azure file shares only support Linux clients that use the NFSv4.1 protocol, with support for most features from the 4.1 protocol specification. Some security features, such as Kerberos authentication, access control lists (ACLs), and encryption in transit, aren't supported.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "7f1ac6f7-d832-4c71-adbd-ae31d36320a7",
            "service": "File Storage",
            "text": "Use network-level security and controls to restrict ingress and egress traffic: Identity-based authentication isn't available for NFS Azure file shares, so you must use network-level security and controls to grant the minimum required level of access to users and applications. For more information, see How to approach network security for your storage account.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "Lock the account to prevent accidental or malicious deletion of the storage account, which might cause data loss.",
            "guid": "a51426ff-75f8-429b-940a-6ddd2c06d3fb",
            "service": "File Storage",
            "text": "Apply a Resource Manager lock on the storage account.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Open port 2049 to let clients communicate with the NFS Azure file share.",
            "guid": "af6d0dd1-6add-4f9b-96b6-e65dba4242a4",
            "service": "File Storage",
            "text": "You must open port 2049 on the clients that you want to mount your NFS share to.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Network traffic travels over the Microsoft backbone network instead of the public internet, which eliminates risk exposure from the public internet.",
            "guid": "528b4915-a4d9-413d-9b79-e4078f5cd27d",
            "service": "File Storage",
            "text": "NFS Azure file shares are only accessible through restricted networks. So you must create a private endpoint for your storage account or restrict public endpoint access to selected virtual networks and IP addresses. We recommend that you create a private endpoint. You must configure network-level security for NFS shares because Azure Files doesn't support encryption in transit with the NFS protocol. You need to disable the Require secure transfer setting on the storage account to use NFS Azure file shares. Standard data processing rates apply for private endpoints. If you don't require a static IP address for your file share and want to avoid the cost of private endpoints, you can restrict public endpoint access instead.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Disallow the use of storage account keys to make your storage account more secure.",
            "guid": "2f92995e-d1d1-411d-96cd-309faf0a6ada",
            "service": "File Storage",
            "text": "Consider disallowing storage account key access at the storage account level. You don't need this access to mount NFS file shares. But keep in mind that full administrative control of a file share, including the ability to take ownership of a file, requires use of a storage account key.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "bc87a075-cc79-46be-a413-106c995f41ef",
            "service": "File Storage",
            "text": "Decide whether your workload requires the performance of premium file shares (Azure Premium SSD) or if Azure Standard HDD storage is sufficient: Determine your storage account type and billing model based on the type of storage that you need. If you require large amounts of input/output operations per second (IOPS), extremely fast data transfer speeds, or very low latency, then you should choose premium Azure file shares. NFS Azure file shares are only available on the premium tier. NFS and SMB file shares are the same price on the premium tier.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "fc9a86d1-8dcf-4e82-87fa-81d736ab60f4",
            "service": "File Storage",
            "text": "Create a storage account for your file share, and choose a redundancy level: Choose either a standard (GPv2) or premium (FileStorage) account. The redundancy level that you choose affects cost. The more redundancy, the higher the cost. Locally redundant storage (LRS) is the most affordable. GRS is only available for standard SMB file shares. Standard file shares only show transaction information at the storage account level, so we recommend that you deploy only one file share in each storage account to ensure full billing visibility.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "1a78abc4-bed1-486b-952e-fd147db1123a",
            "service": "File Storage",
            "text": "Understand how your bill is calculated: Standard Azure file shares provide a pay-as-you-go model. Premium shares use a provisioned model in which you specify and pay for a certain amount of capacity, IOPS, and throughput up front. In the pay-as-you-go model, meters track the amount of data that's stored in the account, or the capacity, and the number and type of transactions based on your usage of that data. The pay-as-you-go model can be cost efficient because you pay only for what you use. With the pay-as-you-go model, you don't need to overprovision or deprovision storage based on performance requirements or demand fluctuations.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "52d8f743-4489-49a3-876c-0f36827a8f8e",
            "service": "File Storage",
            "text": "Estimate the cost of capacity and operations: You can use the Azure pricing calculator to model the costs associated with data storage, ingress, and egress. Compare the cost associated with various regions, account types, and redundancy configurations. For more information, see Azure Files pricing.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "9dede643-062f-40d2-869e-10458f04859a",
            "service": "File Storage",
            "text": "Choose the most cost-effective access tier: Standard SMB Azure file shares offer three access tiers: transaction optimized, hot, and cool. All three tiers are stored on the same standard storage hardware. The main difference for these three tiers is their data at rest storage prices, which are lower in cooler tiers, and the transaction prices, which are higher in cooler tiers. For more information, see Differences in standard tiers.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "8ec1a7f3-7cff-41f4-9cd5-59656983c739",
            "service": "File Storage",
            "text": "Decide which value-added services you need: Azure Files supports integrations with value-added services such as Backup, Azure File Sync, and Defender for Storage. These solutions have their own licensing and product costs but are often considered part of the total cost of ownership for file storage. Consider other cost aspects if you use Azure File Sync.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "ae36a7c7-3255-4544-b751-bdbe08716cc2",
            "service": "File Storage",
            "text": "Create guardrails: Create budgets based on subscriptions and resource groups. Use governance policies to restrict resource types, configurations, and locations. Additionally, use role-based access control (RBAC) to block actions that can lead to overspending.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "b5ca80d5-d5c8-4d24-8a3c-b2d96a2bcd71",
            "service": "File Storage",
            "text": "Monitor costs: Ensure costs stay within budgets, compare costs against forecasts, and see where overspending occurs. You can use the cost analysis pane in the Azure portal to monitor costs. You can also export cost data to a storage account, and use Excel or Power BI to analyze that data.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "a6bc4298-8317-4153-b281-2b83af53fd26",
            "service": "File Storage",
            "text": "Monitor usage: Continuously monitor usage patterns to detect unused or underused storage accounts and file shares. Check for unexpected increases in capacity, which might indicate that you're collecting numerous log files or soft-deleted files. Develop a strategy for deleting files or moving files to more cost-effective access tiers.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "Migrating to Azure Files is a temporary, transaction-heavy workload. Optimize the price for high-transaction workloads to help reduce migration costs.",
            "guid": "4fc0a2e6-1138-4c55-9644-890104fecd40",
            "service": "File Storage",
            "text": "When you migrate to standard Azure file shares, we recommend that you start in the transaction-optimized tier during the initial migration. Transaction usage during migration isn't typically indicative of normal transaction usage. This consideration doesn't apply for premium file shares because the provisioned billing model doesn't charge for transactions.",
            "type": "recommendation",
            "waf": "Cost"
        },
        {
            "description": "Select the appropriate access tier for standard file shares to considerably reduce your costs.",
            "guid": "4ee4d06f-ae90-4ba1-b87e-608a8871e182",
            "service": "File Storage",
            "text": "After you migrate your workload, if you use standard file shares, carefully choose the most cost effective access tier for your file share: hot, cool, or transaction optimized. After you operate for a few days or weeks with regular usage, you can insert your transaction counts in the pricing calculator to figure out which tier best suits your workload. Most customers should choose cool even if they actively use the share. But you should examine each share and compare the balance of storage capacity to transactions to determine your tier. If transaction costs make up a significant percentage of your bill, the savings from using the cool access tier often offsets this cost and minimizes the total overall cost. We recommend that you move standard file shares between access tiers only when necessary to optimize for changes in your workload pattern. Each move incurs transactions. For more information, see Switching between standard tiers.",
            "type": "recommendation",
            "waf": "Cost"
        },
        {
            "description": "Overprovision premium file shares by a reasonable amount to help maintain performance and account for future growth and performance requirements.",
            "guid": "569b045f-3018-4487-be79-5ae7fe5f42f6",
            "service": "File Storage",
            "text": "If you use premium shares, ensure that you provision more than enough capacity and performance for your workload but not so much that you incur unnecessary costs. We recommend overprovisioning by two to three times. You can dynamically scale premium file shares up or down depending on your storage and input/output (IO) performance characteristics.",
            "type": "recommendation",
            "waf": "Cost"
        },
        {
            "description": "Three-year reservations can provide a discount up to 36% on the total cost of file storage. Reservations don't affect performance.",
            "guid": "e4d7ee80-2657-4a1b-bf32-b16588f1511e",
            "service": "File Storage",
            "text": "Use Azure Files reservations, also referred to as reserved instances, to precommit to storage usage and get a discount. Use reservations for production workloads or dev/test workloads with consistent footprints. For more information, see Optimize costs with storage reservations. Reservations don't include transaction, bandwidth, data transfer, and metadata storage charges.",
            "type": "recommendation",
            "waf": "Cost"
        },
        {
            "description": "Differential snapshots ensure that you're not billed multiple times for storing the same data. However, you should still monitor snapshot usage to help reduce your Azure Files bill.",
            "guid": "90fbd856-01ee-41d2-a912-039edc971236",
            "service": "File Storage",
            "text": "Monitor snapshot usage. Snapshots incur charges, but they're billed based on the differential storage usage of each snapshot. You pay only for the difference in each snapshot. For more information, see Snapshots. Azure File Sync takes share-level and file-level snapshots as part of regular usage, which can increase your total Azure Files bill.",
            "type": "recommendation",
            "waf": "Cost"
        },
        {
            "description": "Set a retention period so that soft-deleted files don't pile up and increase the cost of capacity. After the configured retention period, permanently deleted data doesn't incur cost.",
            "guid": "d28f02bd-5de7-4d5b-bfbf-46ff161833b5",
            "service": "File Storage",
            "text": "Set retention periods for the soft-delete feature, especially when you first start using it. Consider starting with a short retention period to better understand how the feature affects your bill. The minimum recommended retention period is seven days. When you soft delete standard and premium file shares, they're billed as used capacity rather than provisioned capacity. And premium file shares are billed at the snapshot rate while in the soft-delete state. Standard file shares are billed at the regular rate while in the soft-delete state.",
            "type": "recommendation",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "ab85e732-c3b0-47d2-ae0c-fa0ccf3ee4d1",
            "service": "File Storage",
            "text": "Create maintenance and emergency recovery plans: Consider data protection features, backup and restore operations, and failover procedures. Prepare for potential data loss and data inconsistencies and the time and cost of failing over.",
            "type": "checklist",
            "waf": "Operations"
        },
        {
            "description": "",
            "guid": "6fd27f65-59e7-41ee-8994-d93ef20dbd99",
            "service": "File Storage",
            "text": "Monitor the health of your storage account: Create Storage insights dashboards to monitor availability, performance, and resiliency metrics. Set up alerts to identify and address problems in your system before your customers notice them. Use diagnostic settings to route resource logs to an Azure Monitor Logs workspace. Then you can query logs to investigate alerts more deeply.",
            "type": "checklist",
            "waf": "Operations"
        },
        {
            "description": "",
            "guid": "e6d6588e-c646-4221-832a-0e289e272531",
            "service": "File Storage",
            "text": "Periodically review file share activity: Share activity can change over time. Move standard file shares to cooler access tiers, or you can provision or deprovision capacity for premium shares. When you move standard file shares to a different access tier, you incur a transaction charge. Move standard file shares only when needed to reduce your monthly bill.",
            "type": "checklist",
            "waf": "Operations"
        },
        {
            "description": "You can use your existing DevOps processes to deploy new storage accounts, and use Azure Policy to enforce their configuration.",
            "guid": "d069785a-7a9f-4a12-9642-3987b04328d1",
            "service": "File Storage",
            "text": "Use infrastructure as code (IaC) to define the details of your storage accounts in Azure Resource Manager templates (ARM templates), Bicep, or Terraform.",
            "type": "recommendation",
            "waf": "Operations"
        },
        {
            "description": "You can track the health and operation of each of your accounts. Easily create dashboards and reports that stakeholders can use to track the health of your storage accounts.",
            "guid": "9475eb5c-afb9-446a-bcb1-85ecc26112a9",
            "service": "File Storage",
            "text": "Use Storage insights to track the health and performance of your storage accounts. Storage insights provides a unified view of the failures, performance, availability, and capacity for all your storage accounts.",
            "type": "recommendation",
            "waf": "Operations"
        },
        {
            "description": "Monitor provides a view of availability, performance, and resiliency for your file shares.",
            "guid": "a4946cee-c1bc-4f12-9819-fddf25f093c4",
            "service": "File Storage",
            "text": "Use Monitor to analyze metrics, such as availability, latency, and usage, and to create alerts.",
            "type": "recommendation",
            "waf": "Operations"
        },
        {
            "description": "",
            "guid": "6c44da65-6a81-442d-87e7-dd1ecdbca0a5",
            "service": "File Storage",
            "text": "Plan for scale: Understand the scalability and performance targets for storage accounts, Azure Files, and Azure File Sync.",
            "type": "checklist",
            "waf": "Performance"
        },
        {
            "description": "",
            "guid": "d9878efd-6174-4cf7-b7f4-429d8e82e577",
            "service": "File Storage",
            "text": "Understand your application and usage patterns to achieve predictable performance: Determine latency sensitivity, IOPS and throughput requirements, workload duration and frequency, and workload parallelization. Use Azure Files for multi-threaded applications to help you achieve the upper performance limits of a service. If most of your requests are metadata-centric, such as createfile, openfile, closefile, queryinfo, or querydirectory, the requests create poor latency that's higher than the read and write operations. If you have this problem, consider separating the file share into multiple file shares within the same storage account.",
            "type": "checklist",
            "waf": "Performance"
        },
        {
            "description": "",
            "guid": "3e382c2e-26ee-459d-967e-19377821c26e",
            "service": "File Storage",
            "text": "Choose the optimal storage account type: If your workload requires large amounts of IOPS, extremely fast data transfer speeds, or very low latency, then you should choose premium (FileStorage) storage accounts. You can use a standard general-purpose v2 account for most SMB file share workloads. The primary tradeoff between the two storage account types is cost versus performance.",
            "type": "checklist",
            "waf": "Performance"
        },
        {
            "description": "",
            "guid": "a0564644-9831-4f33-b4e7-6a56a6a658fb",
            "service": "File Storage",
            "text": "Create storage accounts in the same regions as connecting clients to reduce latency: The farther you are from the Azure Files service, the greater the latency and the more difficult to achieve performance scale limits. This consideration is especially true when you access Azure Files from on-premises environments. If possible, ensure that your storage account and your clients are co-located in the same Azure region. Optimize for on-premises clients by minimizing network latency or by using an ExpressRoute connection to extend on-premises networks into the Microsoft cloud over a private connection.",
            "type": "checklist",
            "waf": "Performance"
        },
        {
            "description": "",
            "guid": "0dfbbd8e-9f88-4e9d-b13c-01f12078faef",
            "service": "File Storage",
            "text": "Collect performance data: Monitor workload performance, including latency, availability, and usage metrics. Analyze logs to diagnose problems such as timeouts and throttling. Create alerts to notify you if a file share is being throttled, about to be throttled, or experiencing high latency.",
            "type": "checklist",
            "waf": "Performance"
        },
        {
            "description": "",
            "guid": "86f0acc5-ce95-4ea0-b0b7-b733f1b2b10b",
            "service": "File Storage",
            "text": "Optimize for hybrid deployments: If you use Azure File Sync, sync performance depends on many factors: your Windows Server and the underlying disk configuration, network bandwidth between the server and the Azure storage, file size, total dataset size, and the activity on the dataset. To measure the performance of a solution that's based on Azure File Sync, determine the number of objects, such as files and directories, that you process per second.",
            "type": "checklist",
            "waf": "Performance"
        },
        {
            "description": "Increase throughput and IOPS while reducing the total cost of ownership. Performance benefits increase with the number of files that distribute load.",
            "guid": "24a072d9-074d-4bcf-a65d-9a14336f8075",
            "service": "File Storage",
            "text": "Enable SMB Multichannel for premium SMB file shares. SMB Multichannel allows an SMB 3.1.1 client to establish multiple network connections to an SMB Azure file share. SMB Multichannel only works when the feature is enabled on both client-side (your client) and service-side (Azure). On Windows clients, SMB Multichannel is enabled by default, but you need to enable it on your storage account.",
            "type": "recommendation",
            "waf": "Performance"
        },
        {
            "description": "Increase performance at scale, and reduce the total cost of ownership for NFS file shares.",
            "guid": "c06bc804-3315-43f1-96ca-70169c020494",
            "service": "File Storage",
            "text": "Use the nconnect client-side mount option with NFS Azure file shares on Linux clients. Nconnect enables you to use more TCP connections between the client and the Azure Files premium service for NFSv4.1.",
            "type": "recommendation",
            "waf": "Performance"
        },
        {
            "description": "Avoid throttling to provide the best possible client experience.",
            "guid": "494347eb-d007-45b5-b13c-9a28ee4f8e9a",
            "service": "File Storage",
            "text": "Make sure your file share or storage account isn't being throttled, which can result in high latency, low throughput, or low IOPS. Requests are throttled when the IOPS, ingress, or egress limits are reached. For standard storage accounts, throttling occurs at the account level. For premium file shares, throttling usually occurs at the share level.",
            "type": "recommendation",
            "waf": "Performance"
        },
        {
            "description": "",
            "guid": "20ce14f0-d217-45ca-953e-da6acda1b73c",
            "service": "Firewall",
            "text": "Review the list of Azure Firewall known issues. Azure Firewall products maintain an updated list of known issues. This list contains important information about by-design behavior, fixes under construction, platform limitations, and possible workarounds or mitigation strategies.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "de630a06-a4a8-4215-bb80-cc89dd3ced08",
            "service": "Firewall",
            "text": "Deploy Azure Firewall across multiple availability zones for a higher service-level agreement (SLA). Azure Firewall provides different SLAs depending on whether you deploy the service in a single availability zone or multiple zones. For more information, see SLAs for online services.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "be394cd4-78f2-4737-8d8d-ec8f83193584",
            "service": "Firewall",
            "text": "Deploy an Azure Firewall instance in each region in multi-region environments. For traditional hub-and-spoke architectures, see Multi-region considerations. For secured Azure Virtual WAN hubs, configure routing intent and policies to secure inter-hub and branch-to-branch communications. For failure-resistant and fault-tolerant workloads, consider instances of Azure Firewall and Azure Virtual Network as regional resources.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "5f5c6480-7d26-4d6a-b375-e5786b200448",
            "service": "Firewall",
            "text": "Monitor Azure Firewall metrics and the resource health state. Azure Firewall integrates with Azure Resource Health. Use the Resource Health check to view the health status of Azure Firewall and address service problems that might affect your Azure Firewall resource.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "e1c47da5-f5ed-4300-911e-7fc916e4c488",
            "service": "Firewall",
            "text": "Deploy Azure Firewall in hub virtual networks or as part of Virtual WAN hubs.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "Deploy Azure Firewall across multiple availability zones to maintain a specific level of resiliency. If one zone experiences an outage, another zone continues to serve traffic.",
            "guid": "13571efe-01ca-4dd1-8cc8-fe95125e3bf2",
            "service": "Firewall",
            "text": "Deploy Azure Firewall across multiple availability zones.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Monitor resource metrics and service health so you can detect when a service state degrades and take proactive measures to prevent failures.",
            "guid": "09d6362f-d7a1-4c56-822c-065064bbcad7",
            "service": "Firewall",
            "text": "Monitor Azure Firewall metrics in a Log Analytics workspace. Closely monitor metrics that indicate the Azure Firewall health state, such as throughput, Firewall health state, SNAT port utilization, and AZFW latency probe metrics.  Use Azure Service Health to monitor Azure Firewall health.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Use forced tunneling so you don't expose your Azure resources directly to the internet. This approach reduces the attack surface and minimizes the risk of external threats. To enforce corporate policies and compliance requirements more effectively, route all internet-bound traffic through an on-premises firewall or an NVA.",
            "guid": "7abca50a-05ca-41fc-8485-cd536ba9ec86",
            "service": "Firewall",
            "text": "Configure Azure Firewall in forced tunneling mode if you need to route all internet-bound traffic to a designated next hop instead of directly to the internet. This recommendation doesn't apply to Virtual WAN. <BR><BR> Azure Firewall must have direct internet connectivity. If your AzureFirewallSubnet learns a default route to your on-premises network via the Border Gateway Protocol, you must configure Azure Firewall in forced tunneling mode. You can use the forced tunneling feature to add another /26 address space for the Azure Firewall Management subnet. Name the subnet AzureFirewallManagementSubnet. If you have an existing Azure Firewall instance that you can't reconfigure in forced tunneling mode, create a UDR with a 0.0.0.0/0 route. Set the NextHopType value as Internet. To maintain internet connectivity, associate the UDR with AzureFirewallSubnet.  Set the public IP address to None to deploy a fully private data plane when you configure Azure Firewall in forced tunneling mode. But the management plane still requires a public IP for management purposes only. The internal traffic from virtual and on-premises networks doesn't use that public IP.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Organize rules in a hierarchical structure so that granular policies can meet the requirements of specific regions. Each policy can contain different sets of Destination Network Address Translation (DNAT), network, and application rules that have specific priorities, actions, and processing orders.",
            "guid": "0d9c6369-6b1b-49db-8198-68f2344273d8",
            "service": "Firewall",
            "text": "Create rules for Firewall policies in an hierarchical structure to overlay a central base policy. For more information, see Use Azure Firewall policies to process rules. <BR><BR> Create your rules based on the least-privilege access Zero Trust principle",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Enable security partner providers in Azure Firewall to take advantage of best-in-breed cloud security offerings, which provide advanced protection for your internet traffic. These providers offer specialized, user-aware filtering and comprehensive threat-detection capabilities that enhance your overall security posture.",
            "guid": "7bfae9e9-d97d-4d04-97a6-7eb31a73ed10",
            "service": "Firewall",
            "text": "Configure supported security partner providers within Firewall Manager to protect outbound connections. <BR><BR> This scenario requires Virtual WAN with a S2S VPN gateway in the hub because it uses an IPsec tunnel to connect to the provider's infrastructure. Managed security service providers might charge extra license fees and limit throughput on IPsec connections. You can also use alternative solutions, such as Zscaler Cloud Connector.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Enable this feature to point clients in the virtual networks to Azure Firewall as a DNS server. This feature protects internal DNS infrastructure that's not directly accessed and exposed.",
            "guid": "68949fe5-365d-4c55-b909-d52c39d24b6d",
            "service": "Firewall",
            "text": "Enable Azure Firewall DNS proxy configuration. <BR><BR> Also configure Azure Firewall to use custom DNS for forwarding DNS queries.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Send traffic through the firewall to inspect traffic and help identify and block malicious traffic. <BR><BR> Use Azure Firewall as an explicit proxy for outbound traffic so that web traffic reaches the firewall's private IP address and therefore egresses directly from the firewall without using a UDR. This feature also facilitates the use of multiple firewalls without modifying existing network routes.",
            "guid": "7269ebdb-4f21-41f7-846b-b0f90145a8ca",
            "service": "Firewall",
            "text": "Configure UDRs to force traffic through Azure Firewall in a traditional hub-and-spoke architecture for spoke-to-spoke, spoke-to-internet, and spoke-to-hybrid connectivity. <BR><BR> In Virtual WAN, configure routing intent and policies to redirect private traffic or internet traffic through the Azure Firewall instance that's integrated into the hub. <BR><BR> If you can't apply a UDR, and you only require web traffic redirection, use Azure Firewall as an explicit proxy on the outbound path. You can configure a proxy setting on the sending application, such as a web browser, when you configure Azure Firewall as a proxy.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Use FQDNs in Azure Firewall network rules so that administrators can manage domain names instead of multiple IP addresses, which simplifies management. This dynamic resolution ensures that firewall rules automatically update when domain IPs change.",
            "guid": "dbcfaeb4-af8a-4536-aea5-b0941fe8cb1c",
            "service": "Firewall",
            "text": "Use FQDN filtering in network rules. You must enable the Azure Firewall DNS proxy configuration to use FQDNs in your network rules.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Use service tags in network rules so you can define access controls based on service names rather than specific IP addresses, which simplifies security management. Microsoft manages and updates these tags automatically when IP addresses change. This method ensures that your firewall rules remain accurate and effective without manual intervention.",
            "guid": "a24f4843-209c-4f51-88e6-1908be48e722",
            "service": "Firewall",
            "text": "Use Azure Firewall service tags in place of specific IP addresses to provide selective access to specific services in Azure, Microsoft Dynamics 365, and Microsoft 365.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Use FQDN tags in Azure Firewall application rules to represent a group of FQDNs that are associated with well-known Microsoft services. This method simplifies the management of network security rules.",
            "guid": "4063f792-86cc-469b-9b6d-3c3d5e7f5d74",
            "service": "Firewall",
            "text": "Use FQDN tags in application rules to provide selective access to specific Microsoft services. <BR><BR> You can use an FQDN tag in application rules to allow the required outbound network traffic through your firewall for specific Azure services, such as Microsoft 365, Windows 365, and Microsoft Intune.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Use threat intelligence to provide real-time protection against emerging threats, which reduces the risk of cyberattacks. This feature uses the Microsoft threat intelligence feed to automatically alert and block traffic from known malicious IP addresses, domains, and URLs.",
            "guid": "e8dcc3ab-b391-475c-8d78-cee55c784f06",
            "service": "Firewall",
            "text": "Enable threat intelligence on Azure Firewall in Alert and deny mode.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Enable IDPS filtering in Azure Firewall provides real-time monitoring and analysis of network traffic to detect and prevent malicious activities. This feature uses signature-based detection to swiftly identify known threats and block them before they cause harm.  For more information, see Detect abuse.",
            "guid": "053202f4-db7d-4b08-ad61-c5d0037b713a",
            "service": "Firewall",
            "text": "Enable the IDPS in Alert or Alert and deny mode. Consider the performance impact of this feature.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Enable TLS inspection so that Azure Firewall Premium terminates and inspects TLS connections to detect, alert, and mitigate malicious activity in HTTPS.",
            "guid": "ab822518-b2ff-4048-8e9f-5a86d431d063",
            "service": "Firewall",
            "text": "Use an internal enterprise certification authority (CA) to generate certificates when you use TLS inspection with Azure Firewall Premium. Use self-signed certificates only for testing and proof of concept (PoC) purposes.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Configure an Azure DDoS Protection plan so that you can centrally manage DDoS protection alongside your firewall policies. This approach streamlines how you manage your network security and simplifies how you deploy and monitor processes.",
            "guid": "05a6fac9-edc2-49bc-8bf8-17950c0cd710",
            "service": "Firewall",
            "text": "Use Firewall Manager to create and associate an Azure DDoS Protection plan with your hub virtual network. This approach doesn't apply to Virtual WAN.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "9220cde5-ecbc-4eb1-a5ac-65e56e2aa925",
            "service": "Firewall",
            "text": "Select an Azure Firewall SKU to deploy. Choose from three Azure Firewall SKUs: Basic, Standard, and Premium. Use Azure Firewall Premium to secure highly sensitive applications, such as payment processing. Use Azure Firewall Standard if your workload needs a Layer 3 to Layer 7 firewall and needs autoscaling to handle peak traffic periods of up to 30 Gbps. Use Azure Firewall Basic if you use SMB and require up to 250 Mbps of throughput. You can downgrade or upgrade between Standard and Premium SKUs. For more information, see Choose the right Azure Firewall SKU.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "54c37b38-2e3d-4cf9-b174-bee69a2a5b5d",
            "service": "Firewall",
            "text": "Remove unused firewall deployments and optimize underused deployments. Stop Azure Firewall deployments that don't need to continuously run. Identify and delete unused Azure Firewall deployments. To reduce operational costs, monitor and optimize firewall instances usage, Azure Firewall Manager policies configuration, and the number of public IP addresses and policies that you use.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "a522ab1e-0659-43b3-9fad-906116bb1432",
            "service": "Firewall",
            "text": "Share the same instance of Azure Firewall. You can use a central instance of Azure Firewall in the hub virtual network or Virtual WAN secure hub and share the same Azure Firewall instance across spoke virtual networks that connect to the same hub from the same region. Ensure that you don't have unexpected cross-region traffic in a hub-and-spoke topology.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "0976c680-8f44-46f9-ae4d-2349eaafd800",
            "service": "Firewall",
            "text": "Optimize traffic through the firewall. Regularly review traffic that Azure Firewall processes. Find opportunities to reduce the amount of traffic that traverses the firewall.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "debc5298-dba5-4c67-a03a-1ca626025139",
            "service": "Firewall",
            "text": "Decrease the amount of log data that you store. Azure Firewall can use Azure Event Hubs to comprehensively log the traffic's metadata and send it to Log Analytics workspaces, Azure Storage, or non-Microsoft solutions. All logging solutions incur costs to process data and provide storage. Large amounts of data can incur significant costs. Consider a cost-effective approach and alternative to Log Analytics, and estimate the cost. Consider whether you need to log traffic metadata for all logging categories.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "Shut down these deployments during off-peak hours or when idle to reduce unnecessary expenses but maintain security and performance during critical times.",
            "guid": "c12bc13f-aeea-4f9c-a7c0-476028848d3c",
            "service": "Firewall",
            "text": "Stop Azure Firewall deployments that don't need to continuously run. You might have development or testing environments that you only use during business hours. For more information, see Deallocate and allocate Azure Firewall.",
            "type": "recommendation",
            "waf": "Cost"
        },
        {
            "description": "Optimize workloads that generate the most traffic through the firewall to reduce the volume of traffic, which decreases the load on the firewall and minimizes data-processing and bandwidth costs.",
            "guid": "fcd6975c-5cb6-4716-9bab-fe8e7cd50e00",
            "service": "Firewall",
            "text": "Regularly review traffic that Azure Firewall processes, and find originating workload optimizations. The top flows log, also known as the fat flows log, shows the top connections that contribute to the highest throughput through the firewall.",
            "type": "recommendation",
            "waf": "Cost"
        },
        {
            "description": "Use this approach to detect cost-effective deployments over time and eliminate unused resources, which prevents unnecessary costs.",
            "guid": "06d0aca0-59c3-4474-aea8-314ebc1d4367",
            "service": "Firewall",
            "text": "Identify and delete unused Azure Firewall deployments. Analyze monitoring metrics and UDRs that are associated with subnets that point to the firewall's private IP. Also consider other validations and internal documentation about your environment and deployments. For example, analyze any classic NAT, network, and application rules for Azure Firewall. And consider your settings. For example, you might configure the DNS proxy setting to Disabled.  For more information, see Monitor Azure Firewall.",
            "type": "recommendation",
            "waf": "Cost"
        },
        {
            "description": "Properly use Firewall Manager and its policies to reduce operational costs, increase efficiency, and reduce management overhead.",
            "guid": "0afd66fd-36c6-44ad-8e71-cd3b247c6816",
            "service": "Firewall",
            "text": "Review your Firewall Manager policies, associations, and inheritance carefully to optimize cost. Policies are billed based on firewall associations. A policy with zero or one firewall association is free. A policy with multiple firewall associations is billed at a fixed rate. For more information, see Firewall Manager pricing.",
            "type": "recommendation",
            "waf": "Cost"
        },
        {
            "description": "Delete unused IP addresses to reduce costs.",
            "guid": "2cbff8d4-4f59-42dc-b186-58f7c4965dbe",
            "service": "Firewall",
            "text": "Review all the public IP addresses in your configuration, and disassociate and delete the ones that you don't use. Evaluate source network address translation (SNAT) port usage before you remove any IP addresses.  For more information, see Monitor Azure Firewall logs and metrics and SNAT port usage.",
            "type": "recommendation",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "733bab93-bd9d-43c1-a780-e977d8f4fd3d",
            "service": "Firewall",
            "text": "Use Firewall Manager with traditional hub-and-spoke topologies or Virtual WAN network topologies to deploy and manage instances of Azure Firewall. Use native security services for traffic governance and protection to create hub-and-spoke and transitive architectures. For more information, see Network topology and connectivity.",
            "type": "checklist",
            "waf": "Operations"
        },
        {
            "description": "",
            "guid": "8271c7ff-1472-4a86-ab05-0538a869631c",
            "service": "Firewall",
            "text": "Maintain regular backups of Azure Policy artifacts. If you use an infrastructure-as-code approach to maintain Azure Firewall and all dependencies, you should have backup and versioning of Azure Firewall policies in place. If you don't, you can deploy a companion mechanism that's based on an external logic app to provide an effective automated solution.",
            "type": "checklist",
            "waf": "Operations"
        },
        {
            "description": "",
            "guid": "09e15d81-89b9-458e-85a1-98ea29c9c72f",
            "service": "Firewall",
            "text": "Monitor Azure Firewall logs and metrics. Take advantage of diagnostic logs for firewall monitoring and troubleshooting and activity logs for auditing operations.",
            "type": "checklist",
            "waf": "Operations"
        },
        {
            "description": "",
            "guid": "ab3610c2-56cf-4888-8bb3-fe3816ee0d11",
            "service": "Firewall",
            "text": "Analyze monitoring data to assess the overall health of the system. Use the built-in Azure Firewall monitoring workbook, familiarize yourself with Kusto Query Language (KQL) queries, and use the policy analytics dashboard to identify potential problems.",
            "type": "checklist",
            "waf": "Operations"
        },
        {
            "description": "",
            "guid": "67eb37ee-d9b8-4aff-8aa3-71011176aa0a",
            "service": "Firewall",
            "text": "Define alerts for key events so that operators can quickly respond to them.",
            "type": "checklist",
            "waf": "Operations"
        },
        {
            "description": "",
            "guid": "5a8645c5-e586-4562-9f0a-7893542586fd",
            "service": "Firewall",
            "text": "Take advantage of platform-provided detection mechanisms in Azure to detect abuse. Integrate Azure Firewall with Microsoft Defender for Cloud and Microsoft Sentinel if possible. Integrate with Defender for Cloud so you can visualize the status of network infrastructure and network security in one place, including Azure network security across all virtual networks and virtual hubs in different regions in Azure. Integrate with Microsoft Sentinel to provide threat-detection and prevention capabilities.",
            "type": "checklist",
            "waf": "Operations"
        },
        {
            "description": "Enable diagnostic logs to optimize your monitoring tools and strategies for Azure Firewall.  Use structured firewall logs to structure log data so that it's easy to search, filter, and analyze. The latest monitoring tools are based on this type of log, so it's often a prerequisite.",
            "guid": "1069db41-1f8c-43b3-a25f-9981cc78e397",
            "service": "Firewall",
            "text": "Enable diagnostic logs for Azure Firewall. Use firewall logs or workbooks to monitor Azure Firewall. You can also use activity logs to audit operations on Azure Firewall resources.  Use the structured firewall logs format. Only use the previous diagnostic logs format if you have an existing tool that requires it. Don't enable both logging formats at the same time.",
            "type": "recommendation",
            "waf": "Operations"
        },
        {
            "description": "Use the Azure Firewall workbook to extract valuable insights from Azure Firewall events, analyze your application and network rules, and examine statistics about firewall activities across URLs, ports, and addresses.",
            "guid": "3e10f8ea-c20e-4374-9e58-52969a407dc5",
            "service": "Firewall",
            "text": "Use the built-in Azure Firewall workbook.",
            "type": "recommendation",
            "waf": "Operations"
        },
        {
            "description": "Set up alerts for key events to notify operators before potential problems arise, help prevent disruptions, and initiate quick capacity adjustments.",
            "guid": "7f972e0f-0259-4783-b9e6-82c278711b0f",
            "service": "Firewall",
            "text": "Monitor Azure Firewall logs and metrics, and create alerts for Azure Firewall capacity. Create alerts to monitor Throughput, Firewall health state, SNAT port utilization, and AZFW latency probe metrics.",
            "type": "recommendation",
            "waf": "Operations"
        },
        {
            "description": "Use policy analytics to analyze the impact of your Azure Firewall policies. Identify potential problems in your policies, such as meeting policy limits, improper rules, and improper IP groups usage. Get recommendations to improve your security posture and rule-processing performance.",
            "guid": "90c06dd6-c01a-4f49-9054-7073f5c774ae",
            "service": "Firewall",
            "text": "Regularly review the policy analytics dashboard to identify potential problems.",
            "type": "recommendation",
            "waf": "Operations"
        },
        {
            "description": "Use KQL queries to quickly identify events inside your firewall and check to see which rule is triggered or which rule allows or blocks a request.",
            "guid": "a3aa7729-46bd-4de6-82e6-28ac9d631b7a",
            "service": "Firewall",
            "text": "Understand KQL queries so you can use Azure Firewall logs to quickly analyze and troubleshoot problems. Azure Firewall provides sample queries.",
            "type": "recommendation",
            "waf": "Operations"
        },
        {
            "description": "",
            "guid": "9e42071b-fe43-455d-afa9-5ed2c33c7d20",
            "service": "Firewall",
            "text": "Optimize your Azure Firewall configuration in accordance with the Well-Architected Framework recommendations to optimize code and infrastructure and ensure peak operation. To maintain an efficient and secure network, regularly review and optimize firewall rules. This practice helps ensure that your firewall configurations remain effective and up to date with the latest security threats.",
            "type": "checklist",
            "waf": "Performance"
        },
        {
            "description": "",
            "guid": "1655f213-e590-45ee-8819-9a5e40f83430",
            "service": "Firewall",
            "text": "Don't use Azure Firewall for intra-virtual network traffic control. Use Azure Firewall to control the following types of traffic:",
            "type": "checklist",
            "waf": "Performance"
        },
        {
            "description": "",
            "guid": "c3ae17a3-eff4-4f6e-98b9-df3a59bacfd9",
            "service": "Firewall",
            "text": "Warm up Azure Firewall properly before performance tests. Create initial traffic that isn't part of your load tests 20 minutes before your tests. Use diagnostics settings to capture scale-up and scale-down events. You can use the Azure Load Testing service to generate the initial traffic so you can scale up Azure Firewall to the maximum number of instances.",
            "type": "checklist",
            "waf": "Performance"
        },
        {
            "description": "",
            "guid": "df91da5c-22c8-4c7c-bfe5-9a1ede0028d9",
            "service": "Firewall",
            "text": "Configure an Azure Firewall subnet with a /26 address space. You need a dedicated subnet for Azure Firewall. Azure Firewall provisions more capacity as it scales.",
            "type": "checklist",
            "waf": "Performance"
        },
        {
            "description": "",
            "guid": "ddf79c25-05f6-4085-94c4-9534ec1a05fa",
            "service": "Firewall",
            "text": "Don't enable advanced logging if you don't need it. Azure Firewall provides some advanced logging capabilities that can incur significant costs to keep active. Instead, you can use these capabilities for troubleshooting purposes only and for limited amounts of time. Disable capabilities when you don't need them. For example, top flows and flow trace logs are expensive and can cause excessive CPU and storage usage on the Azure Firewall infrastructure.",
            "type": "checklist",
            "waf": "Performance"
        },
        {
            "description": "Use policy analytics to identify potential problems in your policies, such as meeting policy limits, improper rules, and improper IP groups usage. Get recommendations to improve your security posture and rule-processing performance.",
            "guid": "9a20f369-25cd-45ba-bda7-e56f1e379e15",
            "service": "Firewall",
            "text": "Use the policy analytics dashboard to identify ways to optimize Azure Firewall policies.",
            "type": "recommendation",
            "waf": "Performance"
        },
        {
            "description": "Place frequently used rules high in a rule set to optimize processing latency. Azure Firewall processes rules based on the rule type, inheritance, rule collection group priority, and rule collection priority. Azure Firewall processes high-priority rule collection groups first. Inside a rule collection group, Azure Firewall processes rule collections that have the highest priority first.",
            "guid": "ce0fa221-61f9-41ab-a9ed-233f5546d732",
            "service": "Firewall",
            "text": "Place frequently used rules early in a group to optimize latency for Azure Firewall policies that have large rule sets.  For more information, see Use Azure Firewall policies to process rules.",
            "type": "recommendation",
            "waf": "Performance"
        },
        {
            "description": "This approach effectively increases the number of IP addresses that you can cover without exceeding the limit. For each rule, Azure multiplies ports by IP addresses. So, if one rule has four IP address ranges and five ports, you consume 20 network rules.",
            "guid": "1d2f023e-7dcf-4f55-b07f-1a93c9c0ab4e",
            "service": "Firewall",
            "text": "Use IP groups to summarize IP address ranges and avoid exceeding the limit of unique source or unique destination network rules. Azure Firewall treats the IP group as a single address when you create network rules.",
            "type": "recommendation",
            "waf": "Performance"
        },
        {
            "description": "This feature dynamically categorizes web content and permits the creation of compact application rules, which reduces operational overhead.",
            "guid": "2007a892-6911-4310-b6eb-5eb3660dc8c9",
            "service": "Firewall",
            "text": "Use Azure Firewall web categories to allow or deny outbound access in bulk, instead of explicitly building and maintaining a long list of public internet sites.",
            "type": "recommendation",
            "waf": "Performance"
        },
        {
            "description": "Enable IDPS in Alert and deny mode to detect and prevent malicious network activity. This feature might introduce a performance penalty. Understand the effect on your workload so you can plan accordingly.",
            "guid": "984c7d68-82f6-48e9-a894-a8e7717d49e2",
            "service": "Firewall",
            "text": "Evaluate the performance impact of IDPS in Alert and deny mode. For more information, see Azure Firewall performance.",
            "type": "recommendation",
            "waf": "Performance"
        },
        {
            "description": "Azure Firewall supports 2,496 ports for each public IP address that each back-end Azure Virtual Machine Scale Sets instance uses. This configuration increases the available SNAT ports by five times.  By default, Azure Firewall deploys two Virtual Machine Scale Sets instances that support 4,992 ports for each flow destination IP, destination port, and TCP or UDP protocol. The firewall scales up to a maximum of 20 instances.",
            "guid": "899877c6-618a-4814-953a-7c7ce430e407",
            "service": "Firewall",
            "text": "Configure Azure Firewall deployments with a minimum of five public IP addresses for deployments that are susceptible to SNAT port exhaustion.",
            "type": "recommendation",
            "waf": "Performance"
        },
        {
            "description": "",
            "guid": "59ed40bd-06a0-4125-ab99-afc88a248aa5",
            "service": "Front Door",
            "text": "Estimate the traffic pattern and volume. The number of requests from the client to the Azure Front Door edge might influence your tier choice. If you need to support a high volume of requests, consider the Azure Front Door Premium tier because performance ultimately impacts availability. However, there's a cost tradeoff. These tiers are described in Performance Efficiency.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "51f023f3-53b4-4878-8548-2b08a6b095ab",
            "service": "Front Door",
            "text": "Choose your deployment strategy. The fundamental deployment approaches are active-active and active-passive. Active-active deployment means that multiple environments or stamps that run the workload serve traffic. Active-passive deployment means that only the primary region handles all traffic, but it fails over to the secondary region when necessary. In a multiregion deployment, stamps run in different regions for higher availability with a global load balancer, like Azure Front Door, that distributes traffic. Therefore, it's important to configure the load balancer for the appropriate deployment approach.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "486f318a-8747-45e5-a5f4-97642d4fada6",
            "service": "Front Door",
            "text": "Use the same host name on Azure Front Door and origin servers. To ensure that cookies or redirect URLs work properly, preserve the original HTTP host name when you use a reverse proxy, like a load balancer, in front of a web application.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "9bc96e35-d25f-4521-86f8-8cadefb23576",
            "service": "Front Door",
            "text": "Implement the health endpoint monitoring pattern. Your application should expose health endpoints, which aggregate the state of the critical services and dependencies that your application needs to serve requests. Azure Front Door health probes use the endpoint to detect origin servers' health. For more information, see Health Endpoint Monitoring pattern.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "96c8dc89-cafe-411e-9080-35c13fffb8b3",
            "service": "Front Door",
            "text": "Take advantage of the built-in content delivery network functionality in Azure Front Door. The content delivery network feature of Azure Front Door has hundreds of edge locations and can help withstand distributed denial of service (DDoS) attacks. These capabilities help improve reliability.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "750bc3ba-30aa-44fc-88aa-bc93cdf29cdf",
            "service": "Front Door",
            "text": "Consider a redundant traffic management option. Azure Front Door is a globally distributed service that runs as a singleton in an environment. Azure Front Door is a potential single point of failure in the system. If the service fails, then clients can't access your application during the downtime.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "You can select the best origin resource by using a series of decision steps and your design. The selected origin serves traffic within the allowable latency range in the specified ratio of weights.",
            "guid": "1a6fba56-5098-4506-9be0-940fe556996c",
            "service": "Front Door",
            "text": "Choose a routing method that supports your deployment strategy.  The weighted method, which distributes traffic based on the configured weight coefficient, supports active-active models.  A priority-based value that configures the primary region to receive all traffic and send traffic to the secondary region as a backup supports active-passive models.  Combine the preceding methods with latency so that the origin with the lowest latency receives traffic.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Multiple origins support redundancy by distributing traffic across multiple instances of the application. If one instance is unavailable, then other back-end origins can still receive traffic.",
            "guid": "00f51ce2-46a9-4051-ab0e-762743d0837d",
            "service": "Front Door",
            "text": "Support redundancy by having multiple origins in one or more back-end pools. Always have redundant instances of your application and make sure each instance exposes an endpoint or origin. You can place those origins in one or more back-end pools.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Enabled health probes are part of the health monitoring pattern implementation. Health probes make sure that Azure Front Door only routes traffic to instances that are healthy enough to handle requests.  For more information, see Best practices on health probes.",
            "guid": "17fbec2c-ddb4-4490-946c-a151ae0fadd4",
            "service": "Front Door",
            "text": "Set up health probes on the origin. Configure Azure Front Door to conduct health checks to determine if the back-end instance is available and ready to continue receiving requests.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Timeouts help prevent performance issues and availability issues by terminating requests that take longer than expected to complete.",
            "guid": "1a308f11-1d93-4d57-bd84-cbd8f6198dd2",
            "service": "Front Door",
            "text": "Set a timeout on forwarding requests to the back end.  Adjust the timeout setting according to your endpoints' needs. If you don't, Azure Front Door might close the connection before the origin sends the response.  You can also lower the default timeout for Azure Front Door if all of your origins have a shorter timeout.  For more information, see Troubleshooting unresponsive requests.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Set the same host name to prevent malfunction with session affinity, authentication, and authorization. For more information, see Preserve the original HTTP host name between a reverse proxy and its back-end web application.",
            "guid": "7af90aa7-b21f-432f-858b-2d872c752d7f",
            "service": "Front Door",
            "text": "Use the same host name on Azure Front Door and your origin. Azure Front Door can rewrite the host header of incoming requests, which is useful when you have multiple custom domain names that route to one origin. However, rewriting the host header might cause issues with request cookies and URL redirection.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "With session affinity, user connections stay on the same origin during the user session. If that origin becomes unavailable, the user experience might be disrupted.",
            "guid": "f66a8d49-8d0a-4952-9db2-ac2e526f08ad",
            "service": "Front Door",
            "text": "Decide if your application requires session affinity. If you have high reliability requirements, we recommend that you disable session affinity.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Limit requests to prevent clients from sending too much traffic to your application. Rate limiting can help you avoid problems like a retry storm.",
            "guid": "63faaf18-da4b-4274-ac3c-d955f2a2e01b",
            "service": "Front Door",
            "text": "Take advantage of the rate-limiting rules that are included with a web application firewall (WAF).",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "ad186a96-5de2-4bf7-acd4-5b534cdb3e97",
            "service": "Front Door",
            "text": "Review the security baseline for Azure Front Door.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "b31346d7-4fde-42c2-82fe-2e4d54aa8f1b",
            "service": "Front Door",
            "text": "Protect the back-end servers. The front end acts as the single point of ingress to the application.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "903b1844-994a-49e8-8e08-6ef445aec4f7",
            "service": "Front Door",
            "text": "Allow only authorized access to the control plane. Use Azure Front Door role-based access control (RBAC) to restrict access to only the identities that need it.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "329c0516-9a14-45ea-ad04-fe75453c8d88",
            "service": "Front Door",
            "text": "Block common threats at the edge. WAF is integrated with Azure Front Door. Enable WAF rules on the front ends to protect applications from common exploits and vulnerabilities at the network edge, closer to the attack source.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "d323ca3c-f7df-4f7e-b7c9-698d2bdad3e2",
            "service": "Front Door",
            "text": "Protect Azure Front Door against unexpected traffic. Azure Front Door uses the basic plan of Azure DDoS protection to protect application endpoints from DDoS attacks. If you need to expose other public IP addresses from your application, consider adding the DDoS Protection standard plan for those addresses for advanced protection and detection capabilities.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "fcb4a654-3e3b-408c-9538-a1dfefdef774",
            "service": "Front Door",
            "text": "Protect data in transit. Enable end-to-end Transport Layer Security (TLS), HTTP to HTTPS redirection, and managed TLS certificates when applicable. For more information, see TLS best practices for Azure Front Door.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "451f9871-3ca1-40b9-a1f6-c5eb0a37213b",
            "service": "Front Door",
            "text": "Monitor anomalous activity. Regularly review the logs to check for attacks and false positives. Send WAF logs from Azure Front Door to your organization's centralized security information and event management (SIEM), such as Microsoft Sentinel, to detect threat patterns and incorporate preventative measures in the workload design.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "Default rule sets are updated frequently based on OWASP top-10 attack types and information from Microsoft Threat Intelligence.  The specialized rule sets detect certain use cases. For example, bot rules classify bots as good, bad, or unknown based on the client IP addresses. They also block bad bots and known IP addresses and restrict traffic based on geographical location of the callers.  By using a combination of rule sets, you can detect and block attacks with various intents.",
            "guid": "711c450c-ac42-4570-b2fd-22319b4a7913",
            "service": "Front Door",
            "text": "Enable WAF rule sets that detect and block potentially malicious traffic. This feature is available on the Premium tier. We recommend these rule sets:  - Default- Bot protection- IP restriction- Geo-filtering- Rate limiting",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Reduce false positives and allow legitimate requests for your application.",
            "guid": "a6fe49f4-0b1f-4677-af1f-b766f073ac6c",
            "service": "Front Door",
            "text": "Create exclusions for managed rule sets.  Test a WAF policy in detection mode for a few weeks and adjust any false positives before you deploy it.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "TLS ensures that data exchanges between the browser, Azure Front Door, and the back-end origins are encrypted to prevent tampering.  Key Vault offers managed certificate support and simple certificate renewal and rotation.",
            "guid": "450b511f-9e82-45ce-986b-769ea00dbeaa",
            "service": "Front Door",
            "text": "Enable end-to-end TLS, HTTP to HTTPS redirection, and managed TLS certificates when applicable.  Review the TLS best practices for Azure Front Door.  Use TLS version 1.2 as the minimum allowed version with ciphers that are relevant for your application.  Azure Front Door managed certificates should be your default choice for ease of operations. However, if you want to manage the lifecycle of the certificates, use your own certificates in Azure Front Door custom domain endpoints and store them in Key Vault.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "baeb625f-93ac-4181-be7b-07f474584985",
            "service": "Front Door",
            "text": "Review Azure Front Door tiers and pricing. Use the pricing calculator to estimate the realistic costs for each tier. Compare the features and suitability of each tier for your scenario. For instance, only the Premium tier supports connecting to your origin via Private Link.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "ed02627c-4a6d-4d6e-982f-a1fbee4a7259",
            "service": "Front Door",
            "text": "Consider bandwidth costs. The bandwidth costs of Azure Front Door depend on the tier that you choose and the type of data transfer. Azure Front Door provides built-in reports for billable metrics. To assess your costs related to bandwidth and where you can focus your optimization efforts, see Azure Front Door reports.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "e2e0bb7e-521d-4729-9579-5c9539a68867",
            "service": "Front Door",
            "text": "Optimize incoming requests. Azure Front Door bills the incoming requests. You can set restrictions in your design configuration.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "337e7030-494e-4be5-8920-9144cb02c399",
            "service": "Front Door",
            "text": "Use resources efficiently. Azure Front Door uses a routing method that helps with resource optimization. Unless the workload is extremely latency sensitive, distribute traffic evenly across all environments to effectively use deployed resources.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "add1a775-b13c-477b-acc7-38dbcccd51fe",
            "service": "Front Door",
            "text": "Consider using a shared instance that's provided by the organization. Costs incurred from centralized services are shared between the workloads. However, consider the tradeoff with reliability. For mission-critical applications that have high availability requirements, we recommend an autonomous instance.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "48f2f718-1ae7-476f-a0a1-d6b83e47bbaa",
            "service": "Front Door",
            "text": "Pay attention to the amount of data logged. Costs related to both bandwidth and storage can accrue if certain requests aren't necessary or if logging data is retained for a long period of time.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "Caching optimizes data transfer costs because it reduces the number of calls from your Azure Front Door instance to the origin.",
            "guid": "5a9023b8-c181-41d5-aeb5-9c09a85b0792",
            "service": "Front Door",
            "text": "Use caching for endpoints that support it.",
            "type": "recommendation",
            "waf": "Cost"
        },
        {
            "description": "Compression reduces bandwidth consumption and improves performance.",
            "guid": "84da68ee-7bb0-4a7d-ad70-d53c186ffd3e",
            "service": "Front Door",
            "text": "Consider enabling file compression. For this configuration, the application must support compression and caching must be enabled.",
            "type": "recommendation",
            "waf": "Cost"
        },
        {
            "description": "You can save on bandwidth costs by disabling requests that aren't required to make routing decisions.",
            "guid": "5d3ad5cb-d897-4ae7-8d1c-ae8398c79ed6",
            "service": "Front Door",
            "text": "Disable health checks in single back-end pools.If you have only one origin configured in your Azure Front Door origin group, these calls are unnecessary.",
            "type": "recommendation",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "5e8bfd0e-20d9-441f-814d-c2b49e7033ea",
            "service": "Front Door",
            "text": "Use infrastructure as code (IaC) technologies. Use IaC technologies like Bicep and Azure Resource Manager templates to provision the Azure Front Door instance. These declarative approaches provide consistency and straightforward maintenance. For example, by using IaC technologies, you can easily adopt new ruleset versions.",
            "type": "checklist",
            "waf": "Operations"
        },
        {
            "description": "",
            "guid": "e9bd20e3-6e61-4907-9b84-4bd50b867875",
            "service": "Front Door",
            "text": "Simplify configurations. Use Azure Front Door to easily manage configurations. For example, suppose your architecture supports microservices. Azure Front Door supports redirection capabilities, so you can use path-based redirection to target individual services.",
            "type": "checklist",
            "waf": "Operations"
        },
        {
            "description": "",
            "guid": "bb3943fb-6d97-458d-be6a-d9b71e8898d7",
            "service": "Front Door",
            "text": "Handle progressive exposure by using Azure Front Door routing methods. For a weighted load balancing approach you can use a canary deployment to send a specific percentage of traffic to a back end. This approach helps you test new features and releases in a controlled environment before you roll them out.",
            "type": "checklist",
            "waf": "Operations"
        },
        {
            "description": "",
            "guid": "5e1264a9-c6cc-4d4e-8e73-7ca4b3f05c17",
            "service": "Front Door",
            "text": "Collect and analyze Azure Front Door operational data as part of your workload monitoring. Capture relevant Azure Front Door logs and metrics with Azure Monitor Logs. This data helps you troubleshoot, understand user behaviors, and optimize operations.",
            "type": "checklist",
            "waf": "Operations"
        },
        {
            "description": "",
            "guid": "8bdff2ab-0800-45ef-acab-ff7d320856aa",
            "service": "Front Door",
            "text": "Offload certificate management to Azure. Ease the operational burden associated with certification rotation and renewals.",
            "type": "checklist",
            "waf": "Operations"
        },
        {
            "description": "When redirection is enabled, Azure Front Door automatically redirects clients that are using older protocol to use HTTPS for a secure experience.",
            "guid": "829f4fea-1653-4093-aaf7-93b6a30aae1f",
            "service": "Front Door",
            "text": "Use HTTP to HTTPS redirection to support forward compatibility.",
            "type": "recommendation",
            "waf": "Operations"
        },
        {
            "description": "Monitoring ingress flow is a crucial part of monitoring an application. You want to track requests and make performance and security improvements. You need data to debug your Azure Front Door configuration.  With alerts in place, you can get instant notifications of any critical operational issues.",
            "guid": "8ad83783-d01c-4772-a76b-39f7c9d61cc7",
            "service": "Front Door",
            "text": "Capture logs and metrics.  Include resource activity logs, access logs, health probe logs, and WAF logs. Set up alerts.",
            "type": "recommendation",
            "waf": "Operations"
        },
        {
            "description": "A holistic view of your Azure Front Door profile helps drive improvements based on traffic and security reports through WAF metrics.",
            "guid": "e5e56ee9-79e4-4fa8-9fdb-600748d7df10",
            "service": "Front Door",
            "text": "Review the built-in analytics reports.",
            "type": "recommendation",
            "waf": "Operations"
        },
        {
            "description": "Azure Front Door can issue and manage certificates for you. This feature eliminates the need for certificate renewals and minimizes the risk of an outage due to an invalid or expired TLS certificate.",
            "guid": "c2fcfdfb-fedb-4b47-93ac-1988250f76cd",
            "service": "Front Door",
            "text": "Use managed TLS certificates when possible.",
            "type": "recommendation",
            "waf": "Operations"
        },
        {
            "description": "You don't need to modify the configuration to add or specify each subdomain separately.",
            "guid": "0d7deaf4-ec0e-4e32-8b6b-64f3190d10f6",
            "service": "Front Door",
            "text": "Use wildcard TLS certificates.",
            "type": "recommendation",
            "waf": "Operations"
        },
        {
            "description": "",
            "guid": "d18003c9-2d90-4e52-b503-5fcdb4ffcd96",
            "service": "Front Door",
            "text": "Plan capacity by analyzing your expected traffic patterns. Conduct thorough testing to understand how your application performs under different loads. Consider factors like simultaneous transactions, request rates, and data transfer.",
            "type": "checklist",
            "waf": "Performance"
        },
        {
            "description": "",
            "guid": "87c450a0-6a4a-453c-ae38-b8f21952ab79",
            "service": "Front Door",
            "text": "Analyze performance data by regularly reviewing Azure Front Door reports. These reports provide insights into various metrics that serve as performance indicators at the technology level.",
            "type": "checklist",
            "waf": "Performance"
        },
        {
            "description": "",
            "guid": "a9d9ffe4-3fa7-48c8-bc1d-d0685e495dbe",
            "service": "Front Door",
            "text": "Optimize data transfers.",
            "type": "checklist",
            "waf": "Performance"
        },
        {
            "description": "",
            "guid": "161bc803-0586-4d21-b2ea-018d78209565",
            "service": "Front Door",
            "text": "Optimize the use of health probes. Get health information from health probes only when the state of the origins change. Strike a balance between monitoring accuracy and minimizing unnecessary traffic.",
            "type": "checklist",
            "waf": "Performance"
        },
        {
            "description": "",
            "guid": "8596ddcf-3f3c-4b1c-baa1-a7eb844b2fb6",
            "service": "Front Door",
            "text": "Review the origin routing method. Azure Front Door provides various routing methods, including latency-based, priority-based, weighted, and session affinity-based routing, to the origin. These methods significantly affect your application's performance. To learn more about the best traffic routing option for your scenario, see Traffic routing methods to origin.",
            "type": "checklist",
            "waf": "Performance"
        },
        {
            "description": "",
            "guid": "205d3288-088c-4f24-af39-f9cb610c54a1",
            "service": "Front Door",
            "text": "Review the location of origin servers. Your origin servers' location impacts the responsiveness of your application. Origin servers should be closer to the users. Azure Front Door ensures that users from a specific location access the nearest Azure Front Door entry point. The performance benefits include faster user experience, better use of latency-based routing by Azure Front Door, and minimized data transfer time by using caching, which stores content closer to users.",
            "type": "checklist",
            "waf": "Performance"
        },
        {
            "description": "Azure Front Door offers a robust content delivery network solution that caches content at the edge of the network. Caching reduces the load on the back-end servers and reduces data movement across the network, which helps offload bandwidth usage.",
            "guid": "2f6a39a1-884a-4661-accd-f534bf795a96",
            "service": "Front Door",
            "text": "Enable caching.  You can optimize query strings for caching. For purely static content, ignore query strings to maximize your use of the cache.  If your application uses query strings, consider including them in the cache key. Including the query strings in the cache key allows Azure Front Door to serve cached responses or other responses, based on your configuration.",
            "type": "recommendation",
            "waf": "Performance"
        },
        {
            "description": "Compression in Azure Front Door helps deliver content in the optimal format, has a smaller payload, and delivers content to the users faster.",
            "guid": "09c90ce3-ade6-413a-9c1b-45d33d6d9069",
            "service": "Front Door",
            "text": "Use file compression when you're accessing downloadable content.",
            "type": "recommendation",
            "waf": "Performance"
        },
        {
            "description": "`HEAD` requests let you query a state change without fetching its entire content.",
            "guid": "15daeecf-bcbf-4c46-b196-030839fd4864",
            "service": "Front Door",
            "text": "When you configure health probes in Azure Front Door, consider using `HEAD` requests instead of `GET` requests.  The health probe reads only the status code, not the content.",
            "type": "recommendation",
            "waf": "Performance"
        },
        {
            "description": "Optimize performance and maintain continuity for user sessions, especially when applications rely on maintaining state information locally.",
            "guid": "2a92f55e-a422-49f4-9a26-8ba819a17323",
            "service": "Front Door",
            "text": "Evaluate whether you should enable session affinity when requests from the same user should be directed to the same back-end server.  From a reliability perspective, we don't recommend this approach. If you use this option, the application should gracefully recover without disrupting user sessions.  There's also a tradeoff on load balancing because it restricts the flexibility of distributing traffic across multiple back ends evenly.",
            "type": "recommendation",
            "waf": "Performance"
        },
        {
            "description": "",
            "guid": "ad7540f5-4cb1-4fc5-b168-e1cd97a0aef6",
            "service": "AKS",
            "text": "Cluster architecture: For critical workloads, use availability zones for your AKS clusters.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "904fdfa5-af9a-4195-b683-e3bb7627b394",
            "service": "AKS",
            "text": "Cluster architecture: Plan the IP address space to ensure your cluster can reliably scale, including handling of failover traffic in multi-cluster topologies.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "00c83f06-95ab-41c2-aef0-c770e177066f",
            "service": "AKS",
            "text": "Cluster architecture: Review the Best practices for monitoring Kubernetes with Azure Monitor to determine the best monitoring strategy for your workloads.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "fa12c27b-df70-41fd-a93a-680e3cacf7ac",
            "service": "AKS",
            "text": "Workload architecture: Ensure workloads are built to support horizontal scaling and report application readiness and health.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "f2297ffc-fec7-43c6-9187-9739264c9d66",
            "service": "AKS",
            "text": "Cluster and workload architectures: Ensure your workload is running on user node pools and chose the right size SKU. At a minimum, include two nodes for user node pools and three nodes for the system node pool.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "0b542d27-1846-4d1b-9c5e-bd7c0d079cb3",
            "service": "AKS",
            "text": "Cluster architecture: Use the AKS Uptime SLA to meet availability targets for production workloads.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "Allows the Kubernetes scheduler to logically isolate workloads by hardware in the node. Unlike tolerations, pods without a matching node selector can be scheduled on labeled nodes, which allows unused resources on the nodes to consume, but gives priority to pods that define the matching node selector. Use node affinity for more flexibility, which allows you to define what happens if the pod can't be matched with a node.",
            "guid": "b11892cd-f678-4399-bac8-b98095e250c6",
            "service": "AKS",
            "text": "Cluster and workload architectures: Control pod scheduling using node selectors and affinity.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Azure CNI is required for specific scenarios, for example, Windows-based node pools, specific networking requirements and Kubernetes Network Policies. Reference Kubenet versus Azure CNI for more information.",
            "guid": "9e3e8182-95e7-4953-9a2b-9cc2f77bf717",
            "service": "AKS",
            "text": "Cluster architecture: Ensure proper selection of network plugin based on network requirements and cluster sizing.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "The AKS Uptime SLA guarantees: - `99.95%` availability of the Kubernetes API server endpoint for AKS Clusters that use Azure Availability Zones, or  - `99.9%` availability for AKS Clusters that don't use Azure Availability Zones.",
            "guid": "4bfaa73e-a949-404a-a93b-a2b0a7feeff5",
            "service": "AKS",
            "text": "Cluster and workload architectures: Use the AKS Uptime SLA for production grade clusters.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "By spreading node pools across multiple zones, nodes in one node pool will continue running even if another zone has gone down. If colocality requirements exist, either a regular VMSS-based AKS deployment into a single zone or proximity placement groups can be used to minimize internode latency.",
            "guid": "74ff8612-55b7-4029-81bc-da363b133f16",
            "service": "AKS",
            "text": "Cluster architecture: Use availability zones to maximize resilience within an Azure region by distributing AKS agent nodes across physically separate data centers.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Internet facing workloads should leverage Azure Front Door or Azure Traffic Manager to route traffic globally across AKS clusters.",
            "guid": "844d923f-cfe0-4a3a-97ff-67c072c4220c",
            "service": "AKS",
            "text": "Cluster architecture: Adopt a multiregion strategy by deploying AKS clusters deployed across different Azure regions to maximize availability and provide business continuity.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Container CPU and memory resource limits are necessary to prevent resource exhaustion in your Kubernetes cluster.",
            "guid": "f1a92d3f-eab5-4dc2-b0e8-75865842f205",
            "service": "AKS",
            "text": "Cluster and workload architectures: Define Pod resource requests and limits in application deployment manifests, and enforce with Azure Policy.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "System node pools require a VM SKU of at least 2 vCPUs and 4 GB memory, but 4 vCPU or more is recommended. Reference System and user node pools for detailed requirements.",
            "guid": "55429203-5f2a-4ed1-9107-22d2c47b8ef1",
            "service": "AKS",
            "text": "Cluster and workload architectures: Keep the System node pool isolated from application workloads.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Applications may share the same configuration and need GPU-enabled VMs, CPU or memory optimized VMs, or the ability to scale-to-zero. Avoid large number of node pools to reduce extra management overhead.",
            "guid": "3603ec74-ada6-4050-baa3-fb25386fb7df",
            "service": "AKS",
            "text": "Cluster and workload architectures: Separate applications to dedicated node pools based on specific requirements.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "To avoid reliability issues with Azure Load Balancer limitations with high concurrent outbound traffic, us a NAT Gateway instead to support reliable egress traffic at scale.",
            "guid": "d441f009-ca99-4caf-9544-c71de5949d10",
            "service": "AKS",
            "text": "Cluster architecture: Use a NAT gateway for clusters that run workloads that make many concurrent outbound connections.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "ff274266-a326-4c2c-9b85-7ce50c679b36",
            "service": "AKS",
            "text": "Cluster architecture: Use Managed Identities to avoid managing and rotating service principles.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "d44b3684-99d7-4946-ab75-fb58d9d8626e",
            "service": "AKS",
            "text": "Cluster architecture: Use Kubernetes role-based access control (RBAC) with Microsoft Entra ID for least privilege access and minimize granting administrator privileges to protect configuration, and secrets access.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "12e0cc02-b585-4d6f-97be-1b073e57522c",
            "service": "AKS",
            "text": "Cluster architecture: Use Microsoft Defender for containers with Azure Sentinel to detect and quickly respond to threats across your cluster and workloads running on them.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "8e9c196f-b93a-46c5-9507-1e5cad83dd21",
            "service": "AKS",
            "text": "Cluster architecture: Deploy a private AKS cluster to ensure cluster management traffic to your API server remains on your private network. Or use the API server allow list for non-private clusters.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "4658f193-0b5d-41c9-b2c9-0a5f500799ea",
            "service": "AKS",
            "text": "Workload architecture: Use a Web Application Firewall to secure HTTP(S) traffic.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "feba8909-0760-4a87-833a-b36fabbe722e",
            "service": "AKS",
            "text": "Workload architecture: Ensure your CI/CID pipeline is hardened with container-aware scanning.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "Using Microsoft Entra ID centralizes the identity management component. Any change in user account or group status is automatically updated in access to the AKS cluster. The developers and application owners of your Kubernetes cluster need access to different resources.",
            "guid": "463da713-377d-46e1-a9cf-a384a0657537",
            "service": "AKS",
            "text": "Cluster architecture: Use Microsoft Entra integration.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "AKS and Microsoft Entra ID enables authentication with Azure Container Registry without the use of `imagePullSecrets` secrets. Review Authenticate with Azure Container Registry from Azure Kubernetes Service for more information.",
            "guid": "f9f7946f-b9b6-40d1-9f30-0bfb38be5c74",
            "service": "AKS",
            "text": "Cluster architecture: Authenticate with Microsoft Entra ID to Azure Container Registry.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "By default, network traffic between your node pools and the API server travels the Microsoft backbone network; by using a private cluster, you can ensure network traffic to your API server remains on the private network only.",
            "guid": "10d61300-19e4-403c-bf22-a554c56b4afc",
            "service": "AKS",
            "text": "Cluster architecture: Secure network traffic to your API server with private AKS cluster.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "When using public clusters, you can still limit the traffic that can reach your clusters API server by using the authorized IP range feature. Include sources like the public IPs of your deployment build agents, operations management, and node pools' egress point (such as Azure Firewall).",
            "guid": "b845e9a6-c5f3-4cf7-a956-6f1ffde88569",
            "service": "AKS",
            "text": "Cluster architecture: For non-private AKS clusters, use API server authorized IP ranges.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Securing access to the Kubernetes API Server is one of the most important things you can do to secure your cluster. Integrate Kubernetes role-based access control (RBAC) with Microsoft Entra ID to control access to the API server. Disable local accounts to enforce all cluster access using Microsoft Entra ID-based identities.",
            "guid": "0b3a4624-de6e-4cfe-af5b-19ad4708087d",
            "service": "AKS",
            "text": "Cluster architecture: Protect the API server with Microsoft Entra RBAC.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Secure and control network traffic between pods in a cluster.",
            "guid": "caabd1f2-e6a9-4c55-9115-349d1d6716bb",
            "service": "AKS",
            "text": "Cluster architecture: Use Azure network policies or Calico.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Azure Policy can help to apply at-scale enforcement and safeguards on your clusters in a centralized, consistent manner. It can also control what functions pods are granted and if anything is running against company policy.",
            "guid": "d65686d0-3988-49b5-8a98-59818ba81c50",
            "service": "AKS",
            "text": "Cluster architecture: Secure clusters and pods with Azure Policy.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Limit access to actions that containers can perform. Provide the least number of permissions, and avoid the use of root or privileged escalation.",
            "guid": "f1e41c15-87e4-4135-ab6c-fb6803194f12",
            "service": "AKS",
            "text": "Cluster architecture: Secure container access to resources.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "To scan incoming traffic for potential attacks, use a web application firewall such as Azure Web Application Firewall (WAF) on Azure Application Gateway or Azure Front Door.",
            "guid": "4658f193-0b5d-41c9-b2c9-0a5f500799ea",
            "service": "AKS",
            "text": "Workload architecture: Use a Web Application Firewall to secure HTTP(S) traffic.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Ensure your cluster's outbound traffic is passing through a network security point such as Azure Firewall or an HTTP proxy.",
            "guid": "fa580200-65eb-4cc8-9c23-a5e68f1d86a7",
            "service": "AKS",
            "text": "Cluster architecture: Control cluster egress traffic.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Protect and rotate secrets, certificates, and connection strings in Azure Key Vault with strong encryption. Provides an access audit log, and keeps core secrets out of the deployment pipeline.",
            "guid": "0f5b5089-02fc-4f46-839c-7ff86610366a",
            "service": "AKS",
            "text": "Cluster architecture: Use the open-source Microsoft Entra Workload ID and Secrets Store CSI Driver with Azure Key Vault.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Monitor and maintain the security of your clusters, containers, and their applications.",
            "guid": "d2895e72-e9c1-4af7-9e5a-53edc92423e7",
            "service": "AKS",
            "text": "Cluster architecture: Use Microsoft Defender for Containers.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "c5148caa-6478-4ba8-993b-1a8640716d66",
            "service": "AKS",
            "text": "Cluster architecture: Use appropriate VM SKU per node pool and reserved instances where long-term capacity is expected.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "90ac2d0c-790e-4b2b-be35-60a55a19397a",
            "service": "AKS",
            "text": "Cluster and workload architectures: Use appropriate managed disk tier and size.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "df9bb42d-c34f-488f-a50c-0624ca247647",
            "service": "AKS",
            "text": "Cluster architecture: Review performance metrics, starting with CPU, memory, storage, and network, to identify cost optimization opportunities by cluster, nodes, and namespace.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "43ffe0b7-7bc4-42b0-a370-af4a943b19c0",
            "service": "AKS",
            "text": "Cluster and workload architecture: Use autoscalers to scale in when workloads are less active.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "Matching your selection to your workload demands ensures you don't pay for unneeded resources.",
            "guid": "c4ce3529-2891-41f1-aa3f-e87a791b01a3",
            "service": "AKS",
            "text": "Cluster and workload architectures: Align SKU selection and managed disk size with workload requirements.",
            "type": "recommendation",
            "waf": "Cost"
        },
        {
            "description": "Selecting the right virtual machine instance type is critical as it directly impacts the cost of running applications on AKS. Choosing a high-performance instance without proper utilization can lead to wasteful spending, while choosing a less powerful instance can lead to performance issues and increased downtime. To determine the right virtual machine instance type, consider workload characteristics, resource requirements, and availability needs.",
            "guid": "1088060f-7467-48db-950d-5890503e2974",
            "service": "AKS",
            "text": "Cluster architecture: Select the right virtual machine instance type.",
            "type": "recommendation",
            "waf": "Cost"
        },
        {
            "description": "AKS supports creating ARM64 Ubuntu agent nodes, as well as a of mix Intel and ARM architecture nodes within a cluster that can bring better performance at a lower cost.",
            "guid": "ce50c713-ad3e-4781-9193-63485491aa48",
            "service": "AKS",
            "text": "Cluster architecture: Select virtual machines based on the Arm architecture.",
            "type": "recommendation",
            "waf": "Cost"
        },
        {
            "description": "Spot VMs allow you to take advantage of unutilized Azure capacity with significant discounts (up to 90% as compared to pay-as-you-go prices). If Azure needs capacity back, the Azure infrastructure evicts the Spot nodes.",
            "guid": "7a281f48-217a-4668-aa30-c9d2c84d0d72",
            "service": "AKS",
            "text": "Cluster architecture: Select Azure Spot Virtual Machines.",
            "type": "recommendation",
            "waf": "Cost"
        },
        {
            "description": "Due to many factors, cost of resources varies per region in Azure. Evaluate the cost, latency, and compliance requirements to ensure you are running your workload cost-effectively and it doesn't affect your end-users or create extra networking charges.",
            "guid": "433efe5b-3776-459c-8560-058f87773838",
            "service": "AKS",
            "text": "Cluster architecture: Select the appropriate region.",
            "type": "recommendation",
            "waf": "Cost"
        },
        {
            "description": "Streamlining your images helps reduce costs since new nodes need to download these images. Build images in a way that allows the container start as soon as possible to help avoid user request failures or timeouts while the application is starting up, potentially leading to overprovisioning.",
            "guid": "65d3f70e-457a-4d62-8140-de2b0c4f7f99",
            "service": "AKS",
            "text": "Workload architecture: Maintain small and optimized images.",
            "type": "recommendation",
            "waf": "Cost"
        },
        {
            "description": "Automatically scaling down the number of nodes in your AKS cluster lets you run an efficient cluster when demand is low and scale up when demand returns.",
            "guid": "b4d583e3-7268-41d9-9e93-0394bed77298",
            "service": "AKS",
            "text": "Cluster architecture: Enable Cluster Autoscaler to automatically reduce the number of agent nodes in response to excess resource capacity.",
            "type": "recommendation",
            "waf": "Cost"
        },
        {
            "description": "Node Autoprovision simplifies the SKU selection process and decides, based on pending pod resource requirements, the optimal VM configuration to run workloads in the most efficient and cost effective manner.",
            "guid": "48ae7de4-26f7-457c-b1a4-a18467b7401d",
            "service": "AKS",
            "text": "Cluster architecture: Enable Node Autoprovision to automate VM SKU selection.",
            "type": "recommendation",
            "waf": "Cost"
        },
        {
            "description": "Adjust the number of pods in a deployment depending on CPU utilization or other select metrics, which support cluster scale-in operations.",
            "guid": "d3194174-d037-4a35-9cd5-244d377cfabb",
            "service": "AKS",
            "text": "Workload architecture: Use the Horizontal Pod Autoscaler.",
            "type": "recommendation",
            "waf": "Cost"
        },
        {
            "description": "Rightsize your pods and dynamically set requests and limits based on historic usage.",
            "guid": "091dc052-7bf8-4dd1-aca1-d514ddcb2aa8",
            "service": "AKS",
            "text": "Workload architecture: Use Vertical Pod Autoscaler (preview).",
            "type": "recommendation",
            "waf": "Cost"
        },
        {
            "description": "Scale based on the number of events being processed. Choose from a rich catalogue of 50+ KEDA scalers.",
            "guid": "fe3d7c5f-f5a9-4b5e-a4f9-81bf76930967",
            "service": "AKS",
            "text": "Workload architecture: Use Kubernetes Event Driven Autoscaling (KEDA).",
            "type": "recommendation",
            "waf": "Cost"
        },
        {
            "description": "The foundation of enabling cost optimization is the spread of a cost saving cluster. A financial operations approach (FinOps) is often used to help organizations reduce cloud costs. It is a practice involving collaboration between finance, operations, and engineering teams to drive alignment on cost saving goals and bring transparency to cloud costs.",
            "guid": "3a7d1aa1-37a0-40aa-acbf-ff1852c15c93",
            "service": "AKS",
            "text": "Cluster and workload architectures: Adopt a cloud financial discipline and cultural practice to drive ownership of cloud usage.",
            "type": "recommendation",
            "waf": "Cost"
        },
        {
            "description": "If you properly planned for capacity, your workload is predictable and exists for an extended period of time, sign up for an Azure Reservation or a savings plan to further reduce your resource costs.",
            "guid": "ed669535-43d7-4988-9ec5-3b70762e54eb",
            "service": "AKS",
            "text": "Cluster architecture: Sign up for Azure Reservations or Azure Savings Plan.",
            "type": "recommendation",
            "waf": "Cost"
        },
        {
            "description": "The cost analysis cluster extension enables you to obtain granular insight into costs associated with various Kubernetes resources in your clusters or namespaces.",
            "guid": "6588bddb-d7b6-41a6-8b87-628a758df2fe",
            "service": "AKS",
            "text": "Cluster architecture: Configure the AKS Cost Analysis add-on.",
            "type": "recommendation",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "38e28f4f-7465-4e3a-bf05-4d6072d4bae6",
            "service": "AKS",
            "text": "Cluster architecture: Use a template-based deployment using Bicep, Terraform, or others. Make sure that all deployments are repeatable, traceable, and stored in a source code repo.",
            "type": "checklist",
            "waf": "Operations"
        },
        {
            "description": "",
            "guid": "1255b75f-0f3b-4fd7-96c5-17e4e30bbe11",
            "service": "AKS",
            "text": "Cluster architecture: Build an automated process to ensure your clusters are bootstrapped with the necessary cluster-wide configurations and deployments. This is often performed using GitOps.",
            "type": "checklist",
            "waf": "Operations"
        },
        {
            "description": "",
            "guid": "07b2d10f-e373-484e-9ece-f182a1b714b2",
            "service": "AKS",
            "text": "Workload architecture: Use a repeatable and automated deployment processes for your workload within your software development lifecycle.",
            "type": "checklist",
            "waf": "Operations"
        },
        {
            "description": "",
            "guid": "6ec1af22-6132-43a6-9286-20333ee6e244",
            "service": "AKS",
            "text": "Cluster architecture: Enable diagnostics settings to ensure control plane or core API server interactions are logged.",
            "type": "checklist",
            "waf": "Operations"
        },
        {
            "description": "",
            "guid": "98844a97-9372-4cd2-ad68-aae36a43de4c",
            "service": "AKS",
            "text": "Cluster and workload architectures: Review the Best practices for monitoring Kubernetes with Azure Monitor to determine the best monitoring strategy for your workloads.",
            "type": "checklist",
            "waf": "Operations"
        },
        {
            "description": "",
            "guid": "20301c55-a815-4a3a-83ec-fe6d1789e697",
            "service": "AKS",
            "text": "Workload architecture: The workload should be designed to emit telemetry that can be collected, which should also include liveliness and readiness statuses.",
            "type": "checklist",
            "waf": "Operations"
        },
        {
            "description": "",
            "guid": "13d37985-5266-4064-97f0-7c7aa7491941",
            "service": "AKS",
            "text": "Cluster and workload architectures: Use chaos engineering practices that target Kubernetes to identify application or platform reliability issues.",
            "type": "checklist",
            "waf": "Operations"
        },
        {
            "description": "",
            "guid": "d96fea7e-598f-4f59-95c6-d75fc8db1c7a",
            "service": "AKS",
            "text": "Workload architecture: Optimize your workload to operate and deploy efficiently in a container.",
            "type": "checklist",
            "waf": "Operations"
        },
        {
            "description": "",
            "guid": "8e8fbde0-f037-4eec-bac2-634ab73d7b0a",
            "service": "AKS",
            "text": "Cluster and workload architectures: Enforce cluster and workload governance using Azure Policy.",
            "type": "checklist",
            "waf": "Operations"
        },
        {
            "description": "To build and run applications successfully in AKS, there are key considerations to understand and implement. These areas include multi-tenancy and scheduler features, cluster, and pod security, or business continuity and disaster recovery.",
            "guid": "95ee25c6-37fc-47c0-a3e1-eea5c1324edb",
            "service": "AKS",
            "text": "Cluster and workload architectures: Review AKS best practices documentation.",
            "type": "recommendation",
            "waf": "Operations"
        },
        {
            "description": "Azure Chaos Studio can help simulate faults and trigger disaster recovery situations.",
            "guid": "2695b4b9-e125-4644-a27c-977eefdbce73",
            "service": "AKS",
            "text": "Cluster and workload architectures: Review Azure Chaos Studio.",
            "type": "recommendation",
            "waf": "Operations"
        },
        {
            "description": "Internet facing workloads should leverage Azure Front Door or Azure Traffic Manager to route traffic globally across AKS clusters.",
            "guid": "844d923f-cfe0-4a3a-97ff-67c072c4220c",
            "service": "AKS",
            "text": "Cluster architecture: Adopt a multiregion strategy by deploying AKS clusters deployed across different Azure regions to maximize availability and provide business continuity.",
            "type": "recommendation",
            "waf": "Operations"
        },
        {
            "description": "Azure Policy can help to apply at-scale enforcement and safeguards on your clusters in a centralized, consistent manner. It can also control what functions pods are granted and if anything is running against company policy.",
            "guid": "02f47a84-6d0c-4243-a5ab-743c85dcce67",
            "service": "AKS",
            "text": "Cluster architecture: Operationalize clusters and pods configuration standards with Azure Policy.",
            "type": "recommendation",
            "waf": "Operations"
        },
        {
            "description": "Kubernetes and ingress controllers support many advanced deployment patterns for inclusion in your release engineering process. Consider patterns like blue-green deployments or canary releases.",
            "guid": "ecbf4266-e97a-4b02-8d02-ca2fd42cea5b",
            "service": "AKS",
            "text": "Workload architecture: Use platform capabilities in your release engineering process.",
            "type": "recommendation",
            "waf": "Operations"
        },
        {
            "description": "Automate your mission-critical design areas, including deployment and testing.",
            "guid": "4646ab36-8c28-4740-afac-c9819f0f6ac9",
            "service": "AKS",
            "text": "Cluster and workload architectures: For mission-critical workloads, use stamp-level blue/green deployments.",
            "type": "recommendation",
            "waf": "Operations"
        },
        {
            "description": "",
            "guid": "de0e6d8d-65a5-46b0-891b-2ad2aa09de11",
            "service": "AKS",
            "text": "Cluster and workload architectures: Perform and iterate on a detailed capacity plan exercise that includes SKU, autoscale settings, IP addressing, and failover considerations.",
            "type": "checklist",
            "waf": "Performance"
        },
        {
            "description": "",
            "guid": "b78aea0e-3fd2-4dcc-b617-34a26892aa76",
            "service": "AKS",
            "text": "Cluster architecture: Enable cluster autoscaler to automatically adjust the number of agent nodes in response workload demands.",
            "type": "checklist",
            "waf": "Performance"
        },
        {
            "description": "",
            "guid": "9b168db7-a88b-4e2c-b555-bc525c7e48da",
            "service": "AKS",
            "text": "Cluster architecture: Use the Horizontal pod autoscaler to adjust the number of pods in a deployment depending on CPU utilization or other select metrics.",
            "type": "checklist",
            "waf": "Performance"
        },
        {
            "description": "",
            "guid": "deadeedd-dab6-4774-84df-f5223ed6ede1",
            "service": "AKS",
            "text": "Cluster and workload architectures: Perform ongoing load testing activities that exercise both the pod and cluster autoscaler.",
            "type": "checklist",
            "waf": "Performance"
        },
        {
            "description": "",
            "guid": "7b1e9a65-2d5d-4eeb-a349-136895131b06",
            "service": "AKS",
            "text": "Cluster and workload architectures: Separate workloads into different node pools allowing independent scalling.",
            "type": "checklist",
            "waf": "Performance"
        },
        {
            "description": "After formalizing your capacity plan, it should be frequently updated by continuously observing the resource utilization of the cluster.",
            "guid": "7b4e5e8b-6e55-4db7-a330-19990bd1e0d2",
            "service": "AKS",
            "text": "Cluster and workload architectures: Develop a detailed capacity plan and continually review and revise.",
            "type": "recommendation",
            "waf": "Performance"
        },
        {
            "description": "The ability to automatically scale up or down the number of nodes in your AKS cluster lets you run an efficient, cost-effective cluster.",
            "guid": "631272b4-9ca7-4e6f-ae9b-3c55946b3924",
            "service": "AKS",
            "text": "Cluster architecture: Enable cluster autoscaler to automatically adjust the number of agent nodes in response to resource constraints.",
            "type": "recommendation",
            "waf": "Performance"
        },
        {
            "description": "Unlike System node pools that always require running nodes, user node pools allow you to scale up or down.",
            "guid": "85ffe644-7c4b-4f2d-b2fa-ed8e7c8d2e84",
            "service": "AKS",
            "text": "Cluster and workload architectures: Separate workloads into different node pools and consider scaling user node pools.",
            "type": "recommendation",
            "waf": "Performance"
        },
        {
            "description": "Helps control balancing of resources for workloads that require them.",
            "guid": "bb7f1396-6a84-4e6d-b6d8-5fc48b4c2b5f",
            "service": "AKS",
            "text": "Workload architecture: Use AKS advanced scheduler features.",
            "type": "recommendation",
            "waf": "Performance"
        },
        {
            "description": "Not all scale decisions can be derived from CPU or memory metrics. Often scale considerations will come from more complex or even external data points. Use KEDA to build a meaningful auto scale ruleset based on signals that are specific to your workload.",
            "guid": "bc908693-9e21-478c-9fde-e92ba949c89e",
            "service": "AKS",
            "text": "Workload architecture: Use meaningful workload scaling metrics.",
            "type": "recommendation",
            "waf": "Performance"
        },
        {
            "description": "",
            "guid": "f4804af8-4f42-450d-916c-5593c145ccf9",
            "service": "Machine Learning",
            "text": "Resiliency: Deploy models to environments that support availability zones, such as AKS. By ensuring deployments are distributed across availability zones, you're ensuring a deployment is available even in the event of a datacenter failure. For enhanced reliability and availability, consider a multi-region deployment topology.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "995d097a-0de2-4431-947f-561b49a60f21",
            "service": "Machine Learning",
            "text": "Resiliency: Ensure you have sufficient compute for both training and inferencing. Through resource planning, make sure your compute SKU and scale settings meet the requirements of your workload.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "d494b7f5-ad32-471f-9fc7-18945ca454ab",
            "service": "Machine Learning",
            "text": "Resiliency: Segregate Machine Learning workspaces used for exploratory work from those used for production.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "6f1dd2cc-e0af-4203-ab0b-b7c65b7b18ae",
            "service": "Machine Learning",
            "text": "Resiliency: When using managed online endpoints for inferencing, use a release strategy such as blue-green deployments to minimize downtime and reduce the risk associated with deploying new versions.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "558fcdcf-33e7-4385-82fd-424bc8ae64bc",
            "service": "Machine Learning",
            "text": "Business requirements: Select your use of compute clusters, compute instances, and externalized inference hosts based on reliability needs, considering service-level agreements (SLAs) as a factor.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "de5be058-1d22-4f38-96aa-3fbca5071a8f",
            "service": "Machine Learning",
            "text": "Recovery: Ensure you have self-healing capabilities, such as checkpointing features supported by Machine Learning, when training large models.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "20104165-9764-4920-98dd-63fddc5f58d3",
            "service": "Machine Learning",
            "text": "Recovery: Ensure you have a recovery strategy defined. Machine Learning doesn't have automatic failover. Therefore, you must design a strategy that encompasses the workspace and all its dependencies, such as Key Vault, Azure Storage, and Azure Container Registry.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "A multi-region deployment ensures that your Machine Learning workloads continue to run even if one region experiences an outage. Multi-region deployment improves load distribution across regions, potentially enhancing performance for users located in different geographical areas. For more information, see Failover for business continuity and disaster recovery.",
            "guid": "046ff188-7d68-492f-850c-c65ee0c9a962",
            "service": "Machine Learning",
            "text": "Multi-region model deployment: For enhanced reliability and availability, consider a multi-region deployment environment when possible.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Model checkpointing periodically saves the state of your machine learning model during training, so that it can be restored in case of interruption, failure, or termination. For more information, see Boost checkpoint speed and reduce cost with Nebula.",
            "guid": "8eaf992c-ccd9-495f-b625-d4f544d38d38",
            "service": "Machine Learning",
            "text": "Model training resiliency: Use checkpointing features supported by Machine Learning including Azure Container for PyTorch, the TensorFlow Estimator class, or the Run object and the FileDataset class that support model checkpointing.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Low-priority virtual machines come at a reduced price but are preemptible. Clusters that use the Dedicated virtual machine tier aren't preempted.",
            "guid": "19720202-b456-44c4-8ff1-28eaa20e1a7d",
            "service": "Machine Learning",
            "text": "Use the Dedicated virtual machine tier for compute clusters: Use the Dedicated virtual machine tier for compute clusters for batch inferencing to ensure your batch job isn't preempted.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "303116b4-65cb-43e5-8ceb-7bebaf16b568",
            "service": "Machine Learning",
            "text": "Availability: Reduce the attack surface of the Machine Learning workspace by restricting access to the workspace to resources within the virtual network.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "eb9cc8b2-c9a3-4fe7-9578-8918ab53eae6",
            "service": "Machine Learning",
            "text": "Confidentiality: Guard against data exfiltration from the Machine Learning workspace by implementing network isolation. Ensure access to all external resources is explicitly approved and access to all other external resources isn't permitted.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "1cb53633-f0c7-45f4-a98b-76b0314a94ba",
            "service": "Machine Learning",
            "text": "Integrity: Implement access controls that authenticate and authorize the Machine Learning workspace for external resources based on the least privilege principle.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "30341513-1f91-480e-bc19-8031f1851087",
            "service": "Machine Learning",
            "text": "Integrity: Implement use case segregation for Machine Learning workspaces by setting up workspaces based on specific use cases or projects. This approach adheres to the principle of least privilege by ensuring that workspaces are only accessible to individuals that require access to data and experimentation assets for the use case or project.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "1274dc7a-a81c-409d-8cd6-e3bda0ee8687",
            "service": "Machine Learning",
            "text": "Integrity: Regulate access to foundational models. Ensure only approved registries have access to models in the model registry.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "ca17ad83-954c-4eba-a30f-9e7c3c2079f6",
            "service": "Machine Learning",
            "text": "Integrity: Regulate access to approved container registries. Ensure Machine Learning compute can only access approved registries.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "1ffe0cf7-a26a-4018-bef8-4d7fdf3291e2",
            "service": "Machine Learning",
            "text": "Integrity: Regulate the Python packages that can be run on Machine Learning compute. Regulating the Python packages ensures only trusted packages are run.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "8d9aea78-3ebe-4ec6-968d-3daa07abc239",
            "service": "Machine Learning",
            "text": "Integrity: Require code used for training in Machine Learning compute environments to be signed. Requiring code signing ensures that the code running is from a trusted source and hasn't been tampered with.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "a6664b76-0292-4bd4-841e-859b65a569c0",
            "service": "Machine Learning",
            "text": "Confidentiality: Adhere to the principle of least privilege for role-based access control (RBAC) to the Machine Learning workspace and related resources, such as the workspace storage account, to ensure individuals have only the necessary permissions for their role, thereby minimizing potential security risks.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "2a509fe2-ce1d-410c-a5cb-780eb8dfaf15",
            "service": "Machine Learning",
            "text": "Integrity: Establish trust and verified access by implementing encryption for data at rest and data in transit.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "The security baseline provides tailored guidance on crucial security aspects such as network security, identity management, data protection, and privileged access. For optimal security, use Microsoft Defender for Cloud to monitor these aspects.",
            "guid": "0e30e670-0c69-4c8a-82f5-b88494e56879",
            "service": "Machine Learning",
            "text": "Security baseline: To enhance the security and compliance of your Machine Learning Service, apply the Azure security baseline for Machine Learning.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Managed virtual network isolation enhances security by isolating your workspace from other networks, reducing the risk of unauthorized access. In a scenario in which a breach occurs in another network within your organization, the isolated network of your Machine Learning workspace remains unaffected, protecting your machine learning workloads.",
            "guid": "aeb66f5c-45bc-45d8-a7bf-a6bd5c6e5f9a",
            "service": "Machine Learning",
            "text": "Managed virtual network isolation: Configure managed virtual network isolation for Machine Learning. When you enable managed virtual network isolation, a managed virtual network is created for the workspace. Managed compute resources you create for the workspace automatically use this managed virtual network. If you can't implement managed virtual network isolation, then you must follow the network topology recommendations to separate compute into a dedicated subnet away from the rest of the resources in the solution, including the private endpoints for workspace resources.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Machine Learning network isolation enhances security by ensuring that access to your workspace is secure and controlled. With a private endpoint configured for your workspace, you can then limit access to your workspace to only occur over the private IP addresses.",
            "guid": "af44fe21-713a-435f-97bd-34ec8221f729",
            "service": "Machine Learning",
            "text": "Machine Learning network isolation: Configure a private endpoint for your Machine Learning workspace and connect to the workspace over that private endpoint.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "This configuration minimizes the risk of data exfiltration, improving data security. With this configuration enabled, a malicious actor who gains access to your system can’t send your data to an unapproved external destination.",
            "guid": "d1cdc5a5-eb9a-43d7-ad74-6169482b28d0",
            "service": "Machine Learning",
            "text": "Allow only approved outbound access: Configure the outbound mode on the Machine Learning workspace managed outbound access to `Allow only approved outbound` to minimize the risk of data exfiltration. Configure private endpoints, service tags, or fully qualified domain names (FQDNs) for resources that you need to access.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Network isolation bolsters security by restricting access to Azure platform as a service (PaaS) solutions to private IP addresses only.",
            "guid": "0d8346f9-f2fe-4a4e-b153-662c5c6e4510",
            "service": "Machine Learning",
            "text": "Virtual network isolation for dependent services: Configure dependent services, such as Storage, Key Vault, and Container Registry with private endpoints and disable public access.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Managed identities improve security by eliminating the need to store credentials and manually manage and rotate service principals.",
            "guid": "bf2a8ddf-263e-46fb-b73a-ca8b9ba168e7",
            "service": "Machine Learning",
            "text": "Managed identity: Use managed identities for authentication between Machine Learning and other services.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Disabling local authentication increases the security of your Machine Learning compute and provides centralized control and management of identities and resource credentials.",
            "guid": "70477454-0ddb-4ad6-9342-1ad6290bbb06",
            "service": "Machine Learning",
            "text": "Disable local authentication: Disable local authentication for Machine Learning compute clusters and instances.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Disabling SSH access helps prevent unauthorized individuals from gaining access and potentially causing harm to your system and protects you against brute force attacks.",
            "guid": "cbd359bc-8057-4a9c-9183-c4fc1e70a69b",
            "service": "Machine Learning",
            "text": "Disable the public SSH port: Ensure the public Secure Shell (SSH) port is closed on the Machine Learning compute cluster by setting `remoteLoginPortPublicAccess` to `Disabled`. Apply a similar configuration if you use a different compute.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Refrain from provisioning public IP addresses to enhance security by limiting the potential for unauthorized access to your compute instance or clusters.",
            "guid": "cc532133-2bba-484f-b316-035b93b3ee6a",
            "service": "Machine Learning",
            "text": "Don't provision public IP addresses for Machine Learning compute: Set enableNodePublicIp to `false` when provisioning Machine Learning compute clusters or compute instances. Apply a similar configuration if you use a different compute.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Using the latest images ensures you're maintaining a consistent, stable, and secure environment, including ensuring you have the latest security patches.",
            "guid": "cb49b636-1011-43a0-a12b-25378f677153",
            "service": "Machine Learning",
            "text": "Get the latest operating system image: Recreate compute instances to get the latest operating system image.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Strict workspace access controls enhance security by ensuring that individuals have only the necessary permissions for their role. A data scientist, for instance, might have access to run experiments but not to modify security settings, minimizing potential security risks.",
            "guid": "17cac647-8c6f-4a6f-a66d-c436e17c91c8",
            "service": "Machine Learning",
            "text": "Strict Machine Learning workspace access controls: Use Microsoft Entra ID groups to manage workspace access and adhere to the principle of least privilege for RBAC.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Restricting the deployments from the model catalog to specific registries ensures you only deploy models to approved registries. This approach helps regulate access to the open-source foundational models.",
            "guid": "18a61ee3-34d2-484a-a740-3c90d23c64b9",
            "service": "Machine Learning",
            "text": "Restrict model catalog deployments: Restrict model deployments to specific registries.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Encrypting data at rest enhances data security by ensuring that sensitive data is encrypted by using keys directly managed by you. If you have a regulatory requirement to manage your own encryption keys, use this feature to comply with that requirement.",
            "guid": "5e14c11e-83fb-40f1-a8dc-d96767d73a13",
            "service": "Machine Learning",
            "text": "Encrypt data at rest: Consider using customer-managed keys with Machine Learning.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Minimize the risk of data exfiltration by limiting inbound and outbound requirements.",
            "guid": "6782cd14-a63d-466c-a7c9-8a92afe3b396",
            "service": "Machine Learning",
            "text": "Minimize the risk of data exfiltration: Implement data exfiltration prevention. For example, create a service endpoint policy to filter egress virtual network traffic and permit data exfiltration only to specific Azure Storage accounts.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "cac38d1e-d21e-4af5-834d-d607469c6439",
            "service": "Machine Learning",
            "text": "Usage optimization: Choose the appropriate resources to ensure that they align with your workload requirements. For example, choose between CPUs or GPUs, various SKUs, or low versus regular-priority VMs.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "8e98fc4b-2fa4-44b9-9aa7-1c01f67aecb7",
            "service": "Machine Learning",
            "text": "Usage optimization: Ensure compute resources that aren't being used are scaled down or shut down when idle to reduce waste.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "dfafcc35-c8fb-429b-92c0-53f045884794",
            "service": "Machine Learning",
            "text": "Usage optimization: Apply policies and configure quotas to comply with the design's upper and lower limits.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "14149f48-97d8-4614-9236-681f5fd42b34",
            "service": "Machine Learning",
            "text": "Usage optimization: Test parallelizing training workloads to determine if training requirements can be met on lower cost SKUs.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "945e262b-3a0f-4ac9-ac51-69b5500f9ee6",
            "service": "Machine Learning",
            "text": "Rate optimization: Purchase Azure Reserved Virtual Machine Instances if you have a good estimate of usage over the next one to three years.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "563a3c8d-4168-4f18-a056-efb624734ecf",
            "service": "Machine Learning",
            "text": "Monitor and optimize: Monitor your resource usage such as CPU and GPU usage when training models. If the resources aren't being fully used, modify your code to better use resources or scale down to smaller or cheaper VM sizes.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "Selecting the right compute is critical as it directly impacts the cost of running your workload. Choosing a GPU or a high-performance SKU without proper usage can lead to wasteful spending, while choosing undersized compute can lead to prohibitively long training times and performance problems.",
            "guid": "3d87f935-99a6-4aee-aac2-069994de09ff",
            "service": "Machine Learning",
            "text": "Optimize compute resources: Optimize your compute resources based on the requirements of your workload. Choose the SKU that best suits your workload:<ul><li>General Purpose – Balanced CPU to memory ratio, good for all purposes.</li><li>Compute Optimized – High CPU to memory ratio, good for math-heavy computations.</li><li>Memory Optimized – High memory to CPU, good for in-memory computations or database applications.</li><li>M Series – Very large machines that have huge amounts of memory and CPU. </li><li> GPU – Better for models with a high number of variables that can benefit from higher parallelism and specialized core instructions. Typical applications are deep learning, image or video processing, scientific simulations, data mining, and taking advantage of GPU development frameworks. Test with multiple families and document the results as your baseline. As your model and data evolve, the most adequate compute resource might change. Monitor execution times and reevaluate as needed.",
            "type": "recommendation",
            "waf": "Cost"
        },
        {
            "description": "Configure autoscaling for compute clusters to scale down when their usage is low.  Set the minimum number of nodes to 0 for training clusters to scale down to 0 when not in use.",
            "guid": "d30cfeeb-6c61-4a9d-9a56-c8296cec72cb",
            "service": "Machine Learning",
            "text": "Optimize compute scaling: Configure your compute clusters for autoscaling to ensure you only use what you need.For training clusters, set the minimum number of nodes to 0 and configure the amount of time the node is idle to an appropriate time. For less iterative experimentation, reduce the time to save costs. For more iterative experimentation, use a higher time to prevent paying for scaling up or down after each change.",
            "type": "recommendation",
            "waf": "Cost"
        },
        {
            "description": "Setting termination policies can help you save costs by stopping nonperforming runs early.",
            "guid": "098a7bee-444c-4351-aeb1-8bd97036299c",
            "service": "Machine Learning",
            "text": "Set training termination policies: Set early termination policies to limit the duration of training runs or terminate them early.",
            "type": "recommendation",
            "waf": "Cost"
        },
        {
            "description": "Low-priority virtual machines enable a large amount of compute power to be used for a low cost. They take advantage of surplus capacity in Azure.",
            "guid": "41f2dd91-5765-4dfb-9db0-9b3e976b4afb",
            "service": "Machine Learning",
            "text": "Use low-priority virtual machines for batch workloads: Consider using low-priority virtual machines for batch workloads that aren't time-sensitive and in which interruptions are recoverable.",
            "type": "recommendation",
            "waf": "Cost"
        },
        {
            "description": "By default, compute instances are available to you, accruing cost. Configuring compute instances to shut down when idle or configuring a schedule for them saves cost when they aren't in use.",
            "guid": "e3150ddd-f553-425f-bb91-249a9598e25e",
            "service": "Machine Learning",
            "text": "Enable idle shutdown for compute instances: Enable idle shutdown for compute instances or schedule a start and stop time if usage time is known.",
            "type": "recommendation",
            "waf": "Cost"
        },
        {
            "description": "Parallel workloads can be run on multiple smaller instances, potentially yielding cost savings.",
            "guid": "8b47ec85-0e9e-428b-9290-c590a7f4ab1a",
            "service": "Machine Learning",
            "text": "Parallelize training workloads: Consider parallelizing training workloads. Test running them with the help of the parallel components in Machine Learning.",
            "type": "recommendation",
            "waf": "Cost"
        },
        {
            "description": "Purchase Azure Reserved VM Instances to prepay for virtual machine usage and provide discounts with pay-as-you-go pricing. The discount is automatically applied for virtual machine usage that matches the reservation.",
            "guid": "b4470844-d54d-4a1c-980c-37d09e17940d",
            "service": "Machine Learning",
            "text": "Azure Reserved VM Instances: Purchase Azure Reserved VM Instances if you have a good estimate of usage over the next one to three years. Take advantage of reserved capacity options for services when you have good estimates of usage.",
            "type": "recommendation",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "4dace40c-2627-4eb1-9d18-4a6c03901283",
            "service": "Machine Learning",
            "text": "Development standards: Take advantage of Machine Learning model catalogs and registries to store, version, and share machine learning assets.",
            "type": "checklist",
            "waf": "Operations"
        },
        {
            "description": "",
            "guid": "2fe1daf9-b388-4d25-8ff8-39908ada7f27",
            "service": "Machine Learning",
            "text": "Automate for efficiency: Follow good machine learning operations (MLOps) practices. When possible, build end-to-end automated pipelines for data preparation, training, and scoring processes. In development, use scripts instead of notebooks for training models, as scripts are easier to integrate into automated pipelines.",
            "type": "checklist",
            "waf": "Operations"
        },
        {
            "description": "",
            "guid": "7b5de736-4956-4313-82be-0a0ff07d7ab6",
            "service": "Machine Learning",
            "text": "Deploy with confidence: Implement infrastructure as code (IaC) for Machine Learning workspaces, compute clusters, compute instances, and other deployment environments.",
            "type": "checklist",
            "waf": "Operations"
        },
        {
            "description": "",
            "guid": "f8196404-8f76-4e65-9b32-46d8d777d1d3",
            "service": "Machine Learning",
            "text": "Observability: Monitor the performance of your deployed models including data drift.",
            "type": "checklist",
            "waf": "Operations"
        },
        {
            "description": "",
            "guid": "d212d648-752b-480f-bda5-0d45d0185312",
            "service": "Machine Learning",
            "text": "Observability: If your models are deployed to online endpoints, enable Application Insights to monitor online endpoints and deployments. Monitor training infrastructure to ensure you're meeting your baseline requirements.",
            "type": "checklist",
            "waf": "Operations"
        },
        {
            "description": "",
            "guid": "afd5b803-c151-4b8d-ae08-63cc8961a378",
            "service": "Machine Learning",
            "text": "Simplicity: Use curated environments optimized for Machine Learning, when available.",
            "type": "checklist",
            "waf": "Operations"
        },
        {
            "description": "Limiting the number of workspaces reduces the maintenance effort and cost of operation. For requirements, such as security, you might need multiple separate workspaces. Minimize the number of workspaces when possible.",
            "guid": "bb6c4c2f-65f4-4fab-ada7-ebe079bde9cb",
            "service": "Machine Learning",
            "text": "Minimize Machine Learning workspace instances: Minimize the number of workspaces, when possible, to reduce maintenance.",
            "type": "recommendation",
            "waf": "Operations"
        },
        {
            "description": "Use Machine Learning model registries to store and version your machine learning models to track changes and maintain lineage with the job and datasets used for training. With Machine Learning model catalogs, your data science teams can discover, evaluate, and fine tune pretrained foundational machine learning models. Storing versioned models in Machine Learning model registries supports deployment strategies such as A/B releases, canary releases, and rollbacks.",
            "guid": "31841d05-3372-4bd4-b8bc-efcaaee1bd88",
            "service": "Machine Learning",
            "text": "Take advantage of model catalogs and registries: Take advantage of Machine Learning model catalogs and registries to store, version, and share machine learning assets.Use Machine Learning model catalogs to help you implement A/B testing and deployment of models.",
            "type": "recommendation",
            "waf": "Operations"
        },
        {
            "description": "Monitoring deployed models ensures your models meet the performance requirements.Monitoring data drift helps you detect changes in the input data that can lead to a decline in your model’s performance. Managing data drift helps you ensure that your model provides accurate results over time.",
            "guid": "90a72a7e-6fb5-4e02-a159-7a4d907eb098",
            "service": "Machine Learning",
            "text": "Monitor model performance: Monitor the performance of your deployed models, and detect data drift on datasets.",
            "type": "recommendation",
            "waf": "Operations"
        },
        {
            "description": "Monitoring endpoints gives you visibility into metrics such as request latency and requests per minute. You can compare your performance versus your baseline and use this information to make changes to compute resources accordingly. Monitoring metrics such as network bytes can alert you if you're approaching quota limits and prevent throttling.Likewise, monitoring your training environment provides you with the information to make changes to your training environment. Use that information to decide to scale in or out, scale up or down with different performant SKUs, or choose between CPUs or GPUs.",
            "guid": "b1d87076-b253-47ae-8727-97f804e49a3c",
            "service": "Machine Learning",
            "text": "Monitor infrastructure: If your models are deployed to online endpoints, enable Application Insights to monitor online endpoints and deployments.Monitor training infrastructure to ensure you're meeting your baseline requirements.Ensure you're collecting resource logs for Machine Learning.",
            "type": "recommendation",
            "waf": "Operations"
        },
        {
            "description": "Curated environments are pre-created environments provided by Machine Learning that speed up deployment time and reduce deployment and training latency. Using curated environments improves training and deployment success rates and avoids unnecessary image builds. Curated environments, such as Azure Container for PyTorch, can also be optimized for training large models on Machine Learning.",
            "guid": "4c6895ce-abd9-4c90-a386-c31bc0681869",
            "service": "Machine Learning",
            "text": "Curate model training environments: Use curated environments optimized for Machine Learning, when available.",
            "type": "recommendation",
            "waf": "Operations"
        },
        {
            "description": "",
            "guid": "82ffebb1-2e91-46a4-b796-3fa55c4c20e3",
            "service": "Machine Learning",
            "text": "Performance targets: Determine the acceptable training time and retrain frequency for your model. Setting a clear target for training time, along with testing, helps you determine the compute resources, CPU versus GPU, and CPU SKUs required to meet the training time goal.",
            "type": "checklist",
            "waf": "Performance"
        },
        {
            "description": "",
            "guid": "5e526216-1b94-4cfe-86ef-bbce971f7f3a",
            "service": "Machine Learning",
            "text": "Performance targets: Define the acceptable performance targets for your deployed models including response time, requests per second, error rate, and uptime. Performance targets act as a benchmark for your deployed model's efficiency. Targets can help you make CPU versus GPU determinations, CPU SKU choices, and scaling requirements.",
            "type": "checklist",
            "waf": "Performance"
        },
        {
            "description": "",
            "guid": "2d6ddbe2-2bcc-4629-a316-5d56d74ef68a",
            "service": "Machine Learning",
            "text": "Meet capacity requirements: Choose the right compute resources for model training.",
            "type": "checklist",
            "waf": "Performance"
        },
        {
            "description": "",
            "guid": "0ab74767-80ac-454e-aab6-b546e38411f8",
            "service": "Machine Learning",
            "text": "Meet capacity requirements: Choose the right compute resources for model deployments.",
            "type": "checklist",
            "waf": "Performance"
        },
        {
            "description": "",
            "guid": "d47bd862-5302-4ecb-a551-37cb0d15e802",
            "service": "Machine Learning",
            "text": "Meet capacity requirements: Choose deployment environments with autoscaling capabilities to add and remove capacity as demand fluctuates.",
            "type": "checklist",
            "waf": "Performance"
        },
        {
            "description": "",
            "guid": "e10dead3-58c0-40b2-aa9b-39c64a68c555",
            "service": "Machine Learning",
            "text": "Achieve and sustain performance: Continuously monitor the performance of your deployed models, review results, and take appropriate actions.",
            "type": "checklist",
            "waf": "Performance"
        },
        {
            "description": "",
            "guid": "e257de8e-a8ef-4b91-81a3-3d832682b1eb",
            "service": "Machine Learning",
            "text": "Achieve and sustain performance: Continuously monitor the performance of your infrastructure of deployed models, review results, and take appropriate actions. Monitor training infrastructure to ensure you're meeting your requirements for training time.",
            "type": "checklist",
            "waf": "Performance"
        },
        {
            "description": "Selecting the right compute is critical as it directly impacts the training time. Choosing the right SKU and CPU versus GPU ensures your model training can meet your requirements and performance targets. Choosing a low-performance SKU that's overused can lead to prohibitively long training times and performance problems. Compute clusters provide the ability to improve performance by scaling out workloads that support horizontal scaling. This method provides flexibility for handling workloads with different demands and lets you add or remove machines as needed.",
            "guid": "352a223c-dabd-46da-8752-56a87c6f18b7",
            "service": "Machine Learning",
            "text": "Select appropriate compute services for model training: Consider Machine Learning compute clusters over compute instances for model training if you require autoscaling.Optimize your compute resources based on the training requirements. First choose between CPUs and GPUs. Default to CPUs, but consider GPUs for workloads such as deep learning, image or video processing, or large amounts of data. Next, choose the image SKU that best suits your workload.Use testing to choose the compute option that optimizes cost against training time when determining your baseline.",
            "type": "recommendation",
            "waf": "Performance"
        },
        {
            "description": "Autoscaling adjusts the number of instances of the deployed model to match demand.",
            "guid": "683ae603-156f-4186-8a82-aa2907fbb9bd",
            "service": "Machine Learning",
            "text": "Model deployment environment scaling: Use the deployment environment’s autoscale capabilities. For AKS deployment environments, use the cluster autoscaler to scale to meet demand. For online endpoints, automatically scale via integration with the Azure Monitor autoscale feature.",
            "type": "recommendation",
            "waf": "Performance"
        },
        {
            "description": "Tracking the performance of models in production alerts you to potential problems such as data drift, prediction drift, data quality, and feature attribution drift.Monitoring data drift helps you detect changes in the input data that can lead to a decline in your model’s performance. Managing data drift helps you ensure that your model provides accurate results over time.",
            "guid": "eccdaab6-7458-4967-9cd4-da6a89e3ce8c",
            "service": "Machine Learning",
            "text": "Monitor model performance: Monitor the performance of your deployed models.",
            "type": "recommendation",
            "waf": "Performance"
        },
        {
            "description": "Monitoring endpoints gives you visibility into metrics such as request latency and requests per minute. You can compare your performance versus your baseline and use this information to make changes to compute resources accordingly. Monitoring metrics such as network bytes can alert you if you're approaching quota limits and prevent throttling.Likewise, monitoring your training environment provides you with the information to make changes to your training environment. Use that information to decide to scale in or out, scale up or down with different performant SKUs, or choose between CPUs or GPUs.",
            "guid": "76b80c26-8252-416e-aae1-ace03a9403dd",
            "service": "Machine Learning",
            "text": "Monitor infrastructure: Monitor online endpoints and integrate with Monitor to track and monitor the appropriate metrics and logs. Enable Application Insights when creating online deployments.Monitor training infrastructure and review resource usage such as memory and CPU or GPU usage when training models to ensure you're meeting your baseline requirements.",
            "type": "recommendation",
            "waf": "Performance"
        },
        {
            "description": "",
            "guid": "154d9075-f8f8-4dc8-b8f4-651d875d5dfe",
            "service": "OpenAI",
            "text": "Resiliency: Choose the appropriate deployment option of either pay-as-you-go or provisioned throughput based on your use case. Because reserved capacity increases resiliency, choose provisioned throughput for production solutions. The pay-as-you-go approach is ideal for dev/test environments.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "571ddd3c-601e-46a7-bf80-c52f04a301fb",
            "service": "OpenAI",
            "text": "Redundancy: Add the appropriate gateways in front of your Azure OpenAI deployments. The gateway must have the capability to withstand transient failures like throttling and also route to multiple Azure OpenAI instances. Consider routing to instances in different regions to build regional redundancy.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "3861cb87-64b1-4958-b439-5575b8d1fc67",
            "service": "OpenAI",
            "text": "Resiliency: If you're using provisioned throughput, consider also deploying a pay-as-you-go instance to handle overflow. You can route calls to the pay-as-you-go instance via your gateway when your provisioned throughput model is throttled.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "7fd57f22-417b-47d5-88c9-ab7a2ceb5599",
            "service": "OpenAI",
            "text": "Resiliency: Monitor capacity usage to ensure you aren't exceeding throughput limits. Regularly review capacity usage to achieve more accurate forecasting and help prevent service interruptions due to capacity constraints.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "950e6010-4345-43e6-a8e9-d8c95e45f818",
            "service": "OpenAI",
            "text": "Resiliency: Follow the guidance for fine-tuning with large data files and import the data from an Azure blob store. Large files, 100 MB or larger, can become unstable when uploaded through multipart forms because the requests are atomic and can't be retried or resumed.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "088c617d-fce0-4fab-b4cd-9f9eb6a96cff",
            "service": "OpenAI",
            "text": "Recovery: Define a recovery strategy that includes a recovery plan for models that are fine-tuned and for training data uploaded to Azure OpenAI. Because Azure OpenAI doesn't have automatic failover, you must design a strategy that encompasses the entire service and all dependencies, such as storage that contains training data.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "This important throughput information provides information required to ensure that you assign enough TPM from your quota to meet the demand for your deployments.Assigning enough quota prevents throttling of calls to your deployed models.",
            "guid": "f109deb2-54f9-4405-a9f0-f90fd0f76adf",
            "service": "OpenAI",
            "text": "Monitor rate limits for pay-as-you-go: If you're using the pay-as-you-go approach, manage rate limits for your model deployments and monitor usage of tokens per minute (TPM) and requests per minute (RPM).",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "It's important to monitor provision-managed utilization to ensure it doesn't exceed 100%, to prevent throttling of calls to your deployed models.",
            "guid": "ef12f5c3-dbe2-4040-be82-724eebc6f87e",
            "service": "OpenAI",
            "text": "Monitor provision-managed utilization for provisioned throughput: If you're using the provisioned throughput payment model, monitor provision-managed utilization.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Content filters block prompts or completions based on an opaque risk analysis. Ensure content filters are tuned to allow expected usage for your workload.",
            "guid": "efcf5f6a-02bb-4cc8-8018-055ebf2e57e0",
            "service": "OpenAI",
            "text": "Tune content filters: Tune content filters to minimize false positives from overly aggressive filters.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "a61b826b-9f3b-4f51-8e0e-a32a92865386",
            "service": "OpenAI",
            "text": "Protect confidentiality: If you upload training data to Azure OpenAI, use customer-managed keys for data encryption, implement a key-rotation strategy, and delete training, validation, and training results data. If you use an external data store for training data, follow security best practices for that store. For example, for Azure Blob Storage, use customer-managed keys for encryption and implement a key-rotation strategy. Use managed identity-based access, implement a network perimeter by using private endpoints, and enable access logs.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "9f4bdfff-2c6c-4662-9139-1de51d2dbd20",
            "service": "OpenAI",
            "text": "Protect confidentiality: Guard against data exfiltration by limiting the outbound URLs that Azure OpenAI resources can access.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "b8463e8d-daaa-4209-9944-0fb0587219a8",
            "service": "OpenAI",
            "text": "Protect integrity: Implement access controls to authenticate and authorize user access to the system by using the least-privilege principle and by using individual identities instead of keys.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "714249d8-2b60-4920-89a2-eab4a338ac02",
            "service": "OpenAI",
            "text": "Protect integrity: Implement jailbreak risk detection to safeguard your language model deployments against prompt injection attacks.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "e0383d3b-71f1-4fda-9759-24cfd293abff",
            "service": "OpenAI",
            "text": "Protect availability: Use security controls to prevent attacks that might exhaust model usage quotas. You might configure controls to isolate the service on a network. If the service must be accessible from the internet, consider using a gateway to block suspected abuse by using routing or throttling.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "Separating secrets from code by storing them in Key Vault reduces the chance of leaking secrets. Separation also facilitates central management of secrets, easing responsibilities like key rotation.",
            "guid": "c4310e87-1366-4523-b2e1-244e1074fbb0",
            "service": "OpenAI",
            "text": "Secure keys: If your architecture requires Azure OpenAI key-based authentication, store those keys in Azure Key Vault, not in application code.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Controlling access to Azure OpenAI helps prevent attacks from unauthorized users. Using private endpoints ensures network traffic remains private between the application and the platform.",
            "guid": "4a7a9a07-0229-4175-b784-9a99eded4d54",
            "service": "OpenAI",
            "text": "Restrict access: Disable public access to Azure OpenAI unless your workload requires it. Create private endpoints if you're connecting from consumers in an Azure virtual network.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Using Microsoft Entra ID centralizes the identity-management component and eliminates the use of API keys. Using RBAC with Microsoft Entra ID ensures that users or groups have exactly the permissions they need to do their job. This kind of fine-grained access control isn't possible with Azure OpenAI API keys.",
            "guid": "d5892190-2da9-43f4-b1e1-76b38b369643",
            "service": "OpenAI",
            "text": "Microsoft Entra ID: Use Microsoft Entra ID for authentication and to authorize access to Azure OpenAI by using role-based access control (RBAC). Disable local authentication in Azure AI Services and set `disableLocalAuth` to `true`. Grant identities that perform completions or image generation the Cognitive Services OpenAI User role. Grant model automation pipelines and ad-hoc data-science access a role like Cognitive Services OpenAI Contributor.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Using customer-managed keys gives you greater flexibility to create, rotate, disable, and revoke access controls.",
            "guid": "60a4703c-1086-45e1-9384-ebb32ab50696",
            "service": "OpenAI",
            "text": "Use customer-managed keys: Use customer-managed keys for fine-tuned models and training data that's uploaded to Azure OpenAI.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Detect jailbreak attempts to identify and block prompts that try to bypass the safety mechanisms of your Azure OpenAI deployments.",
            "guid": "ce66eba7-5972-4cb5-8db0-b75c3720b220",
            "service": "OpenAI",
            "text": "Protect against jailbreak attacks: Use Azure AI Content Safety Studio to detect jailbreak risks.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "08f7b66c-7679-479b-8e2f-41b3305613dc",
            "service": "OpenAI",
            "text": "Cost management: Develop your cost model, considering prompt sizes. Understanding prompt input and response sizes and how text translates into tokens helps you create a viable cost model.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "3f66f351-a073-40bb-94d2-326e1ea1a696",
            "service": "OpenAI",
            "text": "Usage optimization: Start with pay-as-you-go pricing for Azure OpenAI until your token usage is predictable.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "3802ce2d-2a46-445d-92e2-2a23b2e40705",
            "service": "OpenAI",
            "text": "Rate optimization: When your token usage is sufficiently high and predictable over a period of time, use the provisioned throughput pricing model for better cost optimization.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "2b2303c0-e057-431d-9a02-20a1a0b2b5b9",
            "service": "OpenAI",
            "text": "Usage optimization: Consider model pricing and capabilities when you choose models. Start with less-costly models for less-complex tasks like text generation or completion tasks. For more complex tasks like language translation or content understanding, consider using more advanced models. Consider different model capabilities and maximum token usage limits when you choose a model that's appropriate for use cases like text embedding, image generation, or transcription scenarios. By carefully selecting the model that best fits your needs, you can optimize costs while still achieving the desired application performance.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "c4104d7c-4a4f-4b8a-9928-558a7c5c61d8",
            "service": "OpenAI",
            "text": "Usage optimization: Use the token-limiting constraints offered by the API calls, such as `max_tokens` and `n`, which indicate the number of completions to generate.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "fb44ea80-44a3-465f-9d50-98b800a90fd6",
            "service": "OpenAI",
            "text": "Usage optimization: Maximize Azure OpenAI price breakpoints, for example, fine-tuning and model breakpoints like image generation. Because fine-tuning is charged per hour, use as much time as you have available per hour to improve fine-tuning results while avoiding slipping into the next billing period. Similarly, the cost for generating 100 images is the same as the cost for 1 image. Maximize price breakpoints to your advantage.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "5f027af8-e168-4b86-8255-4ea6f74cfd87",
            "service": "OpenAI",
            "text": "Usage optimization: Remove unused fine-tuned models when they're no longer being consumed to avoid incurring an ongoing hosting fee.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "23756c91-3a66-4733-98b7-448bc8441f56",
            "service": "OpenAI",
            "text": "Adjust usage: Optimize prompt input and response length. Longer prompts raise costs by consuming more tokens. However, prompts that are missing sufficient context don't help the models yield good results. Create concise prompts that provide enough context for the model to generate a useful response. Also ensure that you optimize the limit of the response length.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "160154da-ea9e-4a84-ac35-8a731658c0fd",
            "service": "OpenAI",
            "text": "Cost efficiency: Batch requests where possible to minimize the per-call overhead, which can reduce overall costs. Ensure that you optimize batch size.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "739c80f6-0570-435b-ab82-2c8ce9d2deb8",
            "service": "OpenAI",
            "text": "Cost efficiency: Because models have different fine-tuning costs, consider these costs if your solution requires fine-tuning.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "518fd651-b13e-427e-a0de-f634a014f5b2",
            "service": "OpenAI",
            "text": "Monitor and optimize: Set up a cost-tracking system that monitors model usage. Use that information to help inform model choices and prompt sizes.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "Using API features to restrict usage aligns service consumption with client needs. This saves money by ensuring the model doesn't generate an overly long response that consumes more tokens than necessary.",
            "guid": "afb53b41-825a-4310-b445-bf391792c568",
            "service": "OpenAI",
            "text": "Design client code to set limits: Your custom clients should use the limit features of the Azure OpenAI completions API, such as maximum limit on the number of tokens per model (`max_tokens`) or number of completions to generation (`n`). Setting limits ensures that the server doesn't produce more than the client needs.",
            "type": "recommendation",
            "waf": "Cost"
        },
        {
            "description": "Continuously monitoring TPM and RPM gives you relevant metrics to optimize the cost of Azure OpenAI models. You can couple this monitoring with model features and model pricing to optimize model usage. You can also use this monitoring to optimize prompt sizes.",
            "guid": "e91029f2-ddf4-41f3-8358-f31b5afbe8ba",
            "service": "OpenAI",
            "text": "Monitor pay-as-you-go usage: If you use the pay-as-you-go approach, monitor usage of TPM and RPM. Use that information to inform architectural design decisions such as what models to use, and to optimize prompt sizes.",
            "type": "recommendation",
            "waf": "Cost"
        },
        {
            "description": "Continuously monitoring provision-managed utilization gives you the information you need to understand if you're underutilizing your provisioned throughput.",
            "guid": "06a0b95c-b014-4205-8d0c-f074ec393239",
            "service": "OpenAI",
            "text": "Monitor provisioned throughput usage: If you use provisioned throughput, monitor provision-managed utilization to ensure you're not underutilizing the provisioned throughput you purchased.",
            "type": "recommendation",
            "waf": "Cost"
        },
        {
            "description": "Cost monitoring, setting budgets, and setting alerts provides governance with the appropriate accountability processes.",
            "guid": "f18aba52-5587-43e6-b994-8cab7022167f",
            "service": "OpenAI",
            "text": "Cost management: Use cost management features with OpenAI to monitor costs, set budgets to manage costs, and create alerts to notify stakeholders of risks or anomalies.",
            "type": "recommendation",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "3c5f9e8e-c1a9-4c18-ac05-72877f24ff22",
            "service": "OpenAI",
            "text": "Azure DevOps culture: Ensure deployment of Azure OpenAI instances across your various environments, such as development, test, and production. Ensure that you have environments to support continuous learning and experimentation throughout the development cycle.",
            "type": "checklist",
            "waf": "Operations"
        },
        {
            "description": "",
            "guid": "56e72e7c-32bb-414b-bf04-d2883871aacb",
            "service": "OpenAI",
            "text": "Observability: Monitor, aggregate, and visualize appropriate metrics.",
            "type": "checklist",
            "waf": "Operations"
        },
        {
            "description": "",
            "guid": "63aedcb9-e01e-4df3-b9a6-13c13d6971d4",
            "service": "OpenAI",
            "text": "Observability: If Azure OpenAI diagnostics are insufficient for your needs, consider using a gateway like Azure API Management in front of Azure OpenAI to log both incoming prompts and outgoing responses where permitted. This information can help you understand the effectiveness of the model for incoming prompts.",
            "type": "checklist",
            "waf": "Operations"
        },
        {
            "description": "",
            "guid": "fe7a8e0a-b53a-48f0-a204-4e1e7e20ea4b",
            "service": "OpenAI",
            "text": "Deploy with confidence: Use infrastructure as code (IaC) to deploy Azure OpenAI, model deployments, and other infrastructure required for fine-tuning models.",
            "type": "checklist",
            "waf": "Operations"
        },
        {
            "description": "",
            "guid": "3dffb456-4675-4acb-b797-a5bf591e003a",
            "service": "OpenAI",
            "text": "Deploy with confidence: Follow large language model operations (LLMOps) practices to operationalize the management of your Azure OpenAI LLMs, including deployment, fine-tuning, and prompt engineering.",
            "type": "checklist",
            "waf": "Operations"
        },
        {
            "description": "",
            "guid": "4c82d2b3-c083-4a0e-9cd2-92d2b00b4c96",
            "service": "OpenAI",
            "text": "Automate for efficiency: If you use key-based authentication, implement an automated key-rotation strategy.",
            "type": "checklist",
            "waf": "Operations"
        },
        {
            "description": "Diagnostics collects and analyzes metrics and logs, helping you monitor the availability, performance, and operation of Azure OpenAI.",
            "guid": "ff3d2610-e8e8-4a78-aba5-556758a2798c",
            "service": "OpenAI",
            "text": "Enable and configure Azure Diagnostics: Enable and configure Diagnostics for the Azure OpenAI Service.",
            "type": "recommendation",
            "waf": "Operations"
        },
        {
            "description": "",
            "guid": "63dbbc6a-f840-4893-979c-2afcea82bf5f",
            "service": "OpenAI",
            "text": "Capacity: Estimate consumers' elasticity demands. Identify high-priority traffic that requires synchronous responses and low-priority traffic that can be asynchronous and batched.",
            "type": "checklist",
            "waf": "Performance"
        },
        {
            "description": "",
            "guid": "14677a1d-0b65-455a-997b-1490c397fbc8",
            "service": "OpenAI",
            "text": "Capacity: Benchmark token consumption requirements based on estimated demands from consumers. Consider using the Azure OpenAI benchmarking tool to help you validate the throughput if you're using provisioned throughput unit (PTU) deployments.",
            "type": "checklist",
            "waf": "Performance"
        },
        {
            "description": "",
            "guid": "59c8767d-1b78-4016-92d5-ebd83032fafa",
            "service": "OpenAI",
            "text": "Capacity: Use provisioned throughput for production workloads. Provisioned throughput offers dedicated memory and compute, reserved capacity, and consistent maximum latency for the specified model version. The pay-as-you-go offering can suffer from noisy neighbor problems like increased latency and throttling in regions under heavy use. Also, the pay-as-you-go approach doesn't offer guaranteed capacity.",
            "type": "checklist",
            "waf": "Performance"
        },
        {
            "description": "",
            "guid": "a318b299-9d54-4dfc-8f20-b00ceed43ed0",
            "service": "OpenAI",
            "text": "Capacity: Add the appropriate gateways in front of your Azure OpenAI deployments. Ensure that the gateway can route to multiple instances in the same or different regions.",
            "type": "checklist",
            "waf": "Performance"
        },
        {
            "description": "",
            "guid": "ceb21879-94da-485e-a24b-b30180fb566c",
            "service": "OpenAI",
            "text": "Capacity: Allocate PTUs to cover your predicted usage, and complement these PTUs with a TPM deployment to handle elasticity above that limit. This approach combines base throughput with elastic throughput for efficiency. Like other considerations, this approach requires a custom gateway implementation to route requests to the TPM deployment when the PTU limits are reached.",
            "type": "checklist",
            "waf": "Performance"
        },
        {
            "description": "",
            "guid": "dd313c03-7429-4cb1-84e9-d982664c2dfc",
            "service": "OpenAI",
            "text": "Capacity: Send high-priority requests synchronously. Queue low-priority requests and send them through in batches when demand is low.",
            "type": "checklist",
            "waf": "Performance"
        },
        {
            "description": "",
            "guid": "cdf82e76-ee07-47e6-9985-6b1c0a39dd42",
            "service": "OpenAI",
            "text": "Capacity: Select a model that aligns with your performance requirements, considering the tradeoff between speed and output complexity. Model performance can vary significantly based on the chosen model type. Models designed for speed offer faster response times, which can be beneficial for applications that require quick interactions. Conversely, more sophisticated models might deliver higher-quality outputs at the expense of increased response time.",
            "type": "checklist",
            "waf": "Performance"
        },
        {
            "description": "",
            "guid": "9aa6da24-6a00-4381-9da6-66c9d5cbf41f",
            "service": "OpenAI",
            "text": "Achieve performance: For applications like chatbots or conversational interfaces, consider implementing streaming. Streaming can enhance the perceived performance of Azure OpenAI applications by delivering responses to users in an incremental manner, improving the user experience.",
            "type": "checklist",
            "waf": "Performance"
        },
        {
            "description": "",
            "guid": "456cbf54-9c2f-4c6e-9739-eca408fa6baf",
            "service": "OpenAI",
            "text": "Achieve performance: Determine when to use fine-tuning before you commit to fine-tuning. Although there are good use cases for fine-tuning, such as when the information needed to steer the model is too long or complex to fit into the prompt, make sure that prompt engineering and retrieval-augmented generation (RAG) approaches don't work or are demonstrably more expensive.",
            "type": "checklist",
            "waf": "Performance"
        },
        {
            "description": "",
            "guid": "2dc38e31-8e03-40f4-842d-58ac317c5106",
            "service": "OpenAI",
            "text": "Achieve performance: Consider using dedicated model deployments per consumer group to provide per-model usage isolation that can help prevent noisy neighbors between your consumer groups.",
            "type": "checklist",
            "waf": "Performance"
        },
        {
            "description": "",
            "guid": "999ecfef-c272-4cd8-8bd0-9cd5335fb695",
            "service": "VM",
            "text": "Review Virtual Machines quotas and limits that might pose design restrictions. VMs have specific limits and quotas, which vary based on the type of VM or the region. There might be subscription restrictions, such as the number of VMs per subscription or the number of cores per VM. If other workloads share your subscription, then your ability to consume data might be reduced.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "bf605fe8-6171-4c01-8290-d6c79a21cf10",
            "service": "VM",
            "text": "Conduct a failure mode analysis to minimize points of failure by analyzing VM interactions with the network and storage components. Choose configurations like ephemeral operating system (OS) disks to localize disk access and avoid network hops. Add a load balancer to enhance self-preservation by distributing network traffic across multiple VMs, which improves availability and reliability.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "4cd18dd0-57e4-4fc9-a8ad-74c3333b6d8b",
            "service": "VM",
            "text": "Calculate your composite service-level objectives (SLOs) based on Azure service-level agreements (SLAs). Ensure that your SLO isn't higher than the Azure SLAs to avoid unrealistic expectations and potential issues.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "90e0bce0-bc44-42ba-be28-2f3dde2f4b37",
            "service": "VM",
            "text": "Create state isolation. Workload data should be on a separate data disk to prevent interference with the OS disk. If a VM fails, you can create a new OS disk with the same data disk, which ensures resilience and fault isolation. For more information, see Ephemeral OS disks.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "6d76e7b9-52d3-4878-83ab-2a08df23c8f6",
            "service": "VM",
            "text": "Make VMs and their dependencies redundant across zones. If a VM fails, the workload should continue to function because of redundancy. Include dependencies in your redundancy choices. For example, use the built-in redundancy options that are available with disks. Use zone-redundant IPs to ensure data availability and high uptime.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "56d104f5-469e-4ead-bf17-7c81c746dabe",
            "service": "VM",
            "text": "Be ready to scale up and scale out to prevent service level degradation and to avoid failures. Virtual Machine Scale Sets have autoscale capabilities that create new instances as required and distribute the load across multiple VMs and availability zones.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "3395416e-27c6-4ded-941a-de4e562c5c00",
            "service": "VM",
            "text": "Explore the automatic recovery options. Azure supports health degradation monitoring and self-healing features for VMs. For example, scale sets provide automatic instance repairs. In more advanced scenarios, self-healing involves using Azure Site Recovery, having a passive standby to fail over to, or redeploying from infrastructure as code (IaC). The method that you choose should align with the business requirements and your organizational operations. For more information, see VM service disruptions.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "3d633098-6fc7-4752-907c-5a02d53ffba2",
            "service": "VM",
            "text": "Rightsize the VMs and their dependencies. Understand your VM's expected work to ensure it's not undersized and can handle the maximum load. Have extra capacity to mitigate failures.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "cbe651de-8754-4078-8066-803f94814634",
            "service": "VM",
            "text": "Create a comprehensive disaster recovery plan. Disaster preparedness involves creating a comprehensive plan and deciding on a technology for recovery.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "6bbb44ad-f6ed-4990-b519-a56e4d995170",
            "service": "VM",
            "text": "Run operations with rigor. Reliability design choices must be supported by effective operations based on the principles of monitoring, resiliency testing in production, automated application VM patches and upgrades, and consistency of deployments. For operational guidance, see Operational Excellence.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "Future-proof your application for scaling and take advantage of the high availability guarantees that spread VMs across fault domains in a region or an availability zone.",
            "guid": "bb45d3f7-dae7-4eb6-a823-76737e6d0d88",
            "service": "VM",
            "text": "(Scale set) Use Virtual Machine Scale Sets in Flexible orchestration mode to deploy VMs.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Maintain availability even if an instance is deemed unhealthy. Automatic repairs initiate recovery by replacing the faulty instance. Setting a time window can prevent inadvertent or premature repair operations.",
            "guid": "29912435-4c36-465e-91e2-6c8fcb42b33f",
            "service": "VM",
            "text": "(VMs) Implement heath endpoints that emit instance health statuses on VMs.  (Scale set) Enable automatic repairs on the scale set by specifying the preferred repair action.  Consider setting a time frame during which automatic repairs pause if the VM's state changes.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Overprovisioning reduces deployment times and has a cost benefit because the extra VMs aren't billed.",
            "guid": "71982e91-2b16-4f49-b91e-7c52a6e0042a",
            "service": "VM",
            "text": "(Scale set) Enable overprovisioning on scale sets.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "This option isolates fault domains. During maintenance periods, when one fault domain is updated, VM instances are available in the other fault domains.",
            "guid": "07b6117e-18f8-4df2-9816-9bba2f028219",
            "service": "VM",
            "text": "(Scale set) Allow Flexible orchestration to spread the VM instances across as many fault domains as possible.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "The VM instances are provisioned in physically separate locations within each Azure region that are tolerant to local failures.  Keep in mind that, depending on resource availability, there might be an uneven number of instances across zones. Zone balancing supports availability by making sure that, if one zone is down, the other zones have sufficient instances.  Two instances in each zone provide a buffer during upgrades.",
            "guid": "056b1e06-a521-4662-9c87-19371260efe6",
            "service": "VM",
            "text": "(Scale set) Deploy across availability zones on scale sets. Set up at least two instances in each zone. Zone balancing equally spreads the instances across zones.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Capacity is reserved for your use and is available within the scope of the applicable SLAs. You can delete capacity reservations when you no longer need them, and billing is consumption based.",
            "guid": "2554bcd7-c6b8-4461-aaaa-071092d5483f",
            "service": "VM",
            "text": "(VMs) Take advantage of the capacity reservations feature.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "fa5e017f-a99c-4fcc-883b-e16427f4e05d",
            "service": "VM",
            "text": "Review the security baselines for Linux and Windows VMs and Virtual Machine Scale Sets.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "63866f61-ef77-4793-9257-dfc53e87a550",
            "service": "VM",
            "text": "Ensure timely and automated security patching and upgrades. Make sure updates are automatically rolled out and validated by using a well-defined process. Use a solution like Azure Automation to manage OS updates and maintain security compliance by making critical updates.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "5bc85e31-f7fa-4102-8e43-6fbe7add0d89",
            "service": "VM",
            "text": "Identify the VMs that hold state. Make sure that data is classified according to the sensitivity labels that your organization provided. Protect data by using security controls like appropriate levels of at-rest and in-transit encryption. If you have high sensitivity requirements, consider using high-security controls like double encryption and Azure confidential computing to protect data-in-use.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "d5320544-6d25-46c7-ab46-e81e5d85d9b3",
            "service": "VM",
            "text": "Provide segmentation to the VMs and scale sets by setting network boundaries and access controls. Place VMs in resource groups that share the same lifecycle.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "becd6031-a256-4186-995e-75817fc7783c",
            "service": "VM",
            "text": "Apply access controls to the identities that try to reach the VMs and also to the VMs that reach other resources. Use Microsoft Entra ID for authentication and authorization needs. Put strong passwords, multifactor authentication, and role-based access control (RBAC) in place for your VMs and their dependencies, like secrets, to permit allowed identities to perform only the operations that are expected of their roles.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "cc96d188-8a1f-4b48-9525-d6f3f867f322",
            "service": "VM",
            "text": "Use network controls to restrict ingress and egress traffic. Isolate VMs and scale sets in Azure Virtual Network and define network security groups to filter traffic. Protect against distributed denial of service (DDoS) attacks. Use load balancers and firewall rules to protect against malicious traffic and data exfiltration attacks.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "66e5f683-0d57-4ed1-b2bd-68e4549631bc",
            "service": "VM",
            "text": "Reduce the attack surface by hardening OS images and removing unused components. Use smaller images and remove binaries that aren't required to run the workload. Tighten the VM configurations by removing features, like default accounts and ports, that you don't need.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "961b264a-fddf-43d4-b137-a132429c2874",
            "service": "VM",
            "text": "Protect secrets such as the certificates that you need to protect data in transit. Consider using the Azure Key Vault extension for Windows or Linux that automatically refreshes the certificates stored in a key vault. When it detects a change in the certificates, the extension retrieves and installs the corresponding certificates.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "39b32108-5423-42aa-beaa-1601df1971f6",
            "service": "VM",
            "text": "Threat detection. Monitor VMs for threats and misconfigurations. Use Defender for Servers to capture VM and OS changes, and maintain an audit trail of access, new accounts, and changes in permissions.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "fb9921a8-884c-40df-a588-a554143809f2",
            "service": "VM",
            "text": "Threat prevention. Protect against malware attacks and malicious actors by implementing security controls like firewalls, antivirus software, and intrusion detection systems. Determine if a Trusted Execution Environment (TEE) is required.",
            "type": "checklist",
            "waf": "Reliability"
        },
        {
            "description": "When VMs communicate with other resources, they cross a trust boundary. Scale sets and VMs should authenticate their identity before communication is allowed. Microsoft Entra ID handles that authentication by using managed identities.",
            "guid": "21e2209a-6217-464b-9886-1914124b0721",
            "service": "VM",
            "text": "(Scale set) Assign a managed identity to scale sets. All VMs in the scale set get the same identity through the specified VM profile.  (VMs) You can also assign a managed identity to individual VMs when you create them and then add it to a scale set if needed.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Azure-provided features are based on signals that are captured across many tenants and can protect resources better than custom controls. You can also use policies to enforce those controls.",
            "guid": "f13132ec-ac80-4a27-a14e-b7b357523df1",
            "service": "VM",
            "text": "(Scale set) Choose VM SKUs with security features. For example, some SKUs support BitLocker encryption, and confidential computing provides encryption of data-in-use.  Review the features to understand the limitations.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Tagging is a common way to segment and organize resources and can be crucial during incident management. For more information, see Purpose of naming and tagging.",
            "guid": "944802d9-671c-479f-b973-fd6111a18486",
            "service": "VM",
            "text": "(VMs, scale set) Apply organization-recommended tags in the provisioned resources.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "The features in the security profile are automatically enabled when the VM is created.  For more information, see Azure security baseline for Virtual Machine Scale Sets.",
            "guid": "a6b12603-c2e3-43fd-9a79-6e6317817278",
            "service": "VM",
            "text": "(VMs, scale set) Set a security profile with the security features that you want to enable in the VM configuration.  For example, when you specify encryption at host in the profile, the data that's stored on the VM host is encrypted at rest and flows are encrypted to the storage service.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "You can set segmentation controls in the networking profile.  Attackers scan public IP addresses, which makes VMs vulnerable to threats.",
            "guid": "3c83a4bb-2b58-4fae-9a65-37490fecaf1c",
            "service": "VM",
            "text": "(VMs) Choose secure networking options for your VM's network profile.  Don't directly associate public IP addresses to your VMs and don't enable IP forwarding.  Ensure that all virtual network interfaces have an associated network security group.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "Disabling public network access helps prevent unauthorized access to your data and resources.",
            "guid": "fe1df647-99c3-43ea-b8ed-507b23f120e0",
            "service": "VM",
            "text": "(VMs) Choose secure storage options for your VM's storage profile.  Enable disk encryption and data-at-rest encryption by default. Disable public network access to the VM disks.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "The extensions are used to bootstrap the VMs with the right software that protects access to and from the VMs.  Microsoft-provided extensions are updated frequently to keep up with the evolving security standards.",
            "guid": "06c4068a-2562-4cc4-9269-8bdb6b349c3a",
            "service": "VM",
            "text": "(VMs, scale set) Include extensions in your VMs that protect against threats.  For example,  - Key Vault extension for Windows and Linux  - Microsoft Entra ID authentication  - Microsoft Antimalware for Azure Cloud Services and Virtual Machines  - Azure Disk Encryption extension for Windows and Linux.",
            "type": "recommendation",
            "waf": "Reliability"
        },
        {
            "description": "",
            "guid": "3e760d37-8430-4da5-833d-95bff2d43e4f",
            "service": "VM",
            "text": "Estimate realistic costs. Use the pricing calculator to estimate the costs of your VMs. Identify the best VM for your workload by using the VM selector. For more information, see Linux and Windows pricing.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "284bc1f9-59a6-491e-8070-d05e31e29ee7",
            "service": "VM",
            "text": "Implement cost guardrails. Use governance policies to restrict resource types, configurations, and locations. Use RBAC to block actions that can lead to overspending.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "353f0d7a-b104-43c3-b3e9-926af6458844",
            "service": "VM",
            "text": "Choose the right resources. Your selection of VM plan sizes and SKUs directly affect the overall cost. Choose VMs based on workload characteristics. Is the workload CPU intensive or does it run interruptible processes? Each SKU has associated disk options that affect the overall cost.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "dff9f383-b459-4359-907e-bd33a92d4bd6",
            "service": "VM",
            "text": "Choose the right capabilities for dependent resources. Save on backup storage costs for the vault-standard tier by using Azure Backup storage with reserved capacity. It offers a discount when you commit to a reservation for either one year or three years.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "24cfa2c5-9e77-48e8-82ad-c5e98c636a69",
            "service": "VM",
            "text": "Choose the right billing model. Evaluate whether commitment-based models for computing optimize costs based on the business requirements of workload. Consider these Azure options:",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "046215f1-13ee-4fbf-893d-eeafa28ab76b",
            "service": "VM",
            "text": "Monitor usage. Continuously monitor usage patterns and detect unused or underutilized VMs. For those instances, shut down VM instances when they're not in use. Monitoring is a key approach of Operational Excellence. For more information, see the recommendations in Operational Excellence.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "877c04dd-441f-4202-9b87-9eeb3c60b564",
            "service": "VM",
            "text": "Look for ways to optimize. Some strategies include choosing the most cost-effective approach between increasing resources in an existing system, or scaling up, and adding more instances of that system, or scaling out. You can offload demand by distributing it to other resources, or you can reduce demand by implementing priority queues, gateway offloading, buffering, and rate limiting. For more information, see the recommendations in Performance Efficiency.",
            "type": "checklist",
            "waf": "Cost"
        },
        {
            "description": "SKUs are priced according to the capabilities that they offer. If you don't need advanced capabilities, don't overspend on SKUs.  Spot virtual machines take advantage of the surplus capacity in Azure at a lower cost.",
            "guid": "90700d86-70f6-433f-b995-b9ad8cfdec84",
            "service": "VM",
            "text": "(VMs, scale set) Choose the right VM plan size and SKU. Identify the best VM sizes for your workload.  Use the VM selector to identify the best VM for your workload. See Windows and Linux pricing.  For workloads like highly parallel batch processing jobs that can tolerate some interruptions, consider using Azure Spot Virtual Machines. Spot virtual machines are good for experimenting, developing, and testing large-scale solutions.",
            "type": "recommendation",
            "waf": "Cost"
        },
        {
            "description": "Some high-performance disk types offer extra cost optimization features and strategies.  The Premium SSD v2 disk's adjustment capability can reduce costs because it provides high performance without overprovisioning, which could otherwise lead to underutilized resources.",
            "guid": "14211a5a-ea48-4aa1-9f24-e46689328dda",
            "service": "VM",
            "text": "(VMs, scale set) Evaluate the disk options that are associated with your VM's SKUs.  Determine your performance needs while keeping in mind your storage capacity needs and accounting for fluctuating workload patterns.  For example, the Azure Premium SSD v2 disk allows you to granularly adjust your performance independent of the disk's size.",
            "type": "recommendation",
            "waf": "Cost"
        },
        {
            "description": "Reduce compute infrastructure costs by applying the deep discounts of spot virtual machines.",
            "guid": "38d3a88b-a84f-46f3-95ce-76a4e245027b",
            "service": "VM",
            "text": "(Scale set) Mix regular VMs with spot virtual machines.  Flexible orchestration lets you distribute spot virtual machines based on a specified percentage.",
            "type": "recommendation",
            "waf": "Cost"
        },
        {
            "description": "Scaling in or stopping resources when they're not in use reduces the number of VMs running in the scale set, which saves costs.  The Start/Stop feature is a low-cost automation option.",
            "guid": "eccee9b1-70f3-4c96-8223-35e24d842201",
            "service": "VM",
            "text": "(Scale set) Reduce the number of VM instances when demand decreases. Set a scale-in policy based on criteria.   Stop VMs during off-hours. You can use the Azure Automation Start/Stop feature and configure it according to your business needs.",
            "type": "recommendation",
            "waf": "Cost"
        },
        {
            "description": "You can maximize your on-premises licenses while getting the benefits of the cloud.",
            "guid": "3c34c3e4-5715-472e-953e-2d5030bf18a0",
            "service": "VM",
            "text": "(VMs, scale set) Take advantage of license mobility by using Azure Hybrid Benefit. VMs have a licensing option that allows you to bring your own on-premises Windows Server OS licenses to Azure.  Azure Hybrid Benefit also lets you bring certain Linux subscriptions to Azure.",
            "type": "recommendation",
            "waf": "Cost"
        },
        {
            "description": "",
            "guid": "fc1734b9-fefe-403d-bfc9-c2beca6f12a2",
            "service": "VM",
            "text": "Monitor the VM instances. Collect logs and metrics from VM instances to monitor resource usage and measure the health of the instances. Some common metrics include CPU usage, number of requests, and input/output (I/O) latency. Set up Azure Monitor alerts to be notified about issues and to detect configuration changes in your environment.",
            "type": "checklist",
            "waf": "Operations"
        },
        {
            "description": "",
            "guid": "724b847d-caf4-4e90-83e7-f4c71e68c4f7",
            "service": "VM",
            "text": "Monitor the health of the VMs and their dependencies.",
            "type": "checklist",
            "waf": "Operations"
        },
        {
            "description": "",
            "guid": "f99e71a9-05ee-41c2-81b7-8d794763040b",
            "service": "VM",
            "text": "Create a maintenance plan that includes regular system patching as a part of routine operations. Include emergency processes that allow for immediate patch application. You can have custom processes to manage patching or partially delegate the task to Azure.",
            "type": "checklist",
            "waf": "Operations"
        },
        {
            "description": "",
            "guid": "ca34b9c2-69db-4256-a354-c491877f79ac",
            "service": "VM",
            "text": "Automate processes for bootstrapping, running scripts, and configuring VMs. You can automate processes by using extensions or custom scripts. We recommend the following options:",
            "type": "checklist",
            "waf": "Operations"
        },
        {
            "description": "",
            "guid": "821779c7-588f-40af-a740-8dd41fb585fd",
            "service": "VM",
            "text": "Have processes for installing automatic updates. Consider using Automatic VM guest patching for a timely rollout of critical patches and security patches. Use Azure Update Manager to manage OS updates for your Windows and Linux virtual machines in Azure.",
            "type": "checklist",
            "waf": "Operations"
        },
        {
            "description": "",
            "guid": "079c8821-00dd-4eaf-9cae-5a3dbfd6fdfa",
            "service": "VM",
            "text": "Build a test environment that closely matches your production environment to test updates and changes before you deploy them to production. Have processes in place to test the security updates, performance baselines, and reliability faults. Take advantage of Azure Chaos Studio fault libraries to inject and simulate error conditions. For more information, see Azure Chaos Studio fault and action library.",
            "type": "checklist",
            "waf": "Operations"
        },
        {
            "description": "",
            "guid": "77cdbef0-ba18-4ef0-9ef4-088931e331c7",
            "service": "VM",
            "text": "Manage your quota. Plan what level of quota your workload requires and review that level regularly as the workload evolves. If you need to increase or decrease your quota, request those changes early.",
            "type": "checklist",
            "waf": "Operations"
        },
        {
            "description": "Flexible orchestration can manage VM instances at scale. Handing individual VMs adds operational overhead.  For example, when you delete VM instances, the associated disks and NICs are also automatically deleted. VM instances are spread across multiple fault domains so that update operations don't disrupt service.",
            "guid": "3049efb5-d3ae-4e36-a8fa-12f2c4a44144",
            "service": "VM",
            "text": "(Scale set) Virtual Machine Scale Sets in Flexible orchestration mode can help simplify the deployment and management of your workload. For example, you can easily manage self-healing by using automatic repairs.",
            "type": "recommendation",
            "waf": "Operations"
        },
        {
            "description": "Security is the primary reason for upgrades. Security assurances for the instances shouldn't decay over time.  Rolling upgrades are done in batches, which ensures all instances aren't down at the same time.",
            "guid": "19de83a6-2f87-49b1-8241-d1d687f46658",
            "service": "VM",
            "text": "(Scale set) Keep your VMs up to date by setting an upgrade policy. We recommend rolling upgrades. However, if you need granular control, choose to upgrade manually.  For Flexible orchestration, you can use  Azure Update Manager.",
            "type": "recommendation",
            "waf": "Operations"
        },
        {
            "description": "The VMs in the scale set are created and the specified apps are preinstalled, which makes management easier.",
            "guid": "65c832e8-2882-45ed-b239-0e68f74975aa",
            "service": "VM",
            "text": "(VMs, scale set) Automatically deploy VM applications from the Azure Compute Gallery by defining the applications in the profile.",
            "type": "recommendation",
            "waf": "Operations"
        },
        {
            "description": "Extensions can help simplify the software installation at scale without you having to manually install, configure, or upgrade it on each VM.",
            "guid": "40266c61-9685-4ee1-8cb6-a899a6b573f2",
            "service": "VM",
            "text": "Install prebuilt software components as extensions as part of bootstrapping.  Azure supports many extensions that can be used to configure, monitor, secure, and provide utility applications for your VMs.   Enable automatic upgrades on extensions.",
            "type": "recommendation",
            "waf": "Operations"
        },
        {
            "description": "Monitoring data is at the core of incident resolution. A comprehensive monitoring stack provides information about how the VMs are performing and their health. By continuously monitoring the instances, you can be ready for or prevent failures like performance overload and reliability issues.",
            "guid": "72e210dc-5abb-4569-b650-ec27003bb1cf",
            "service": "VM",
            "text": "(VMs, scale set) Monitor and measure the health of the VM instances.  Deploy the Monitor agent extension to your VMs to collect monitoring data from the guest OS with OS-specific data collection rules.  Enable VM insights to monitor health and performance and to view trends from the collected data. Use boot diagnostics to get information as VMs boot. Boot diagnostics also diagnose boot failures.",
            "type": "recommendation",
            "waf": "Operations"
        },
        {
            "description": "",
            "guid": "0303e75c-321d-42b0-9226-b05f43633d50",
            "service": "VM",
            "text": "Define performance targets. Identify VM metrics to track and measure against performance indicators as response time, CPU utilization, and memory utilization, as well as workload metrics such as transactions per second, concurrent users, and availability and health.",
            "type": "checklist",
            "waf": "Performance"
        },
        {
            "description": "",
            "guid": "f2c0ba97-9170-43ab-90b5-b30f159913ba",
            "service": "VM",
            "text": "Factor in the performance profile of VMs, scale sets, and disk configuration in your capacity planning. Each SKU has a different profile of memory and CPU and behaves differently depending on the type of workload. Conduct pilots and proofs of concept to understand performance behavior under the specific workload.",
            "type": "checklist",
            "waf": "Performance"
        },
        {
            "description": "",
            "guid": "ffee7b2f-b57c-40cc-a8ab-9044dead9dc7",
            "service": "VM",
            "text": "VM performance tuning. Take advantage of performance optimization and enhancing features as required by the workload. For example, use locally attached Non-Volatile Memory Express (NVMe) for high performance use cases and accelerated networking, and use Premium SSD v2 for better performance and scalability.",
            "type": "checklist",
            "waf": "Performance"
        },
        {
            "description": "",
            "guid": "75cf3a03-3d7c-4199-8138-45ff62b1f7a5",
            "service": "VM",
            "text": "Take the dependent services into account. Workload dependencies, like caching, network traffic, and content delivery networks, that interact with the VMs can affect performance. Also, consider geographical distribution, like zones and regions, which can add latency.",
            "type": "checklist",
            "waf": "Performance"
        },
        {
            "description": "",
            "guid": "739525ea-4d0a-4965-baef-ab0325fbed67",
            "service": "VM",
            "text": "Collect performance data. Follow the Operational Excellence best practices for monitoring and deploy the appropriate extensions to view metrics that track against performance indicators.",
            "type": "checklist",
            "waf": "Performance"
        },
        {
            "description": "",
            "guid": "39acd43b-a405-439b-83c9-b9d79d9cdba6",
            "service": "VM",
            "text": "Proximity placement groups. Use proximity placement groups in workloads where low latency is required to ensure that VMs are physically located close to each other.",
            "type": "checklist",
            "waf": "Performance"
        },
        {
            "description": "Rightsizing your VMs is a fundamental decision that significantly affects the performance of your workload. Without the right set of VMs, you might experience performance issues and accrue unnecessary costs.",
            "guid": "67cc04db-4b74-40f4-9bf6-0ba5f758b45e",
            "service": "VM",
            "text": "(VMs, scale set) Choose SKUs for VMs that align with your capacity planning. Have a good understanding of your workload requirements, including the number of cores, memory, storage, and network bandwidth so that you can filter out unsuitable SKUs.",
            "type": "recommendation",
            "waf": "Performance"
        },
        {
            "description": "Proximity placement groups reduce the physical distance between Azure compute resources, which can improve performance and reduce network latency between stand-alone VMs, VMs in multiple availability sets, or VMs in multiple scale sets.",
            "guid": "ef3de2ad-d5b6-4931-9fc7-28249d9300c0",
            "service": "VM",
            "text": "(VMs, scale set) Deploy latency-sensitive workload VMs in proximity placement groups.",
            "type": "recommendation",
            "waf": "Performance"
        },
        {
            "description": "Premium SSDs deliver high-performance and low-latency disk support VMs with I/O-intensive workloads.  Premium SSD v2 doesn't require disk resizing, which enables high performance without excessive over-provisioning and minimizes the cost of unused capacity.  When available on VM SKUs, locally attached NVMe or similar devices can offer high performance, especially for use cases that require high input/output operations per second (IOPS) and low latency.",
            "guid": "a91aae92-2b2c-4c88-b268-2c70b995a952",
            "service": "VM",
            "text": "(VMs, scale set)  Set the storage profile by analyzing the disk performance of existing workloads and the VM SKU.  Use Premium SSDs for production VMs. Adjust the performance of disks with Premium SSD v2. Use locally attached NVMe devices.",
            "type": "recommendation",
            "waf": "Performance"
        },
        {
            "description": "It enables single root I/O virtualization (SR-IOV) to a VM, which greatly improves its networking performance.",
            "guid": "57e446da-1b2e-4bdc-abc9-3e978a11e940",
            "service": "VM",
            "text": "(VMs) Consider enabling accelerated networking.",
            "type": "recommendation",
            "waf": "Performance"
        },
        {
            "description": "If your application demand increases, the load on the VM instances in your scale set increases. Autoscale rules ensure that you have enough resources to meet the demand.",
            "guid": "785858b0-2f0b-476d-9f1e-af92b57314c9",
            "service": "VM",
            "text": "(VMs, scale set) Set autoscale rules to increase or decrease the number of VM instances in your scale set based on demand.",
            "type": "recommendation",
            "waf": "Performance"
        }
    ],
    "metadata": {
        "name": "WAF checklist",
        "timestamp": "October 01, 2024"
    },
    "severities": [
        {
            "name": "High"
        },
        {
            "name": "Medium"
        },
        {
            "name": "Low"
        }
    ],
    "status": [
        {
            "description": "This check has not been looked at yet",
            "name": "Not verified"
        },
        {
            "description": "There is an action item associated to this check",
            "name": "Open"
        },
        {
            "description": "This check has been verified, and there are no further action items associated to it",
            "name": "Fulfilled"
        },
        {
            "description": "Recommendation understood, but not needed by current requirements",
            "name": "Not required"
        },
        {
            "description": "Not applicable for current design",
            "name": "N/A"
        }
    ]
}
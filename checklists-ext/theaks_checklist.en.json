{
    "items": [
        {
            "title": "Implement a proper Liveness probe",
            "guid": "2e9ed573-38b2-4856-a7f9-676d9ab604e1",
            "priority": "High",
            "description": "Many applications running for long periods of time eventually transition to broken states, and cannot recover except by being restarted. Kubernetes provides liveness probes to detect and remedy such situations. The probe is here to tell Kubernetes to restart your pod when it is not responding anymore",
            "documentation": [
                {
                    "title": "Configure Liveness, Readiness and Startup Probes",
                    "url": "https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/"
                }
            ],
            "tags": [
                "all",
                "application"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Application",
            "service": "AKS"
        },
        {
            "title": "Implement a proper Startup probe",
            "guid": "a066989c-9dce-4712-bce3-4eef36f8c0c2",
            "priority": "Medium",
            "description": "Protect slow starting containers with startup probes. Startup probe allow to delay the initial check by liveness which could cause deadlock or wrong result",
            "documentation": [
                {
                    "title": "Configure Liveness, Readiness and Startup Probes",
                    "url": "https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/"
                }
            ],
            "tags": [
                "all",
                "application"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Application",
            "service": "AKS"
        },
        {
            "title": "Implement a proper Readiness probe",
            "guid": "de1b6b38-4fa9-4f6e-ab92-d824346dd20c",
            "priority": "Medium",
            "description": "Sometimes, applications are temporarily unable to serve traffic. For example, an application might need to load large data or configuration files during startup, or depend on external services after startup. In such cases, you don't want to kill the application, but you don't want to send it requests either. Kubernetes provides readiness probes to detect and mitigate these situations. A pod with containers reporting that they are not ready does not receive traffic through Kubernetes Services.",
            "documentation": [
                {
                    "title": "Configure Liveness, Readiness and Startup Probes",
                    "url": "https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/"
                }
            ],
            "tags": [
                "all",
                "application"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Application",
            "service": "AKS"
        },
        {
            "title": "Implement a proper prestop hook",
            "guid": "dc4828a3-fc4f-4ac5-8844-122b8482dbb1",
            "priority": "Low",
            "description": "This hook is called immediately before a container is terminated due to an API request or management event such as liveness probe failure, preemption, resource contention and others. It can be used when you have critical process you want to finish or save when your pod is destroyed for any reason",
            "documentation": [
                {
                    "title": "Container Lifecycle Hooks",
                    "url": "https://kubernetes.io/docs/concepts/containers/container-lifecycle-hooks/"
                }
            ],
            "tags": [
                "all",
                "application"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Application",
            "service": "AKS"
        },
        {
            "title": "Run more than one replica for your Deployment",
            "guid": "4f1f88f9-98a3-48f5-a37f-4d9c9aecbb11",
            "priority": "Medium",
            "description": "Ensure that your application always configure proper replicas to ensure resiliency in the event of a pod crashing or being evicted.",
            "documentation": [
                {
                    "title": "Pod replicas",
                    "url": "https://kubernetes.io/docs/concepts/workloads/controllers/replicaset/"
                }
            ],
            "tags": [
                "all",
                "application"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Application",
            "service": "AKS"
        },
        {
            "title": "Apply tags/labels to all resources",
            "guid": "7b613b26-df38-49a8-94bf-c5301a91d558",
            "priority": "Medium",
            "description": "Ensure that your components are tagged, it could be business, security or technical tags and these tags will help to assess or apply relevant policies.",
            "documentation": [
                {
                    "title": "Recommended Labels",
                    "url": "https://kubernetes.io/docs/concepts/overview/working-with-objects/common-labels/"
                }
            ],
            "tags": [
                "all",
                "application"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Application",
            "service": "AKS"
        },
        {
            "title": "Implement autoscaling of your applications (Horizontal pod autoscaler, KEDA)",
            "priority": "Low",
            "guid": "faa19bfe-9d55-4d04-a3c4-919ca1b2d121",
            "description": "Automatically scale your application to the number of pods required to handle the current load. This can be achieved by using Horizontal Pod Autoscaler for CPU & Memory or by using KEDA for scaling based on other sources",
            "documentation": [
                {
                    "title": "Horizontal Pod Autoscaler",
                    "url": "https://kubernetes.io/docs/tasks/run-application/horizontal-pod-autoscale/"
                }
            ],
            "tools": [
                {
                    "title": "Kubernetes Event-driven Autoscaling (KEDA)",
                    "url": "https://keda.sh/"
                },
                {
                    "title": "KEDA as AKS addon",
                    "url": "https://docs.microsoft.com/azure/aks/keda-about"
                }
            ],
            "tags": [
                "all",
                "resiliency"
            ],
            "optionalFields": {
                "score": {
                    "scale": 1,
                    "simple": -1
                }
            },
            "category": "Application",
            "service": "AKS",
            "subcategory": "Scalability",
            "waf": "Performance"
        },
        {
            "title": "Store your secrets in Azure Key Vault, don't inject passwords in Docker Images",
            "priority": "High",
            "guid": "5e3df584-eccc-4d97-a3b6-bcda3b50eb2e",
            "description": "Secrets are not encrypted in etcd, prefer to store your secrets in a proper HSM like Azure Key Vault. You can then inject secrets using CSI provider.",
            "documentation": [
                {
                    "title": "Azure Key Vault Provider for Secret Store CSI Driver",
                    "url": "https://github.com/Azure/secrets-store-csi-driver-provider-azure"
                },
                {
                    "title": "AKV2K8S",
                    "url": "https://akv2k8s.io/"
                }
            ],
            "tags": [
                "all",
                "security"
            ],
            "optionalFields": {
                "score": {
                    "simple": -1,
                    "security": 1
                }
            },
            "category": "Application",
            "service": "AKS",
            "subcategory": "Secrets",
            "waf": "Security"
        },
        {
            "title": "Implement Azure Workload Identity",
            "priority": "Medium",
            "guid": "d2e0d5d7-71d4-41e3-910c-c57b4a4b1410",
            "description": "Don't use fixed credentials within pods or container images, as they are at risk of exposure or abuse. Instead, use workload identity federation to access Azure Active Directory (Azure AD) protected resources without needing to manage secrets ",
            "detail": "When pods need access to other Azure services, such as Cosmos DB, Key Vault, or Blob Storage, the pod needs access credentials. These access credentials could be defined with the container image or injected as a Kubernetes secret, but need to be manually created and assigned. Often, the credentials are reused across pods, and aren't regularly rotated. Managed identities for Azure resources (currently implemented as an associated AKS open source project) let you automatically request access to services through Azure AD. You don't manually define credentials for pods, instead they request an access token in real time, and can use it to access only their assigned services.",
            "documentation": [
                {
                    "title": "Use Azure Workload Identity",
                    "url": "https://learn.microsoft.com/azure/aks/workload-identity-overview"
                },
                {
                    "title": "Azure Active Directory Pod Identity (deprecated)",
                    "url": "https://docs.microsoft.com/azure/aks/use-azure-ad-pod-identity"
                }
            ],
            "tags": [
                "all",
                "identity",
                "security",
                "application"
            ],
            "optionalFields": {
                "score": {
                    "simple": -1,
                    "security": 1
                }
            },
            "category": "Application",
            "service": "AKS",
            "subcategory": "Identity",
            "waf": "Security"
        },
        {
            "title": "Use Kubernetes namespaces to properly isolate your Kubernetes resources",
            "guid": "0b56d03c-5fc8-42b1-943b-9e4b4d0f3de8",
            "priority": "Medium",
            "description": "Namespaces give you the ability to create logical partitions and enforce separation of your resources as well as limit the scope of user permissions. Don't forget not to use the Default namespace",
            "documentation": [
                {
                    "title": "Namespaces",
                    "url": "https://kubernetes.io/docs/concepts/overview/working-with-objects/namespaces/"
                }
            ],
            "tags": [
                "all",
                "security",
                "application",
                "multi-tenancy"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Application",
            "service": "AKS"
        },
        {
            "title": "Set up requests and limits on your containers",
            "priority": "High",
            "guid": "b54eb2eb-03dd-4aa3-9927-18e2edb11726",
            "description": "When Containers have resource requests specified, the scheduler can make better decisions about which nodes to place Pods on. And when Containers have their limits specified, contention for resources on a node can be handled in a specified manner.",
            "documentation": [
                {
                    "title": "Managing Compute Resources for Containers",
                    "url": "https://kubernetes.io/docs/concepts/configuration/manage-compute-resources-container/"
                },
                {
                    "title": "Take benefit of the Quality of Service",
                    "url": "https://kubernetes.io/docs/tasks/configure-pod-container/quality-service-pod/"
                }
            ],
            "tags": [
                "all",
                "resources",
                "application",
                "multi-tenancy"
            ],
            "optionalFields": {
                "score": {
                    "simple": -1,
                    "ha": 1
                }
            },
            "category": "Application",
            "service": "AKS",
            "subcategory": "Resources",
            "waf": "Operations"
        },
        {
            "title": "Specify the security context of your pod/container",
            "guid": "20861805-be15-48f5-b40b-5ae203ddbb67",
            "priority": "Medium",
            "description": "A security context defines privilege and access control settings for a Pod or Container. Control the capabilities and the rights your container can have. If you don't specify the security context, the pod get the 'default' one which may have more rights that it should",
            "detail": "You should also disable mounting credentials by default (automountServiceAccountToken)",
            "documentation": [
                {
                    "title": "Configure a Security Context for a Pod or Container",
                    "url": "https://kubernetes.io/docs/tasks/configure-pod-container/security-context/"
                }
            ],
            "tags": [
                "all",
                "security"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Application",
            "service": "AKS"
        },
        {
            "title": "Ensure your manifests respect good practices",
            "priority": "Medium",
            "guid": "5388e9de-d167-4dd1-a2b0-ac241b999a64",
            "description": "Best practices inside the cluster start with the configuration of your manifests. Ensure that they respect good practices",
            "documentation": [
                {
                    "title": "Kubernetes YAML: Enforcing best practices and security policies",
                    "url": "https://thechief.io/c/editorial/kubernetes-yaml-enforcing-best-practices-and-security-policies-cicd-and-gitops-pipelines/"
                },
                {
                    "title": "13 Best Practices for Using Helm",
                    "url": "https://betterprogramming.pub/13-best-practices-for-using-helm-f4fc68545a2c"
                }
            ],
            "tools": [
                {
                    "title": "kube-score",
                    "url": "https://kube-score.com/"
                },
                {
                    "title": "Checkov",
                    "url": "https://www.checkov.io/"
                },
                {
                    "title": "kubelinter",
                    "url": "https://github.com/stackrox/kube-linter"
                }
            ],
            "tags": [
                "all",
                "resources",
                "security"
            ],
            "optionalFields": {
                "score": {
                    "simple": 1
                }
            },
            "category": "Application",
            "service": "AKS"
        },
        {
            "title": "Conduct Dockerfile scanning to ensure Docker Image Security Best Practices",
            "guid": "b5222fdc-72b7-4b5f-baae-ab48a69b1d36",
            "priority": "High",
            "description": "Define a Image build security baseline for your developers to follow. You should also use scanning tools to detect Dockerfile issue",
            "documentation": [
                {
                    "title": "SNYK 10 Docker Image Security Best Practices",
                    "url": "https://snyk.io/blog/10-docker-image-security-best-practices/"
                },
                {
                    "title": "21 Best Practises in 2021 for Dockerfile",
                    "url": "https://dev.to/chrisedrego/21-best-practise-in-2021-for-dockerfile-1dji"
                }
            ],
            "tools": [
                {
                    "title": "Dockle",
                    "url": "https://github.com/goodwithtech/dockle"
                },
                {
                    "title": "Hadolint",
                    "url": "https://github.com/hadolint/hadolint"
                }
            ],
            "tags": [
                "all",
                "security"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Application",
            "service": "AKS"
        },
        {
            "title": "Static Analysis of Docker Images on Build",
            "guid": "54cbc938-394e-480a-823a-51c2bcd3c66b",
            "priority": "High",
            "description": "Introduction of DevSecOps into the environment to promote a proactive security model that starts to shift the responsibility left",
            "documentation": [
                {
                    "title": "Introduction to Microsoft Defender for container registries",
                    "url": "https://docs.microsoft.com/azure/defender-for-cloud/defender-for-containers-introduction"
                },
                {
                    "title": "Palo Alto CI/CD Integration (twistcli)",
                    "url": "https://docs.paloaltonetworks.com/prisma/prisma-cloud/prisma-cloud-admin-compute/tools/twistcli_scan_images"
                },
                {
                    "title": "Qualys CI/CD Integration",
                    "url": "https://qualysguard.qg2.apps.qualys.com/cs/help/vuln_scans/docker_images.htm"
                },
                {
                    "title": "Clair CI/CD Integration",
                    "url": "https://github.com/quay/clair"
                }
            ],
            "tags": [
                "all",
                "security"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Application",
            "service": "AKS"
        },
        {
            "title": "Threshold enforcement of Docker Image Builds that contain vulnerabilities",
            "guid": "1a67a172-c4ca-4383-8934-a71277cb927e",
            "priority": "Medium",
            "description": "Restrict builds with identified issues.",
            "detail": "Use a tool that allows for the restriction of builds with enough granularity to not break development.  All Critical CVE's are not the same, so being able to restrict builds based on Critical or High vulnerabilities with a Vendor fix, but allowing builds to continue if that Critical vulnerability is 'Open'",
            "documentation": [
                {
                    "title": "Prisma Threshold enforcement",
                    "url": "https://docs.paloaltonetworks.com/prisma/prisma-cloud/prisma-cloud-admin-compute/vulnerability_management/vuln_management_rules.html"
                }
            ],
            "tags": [
                "all",
                "security"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Application",
            "service": "AKS"
        },
        {
            "title": "Compliance enforcement of Docker Image Builds",
            "guid": "01ede997-e0bf-454a-bd1f-114be06a9874",
            "priority": "High",
            "description": "Being able to assess and restrict the Compliance state of an image on build.",
            "detail": "Identifying an image running as 'root' before it get deployed, or opening up port 80 or 22",
            "documentation": [
                {
                    "title": "Azure Built-In Policy",
                    "url": "https://docs.microsoft.com/azure/aks/policy-samples"
                },
                {
                    "title": "Prisma Managing Compliance",
                    "url": "https://docs.paloaltonetworks.com/prisma/prisma-cloud/prisma-cloud-admin-compute/compliance/manage_compliance.html"
                }
            ],
            "tags": [
                "all",
                "security"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Application",
            "service": "AKS"
        },
        {
            "title": "Use Azure Migrate to quick containerize your applications",
            "guid": "c1c05f94-4b74-4231-9d36-aa7a56fb775e",
            "priority": "Low",
            "description": "The App Containerization tool offers a point-and-containerize approach to repackage applications as containers with minimal to no code changes by using the running state of the application. The tool currently supports containerizing ASP.NET applications and Java web applications running on Apache Tomcat.",
            "documentation": [
                {
                    "title": "Accelerate application modernization with Azure Migrate: App Containerization",
                    "url": "https://aka.ms/AppContainerizationtoAKS"
                }
            ],
            "tags": [
                "all",
                "application"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Application",
            "service": "AKS"
        },
        {
            "title": "Apply the right deployment type to your application",
            "guid": "3abc7c0e-44c7-40fc-afce-aa4ddbf3dd81",
            "priority": "Low",
            "description": "There are a variety of techniques to deploy new applications to production so choosing the right strategy is an important decision that needs to be made to leverage the impact of change on the consumer.",
            "documentation": [
                {
                    "title": "Kubernetes Deployment Strategies",
                    "url": "https://blog.container-solutions.com/deployment-strategies"
                }
            ],
            "tags": [
                "all",
                "application"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Application",
            "service": "AKS"
        },
        {
            "title": "Don't use naked pods",
            "guid": "980e9f76-e20a-426a-9c01-cbae1b63c5e8",
            "priority": "Low",
            "description": "Naked pods are pods not linked to a Replicaset or a Deployment. Naked Pods will not be rescheduled in the event of a node failure.",
            "details": "If imagePullPolicy is omitted and either the image tag is :latest or it is omitted: imagePullPolicy is automatically set to Always. Prefer to set explicitly IfNotPresent",
            "tags": [
                "all",
                "resiliency",
                "application"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Application",
            "service": "AKS"
        },
        {
            "title": "Control the usage of imagePullPolicy",
            "guid": "d457598a-047b-4fd7-88e5-9c61dea67f6a",
            "priority": "Low",
            "description": "If this attributes is not properly define kubernetes downloads the container image for each new instance of the containers.",
            "documentation": [
                {
                    "title": "Updating images",
                    "url": "https://kubernetes.io/docs/concepts/containers/images/#updating-images"
                }
            ],
            "tags": [
                "all",
                "application",
                "resiliency"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Application",
            "service": "AKS"
        },
        {
            "title": "Use automation through ARM/TF to create your Azure resources",
            "priority": "Medium",
            "guid": "3acbe04b-be20-49d3-afda-47778424d116",
            "description": "If this attributes is not properly define kubernetes downloads the container image for each new instance of the containers.",
            "documentation": [
                {
                    "title": "Create a Kubernetes cluster with Azure Kubernetes Service using Terraform",
                    "url": "https://docs.microsoft.com/azure/developer/terraform/create-k8s-cluster-with-tf-and-aks"
                }
            ],
            "tags": [
                "all",
                "IaC",
                "application"
            ],
            "optionalFields": {
                "score": {
                    "simple": -1,
                    "ha": 1
                }
            },
            "category": "Application",
            "service": "AKS",
            "subcategory": "Infrastructure as Code",
            "waf": "Operations"
        },
        {
            "title": "Use canary or blue/green deployments",
            "priority": "Medium",
            "guid": "785c2fa5-5b56-4ad4-a408-fe72734c476b",
            "description": "This will help ensure your workloads remain online during cluster upgrades.",
            "documentation": [
                {
                    "title": "Blue-green deployment for AKS",
                    "url": "https://learn.microsoft.com/en-us/azure/architecture/reference-architectures/containers/blue-green-deployment-for-aks/blue-green-deployment-for-aks"
                }
            ],
            "tags": [
                "all",
                "application",
                "IaC"
            ],
            "optionalFields": {
                "score": {
                    "cost": 1
                }
            },
            "category": "Application",
            "service": "AKS",
            "subcategory": "Development",
            "waf": "Operations"
        },
        {
            "title": "Use Dapr to ease microservice development",
            "priority": "Low",
            "guid": "26886d20-b66c-457b-a591-19bf8e8f5c58",
            "description": "This will help ensure your workloads remain online during cluster upgrades.",
            "documentation": [
                {
                    "title": "Dapr project page",
                    "url": "https://dapr.io/"
                }
            ],
            "tags": [
                "all",
                "application"
            ],
            "optionalFields": {
                "score": {
                    "simple": 1
                }
            },
            "category": "Application",
            "service": "AKS",
            "subcategory": "Development",
            "waf": "Operations"
        },
        {
            "title": "Define non-functional requirements such as SLAs, RTO (Recovery Time Objective) and RPO (Recovery Point Objective)",
            "guid": "bc14aea6-e65d-48d9-a3ad-c218e6436b06",
            "priority": "High",
            "description": "Before going to production, it is very important to decide the target of availability and recovery time you are looking for. This will help you to decide the right backup strategy but also the architecture of your solution.",
            "documentation": [
                {
                    "title": "Define the BCDR strategy",
                    "url": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/enterprise-scale/business-continuity-and-disaster-recovery"
                }
            ],
            "tags": [
                "all",
                "resiliency"
            ],
            "optionalFields": {
                "score": {
                    "ha": 1
                }
            },
            "category": "Bc_Dr",
            "service": "AKS",
            "waf": "Resiliency",
            "subcategory": "Requirements"
        },
        {
            "title": "Schedule and perform DR tests regularly (whitespace deplyment)",
            "guid": "36cb45e5-7960-4332-9bdf-8cc23318da61",
            "priority": "High",
            "description": "A whitespace (greenfield) deployment is the exercise to delete everything and to redeploy the whole platform in an automated way.",
            "detail": "In case of an emergency, a security flaw or datacenter failure, it's mandatory for you to be able to restore/create a new environment properly configured in a fully automated way",
            "documentation": [
                {
                    "title": "Schedule and perform DR tests regularly",
                    "url": "https://docs.microsoft.com/azure/cloud-adoption-framework/ready/enterprise-scale/business-continuity-and-disaster-recovery"
                }
            ],
            "tags": [
                "all",
                "resiliency",
                "devops"
            ],
            "optionalFields": {
                "score": {
                    "ha": 1
                }
            },
            "category": "Bc_Dr",
            "service": "AKS",
            "waf": "Resiliency",
            "subcategory": "Disaster Recovery"
        },
        {
            "title": "Use Availability Zones if supported in your Azure region",
            "priority": "High",
            "guid": "578a219a-46be-4b54-9350-24922634292b",
            "description": "An Azure Kubernetes Service (AKS) cluster distributes resources such as the nodes and storage across logical sections of the underlying Azure compute infrastructure. This deployment model makes sure that the nodes run across separate update and fault domains in a single Azure datacenter.",
            "documentation": [
                {
                    "title": "Create an AKS cluster across availability zones",
                    "url": "https://docs.microsoft.com/azure/aks/availability-zones"
                }
            ],
            "tags": [
                "all",
                "resiliency"
            ],
            "optionalFields": {
                "score": {
                    "ha": 1,
                    "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant= isnotnull(zones) | distinct id,compliant"
                }
            },
            "category": "Bc_Dr",
            "service": "AKS",
            "waf": "Resiliency",
            "subcategory": "High Availability",
            "graph": "resources | where type=='microsoft.containerservice/managedclusters' | extend compliant= isnotnull(properties.agentPoolProfiles[0].availabilityZones) | distinct id,compliant"
        },
        {
            "title": "Plan for multiregion deployment",
            "guid": "4e907690-4780-492f-9632-03bcc80b7a80",
            "priority": "Medium",
            "description": "When you deploy multiple AKS clusters, choose regions where AKS is available, and use paired regions.",
            "documentation": [
                {
                    "title": "Plan for multiregion deployment",
                    "url": "https://docs.microsoft.com/azure/aks/operator-best-practices-multi-region#plan-for-multiregion-deployment"
                }
            ],
            "tags": [
                "all",
                "resiliency"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Bc_Dr",
            "service": "AKS",
            "waf": "Resiliency"
        },
        {
            "title": "Use Azure Traffic Manager or Azure Front Door as a global load balancer for region failover",
            "priority": "Low",
            "guid": "170265f4-bb46-4a39-9af7-f317284797b1",
            "description": "Azure Traffic Manager can direct customers to their closest AKS cluster and application instance. For the best performance and redundancy, direct all application traffic through Traffic Manager before it goes to your AKS cluster.",
            "documentation": [
                {
                    "title": "Traffic Manager and AKS",
                    "url": "https://docs.microsoft.com/azure/aks/operator-best-practices-multi-region#use-azure-traffic-manager-to-route-traffic"
                },
                {
                    "title": "Cross-region load balancer",
                    "url": "https://learn.microsoft.com/en-us/azure/load-balancer/cross-region-overview"
                }
            ],
            "tags": [
                "all",
                "resiliency",
                "network"
            ],
            "optionalFields": {
                "score": {
                    "ha": 1
                }
            },
            "category": "Bc_Dr",
            "service": "AKS",
            "waf": "Resiliency",
            "subcategory": "High Availability"
        },
        {
            "title": "Create a storage migration plan",
            "guid": "8c6703c5-42e9-46ef-93f1-7f6232af25fc",
            "priority": "Low",
            "description": "Your applications might use Azure Storage for their data. Because your applications are spread across multiple AKS clusters in different regions, you need to keep the storage synchronized",
            "documentation": [
                {
                    "title": "Create a storage migration plan",
                    "url": "https://docs.microsoft.com/azure/aks/operator-best-practices-multi-region#create-a-storage-migration-plan"
                },
                {
                    "title": "Backup, restore and migrate Kubernetes resources including state to another AKS cluster with Velero",
                    "url": "https://pumpingco.de/blog/backup-and-restore-a-kubernetes-cluster-with-state-using-velero/"
                }
            ],
            "tags": [
                "all",
                "resiliency",
                "storage"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Bc_Dr",
            "service": "AKS",
            "waf": "Resiliency"
        },
        {
            "title": "Use the standard-tier AKS offering",
            "priority": "High",
            "guid": "71d41e36-10cc-457b-9a4b-1410d4395898",
            "description": "standard-tier (formerly Uptime SLA) is an optional feature to enable a financially backed, higher SLA for a cluster. It provides you a 99,95% SLA instead of the 99,5% SLO and is relevant for your production (and large) clusters",
            "detail": "Customers needing an SLA to meet compliance requirements or require extending an SLA to their end users should enable this feature. Customers with critical workloads that will benefit from a higher uptime SLA may also benefit. Using the Uptime SLA feature with Availability Zones enables a higher availability for the uptime of the Kubernetes API server.",
            "documentation": [
                {
                    "title": "Azure Kubernetes Service (AKS) Uptime SLA",
                    "url": "https://learn.microsoft.com/en-gb/azure/aks/free-standard-pricing-tiers"
                },
                {
                    "title": "Business continuity / disaster recovery to protect and recover AKS",
                    "url": "https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/scenarios/app-platform/aks/management#business-continuity--disaster-recovery-to-protect-and-recover-aks"
                }
            ],
            "tags": [
                "all",
                "resiliency"
            ],
            "optionalFields": {
                "score": {
                    "ha": 2,
                    "cost": -2,
                    "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (sku.tier=='Paid') | distinct id,compliant"
                }
            },
            "category": "Bc_Dr",
            "service": "AKS",
            "waf": "Resiliency",
            "subcategory": "High Availability",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (sku.tier=='Paid') | distinct id,compliant"
        },
        {
            "title": "Avoid Pods being placed into a single node",
            "guid": "1eea4888-8c2a-40b2-a40b-cacdc5f55497",
            "priority": "Low",
            "description": "Even if you run several copies of your Pods, there are no guarantees that losing a node won't take down your service.",
            "detail": "Customers needing an SLA to meet compliance requirements or require extending an SLA to their end users should enable this feature. Customers with critical workloads that will benefit from a higher uptime SLA may also benefit. Using the Uptime SLA feature with Availability Zones enables a higher availability for the uptime of the Kubernetes API server.",
            "documentation": [
                {
                    "title": "Inter-pod affinity and anti-affinity",
                    "url": "https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/#inter-pod-affinity-and-anti-affinity"
                }
            ],
            "tags": [
                "all",
                "resiliency"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Bc_Dr",
            "service": "AKS",
            "waf": "Resiliency"
        },
        {
            "title": "If using a private registry (ACR), configure region replication to store images in multiple regions",
            "guid": "b0803aed-1ca6-4330-816c-92677c6e9935",
            "priority": "Medium",
            "description": "Companies that want a local presence, or a hot backup, choose to run services from multiple Azure regions.",
            "detail": "As a best practice, placing a container registry in each region where images are run allows network-close operations, enabling fast, reliable image layer transfers. Geo-replication enables an Azure container registry to function as a single registry, serving multiple regions with multi-master regional registries.",
            "documentation": [
                {
                    "title": "Enable geo-replication for container images",
                    "url": "https://docs.microsoft.com/azure/container-registry/container-registry-geo-replication"
                }
            ],
            "tags": [
                "all",
                "resiliency"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Bc_Dr",
            "service": "AKS",
            "waf": "Resiliency"
        },
        {
            "title": "Configure your registry to use zone reduncancy",
            "guid": "a4cefd60-f24f-4907-9723-b927300b4c42",
            "priority": "Medium",
            "description": "Use Azure availability zones to create a resilient and high availability Azure container registry within an Azure region.",
            "documentation": [
                {
                    "title": "Enable zone redundancy in Azure Container Registry for resiliency and high availability",
                    "url": "https://review.learn.microsoft.com/en-us/azure/container-registry/zone-redundancy"
                }
            ],
            "tags": [
                "all",
                "resiliency"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Bc_Dr",
            "service": "AKS",
            "waf": "Resiliency"
        },
        {
            "title": "Move Container Registry to a dedicated resource group ",
            "guid": "7b0bb400-deb6-4914-82da-2e914c9aaa72",
            "priority": "Low",
            "description": "Because container registries are resources that are used across multiple container hosts, a registry should reside in its own resource group.",
            "detail": "Although you might experiment with a specific host type, such as Azure Container Instances, you\u2019ll likely want to delete the container instance when you\u2019re done. However, you might also want to keep the collection of images you pushed to Azure Container Registry. By placing your registry in its own resource group, you minimize the risk of accidentally deleting the collection of images in the registry when you delete the container instance resource group.",
            "documentation": [
                {
                    "title": "Registry best practices - Use dedicated resource group",
                    "url": "https://learn.microsoft.com/en-us/azure/container-registry/container-registry-best-practices#dedicated-resource-group"
                }
            ],
            "tags": [
                "all"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Bc_Dr",
            "service": "AKS",
            "waf": "Resiliency"
        },
        {
            "title": "Enable soft delete policy",
            "guid": "49919955-fd6c-40f5-9c5c-5a7273c7a935",
            "priority": "Low",
            "description": "Once you enable the soft delete policy, ACR manages the deleted artifacts as the soft deleted artifacts with a set retention period. Thereby you have ability to list, filter, and restore the soft deleted artifacts. Once the retention period is complete, all the soft deleted artifacts are auto-purged.",
            "documentation": [
                {
                    "title": "Enable soft delete policy",
                    "url": "https://learn.microsoft.com/en-us/azure/container-registry/container-registry-soft-delete-policy"
                }
            ],
            "tags": [
                "all"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Bc_Dr",
            "service": "AKS",
            "waf": "Resiliency"
        },
        {
            "title": "Logically isolate cluster",
            "guid": "49be78dc-6ff0-4b2c-94ef-e74002e18866",
            "priority": "Medium",
            "description": "Use logical isolation to separate teams and projects. Try to minimize the number of physical AKS clusters you deploy to isolate teams or applications",
            "documentation": [
                {
                    "title": "Isolating cluster",
                    "url": "https://docs.microsoft.com/azure/aks/operator-best-practices-cluster-isolation#logically-isolate-clusters"
                }
            ],
            "tags": [
                "all",
                "multi-tenancy"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Cluster_Multi",
            "service": "AKS"
        },
        {
            "title": "Physically isolate cluster",
            "guid": "3b77c0ee-3f84-4a86-bb46-c6dc3070168c",
            "priority": "High",
            "description": "Minimize the use of physical isolation for each separate team or application deployment",
            "documentation": [
                {
                    "title": "Isolating cluster",
                    "url": "https://docs.microsoft.com/azure/aks/operator-best-practices-cluster-isolation#physically-isolate-clusters"
                }
            ],
            "tags": [
                "all"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Cluster_Multi",
            "service": "AKS"
        },
        {
            "title": "Use Azure tags in Azure Kubernetes Service (AKS)",
            "guid": "574bd2fe-f58b-4199-b334-f7eff3ef90c8",
            "priority": "Medium",
            "description": "With Azure Kubernetes Service (AKS), you can set Azure tags on an AKS cluster and its related resources by using Azure Resource Manager, through the Azure CLI.",
            "documentation": [
                {
                    "title": "Use Azure tags in Azure Kubernetes Service ",
                    "url": "https://learn.microsoft.com/en-us/Azure/aks/use-tags"
                },
                {
                    "title": "Use Azure tags in Azure Kubernetes Service (AKS)",
                    "url": "https://techcommunity.microsoft.com/t5/fasttrack-for-azure/use-azure-tags-in-azure-kubernetes-service-aks/ba-p/3611583"
                }
            ],
            "tags": [
                "all",
                "operations",
                "finops"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Cluster_Multi",
            "service": "AKS"
        },
        {
            "title": "Use Mariner COS as host OS",
            "guid": "d34f49c0-e964-4465-9211-520479338b13",
            "priority": "Medium",
            "description": "Mariner Container-Optimized OS is a first-party operating system developed specifically for Azure Kubernetes Service (AKS). It is designed to optimize the execution of Kubernetes workloads, offering a secure, lightweight, and highly performant environment. ",
            "documentation": [
                {
                    "title": "Use the Mariner container host on Azure Kubernetes Service",
                    "url": "https://learn.microsoft.com/en-us/azure/aks/use-mariner"
                }
            ],
            "tags": [
                "all",
                "operations",
                "security"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Cluster_Security",
            "service": "AKS",
            "waf": "Security"
        },
        {
            "title": "Configure your cluster for regulated industries",
            "priority": "Medium",
            "guid": "42d4aefe-2383-470e-b019-c30df24996b2",
            "description": "Some industries require certified kubernetes or to implement specific configurations. AKS offers several features to meet this requirements",
            "tags": [
                "all",
                "security",
                "operations"
            ],
            "documentation": [
                {
                    "title": "Use FIPS-enabled node pool",
                    "url": "https://docs.microsoft.com/azure/aks/use-multiple-node-pools#add-a-fips-enabled-node-pool"
                },
                {
                    "title": "AKS CIS benchmark",
                    "url": "https://docs.microsoft.com/compliance/regulatory/offering-CIS-Benchmark"
                },
                {
                    "title": "AKS architecture reference for PCI-DSS 3.2.1",
                    "url": "https://docs.microsoft.com/azure/architecture/reference-architectures/containers/aks-pci/aks-pci-intro"
                }
            ],
            "optionalFields": {
                "score": {
                    "cost": -1,
                    "security": 1
                }
            },
            "category": "Cluster_Security",
            "service": "AKS",
            "waf": "Security",
            "subcategory": "Compliance"
        },
        {
            "title": "Check if you need the Kubernetes dashboard",
            "guid": "aefbf509-a9e8-46cc-8ae9-80f07acffd7c",
            "priority": "Medium",
            "description": "Starting with Kubernetes version 1.19, AKS will no longer allow the managed Kubernetes dashboard add-on to be installed for security reasons, and the add-on is scheduled to be deprecated. Ensure the Kubernetes dashboard is not installed on the cluster.",
            "detail": "It can be done with the following CLI: az aks disable-addons --addons kube-dashboard --resource-group RG_NAME --name CLUSTER_NAME",
            "documentation": [],
            "tags": [
                "all",
                "compliance",
                "security"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Cluster_Security",
            "service": "AKS",
            "waf": "Security"
        },
        {
            "title": "Encrypt ETCD at rest with your own key",
            "priority": "Low",
            "guid": "e7ba73a3-0508-4f80-806f-527db30cee96",
            "description": "By default, ETCD is encrypted at rest with keys managed by Microsoft. It is possible to encrypt the database using your own key using a KMS plugin and store the key in Azure Key Vault.",
            "documentation": [
                {
                    "title": "Add KMS etcd encryption to an Azure Kubernetes Service (AKS) cluster",
                    "url": "https://docs.microsoft.com/azure/aks/use-kms-etcd-encryption"
                },
                {
                    "title": "Kubernetes KMS",
                    "url": "https://github.com/Azure/kubernetes-kms"
                }
            ],
            "tags": [
                "all",
                "secrets",
                "security"
            ],
            "optionalFields": {
                "score": {
                    "cost": -1,
                    "security": 1
                }
            },
            "category": "Cluster_Security",
            "service": "AKS",
            "waf": "Security",
            "subcategory": "Secrets"
        },
        {
            "title": "Maintain kubernetes version up to date",
            "priority": "High",
            "guid": "e189c599-df0d-45a7-9dd4-ce32c1881370",
            "description": "To stay current on new features and bug fixes, regularly upgrade to the Kubernetes version in your AKS cluster. Support for kubernetes is current and N-2 versions only",
            "documentation": [
                {
                    "title": "Regularly update to the latest version of Kubernetes",
                    "url": "https://docs.microsoft.com/azure/aks/operator-best-practices-cluster-security#regularly-update-to-the-latest-version-of-kubernetes"
                },
                {
                    "title": "Use the auto-upgrade feature",
                    "url": "https://docs.microsoft.com/azure/aks/upgrade-cluster#set-auto-upgrade-channel"
                }
            ],
            "tags": [
                "all",
                "security",
                "operations"
            ],
            "optionalFields": {
                "score": {
                    "simple": -1,
                    "security": 1
                }
            },
            "category": "Cluster_Security",
            "service": "AKS",
            "waf": "Security",
            "subcategory": "Compliance"
        },
        {
            "title": "Policy blocking the deployment of vulnerable image",
            "guid": "1f95a465-c682-405b-84b4-966c3a619c12",
            "priority": "Medium",
            "description": "You can now protect your Kubernetes clusters and container workloads from potential threats by restricting deployment of container images with vulnerabilities in their software components.",
            "tools": [
                {
                    "title": "Policy blocking the deployment of vulnerable images",
                    "url": "https://github.com/Azure/azure-policy/blob/master/built-in-policies/policyDefinitions/Kubernetes/BlockVulnerableImages.json"
                }
            ],
            "tags": [
                "all",
                "security",
                "operations"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Cluster_Security",
            "service": "AKS",
            "waf": "Security"
        },
        {
            "title": "Use Azure Key Vault",
            "guid": "fc1e68dd-ac89-4851-8e53-8fbac3461d26",
            "priority": "High",
            "description": "Use Azure Key Vault to store Secrets and Certificates",
            "documentation": [
                {
                    "title": "Tutorial: Configure and run the Azure Key Vault provider for the Secrets Store CSI driver on Kubernetes",
                    "url": "https://docs.microsoft.com/azure/key-vault/general/key-vault-integrate-kubernetes"
                }
            ],
            "tags": [
                "all",
                "security",
                "operations"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Cluster_Security",
            "service": "AKS",
            "waf": "Security"
        },
        {
            "title": "Monitor the security of your cluster with Azure Security Center",
            "guid": "23fda718-b80b-44c8-b2e4-d46580ab6651",
            "priority": "Medium",
            "description": "Security Center brings security benefits to your AKS clusters using data already gathered by the AKS master node.",
            "documentation": [
                {
                    "title": "Azure Kubernetes Services integration with Security Center",
                    "url": "https://docs.microsoft.com/azure/security-center/azure-kubernetes-service-integration"
                }
            ],
            "tags": [
                "all",
                "security",
                "operations"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Cluster_Security",
            "service": "AKS",
            "waf": "Security"
        },
        {
            "title": "Remove vulnerable images from your cluster",
            "guid": "ca62d835-69cc-476d-bd8e-ea8fa58fab9c",
            "priority": "High",
            "description": "With image cleaner, you can detect and automatically remove all unused and vulnerable images cached on AKS nodes keeping the nodes cleaner and safer.",
            "detail": "It's common to use pipelines to build and deploy images on Azure Kubernetes Service (AKS) clusters. While great for image creation, this process often doesn't account for the stale images left behind and can lead to image bloat on cluster nodes. These images can present security issues as they may contain vulnerabilities. By cleaning these unreferenced images, you can remove an area of risk in your clusters. When done manually, this process can be time intensive, which ImageCleaner can mitigate via automatic image identification and removal.",
            "documentation": [
                {
                    "title": "Use ImageCleaner to clean up stale images on your AKS cluster",
                    "url": "https://learn.microsoft.com/en-us/azure/aks/image-cleaner"
                }
            ],
            "tags": [
                "all",
                "security",
                "operations"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Cluster_Security",
            "service": "AKS",
            "waf": "Security"
        },
        {
            "title": "Enable Microsoft Defender for Containers",
            "priority": "High",
            "guid": "c9e95ffe-6dd1-4a17-8c5f-110389ca9b21",
            "description": "Microsoft Defender for Containers provides protections for your Kubernetes clusters wherever they're running (AKS and on-premesis)",
            "documentation": [
                {
                    "title": "Introduction to Microsoft Defender for Containers",
                    "url": "https://docs.microsoft.com/azure/defender-for-cloud/defender-for-containers-introduction"
                }
            ],
            "tags": [
                "all",
                "security",
                "operations"
            ],
            "optionalFields": {
                "score": {
                    "cost": -1,
                    "security": 1
                }
            },
            "category": "Cluster_Security",
            "service": "AKS",
            "waf": "Security",
            "subcategory": "Secrets"
        },
        {
            "title": "Use Azure Policy for Kubernetes to ensure cluster compliance",
            "priority": "Medium",
            "guid": "9ca48e4a-85e2-4223-bce8-bb12307ca5f1",
            "description": "Azure Policy integrates with the Azure Kubernetes Service (AKS) to apply at-scale enforcements and safeguards on your clusters in a centralized, consistent manner.",
            "documentation": [
                {
                    "title": "Azure Policies for AKS",
                    "url": "https://docs.microsoft.com/azure/governance/policy/concepts/rego-for-aks"
                },
                {
                    "title": "Azure Kubernetes Services Governance with Azure Policy",
                    "url": "https://learn.microsoft.com/training/modules/aks-governance-azure-policy"
                }
            ],
            "tools": [
                {
                    "title": "Gatekeeper",
                    "url": "https://github.com/open-policy-agent/gatekeeper"
                }
            ],
            "tags": [
                "all",
                "operations"
            ],
            "optionalFields": {
                "score": {
                    "simple": -1,
                    "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (isnotnull(properties.addonProfiles.azurepolicy) and properties.addonProfiles.azurepolicy.enabled==true) | distinct id,compliant",
                    "security": 1
                }
            },
            "category": "Cluster_Security",
            "service": "AKS",
            "waf": "Security",
            "subcategory": "Compliance",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (isnotnull(properties.addonProfiles.azurepolicy) and properties.addonProfiles.azurepolicy.enabled==true) | distinct id,compliant"
        },
        {
            "title": "Separate applications from the control plane with user/system nodepools",
            "priority": "Medium",
            "guid": "6f158e3e-a3a9-42c2-be7e-2165c3a87af4",
            "description": "Manage system node pools in Azure Kubernetes Service (AKS) and add taint to your system nodepool to make it dedicated",
            "documentation": [
                {
                    "title": "AKS System Pools",
                    "url": "https://docs.microsoft.com/azure/aks/use-system-pools"
                }
            ],
            "tags": [
                "all",
                "compliance",
                "operations"
            ],
            "optionalFields": {
                "score": {
                    "simple": -1,
                    "cost": -1,
                    "graph": "where type=='microsoft.containerservice/managedclusters' | project id,resourceGroup,name,pools=properties.agentPoolProfiles | project id,name,resourceGroup,poolcount=array_length(pools) | extend compliant = (poolcount > 1)",
                    "security": 1
                }
            },
            "category": "Cluster_Security",
            "service": "AKS",
            "waf": "Security",
            "subcategory": "Compliance",
            "graph": "where type=='microsoft.containerservice/managedclusters' | project id,resourceGroup,name,pools=properties.agentPoolProfiles | project id,name,resourceGroup,poolcount=array_length(pools) | extend compliant = (poolcount > 1)"
        },
        {
            "title": "If user Service Principals for the cluster, refresh credentials periodically (like quarterly)",
            "priority": "High",
            "guid": "b03dda6d-58d7-4c89-8ddb-107d5769ae66",
            "description": "You may want to update, or rotate, the credentials as part of a defined security polic",
            "documentation": [
                {
                    "title": "Update or rotate the credentials for AKS",
                    "url": "https://docs.microsoft.com/azure/aks/update-credentials"
                }
            ],
            "tags": [
                "all",
                "secrets"
            ],
            "optionalFields": {
                "score": {
                    "security": 1
                }
            },
            "category": "Cluster_Security",
            "service": "AKS",
            "waf": "Security",
            "subcategory": "Secrets"
        },
        {
            "title": "Use a private registry for your images, such as ACR",
            "priority": "High",
            "guid": "55b46a94-8008-4ae7-b7e4-b475b6c8bdbf",
            "description": "Azure Container Registry allows you to build, store, and manage container images and artifacts in a private registry",
            "documentation": [
                {
                    "title": "Azure Container Registry documentation",
                    "url": "https://docs.microsoft.com/azure/container-registry/"
                }
            ],
            "tags": [
                "all",
                "compliance"
            ],
            "optionalFields": {
                "score": {
                    "simple": -1,
                    "security": 1
                }
            },
            "category": "Cluster_Security",
            "service": "AKS",
            "waf": "Security",
            "subcategory": "Compliance"
        },
        {
            "title": "Use Azure Security Center to detect security posture vulnerabiities",
            "priority": "Medium",
            "guid": "cc639637-a652-42ac-89e8-06965388e9de",
            "description": "Microsoft Defender for Containers is the cloud-native solution that is used to secure your containers ",
            "documentation": [
                {
                    "title": "Overview of Microsoft Defender for Containers",
                    "url": "https://docs.microsoft.com/azure/security-center/container-security"
                }
            ],
            "tags": [
                "all",
                "compliance"
            ],
            "optionalFields": {
                "score": {
                    "cost": -1,
                    "security": 1
                }
            },
            "category": "Cluster_Security",
            "service": "AKS",
            "waf": "Security",
            "subcategory": "Compliance"
        },
        {
            "title": "If required consider using Confidential Compute for AKS",
            "priority": "Low",
            "guid": "ec8e4e42-0344-41b0-b865-9123e8956d31",
            "description": "Containers run within a Trusted Execution Environment(TEE) brings isolation from other containers, the node kernel in a hardware protected, integrity protected attestable environment.",
            "documentation": [
                {
                    "title": "Application enclave support on AKS",
                    "url": "https://learn.microsoft.com/en-us/azure/confidential-computing/confidential-nodes-aks-overview"
                }
            ],
            "tags": [
                "all",
                "compliance"
            ],
            "optionalFields": {
                "score": {
                    "cost": -1,
                    "security": 1
                }
            },
            "category": "Cluster_Security",
            "service": "AKS",
            "waf": "Security",
            "subcategory": "Secrets"
        },
        {
            "title": "Define app separation requirements (namespace/nodepool/cluster)",
            "priority": "High",
            "guid": "d167dd18-2b0a-4c24-8b99-9a646f8389a7",
            "description": "Plan for multi-tenant clusters and separation of resources and use logical or physical isolation in your AKS clusters",
            "documentation": [
                {
                    "title": "Best practices for cluster isolation in AKS",
                    "url": "https://docs.microsoft.com/azure/aks/operator-best-practices-cluster-isolation"
                }
            ],
            "tags": [
                "all",
                "compliance"
            ],
            "optionalFields": {
                "score": {
                    "security": 1
                }
            },
            "category": "Cluster_Security",
            "service": "AKS",
            "waf": "Security",
            "subcategory": "Compliance"
        },
        {
            "title": "If required consider using Azure Dedicated Hosts for AKS nodes",
            "priority": "Low",
            "guid": "5ae124ba-34df-4585-bcdc-e9bd3bb0cdb3",
            "description": "Plan for multi-tenant clusters and separation of resources and use logical or physical isolation in your AKS clusters",
            "documentation": [
                {
                    "title": "Add Azure Dedicated Host to an AKS cluster",
                    "url": "https://learn.microsoft.com/en-us/azure/aks/use-azure-dedicated-hosts"
                }
            ],
            "tags": [
                "all",
                "compliance"
            ],
            "optionalFields": {
                "score": {
                    "cost": 1
                }
            },
            "category": "Cluster_Security",
            "service": "AKS",
            "waf": "Security",
            "subcategory": "Scalability"
        },
        {
            "title": "Scan the container image against vulnerabilities",
            "priority": "High",
            "guid": "59bce65d-e8a0-43f9-9879-468d66a786d6",
            "description": "Scan your container images to ensure there are no vulnerabilities in it",
            "documentation": [
                {
                    "title": "Azure Security Center : scanning feature (Qualys)",
                    "url": "https://docs.microsoft.com/azure/security-center/azure-container-registry-integration"
                },
                {
                    "title": "Identify vulnerable container images in your CI/CD workflows",
                    "url": "https://docs.microsoft.com/azure/defender-for-cloud/defender-for-containers-cicd"
                }
            ],
            "tools": [
                {
                    "title": "Prisma (ex Twistlock)",
                    "url": "https://www.twistlock.com/"
                },
                {
                    "title": "Anchore",
                    "url": "https://anchore.com/"
                },
                {
                    "title": "Clair",
                    "url": "https://github.com/quay/clair"
                }
            ],
            "tags": [
                "all",
                "security"
            ],
            "optionalFields": {
                "score": {
                    "cost": -1,
                    "security": 1
                }
            },
            "category": "Container",
            "service": "AKS",
            "subcategory": "Compliance",
            "waf": "Security"
        },
        {
            "title": "Allow deploying containers only from known registries",
            "guid": "8dcb9d27-a601-48e6-aeb8-e0469aaf8921",
            "priority": "Medium",
            "description": "One of the most common custom policies that you might want to consider is to restrict the images that can be deployed in your cluster. But it can also be addressed with a proper egress lockdown or using an admission controller",
            "documentation": [
                {
                    "title": "Use the Azure Policy : Ensure only allowed container images in AKS",
                    "url": "https://docs.microsoft.com/azure/governance/policy/concepts/rego-for-aks#built-in-policies"
                },
                {
                    "title": "Using ImagePolicyWebhook",
                    "url": "https://kubernetes.io/docs/reference/access-authn-authz/admission-controllers/#imagepolicywebhook"
                },
                {
                    "title": "Using egress lockdown and authorizing only the URL of your registry",
                    "url": "https://docs.microsoft.com/azure/aks/limit-egress-traffic"
                }
            ],
            "tags": [
                "all",
                "security"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Container",
            "service": "AKS"
        },
        {
            "title": "Runtime Security of Applications",
            "guid": "a71e024f-ac46-4d0e-86d8-fad9a86c99af",
            "priority": "High",
            "description": "Integrate Runtime Security for your pods.  To complete the defense in depth structure, ensure Runtime protection is in place to protect from process, network, storage and system call attacks.",
            "tools": [
                {
                    "title": "Prisma Runtime defense",
                    "url": "https://docs.paloaltonetworks.com/prisma/prisma-cloud/prisma-cloud-admin-compute/runtime_defense.html"
                },
                {
                    "title": "Falco",
                    "url": "https://falco.org"
                }
            ],
            "tags": [
                "all",
                "security"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Container",
            "service": "AKS"
        },
        {
            "title": "Quarantine of Docker Images in Docker Registries that have discovered issues",
            "guid": "c970cb26-a707-4bf2-9e40-5401fea3d55b",
            "priority": "High",
            "description": "Use policy to protect images from drift while in the registry, on both push and pull.",
            "detail": "On build, the image is secured based on the threshold set, but now while in the registry a new issue is discovered.  You need to ensure that the image can not be deployed until the issue is remediated.",
            "documentation": [
                {
                    "title": "ACR Quarantine",
                    "url": "https://github.com/Azure/acr/tree/master/docs/preview/quarantine"
                }
            ],
            "tags": [
                "all",
                "security"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Container",
            "service": "AKS"
        },
        {
            "title": "Role-Based Access Contol (RBAC) to Docker Registries",
            "guid": "3f703579-9f4a-43c4-8c40-5a9e78015379",
            "priority": "High",
            "description": "The Azure Container Registry service supports a set of built-in Azure roles that provide different levels of permissions to an Azure container registry. Use Azure role-based access control (RBAC) to assign specific permissions to users, service principals, or other identities that need to interact with a registry.",
            "documentation": [
                {
                    "title": "Azure Container Registry roles and permissions",
                    "url": "https://docs.microsoft.com/azure/container-registry/container-registry-roles"
                }
            ],
            "tags": [
                "all",
                "security"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Container",
            "service": "AKS"
        },
        {
            "title": "Network Segmentation of Docker Registries",
            "guid": "6ae51d09-8142-4979-95ed-7ec3451de81c",
            "priority": "High",
            "description": "Limit access to a registry by assigning virtual network private IP addresses to the registry endpoints and using Azure Private Link. Network traffic between the clients on the virtual network and the registry's private endpoints traverses the virtual network and a private link on the Microsoft backbone network, eliminating exposure from the public internet. Private Link also enables enables private registry access from on-premises through Azure ExpressRoute private peering or a VPN gateway.",
            "documentation": [
                {
                    "title": "Azure Container Registry Private Link",
                    "url": "https://docs.microsoft.com/azure/container-registry/container-registry-private-link"
                }
            ],
            "tags": [
                "all",
                "security",
                "network"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Container",
            "service": "AKS"
        },
        {
            "title": "Prefer distroless images",
            "guid": "f57ba3a5-93ae-435f-9468-80ccd6a841b9",
            "priority": "Medium",
            "description": "When building a docker image, try to use the distroless version of the base OS image, to reduce the risk of vulnerabilities with preinstalled but unused tools. From example, use base-debian10 instead of debian10",
            "detail": "'Distroless' images are bare-bones versions of common base images. They have the bare-minimum needed to execute a binary.The shell and other developer utilities have been removed so that if/when an attacker gains control of your container, they can't do much of anything",
            "documentation": [
                {
                    "title": "Google distroless images",
                    "url": "https://github.com/GoogleContainerTools/distroless"
                }
            ],
            "tags": [
                "all",
                "security"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Container",
            "service": "AKS"
        },
        {
            "title": "Refresh container when base image is updated",
            "guid": "22882284-a9c2-4e16-b3e3-2d4947cc24b8",
            "priority": "Low",
            "description": "As you use base images for application images, use automation to build new images when the base image is updated. As those base images typically include security fixes, update any downstream application container images.",
            "documentation": [
                {
                    "title": "Automatically build new images on base image update",
                    "url": "https://docs.microsoft.com/azure/aks/operator-best-practices-container-image-management#automatically-build-new-images-on-base-image-update"
                },
                {
                    "title": "Azure DevOps - Trigger pipeline from Docker image update",
                    "url": "https://dev.to/larryclaman/trigger-azure-devops-build-pipeline-from-docker-image-update-5d3i"
                }
            ],
            "tags": [
                "all",
                "resources"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Container",
            "service": "AKS"
        },
        {
            "title": "Integrate authentication with AAD (using the managed integration)",
            "priority": "High",
            "guid": "7e42c78e-78c0-46a6-8a21-94956e698dc4",
            "severity": "Medium",
            "description": "Azure Kubernetes Service (AKS) can be configured to use Azure Active Directory (Azure AD) for user authentication. In this configuration, you can sign in to an AKS cluster by using your Azure AD authentication token.",
            "documentation": [
                {
                    "title": "AKS-managed Azure Active Directory integration",
                    "url": "https://docs.microsoft.com/azure/aks/managed-aad"
                },
                {
                    "title": "Disable local accounts",
                    "url": "https://docs.microsoft.com/azure/aks/managed-aad#disable-local-accounts"
                }
            ],
            "tags": [
                "all",
                "security",
                "identity"
            ],
            "optionalFields": {
                "score": {
                    "simple": 1,
                    "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = isnotnull(properties.aadProfile) | distinct id,compliant"
                }
            },
            "category": "Identity",
            "service": "AKS",
            "waf": "Security",
            "subcategory": "Identity",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = isnotnull(properties.aadProfile) | distinct id,compliant"
        },
        {
            "title": "Integrate authorization with AAD RBAC",
            "priority": "High",
            "guid": "eec4962c-c3bd-421b-b77f-26e5e6b3bec3",
            "description": "Control access to cluster resources using Kubernetes role-based access control and Azure Active Directory identities in Azure Kubernetes Service",
            "documentation": [
                {
                    "title": "Limit cluster access via K8S RBAC for users & workloads",
                    "url": "https://docs.microsoft.com/azure/aks/azure-ad-rbac"
                }
            ],
            "tags": [
                "all",
                "security",
                "identity"
            ],
            "optionalFields": {
                "score": {
                    "simple": -1,
                    "security": 1
                }
            },
            "category": "Identity",
            "service": "AKS",
            "waf": "Security",
            "subcategory": "Identity"
        },
        {
            "title": "Use AKS and ACR integration without password",
            "guid": "100f8f70-3ec6-44bb-ab07-95eef965e80d",
            "priority": "Medium",
            "description": "AKS can authenticate to ACR without using any password, but by using either Service Principal or Managed Identity.",
            "detail": "For AKS to download/pull images from Azure Container Registry (ACR), it needs the ACR credentials including the password. To avoid saving the password in the cluster, you can simply activate the ACR integration on new or existing AKS cluster using SPN or Managed Identity",
            "documentation": [
                {
                    "title": "Authenticate with Azure Container Registry from AKS",
                    "url": "https://docs.microsoft.com/azure/aks/cluster-container-registry-integration"
                }
            ],
            "tags": [
                "all",
                "security",
                "identity"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Identity",
            "service": "AKS",
            "waf": "Security"
        },
        {
            "title": "Use managed identities instead of Service Principals",
            "priority": "High",
            "guid": "ed127dd1-42b0-46b2-8c69-99a646f3389a",
            "description": "Each AKS cluster needs either a Managed Identity or Service Principal.  We recommend using Managed Identity in AKS",
            "documentation": [
                {
                    "title": "Use managed identities in Azure Kubernetes Service",
                    "url": "https://docs.microsoft.com/azure/aks/use-managed-identity"
                }
            ],
            "tags": [
                "all",
                "security",
                "identity"
            ],
            "optionalFields": {
                "score": {
                    "simple": 1,
                    "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (properties.servicePrincipalProfile.clientId=='msi') | distinct id,compliant"
                }
            },
            "category": "Identity",
            "service": "AKS",
            "waf": "Security",
            "subcategory": "Identity",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (properties.servicePrincipalProfile.clientId=='msi') | distinct id,compliant"
        },
        {
            "title": "Limit access to admin kubeconfig (get-credentials --admin)",
            "priority": "Medium",
            "guid": "a2fe27b2-e287-401a-8352-beedf79b488d",
            "description": "To limit who can get that Kubernetes configuration (kubeconfig) information and to limit the permissions they then have, you can use Azure role-based access control (Azure RBAC).",
            "documentation": [
                {
                    "title": "Use Azure RBAC to define access to the Kubernetes configuration file",
                    "url": "https://docs.microsoft.com/azure/aks/control-kubeconfig-access"
                }
            ],
            "tags": [
                "all",
                "security",
                "identity"
            ],
            "optionalFields": {
                "score": {
                    "simple": -1,
                    "security": 1
                }
            },
            "category": "Identity",
            "service": "AKS",
            "waf": "Security",
            "subcategory": "Identity"
        },
        {
            "title": "For AKS non-interactive logins use kubelogin",
            "priority": "Medium",
            "guid": "f4dcf690-1b30-407d-abab-6f8aa780d3a3",
            "description": " You can use kubelogin to access the cluster with non-interactive service principal sign-in.",
            "documentation": [
                {
                    "title": "Non-interactive sign in with kubelogin",
                    "url": "https://learn.microsoft.com/en-us/azure/aks/managed-aad#non-interactive-sign-in-with-kubelogin"
                }
            ],
            "tags": [
                "all",
                "identity",
                "security"
            ],
            "optionalFields": {
                "score": {
                    "simple": -1,
                    "security": 1
                }
            },
            "category": "Identity",
            "service": "AKS",
            "waf": "Security",
            "subcategory": "Identity"
        },
        {
            "title": "Disable AKS local accounts",
            "priority": "Medium",
            "guid": "b085b1f2-3119-4771-8c9a-bbf4411810ec",
            "description": "AKS offers users the ability to disable local accounts via a flag, disable-local-accounts",
            "documentation": [
                {
                    "title": "Disable local accounts",
                    "url": "https://learn.microsoft.com/azure/aks/managed-aad#disable-local-accounts"
                }
            ],
            "tags": [
                "all",
                "identity",
                "security"
            ],
            "optionalFields": {
                "score": {
                    "simple": -1,
                    "security": 1
                }
            },
            "category": "Identity",
            "service": "AKS",
            "waf": "Security",
            "subcategory": "Identity",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (properties.disableLocalAccounts==true) | distinct id,compliant"
        },
        {
            "title": "Configure if required Just-in-time cluster access",
            "priority": "Low",
            "guid": "36abb0db-c118-4f4c-9880-3f30f9a2deb6",
            "description": "AKS offers users the ability to enable access for a limited time",
            "documentation": [
                {
                    "title": "Configure just-in-time cluster access with Azure AD and AKS",
                    "url": "https://learn.microsoft.com/azure/aks/managed-aad#configure-just-in-time-cluster-access-with-azure-ad-and-aks"
                }
            ],
            "tags": [
                "all",
                "identity",
                "security"
            ],
            "optionalFields": {
                "score": {
                    "simple": -1,
                    "security": 1
                }
            },
            "category": "Identity",
            "service": "AKS",
            "waf": "Security",
            "subcategory": "Identity"
        },
        {
            "title": "For finer control consider using a managed Kubelet Identity",
            "priority": "Low",
            "guid": "1f711a74-3672-470b-b8b8-a2148d640d79",
            "description": "A Kubelet identity enables access granted to the existing identity prior to cluster creation.",
            "documentation": [
                {
                    "title": "Use a pre-created kubelet managed identity",
                    "url": "https://learn.microsoft.com/azure/aks/use-managed-identity#use-a-pre-created-kubelet-managed-identity"
                }
            ],
            "tags": [
                "all",
                "identity",
                "security"
            ],
            "optionalFields": {
                "score": {
                    "simple": -1,
                    "security": 1
                }
            },
            "category": "Identity",
            "service": "AKS",
            "waf": "Security",
            "subcategory": "Identity"
        },
        {
            "title": "Configure if required AAD conditional access for AKS",
            "priority": "Low",
            "guid": "c4d7f4c6-79bf-45d0-aa05-ce8fc717e150",
            "description": "When integrating Azure AD with your AKS cluster, you can also use Conditional Access to control access to your cluster.",
            "documentation": [
                {
                    "title": "Use Conditional Access with Azure AD and AKS",
                    "url": "https://learn.microsoft.com/azure/aks/managed-aad#use-conditional-access-with-azure-ad-and-aks"
                }
            ],
            "tags": [
                "all",
                "identity",
                "security"
            ],
            "optionalFields": {
                "score": {
                    "security": 1,
                    "simple": -1
                }
            },
            "category": "Identity",
            "service": "AKS",
            "waf": "Security",
            "subcategory": "Identity"
        },
        {
            "title": "Choose the best CNI network plugin for your requirements (Azure CNI recommended)",
            "priority": "Medium",
            "guid": "a0f61565-9de5-458f-a372-49c831112dbd",
            "description": "For integration with existing virtual networks or on-premises networks, use Azure CNI networking in AKS. This network model also allows greater separation of resources and controls in an enterprise environment but be aware of the impact on the network topology/IP ranges. You can now use the CNI overlay model which gives more control and takes the benefits of both approachs.",
            "detail": "While Kubenet is the default Kubernetes network plugin, the Container Networking Interface (CNI) is a vendor-neutral protocol that lets the container runtime make requests to a network provider. The Azure CNI assigns IP addresses to pods and nodes, and provides IP address management (IPAM) features as you connect to existing Azure virtual networks. Each node and pod resource receives an IP address in the Azure virtual network, and no additional routing is needed to communicate with other resources or services.",
            "documentation": [
                {
                    "title": "Kubenet vs CNI",
                    "url": "https://docs.microsoft.com/azure/aks/operator-best-practices-network#choose-the-appropriate-network-model"
                },
                {
                    "title": "Dynamic IP allocation",
                    "url": "https://docs.microsoft.com/azure/aks/configure-azure-cni#dynamic-allocation-of-ips-and-enhanced-subnet-support"
                },
                {
                    "title": "Azure CNI Overlay",
                    "url": "https://learn.microsoft.com/azure/aks/azure-cni-overlay"
                },
                {
                    "title": "Bring your own CNI",
                    "url": "https://docs.microsoft.com/azure/aks/use-byo-cni"
                },
                {
                    "title": "Add a node pool with a unique subnet",
                    "url": "https://docs.microsoft.com/azure/aks/use-multiple-node-pools#add-a-node-pool-with-a-unique-subnet"
                }
            ],
            "tags": [
                "all",
                "network"
            ],
            "optionalFields": {
                "score": {
                    "simple": 1,
                    "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (properties.networkProfile.networkPlugin=='azure') | distinct id,compliant"
                }
            },
            "category": "Networking",
            "service": "AKS",
            "subcategory": "IPAM",
            "waf": "Reliability",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (properties.networkProfile.networkPlugin=='azure') | distinct id,compliant"
        },
        {
            "title": "If using Azure CNI, size your subnet accordingly considering the maximum number of pods per node",
            "priority": "High",
            "guid": "7faf12e7-0943-4f63-8472-2da29c2b1cd6",
            "description": "The size of your virtual network and its subnet must accommodate the number of pods you plan to run and the number of nodes for the cluster.",
            "detail": "As an example, using CNI, you need one IP for each node + one spare for a new node in case of cluster upgrade, and you need an IP for each pod which can represent hundred of IP addresses",
            "documentation": [
                {
                    "title": "Plan IP addressing for your cluster",
                    "url": "https://docs.microsoft.com/azure/aks/configure-azure-cni#plan-ip-addressing-for-your-cluster"
                }
            ],
            "tags": [
                "all",
                "network"
            ],
            "optionalFields": {
                "score": {
                    "scale": 1
                }
            },
            "category": "Networking",
            "service": "AKS",
            "subcategory": "IPAM",
            "waf": "Performance"
        },
        {
            "title": "Use an ingress controller to expose web-based apps instead of exposing them with LoadBalancer-type services",
            "priority": "Medium",
            "guid": "b3808b9f-a1cf-4204-ad01-3a923ce474db",
            "description": "To distribute HTTP or HTTPS traffic to your applications, use ingress resources and controllers. Ingress controllers provide additional features over a regular Azure load balancer, and can be managed as native Kubernetes resources.",
            "documentation": [
                {
                    "title": "Application routing add-on for Azure Kubernetes Service (AKS)",
                    "url": "https://aka.ms/aks/docs/app-routing"
                },
                {
                    "title": "Distribute ingress traffic",
                    "url": "https://docs.microsoft.com/azure/aks/operator-best-practices-network#distribute-ingress-traffic"
                },
                {
                    "title": "Network concepts: Ingress controllers",
                    "url": "https://learn.microsoft.com/en-us/azure/aks/concepts-network#ingress-controllers"
                }
            ],
            "tags": [
                "all",
                "network"
            ],
            "optionalFields": {
                "score": {
                    "scale": 1,
                    "simple": -1
                }
            },
            "category": "Networking",
            "service": "AKS",
            "subcategory": "Scalability",
            "waf": "Reliability"
        },
        {
            "title": "Secure your exposed applications with a web application firewall (WAF)",
            "priority": "Medium",
            "guid": "a3a92c2d-e7e2-4165-a3a8-7af4a7a1f893",
            "description": "If you plan to host exposed applications, to scan incoming traffic for potential attacks, use a web application firewall (WAF) such as Barracuda WAF for Azure or Azure Application Gateway. These more advanced network resources can also route traffic beyond just HTTP and HTTPS connections or basic SSL termination.",
            "documentation": [
                {
                    "title": "Secure traffic with a web application firewall (WAF)",
                    "url": "https://docs.microsoft.com/azure/aks/operator-best-practices-network#secure-traffic-with-a-web-application-firewall-waf"
                }
            ],
            "tags": [
                "all",
                "network"
            ],
            "optionalFields": {
                "score": {
                    "simple": -1,
                    "cost": -1,
                    "security": 2
                }
            },
            "category": "Networking",
            "service": "AKS",
            "subcategory": "Security",
            "waf": "Security"
        },
        {
            "title": "Apply control on ingress hostnames",
            "guid": "e5684a8b-f072-43d2-83b2-234ad48f57c7",
            "priority": "Low",
            "description": "When a user creates an Ingress manifest, they can use any hostname in it. You may want to control which hostnames are allowed to use, like your company's hostnames.",
            "documentation": [
                {
                    "title": "Tutorial: only allow approved domain names as ingress hostnames",
                    "url": "https://www.openpolicyagent.org/docs/latest/kubernetes-tutorial/#4-define-a-policy-and-load-it-into-opa-via-kubernetes"
                }
            ],
            "tags": [
                "all",
                "security",
                "network"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Networking",
            "service": "AKS"
        },
        {
            "title": "Don't expose your load-balancer on Internet if not necessary",
            "guid": "c0179fd4-470b-43c8-b7bb-80307051bc96",
            "priority": "High",
            "description": "There is almost no reason to directly expose the ingress entry point to Internet but by default AKS create a public one. Tell him to create an internal one only.",
            "documentation": [
                {
                    "title": "Create an ingress controller to an internal virtual network",
                    "url": "https://docs.microsoft.com/azure/aks/ingress-internal-ip"
                }
            ],
            "tags": [
                "all",
                "security",
                "network"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Networking",
            "service": "AKS"
        },
        {
            "title": "Control traffic flow with network policies",
            "guid": "0751f099-e6f4-4250-b405-d2b26c707432",
            "priority": "Medium",
            "severity": "High",
            "description": "Use network policies to allow or deny traffic to pods. By default, all traffic is allowed between pods within a cluster. For improved security, define rules that limit pod communication.",
            "detail": "Network policy is a Kubernetes feature that lets you control the traffic flow between pods. You can choose to allow or deny traffic based on settings such as assigned labels, namespace, or traffic port. The use of network policies gives a cloud-native way to control the flow of traffic. As pods are dynamically created in an AKS cluster, the required network policies can be automatically applied. Don't use Azure network security groups to control pod-to-pod traffic, use network policies.",
            "documentation": [
                {
                    "title": "Enable a Kubernetes Network Policy option (Calico/Azure)",
                    "url": "https://docs.microsoft.com/azure/aks/operator-best-practices-network#control-traffic-flow-with-network-policies"
                },
                {
                    "title": "Secure traffic between pods using network policies",
                    "url": "https://docs.microsoft.com/azure/aks/use-network-policies"
                }
            ],
            "tools": [
                {
                    "title": "Calico",
                    "url": "https://docs.projectcalico.org/reference/resources/networkpolicy"
                },
                {
                    "title": "Cillium",
                    "url": "https://cilium.io/"
                }
            ],
            "tags": [
                "all",
                "security",
                "network",
                "multi-tenancy"
            ],
            "optionalFields": {
                "score": {
                    "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = isnotnull(properties.networkProfile.networkPolicy) | distinct id,compliant",
                    "security": 1
                }
            },
            "category": "Networking",
            "service": "AKS"
        },
        {
            "title": "Configure default network policies in each namespace",
            "guid": "0bc4e0c6-97fd-411a-9eb4-1a1f85f9cdf0",
            "priority": "Medium",
            "description": "Start by creating a deny all policy in each namespace and then add specific policies.",
            "documentation": [
                {
                    "title": "Recipes of best default network policies",
                    "url": "https://github.com/ahmetb/kubernetes-network-policy-recipes"
                },
                {
                    "title": "Callico global network policy",
                    "url": "https://projectcalico.docs.tigera.io/reference/resources/globalnetworkpolicy"
                }
            ],
            "tags": [
                "all",
                "security",
                "multi-tenancy",
                "network"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Networking",
            "service": "AKS"
        },
        {
            "title": "Filter egress traffic with AzFW/NVA if your security requirements mandate it (egress lockdown)",
            "priority": "Medium",
            "guid": "3b365a91-7ecb-4e48-bbe5-4cd7df2e8bba",
            "severity": "High",
            "description": "Use Azure Firewall to secure and control all egress traffic going outside of the cluster.",
            "documentation": [
                {
                    "title": "Egress traffic requirements",
                    "url": "https://docs.microsoft.com/azure/aks/limit-egress-traffic"
                }
            ],
            "tags": [
                "all",
                "security",
                "network"
            ],
            "optionalFields": {
                "score": {
                    "simple": -2,
                    "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (properties.networkProfile.outboundType=='userDefinedRouting') | distinct id,compliant",
                    "security": 2
                }
            },
            "category": "Networking",
            "service": "AKS",
            "subcategory": "Security",
            "waf": "Security",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (properties.networkProfile.outboundType=='userDefinedRouting') | distinct id,compliant"
        },
        {
            "title": "Don't expose your container registry on Internet",
            "guid": "e38f1680-8ddc-4c93-bf09-6b932a4935ca",
            "priority": "Low",
            "description": "When possible, use private link to only allow private network to reach your registry.",
            "documentation": [
                {
                    "title": "Azure Container Registry Private Link",
                    "url": "https://docs.microsoft.com/azure/container-registry/container-registry-private-link"
                }
            ],
            "tags": [
                "all",
                "security",
                "network"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Networking",
            "service": "AKS"
        },
        {
            "title": "Block Pod access to VMSS IMDS",
            "guid": "4fb072a7-0303-46d8-9ecf-d8aa4d69ff83",
            "priority": "Medium",
            "description": "By default, Pods have access to VMSS IMDS and can request access token from the attached Managed Identity. This access should be restriced by using Network Policy.",
            "documentation": [
                {
                    "title": "Pods requesting access to get a token",
                    "url": "https://docs.microsoft.com/azure/active-directory/managed-identities-azure-resources/how-to-use-vm-token#get-a-token-using-curl"
                }
            ],
            "tags": [
                "all",
                "security",
                "network"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Networking",
            "service": "AKS"
        },
        {
            "title": "Use private clusters if your requirements mandate it",
            "guid": "29fb411c-20a8-4c39-84df-aaa4227eaeb2",
            "priority": "High",
            "description": "In a private cluster, the control plane or API server has internal IP addresses and is not exposed to Internet",
            "detail": "By using a private cluster, you can ensure that network traffic between your API server and your node pools remains on the private network only. Because the API server has a private address, it means that to access it for administration or for deployment, you need to set up private connection, like using a 'jumpbox' (i.e.: Azure Bastion)",
            "documentation": [
                {
                    "title": "Create a private cluster (using private link)",
                    "url": "https://docs.microsoft.com/azure/aks/private-clusters"
                },
                {
                    "title": "Create an Azure Kubernetes Service cluster with API Server VNet Integration (preview)",
                    "url": "https://learn.microsoft.com/en-us/azure/aks/api-server-vnet-integration"
                },
                {
                    "title": "Use azure CLI to run command on a private cluster",
                    "url": "https://docs.microsoft.com/azure/aks/private-clusters#options-for-connecting-to-the-private-cluster"
                },
                {
                    "title": "Use public DNS with a private cluster",
                    "url": "https://docs.microsoft.com/azure/aks/private-clusters#create-a-private-aks-cluster-with-a-public-dns-address"
                }
            ],
            "tags": [
                "all",
                "security",
                "network"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Networking",
            "service": "AKS"
        },
        {
            "title": "Enable traffic management",
            "guid": "5d0bb60d-b8e0-4031-9c5b-1f0a735f771f",
            "priority": "Medium",
            "description": "Azure Traffic Manager can direct customers to their closest AKS cluster and application instance. For the best performance and redundancy, direct all application traffic through Traffic Manager before it goes to your AKS cluster.",
            "detail": "If you have multiple AKS clusters in different regions, use Traffic Manager to control how traffic flows to the applications that run in each cluster. Azure Traffic Manager is a DNS-based traffic load balancer that can distribute network traffic across regions. Use Traffic Manager to route users based on cluster response time or based on geography. It can be used to improve app availability with automatic failover",
            "documentation": [
                {
                    "title": "Use Azure Traffic Manager to route traffic",
                    "url": "https://docs.microsoft.com/azure/aks/operator-best-practices-multi-region#use-azure-traffic-manager-to-route-traffic"
                }
            ],
            "tags": [
                "all",
                "network",
                "resiliency",
                "multi-tenancy"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Networking",
            "service": "AKS"
        },
        {
            "title": "If using Azure CNI, check the maximum pods/node (default 30)",
            "priority": "High",
            "guid": "22f54b29-bade-43aa-b1e8-c38ec9366673",
            "description": "With Azure Container Networking Interface (CNI), every pod gets an IP address from the subnet and can be accessed directly.",
            "detail": "These IP addresses must be unique across your network space, and must be planned in advance. Each node has a configuration parameter for the maximum number of pods that it supports. ",
            "documentation": [
                {
                    "title": "Configure Azure CNI networking on AKS",
                    "url": "https://docs.microsoft.com/azure/aks/configure-azure-cni"
                }
            ],
            "tags": [
                "all",
                "IPAM",
                "network"
            ],
            "optionalFields": {
                "score": {
                    "scale": 1,
                    "simple": -1
                }
            },
            "category": "Networking",
            "service": "AKS",
            "subcategory": "IPAM",
            "waf": "Performance"
        },
        {
            "title": "If using a public API endpoint, restrict the IP addresses that can access it",
            "guid": "d783a3e8-264f-4dac-870f-569791d1837e",
            "priority": "Medium",
            "description": "To improve the security of your clusters and minimize the risk of attacks, we recommend limiting the IP address ranges that can access the API server.",
            "documentation": [
                {
                    "title": "Secure access to the API server using authorized IP address ranges",
                    "url": "https://docs.microsoft.com/azure/aks/api-server-authorized-ip-ranges"
                }
            ],
            "tags": [
                "all",
                "security",
                "network"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Networking",
            "service": "AKS"
        },
        {
            "title": "Use Azue NAT Gateway as outboundType for scaling egress traffic",
            "priority": "Medium",
            "guid": "ccb534e7-416e-4a1d-8e93-533b53199085",
            "description": "Whilst AKS customers are able to route egress traffic through an Azure Load Balancer, there are limitations on the amount of outbound flows of traffic that is possible.",
            "documentation": [
                {
                    "title": "Managed NAT Gateway",
                    "url": "https://learn.microsoft.com/azure/aks/nat-gateway"
                }
            ],
            "tags": [
                "all",
                "scalability",
                "network"
            ],
            "optionalFields": {
                "score": {
                    "scale": 1,
                    "simple": -1
                }
            },
            "category": "Networking",
            "service": "AKS",
            "subcategory": "Scalability",
            "waf": "Reliability"
        },
        {
            "title": "Use Dynamic allocations of IPs in order to avoid Azure CNI IP exhaustion",
            "priority": "Medium",
            "guid": "8ee9a69a-1b58-4b1e-9c61-476e110a160b",
            "description": "A drawback with the traditional CNI is the exhaustion of pod IP addresses as the AKS cluster grows, resulting in the need to rebuild the entire cluster in a bigger subnet.",
            "detail": "The new dynamic IP allocation capability in Azure CNI solves this problem by allocating pod IPs from a subnet separate from the subnet hosting the AKS cluster.",
            "documentation": [
                {
                    "title": "Dynamic allocation of IPs and enhanced subnet support",
                    "url": "https://learn.microsoft.com/azure/aks/configure-azure-cni#dynamic-allocation-of-ips-and-enhanced-subnet-support"
                }
            ],
            "tags": [
                "all",
                "scalability",
                "network"
            ],
            "optionalFields": {
                "score": {
                    "scale": 1,
                    "simple": -1
                }
            },
            "category": "Networking",
            "service": "AKS",
            "subcategory": "Scalability",
            "waf": "Reliability"
        },
        {
            "title": "If using AGIC, do not share an AppGW across clusters",
            "priority": "Medium",
            "guid": "cbd8ac2a-aebc-4a2a-94da-1dbf3dc99248",
            "description": "The App Gateway Ingress Controller (AGIC) is a pod within your Kubernetes cluster. AGIC monitors the Kubernetes Ingress resources, and creates and applies App Gateway config based on these.",
            "documentation": [
                {
                    "title": "Application gateway ingress controller",
                    "url": "https://azure.github.io/application-gateway-kubernetes-ingress/setup/install-existing/"
                }
            ],
            "tags": [
                "all",
                "scalability",
                "security",
                "network"
            ],
            "optionalFields": {
                "score": {
                    "simple": -1,
                    "security": 1
                }
            },
            "category": "Networking",
            "service": "AKS",
            "subcategory": "Best practices",
            "waf": "Reliability"
        },
        {
            "title": "Use Private Endpoints (preferred) or Virtual Network Service Endpoints to access PaaS services from the cluster",
            "priority": "Medium",
            "guid": "ecccd979-3b6b-4cda-9b50-eb2eb03dda6d",
            "description": "This will help keep your cluster secure by limiting access from outside the virtual network to Azure PaaS services",
            "documentation": [
                {
                    "title": "What is Azure Private Link?",
                    "url": "https://docs.microsoft.com/azure/private-link/private-link-overview"
                }
            ],
            "tags": [
                "all",
                "security",
                "network"
            ],
            "optionalFields": {
                "score": {
                    "simple": -1,
                    "graph": "where type=='microsoft.containerservice/managedclusters' | where isnotnull(properties.apiServerAccessProfile.enablePrivateCluster) | extend compliant = (properties.apiServerAccessProfile.enablePrivateCluster==true) | distinct id, compliant",
                    "security": 1
                }
            },
            "category": "Networking",
            "service": "AKS",
            "subcategory": "Security",
            "waf": "Security",
            "graph": "where type=='microsoft.containerservice/managedclusters' | where isnotnull(properties.apiServerAccessProfile.enablePrivateCluster) | extend compliant = (properties.apiServerAccessProfile.enablePrivateCluster==true) | distinct id, compliant"
        },
        {
            "title": "Consider using a service mesh for advanced microservice communication management",
            "priority": "Medium",
            "guid": "e9855d04-c3c3-49c9-a6bb-2c12159a114b",
            "description": "A service mesh provides capabilities like traffic management, resiliency, policy, security, strong identity, and observability to your workloads.",
            "documentation": [
                {
                    "title": "About service meshes",
                    "url": "https://learn.microsoft.com/azure/aks/servicemesh-about"
                }
            ],
            "tags": [
                "all",
                "security",
                "network"
            ],
            "optionalFields": {
                "score": {
                    "simple": -2,
                    "security": 1
                }
            },
            "category": "Networking",
            "service": "AKS",
            "subcategory": "Security",
            "waf": "Security"
        },
        {
            "title": "If required add your own CNI plugin",
            "priority": "Low",
            "guid": "57bf217f-6dc8-481c-81e2-785773e9c00f",
            "description": "A service mesh provides capabilities like traffic management, resiliency, policy, security, strong identity, and observability to your workloads.",
            "documentation": [
                {
                    "title": "Bring your own Container Network Interface (CNI) plugin for AKS",
                    "url": "https://learn.microsoft.com/azure/aks/servicemesh-about"
                }
            ],
            "tags": [
                "all",
                "operations",
                "security",
                "network"
            ],
            "optionalFields": {
                "score": {
                    "simple": -2,
                    "security": 1
                }
            },
            "category": "Networking",
            "service": "AKS",
            "subcategory": "Operations",
            "waf": "Security"
        },
        {
            "title": "If using Azure CNI, consider using different Subnets for NodePools",
            "priority": "Medium",
            "guid": "22fbe8d6-9b40-47ef-9011-25bb1a555a6b",
            "description": "This can address requirements such as having non-contiguous virtual network address space to split across node pools and other security reasons.",
            "documentation": [
                {
                    "title": "Add a node pool with a unique subnet",
                    "url": "https://learn.microsoft.com/en-us/azure/aks/use-multiple-node-pools#add-a-node-pool-with-a-unique-subnet"
                }
            ],
            "tags": [
                "all",
                "security",
                "network"
            ],
            "optionalFields": {
                "score": {
                    "simple": -2,
                    "security": 1
                }
            },
            "category": "Networking",
            "service": "AKS",
            "subcategory": "Best practices",
            "waf": "Security"
        },
        {
            "title": "Verify non overlapping CIDR ranges for Service-CIDR and Pod-CIDR or Subnet-CIDR",
            "priority": "Medium",
            "guid": "22fbe8d6-9b40-47ef-9011-25bb1a555a6c",
            "description": "The Service CIDR should not overlap with Pod CIDR or Subnet CIDR or even peered VNET CIDR. If not configured correctly, the cluster might have strange behavior.",
            "documentation": [
                {
                    "title": "Pod CIDR, Service CIDR and Subnet CIDR",
                    "url": "https://learn.microsoft.com/en-us/azure/aks/configure-azure-cni#plan-ip-addressing-for-your-cluster"
                },
                {
                    "title": "Use the right CIDR ranges for networking parameters",
                    "url": "https://learn.microsoft.com/en-us/azure/aks/configure-azure-cni#deployment-parameters"
                }
            ],
            "tags": [
                "all",
                "security",
                "network"
            ],
            "optionalFields": {
                "score": {
                    "simple": -2,
                    "security": 1
                }
            },
            "category": "Networking",
            "service": "AKS"
        },
        {
            "title": "Have a regular process to upgrade the cluster node images periodically (weekly, for example), or use the AKS autoupgrade feature",
            "guid": "945889a8-a9e9-4059-b1aa-0a0df2b8a82c",
            "priority": "High",
            "description": "AKS supports upgrading the images on a node so you're up to date with the newest OS and runtime updates. AKS provides one new image per week with the latest updates, so it's beneficial to upgrade your node's images regularly for the latest features, including Linux or Windows patches",
            "detail": "Using automation and this method will ensure that all your nodes are consistently up to date with last features/fixes/patchs, without having to upgrade the kubernetes version. An alternative could be to use Kured to reboot nodes with pending reboots but it will only patch the Operating System, not the AKS layer",
            "documentation": [
                {
                    "title": "Azure Kubernetes Service (AKS) node image upgrades",
                    "url": "https://docs.microsoft.com/azure/aks/node-image-upgrade"
                },
                {
                    "title": "Process Linux node updates and reboots using Kured (not recommended because it can behave incorrectly in some cluster configurations like autoscaling)",
                    "url": "https://docs.microsoft.com/azure/aks/operator-best-practices-cluster-security#process-linux-node-updates-and-reboots-using-kured"
                },
                {
                    "title": "Use Event Grid to know when an upgrade is available",
                    "url": "https://docs.microsoft.com/azure/aks/quickstart-event-grid"
                }
            ],
            "tools": [
                {
                    "title": "Kured (KUbernetes REboot Daemon)",
                    "url": "https://github.com/weaveworks/kured"
                }
            ],
            "tags": [
                "all",
                "security",
                "operations",
                "windows"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Operations",
            "service": "AKS",
            "waf": "Operational Excellence"
        },
        {
            "title": "Use placement proximity group to improve performance",
            "guid": "17bd8ae4-8ee7-472d-bca5-c7e3cc9b6d82",
            "priority": "Low",
            "description": "When deploying your application in Azure, spreading Virtual Machine (VM) instances across regions or availability zones creates network latency, which may impact the overall performance of your application. A proximity placement group is a logical grouping used to make sure Azure compute resources are physically located close to each other",
            "detail": "Be careful, by using PPG on a nodepool, you reduce the average SLA of your application since they don't rely on availability zones anymore",
            "documentation": [
                {
                    "title": "Reduce latency with proximity placement groups",
                    "url": "https://docs.microsoft.com/azure/aks/reduce-latency-ppg"
                }
            ],
            "tags": [
                "all",
                "operations"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Operations",
            "service": "AKS",
            "waf": "Operational Excellence"
        },
        {
            "title": "Customize your clusters with extensions",
            "priority": "Low",
            "guid": "4cd9bd7a-fe6f-427b-b5dd-9ab2f50aa663",
            "description": "Cluster extensions provides an Azure Resource Manager driven experience for installation and lifecycle management of services like Azure Machine Learning (ML) on an AKS cluster. ",
            "detail": "This feature enables:Azure Resource Manager-based deployment of extensions, including at-scale deployments across AKS clusters but also lifecycle management of the extension (Update, Delete) from Azure Resource Manager.",
            "documentation": [
                {
                    "title": "Customize node configuration for Azure Kubernetes Service (AKS) node pools",
                    "url": "https://docs.microsoft.com/en-gb/azure/aks/cluster-extensions"
                }
            ],
            "tags": [
                "all",
                "operations"
            ],
            "optionalFields": {
                "score": {
                    "ha": 1,
                    "cost": -1,
                    "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (isnotnull(properties.austoscalerProfile)) | distinct id,compliant"
                }
            },
            "category": "Operations",
            "service": "AKS",
            "waf": "Operational Excellence"
        },
        {
            "title": "Customize the name of the MC_ resource group",
            "priority": "Low",
            "guid": "73b32a5a-67f7-4a9e-b5b3-1f38c3f39812",
            "description": "When creating a new AKS cluster, the MC_ resource group is created by default. You can customize the name of the MC_ resource group.",
            "documentation": [
                {
                    "title": "Custom resource group name",
                    "url": "https://learn.microsoft.com/en-gb/azure/aks/cluster-configuration#custom-resource-group-name"
                }
            ],
            "tags": [
                "all",
                "operations"
            ],
            "optionalFields": {
                "score": {
                    "simple": 1,
                    "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (properties.nodeResourceGroup !startswith 'MC_') | distinct id,compliant"
                }
            },
            "category": "Operations",
            "service": "AKS",
            "waf": "Operational Excellence",
            "subcategory": "Compliance",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (properties.nodeResourceGroup !startswith 'MC_') | distinct id,compliant"
        },
        {
            "title": "Securely connect to nodes through a bastion host",
            "guid": "28538587-2c1f-4390-b571-384649732c16",
            "priority": "Medium",
            "description": "Don't expose remote connectivity to your AKS nodes. Create a bastion host, or jump box, in a management virtual network. Use the bastion host to securely route traffic into your AKS cluster to remote management tasks.",
            "documentation": [
                {
                    "title": "Securely connect to nodes through a bastion host",
                    "url": "https://docs.microsoft.com/azure/aks/operator-best-practices-network#securely-connect-to-nodes-through-a-bastion-host"
                }
            ],
            "tags": [
                "all",
                "security",
                "operations"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Operations",
            "service": "AKS",
            "waf": "Operational Excellence"
        },
        {
            "title": "Regularly check for cluster issues ",
            "guid": "4dd8b544-5b8b-443d-8e76-cea80d9dec30",
            "priority": "Medium",
            "description": "Regularly run the latest version of cluster scanning open source tool to detect issues in your cluster. For instance, if you apply resource quotas on an existing AKS cluster, run kubestriker first to find pods that don't have resource requests and limits defined.",
            "tools": [
                {
                    "title": "AKS Periscope",
                    "url": "https://github.com/Azure/aks-periscope"
                },
                {
                    "title": "kubestriker",
                    "url": "https://www.kubestriker.io/"
                },
                {
                    "title": "kubebench",
                    "url": "https://github.com/aquasecurity/kube-bench"
                }
            ],
            "tags": [
                "all",
                "operations"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Operations",
            "service": "AKS",
            "waf": "Operational Excellence"
        },
        {
            "title": "Provision a log aggregation tool",
            "guid": "90640e42-ce36-4c2a-b20a-bee9c572df6c",
            "priority": "High",
            "description": "Ensure that you are always aware of what happens in your cluster. Monitor the health of the cluster (nodes, server) but also the pods",
            "documentation": [
                {
                    "title": "Azure Monitor for AKS",
                    "url": "https://docs.microsoft.com/azure/azure-monitor/insights/container-insights-analyze"
                },
                {
                    "title": "Azure Managed Grafana",
                    "url": "https://azure.microsoft.com/services/managed-grafana/"
                }
            ],
            "tools": [
                {
                    "title": "Elastic Cloud",
                    "url": "https://www.elastic.co/elastic-cloud-kubernetes"
                },
                {
                    "title": "Datadog",
                    "url": "https://www.datadoghq.com/"
                }
            ],
            "tags": [
                "all",
                "monitoring",
                "operations"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Operations",
            "service": "AKS",
            "waf": "Operational Excellence"
        },
        {
            "title": "Monitor your cluster metrics with Container Insights (or other tools like Prometheus)",
            "priority": "High",
            "guid": "6f8389a7-f82c-4b8e-a8c0-aa63a25a4956",
            "description": "If default integration can collect telemetry data and basic metrics (CPU/Memory), they don't collect custom metrics and more detailed information. It's often necessary to install a 3rd party software (prometheus is recommend within Kubernetes) and they store these metrics to exploit them.",
            "detail": "Typically, to use Prometheus, you need to set up and manage a Prometheus server with a store. By integrating with Azure Monitor, a Prometheus server is not required. You just need to expose the Prometheus metrics endpoint through your exporters or pods (application), and the containerized agent for Azure Monitor for containers can scrape the metrics for you.",
            "documentation": [
                {
                    "title": "Configure scraping of Prometheus metrics",
                    "url": "https://docs.microsoft.com/azure/azure-monitor/insights/container-insights-prometheus-integration"
                },
                {
                    "title": "Deploying ELK",
                    "url": "https://www.elastic.co/guide/en/cloud-on-k8s/current/k8s-quickstart.html"
                }
            ],
            "tags": [
                "all",
                "monitoring",
                "operations"
            ],
            "optionalFields": {
                "score": {
                    "simple": -1,
                    "ha": 1
                }
            },
            "category": "Operations",
            "service": "AKS",
            "waf": "Operational Excellence",
            "subcategory": "Monitoring"
        },
        {
            "title": "Configure distributed tracing",
            "guid": "8d33b2b2-e043-4c61-aa5d-319a8eb6c382",
            "priority": "Low",
            "description": "Distributed tracing, also called distributed request tracing, is a method used to profile and monitor applications, especially those built using a microservices architecture. Distributed tracing helps pinpoint where failures occur and what causes poor performance.",
            "documentation": [
                {
                    "title": "Solution for onboarding Kubernetes/AKS workloads onto Application Insights monitoring.",
                    "url": "https://github.com/microsoft/Application-Insights-K8s-Codeless-Attach"
                },
                {
                    "title": "Zero instrumentation application monitoring for Kubernetes hosted applications (deprecated)",
                    "url": "https://docs.microsoft.com/azure/azure-monitor/app/kubernetes"
                }
            ],
            "tags": [
                "all",
                "monitoring",
                "operations"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Operations",
            "service": "AKS",
            "waf": "Operational Excellence"
        },
        {
            "title": "Set Upgrade Channel",
            "guid": "01deb8ed-b6f5-40bb-8d0b-d0ee2d933f51",
            "priority": "Medium",
            "description": "In addition to manually upgrading a cluster, you can set an auto-upgrade channel on your cluster",
            "documentation": [
                {
                    "title": "Set AKS auto-upgrade channel",
                    "url": "https://docs.microsoft.com/azure/aks/upgrade-cluster#set-auto-upgrade-channel"
                }
            ],
            "tags": [
                "all",
                "operations"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Operations",
            "service": "AKS",
            "waf": "Operational Excellence"
        },
        {
            "title": "Enable cluster autoscaling",
            "priority": "Medium",
            "guid": "90ce65de-8e13-4f9c-abd4-69266abca264",
            "description": "To keep up with application demands in Azure Kubernetes Service (AKS), you may need to adjust the number of nodes that run your workloads. The cluster autoscaler component can watch for pods in your cluster that can't be scheduled because of resource constraints.",
            "detail": "You can enable autoscaling module per node pool but only create one mutual autoscale profile",
            "documentation": [
                {
                    "title": "AKS Autoscaler",
                    "url": "https://docs.microsoft.com/azure/aks/cluster-autoscaler"
                },
                {
                    "title": "Node autoprovisioning (karpenter)",
                    "url": "https://learn.microsoft.com/en-us/azure/aks/node-autoprovision"
                },
                {
                    "title": "Cluster autoscaler",
                    "url": "https://learn.microsoft.com/en-us/azure/aks/concepts-scale#cluster-autoscaler"
                }
            ],
            "tags": [
                "all",
                "resources",
                "finops"
            ],
            "optionalFields": {
                "score": {
                    "ha": 1,
                    "cost": -1
                }
            },
            "category": "Operations",
            "service": "AKS",
            "waf": "Operational Excellence",
            "subcategory": "Scalability",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (isnotnull(properties.autoScalerProfile)) | distinct id,compliant"
        },
        {
            "title": "Use GitOps to deploy workloads in your cluster",
            "priority": "High",
            "guid": "0102ce16-ee30-41e6-b882-e52e4621dd68",
            "description": "GitOps works by using Git as a single source of truth for declarative infrastructure and applications",
            "detail": "On Azure you can for instance use Azure Arc for Kubernetes but also directly GitOps addon for AKS",
            "documentation": [
                {
                    "title": "Use Flux v2 addon for AKS",
                    "url": "https://learn.microsoft.com/en-us/azure/azure-arc/kubernetes/tutorial-use-gitops-flux2"
                },
                {
                    "title": "What is Azure Arc enabled Kubernetes?",
                    "url": "https://docs.microsoft.com/azure/azure-arc/kubernetes/overview"
                },
                {
                    "title": "Guide To GitOps",
                    "url": "https://www.weave.works/technologies/gitops"
                }
            ],
            "tags": [
                "all",
                "operations"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Operations",
            "service": "AKS",
            "waf": "Operational Excellence",
            "subcategory": "Compliance"
        },
        {
            "title": "Implement CI/CD to deploy workloads in your cluster",
            "guid": "cd943950-e336-4906-a719-d2128c8d78e4",
            "priority": "High",
            "description": "Instead of GitOps (or in addition) you can use CI/CD to deploy workloads/tools in your cluster",
            "documentation": [
                {
                    "title": "Automated Deployments for Azure Kubernetes Service (Preview)",
                    "url": "https://learn.microsoft.com/en-gb/azure/aks/automated-deployments"
                },
                {
                    "title": "Build and deploy to Azure Kubernetes Service with Azure Pipelines",
                    "url": "https://learn.microsoft.com/en-gb/azure/aks/devops-pipeline?pivots=pipelines-yaml"
                },
                {
                    "title": "Tutorial: Deploy from GitHub to Azure Kubernetes Service using Jenkins",
                    "url": "https://learn.microsoft.com/en-gb/azure/developer/jenkins/deploy-from-github-to-aks"
                }
            ],
            "tags": [
                "all",
                "operations"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Operations",
            "service": "AKS",
            "waf": "Operational Excellence"
        },
        {
            "title": "Improve efficiency with K8S Tools",
            "guid": "fd926057-60e1-4d6c-afc2-0f03b5ab3763",
            "priority": "Medium",
            "description": "The Kubernetes ecosystem is strengthened by many tools that make operating it easier.  Here's a few",
            "tools": [
                {
                    "title": "OpenLens",
                    "url": "https://github.com/MuhammedKalkan/OpenLens"
                },
                {
                    "title": "Helm",
                    "url": "https://helm.sh"
                },
                {
                    "title": "kubectl aliases",
                    "url": "https://github.com/ahmetb/kubectl-aliases"
                },
                {
                    "title": "kubectx",
                    "url": "https://github.com/ahmetb/kubectx"
                },
                {
                    "title": "k9s",
                    "url": "https://k9scli.io/"
                }
            ],
            "tags": [
                "all",
                "operations"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Operations",
            "service": "AKS",
            "waf": "Operational Excellence"
        },
        {
            "title": "Don't use the default namespace",
            "guid": "13bb9e32-6f48-4747-9531-0147f20f4b03",
            "priority": "Medium",
            "description": "It's recommended to keep all applications in a namespace other than default",
            "documentation": [
                {
                    "url": "https://kubernetes.io/docs/concepts/overview/working-with-objects/namespaces/?ref=www.the-aks-checklist.com#when-to-use-multiple-namespaces",
                    "title": "Using multiple namespaces"
                }
            ],
            "tags": [
                "all",
                "operations"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Operations",
            "service": "AKS",
            "waf": "Operational Excellence"
        },
        {
            "title": "Apply different types of labels to all resources",
            "guid": "13bb9e32-6f48-4747-9531-0147f20f4b04",
            "priority": "Low",
            "description": "A common set of labels allows tools to work interoperably, describing objects in a common manner that all tools can understand. For instance, resources should have technical, business and security labels. ",
            "documentation": [
                {
                    "title": "Recommended labels",
                    "url": "https://kubernetes.io/docs/concepts/overview/working-with-objects/common-labels/"
                }
            ],
            "tags": [
                "all",
                "multi-tenancy",
                "operations"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Operations",
            "service": "AKS",
            "waf": "Operational Excellence"
        },
        {
            "title": "Fine tune your node configuration",
            "priority": "Low",
            "guid": "831c2872-c693-4b39-a887-a561bada49bc",
            "description": "Customizing your node configuration allows you to configure or tune your operating system (OS) settings, node pools or the kubelet parameters to match the needs of the workloads.",
            "detail": "When you create an AKS cluster or add a node pool to your cluster, you can customize a subset of commonly used OS and kubelet settings.",
            "documentation": [
                {
                    "title": "Customize node configuration for Azure Kubernetes Service (AKS) node pools",
                    "url": "https://learn.microsoft.com/azure/aks/custom-node-configuration"
                }
            ],
            "tags": [
                "all"
            ],
            "optionalFields": {
                "score": {
                    "cost": -1,
                    "ha": 1,
                    "severity": "Low",
                    "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (isnotnull(properties.austoscalerProfile)) | distinct id,compliant"
                }
            },
            "category": "Operations",
            "service": "AKS",
            "waf": "Operational Excellence",
            "subcategory": "Scalability",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (isnotnull(properties.austoscalerProfile)) | distinct id,compliant"
        },
        {
            "title": "Consider using AKS command invoke on private clusters",
            "priority": "Low",
            "guid": "d7672c26-7602-4482-85a4-14527fbe855c",
            "description": "You can use command invoke to access private clusters without having to configure a VPN or Express Route",
            "detail": "Using command invoke allows you to remotely invoke commands like kubectl and helm on your private cluster through the Azure API without directly connecting to the cluster.",
            "documentation": [
                {
                    "title": "Use command invoke to access a private AKS",
                    "url": "https://learn.microsoft.com/azure/aks/command-invoke"
                }
            ],
            "tags": [
                "all",
                "compliance"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Operations",
            "service": "AKS",
            "waf": "Operational Excellence",
            "subcategory": "Compliance"
        },
        {
            "title": "Monitor CPU and memory utilization of the nodes",
            "priority": "Medium",
            "guid": "4621dd68-c5a5-4be2-bdb1-1726769ef669",
            "description": "With Container insights, you can use the performance charts and health status to monitor the workload of Kubernetes clusters hosted on AKS",
            "documentation": [
                {
                    "title": "Monitor your Kubernetes cluster performance",
                    "url": "https://learn.microsoft.com/azure/azure-monitor/containers/container-insights-analyze"
                }
            ],
            "tags": [
                "all",
                "monitoring"
            ],
            "optionalFields": {
                "score": {
                    "simple": -1,
                    "ha": 1
                }
            },
            "category": "Operations",
            "service": "AKS",
            "waf": "Operational Excellence",
            "subcategory": "Monitoring"
        },
        {
            "title": "Send master logs (aka API logs) to Azure Monitor or your preferred log management solution",
            "priority": "High",
            "guid": "5b56ad48-408f-4e72-934c-476ba280dcf5",
            "description": "To help troubleshoot your application and services, you may need to view the logs generated by the master components. Be aware that if you don't enable these logs, there is no way for Microsoft to retrieve them for you",
            "documentation": [
                {
                    "title": "Enable and review Kubernetes master node logs",
                    "url": "https://docs.microsoft.com/azure/aks/view-control-plane-logs"
                },
                {
                    "title": "Monitoring Azure Kubernetes Service (AKS) with Azure Monitor",
                    "url": "https://learn.microsoft.com/en-us/azure/aks/monitor-aks"
                }
            ],
            "tags": [
                "all",
                "monitoring"
            ],
            "optionalFields": {
                "score": {
                    "ha": 1,
                    "cost": -1
                }
            },
            "category": "Operations",
            "service": "AKS",
            "waf": "Operational Excellence",
            "subcategory": "Compliance"
        },
        {
            "title": "Consider an appropriate node size, not too large or too small",
            "priority": "High",
            "guid": "5ae124ba-34df-4585-bcdc-e9bd3bb0cdb3",
            "description": "Optimizing node size can lead to lots of benefits including cost optimization, optimized performance and proper resource allocation",
            "documentation": [
                {
                    "title": "Which VM size should I choose as AKS node?",
                    "url": "https://blog.cloudtrooper.net/2020/10/23/which-vm-size-should-i-choose-as-aks-node/"
                }
            ],
            "tags": [
                "all",
                "cost",
                "finops",
                "monitoring"
            ],
            "optionalFields": {
                "score": {
                    "cost": 1
                }
            },
            "category": "Operations",
            "service": "AKS",
            "waf": "Operational Excellence",
            "subcategory": "Scalability"
        },
        {
            "title": "Regularly check Azure Advisor for recommendations on your cluster",
            "priority": "Medium",
            "guid": "337453a3-cc63-4963-9a65-22ac19e80696",
            "description": "Azure advisor can enhance environment monitoring and can help improve the operations of your cluster by reducing costs, etc",
            "documentation": [
                {
                    "title": "Azure advisor get started",
                    "url": "https://docs.microsoft.com/azure/advisor/advisor-get-started"
                }
            ],
            "tags": [
                "all",
                "compliance",
                "cost",
                "finops",
                "monitoring",
                "compliance"
            ],
            "optionalFields": {
                "score": {
                    "simple": -1,
                    "ha": 1
                }
            },
            "category": "Operations",
            "service": "AKS",
            "waf": "Operational Excellence",
            "subcategory": "Compliance"
        },
        {
            "title": "Write manifests following good practices using dedicated tools",
            "guid": "b78f2dec-d75e-44c3-937a-7509fd7a54f1",
            "priority": "Low",
            "description": "There are various tools that can make creating k8s manifest files much easier and can help with operational efficiency",
            "documentation": [
                {
                    "title": "what is prettier",
                    "url": "https://prettier.io/"
                }
            ],
            "tags": [
                "all",
                "operations",
                "monitoring",
                "compliance"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Operations",
            "service": "AKS",
            "waf": "Operational Excellence"
        },
        {
            "title": "Enable AKS auto-certificate rotation",
            "priority": "Low",
            "guid": "3aa70560-e7e7-4968-be3d-628af35b2ced",
            "description": "Periodically, you may need to rotate those certificates for security or policy reasons. For example, you may have a policy to rotate all your certificates every 90 days.",
            "documentation": [
                {
                    "title": "Certificate rotation in Azure Kubernetes Service (AKS)",
                    "url": "https://learn.microsoft.com/en-us/azure/aks/certificate-rotation"
                }
            ],
            "tags": [
                "all",
                "security"
            ],
            "optionalFields": {
                "score": {
                    "simple": 1
                }
            },
            "category": "Operations",
            "service": "AKS",
            "waf": "Operational Excellence",
            "subcategory": "Compliance"
        },
        {
            "title": "Store and analyze your cluster logs with Container Insights (or other tools like Telegraf/ElasticSearch)",
            "priority": "High",
            "guid": "eaa8dc4a-2436-47b3-9697-15b1752beee0",
            "description": "Monitoring the logs from your cluster can help prevent issues and identify areas of improvements",
            "documentation": [
                {
                    "title": "Container insights overview",
                    "url": "https://learn.microsoft.com/en-us/azure/azure-monitor/containers/container-insights-overview"
                }
            ],
            "tags": [
                "all",
                "monitoring"
            ],
            "category": "Operations",
            "service": "AKS",
            "waf": "Operational Excellence",
            "subcategory": "Monitoring",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (isnotnull(properties.addonProfiles.omsagent) and properties.addonProfiles.omsagent.enabled==true) | distinct id,compliant"
        },
        {
            "guid": "62f89719-db42-4cd0-824f-82ac7d62d9ac",
            "title": "Enable ContainerLogV2 schema for logging",
            "priority": "Medium",
            "description": "ContainerLogV2 schema improves the data related to the container logs (such as namespace, pod name, container name, etc.) and allows you to query the logs using these fields",
            "documentation": [
                {
                    "title": "Enable the ContainerLogV2 schema",
                    "url": "https://learn.microsoft.com/en-gb/azure/azure-monitor/containers/container-insights-logging-v2"
                }
            ],
            "tags": [
                "all",
                "monitoring"
            ],
            "category": "Operations",
            "service": "AKS",
            "waf": "Operational Excellence"
        },
        {
            "title": "Consider AKS virtual node for quick bursting",
            "priority": "Low",
            "guid": "c755562f-2b4e-4456-9b4d-874a748b662e",
            "description": "Virtual nodes with ACI can help speed up scaling",
            "documentation": [
                {
                    "title": "Create and configure an AKS cluster to use virtual nodes",
                    "url": "https://learn.microsoft.com/en-us/azure/aks/virtual-nodes"
                }
            ],
            "tags": [
                "all",
                "scalability"
            ],
            "optionalFields": {
                "score": {
                    "scale": 1,
                    "simple": -1,
                    "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (isnotnull(properties.addonProfiles.aciConnectorLinux) and properties.addonProfiles.aciConnectorLinux.enabled==true) | distinct id,compliant"
                }
            },
            "category": "Operations",
            "service": "AKS",
            "waf": "Operational Excellence",
            "subcategory": "Cost",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (isnotnull(properties.addonProfiles.aciConnectorLinux) and properties.addonProfiles.aciConnectorLinux.enabled==true) | distinct id,compliant"
        },
        {
            "title": "Consider spot node pools for non time-sensitive workloads",
            "priority": "Low",
            "guid": "c5a5b252-1e44-4a59-a9d2-399c4d7b68d0",
            "description": "Spot nodepools can help with cost management",
            "documentation": [
                {
                    "title": "Add an Azure Spot node pool to an AKS cluster",
                    "url": "https://docs.microsoft.com/azure/aks/spot-node-pool"
                }
            ],
            "tags": [
                "all",
                "cost",
                "operations",
                "finops"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Operations",
            "service": "AKS",
            "waf": "Operational Excellence",
            "subcategory": "Cost"
        },
        {
            "title": "Configure alerts on the most critical metrics (see Container Insights for recommendations)",
            "priority": "High",
            "guid": "67f7a9ed-5b31-4f38-a3f3-9812b2463cff",
            "description": "Alerts can provide early warnings of issues, etc in your cluster",
            "documentation": [
                {
                    "title": "Metric alert rules in Container insights",
                    "url": "https://docs.microsoft.com/azure/azure-monitor/insights/container-insights-metric-alerts"
                }
            ],
            "tags": [
                "all",
                "monitoring",
                "security"
            ],
            "optionalFields": {
                "score": {
                    "simple": -1,
                    "ha": 1
                }
            },
            "category": "Operations",
            "service": "AKS",
            "waf": "Operational Excellence",
            "subcategory": "Alerting"
        },
        {
            "title": "If not using egress filtering with AzFW/NVA, monitor standard ALB allocated SNAT ports",
            "guid": "95951d87-1a2f-4a45-833c-2fc62d23c44d",
            "priority": "Medium",
            "description": "Monitoring these ports are important for security reasons",
            "documentation": [
                {
                    "title": "Use a public standard load balancer in Azure Kubernetes Service",
                    "url": "https://docs.microsoft.com/azure/aks/load-balancer-standard"
                }
            ],
            "tags": [
                "all",
                "monitoring",
                "security"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Operations",
            "service": "AKS",
            "waf": "Operational Excellence"
        },
        {
            "title": "Subscribe to resource health notifications for your AKS cluster",
            "priority": "High",
            "guid": "74c2ee76-569b-4a79-a57e-dedf91b022c9",
            "description": "Learn how to troubleshoot resource health issues",
            "documentation": [
                {
                    "title": "Azure Kubernetes Services troubleshooting documentation",
                    "url": "https://learn.microsoft.com/en-us/troubleshoot/azure/azure-kubernetes/welcome-azure-kubernetes"
                }
            ],
            "tags": [
                "all",
                "monitoring",
                "security"
            ],
            "optionalFields": {
                "score": {
                    "ha": 1
                }
            },
            "category": "Operations",
            "service": "AKS",
            "waf": "Operational Excellence",
            "subcategory": "Monitoring"
        },
        {
            "title": "Consider subscribing to EventGrid Events for AKS automation",
            "priority": "Low",
            "guid": "9583c0f6-6083-43f6-aa6b-df7102c901bb",
            "description": "AKS emits certain events that enable it to subscribe to EventGrid which can be used for automation",
            "documentation": [
                {
                    "title": "AKS as an Event Grid source",
                    "url": "https://learn.microsoft.com/azure/event-grid/event-schema-aks"
                }
            ],
            "tags": [
                "all",
                "monitoring"
            ],
            "optionalFields": {
                "score": {
                    "cost": 1
                }
            },
            "category": "Operations",
            "service": "AKS",
            "waf": "Operational Excellence",
            "subcategory": "Scalability"
        },
        {
            "title": "Develop own governance practices to make sure no changes are performed by operators in the node RG (aka 'infra RG')",
            "priority": "High",
            "guid": "ed0fda7f-211b-47c7-8b6e-c18873fb473c",
            "description": "Develop own governance practices to make sure no changes are performed by operators in the node RG (aka 'infra RG')",
            "documentation": [
                {
                    "title": "AKS FAQ",
                    "url": "https://docs.microsoft.com/azure/aks/faq"
                }
            ],
            "tags": [
                "all",
                "monitoring"
            ],
            "optionalFields": {
                "score": {
                    "security": 1
                }
            },
            "category": "Operations",
            "service": "AKS",
            "waf": "Operational Excellence",
            "subcategory": "Compliance"
        },
        {
            "title": "Install debuging tools on your cluster",
            "priority": "High",
            "guid": "f1d2d2f4-53a2-5f1b-9d1a-3a907b6844a5",
            "description": "You are never ready when something bad happen and debugging a kubernetes cluster can be tricky. Some toolbox can be deployed to help you to find and fix the most common issues",
            "documentation": [
                {
                    "title": "Inspektor Gadget",
                    "url": "https://www.inspektor-gadget.io/"
                }
            ],
            "tags": [
                "all",
                "monitoring"
            ],
            "optionalFields": {
                "score": {
                    "security": 1
                }
            },
            "category": "Operations",
            "service": "AKS",
            "waf": "Operational Excellence"
        },
        {
            "title": "Burst serverless with Azure Container Instances and Virtual Nodes",
            "guid": "c88681ab-bb2b-46d1-9ea6-72564b75429a",
            "priority": "Low",
            "description": "To rapidly scale your AKS cluster, you can integrate with Azure Container Instances (ACI)",
            "detail": "Kubernetes has built-in components to scale the replica and node count. However, if your application needs to rapidly scale, the horizontal pod autoscaler may schedule more pods than can be provided by the existing compute resources in the node pool.",
            "documentation": [
                {
                    "title": "Burst to Azure Container Instances",
                    "url": "https://learn.microsoft.com/en-gb/azure/aks/concepts-scale#burst-to-azure-container-instances"
                }
            ],
            "tags": [
                "all",
                "operations",
                "finops"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Resource_Management",
            "service": "AKS",
            "waf": "Operational Excellence"
        },
        {
            "title": "Sizing of the nodes",
            "guid": "7f8b07c5-882b-45ba-9ec9-bcc29b4721ff",
            "priority": "Medium",
            "description": "what type of worker nodes should I use, and how many of them is a critical question which requires the analysis of the workloads deployed on your cluster to get the best values of it",
            "detail": "Choosing on one hand between easy management and big blast radius, and on the other end to focus on high replication, low impact but worse resources optimization ",
            "documentation": [
                {
                    "title": "Choosing a worker node size",
                    "url": "https://learnk8s.io/kubernetes-node-size"
                },
                {
                    "title": "Choose the right storage type",
                    "url": "https://docs.microsoft.com/azure/aks/operator-best-practices-storage#choose-the-appropriate-storage-type"
                }
            ],
            "tools": [
                {
                    "title": "Kubernetes instance calculator",
                    "url": "https://learnk8s.io/kubernetes-instance-calculator"
                }
            ],
            "tags": [
                "all",
                "resources"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Resource_Management",
            "service": "AKS",
            "waf": "Operational Excellence"
        },
        {
            "title": "Use ARM64 nodes when possible",
            "guid": "2a5f0cab-92b2-46dc-81a6-d358f7fd062a",
            "priority": "Medium",
            "description": "Benefit from ARM64's better price, compute performance, and lower power utilization in AKS node pools.",
            "documentation": [
                {
                    "title": "Add an ARM64 node pool",
                    "url": "https://learn.microsoft.com/en-us/azure/aks/use-multiple-node-pools#add-an-arm64-node-pool"
                }
            ],
            "tags": [
                "all",
                "operations"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Resource_Management",
            "service": "AKS",
            "waf": "Operational Excellence"
        },
        {
            "title": "Enforce resource quotas for namespaces",
            "priority": "Low",
            "guid": "769ef669-1a48-435a-a942-223ece80b123",
            "description": "Plan and apply resource quotas at the namespace level. If pods don't define resource requests and limits, reject the deployment. Monitor resource usage and adjust quotas as needed.",
            "detail": "Resource requests and limits are placed in the pod specification. These limits are used by the Kubernetes scheduler at deployment time to find an available node in the cluster. But developers can forget them and thus impact other applications by over-consuming resources of the cluster",
            "documentation": [
                {
                    "title": "Enforce resource quotas",
                    "url": "https://docs.microsoft.com/azure/aks/operator-best-practices-scheduler#enforce-resource-quotas"
                },
                {
                    "title": "Resources quotas",
                    "url": "https://kubernetes.io/docs/concepts/policy/resource-quotas/"
                }
            ],
            "tags": [
                "all",
                "resiliency",
                "resource management",
                "multi-tenancy"
            ],
            "optionalFields": {
                "score": {
                    "simple": -1,
                    "ha": 1
                }
            },
            "category": "Resource_Management",
            "service": "AKS",
            "waf": "Operational Excellence",
            "subcategory": "Resources"
        },
        {
            "title": "Namespaces should have LimitRange",
            "guid": "b74ea93b-598d-48e0-bb26-762b015602e1",
            "priority": "Low",
            "description": " A LimitRange is a policy to constrain resource allocations (to Pods or Containers) in a namespace. It's useful to ensure that pods don't forget to declare request limits",
            "documentation": [
                {
                    "title": "LimitRange",
                    "url": "https://kubernetes.io/docs/concepts/policy/limit-range/"
                }
            ],
            "tags": [
                "all",
                "resiliency",
                "resource management",
                "multi-tenancy"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Resource_Management",
            "service": "AKS",
            "waf": "Operational Excellence"
        },
        {
            "title": "Set memory limits and requests for all containers",
            "guid": "4868aa30-95a9-49fd-867e-57e70cb0d1d5",
            "priority": "Medium",
            "description": "Set CPU and memory limits and requests to all the containers. It prevents memory leaks and CPU over-usage and protects the whole platform",
            "detail": " When you specify limits for CPU and memory, each takes a different action when it reaches the specified limit. With CPU limits, the container is throttled from using more than its specified limit. With memory limits, the pod is restarted if it reaches its limit. The pod might be restarted on the same host or a different host within the cluster.",
            "documentation": [
                {
                    "title": "Define pod resource requests and limits",
                    "url": "https://learn.microsoft.com/en-gb/azure/aks/developer-best-practices-resource-management#define-pod-resource-requests-and-limits"
                },
                {
                    "title": "Assign Memory Resources to container",
                    "url": "https://kubernetes.io/docs/tasks/configure-pod-container/assign-memory-resource/"
                }
            ],
            "tags": [
                "all",
                "resiliency",
                "resource management",
                "multi-tenancy"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Resource_Management",
            "service": "AKS",
            "waf": "Operational Excellence"
        },
        {
            "title": "Use Disruption Budgets in your pod and deployment definitions",
            "priority": "Low",
            "guid": "3c763963-7a55-42d5-a15e-401955387e5c",
            "description": "To maintain the availability of applications, define Pod Disruption Budgets (PDBs) to make sure that a minimum number of pods are available in the cluster.",
            "detail": "At some point in time, Kubernetes might need to evict pods from a host. There are two types of evictions: voluntary and involuntary disruptions. Involuntary disruptions can be caused by hardware failure, network partitions, kernel panics, or a node being out of resources. Voluntary evictions can be caused by performing maintenance on the cluster, the Cluster Autoscaler deallocating nodes, or updating pod templates. To minimize the impact to your application, you can set a PodDisruptionBudget to ensure uptime of the application when pods need to be evicted. A PodDisruptionBudget allows you to set a policy on the minimum available and maximum unavailable pods during voluntary eviction events. An example of a voluntary eviction would be when draining a node to perform maintenance on the node.",
            "documentation": [
                {
                    "title": "Plan for availability using pod disruption budgets",
                    "url": "https://docs.microsoft.com/azure/aks/operator-best-practices-scheduler#plan-for-availability-using-pod-disruption-budgets"
                },
                {
                    "title": "Specifying a Disruption Budget for your Application",
                    "url": "https://kubernetes.io/docs/tasks/run-application/configure-pdb/"
                }
            ],
            "tags": [
                "all",
                "resiliency",
                "resource management"
            ],
            "optionalFields": {
                "score": {
                    "ha": 1,
                    "cost": -1
                }
            },
            "category": "Resource_Management",
            "service": "AKS",
            "waf": "Operational Excellence",
            "subcategory": "High Availability"
        },
        {
            "title": "Use an external application such as kubecost to allocate costs to different users",
            "priority": "Low",
            "guid": "f82cb8eb-8c0a-4a63-a25a-4956eaa8dc4a",
            "description": "These tools can be very valuable for cost allocation especially in the case of multitenancy",
            "documentation": [
                {
                    "title": "cost governance with kubecost",
                    "url": "https://docs.microsoft.com/azure/cloud-adoption-framework/scenarios/aks/eslz-cost-governance-with-kubecost"
                }
            ],
            "tags": [
                "all",
                "cost",
                "finops",
                "resource management"
            ],
            "optionalFields": {
                "score": {
                    "cost": 1
                }
            },
            "category": "Resource_Management",
            "service": "AKS",
            "waf": "Operational Excellence",
            "subcategory": "Cost"
        },
        {
            "title": "When required use multi-instance partioning GPU on AKS Clusters",
            "guid": "87e651ea-bc4a-4a87-a6df-c06a4b570ebc",
            "priority": "Medium",
            "description": "Nvidia's A100 GPU can be divided in up to seven independent instances. Each instance has their own memory and Stream Multiprocessor (SM).",
            "documentation": [
                {
                    "title": "Multi-instance GPU Node pool",
                    "url": "https://learn.microsoft.com/azure/aks/gpu-multi-instance"
                }
            ],
            "tags": [
                "all",
                "cost",
                "finops",
                "resource management"
            ],
            "optionalFields": {
                "score": {
                    "cost": 1
                }
            },
            "category": "Resource_Management",
            "service": "AKS",
            "waf": "Operational Excellence",
            "subcategory": "Cost"
        },
        {
            "title": "If running a Dev/Test cluster use NodePool Start/Stop",
            "priority": "Medium",
            "guid": "2b72a08b-0410-4cd6-9093-e068a5cf27e8",
            "description": "Your AKS workloads may not need to run continuously, for example a development cluster that has node pools running specific workloads.",
            "documentation": [
                {
                    "title": "Start and stop an Azure Kubernetes Service (AKS) node pool",
                    "url": "https://learn.microsoft.com/azure/aks/start-stop-nodepools"
                }
            ],
            "tags": [
                "all",
                "cost",
                "finops",
                "resource management"
            ],
            "optionalFields": {
                "score": {
                    "cost": 1
                }
            },
            "category": "Resource_Management",
            "service": "AKS",
            "waf": "Operational Excellence",
            "subcategory": "Cost"
        },
        {
            "title": "If required scale NodePool snapshots",
            "priority": "Low",
            "guid": "64d1a846-e28a-4b6b-9a33-22a635c15a21",
            "description": "Node pool snapshots allow you to take a configuration snapshot of your node pool and then create new node pools or new clusters based of that snapshot for as long as that configuration and kubernetes version is supported.",
            "documentation": [
                {
                    "title": "AKS node pool snapshot",
                    "url": "https://learn.microsoft.com/azure/aks/node-pool-snapshot"
                }
            ],
            "tags": [
                "all",
                "cost",
                "finops",
                "resource management"
            ],
            "optionalFields": {
                "score": {
                    "cost": 1
                }
            },
            "category": "Resource_Management",
            "service": "AKS",
            "waf": "Operational Excellence",
            "subcategory": "Compliance"
        },
        {
            "title": "Ensure your subscription has enough quota to scale out your nodepools",
            "priority": "High",
            "guid": "081a5417-4158-433e-a3ad-3c2de733165c",
            "description": "Azure VMs/nodes have quotas per subscription. Ensure that you have planned for these quota and proactively prepare to request for more if needed",
            "documentation": [
                {
                    "title": "Azure subscription and service limits, quotas, and constraints",
                    "url": "https://learn.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits"
                }
            ],
            "tags": [
                "all",
                "scalability",
                "resources"
            ],
            "optionalFields": {
                "score": {
                    "cost": 1
                }
            },
            "category": "Resource_Management",
            "service": "AKS",
            "waf": "Operational Excellence",
            "subcategory": "Resources"
        },
        {
            "title": "Use scale down mode to delete/delallocate nodes",
            "priority": "Low",
            "guid": "4d3dfbab-9924-4831-a68d-fdf0d72f462c",
            "description": " Scale-down Mode allows you to decide whether you would like to delete or deallocate the nodes in your Azure Kubernetes Service (AKS) cluster upon scaling down.",
            "documentation": [
                {
                    "title": "Use Scale-down Mode to delete/deallocate nodes",
                    "url": "https://learn.microsoft.com/azure/aks/scale-down-mode"
                }
            ],
            "tags": [
                "all",
                "cost",
                "resources"
            ],
            "optionalFields": {
                "score": {
                    "cost": 1
                }
            },
            "category": "Resource_Management",
            "service": "AKS",
            "waf": "Operational Excellence",
            "subcategory": "Cost"
        },
        {
            "title": "Choose the right storage type",
            "guid": "4c20c4bd-a7e3-449f-9597-4939a3aeafe7",
            "priority": "High",
            "description": "Understand the needs of your application to pick the right storage. Use high performance, SSD-backed storage for production workloads. Plan for network-based storage when there is a need for multiple concurrent connections.",
            "documentation": [
                {
                    "title": "Storage considerations for Azure Kubernetes Service",
                    "url": "https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/scenarios/app-platform/aks/storage"
                },
                {
                    "title": "Choose the right storage type",
                    "url": "https://docs.microsoft.com/azure/aks/operator-best-practices-storage#choose-the-appropriate-storage-type"
                }
            ],
            "tags": [
                "all",
                "storage"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Storage",
            "service": "AKS"
        },
        {
            "title": "Size the nodes for storage needs",
            "guid": "18707174-fa23-4935-b463-8f9982629b35",
            "priority": "Medium",
            "description": "Each node size supports a maximum number of disks. Different node sizes also provide different amounts of local storage and network bandwidth. Plan for your application demands to deploy the appropriate size of nodes.",
            "detail": "Different types and sizes of nodes are available. Each node (underlying VM) size provides a different amount of core resources such as CPU and memory. These VM sizes have a maximum number of disks that can be attached. Storage performance also varies between VM sizes for the maximum local and attached disk IOPS (input/output operations per second). If your applications require Azure Disks as their storage solution, plan for and choose an appropriate node VM size. The amount of CPU and memory isn't the only factor when you choose a VM size. The storage capabilities are also important.",
            "documentation": [
                {
                    "title": "Size the nodes for storage needs",
                    "url": "https://docs.microsoft.com/azure/aks/operator-best-practices-storage#size-the-nodes-for-storage-needs"
                }
            ],
            "tags": [
                "all",
                "storage"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Storage",
            "service": "AKS"
        },
        {
            "title": "Dynamically provision volumes",
            "guid": "77bda7ce-1fcf-4735-bd3d-1b3a83a9e484",
            "priority": "Low",
            "description": "To reduce management overhead and let you scale, don't statically create and assign persistent volumes. Use dynamic provisioning. In your storage classes, define the appropriate reclaim policy to minimize unneeded storage costs once pods are deleted.",
            "documentation": [
                {
                    "title": "Dynamically provision volumes",
                    "url": "https://docs.microsoft.com/azure/aks/operator-best-practices-storage#dynamically-provision-volumes"
                }
            ],
            "tags": [
                "all",
                "storage"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Storage",
            "service": "AKS"
        },
        {
            "title": "Secure and back up your data",
            "guid": "13d493b9-2cdc-4632-b188-6882b81da0ed",
            "priority": "Medium",
            "description": "Back up your data using an appropriate tool for your storage type, such as Velero or Azure Site Recovery",
            "detail": "Understand the limitations of the different approaches to data backups and if you need to quiesce your data prior to snapshot. Data backups don't necessarily let you restore your application environment of cluster deployment.",
            "documentation": [
                {
                    "title": "Secure and back up your data",
                    "url": "https://docs.microsoft.com/azure/aks/operator-best-practices-storage#secure-and-back-up-your-data"
                }
            ],
            "tags": [
                "all",
                "storage",
                "resiliency"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Storage",
            "service": "AKS"
        },
        {
            "title": "Avoid keeping state in the cluster, and store data outside (AzStorage, AzSQL, Cosmos, etc)",
            "priority": "High",
            "guid": "9f7547c1-747d-4c56-868a-714435bd19dd",
            "description": "Where possible, don't store service state inside the container. Instead, use an Azure platform as a service (PaaS) that supports multiregion replication.",
            "detail": "Service state refers to the in-memory or on-disk data that a service requires to function. State includes the data structures and member variables that the service reads and writes. Depending on how the service is architected, the state might also include files or other resources that are stored on the disk. For example, the state might include the files a database uses to store data and transaction logs.",
            "documentation": [
                {
                    "title": "Remove service state from inside containers",
                    "url": "https://docs.microsoft.com/azure/aks/operator-best-practices-multi-region#remove-service-state-from-inside-containers"
                }
            ],
            "tags": [
                "all",
                "storage",
                "resiliency"
            ],
            "optionalFields": {
                "score": {
                    "simple": -1,
                    "ha": 1
                }
            },
            "category": "Storage",
            "service": "AKS",
            "subcategory": "Storage",
            "waf": "Performance"
        },
        {
            "title": "Use ephemeral OS disks",
            "priority": "High",
            "guid": "24367b33-6971-45b1-952b-eee0b9b588de",
            "description": " With ephemeral OS disks, you see lower read/write latency on the OS disk of AKS agent nodes since the disk is locally attached.",
            "detail": "You will also get faster cluster operations like scale or upgrade thanks to faster re-imaging and boot times",
            "documentation": [
                {
                    "title": "Everything you want to know about ephemeral OS disks and AKS",
                    "url": "https://learn.microsoft.com/en-us/samples/azure-samples/aks-ephemeral-os-disk/aks-ephemeral-os-disk/"
                }
            ],
            "tags": [
                "all",
                "storage",
                "resiliency"
            ],
            "optionalFields": {
                "score": {
                    "scale": 1,
                    "cost": -1,
                    "graph": "where type=='microsoft.containerservice/managedclusters' | project id,resourceGroup,name,pools=properties.agentPoolProfiles | mvexpand pools | extend compliant = (pools.osDiskType=='Ephemeral') | project id,name=strcat(name,'-',pools.name), resourceGroup, compliant"
                }
            },
            "category": "Storage",
            "service": "AKS",
            "subcategory": "Storage",
            "waf": "Performance",
            "graph": "where type=='microsoft.containerservice/managedclusters' | project id,resourceGroup,name,pools=properties.agentPoolProfiles | mvexpand pools | extend compliant = (pools.osDiskType=='Ephemeral') | project id,name=strcat(name,'-',pools.name), resourceGroup, compliant"
        },
        {
            "title": "For hyper performance storage option use Ultra Disks on AKS",
            "priority": "Low",
            "guid": "39c486ce-d5af-4062-89d5-18bb5fd795db",
            "description": "Azure ultra disks offer high throughput, high IOPS, and consistent low latency disk storage for your stateful applications.",
            "detail": "One major benefit of ultra disks is the ability to dynamically change the performance of the SSD along with your workloads without the need to restart your agent nodes. Ultra disks are suited for data-intensive workloads.",
            "documentation": [
                {
                    "title": "Use Azure ultra disks on AKS",
                    "url": "https://learn.microsoft.com/azure/aks/use-ultra-disks"
                }
            ],
            "tags": [
                "all",
                "storage",
                "resiliency"
            ],
            "optionalFields": {
                "score": {
                    "scale": 1,
                    "cost": -1
                }
            },
            "category": "Storage",
            "service": "AKS",
            "subcategory": "Storage",
            "waf": "Performance"
        },
        {
            "title": "Avoid keeping state in the cluster, and store data outside (AzStorage, AzSQL, Cosmos, etc)",
            "guid": "b5f3808d-3a6a-42a5-adde-7bb34e047169",
            "priority": "Medium",
            "description": "Where possible, don't store service state inside the container. Instead, use an Azure platform as a service (PaaS) that supports multiregion replication.",
            "detail": "Service state refers to the in-memory or on-disk data that a service requires to function. State includes the data structures and member variables that the service reads and writes. Depending on how the service is architected, the state might also include files or other resources that are stored on the disk. For example, the state might include the files a database uses to store data and transaction logs.",
            "documentation": [
                {
                    "title": "Remove service state from inside containers",
                    "url": "https://learn.microsoft.com/en-us/azure/aks/operator-best-practices-multi-region#remove-service-state-from-inside-containers"
                }
            ],
            "tags": [
                "all",
                "storage",
                "resiliency"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Storage",
            "service": "AKS"
        },
        {
            "title": "If using Azure Disks and AZs, consider having nodepools within a zone for LRS disk",
            "priority": "Medium",
            "guid": "83958a8c-2689-4b32-ab57-cfc64546135a",
            "description": "If using Azure Disks and AZs, consider having nodepools within a zone for LRS disk with VolumeBindingMode:WaitForFirstConsumer for provisioning storage in right zone or use ZRS disk for nodepools spanning multiple zones",
            "documentation": [
                {
                    "title": "Azure disk availability zone support",
                    "url": "https://docs.microsoft.com/azure/aks/availability-zones#azure-disk-availability-zone-support"
                }
            ],
            "tags": [
                "all",
                "storage",
                "resiliency"
            ],
            "optionalFields": {
                "score": {
                    "simple": -1,
                    "ha": 1
                }
            },
            "category": "Storage",
            "service": "AKS",
            "subcategory": "Storage",
            "waf": "Performance"
        },
        {
            "title": "For non-ephemeral disks, use high IOPS and larger OS disks for the nodes when running many pods/node",
            "priority": "High",
            "guid": "fc4972cc-3cd2-45bf-a707-6e9eab4bed32",
            "description": "For non-ephemeral disks, use high IOPS and larger OS disks for the nodes when running many pods/node since it requires high performance for running multiple pods and will generate huge logs with default AKS log rotation thresholds",
            "documentation": [
                {
                    "title": "Azure disk availability zone support",
                    "url": "Azure managed disk types"
                }
            ],
            "tags": [
                "all",
                "storage",
                "resiliency"
            ],
            "optionalFields": {
                "score": {
                    "cost": -1,
                    "scale": 1
                }
            },
            "category": "Storage",
            "service": "AKS"
        },
        {
            "title": "Map the base image to node OS",
            "guid": "4d3e8a06-b724-43a3-b9b9-328a08325c61",
            "priority": "High",
            "description": "Windows has strict compatibility rules, where the host OS version must match the container base image OS version. Only Windows containers with a container operating system of Windows Server 2019 are supported.",
            "documentation": [
                {
                    "title": "Windows container version compatibility",
                    "url": "https://docs.microsoft.com/virtualization/windowscontainers/deploy-containers/version-compatibility"
                },
                {
                    "title": "Limitations of Windows containers",
                    "url": "https://kubernetes.io/docs/setup/production-environment/windows/intro-windows-in-kubernetes/#supported-functionality-and-limitations"
                }
            ],
            "tags": [
                "all",
                "windows"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Windows",
            "service": "AKS"
        },
        {
            "title": "Prepare your application for an abrupt kill",
            "guid": "fce3ccf3-5f62-4ad6-b945-845362777529",
            "priority": "Medium",
            "description": "TerminationGracePeriod is not implemented on Windows containers",
            "documentation": [
                {
                    "title": "Understand pod lifecycle",
                    "url": "https://cloud.google.com/blog/products/gcp/kubernetes-best-practices-terminating-with-grace"
                },
                {
                    "title": "Limitations of Windows containers",
                    "url": "https://kubernetes.io/docs/setup/production-environment/windows/intro-windows-in-kubernetes/#supported-functionality-and-limitations"
                }
            ],
            "tags": [
                "all",
                "windows"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Windows",
            "service": "AKS"
        },
        {
            "title": "Don't use privileged containers",
            "guid": "bd773172-40dc-4502-b284-137c70d77bc9",
            "priority": "Medium",
            "description": "Windows containers do not support elevation of privilege",
            "documentation": [
                {
                    "title": "Limitations of Windows containers",
                    "url": "https://kubernetes.io/docs/setup/production-environment/windows/intro-windows-in-kubernetes/#supported-functionality-and-limitations"
                }
            ],
            "tags": [
                "all",
                "windows"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Windows",
            "service": "AKS"
        },
        {
            "title": "Watch for memory usage",
            "guid": "dea429d5-2c10-480c-85a1-9d9d0c4afc3d",
            "priority": "Medium",
            "description": "There are no OOM eviction actions taken by the kubelet. Windows always treats all user-mode memory allocations as virtual, and pagefiles are mandatory. If memory is over-provisioned and all physical memory is exhausted, then paging can slow down performance.",
            "documentation": [
                {
                    "title": "Limitations of Windows containers",
                    "url": "https://kubernetes.io/docs/setup/production-environment/windows/intro-windows-in-kubernetes/#supported-functionality-and-limitations"
                }
            ],
            "tags": [
                "all",
                "windows"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Windows",
            "service": "AKS"
        },
        {
            "title": "Implement CNI network mode",
            "guid": "3922e5b0-fa6b-4020-a92e-2e0d76338e95",
            "priority": "High",
            "description": "AKS clusters with Windows node pools must use the Azure CNI (advanced) networking model. Kubenet (basic) networking is not supported. ",
            "documentation": [
                {
                    "title": "What network plug-ins are supported?",
                    "url": "https://docs.microsoft.com/azure/aks/windows-node-limitations#what-network-plug-ins-are-supported"
                }
            ],
            "tags": [
                "all",
                "windows"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Windows",
            "service": "AKS"
        },
        {
            "title": "Keep windows containers patch level in sync with host patch level",
            "priority": "High",
            "guid": "67138b82-0102-4ce1-9ee3-01e6e882e52e",
            "description": "Windows Server nodes in AKS must be upgraded to get the latest patch fixes and updates. Windows Updates are not enabled on nodes in AKS. AKS releases new node pool images as soon as patches are available, it is the customers responsibility to upgrade node pools to stay current on patches and hotfix. ",
            "documentation": [
                {
                    "title": "Windows container version compatibility",
                    "url": "https://docs.microsoft.com/virtualization/windowscontainers/deploy-containers/version-compatibility?tabs=windows-server-20H2%2Cwindows-10-20H2"
                },
                {
                    "title": "How do patch my Windows nodes? ",
                    "url": "https://docs.microsoft.com/azure/aks/windows-node-limitations#how-do-patch-my-windows-nodes"
                }
            ],
            "tags": [
                "all",
                "windows"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Windows",
            "service": "AKS",
            "subcategory": "Compliance",
            "waf": "Operations"
        },
        {
            "title": "Secure the traffic of your containers",
            "guid": "74e42965-8bbd-46fb-b027-ccad9c3933a4",
            "priority": "High",
            "description": "Network policies are currently not supported, ensure that the containerized applications have a layer of protection like authentication ",
            "documentation": [
                {
                    "title": "Limitations of Windows containers",
                    "url": "https://kubernetes.io/docs/setup/production-environment/windows/intro-windows-in-kubernetes/#supported-functionality-and-limitations"
                }
            ],
            "tags": [
                "all",
                "windows"
            ],
            "optionalFields": {
                "score": {}
            },
            "category": "Windows",
            "service": "AKS"
        },
        {
            "title": "Enable Group Managed Service Accounts (GMSA) for your Windows Server nodes",
            "priority": "Medium",
            "guid": "e1123a7c-a333-4eb4-a120-4ee3f293c9f3",
            "description": "Group Managed Service Accounts (GMSA) is a managed domain account for multiple servers that provides automatic password management, simplified service principal name (SPN) management and the ability to delegate the management to other administrators.",
            "documentation": [
                {
                    "title": "Enable Group Managed Service Accounts (GMSA) for your Windows Server nodes",
                    "url": "https://docs.microsoft.com/en-gb/azure/aks/use-group-managed-service-accounts"
                }
            ],
            "tags": [
                "all",
                "identity",
                "windows",
                "security"
            ],
            "optionalFields": {
                "score": {
                    "simple": -1,
                    "security": 1
                }
            },
            "category": "Windows",
            "service": "AKS",
            "subcategory": "Identity",
            "waf": "Security"
        },
        {
            "title": "If required for AKS Windows workloads, HostProcess containers can be used",
            "priority": "Medium",
            "guid": "ab5351f6-383a-45ed-9c5e-b143b16db40a",
            "description": "HostProcess / Privileged containers extend the Windows container model to enable a wider range of Kubernetes cluster management scenarios.",
            "documentation": [
                {
                    "title": "Use Windows HostProcess containers",
                    "url": "https://learn.microsoft.com/azure/aks/use-windows-hpc"
                }
            ],
            "tags": [
                "all",
                "application",
                "windows"
            ],
            "optionalFields": {
                "score": {
                    "cost": 1
                }
            },
            "category": "Windows",
            "service": "AKS",
            "subcategory": "Development",
            "waf": "Reliability"
        },
        {
            "title": "Taint Windows nodes",
            "priority": "low",
            "guid": "c1881370-6f7c-44c0-b4e5-14648d2457ed",
            "description": "Adding taints, tolerations and node selectors will help avoid having pods scheduled in the wrong OS node pool",
            "documentation": [
                {
                    "title": "Adapt apps for mixed-OS Kubernetes clusters using node selectors or taints and tolerations",
                    "url": "https://learn.microsoft.com/en-us/azure/aks/hybrid/adapt-apps-mixed-os-clusters"
                }
            ],
            "tags": [
                "all",
                "compliance",
                "windows"
            ],
            "optionalFields": {
                "score": {
                    "simple": -1,
                    "ha": 1
                }
            },
            "category": "Windows",
            "service": "AKS",
            "subcategory": "Compliance",
            "waf": "Operations"
        },
        {
            "title": "For Windows 2019 and 2022 AKS nodes Calico Network Policies can be us",
            "priority": "Medium",
            "guid": "ce7f2a7c-297c-47c6-adea-a6ff838db665",
            "description": "For Windows 2019 and 2022 AKS nodes Calico Network Policies can be use",
            "documentation": [
                {
                    "title": "Secure traffic between pods using network policies",
                    "url": "https://learn.microsoft.com/azure/aks/use-network-policies"
                }
            ],
            "tags": [
                "all",
                "security",
                "compliance",
                "windows"
            ],
            "optionalFields": {
                "score": {
                    "security": 1,
                    "simple": -1,
                    "graph": "where type=='microsoft.containerservice/managedclusters' | where isnotnull(properties.apiServerAccessProfile.enablePrivateCluster) | extend compliant = (properties.apiServerAccessProfile.enablePrivateCluster==true) | distinct id, compliant"
                }
            },
            "category": "Windows",
            "service": "AKS",
            "subcategory": "Security",
            "waf": "Security",
            "graph": "where type=='microsoft.containerservice/managedclusters' | where isnotnull(properties.apiServerAccessProfile.enablePrivateCluster) | extend compliant = (properties.apiServerAccessProfile.enablePrivateCluster==true) | distinct id, compliant"
        },
        {
            "title": "For Windows workloads use Accelerated Networking",
            "priority": "Medium",
            "guid": "7bacd7b9-c025-4a9d-a5d2-25d6bc5439d9",
            "description": "For Windows workloads use Accelerated Networking",
            "documentation": [
                {
                    "title": "What is Accelerated Networking?",
                    "url": "https://learn.microsoft.com/azure/virtual-network/accelerated-networking-overview"
                }
            ],
            "tags": [
                "all",
                "operations",
                "windows"
            ],
            "optionalFields": {
                "score": {
                    "scale": 1,
                    "simple": -1,
                    "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (isnull(properties.addonProfiles.httpApplicationRouting) or properties.addonProfiles.httpApplicationRouting.enabled==false) | distinct id,compliant"
                }
            },
            "category": "Windows",
            "service": "AKS",
            "subcategory": "Best practices",
            "waf": "Performance"
        }
    ],
    "categories": [
        {
            "name": "Operations"
        },
        {
            "name": "Storage"
        },
        {
            "name": "Networking"
        },
        {
            "name": "Windows"
        },
        {
            "name": "Application"
        },
        {
            "name": "Cluster_Security"
        },
        {
            "name": "Container"
        },
        {
            "name": "Resource_Management"
        },
        {
            "name": "Identity"
        },
        {
            "name": "Bc_Dr"
        },
        {
            "name": "Cluster_Multi"
        }
    ],
    "severities": [
        {
            "name": "High"
        },
        {
            "name": "Medium"
        },
        {
            "name": "Low"
        }
    ],
    "waf": [
        {
            "name": "Reliability"
        },
        {
            "name": "Security"
        },
        {
            "name": "Cost"
        },
        {
            "name": "Operations"
        },
        {
            "name": "Performance"
        }
    ],
    "yesno": [
        {
            "name": "Yes"
        },
        {
            "name": "No"
        }
    ],
    "status": [
        {
            "name": "Not verified",
            "description": "This check has not been looked at yet"
        },
        {
            "name": "Open",
            "description": "There is an action item associated to this check"
        },
        {
            "name": "Fulfilled",
            "description": "This check has been verified, and there are no further action items associated to it"
        },
        {
            "name": "Not required",
            "description": "Recommendation understood, but not needed by current requirements"
        },
        {
            "name": "N/A",
            "description": "Not applicable for current design"
        }
    ],
    "metadata": {
        "name": "The AKS Checklist",
        "waf": "none",
        "state": "preview",
        "timestamp": "July 14, 2024"
    }
}
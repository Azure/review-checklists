{
    "$schema": "checklist.schema.json",
    "categories": [
        {
            "name": "BCDR"
        },
        {
            "name": "Defensor"
        },
        {
            "name": "Encriptación"
        },
        {
            "name": "Identidad"
        },
        {
            "name": "Acceso privilegiado"
        },
        {
            "name": "Libro mayor"
        },
        {
            "name": "Registro"
        },
        {
            "name": "Gestión de redes"
        },
        {
            "name": "Descubrimiento y clasificación de datos"
        },
        {
            "name": "Enmascaramiento de datos"
        },
        {
            "name": "Código"
        }
    ],
    "items": [
        {
            "category": "BCDR",
            "description": "Asegúrese de que sus copias de seguridad estén protegidas contra ataques. Esto debe incluir el cifrado de las copias de seguridad para proteger contra la pérdida de confidencialidad. Para la copia de seguridad regular del servicio de Azure, los datos de copia de seguridad se cifran automáticamente con claves administradas por la plataforma Azure. También puede optar por cifrar la copia de seguridad mediante una clave administrada por el cliente. En este caso, asegúrese de que esta clave administrada por el cliente en el almacén de claves también esté en el ámbito de copia de seguridad.",
            "guid": "676f6951-0368-49e9-808d-c33a692c9a64",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/sql-database-security-baseline#br-2-encrypt-backup-data",
            "severity": "Medio",
            "subcategory": "Azure Key Vault",
            "text": "Proteja sus datos de copia de seguridad con cifrado y almacene claves de forma segura en Azure Key Vault"
        },
        {
            "category": "BCDR",
            "description": "Base de datos SQL de Azure usa la tecnología de SQL Server para crear copias de seguridad completas cada semana, copias de seguridad diferenciales cada 12 a 24 horas y copias de seguridad del registro de transacciones cada 5 a 10 minutos. De forma predeterminada, Base de datos SQL almacena datos en blobs de almacenamiento con redundancia geográfica que se replican en una región emparejada.",
            "guid": "e2518261-b3bc-4bd1-b331-637fb2df833f",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/sql-database-security-baseline#br-1-ensure-regular-automated-backups",
            "severity": "Medio",
            "subcategory": "Copia de seguridad",
            "text": "Configuración de copias de seguridad automatizadas de Base de datos SQL de Azure"
        },
        {
            "category": "BCDR",
            "description": "De forma predeterminada, Base de datos SQL almacena datos en blobs de almacenamiento con redundancia geográfica que se replican en una región emparejada. Para Base de datos SQL, la redundancia de almacenamiento de copia de seguridad se puede configurar en el momento de la creación de la base de datos o se puede actualizar para una base de datos existente; Los cambios realizados en una base de datos existente solo se aplican a futuras copias de seguridad.",
            "guid": "f8c7cda2-3ed7-43fb-a100-85dcd12a0ee4",
            "link": "https://learn.microsoft.com/azure/azure-sql/database/automated-backups-overview?tabs=single-database&view=azuresql#backup-storage-redundancy",
            "severity": "Bajo",
            "subcategory": "Copia de seguridad",
            "text": "Habilite el almacenamiento de copia de seguridad con redundancia geográfica para proteger contra fallas en una sola región y pérdida de datos"
        },
        {
            "category": "Código",
            "description": "El código malintencionado puede eludir potencialmente los controles de seguridad. Antes de implementar código personalizado en producción, es esencial revisar lo que se está implementando. Use una herramienta de base de datos como Azure Data Studio que admita el control de código fuente. Implementar herramientas y lógica para el análisis de código, vulnerabilidad y escaneo de credenciales.",
            "guid": "7ca9f006-d2a9-4652-951c-de8e4ac5e76e",
            "link": "https://learn.microsoft.com/azure/azure-sql/database/transparent-data-encryption-byok-create-server",
            "severity": "Medio",
            "subcategory": "Control de código fuente y revisión de código",
            "text": "Uso de sistemas de control de código fuente para almacenar, mantener y revisar el código de aplicación implementado en Azure SQLDB Database"
        },
        {
            "category": "Descubrimiento y clasificación de datos",
            "description": "En caso de requisitos de clasificación, Purview es la opción preferida. Solo use SQL Data Discovery & Classification en caso de que Purview no sea una opción. Descubra columnas que potencialmente contengan datos confidenciales. Lo que se considera datos confidenciales depende en gran medida del cliente, la regulación de cumplimiento, etc., y debe ser evaluado por los usuarios a cargo de esos datos. Clasifique las columnas para usar escenarios avanzados de auditoría y protección basados en sensibilidad. Revise los resultados del descubrimiento automatizado y finalice la clasificación si es necesario.",
            "guid": "d401509b-2629-4484-9a7f-af0d29a7778f",
            "link": "https://learn.microsoft.com/azure/azure-sql/database/data-discovery-and-classification-overview?view=azuresql#faq---advanced-classification-capabilities",
            "severity": "Bajo",
            "subcategory": "Descubrimiento y clasificación de datos",
            "text": "Planificar y configurar la clasificación y descubrimiento de datos para proteger los datos confidenciales"
        },
        {
            "category": "Enmascaramiento de datos",
            "description": "El uso de esta característica se recomienda solo si el cifrado de columnas no es una opción y existe un requisito específico para conservar los tipos y formatos de datos. El enmascaramiento dinámico de datos limita la exposición de datos confidenciales al enmascararlos a usuarios sin privilegios. El enmascaramiento dinámico de datos ayuda a evitar el acceso no autorizado a datos confidenciales al permitir a los clientes designar la cantidad de datos confidenciales que se revelarán con un impacto mínimo en la capa de aplicación.",
            "guid": "9391fd50-135e-453e-90a7-c1a23f88cc13",
            "link": "https://learn.microsoft.com/azure/azure-sql/database/dynamic-data-masking-overview",
            "severity": "Bajo",
            "subcategory": "Enmascaramiento de datos",
            "text": "Utilice el enmascaramiento de datos para evitar el acceso no autorizado a los datos de usuarios no administradores si no es posible el cifrado"
        },
        {
            "category": "Defensor",
            "description": "SQL Advanced Threat Detection (ATP) proporciona una capa de seguridad que detecta posibles vulnerabilidades y actividad anómala en bases de datos, como ataques de inyección SQL y patrones de comportamiento inusuales. Cuando se detecta una amenaza potencial, Detección de amenazas envía una alerta procesable en tiempo real por correo electrónico y en Microsoft Defender para la nube, que incluye pasos claros de investigación y corrección para la amenaza específica.",
            "guid": "4e52d73f-5d37-428f-b3a2-e6997e835979",
            "link": "https://learn.microsoft.com/azure/azure-sql/database/threat-detection-configure",
            "severity": "Alto",
            "subcategory": "Protección avanzada contra amenazas",
            "text": "Revisar y completar la configuración de Advanced Threat Protection (ATP)"
        },
        {
            "category": "Defensor",
            "description": "Habilite Microsoft Defender para Azure SQL en el nivel de suscripción para incorporar y proteger automáticamente todos los servidores y bases de datos existentes y futuros. Cuando se habilita en el nivel de suscripción, todas las bases de datos de Base de datos SQL de Azure y Instancia administrada de SQL de Azure están protegidas. A continuación, puede deshabilitarlos individualmente si lo desea. Si desea administrar manualmente qué bases de datos están protegidas, deshabilite en el nivel de suscripción y habilite cada base de datos que desee proteger.",
            "guid": "dff87489-9edb-4cef-bdda-86e8212b2aa1",
            "link": "https://learn.microsoft.com/azure/azure-sql/database/azure-defender-for-sql?view=azuresql#enable-microsoft-defender-for-sql ",
            "severity": "Alto",
            "subcategory": "Defender para Azure SQL",
            "text": "Habilitar Microsoft Defender para Azure SQL"
        },
        {
            "category": "Defensor",
            "description": "Microsoft Defender para Azure SQL ATP detecta actividades anómalas que indican intentos inusuales y potencialmente dañinos de acceso a bases de datos o aprovecharlas. Las alertas se pueden configurar y generar, y se informarán en el Defender para consola.",
            "guid": "ca342fdf-d25a-4427-b105-fcd50ff8a0ea",
            "link": "https://learn.microsoft.com/azure/azure-sql/database/threat-detection-configure",
            "severity": "Alto",
            "subcategory": "Defender para Azure SQL",
            "text": "Preparar un plan de respuesta de seguridad para reaccionar rápidamente a las alertas SQL de Microsoft Defender para Azure"
        },
        {
            "category": "Defensor",
            "description": "La evaluación de vulnerabilidades de Azure SQLDB es un servicio que proporciona visibilidad del estado de seguridad. La evaluación de vulnerabilidades incluye pasos prácticos para resolver problemas de seguridad y mejorar la seguridad de la base de datos. Puede ayudarle a supervisar un entorno de base de datos dinámico donde los cambios son difíciles de rastrear y mejorar su postura de seguridad SQL.",
            "guid": "a6101ae7-534c-45ab-86fd-b34c55ea21ca",
            "link": "https://learn.microsoft.com/azure/defender-for-cloud/sql-azure-vulnerability-assessment-overview",
            "severity": "Alto",
            "subcategory": "Evaluación de vulnerabilidades",
            "text": "Configurar los hallazgos de la evaluación de vulnerabilidades (VA) y revisar las recomendaciones"
        },
        {
            "category": "Defensor",
            "description": "Microsoft Defender para la nube proporciona una evaluación de vulnerabilidades para las bases de datos SQL de Azure. La evaluación de vulnerabilidades analiza las bases de datos en busca de vulnerabilidades de software y proporciona una lista de hallazgos. Puede usar los hallazgos para corregir vulnerabilidades de software y deshabilitar hallazgos.",
            "guid": "c8c5f112-1e50-4f77-9264-8195b4cd61ac",
            "link": "https://learn.microsoft.com/azure/defender-for-cloud/sql-azure-vulnerability-assessment-find?view=azuresql",
            "severity": "Alto",
            "subcategory": "Evaluación de vulnerabilidades",
            "text": "Revisar regularmente los hallazgos y recomendaciones de la Evaluación de Vulnerabilidades (VA) y preparar un plan para corregir"
        },
        {
            "category": "Encriptación",
            "description": "Always Encrypted with Secure Enclaves amplía las capacidades informáticas confidenciales de Always Encrypted al permitir el cifrado in situ y consultas confidenciales más ricas. Always Encrypted with Secure Enclaves aborda estas limitaciones al permitir algunos cálculos en datos de texto sin formato dentro de un enclave seguro en el lado del servidor. Se recomienda el uso de esta función para los casos en los que necesite limitar el acceso de administrador y necesite que sus consultas admitan más que la coincidencia de igualdad de columnas cifradas.",
            "guid": "65d7e54a-10a6-4094-b673-9ff3809c9277",
            "link": "https://learn.microsoft.com/sql/relational-databases/security/encryption/always-encrypted-enclaves",
            "severity": "Medio",
            "subcategory": "Siempre encriptado",
            "text": "Si proteger los datos PII confidenciales de los usuarios administradores es un requisito clave, pero no se pueden tolerar las limitaciones del cifrado de columnas, considere la adopción de Always Encrypted with Secure Enclaves"
        },
        {
            "category": "Encriptación",
            "description": "Con Base de datos SQL de Azure, puede aplicar cifrado simétrico a una columna de datos mediante Transact-SQL. Este enfoque se denomina cifrado de columnas, ya que puede usarlo para cifrar columnas específicas con diferentes claves de cifrado. Hacerlo le brinda una capacidad de cifrado más granular que TDE, que cifra los datos en las páginas. Usar Always Encrypted para garantizar que los datos confidenciales no se expongan en texto sin formato en Base de datos SQL de Azure o Instancia administrada de SQL, incluso en memoria o en uso. Always Encrypted protege los datos de los administradores de bases de datos (DBA) y los administradores de la nube (o los malos actores que pueden hacerse pasar por usuarios con altos privilegios pero no autorizados) y le da más control sobre quién puede acceder a sus datos.",
            "guid": "c03ce136-e3d5-4e17-bf25-ed955ee480d3",
            "link": "https://learn.microsoft.com/azure/azure-sql/database/security-best-practice?view=azuresql#control-access-of-application-users-to-sensitive-data-through-encryption",
            "severity": "Bajo",
            "subcategory": "Cifrado de columnas",
            "text": "Para proteger los datos confidenciales de PII de usuarios que no son administradores en columnas de tabla específicas, considere la posibilidad de usar el cifrado de columnas"
        },
        {
            "category": "Encriptación",
            "description": "Habilitado de forma predeterminada, el cifrado de datos transparente (TDE) ayuda a proteger los archivos de base de datos contra la divulgación de información mediante el cifrado y descifrado en tiempo real de la base de datos, las copias de seguridad asociadas y los archivos de registro de transacciones \"en reposo\", sin necesidad de realizar cambios en la aplicación.",
            "guid": "c614ac47-bebf-4061-b0a1-43e0c6b5e00d",
            "link": "https://learn.microsoft.com/azure/azure-sql/database/transparent-data-encryption-byok-create-server",
            "severity": "Alto",
            "subcategory": "Cifrado de datos transparente",
            "text": "Asegúrese de que el cifrado de datos transparente (TDE) se mantenga habilitado"
        },
        {
            "category": "Encriptación",
            "description": "Si se requiere la separación de tareas en la administración de claves y datos dentro de la organización, aproveche Customer Managed Keys (CMK) for Transparent Data Encryption (TDE) para su SQLDB de Azure y use Azure Key Vault para almacenar (consulte su lista de comprobación). Aproveche esta característica cuando tenga requisitos de seguridad estrictos que no puedan cumplir las claves de servicio administradas.",
            "guid": "2edb4165-4f54-47cc-a891-5c82c2f21e25",
            "link": "https://learn.microsoft.com/azure/azure-sql/database/transparent-data-encryption-byok-overview",
            "severity": "Medio",
            "subcategory": "Cifrado de datos transparente",
            "text": "Use claves administradas por el cliente (CMK) en Azure Key Vault (AKV) si necesita mayor transparencia y control granular sobre la protección TDE"
        },
        {
            "category": "Encriptación",
            "description": "La configuración de versión mínima de Seguridad de la capa de transporte (TLS) permite a los clientes elegir qué versión de TLS utiliza su base de datos SQL. Es posible cambiar la versión mínima de TLS mediante Azure Portal, Azure PowerShell y la CLI de Azure.",
            "guid": "7754b605-57fd-4bcb-8213-52c39d8e8225",
            "link": "https://learn.microsoft.com/azure/azure-sql/database/connectivity-settings?source=recommendations&view=azuresql&tabs=azure-portal#minimal-tls-version",
            "severity": "Alto",
            "subcategory": "Seguridad de la capa de transporte",
            "text": "Aplicar la versión mínima de TLS a la última disponible"
        },
        {
            "category": "Identidad",
            "description": "Use la autenticación de Azure Active Directory (Azure AD) para la administración centralizada de identidades. Utilice la autenticación de SQL solo si es realmente necesario y documente como excepciones.",
            "guid": "c9b8b6bf-2c6b-453d-b400-de9a43a549d7",
            "link": "https://learn.microsoft.com/azure/azure-sql/database/authentication-aad-overview",
            "severity": "Medio",
            "subcategory": "Azure Active Directory",
            "text": "Aprovechar la autenticación de Azure AD para las conexiones a Bases de datos SQL de Azure"
        },
        {
            "category": "Identidad",
            "description": "El uso de grupos de Azure AD simplifica la administración de permisos y tanto el propietario del grupo como el propietario del recurso pueden agregar o quitar miembros del grupo. Cree un grupo independiente para los administradores de Azure AD para cada servidor lógico. Supervise los cambios de pertenencia a grupos de Azure AD mediante los informes de actividad de auditoría de Azure AD.",
            "guid": "29820254-1d14-4778-ae90-ff4aeba504a3",
            "link": "https://learn.microsoft.com/azure/azure-sql/database/security-best-practice?view=azuresql#central-management-for-identities",
            "severity": "Medio",
            "subcategory": "Azure Active Directory",
            "text": "Creación de un grupo de Azure AD independiente con dos cuentas de administrador para cada servidor lógico de Base de datos SQL de Azure"
        },
        {
            "category": "Identidad",
            "description": "Asegúrese de que se usan distintas identidades administradas asignadas por el sistema y el usuario, dedicadas a la función, con menos permisos asignados, para la comunicación entre los servicios y aplicaciones de Azure a las bases de datos SQLDB de Azure.",
            "guid": "df3a09ee-03bb-4198-8637-d141acf5f289",
            "link": "https://learn.microsoft.com/azure/azure-sql/database/security-best-practice?view=azuresql#minimize-the-use-of-password-based-authentication-for-applications",
            "severity": "Medio",
            "subcategory": "Azure Active Directory",
            "text": "Minimice el uso de la autenticación basada en contraseña para las aplicaciones"
        },
        {
            "category": "Identidad",
            "description": "Las identidades administradas asignadas por el sistema o el usuario permiten que Azure SQLDB se autentique en otros servicios en la nube (por ejemplo, Azure Key Vault) sin almacenar credenciales en el código. Una vez habilitado, se pueden conceder todos los permisos necesarios a través de Azure role-based-access-control a la instancia específica de Azure SQLDB. No comparta identidades administradas asignadas por el usuario en varios servicios si no es estrictamente necesario.",
            "guid": "69891194-5074-4e30-8f69-4efc3c580900",
            "link": "https://learn.microsoft.com/azure/active-directory/managed-identities-azure-resources/overview",
            "severity": "Bajo",
            "subcategory": "Identidades administradas",
            "text": "Asignación de una identidad administrada a Base de datos SQL de Azure para el acceso a recursos salientes"
        },
        {
            "category": "Identidad",
            "description": "Use una autenticación integrada de Azure AD que elimine el uso de contraseñas. Los métodos de autenticación basados en contraseña son una forma más débil de autenticación. Las credenciales pueden verse comprometidas o regalarse por error. Use la autenticación de inicio de sesión único con credenciales de Windows. Federe el dominio de AD local con Azure AD y use la autenticación integrada de Windows (para máquinas unidas a un dominio con Azure AD).",
            "guid": "88287d4a-8bb8-4640-ad78-03f51354d003",
            "link": "https://learn.microsoft.com/azure/azure-sql/database/authentication-aad-configure?view=azuresql&tabs=azure-powershell#active-directory-integrated-authentication",
            "severity": "Medio",
            "subcategory": "Contraseñas",
            "text": "Minimice el uso de la autenticación basada en contraseña para los usuarios"
        },
        {
            "category": "Libro mayor",
            "description": "El hash del último bloque en el libro mayor de la base de datos se denomina resumen de la base de datos. Representa el estado de todas las tablas de contabilidad de la base de datos en el momento en que se generó el bloque. Generar un resumen de base de datos es eficiente, ya que implica calcular solo los hashes de los bloques que se agregaron recientemente. Azure Confidential Ledger es uno de los almacenes compatibles, se puede usar y admite la generación y el almacenamiento automáticos de resúmenes de bases de datos. Azure Ledger proporciona características de seguridad avanzadas como Blockchain Ledger Proof y Confidential Hardware Enclaves. Úselo solo si se requieren características de seguridad avanzadas y, de lo contrario, vuelva al almacenamiento de Azure.",
            "guid": "0e853380-50ba-4bce-b2fd-5c7391c85ecc",
            "link": "https://learn.microsoft.com/azure/architecture/guide/technology-choices/multiparty-computing-service#confidential-ledger-and-azure-blob-storage",
            "severity": "Medio",
            "subcategory": "Resumen de base de datos",
            "text": "Usar Azure Confidential Ledger para almacenar resúmenes de base de datos solo si se requieren características de seguridad avanzadas"
        },
        {
            "category": "Libro mayor",
            "description": "El hash del último bloque en el libro mayor de la base de datos se denomina resumen de la base de datos. Representa el estado de todas las tablas de contabilidad de la base de datos en el momento en que se generó el bloque. Generar un resumen de base de datos es eficiente, ya que implica calcular solo los hashes de los bloques que se agregaron recientemente. La característica Azure Blob Storage with Immutable Storage se puede usar y admite la generación y el almacenamiento automáticos de resúmenes de bases de datos. Para evitar la manipulación de los archivos de resumen, configure y bloquee una directiva de retención para el contenedor.",
            "guid": "afefb2d3-95da-4ac9-acf5-33d18b32ef9a",
            "link": "https://learn.microsoft.com/sql/relational-databases/security/ledger/ledger-digest-management",
            "severity": "Medio",
            "subcategory": "Resumen de base de datos",
            "text": "Si se usa la cuenta de almacenamiento de Azure para almacenar resúmenes de base de datos, asegúrese de que la seguridad esté configurada correctamente"
        },
        {
            "category": "Libro mayor",
            "description": "El libro mayor proporciona una forma de integridad de datos denominada integridad hacia adelante, que proporciona evidencia de manipulación de datos en los datos de las tablas del libro mayor. El proceso de verificación de la base de datos toma como entrada uno o más resúmenes de base de datos generados previamente. A continuación, vuelve a calcular los hashes almacenados en el libro mayor de la base de datos en función del estado actual de las tablas del libro mayor. Si los hashes calculados no coinciden con los resúmenes de entrada, se produce un error en la verificación. El error indica que los datos han sido manipulados. El proceso de verificación informa de todas las inconsistencias que detecta.",
            "guid": "f8d4ffda-8aac-4cc6-b72b-c81cb8625420",
            "link": "https://learn.microsoft.com/sql/relational-databases/security/ledger/ledger-database-verification",
            "severity": "Medio",
            "subcategory": "Integridad",
            "text": "Programe el proceso de verificación del libro mayor regularmente para verificar la integridad de los datos"
        },
        {
            "category": "Libro mayor",
            "description": "La función Ledger proporciona capacidades de evidencia de manipulación en su base de datos. Puede dar fe criptográficamente a otras partes, como auditores u otras partes comerciales, de que sus datos no han sido manipulados. Ledger ayuda a proteger los datos de cualquier atacante o usuario con privilegios altos, incluidos los administradores de bases de datos (DBA), los administradores de sistemas y los administradores de la nube.",
            "guid": "2563f498-e2d3-42ea-9e7b-5517881a06a2",
            "link": "https://learn.microsoft.com/sql/relational-databases/security/ledger/ledger-overview",
            "severity": "Medio",
            "subcategory": "Libro mayor",
            "text": "Si la prueba criptográfica de la integridad de los datos es un requisito crítico, se debe considerar la función Ledger"
        },
        {
            "category": "Libro mayor",
            "description": "Dependiendo del tipo de manipulación, hay casos en los que puede reparar el libro mayor sin perder datos. En el artículo contenido en la columna --Más información-- se describen diferentes escenarios y técnicas de recuperación.",
            "guid": "804fc554-6554-4842-91c1-713b32f99902",
            "link": "https://learn.microsoft.com/sql/relational-databases/security/ledger/ledger-how-to-recover-after-tampering",
            "severity": "Medio",
            "subcategory": "Recuperación",
            "text": "Preparar un plan de respuesta para investigar y reparar una base de datos después de un evento de manipulación"
        },
        {
            "category": "Registro",
            "description": "Azure SQL Database Auditing realiza un seguimiento de los eventos de la base de datos y los escribe en un registro de auditoría de la cuenta de almacenamiento de Azure. La auditoría le ayuda a comprender la actividad de la base de datos y a obtener información sobre discrepancias y anomalías que podrían indicar problemas empresariales o sospechas de infracciones de seguridad, así como a cumplir las normativas. De forma predeterminada, la directiva de auditoría incluye todas las acciones (consultas, procedimientos almacenados e inicios de sesión correctos y erróneos) en las bases de datos, lo que puede dar lugar a un gran volumen de registros de auditoría. Se recomienda que los clientes configuren la auditoría para diferentes tipos de acciones y grupos de acciones mediante PowerShell.",
            "guid": "4082e31d-35f4-4a49-8507-d3172cc930a6",
            "link": "https://learn.microsoft.com/azure/azure-sql/database/auditing-overview",
            "severity": "Medio",
            "subcategory": "Auditoría",
            "text": "Asegúrese de que Azure SQL Database Auditing está habilitado en el nivel de servidor"
        },
        {
            "category": "Registro",
            "description": "Los registros de auditoría de Base de datos SQL de Azure se pueden escribir en cuentas de almacenamiento externo, en el área de trabajo de Log Analytics o en el Centro de eventos. Asegúrese de proteger el repositorio de destino mediante copias de seguridad y configuración segura. Use Azure SQL Database Managed Identity para acceder al almacenamiento y establecer un período de retención explícito. No conceda permisos a los administradores para el repositorio del registro de auditoría. Utilice un almacenamiento de destino diferente para --Habilitación de la auditoría de las operaciones de soporte técnico de Microsoft--. ",
            "guid": "9b64bc50-b60f-4035-bf7a-28c4806dfb46",
            "link": "https://learn.microsoft.com/azure/azure-sql/database/auditing-overview",
            "severity": "Bajo",
            "subcategory": "Auditoría",
            "text": "Asegúrese de que los registros de auditoría de Base de datos SQL de Azure están respaldados y protegidos en el tipo de repositorio seleccionado"
        },
        {
            "category": "Registro",
            "description": "El registro de actividad de Azure Monitor es un registro de plataforma en Azure que proporciona información sobre los eventos de nivel de suscripción. El registro de actividad incluye información como cuando se modifica un recurso. Se recomienda enviar este registro de actividad al mismo repositorio de almacenamiento externo que el registro de auditoría de Base de datos SQL de Azure (cuenta de almacenamiento, área de trabajo de Log Analytics, Centro de eventos).",
            "guid": "fcd34708-87ac-4efc-aaf6-57a47f76644a",
            "link": "https://learn.microsoft.com/azure/azure-monitor/essentials/activity-log",
            "severity": "Medio",
            "subcategory": "Auditoría",
            "text": "Asegúrese de que el registro de actividad de Base de datos SQL de Azure se recopila e integra con los registros de auditoría"
        },
        {
            "category": "Registro",
            "description": "Reenvíe los registros de Azure SQL a su administración de eventos e información de seguridad (SIEM) y a Security Orchestration Automation and Response (SOAR). Asegúrese de que está supervisando diferentes tipos de activos de Azure para detectar posibles amenazas y anomalías. Concéntrese en obtener alertas de alta calidad para reducir los falsos positivos para que los analistas los clasifiquen. Las alertas pueden obtenerse de datos de registro, agentes u otros datos.",
            "guid": "f96e127e-9572-453a-b325-ff89ae9f6b44",
            "link": "https://learn.microsoft.com/azure/azure-sql/database/auditing-overview",
            "severity": "Medio",
            "subcategory": "SIEM/SOAR",
            "text": "Asegúrese de que los registros de auditoría de Base de datos SQL de Azure se presentan en SIEM/SOAR de su organización"
        },
        {
            "category": "Registro",
            "description": "Reenvíe los registros de Azure SQL a su Administración de eventos e información de seguridad (SIEM) y Automatización y respuesta de orquestación de seguridad (SOAR), que se pueden usar para configurar detecciones de amenazas personalizadas. Asegúrese de que está supervisando diferentes tipos de activos de Azure para detectar posibles amenazas y anomalías. Concéntrese en obtener alertas de alta calidad para reducir los falsos positivos para que los analistas los clasifiquen. Las alertas pueden obtenerse de datos de registro, agentes u otros datos.",
            "guid": "41503bf8-73da-4a10-af9f-5f7fceb5456f",
            "link": "https://learn.microsoft.com/azure/azure-monitor/essentials/activity-log",
            "severity": "Medio",
            "subcategory": "SIEM/SOAR",
            "text": "Asegúrese de que los datos del registro de actividad de Base de datos SQL de Azure se presentan en su SIEM/SOAR"
        },
        {
            "category": "Registro",
            "description": "El equipo del Centro de Operaciones de Seguridad (SOC) debe crear un plan de respuesta a incidentes (cuadernos de jugadas o respuestas manuales) para investigar y mitigar la manipulación, las actividades maliciosas y otros comportamientos anómalos.",
            "guid": "19ec7c97-c563-4e1d-82f0-54d6ec12e754",
            "link": "https://learn.microsoft.com/azure/azure-monitor/essentials/activity-log",
            "severity": "Medio",
            "subcategory": "SIEM/SOAR",
            "text": "Asegúrese de que tiene planes de respuesta para eventos de registro de auditoría malintencionados o aberrantes"
        },
        {
            "category": "Gestión de redes",
            "description": "Al crear un servidor lógico desde Azure Portal para Base de datos SQL de Azure, el resultado es un punto de conexión público visible y accesible a través de la red pública (acceso público). A continuación, puede limitar la conectividad en función de las reglas de firewall y Service Endpoint. También puede configurar la conectividad privada limitando solo las conexiones a redes internas mediante Private Endpoint (Private Access). El acceso privado mediante un punto de conexión privado debe ser el valor predeterminado, a menos que se aplique un caso de negocio o una razón técnica o de rendimiento que no pueda admitirlo. El uso de puntos finales privados tiene implicaciones de rendimiento que deben tenerse en cuenta y evaluarse.",
            "guid": "2c6d356a-1784-475b-a42c-ec187dc8c925",
            "link": "https://learn.microsoft.com/azure/azure-sql/database/network-access-controls-overview",
            "severity": "Alto",
            "subcategory": "Conectividad",
            "text": "Revise los métodos de conectividad de acceso público frente al acceso privado y seleccione el adecuado para la carga de trabajo"
        },
        {
            "category": "Gestión de redes",
            "description": "IMPORTANTE: Las conexiones a un punto de enlace privado solo admiten proxy como directiva de conexión. Cuando se usan puntos de conexión privados, las conexiones se envían mediante proxy a través de la puerta de enlace de Base de datos SQL de Azure a los nodos de la base de datos. Los clientes no tendrán una conexión directa.",
            "guid": "557b3ce5-bada-4296-8d52-a2d447bc1718",
            "link": "https://learn.microsoft.com/azure/azure-sql/database/connectivity-architecture",
            "severity": "Bajo",
            "subcategory": "Conectividad",
            "text": "Mantener la directiva de conexión predeterminada de Base de datos SQL de Azure si no se requiere y justifica de manera diferente"
        },
        {
            "category": "Gestión de redes",
            "description": "Esta opción configura el firewall para permitir todas las conexiones de Azure, incluidas las conexiones de las suscripciones de otros clientes. Si selecciona esta opción, asegúrese de que sus permisos de inicio de sesión y de usuario limiten el acceso solo a usuarios autorizados. Si no es estrictamente necesario, mantenga esta configuración en OFF.",
            "guid": "f48efacf-4405-4e8d-9dd0-16c5302ed082",
            "link": "https://learn.microsoft.com/azure/azure-sql/database/network-access-controls-overview",
            "severity": "Alto",
            "subcategory": "Conectividad",
            "text": "Asegúrese de que la opción Permitir que los servicios y recursos de Azure accedan a este servidor esté deshabilitada en el firewall de Base de datos SQL de Azure."
        },
        {
            "category": "Gestión de redes",
            "description": "Base de datos SQL de Azure tiene una nueva característica integrada que permite la integración nativa con puntos de conexión REST externos. Esto significa que la integración de Azure SQL Database con Azure Functions, Azure Logic Apps, Cognitive Services, Event Hubs, Event Grid, Azure Containers, API Management y, en general, cualquier punto de conexión REST o incluso GraphQL. Si no se restringe correctamente, el código dentro de una base de datos de Base de datos SQL de Azure podría aprovechar este mecanismo para filtrar datos. Si no es estrictamente necesario, se recomienda bloquear o restringir esta función mediante las reglas de firewall saliente.",
            "guid": "cb3274a7-e36d-46f6-8de5-46d30c8dde8e",
            "link": "https://learn.microsoft.com/sql/relational-databases/system-stored-procedures/sp-invoke-external-rest-endpoint-transact-sql",
            "severity": "Medio",
            "subcategory": "Control de salida",
            "text": "Bloquear o restringir las llamadas salientes a la API de REST a puntos de conexión externos"
        },
        {
            "category": "Gestión de redes",
            "description": "Las reglas de firewall saliente limitan el tráfico de red desde el servidor lógico de Base de datos SQL de Azure a una lista definida por el cliente de cuentas de almacenamiento de Azure y servidores lógicos de Base de datos SQL de Azure. Se deniega cualquier intento de obtener acceso a cuentas de almacenamiento o bases de datos que no estén en esta lista.",
            "guid": "a566dd3d-314e-4a94-9378-102c42d82b38",
            "link": "https://learn.microsoft.com/azure/azure-sql/database/outbound-firewall-rule-overview",
            "severity": "Medio",
            "subcategory": "Control de salida",
            "text": "Si se requiere acceso a la red saliente, se recomienda configurar las restricciones de red salientes mediante la característica de control integrada Base de datos SQL de Azure."
        },
        {
            "category": "Gestión de redes",
            "description": "Private Endpoint se crea dentro de una subred en una red virtual de Azure. La configuración de seguridad adecuada debe aplicarse también al entorno de red que lo contiene, incluidos NSG / ASG, UDR, firewall, monitoreo y auditoría.",
            "guid": "246cd832-f550-4af0-9c74-ca9baeeb8860",
            "link": "https://learn.microsoft.com/azure/azure-sql/database/private-endpoint-overview?view=azuresql#disable-public-access-to-your-logical-server",
            "severity": "Medio",
            "subcategory": "Acceso privado",
            "text": "Si se usa la conectividad de acceso privado, asegúrese de que está usando las listas de comprobación Punto de conexión privado, Red virtual de Azure, Firewall de Azure y Grupo de seguridad de red de Azure."
        },
        {
            "category": "Gestión de redes",
            "description": "Al agregar una conexión de extremo privado, el enrutamiento público al servidor lógico no se bloquea de forma predeterminada. En el panel --Firewall y redes virtuales-- , la configuración --Denegar acceso a la red pública-- no está seleccionada de forma predeterminada. Para deshabilitar el acceso a la red pública, asegúrese de seleccionar --Denegar acceso a la red pública--.",
            "guid": "3a0808ee-ea7a-47ab-bdce-920a6a2b3881",
            "link": "https://learn.microsoft.com/azure/azure-sql/database/private-endpoint-overview?view=azuresql#disable-public-access-to-your-logical-server",
            "severity": "Alto",
            "subcategory": "Acceso privado",
            "text": "Si se usa el extremo privado (acceso privado), considere la posibilidad de deshabilitar la conectividad de acceso público"
        },
        {
            "category": "Gestión de redes",
            "description": "El grupo de seguridad de red (NSG) y el grupo de seguridad de aplicaciones (ASG) ahora se pueden aplicar a subredes que contienen puntos de conexión privados para restringir las conexiones a Azure SQLDB en función de intervalos IP de origen internos.",
            "guid": "8600527e-e8c4-4424-90ef-1f0dca0224f2",
            "link": "https://learn.microsoft.com/azure/private-link/private-endpoint-overview#network-security-of-private-endpoints",
            "severity": "Medio",
            "subcategory": "Acceso privado",
            "text": "Si se usa Private Endpoint (Private Access), aplique NSG y, finalmente, ASG para limitar los intervalos de direcciones IP de origen entrantes"
        },
        {
            "category": "Gestión de redes",
            "description": "Una instancia administrada (SQL MI) se puede aislar dentro de una red virtual para evitar el acceso externo. Las aplicaciones y herramientas que se encuentran en la misma red virtual o emparejada en la misma región podrían acceder a ella directamente. Las aplicaciones y herramientas que se encuentran en diferentes regiones podrían usar la conexión de red virtual a red virtual o el emparejamiento de circuitos ExpressRoute para establecer la conexión. El cliente debe usar grupos de seguridad de red (NSG) y, finalmente, firewalls internos, para restringir el acceso a través del puerto 1433 solo a los recursos que requieren acceso a una instancia administrada.",
            "guid": "18123ef4-a0a6-45e3-87fe-7f454f65d975",
            "link": "https://learn.microsoft.com/azure/azure-sql/managed-instance/connectivity-architecture-overview",
            "severity": "Medio",
            "subcategory": "Acceso privado",
            "text": "Aplicación de grupos de seguridad de red (NSG) y reglas de firewall para restringir el acceso a la subred interna de Azure SQL Managed Instance"
        },
        {
            "category": "Gestión de redes",
            "description": "Azure Virtual Network Service Endpoint es la solución preferida si desea establecer una conexión directa con los nodos back-end de Base de datos SQL de Azure mediante la directiva Redirect. Esto permitirá el acceso en modo de alto rendimiento y es el enfoque recomendado desde una perspectiva de rendimiento.",
            "guid": "55187443-6852-4fbd-99c6-ce303597ca7f",
            "link": "https://learn.microsoft.com/azure/azure-sql/database/network-access-controls-overview?view=azuresql#ip-vs-virtual-network-firewall-rules",
            "severity": "Alto",
            "subcategory": "Acceso público",
            "text": "Si se usa la conectividad de acceso público, aproveche Service Endpoint para restringir el acceso desde redes virtuales de Azure seleccionadas"
        },
        {
            "category": "Gestión de redes",
            "description": "El firewall de Base de datos SQL de Azure permite especificar intervalos de direcciones IP desde los que se aceptan las comunicaciones. Este enfoque está bien para direcciones IP estables que están fuera de la red privada de Azure.",
            "guid": "a73e32da-b3f4-4960-b5ec-2f42a557bf31",
            "link": "https://learn.microsoft.com/azure/azure-sql/database/network-access-controls-overview",
            "severity": "Medio",
            "subcategory": "Acceso público",
            "text": "Si se usa conectividad de acceso público, asegúrese de que solo se agreguen IP conocidas específicas al firewall."
        },
        {
            "category": "Gestión de redes",
            "description": "Se recomienda utilizar reglas de firewall IP de nivel de base de datos siempre que sea posible. Esta práctica mejora la seguridad y hace que su base de datos sea más portátil. Utilice reglas de firewall IP de nivel de servidor para los administradores. Utilícelos también cuando tenga muchas bases de datos que tengan los mismos requisitos de acceso y no desee configurar cada base de datos individualmente.",
            "guid": "e0f31ac9-35c8-4bfd-9865-edb60ffc6768",
            "link": "https://learn.microsoft.com/azure/azure-sql/database/firewall-configure",
            "severity": "Bajo",
            "subcategory": "Acceso público",
            "text": "Si las reglas de firewall de Base de datos SQL de Azure usan y controlan la conectividad de acceso público, use reglas IP de nivel de base de datos sobre de nivel de servidor"
        },
        {
            "category": "Gestión de redes",
            "description": "Una instancia administrada (SQL MI) se puede aislar dentro de una red virtual para evitar el acceso externo. El punto de enlace público de instancia administrada no está habilitado de forma predeterminada, debe habilitarse explícitamente, solo si es estrictamente necesario. Si la directiva de la empresa no permite el uso de puntos de conexión públicos, use Azure Policy para evitar la habilitación de puntos de conexión públicos en primer lugar.",
            "guid": "b8435656-143e-41a8-9922-61d34edb751a",
            "link": "https://learn.microsoft.com/azure/azure-sql/managed-instance/public-endpoint-overview",
            "severity": "Alto",
            "subcategory": "Acceso público",
            "text": "No habilitar el punto de conexión público de Azure SQL Managed Instance"
        },
        {
            "category": "Gestión de redes",
            "description": "Un extremo público de instancia administrada (SQL MI) no está habilitado de forma predeterminada, debe habilitarse explícitamente, solo si es estrictamente necesario. En este caso, se recomienda aplicar un grupo de seguridad de red (NSG) para restringir el acceso al puerto 3342 solo a las direcciones IP de origen de confianza.",
            "guid": "057dd298-8726-4aa6-b590-1f81d2e30421",
            "link": "https://learn.microsoft.com/azure/azure-sql/managed-instance/public-endpoint-overview",
            "severity": "Alto",
            "subcategory": "Acceso público",
            "text": "Restringir el acceso si se requiere un punto de conexión público de Azure SQL Managed Instance"
        },
        {
            "category": "Acceso privilegiado",
            "description": "La mayoría de las operaciones, el soporte técnico y la solución de problemas realizados por el personal y los subprocesadores de Microsoft no requieren acceso a los datos del cliente. En las raras circunstancias en las que se requiere dicho acceso, Customer Lockbox for Microsoft Azure proporciona una interfaz para que los clientes revisen y aprueben o rechacen las solicitudes de acceso a los datos del cliente.  En escenarios de soporte técnico en los que Microsoft necesita acceder a los datos del cliente, Base de datos SQL de Azure admite Customer Lockbox para proporcionar una interfaz para que pueda revisar y aprobar o rechazar las solicitudes de acceso a datos del cliente.",
            "guid": "37b6eb0f-553d-488f-8a8a-cb9bf97388ff",
            "link": "https://learn.microsoft.com/azure/security/fundamentals/customer-lockbox-overview",
            "severity": "Bajo",
            "subcategory": "Caja",
            "text": "Revisión y habilitación del acceso de Microsoft a Customer Lockbox para Azure SQL Database"
        },
        {
            "category": "Acceso privilegiado",
            "description": "El principio de privilegios mínimos establece que los usuarios no deben tener más privilegios de los necesarios para completar sus tareas. Los usuarios de bases de datos y servidores con privilegios altos pueden realizar muchas actividades de configuración y mantenimiento en la base de datos y también pueden quitar bases de datos en la instancia de Azure SQL. El seguimiento de los propietarios de bases de datos y las cuentas privilegiadas es importante para evitar tener permisos excesivos.",
            "guid": "5fe5281f-f0f9-4842-a682-8baf18bd8316",
            "link": "https://learn.microsoft.com/azure/azure-sql/database/security-best-practice?view=azuresql#implement-principle-of-least-privilege",
            "severity": "Medio",
            "subcategory": "Permisos",
            "text": "Asegúrese de que a los usuarios se les asigne el nivel mínimo de acceso necesario para completar sus funciones de trabajo"
        },
        {
            "category": "Acceso privilegiado",
            "description": "El ámbito de las identidades (tanto Usuarios como SPN) debe tener la menor cantidad de acceso necesaria para realizar la función.  Se debe usar un mayor número de SPN de ámbito estricto, en lugar de tener un SPN con varios conjuntos de permisos no relacionados. Por ejemplo, si hay tres aplicaciones web externas hospedadas localmente que realizan consultas a Base de datos SQL de Azure, no todas deben usar el mismo SPN para estas actividades.  En su lugar, cada uno debe tener su propio SPN de alcance estricto.",
            "guid": "7b5b55e5-4750-4920-be97-eb726c256a5c",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/sql-database-security-baseline#im-3-use-azure-ad-single-sign-on-sso-for-application-access",
            "severity": "Bajo",
            "subcategory": "Permisos",
            "text": "Asegúrese de que a distintas aplicaciones se les asignarán credenciales diferentes con permisos mínimos para acceder a Base de datos SQL de Azure."
        }
    ],
    "metadata": {
        "name": "Azure SQLDB Security Checklist (Preview)"
    },
    "severities": [
        {
            "name": "Alto"
        },
        {
            "name": "Medio"
        },
        {
            "name": "Bajo"
        }
    ],
    "status": [
        {
            "description": "Esta comprobación aún no se ha examinado",
            "name": "No verificado"
        },
        {
            "description": "Hay un elemento de acción asociado a esta comprobación",
            "name": "Abrir"
        },
        {
            "description": "Esta comprobación se ha comprobado y no hay más elementos de acción asociados a ella",
            "name": "Cumplido"
        },
        {
            "description": "Recomendación entendida, pero no necesaria por los requisitos actuales",
            "name": "No es necesario"
        },
        {
            "description": "No aplicable para el diseño actual",
            "name": "N/A"
        }
    ]
}
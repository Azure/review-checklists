{
    "categories": [
        {
            "name": "Inquilinos de Facturación de Azure y de Id. de Microsoft Entra"
        },
        {
            "name": "Gestión de identidades y accesos"
        },
        {
            "name": "Topología y conectividad de red"
        },
        {
            "name": "Seguridad"
        },
        {
            "name": "Administración"
        },
        {
            "name": "Organización de recursos"
        },
        {
            "name": "Automatización de plataformas y DevOps"
        },
        {
            "name": "Gobernanza"
        }
    ],
    "items": [
        {
            "category": "Inquilinos de Facturación de Azure y de Id. de Microsoft Entra",
            "guid": "70c15989-c726-42c7-b0d3-24b7375b9201",
            "id": "A01.01",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/multi-tenant/considerations-recommendations",
            "service": "Entra",
            "severity": "Medio",
            "subcategory": "Inquilinos de Microsoft Entra ID",
            "text": "Use un inquilino de Entra para administrar los recursos de Azure, a menos que tenga un requisito normativo o empresarial claro para varios inquilinos.",
            "waf": "Operaciones"
        },
        {
            "category": "Inquilinos de Facturación de Azure y de Id. de Microsoft Entra",
            "guid": "6309957b-821a-43d1-b9d9-7fcf1802b747",
            "id": "A01.02",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/multi-tenant/automation",
            "service": "Entra",
            "severity": "Bajo",
            "subcategory": "Inquilinos de Microsoft Entra ID",
            "text": "Asegúrese de que tiene un enfoque de automatización multiinquilino para administrar los inquilinos de Microsoft Entra ID",
            "waf": "Operaciones"
        },
        {
            "category": "Inquilinos de Facturación de Azure y de Id. de Microsoft Entra",
            "guid": "78e11934-499a-45ed-8ef7-aae5578f0ecf",
            "id": "A01.03",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/multi-tenant/lighthouse",
            "service": "Entra",
            "severity": "Bajo",
            "subcategory": "Inquilinos de Microsoft Entra ID",
            "text": "Aprovechamiento de Azure Lighthouse para la administración multiinquilino",
            "waf": "Operaciones"
        },
        {
            "category": "Inquilinos de Facturación de Azure y de Id. de Microsoft Entra",
            "guid": "5d82e6df-6f61-42f2-82e2-3132d293be3d",
            "id": "A02.01",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-microsoft-customer-agreement#design-recommendations",
            "service": "Entra",
            "severity": "Medio",
            "subcategory": "Proveedor de soluciones en la nube",
            "text": "Asegúrese de que el asociado usa Azure Lighthouse para administrar el inquilino",
            "waf": "Costar"
        },
        {
            "category": "Inquilinos de Facturación de Azure y de Id. de Microsoft Entra",
            "guid": "a24d0de3-d4b9-4dfb-8ddd-bbfaf123fa01",
            "id": "A02.02",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-microsoft-customer-agreement#design-recommendations",
            "severity": "Bajo",
            "subcategory": "Proveedor de soluciones en la nube",
            "text": "Analizar la solicitud de soporte técnico y el proceso de escalamiento con el socio de CSP",
            "waf": "Costar"
        },
        {
            "category": "Inquilinos de Facturación de Azure y de Id. de Microsoft Entra",
            "guid": "32952499-58c8-4e6f-ada5-972e67893d55",
            "id": "A02.03",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-microsoft-customer-agreement#design-recommendations",
            "severity": "Medio",
            "subcategory": "Proveedor de soluciones en la nube",
            "text": "Configuración de informes de costos y vistas con Azure Cost Management",
            "waf": "Costar"
        },
        {
            "category": "Inquilinos de Facturación de Azure y de Id. de Microsoft Entra",
            "guid": "685cb4f2-ac9c-4b19-9167-993ed0b32415",
            "id": "A03.01",
            "link": "https://learn.microsoft.com/azure/cost-management-billing/manage/direct-ea-administration#manage-notification-contacts",
            "severity": "Medio",
            "subcategory": "Contrato Enterprise",
            "text": "Configurar contactos de notificación en un buzón de grupo",
            "waf": "Costar"
        },
        {
            "category": "Inquilinos de Facturación de Azure y de Id. de Microsoft Entra",
            "guid": "12cd499f-96e2-4e41-a243-231fb3245a1c",
            "id": "A03.02",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-enterprise-agreement#design-considerations",
            "severity": "Bajo",
            "subcategory": "Contrato Enterprise",
            "text": "Use departamentos y cuentas para asignar la estructura de su organización a su jerarquía de inscripción, lo que puede ayudar a separar la facturación.",
            "waf": "Costar"
        },
        {
            "ammp": true,
            "category": "Inquilinos de Facturación de Azure y de Id. de Microsoft Entra",
            "guid": "29213165-f066-46c4-81fc-4214cc19f3d0",
            "id": "A03.03",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-enterprise-agreement#design-considerations",
            "severity": "Alto",
            "subcategory": "Contrato Enterprise",
            "text": "Asegúrese de que las cuentas estén configuradas para ser del tipo \"Cuenta profesional o educativa\"",
            "waf": "Seguridad"
        },
        {
            "category": "Inquilinos de Facturación de Azure y de Id. de Microsoft Entra",
            "guid": "ca0fe401-12ad-46fc-8a7e-86293866a9f6",
            "id": "A03.04",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-enterprise-agreement#design-considerations",
            "severity": "Medio",
            "subcategory": "Contrato Enterprise",
            "text": "Habilite los cargos de visualización de DA y los cargos de vista de AO en sus inscripciones de EA para permitir que los usuarios con las permanentes correctas revisen los datos de costos y facturación.",
            "waf": "Seguridad"
        },
        {
            "category": "Inquilinos de Facturación de Azure y de Id. de Microsoft Entra",
            "guid": "5cf9f485-2784-49b3-9824-75d9b8bdb57b",
            "id": "A03.05",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-enterprise-agreement#design-considerations",
            "severity": "Bajo",
            "subcategory": "Contrato Enterprise",
            "text": "Utilice las suscripciones de desarrollo y pruebas empresariales para reducir los costos de las cargas de trabajo que no son de producción",
            "waf": "Costar"
        },
        {
            "category": "Inquilinos de Facturación de Azure y de Id. de Microsoft Entra",
            "guid": "2cf08656-13ea-4f7e-a53a-e2c956b1ff6c",
            "id": "A03.06",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-enterprise-agreement#design-considerations",
            "severity": "Medio",
            "subcategory": "Contrato Enterprise",
            "text": "Audite periódicamente las asignaciones de roles para revisar quién tiene acceso a la inscripción del Contrato Enterprise",
            "waf": "Costar"
        },
        {
            "category": "Inquilinos de Facturación de Azure y de Id. de Microsoft Entra",
            "guid": "6ad5c3dd-e5ea-4ff1-81a4-7886ff87845c",
            "id": "A04.01",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-microsoft-customer-agreement#design-recommendations",
            "severity": "Bajo",
            "subcategory": "Contrato de cliente de Microsoft",
            "text": "Configurar el correo electrónico de contacto de notificación de la cuenta de facturación del acuerdo",
            "waf": "Costar"
        },
        {
            "category": "Inquilinos de Facturación de Azure y de Id. de Microsoft Entra",
            "guid": "90e87802-602f-4dfb-acea-67c60689f1d7",
            "id": "A04.02",
            "link": "https://learn.microsoft.com/azure/cost-management-billing/manage/mca-section-invoice",
            "severity": "Bajo",
            "subcategory": "Contrato de cliente de Microsoft",
            "text": "Utilice las secciones Perfiles de facturación y Factura para estructurar la facturación de los acuerdos y lograr una administración eficaz de los costos",
            "waf": "Costar"
        },
        {
            "category": "Inquilinos de Facturación de Azure y de Id. de Microsoft Entra",
            "guid": "e81a73f0-84c4-4641-b406-14db3b4d1f50",
            "id": "A04.03",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-microsoft-customer-agreement#design-recommendations",
            "severity": "Bajo",
            "subcategory": "Contrato de cliente de Microsoft",
            "text": "Uso del plan de Azure para reducir los costos de las cargas de trabajo que no son de producción",
            "waf": "Costar"
        },
        {
            "category": "Inquilinos de Facturación de Azure y de Id. de Microsoft Entra",
            "guid": "ae757485-92a4-482a-8bc9-eefe6f5b5ec3",
            "id": "A04.04",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-microsoft-customer-agreement#design-recommendations",
            "severity": "Medio",
            "subcategory": "Contrato de cliente de Microsoft",
            "text": "Audite periódicamente las asignaciones de roles de RBAC de facturación del acuerdo para revisar quién tiene acceso a su cuenta de facturación de MCA",
            "waf": "Costar"
        },
        {
            "ammp": true,
            "category": "Gestión de identidades y accesos",
            "guid": "4348bf81-7573-4512-8f46-9061cc198fea",
            "id": "B01.01",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/identity-access-landing-zones#identity-and-access-management-in-the-azure-landing-zone-accelerator",
            "severity": "Alto",
            "subcategory": "Id. de Microsoft Entra e identidad híbrida",
            "text": "Use identidades administradas en lugar de entidades de servicio para la autenticación en los servicios de Azure. Puede comprobar si hay entidades de servicio existentes a través de Entra ID > Iniciar sesión Registros > Inicios de sesión de entidad de servicio.",
            "training": "https://learn.microsoft.com/azure/active-directory/managed-identities-azure-resources/overview",
            "waf": "Seguridad"
        },
        {
            "category": "Gestión de identidades y accesos",
            "guid": "cd163e39-84a5-4b39-97b7-6973abd70d94",
            "id": "B02.01",
            "link": "https://learn.microsoft.com/azure/active-directory/hybrid/how-to-connect-sync-staging-server",
            "severity": "Medio",
            "subcategory": "Id. de Microsoft Entra",
            "text": "Al implementar Microsoft Entra Connect, aproveche un servidor de ensayo para alta disponibilidad o recuperación ante desastres",
            "waf": "Fiabilidad"
        },
        {
            "ammp": true,
            "category": "Gestión de identidades y accesos",
            "guid": "984a859c-773e-47d2-9162-3a765a917e1f",
            "id": "B03.01",
            "link": "https://learn.microsoft.com/azure/active-directory/roles/security-emergency-access",
            "service": "Entra",
            "severity": "Alto",
            "subcategory": "Identidad",
            "text": "Implemente un acceso de emergencia o cuentas de emergencia para evitar el bloqueo de cuentas en todo el inquilino",
            "training": "https://learn.microsoft.com/learn/modules/azure-ad-privileged-identity-management/",
            "waf": "Seguridad"
        },
        {
            "category": "Gestión de identidades y accesos",
            "guid": "1cf0b8da-70bd-44d0-94af-8d99cfc89ae1",
            "id": "B03.02",
            "link": "https://learn.microsoft.com/azure/active-directory/reports-monitoring/concept-activity-logs-azure-monitor",
            "service": "Entra",
            "severity": "Medio",
            "subcategory": "Identidad",
            "text": "Integre los registros de identificador de Microsoft Entra con Azure Monitor central de la plataforma. Azure Monitor permite una única fuente de información en torno a los datos de registro y supervisión en Azure, lo que ofrece a las organizaciones opciones nativas en la nube para cumplir los requisitos relacionados con la recopilación y retención de registros.",
            "waf": "Seguridad"
        },
        {
            "ammp": true,
            "category": "Gestión de identidades y accesos",
            "guid": "348ef254-c27d-442e-abba-c7571559ab91",
            "id": "B03.03",
            "link": "https://learn.microsoft.com/azure/role-based-access-control/overview",
            "service": "Entra",
            "severity": "Alto",
            "subcategory": "Identidad",
            "text": "Aplique un modelo RBAC que se alinee con su modelo operativo en la nube. Ámbito y asignación entre grupos de administración y suscripciones.",
            "training": "https://learn.microsoft.com/learn/paths/implement-resource-mgmt-security/",
            "waf": "Seguridad"
        },
        {
            "category": "Gestión de identidades y accesos",
            "guid": "53e8908a-e28c-484c-93b6-b7808b9fe5c4",
            "id": "B03.04",
            "link": "https://learn.microsoft.com/azure/active-directory/conditional-access/overview",
            "service": "Entra",
            "severity": "Bajo",
            "subcategory": "Identidad",
            "text": "Aplicación de directivas de acceso condicional de Microsoft Entra ID para cualquier usuario con derechos en entornos de Azure",
            "training": "https://learn.microsoft.com/learn/modules/plan-implement-administer-conditional-access/",
            "waf": "Seguridad"
        },
        {
            "ammp": true,
            "category": "Gestión de identidades y accesos",
            "guid": "1049d403-a923-4c34-94d0-0018ac6a9e01",
            "id": "B03.05",
            "link": "https://learn.microsoft.com/azure/active-directory/authentication/concept-mfa-howitworks",
            "service": "Entra",
            "severity": "Alto",
            "subcategory": "Identidad",
            "text": "Aplicación de la autenticación multifactor para cualquier usuario con derechos en los entornos de Azure",
            "training": "https://learn.microsoft.com/learn/modules/secure-aad-users-with-mfa/",
            "waf": "Seguridad"
        },
        {
            "category": "Gestión de identidades y accesos",
            "guid": "e6a83de5-de32-4c19-a248-1607d5d1e4e6",
            "id": "B03.06",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/manage/centralize-operations",
            "severity": "Medio",
            "subcategory": "Identidad",
            "text": "Aplique responsabilidades centralizadas y delegadas para administrar los recursos implementados dentro de la zona de aterrizaje, en función de los requisitos de rol y seguridad",
            "training": "https://learn.microsoft.com/learn/paths/azure-administrator-manage-identities-governance/",
            "waf": "Seguridad"
        },
        {
            "category": "Gestión de identidades y accesos",
            "guid": "14658d35-58fd-4772-99b8-21112df27ee4",
            "id": "B03.07",
            "link": "https://learn.microsoft.com/azure/active-directory/privileged-identity-management/pim-configure",
            "service": "Entra",
            "severity": "Medio",
            "subcategory": "Identidad",
            "text": "Aplique la administración de identidades privilegiadas (PIM) de Microsoft Entra ID para establecer el acceso permanente cero y los privilegios mínimos",
            "training": "https://learn.microsoft.com/learn/modules/azure-ad-privileged-identity-management/",
            "waf": "Seguridad"
        },
        {
            "ammp": true,
            "category": "Gestión de identidades y accesos",
            "guid": "12e7f983-f630-4472-8dd6-9c5b5c2622f5",
            "id": "B03.08",
            "link": "https://learn.microsoft.com/azure/active-directory/roles/security-planning#identify-microsoft-accounts-in-administrative-roles-that-need-to-be-switched-to-work-or-school-accounts",
            "service": "Entra",
            "severity": "Alto",
            "subcategory": "Identidad",
            "text": "Utilice solo el tipo de autenticación Cuenta profesional o educativa para todos los tipos de cuenta. Evite usar la cuenta de Microsoft",
            "training": "https://learn.microsoft.com/learn/modules/explore-basic-services-identity-types/",
            "waf": "Seguridad"
        },
        {
            "category": "Gestión de identidades y accesos",
            "guid": "4b69bad3-3aad-45e8-a68e-1d76667313b4",
            "id": "B03.09",
            "link": "https://learn.microsoft.com/azure/active-directory/fundamentals/active-directory-groups-create-azure-portal",
            "service": "Entra",
            "severity": "Medio",
            "subcategory": "Identidad",
            "text": "Utilice solo grupos para asignar permisos. Agregue grupos locales al grupo solo de Azure-AD si ya existe un sistema de administración de grupos.",
            "training": "https://learn.microsoft.com/learn/paths/manage-identity-and-access/",
            "waf": "Seguridad"
        },
        {
            "category": "Gestión de identidades y accesos",
            "guid": "f5664b5e-984a-4859-a773-e7d261623a76",
            "id": "B03.10",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/identity-access#prerequisites-for-a-landing-zone---design-recommendations",
            "severity": "Medio",
            "subcategory": "Identidad",
            "text": "Use roles RBAC personalizados de Azure para los siguientes roles clave a fin de proporcionar acceso específico en toda la zona de disponibilidad general: propietario de la plataforma Azure, administración de red, operaciones de seguridad, propietario de la suscripción, propietario de la aplicación. Alinea estos roles con los equipos y las responsabilidades dentro de tu empresa.",
            "training": "https://learn.microsoft.com/learn/modules/create-custom-azure-roles-with-rbac/",
            "waf": "Seguridad"
        },
        {
            "category": "Gestión de identidades y accesos",
            "guid": "1559ab91-53e8-4908-ae28-c84c33b6b780",
            "id": "B03.11",
            "link": "https://learn.microsoft.com/azure/architecture/reference-architectures/identity/adds-extend-domain#vm-recommendations",
            "severity": "Medio",
            "subcategory": "Identidad",
            "text": "Al implementar Active Directory en Windows Server, use una ubicación con zonas de disponibilidad e implemente al menos dos máquinas virtuales en estas zonas. Si no está disponible, impleméntelo en un conjunto de disponibilidad",
            "training": "https://learn.microsoft.com/learn/modules/azure-active-directory/",
            "waf": "Fiabilidad"
        },
        {
            "category": "Gestión de identidades y accesos",
            "guid": "8b9fe5c4-1049-4d40-9a92-3c3474d00018",
            "id": "B03.12",
            "link": "https://learn.microsoft.com/azure/active-directory-domain-services/overview",
            "service": "Entra",
            "severity": "Medio",
            "subcategory": "Identidad",
            "text": "Si Entra Domain Services está en uso, evalúe la compatibilidad de todas las cargas de trabajo",
            "training": "https://learn.microsoft.com/learn/modules/implement-hybrid-identity-windows-server/",
            "waf": "Seguridad"
        },
        {
            "category": "Gestión de identidades y accesos",
            "guid": "ac6a9e01-e6a8-43de-9de3-2c1992481607",
            "id": "B03.13",
            "link": "https://learn.microsoft.com/azure/architecture/reference-architectures/identity/adds-extend-domain",
            "severity": "Medio",
            "subcategory": "Identidad",
            "text": "Si se usan controladores de dominio, asegúrese de que los recursos estén configurados para usar el controlador de dominio correcto.",
            "training": "https://learn.microsoft.com/learn/paths/implement-windows-server-iaas-virtual-machine-identity/",
            "waf": "Seguridad"
        },
        {
            "category": "Gestión de identidades y accesos",
            "guid": "d5d1e4e6-1465-48d3-958f-d77249b82111",
            "id": "B03.14",
            "link": "https://learn.microsoft.com/azure/active-directory/app-proxy/application-proxy",
            "service": "Entra",
            "severity": "Medio",
            "subcategory": "Identidad",
            "text": "Cuando sea necesario, use Microsoft Entra ID Application Proxy para proporcionar a los usuarios remotos acceso seguro y autenticado a las aplicaciones internas (hospedadas en la nube o en el entorno local).",
            "training": "https://learn.microsoft.com/learn/paths/implement-applications-external-access-azure-ad/",
            "waf": "Seguridad"
        },
        {
            "category": "Gestión de identidades y accesos",
            "guid": "35037e68-9349-4c15-b371-228514f4cdff",
            "id": "B03.15",
            "link": "https://learn.microsoft.com/azure/active-directory/roles/best-practices",
            "service": "Entra",
            "severity": "Medio",
            "subcategory": "Identidad",
            "text": "Evite el uso de cuentas sincronizadas locales para las asignaciones de roles de identificador de Microsoft Entra.",
            "training": "https://learn.microsoft.com/learn/modules/design-identity-security-strategy/",
            "waf": "Seguridad"
        },
        {
            "category": "Gestión de identidades y accesos",
            "guid": "9cf5418b-1520-4b7b-add7-88eb28f833e8",
            "id": "B04.01",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/identity-access-landing-zones#managed-identities",
            "severity": "Medio",
            "subcategory": "Zonas de aterrizaje",
            "text": "Configure la segmentación de la red de identidad mediante el uso de una red virtual y vuelva a emparejarse con el centro. Proporcionar autenticación dentro de la zona de aterrizaje de la aplicación (heredada).",
            "training": "https://learn.microsoft.com/azure/architecture/example-scenario/identity/adds-extend-domain",
            "waf": "Seguridad"
        },
        {
            "category": "Gestión de identidades y accesos",
            "guid": "d4d1ad54-1abc-4919-b267-3f342d3b49e4",
            "id": "B04.02",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/identity-access-landing-zones#rbac-recommendations",
            "severity": "Medio",
            "subcategory": "Zonas de aterrizaje",
            "text": "Use Azure RBAC para administrar el acceso del plano de datos a los recursos, si es posible. Por ejemplo, operaciones de datos en Key Vault, cuentas de almacenamiento y servicios de base de datos.",
            "training": "https://learn.microsoft.com/azure/role-based-access-control/overview",
            "waf": "Seguridad"
        },
        {
            "category": "Gestión de identidades y accesos",
            "guid": "d505ebcb-79b1-4274-9c0d-a27c8bea489c",
            "id": "B04.03",
            "link": "https://learn.microsoft.com/azure/active-directory/privileged-identity-management/pim-create-roles-and-resource-roles-review",
            "severity": "Medio",
            "subcategory": "Zonas de aterrizaje",
            "text": "Use las revisiones de acceso PIM de Microsoft Entra ID para validar periódicamente los derechos de recursos.",
            "waf": "Seguridad"
        },
        {
            "ammp": true,
            "category": "Organización de recursos",
            "guid": "cacf55bc-e4e4-46be-96bc-57a5f23a269a",
            "id": "C01.01",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/resource-naming",
            "severity": "Alto",
            "subcategory": "Nomenclatura y etiquetado",
            "text": "Se recomienda seguir los estándares de nomenclatura de procedimientos recomendados de Microsoft",
            "waf": "Seguridad"
        },
        {
            "category": "Organización de recursos",
            "graph": "resourcecontainers| where type == 'microsoft.resources/subscriptions'| extend ManagementGroup = tostring(tags),mgmtChain = properties.managementGroupAncestorsChain| extend compliant =( array_length(mgmtChain) <= 4 and array_length(mgmtChain) > 1)",
            "guid": "2df27ee4-12e7-4f98-9f63-04722dd69c5b",
            "id": "C02.01",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/resource-org-management-groups",
            "severity": "Medio",
            "subcategory": "Suscripciones",
            "text": "Aplique una jerarquía de grupos de administración razonablemente plana con no más de cuatro niveles.",
            "training": "https://learn.microsoft.com/learn/modules/azure-architecture-fundamentals/",
            "waf": "Seguridad"
        },
        {
            "category": "Organización de recursos",
            "guid": "667313b4-f566-44b5-b984-a859c773e7d2",
            "id": "C02.02",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/resource-org-management-groups#management-group-recommendations",
            "severity": "Medio",
            "subcategory": "Suscripciones",
            "text": "Aplicación de un grupo de administración de espacio aislado para permitir que los usuarios experimenten inmediatamente con Azure",
            "training": "https://learn.microsoft.com/learn/paths/enterprise-scale-architecture/",
            "waf": "Seguridad"
        },
        {
            "category": "Organización de recursos",
            "guid": "61623a76-5a91-47e1-b348-ef254c27d42e",
            "id": "C02.03",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/resource-org-management-groups#management-group-recommendations",
            "severity": "Medio",
            "subcategory": "Suscripciones",
            "text": "Aplicación de un grupo de administración de plataforma en el grupo de administración raíz para admitir la directiva de plataforma común y la asignación de roles de Azure",
            "training": "https://learn.microsoft.com/learn/paths/enterprise-scale-architecture/",
            "waf": "Seguridad"
        },
        {
            "category": "Organización de recursos",
            "guid": "8bbac757-1559-4ab9-853e-8908ae28c84c",
            "id": "C02.04",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/resource-org-management-groups#management-group-recommendations",
            "severity": "Medio",
            "subcategory": "Suscripciones",
            "text": "Aplique una suscripción de conectividad dedicada en el grupo de administración de conectividad para hospedar un centro de conectividad de Azure Virtual WAN, un sistema de nombres de dominio (DNS) privado, un circuito ExpressRoute y otros recursos de red.",
            "training": "https://learn.microsoft.com/learn/paths/enterprise-scale-architecture/",
            "waf": "Seguridad"
        },
        {
            "category": "Organización de recursos",
            "graph": "resourcecontainers| where type == 'microsoft.resources/subscriptions'| extend ManagementGroup = tostring(tags),mgmtChain = properties.managementGroupAncestorsChain| extend compliant = (array_length(mgmtChain) > 1)",
            "guid": "33b6b780-8b9f-4e5c-9104-9d403a923c34",
            "id": "C02.05",
            "link": "https://learn.microsoft.com/azure/governance/management-groups/how-to/protect-resource-hierarchy#setting---default-management-group",
            "severity": "Medio",
            "subcategory": "Suscripciones",
            "text": "Exigir que no se coloquen suscripciones en el grupo de administración raíz",
            "waf": "Seguridad"
        },
        {
            "category": "Organización de recursos",
            "guid": "74d00018-ac6a-49e0-8e6a-83de5de32c19",
            "id": "C02.06",
            "link": "https://learn.microsoft.com/azure/governance/management-groups/how-to/protect-resource-hierarchy#setting---require-authorization",
            "severity": "Medio",
            "subcategory": "Suscripciones",
            "text": "Exija que solo los usuarios con privilegios puedan operar grupos de administración en el inquilino habilitando la autorización de Azure RBAC en la configuración de la jerarquía del grupo de administración",
            "waf": "Seguridad"
        },
        {
            "category": "Organización de recursos",
            "guid": "92481607-d5d1-4e4e-9146-58d3558fd772",
            "id": "C02.07",
            "link": "https://learn.microsoft.com/azure/governance/management-groups/overview",
            "severity": "Medio",
            "subcategory": "Suscripciones",
            "text": "Aplique grupos de administración en el grupo de administración de nivel raíz para representar los tipos de cargas de trabajo, en función de sus necesidades de seguridad, cumplimiento, conectividad y características.",
            "waf": "Seguridad"
        },
        {
            "ammp": true,
            "category": "Organización de recursos",
            "guid": "49b82111-2df2-47ee-912e-7f983f630472",
            "id": "C02.08",
            "link": "https://learn.microsoft.com/azure/governance/management-groups/overview",
            "severity": "Alto",
            "subcategory": "Suscripciones",
            "text": "Aplique un proceso para que los propietarios de recursos sean conscientes de sus funciones y responsabilidades, la revisión de acceso, la revisión del presupuesto, el cumplimiento de las políticas y la corrección cuando sea necesario.",
            "waf": "Seguridad"
        },
        {
            "category": "Organización de recursos",
            "guid": "2dd69c5b-5c26-422f-94b6-9bad33aad5e8",
            "id": "C02.09",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits",
            "severity": "Medio",
            "subcategory": "Suscripciones",
            "text": "Asegúrese de que todos los propietarios de suscripciones y el equipo central de TI conozcan las cuotas de suscripción y el impacto que tienen en el aprovisionamiento de recursos para una suscripción determinada.",
            "waf": "Seguridad"
        },
        {
            "ammp": true,
            "category": "Organización de recursos",
            "guid": "c68e1d76-6673-413b-9f56-64b5e984a859",
            "id": "C02.10",
            "link": "https://learn.microsoft.com/azure/cost-management-billing/reservations/save-compute-costs-reservations",
            "severity": "Alto",
            "subcategory": "Suscripciones",
            "text": "Utilice instancias reservadas cuando corresponda para optimizar los costos y garantizar la capacidad disponible en las regiones de destino. Aplique el uso de SKU de máquina virtual de instancia reservada adquiridas a través de Azure Policy.",
            "training": "https://learn.microsoft.com/learn/paths/improve-reliability-modern-operations/",
            "waf": "Seguridad"
        },
        {
            "ammp": true,
            "category": "Organización de recursos",
            "guid": "c773e7d2-6162-43a7-95a9-17e1f348ef25",
            "id": "C02.11",
            "link": "https://learn.microsoft.com/azure/architecture/framework/scalability/design-capacity",
            "severity": "Alto",
            "subcategory": "Suscripciones",
            "text": "Aplique un panel, un libro de trabajo o un proceso manual para supervisar los niveles de capacidad utilizados",
            "training": "https://learn.microsoft.com/learn/paths/monitor-usage-performance-availability-resources-azure-monitor/",
            "waf": "Seguridad"
        },
        {
            "ammp": true,
            "category": "Organización de recursos",
            "guid": "ae28c84c-33b6-4b78-88b9-fe5c41049d40",
            "id": "C02.12",
            "link": "https://learn.microsoft.com/azure/cost-management-billing/cost-management-billing-overview",
            "severity": "Alto",
            "subcategory": "Suscripciones",
            "text": "Aplicación de un proceso para la gestión de costos",
            "training": "https://learn.microsoft.com/learn/paths/control-spending-manage-bills/",
            "waf": "Seguridad"
        },
        {
            "category": "Organización de recursos",
            "guid": "3a923c34-74d0-4001-aac6-a9e01e6a83de",
            "id": "C02.13",
            "link": "https://learn.microsoft.com/azure/governance/management-groups/overview",
            "severity": "Medio",
            "subcategory": "Suscripciones",
            "text": "Si se van a usar servidores para servicios de identidad, como controladores de dominio, establezca una suscripción de identidad dedicada en el grupo de administración de identidades para hospedar estos servicios",
            "training": "https://learn.microsoft.com/learn/paths/enterprise-scale-architecture/",
            "waf": "Seguridad"
        },
        {
            "category": "Organización de recursos",
            "graph": "resources | extend compliant = isnotnull(['tags']) | project name, id, subscriptionId, resourceGroup, tags, compliant",
            "guid": "5de32c19-9248-4160-9d5d-1e4e614658d3",
            "id": "C02.14",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/track-costs",
            "severity": "Medio",
            "subcategory": "Suscripciones",
            "text": "Asegúrese de que las etiquetas se utilizan para la facturación y la gestión de costos",
            "training": "https://learn.microsoft.com/learn/paths/implement-resource-mgmt-security/",
            "waf": "Seguridad"
        },
        {
            "category": "Organización de recursos",
            "guid": "6cc0ea22-42bb-441e-a345-804ab0a09666",
            "id": "C02.15",
            "link": "https://github.com/Azure/sovereign-landing-zone/blob/main/docs/02-Architecture.md",
            "severity": "Medio",
            "subcategory": "Suscripciones",
            "text": "En el caso de la Zona de Aterrizaje Soberana, contar con una \"corporación confidencial\" y un grupo de gestión \"confidencial en línea\" directamente bajo el MG de las \"zonas de aterrizaje\".",
            "waf": "Seguridad"
        },
        {
            "category": "Organización de recursos",
            "guid": "250d81ce-8bbe-4f85-9051-6a18a8221e50",
            "id": "C03.01",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-setup-guide/regions",
            "severity": "Alto",
            "subcategory": "Regiones",
            "text": "Seleccione las regiones de Azure adecuadas para la implementación. Azure es una plataforma en la nube a escala global que proporciona cobertura global a través de muchas regiones y geografías. Las diferentes regiones de Azure tienen diferentes características, modelos de acceso y disponibilidad, costos, capacidad y servicios ofrecidos, por lo que es importante tener en cuenta todos los criterios y requisitos",
            "training": "https://learn.microsoft.com/learn/modules/azure-architecture-fundamentals/",
            "waf": "Fiabilidad"
        },
        {
            "category": "Organización de recursos",
            "guid": "19ca3f89-397d-44b1-b5b6-5e18661372ac",
            "id": "C03.02",
            "link": "https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/ready/azure-setup-guide/regions#operate-in-multiple-geographic-regions",
            "severity": "Medio",
            "subcategory": "Regiones",
            "text": "Considere la posibilidad de realizar una implementación en varias regiones. Dependiendo del tamaño del cliente, las ubicaciones y la presencia de los usuarios, operar en varias regiones puede ser una opción común para prestar servicios y ejecutar aplicaciones más cerca de ellos. El uso de una implementación en varias regiones también es importante para proporcionar capacidades de recuperación ante desastres geográficas, eliminar la dependencia de la capacidad de una sola región y disminuir el riesgo de una restricción temporal y localizada de la capacidad de los recursos",
            "training": "https://learn.microsoft.com/learn/modules/azure-architecture-fundamentals/",
            "waf": "Fiabilidad"
        },
        {
            "category": "Organización de recursos",
            "guid": "4c27d42e-8bba-4c75-9155-9ab9153e8908",
            "id": "C03.03",
            "link": "https://azure.microsoft.com/explore/global-infrastructure/products-by-region/",
            "severity": "Medio",
            "subcategory": "Regiones",
            "text": "Asegúrese de que los servicios y las características necesarios estén disponibles en las regiones de implementación elegidas",
            "training": "https://learn.microsoft.com/learn/modules/azure-architecture-fundamentals/",
            "waf": "Fiabilidad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "373f482f-3e39-4d39-8aa4-7e566f6082b6",
            "id": "D01.01",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-app-delivery",
            "severity": "Medio",
            "subcategory": "Entrega de aplicaciones",
            "text": "Desarrolle un plan para proteger el contenido de la aplicación de entrega de los radios de carga de trabajo mediante Application Gateway y Azure Front Door.  Puede utilizar la lista de comprobación de entrega de aplicaciones para obtener recomendaciones.",
            "waf": "Operaciones"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "6138a720-0f1c-4e16-bd30-1d6e872e52e3",
            "id": "D01.02",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/resource-org-management-groups#management-groups-in-the-azure-landing-zone-accelerator",
            "severity": "Medio",
            "subcategory": "Entrega de aplicaciones",
            "text": "Realice la entrega de aplicaciones dentro de las zonas de aterrizaje tanto para aplicaciones internas (corporativas) como externas (en línea).",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "143b16c3-1d7a-4a9b-9470-4489a8042d88",
            "id": "D01.03",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "service": "VNet",
            "severity": "Medio",
            "subcategory": "Entrega de aplicaciones",
            "text": "Use una red DDoS o planes de protección IP para todas las direcciones IP públicas en las zonas de aterrizaje de la aplicación.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "de0d5973-cd4c-4d21-a088-137f5e6c4cfd",
            "id": "D02.01",
            "link": "https://learn.microsoft.com/en-us/azure/expressroute/expressroute-howto-macsec",
            "service": "ExpressRoute",
            "severity": "Medio",
            "subcategory": "Encriptación",
            "text": "Cuando use ExpressRoute Direct, configure MACsec para cifrar el tráfico en el nivel de capa dos entre los enrutadores de la organización y MSEE. El diagrama muestra este cifrado en el flujo.",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "ed301d6e-872e-452e-9611-cc58b5a4b151",
            "id": "D02.02",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-erdirect-about",
            "service": "ExpressRoute",
            "severity": "Bajo",
            "subcategory": "Encriptación",
            "text": "En escenarios en los que MACsec no es una opción (por ejemplo, no usar ExpressRoute Direct), use una puerta de enlace de VPN para establecer túneles IPsec a través del emparejamiento privado de ExpressRoute.",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "e8bbac75-7155-49ab-a153-e8908ae28c84",
            "id": "D03.01",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/enterprise-scale/network-topology-and-connectivity",
            "service": "VNet",
            "severity": "Medio",
            "subcategory": "Cubo y radio",
            "text": "Aproveche un diseño de red basado en la topología de red radial tradicional para escenarios de red que requieren la máxima flexibilidad.",
            "training": "https://learn.microsoft.com/learn/paths/architect-network-infrastructure/",
            "waf": "Seguridad"
        },
        {
            "ammp": true,
            "category": "Topología y conectividad de red",
            "guid": "7dd61623-a364-4a90-9eca-e48ebd54cd7d",
            "id": "D03.02",
            "link": "https://learn.microsoft.com/azure/architecture/reference-architectures/hybrid-networking/expressroute",
            "service": "VNet",
            "severity": "Alto",
            "subcategory": "Cubo y radio",
            "text": "Asegúrese de que los servicios de redes compartidas, incluidas las puertas de enlace de ExpressRoute, las puertas de enlace de VPN y Azure Firewall o las aplicaciones virtuales de red de asociados en la red virtual del centro central. Si es necesario, implemente también servidores DNS.",
            "waf": "Costar"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "e2e8abac-3571-4559-ab91-53e89f89dc7b",
            "id": "D03.03",
            "link": "https://learn.microsoft.com/azure/architecture/reference-architectures/dmz/nva-ha",
            "service": "NVA",
            "severity": "Medio",
            "subcategory": "Cubo y radio",
            "text": "Al implementar tecnologías de redes de asociados o aplicaciones virtuales de red, siga las instrucciones del proveedor de asociados",
            "waf": "Fiabilidad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "ce463dbb-bc8a-4c2a-aebc-92a43da1dae2",
            "id": "D03.04",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-howto-coexist-resource-manager#to-enable-transit-routing-between-expressroute-and-azure-vpn",
            "service": "ExpressRoute",
            "severity": "Bajo",
            "subcategory": "Cubo y radio",
            "text": "Si necesita el tránsito entre ExpressRoute y las puertas de enlace de VPN en escenarios radiales, use Azure Route Server.",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,subnets=properties.subnets | mv-expand subnets | project id, subnetName = subnets.name, subnetPrefix = subnets.properties.addressPrefix | extend subnetPrefixLength = split(subnetPrefix, '/')[1] | where subnetName == 'RouteServerSubnet' | extend compliant = (subnetPrefixLength <= 27) | distinct id, compliant",
            "guid": "91b9d7d5-91e1-4dcb-8f1f-fa7e465646cc",
            "id": "D03.05",
            "link": "https://learn.microsoft.com/azure/route-server/quickstart-configure-route-server-portal#create-a-route-server-1",
            "service": "ARS",
            "severity": "Bajo",
            "subcategory": "Cubo y radio",
            "text": "Si utiliza el servidor de rutas, utilice un prefijo /27 para la subred del servidor de rutas.",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "cc881471-607c-41cc-a0e6-14658dd558f9",
            "id": "D03.06",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-networks-faq#can-i-create-a-peering-connection-to-a-vnet-in-a-different-region",
            "service": "VNet",
            "severity": "Medio",
            "subcategory": "Cubo y radio",
            "text": "En el caso de las arquitecturas de red con varias topologías en estrella tipo hub-and-spoke en las regiones de Azure, use emparejamientos de red virtual global entre las redes virtuales del centro para conectar las regiones entre sí.",
            "training": "https://learn.microsoft.com/learn/paths/azure-administrator-manage-virtual-networks/",
            "waf": "Rendimiento"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "4722d929-c1b1-4cd6-81f5-4b29bade39ad",
            "id": "D03.07",
            "link": "https://learn.microsoft.com/azure/azure-monitor/insights/network-insights-overview",
            "service": "VNet",
            "severity": "Medio",
            "subcategory": "Cubo y radio",
            "text": "Use Azure Monitor para redes para supervisar el estado de un extremo a otro de las redes en Azure.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-network-monitoring/",
            "waf": "Operaciones"
        },
        {
            "category": "Topología y conectividad de red",
            "graph": "resources | where type == 'microsoft.network/virtualnetworks' | mvexpand properties.virtualNetworkPeerings | summarize peeringcount = count() by id | extend compliant = (peeringcount < 450) | distinct id,compliant",
            "guid": "0e7c28ec-9366-4572-83b0-f4664b1d944a",
            "id": "D03.08",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits?toc=/azure/virtual-network/toc.json#azure-resource-manager-virtual-networking-limits",
            "service": "VNet",
            "severity": "Medio",
            "subcategory": "Cubo y radio",
            "text": "Al conectar redes virtuales de radio a la red virtual del centro central, tenga en cuenta los límites de emparejamiento de red virtual (500), el número máximo de prefijos que se pueden anunciar a través de ExpressRoute (1000)",
            "waf": "Fiabilidad"
        },
        {
            "category": "Topología y conectividad de red",
            "graph": "resources | where type=='microsoft.network/routetables' | mvexpand properties.routes | summarize routeCount = count() by id | extend compliant = (routeCount < 360) | distinct id,compliant",
            "guid": "3d457936-e9b7-41eb-bdff-314b26450b12",
            "id": "D03.09",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits?toc=/azure/virtual-network/toc.json#azure-resource-manager-virtual-networking-limits",
            "service": "VNet",
            "severity": "Medio",
            "subcategory": "Cubo y radio",
            "text": "Tenga en cuenta el límite de rutas por tabla de rutas (400).",
            "waf": "Fiabilidad"
        },
        {
            "ammp": true,
            "category": "Topología y conectividad de red",
            "graph": "resources | where type == 'microsoft.network/virtualnetworks' | mvexpand properties.virtualNetworkPeerings | project id, peeringName=properties_virtualNetworkPeerings.name, compliant = (properties_virtualNetworkPeerings.properties.allowVirtualNetworkAccess == True)",
            "guid": "c76cb5a2-abe2-11ed-afa1-0242ac120002",
            "id": "D03.10",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-network-manage-peering",
            "service": "VNet",
            "severity": "Alto",
            "subcategory": "Cubo y radio",
            "text": "Use la opción \"Permitir tráfico a la red virtual remota\" al configurar emparejamientos de red virtual",
            "waf": "Fiabilidad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "359c373e-7dd6-4162-9a36-4a907ecae48e",
            "id": "D04.01",
            "link": "https://learn.microsoft.com/azure/architecture/reference-architectures/hybrid-networking/hub-spoke?tabs=cli",
            "service": "ExpressRoute",
            "severity": "Medio",
            "subcategory": "Híbrido",
            "text": "Asegúrese de que ha investigado la posibilidad de usar ExpressRoute como conexión principal a Azure.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Rendimiento"
        },
        {
            "category": "Topología y conectividad de red",
            "description": "Puede usar la anteposición de AS y los pesos de conexión para influir en el tráfico de Azure al entorno local, y la gama completa de atributos de BGP en sus propios enrutadores para influir en el tráfico del entorno local a Azure.",
            "guid": "f29812b2-363c-4efe-879b-599de0d5973c",
            "id": "D04.02",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-routing",
            "service": "ExpressRoute",
            "severity": "Medio",
            "subcategory": "Híbrido",
            "text": "Cuando use varios circuitos ExpressRoute o varias ubicaciones locales, asegúrese de optimizar el enrutamiento con atributos BGP, si se prefieren determinadas rutas de acceso.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Fiabilidad"
        },
        {
            "category": "Topología y conectividad de red",
            "graph": "resources| where type == 'microsoft.network/virtualnetworkgateways'| where properties.gatewayType =~ 'vpn' or properties.gatewayType == 'ExpressRoute'| extend SKUName = properties.sku.name, SKUTier = properties.sku.tier, Type = properties.gatewayType| extend compliant = SKUTier !in ('Basic', 'Standard')| project name, id, subscriptionId, resourceGroup, compliant",
            "guid": "d4cd21b0-8813-47f5-b6c4-cfd3e504547c",
            "id": "D04.03",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-routing",
            "service": "ExpressRoute",
            "severity": "Medio",
            "subcategory": "Híbrido",
            "text": "Asegúrese de que usa la SKU correcta para las puertas de enlace de ExpressRoute/VPN en función de los requisitos de ancho de banda y rendimiento.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Rendimiento"
        },
        {
            "ammp": true,
            "category": "Topología y conectividad de red",
            "graph": "resources | where type=='microsoft.network/expressroutecircuits' | extend compliant = (tolower(sku.family) == 'metereddata' or tolower(sku.tier) == 'local') | distinct id,compliant",
            "guid": "7025b442-f6e9-4af6-b11f-c9574916016f",
            "id": "D04.04",
            "link": "https://learn.microsoft.com/azure/expressroute/plan-manage-cost",
            "service": "ExpressRoute",
            "severity": "Alto",
            "subcategory": "Híbrido",
            "text": "Asegúrese de que usa circuitos ExpressRoute de datos ilimitados solo si alcanza el ancho de banda que justifica su costo.",
            "waf": "Costar"
        },
        {
            "ammp": true,
            "category": "Topología y conectividad de red",
            "graph": "resources | where type=='microsoft.network/connections' | where properties.connectionType == 'ExpressRoute' | project id, gwid=tostring(properties.virtualNetworkGateway1.id), circuitid=tostring(properties.peer.id) | join (resources | where type=='microsoft.network/expressroutecircuits' | project circuitid=tostring(id), circuitsku=sku.tier) on circuitid | project id=gwid, compliant = (circuitsku == 'Local') | summarize compliant=max(compliant) by id",
            "guid": "f4e7926a-ec35-476e-a412-5dd17136bd62",
            "id": "D04.05",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-faqs#expressroute-local",
            "service": "ExpressRoute",
            "severity": "Alto",
            "subcategory": "Híbrido",
            "text": "Aproveche la SKU local de ExpressRoute para reducir el costo de los circuitos, si la ubicación de emparejamiento de los circuitos admite las regiones de Azure para la SKU local.",
            "waf": "Costar"
        },
        {
            "category": "Topología y conectividad de red",
            "graph": "resources| where type == 'microsoft.network/virtualnetworkgateways'| where properties.gatewayType =~ 'vpn' or properties.gatewayType == 'ExpressRoute'| extend SKUName = properties.sku.name, SKUTier = properties.sku.tier, Type = properties.gatewayType| extend compliant = SKUTier contains 'AZ'| project name, id, subscriptionId, resourceGroup, Type, compliant",
            "guid": "2447ec66-138a-4720-8f1c-e16ed301d6e8",
            "id": "D04.06",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-about-virtual-network-gateways",
            "service": "ExpressRoute",
            "severity": "Medio",
            "subcategory": "Híbrido",
            "text": "Implemente una puerta de enlace de ExpressRoute con redundancia de zona en las regiones de Azure admitidas.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Fiabilidad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "72e52e36-11cc-458b-9a4b-1511e43a58a9",
            "id": "D04.07",
            "link": "https://learn.microsoft.com/azure/networking/",
            "service": "ExpressRoute",
            "severity": "Medio",
            "subcategory": "Híbrido",
            "text": "En escenarios que requieren un ancho de banda superior a 10 Gbps o puertos dedicados de 10/100 Gbps, use ExpressRoute Direct.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Rendimiento"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "c2299c4d-7b57-4d0c-9555-62f2b3e4563a",
            "id": "D04.08",
            "link": "https://learn.microsoft.com/azure/expressroute/about-fastpath",
            "service": "ExpressRoute",
            "severity": "Medio",
            "subcategory": "Híbrido",
            "text": "Cuando se requiera una latencia baja o el rendimiento del entorno local a Azure sea superior a 10 Gbps, habilite FastPath para omitir la puerta de enlace de ExpressRoute de la ruta de acceso de datos.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Rendimiento"
        },
        {
            "category": "Topología y conectividad de red",
            "graph": "resources | where type=='microsoft.network/virtualnetworkgateways' | where properties.gatewayType == 'Vpn' | extend compliant = (tolower(properties.sku.name) contains 'az') | distinct id, compliant",
            "guid": "4d873974-8b66-42d6-b15f-512a65498f6d",
            "id": "D04.09",
            "link": "https://learn.microsoft.com/azure/vpn-gateway/create-zone-redundant-vnet-gateway",
            "service": "VPN",
            "severity": "Medio",
            "subcategory": "Híbrido",
            "text": "Use puertas de enlace de VPN con redundancia de zona para conectar sucursales o ubicaciones remotas a Azure (donde estén disponibles).",
            "training": "https://learn.microsoft.com/training/modules/intro-to-azure-vpn-gateway/",
            "waf": "Fiabilidad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "45866df8-cf85-4ca9-bbe2-65ec1478919e",
            "id": "D04.10",
            "link": "https://learn.microsoft.com/azure/vpn-gateway/vpn-gateway-highlyavailable",
            "service": "VPN",
            "severity": "Medio",
            "subcategory": "Híbrido",
            "text": "Use dispositivos VPN redundantes en las instalaciones (activo/activo o activo/pasivo).",
            "training": "https://learn.microsoft.com/training/modules/intro-to-azure-vpn-gateway/",
            "waf": "Fiabilidad"
        },
        {
            "ammp": true,
            "category": "Topología y conectividad de red",
            "guid": "718cb437-b060-2589-8856-2e93a5c6633b",
            "id": "D04.11",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-erdirect-about",
            "service": "ExpressRoute",
            "severity": "Alto",
            "subcategory": "Híbrido",
            "text": "Si usa ExpressRoute Direct, considere la posibilidad de usar circuitos locales de ExpressRoute a las regiones locales de Azure para ahorrar costos",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Costar"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "8042d88e-79d1-47b7-9b22-a5a67e7a8ed4",
            "id": "D04.12",
            "link": "https://learn.microsoft.com/azure/architecture/framework/services/networking/expressroute/reliability",
            "service": "ExpressRoute",
            "severity": "Medio",
            "subcategory": "Híbrido",
            "text": "Cuando se requiere aislamiento de tráfico o ancho de banda dedicado, por ejemplo, para separar entornos de producción y no de producción, use circuitos ExpressRoute diferentes. Le ayudará a garantizar dominios de enrutamiento aislados y a aliviar los riesgos de vecinos ruidosos.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "b30e38c3-f298-412b-8363-cefe179b599d",
            "id": "D04.13",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-monitoring-metrics-alerts",
            "service": "ExpressRoute",
            "severity": "Medio",
            "subcategory": "Híbrido",
            "text": "Supervise la disponibilidad y el uso de ExpressRoute mediante Express Route Insights integrado.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Operaciones"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "5bf68dc9-325e-4873-bf88-f8214ef2e5d2",
            "id": "D04.14",
            "link": "https://learn.microsoft.com/azure/expressroute/how-to-configure-connection-monitor",
            "service": "ExpressRoute",
            "severity": "Medio",
            "subcategory": "Híbrido",
            "text": "Use el Monitor de conexión para la supervisión de la conectividad en toda la red, especialmente entre el entorno local y Azure.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Operaciones"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "e0d5973c-d4cd-421b-8881-37f5e6c4cfd3",
            "id": "D04.15",
            "link": "https://learn.microsoft.com/azure/expressroute/designing-for-disaster-recovery-with-expressroute-privatepeering#challenges-of-using-multiple-expressroute-circuits",
            "service": "ExpressRoute",
            "severity": "Medio",
            "subcategory": "Híbrido",
            "text": "Use circuitos ExpressRoute de diferentes ubicaciones de emparejamiento para obtener redundancia.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Fiabilidad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "cf3fe65c-fec0-495a-8edc-9675200f2add",
            "id": "D04.16",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-howto-coexist-resource-manager",
            "service": "ExpressRoute",
            "severity": "Medio",
            "subcategory": "Híbrido",
            "text": "Use VPN de sitio a sitio como conmutación por error de ExpressRoute, especialmente si solo usa un único circuito ExpressRoute.",
            "waf": "Fiabilidad"
        },
        {
            "ammp": true,
            "category": "Topología y conectividad de red",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,resourceGroup,name,subnets=properties.subnets | mv-expand subnets | project id,resourceGroup,name,subnetName=tostring(subnets.name),routeTableId=tostring(subnets.properties.routeTable.id) | where subnetName == 'GatewaySubnet' | join kind=leftouter (Resources | where type == 'microsoft.network/routetables' | project routeTableName=name,routeTableId=id, disableBgpRoutePropagation=properties.disableBgpRoutePropagation) on routeTableId | project id,compliant = (disableBgpRoutePropagation == False or isnull(disableBgpRoutePropagation))",
            "guid": "72105cc8-aaea-4ee1-8c7a-ad25977afcaf",
            "id": "D04.17",
            "link": "https://learn.microsoft.com/azure/vpn-gateway/vpn-gateway-about-vpn-gateway-settings#gwsub",
            "service": "ExpressRoute",
            "severity": "Alto",
            "subcategory": "Híbrido",
            "text": "Si utiliza una tabla de rutas en GatewaySubnet, asegúrese de que las rutas de puerta de enlace se propagan.",
            "waf": "Fiabilidad"
        },
        {
            "ammp": true,
            "category": "Topología y conectividad de red",
            "guid": "d581a947-69a2-4783-942e-9df3664324c8",
            "id": "D04.18",
            "link": "https://learn.microsoft.com/azure/expressroute/designing-for-high-availability-with-expressroute#active-active-connections",
            "service": "ExpressRoute",
            "severity": "Alto",
            "subcategory": "Híbrido",
            "text": "Si usa ExpressRoute, el enrutamiento local debe ser dinámico: en caso de que se produzca un error de conexión, debe converger a la conexión restante del circuito. La carga debe compartirse entre ambas conexiones, idealmente como activa/activa, aunque también se admite activa/pasiva.",
            "waf": "Fiabilidad"
        },
        {
            "ammp": true,
            "category": "Topología y conectividad de red",
            "guid": "558fd772-49b8-4211-82df-27ee412e7f98",
            "id": "D05.01",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-ip-addressing",
            "service": "ExpressRoute",
            "severity": "Alto",
            "subcategory": "Plan de propiedad intelectual",
            "text": "Asegúrese de que no se usan espacios de direcciones IP superpuestos en las regiones de Azure y las ubicaciones locales",
            "training": "https://learn.microsoft.com/learn/paths/architect-network-infrastructure/",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "graph": "resources | where type == 'microsoft.network/virtualnetworks' | extend addressSpace = todynamic(properties.addressSpace) | extend addressPrefix = todynamic(properties.addressSpace.addressPrefixes) | mvexpand addressSpace | mvexpand addressPrefix | project name, id, location, resourceGroup, subscriptionId, cidr = addressPrefix | extend compliant = (cidr matches regex @'^(10\\\\.|172\\\\.(1[6-9]|2[0-9]|3[01])\\\\.|192\\\\.168\\\\.)')  | project id, compliant, cidr",
            "guid": "3f630472-2dd6-49c5-a5c2-622f54b69bad",
            "id": "D05.02",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-ip-addressing",
            "service": "VNet",
            "severity": "Bajo",
            "subcategory": "Plan de propiedad intelectual",
            "text": "Utilice direcciones IP de los rangos de asignación de direcciones para Internet privadas (RFC 1918).",
            "training": "https://learn.microsoft.com/learn/paths/architect-network-infrastructure/",
            "waf": "Seguridad"
        },
        {
            "ammp": true,
            "category": "Topología y conectividad de red",
            "graph": "resources | where type == 'microsoft.network/virtualnetworks' | extend addressSpace = todynamic(properties.addressSpace) | extend addressPrefix = todynamic(properties.addressSpace.addressPrefixes) | mvexpand addressSpace | mvexpand addressPrefix | extend addressMask = split(addressPrefix,'/')[1] | extend compliant = addressMask > 16 | project name, id, subscriptionId, resourceGroup, addressPrefix, compliant",
            "guid": "33aad5e8-c68e-41d7-9667-313b4f5664b5",
            "id": "D05.03",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-ip-addressing",
            "service": "VNet",
            "severity": "Alto",
            "subcategory": "Plan de propiedad intelectual",
            "text": "Asegúrese de que no se desperdicie espacio de direcciones IP, no cree redes virtuales innecesariamente grandes (por ejemplo, /16)",
            "training": "https://learn.microsoft.com/learn/paths/architect-network-infrastructure/",
            "waf": "Rendimiento"
        },
        {
            "ammp": true,
            "category": "Topología y conectividad de red",
            "guid": "f348ef25-4c27-4d42-b8bb-ac7571559ab9",
            "id": "D05.04",
            "link": "https://learn.microsoft.com/azure/site-recovery/concepts-on-premises-to-azure-networking#retain-ip-addresses",
            "service": "VNet",
            "severity": "Alto",
            "subcategory": "Plan de propiedad intelectual",
            "text": "Evite el uso de intervalos de direcciones IP superpuestos para los sitios de producción y recuperación ante desastres.",
            "training": "https://learn.microsoft.com/learn/paths/az-104-manage-virtual-networks/",
            "waf": "Fiabilidad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "153e8908-ae28-4c84-a33b-6b7808b9fe5c",
            "id": "D05.05",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-networks-name-resolution-for-vms-and-role-instances",
            "service": "DNS",
            "severity": "Medio",
            "subcategory": "Plan de propiedad intelectual",
            "text": "En entornos en los que la resolución de nombres en Azure es todo lo que se requiere, use Azure Private DNS para la resolución con una zona delegada para la resolución de nombres (como \"azure.contoso.com\").",
            "training": "https://learn.microsoft.com/learn/paths/az-104-manage-virtual-networks/",
            "waf": "Operaciones"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "41049d40-3a92-43c3-974d-00018ac6a9e0",
            "id": "D05.06",
            "link": "https://learn.microsoft.com/azure/dns/dns-private-resolver-overview",
            "service": "DNS",
            "severity": "Medio",
            "subcategory": "Plan de propiedad intelectual",
            "text": "En el caso de los entornos en los que se requiere la resolución de nombres en Azure y en el entorno local, considere la posibilidad de usar Azure DNS Private Resolver.",
            "training": "https://learn.microsoft.com/training/modules/intro-to-azure-dns-private-resolver/",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "1e6a83de-5de3-42c1-a924-81607d5d1e4e",
            "id": "D05.07",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-networks-name-resolution-for-vms-and-role-instances",
            "service": "DNS",
            "severity": "Bajo",
            "subcategory": "Plan de propiedad intelectual",
            "text": "Las cargas de trabajo especiales que requieren e implementan su propio DNS (como Red Hat OpenShift) deben utilizar su solución DNS preferida.",
            "waf": "Operaciones"
        },
        {
            "ammp": true,
            "category": "Topología y conectividad de red",
            "guid": "614658d3-558f-4d77-849b-821112df27ee",
            "id": "D05.08",
            "link": "https://learn.microsoft.com/azure/dns/private-dns-autoregistration",
            "service": "DNS",
            "severity": "Alto",
            "subcategory": "Plan de propiedad intelectual",
            "text": "Habilite el registro automático de Azure DNS para administrar automáticamente el ciclo de vida de los registros DNS de las máquinas virtuales implementadas en una red virtual.",
            "training": "https://learn.microsoft.com/learn/paths/az-104-manage-virtual-networks/",
            "waf": "Operaciones"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "ee1ac551-c4d5-46cf-b035-d0a3c50d87ad",
            "id": "D06.01",
            "link": "https://learn.microsoft.com/azure/bastion/bastion-overview",
            "service": "Bastion",
            "severity": "Medio",
            "subcategory": "Internet",
            "text": "Considere la posibilidad de usar Azure Bastion para conectarse de forma segura a la red.",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,subnets=properties.subnets | mv-expand subnets | project id, subnetName = subnets.name, subnetPrefix = subnets.properties.addressPrefix | extend subnetPrefixLength = split(subnetPrefix, '/')[1] | where subnetName == 'AzureBastionSubnet' | extend compliant = (subnetPrefixLength <= 26) | distinct id, compliant",
            "guid": "6eab9eb6-762b-485e-8ea8-15aa5dba0bd0",
            "id": "D06.02",
            "link": "https://learn.microsoft.com/azure/bastion/bastion-faq#subnet",
            "service": "Bastion",
            "severity": "Medio",
            "subcategory": "Internet",
            "text": "Use Azure Bastion en una subred /26 o superior.",
            "waf": "Seguridad"
        },
        {
            "ammp": true,
            "category": "Topología y conectividad de red",
            "guid": "e6c4cfd3-e504-4547-a244-7ec66138a720",
            "id": "D06.03",
            "link": "https://learn.microsoft.com/azure/app-service/networking-features",
            "service": "Firewall",
            "severity": "Alto",
            "subcategory": "Internet",
            "text": "Use Azure Firewall para controlar el tráfico saliente de Azure a Internet, las conexiones entrantes que no son HTTP/S y el filtrado del tráfico Este/Oeste (si la organización lo requiere)",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "5a4b1511-e43a-458a-ac22-99c4d7b57d0c",
            "id": "D06.04",
            "link": "https://learn.microsoft.com/azure/firewall/",
            "service": "Firewall",
            "severity": "Medio",
            "subcategory": "Internet",
            "text": "Cree una directiva global de Azure Firewall para controlar la posición de seguridad en todo el entorno de red global y asígnela a todas las instancias de Azure Firewall. Permita que las directivas granulares satisfagan los requisitos de regiones específicas delegando directivas de firewall incrementales a los equipos de seguridad locales a través del control de acceso basado en roles de Azure.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "655562f2-b3e4-4563-a4d8-739748b662d6",
            "id": "D06.05",
            "link": "https://learn.microsoft.com/azure/firewall/",
            "service": "Firewall",
            "severity": "Bajo",
            "subcategory": "Internet",
            "text": "Configure los proveedores de seguridad SaaS de socios compatibles dentro de Firewall Manager si la organización desea utilizar dichas soluciones para ayudar a proteger las conexiones salientes.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "1d7aa9b6-4704-4489-a804-2d88e79d17b7",
            "id": "D06.06",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/afds-overview",
            "service": "WAF",
            "severity": "Medio",
            "subcategory": "Internet",
            "text": "Use directivas de Azure Front Door y WAF para proporcionar protección global en todas las regiones de Azure para las conexiones HTTP/S entrantes a una zona de aterrizaje.",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "3b22a5a6-7e7a-48ed-9b30-e38c3f29812b",
            "id": "D06.07",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "service": "WAF",
            "severity": "Bajo",
            "subcategory": "Internet",
            "text": "Al usar Azure Front Door y Azure Application Gateway para ayudar a proteger las aplicaciones HTTP/S, use directivas de WAF en Azure Front Door. Bloquee Azure Application Gateway para recibir tráfico solo de Azure Front Door.",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "Seguridad"
        },
        {
            "ammp": true,
            "category": "Topología y conectividad de red",
            "guid": "2363cefe-179b-4599-be0d-5973cd4cd21b",
            "id": "D06.08",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "service": "WAF",
            "severity": "Alto",
            "subcategory": "Internet",
            "text": "La implementación de WAF y otros servidores proxy inversos son necesarios para las conexiones HTTP/S entrantes, impleméntelos dentro de una red virtual de zona de aterrizaje y junto con las aplicaciones que protegen y exponen a Internet.",
            "training": "https://learn.microsoft.com/learn/paths/architect-network-infrastructure/",
            "waf": "Seguridad"
        },
        {
            "ammp": true,
            "category": "Topología y conectividad de red",
            "guid": "088137f5-e6c4-4cfd-9e50-4547c2447ec6",
            "id": "D06.09",
            "link": "https://learn.microsoft.com/azure/ddos-protection/ddos-protection-reference-architectures",
            "service": "VNet",
            "severity": "Alto",
            "subcategory": "Internet",
            "text": "Use planes de protección IP o de red DDoS de Azure para ayudar a proteger los puntos de conexión de direcciones IP públicas dentro de las redes virtuales.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Seguridad"
        },
        {
            "ammp": true,
            "category": "Topología y conectividad de red",
            "graph": "resources | where type=='microsoft.network/firewallpolicies' | extend compliant = (properties.dnsSettings.enableProxy == true) | distinct id,compliant",
            "guid": "14d99880-2f88-47e8-a134-62a7d85c94af",
            "id": "D06.10",
            "link": "https://learn.microsoft.com/azure/firewall/fqdn-filtering-network-rules",
            "service": "Firewall",
            "severity": "Alto",
            "subcategory": "Internet",
            "text": "Use reglas de red basadas en FQDN y Azure Firewall con proxy DNS para filtrar el tráfico de salida a Internet a través de protocolos no admitidos por las reglas de aplicación.",
            "waf": "Seguridad"
        },
        {
            "ammp": true,
            "category": "Topología y conectividad de red",
            "graph": "resources | where type=='microsoft.network/firewallpolicies' | extend compliant = (properties.sku.tier == 'Premium') | distinct id,compliant",
            "guid": "c10d51ef-f999-455d-bba0-5c90ece07447",
            "id": "D06.11",
            "link": "https://learn.microsoft.com/azure/firewall/premium-features",
            "service": "Firewall",
            "severity": "Alto",
            "subcategory": "Internet",
            "text": "Use Azure Firewall Premium para obtener seguridad y protección adicionales.",
            "waf": "Seguridad"
        },
        {
            "ammp": true,
            "category": "Topología y conectividad de red",
            "graph": "resources | where type=='microsoft.network/firewallpolicies' | extend compliant = (properties.threatIntelMode == 'Deny') | distinct id,compliant",
            "guid": "e9c8f584-6d5e-473b-8dc5-acc9fbaab4e3",
            "id": "D06.12",
            "link": "https://learn.microsoft.com/azure/firewall/premium-features",
            "service": "Firewall",
            "severity": "Alto",
            "subcategory": "Internet",
            "text": "Configure el modo de inteligencia sobre amenazas de Azure Firewall en Alerta y denegación para obtener protección adicional.",
            "waf": "Seguridad"
        },
        {
            "ammp": true,
            "category": "Topología y conectividad de red",
            "graph": "resources | where type=='microsoft.network/firewallpolicies' | extend compliant = (properties.intrusionDetection.mode == 'Deny') | project id, compliant",
            "guid": "b9d0dff5-bdd4-4cd8-88ed-5811610b2b2c",
            "id": "D06.13",
            "link": "https://learn.microsoft.com/azure/firewall/premium-features#idps",
            "service": "Firewall",
            "severity": "Alto",
            "subcategory": "Internet",
            "text": "Configure el modo IDPS de Azure Firewall en Denegar para obtener protección adicional.",
            "waf": "Seguridad"
        },
        {
            "ammp": true,
            "category": "Topología y conectividad de red",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,resourceGroup,name,subnets=properties.subnets | mv-expand subnets | project id,name,subnetId=tostring(subnets.id), subnetName=tostring(subnets.name),subnetRT=subnets.properties.routeTable.id | where not (subnetName in ('GatewaySubnet', 'AzureFirewallSubnet', 'RouteServerSubnet', 'AzureBastionSubnet')) | extend hasRT = isnotnull(subnetRT) | distinct id, hasRT, subnetId | join kind=fullouter (resources | where type == 'microsoft.network/virtualnetworks' | mvexpand properties.virtualNetworkPeerings | extend isVWAN=(tolower(split(properties_virtualNetworkPeerings.name, '_')[0]) == 'remotevnettohubpeering') | mv-expand properties.subnets | project id, isVWAN, name, subnetId=tostring(properties_subnets.id), subnetName=tostring(properties_subnets.name) | summarize PeeredToVWAN=max(isVWAN) by id, subnetId | project id, subnetId, isVWANpeer = (PeeredToVWAN == true)) on subnetId | project id=iff(isnotempty(id), id, id1), subnetId=iff(isnotempty(subnetId), subnetId, subnetId1), hasRT, isVWANpeer | extend compliant = (hasRT==true or isVWANpeer==true) | distinct id, subnetId, compliant",
            "guid": "a3784907-9836-4271-aafc-93535f8ec08b",
            "id": "D06.14",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-networks-udr-overview",
            "service": "Firewall",
            "severity": "Alto",
            "subcategory": "Internet",
            "text": "En el caso de las subredes de las redes virtuales que no están conectadas a Virtual WAN, adjunte una tabla de rutas para que el tráfico de Internet se redirija a Azure Firewall o a una aplicación virtual de red",
            "waf": "Seguridad"
        },
        {
            "ammp": true,
            "category": "Topología y conectividad de red",
            "guid": "b034c01e-110b-463a-b36e-e3346e57f225",
            "id": "D06.15",
            "link": "https://learn.microsoft.com/en-us/azure/virtual-network/ip-services/default-outbound-access",
            "service": "VNet",
            "severity": "Alto",
            "subcategory": "Internet",
            "text": "Evalúe y revise la configuración y la estrategia del tráfico saliente de la red antes del próximo cambio importante. El 30 de septiembre de 2025, se retirará el acceso saliente predeterminado para las nuevas implementaciones y solo se permitirán las configuraciones de acceso explícitas",
            "waf": "Fiabilidad"
        },
        {
            "ammp": true,
            "category": "Topología y conectividad de red",
            "guid": "b1c82a3f-2320-4dfa-8972-7ae4823c8930",
            "id": "D06.16",
            "link": "https://learn.microsoft.com/azure/ddos-protection/ddos-protection-reference-architectures",
            "service": "VNet",
            "severity": "Alto",
            "subcategory": "Internet",
            "text": "Agregue configuraciones de diagnóstico para guardar registros relacionados con DDoS para todas las direcciones IP públicas protegidas (DDoS IP o Protección de red).",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Seguridad"
        },
        {
            "ammp": true,
            "category": "Topología y conectividad de red",
            "guid": "715d833d-4708-4527-90ac-1b142c7045ba",
            "id": "D06.17",
            "link": "https://learn.microsoft.com/en-us/azure/firewall/firewall-structured-logs",
            "service": "Firewall",
            "severity": "Medio",
            "subcategory": "Internet",
            "text": "Agregue la configuración de diagnóstico para guardar registros, mediante la tabla de destino Recurso específico, para todas las implementaciones de Azure Firewall.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Operaciones"
        },
        {
            "ammp": true,
            "category": "Topología y conectividad de red",
            "guid": "e960fc6b-4ab2-4db6-9609-3745135f9ffa",
            "id": "D06.18",
            "link": "https://learn.microsoft.com/en-us/azure/firewall-manager/migrate-to-policy",
            "service": "Firewall",
            "severity": "Importante",
            "subcategory": "Internet",
            "text": "Migre de las reglas de Azure Firewall clásico (si existen) a la directiva de firewall.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Operaciones"
        },
        {
            "ammp": true,
            "category": "Topología y conectividad de red",
            "guid": "d301d6e8-72e5-42e3-911c-c58b5a4b1511",
            "id": "D07.01",
            "link": "https://learn.microsoft.com/azure/virtual-network/vnet-integration-for-azure-services",
            "service": "App Gateway",
            "severity": "Alto",
            "subcategory": "Paas",
            "text": "Asegúrese de que la comunicación del plano de control para los servicios PaaS de Azure insertados en una red virtual no se interrumpa, por ejemplo, con una ruta 0.0.0.0/0 o una regla de grupo de seguridad de red que bloquee el tráfico del plano de control.",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/?source=learn",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "e43a58a9-c229-49c4-b7b5-7d0c655562f2",
            "id": "D07.02",
            "link": "https://learn.microsoft.com/azure/app-service/networking-features",
            "severity": "Medio",
            "subcategory": "Paas",
            "text": "Use Private Link, cuando esté disponible, para los servicios PaaS compartidos de Azure.",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "b3e4563a-4d87-4397-98b6-62d6d15f512a",
            "id": "D07.03",
            "link": "https://learn.microsoft.com/azure/app-service/networking-features",
            "service": "ExpressRoute",
            "severity": "Medio",
            "subcategory": "Paas",
            "text": "Acceda a los servicios PaaS de Azure desde el entorno local a través de puntos de conexión privados y emparejamiento privado de ExpressRoute. Este método evita el tránsito a través de la Internet pública.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "graph": "resources | where type =~ 'microsoft.network/virtualnetworks' | project id,resourceGroup,name,subnets = properties.subnets | mv-expand subnets | project id = subnets.id, resourceGroup, VNet = name, serviceEndpoints = subnets.properties.serviceEndpoints, compliant = (isnull(subnets.properties.serviceEndpoints) or array_length(subnets.properties.serviceEndpoints) == 0) | order by compliant asc",
            "guid": "4704489a-8042-4d88-b79d-17b73b22a5a6",
            "id": "D07.04",
            "link": "https://learn.microsoft.com/azure/app-service/networking-features",
            "service": "VNet",
            "severity": "Medio",
            "subcategory": "Paas",
            "text": "No habilite los puntos de conexión de servicio de red virtual de forma predeterminada en todas las subredes.",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/?source=learn",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "7e7a8ed4-b30e-438c-9f29-812b2363cefe",
            "id": "D07.05",
            "link": "https://learn.microsoft.com/azure/app-service/networking-features",
            "service": "Firewall",
            "severity": "Medio",
            "subcategory": "Paas",
            "text": "Filtre el tráfico de salida a los servicios PaaS de Azure mediante FQDN en lugar de direcciones IP en Azure Firewall o una aplicación virtual de red para evitar la filtración de datos. Si usa Private Link, puede bloquear todos los FQDN, de lo contrario, permita solo los servicios PaaS necesarios.",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/?source=learn",
            "waf": "Seguridad"
        },
        {
            "ammp": true,
            "category": "Topología y conectividad de red",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,subnets=properties.subnets | mv-expand subnets | project id, subnetName = subnets.name, subnetPrefix = subnets.properties.addressPrefix | extend subnetPrefixLength = split(subnetPrefix, '/')[1] | where subnetName == 'AzureFirewallSubnet' | extend compliant = (subnetPrefixLength == 26) | distinct id, compliant",
            "guid": "22d6419e-b627-4d95-9e7d-019fa759387f",
            "id": "D08.01",
            "link": "https://learn.microsoft.com/azure/firewall/firewall-faq#why-does-azure-firewall-need-a--26-subnet-size",
            "service": "Firewall",
            "severity": "Alto",
            "subcategory": "Segmentación",
            "text": "Use un prefijo /26 para las subredes de Azure Firewall.",
            "waf": "Seguridad"
        },
        {
            "ammp": true,
            "category": "Topología y conectividad de red",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,subnets=properties.subnets | mv-expand subnets | project id, subnetName = subnets.name, subnetPrefix = subnets.properties.addressPrefix | extend subnetPrefixLength = split(subnetPrefix, '/')[1] | where subnetName == 'GatewaySubnet' | extend compliant = (subnetPrefixLength <= 27) | distinct id, compliant",
            "guid": "f2aad7e3-bb03-4adc-8606-4123d342a917",
            "id": "D08.02",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-howto-add-gateway-resource-manager#add-a-gateway",
            "service": "ExpressRoute",
            "severity": "Alto",
            "subcategory": "Segmentación",
            "text": "Use al menos un prefijo /27 para las subredes de puerta de enlace",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "graph": "resources | where type=='microsoft.network/networksecuritygroups' | mvexpand properties.securityRules | project id,name,ruleAction=properties_securityRules.properties.access,rulePriority=properties_securityRules.properties.priority,ruleDst=properties_securityRules.properties.destinationAddressPrefix,ruleSrc=properties_securityRules.properties.sourceAddressPrefix,ruleProt=properties_securityRules.properties.protocol,ruleDirection=properties_securityRules.properties.direction,rulePort=properties_securityRules.properties.destinationPortRange | summarize StarDenies=countif(ruleAction=='Deny' and ruleDst=='*' and ruleSrc=='*' and ruleProt=='*' and rulePort=='*') by id,tostring(ruleDirection) | where ruleDirection == 'Inbound' | project id,compliant=(StarDenies>0) | union (resources | where type=='microsoft.network/networksecuritygroups' | where array_length(properties.securityRules)==0 | extend compliant=false | project id,compliant)",
            "guid": "11deb39d-8299-4e47-bbe0-0fb5a36318a8",
            "id": "D08.03",
            "link": "https://learn.microsoft.com/azure/virtual-network/service-tags-overview#available-service-tags",
            "service": "NSG",
            "severity": "Medio",
            "subcategory": "Segmentación",
            "text": "No confíe en las reglas predeterminadas de entrada del grupo de seguridad de red que usan la etiqueta de servicio VirtualNetwork para limitar la conectividad.",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "c2447ec6-6138-4a72-80f1-ce16ed301d6e",
            "id": "D08.04",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-landing-zone-network-segmentation",
            "severity": "Medio",
            "subcategory": "Segmentación",
            "text": "Delegue la creación de subredes al propietario de la zona de aterrizaje.",
            "training": "https://learn.microsoft.com/learn/paths/implement-resource-mgmt-security/",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "872e52e3-611c-4c58-a5a4-b1511e43a58a",
            "id": "D08.05",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "service": "NSG",
            "severity": "Medio",
            "subcategory": "Segmentación",
            "text": "Use grupos de seguridad de red para ayudar a proteger el tráfico entre subredes, así como el tráfico este/oeste a través de la plataforma (tráfico entre zonas de aterrizaje).",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "graph": "Resources | where type=='microsoft.network/virtualnetworks' | project id,resourceGroup,name,subnets=properties.subnets | mv-expand subnets | project id,name,subnetName=subnets.name,subnetNsg=subnets.properties.networkSecurityGroup | where not (subnetName in ('GatewaySubnet', 'AzureFirewallSubnet', 'RouteServerSubnet', 'AzureBastionSubnet')) | extend compliant = isnotnull(subnetNsg)",
            "guid": "9c2299c4-d7b5-47d0-a655-562f2b3e4563",
            "id": "D08.06",
            "service": "NSG",
            "severity": "Medio",
            "subcategory": "Segmentación",
            "text": "El equipo de aplicaciones debe usar grupos de seguridad de aplicaciones en los grupos de seguridad de red de nivel de subred para ayudar a proteger las máquinas virtuales de varios niveles dentro de la zona de aterrizaje.",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "a4d87397-48b6-462d-9d15-f512a65498f6",
            "id": "D08.07",
            "link": "https://learn.microsoft.com/azure/virtual-network/network-security-group-how-it-works",
            "service": "NSG",
            "severity": "Medio",
            "subcategory": "Segmentación",
            "text": "Use grupos de seguridad de red y grupos de seguridad de aplicaciones para microsegmentar el tráfico dentro de la zona de aterrizaje y evitar el uso de una aplicación virtual de red central para filtrar los flujos de tráfico.",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "dfe237de-143b-416c-91d7-aa9b64704489",
            "id": "D08.08",
            "link": "https://learn.microsoft.com/azure/virtual-network/network-security-group-how-it-works",
            "service": "NSG",
            "severity": "Medio",
            "subcategory": "Segmentación",
            "text": "Habilite los registros de flujo de red virtual e introdúzcalos en Análisis de tráfico para obtener información sobre los flujos de tráfico internos y externos.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-network-monitoring/",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "graph": "resources | where type == 'microsoft.network/networksecuritygroups' | project id, rules = array_length(properties.securityRules) | project id, compliant = (rules < 900)",
            "guid": "0390417d-53dc-44d9-b3f4-c8832f359b41",
            "id": "D08.09",
            "link": "https://learn.microsoft.com/en-us/azure/azure-resource-manager/management/azure-subscription-service-limits",
            "service": "NSG",
            "severity": "Medio",
            "subcategory": "Segmentación",
            "text": "Tenga en cuenta el límite de reglas de grupo de seguridad de red por grupo de seguridad de red (1000).",
            "training": "https://learn.microsoft.com/en-us/azure/virtual-network/network-security-group-how-it-works",
            "waf": "Fiabilidad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "412e7f98-3f63-4047-82dd-69c5b5c2622f",
            "id": "D09.01",
            "link": "https://learn.microsoft.com/azure/virtual-wan/scenario-any-to-any",
            "service": "VWAN",
            "severity": "Medio",
            "subcategory": "Virtual WAN",
            "text": "Considere la posibilidad de utilizar Virtual WAN para simplificar la administración de redes de Azure y asegúrese de que el escenario se describe explícitamente en la lista de diseños de enrutamiento de Virtual WAN",
            "training": "https://learn.microsoft.com/learn/modules/introduction-azure-virtual-wan/",
            "waf": "Operaciones"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "54b69bad-33aa-4d5e-ac68-e1d76667313b",
            "id": "D09.02",
            "link": "https://learn.microsoft.com/azure/virtual-wan/virtual-wan-about",
            "service": "VWAN",
            "severity": "Medio",
            "subcategory": "Virtual WAN",
            "text": "Use un centro de conectividad de Virtual WAN por región de Azure para conectar varias zonas de aterrizaje entre sí en las regiones de Azure a través de una instancia global común de Azure Virtual WAN.",
            "waf": "Rendimiento"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "8ac6a9e0-1e6a-483d-b5de-32c199248160",
            "id": "D09.03",
            "link": "https://learn.microsoft.com/azure/virtual-wan/virtual-wan-about",
            "service": "VWAN",
            "severity": "Bajo",
            "subcategory": "Virtual WAN",
            "text": "Siga el principio \"el tráfico de Azure permanece en Azure\" para que la comunicación entre los recursos de Azure se produzca a través de la red troncal de Microsoft",
            "waf": "Rendimiento"
        },
        {
            "category": "Topología y conectividad de red",
            "graph": "resources | where type=='microsoft.network/virtualhubs' | extend compliant = isnotnull(properties.azureFirewall.id) | project id, compliant",
            "guid": "7d5d1e4e-6146-458d-9558-fd77249b8211",
            "id": "D09.04",
            "link": "https://learn.microsoft.com/azure/virtual-wan/virtual-wan-about",
            "service": "VWAN",
            "severity": "Medio",
            "subcategory": "Virtual WAN",
            "text": "Para la protección y el filtrado del tráfico de Internet saliente, implemente Azure Firewall en centros seguros",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "6667313b-4f56-464b-9e98-4a859c773e7d",
            "id": "D09.05",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits",
            "service": "VWAN",
            "severity": "Medio",
            "subcategory": "Virtual WAN",
            "text": "Asegúrese de que la arquitectura de red está dentro de los límites de Azure Virtual WAN.",
            "waf": "Fiabilidad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "261623a7-65a9-417e-8f34-8ef254c27d42",
            "id": "D09.06",
            "link": "https://learn.microsoft.com/azure/virtual-wan/azure-monitor-insights",
            "service": "VWAN",
            "severity": "Medio",
            "subcategory": "Virtual WAN",
            "text": "Use Azure Monitor Insights para Virtual WAN para supervisar la topología de un extremo a otro de Virtual WAN, el estado y las métricas clave.",
            "waf": "Operaciones"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "727c77e1-b9aa-4a37-a024-129d042422c1",
            "id": "D09.07",
            "link": "https://learn.microsoft.com/azure/virtual-wan/virtual-wan-faq#is-branch-to-branch-connectivity-allowed-in-virtual-wan",
            "service": "VWAN",
            "severity": "Medio",
            "subcategory": "Virtual WAN",
            "text": "Asegúrese de que las implementaciones de IaC no deshabiliten el tráfico de sucursal a sucursal en Virtual WAN, a menos que estos flujos se bloqueen explícitamente.",
            "waf": "Fiabilidad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "d49ac006-6670-4bc9-9948-d3e0a3a94f4d",
            "id": "D09.08",
            "link": "https://learn.microsoft.com/azure/virtual-wan/about-virtual-hub-routing-preference",
            "service": "VWAN",
            "severity": "Medio",
            "subcategory": "Virtual WAN",
            "text": "Use AS-Path como preferencia de enrutamiento del centro, ya que es más flexible que ExpressRoute o VPN.",
            "waf": "Fiabilidad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "2586b854-237e-47f1-84a1-d45d4cd2310d",
            "id": "D09.09",
            "link": "https://learn.microsoft.com/azure/virtual-wan/about-virtual-hub-routing#labels",
            "service": "VWAN",
            "severity": "Medio",
            "subcategory": "Virtual WAN",
            "text": "Asegúrese de que las implementaciones de IaC configuran la propagación basada en etiquetas en Virtual WAN, de lo contrario, la conectividad entre los centros virtuales se verá afectada.",
            "waf": "Fiabilidad"
        },
        {
            "ammp": true,
            "category": "Topología y conectividad de red",
            "guid": "9c75dfef-573c-461c-a698-68598595581a",
            "id": "D09.10",
            "link": "https://learn.microsoft.com/azure/virtual-wan/virtual-wan-faq#what-is-the-recommended-hub-address-space-during-hub-creation",
            "service": "VWAN",
            "severity": "Alto",
            "subcategory": "Virtual WAN",
            "text": "Asigne suficiente espacio IP a los centros virtuales, idealmente un prefijo /23.",
            "waf": "Fiabilidad"
        },
        {
            "ammp": true,
            "category": "Gobernanza",
            "guid": "5c986cb2-9131-456a-8247-6e49f541acdc",
            "id": "E01.01",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "service": "Policy",
            "severity": "Alto",
            "subcategory": "Gobernanza",
            "text": "Aproveche Azure Policy estratégicamente, defina controles para su entorno y use iniciativas de directivas para agrupar directivas relacionadas.",
            "waf": "Seguridad"
        },
        {
            "category": "Gobernanza",
            "guid": "e979377b-cdb3-4751-ab2a-b13ada6e55d7",
            "id": "E01.02",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/naming-and-tagging",
            "service": "Policy",
            "severity": "Medio",
            "subcategory": "Gobernanza",
            "text": "Identifique las etiquetas de Azure necesarias y use el modo de directiva \"anexar\" para aplicar el uso a través de Azure Policy.",
            "waf": "Seguridad"
        },
        {
            "category": "Gobernanza",
            "guid": "d8a2adb1-17d6-4326-af62-5ca44e5695f2",
            "id": "E01.03",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "service": "Policy",
            "severity": "Medio",
            "subcategory": "Gobernanza",
            "text": "Asigne los requisitos normativos y de cumplimiento normativo a las definiciones de Azure Policy y a las asignaciones de roles de Azure.",
            "waf": "Seguridad"
        },
        {
            "category": "Gobernanza",
            "guid": "223ace8c-b123-408c-a501-7f154e3ab369",
            "id": "E01.04",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "service": "Policy",
            "severity": "Medio",
            "subcategory": "Gobernanza",
            "text": "Establezca definiciones de Azure Policy en el grupo de administración raíz intermedio para que se puedan asignar en ámbitos heredados",
            "waf": "Seguridad"
        },
        {
            "category": "Gobernanza",
            "guid": "3829e7e3-1618-4368-9a04-77a209945bda",
            "id": "E01.05",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "service": "Policy",
            "severity": "Medio",
            "subcategory": "Gobernanza",
            "text": "Administre las asignaciones de directivas en el nivel más alto adecuado con exclusiones en los niveles inferiores, si es necesario.",
            "waf": "Seguridad"
        },
        {
            "category": "Gobernanza",
            "guid": "43334f24-9116-4341-a2ba-527526944008",
            "id": "E01.06",
            "link": "https://learn.microsoft.com/security/benchmark/azure/mcsb-asset-management#am-2-use-only-approved-services",
            "service": "Policy",
            "severity": "Bajo",
            "subcategory": "Gobernanza",
            "text": "Use Azure Policy para controlar qué servicios pueden aprovisionar los usuarios en el nivel de suscripción o grupo de administración",
            "waf": "Seguridad"
        },
        {
            "category": "Gobernanza",
            "guid": "be7d7e48-4327-46d8-adc0-55bcf619e8a1",
            "id": "E01.07",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "service": "Policy",
            "severity": "Medio",
            "subcategory": "Gobernanza",
            "text": "Utilice políticas integradas siempre que sea posible para minimizar la sobrecarga operativa.",
            "waf": "Seguridad"
        },
        {
            "category": "Gobernanza",
            "description": "La asignación del rol Colaborador de directivas de recursos a ámbitos específicos le permite delegar la administración de directivas a los equipos pertinentes. Por ejemplo, un equipo de TI central puede supervisar las directivas a nivel de grupo de administración, mientras que los equipos de aplicaciones se encargan de las directivas de sus suscripciones, lo que permite la gobernanza distribuida con el cumplimiento de los estándares de la organización.",
            "guid": "3f988795-25d6-4268-a6d7-0ba6c97be995",
            "id": "E01.08",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview#azure-rbac-permissions-in-azure-policy",
            "service": "Policy",
            "severity": "Medio",
            "subcategory": "Gobernanza",
            "text": "Asigne el rol integrado Colaborador de directivas de recursos en un ámbito determinado para habilitar la gobernanza de nivel de aplicación.",
            "waf": "Seguridad"
        },
        {
            "category": "Gobernanza",
            "guid": "19048384-5c98-46cb-8913-156a12476e49",
            "id": "E01.09",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "service": "Policy",
            "severity": "Medio",
            "subcategory": "Gobernanza",
            "text": "Limite el número de asignaciones de Azure Policy realizadas en el ámbito del grupo de administración raíz para evitar la administración a través de exclusiones en ámbitos heredados.",
            "waf": "Seguridad"
        },
        {
            "category": "Gobernanza",
            "guid": "5a917e1f-348e-4f25-9c27-d42e8bbac757",
            "id": "E01.10",
            "link": "https://azure.microsoft.com/resources/achieving-compliant-data-residency-and-security-with-azure/",
            "service": "Policy",
            "severity": "Medio",
            "subcategory": "Gobernanza",
            "text": "Si existen requisitos de soberanía de datos, se pueden implementar directivas de Azure para aplicarlos",
            "training": "https://learn.microsoft.com/learn/paths/secure-your-cloud-data/",
            "waf": "Seguridad"
        },
        {
            "category": "Gobernanza",
            "guid": "78b22132-b41c-460b-a4d3-df8f73a67dc2",
            "id": "E01.11",
            "link": "https://github.com/Azure/sovereign-landing-zone/blob/main/docs/scenarios/Sovereignty-Policy-Baseline.md",
            "service": "Policy",
            "severity": "Medio",
            "subcategory": "Gobernanza",
            "text": "En el caso de la Zona de Aterrizaje Soberana, la iniciativa política de referencia de la política de soberanía se despliega y asigna al nivel correcto de MG.",
            "waf": "Seguridad"
        },
        {
            "category": "Gobernanza",
            "guid": "caeea0e9-1024-41df-a52e-d99c3f22a6f4",
            "id": "E01.12",
            "link": "https://learn.microsoft.com/en-us/industry/sovereignty/policy-portfolio-baseline",
            "service": "Policy",
            "severity": "Medio",
            "subcategory": "Gobernanza",
            "text": "En el caso de la Zona de Aterrizaje Soberana, se documentan los objetivos de control soberano para el mapeo de políticas.",
            "waf": "Seguridad"
        },
        {
            "category": "Gobernanza",
            "guid": "9b461617-db7b-4399-8ac6-d4eb7153893a",
            "id": "E01.13",
            "service": "Policy",
            "severity": "Medio",
            "subcategory": "Gobernanza",
            "text": "En el caso de la Zona de Aterrizaje Soberana, existe un proceso para el CRUD de \"Objetivos de Control Soberano para el mapeo de políticas\".",
            "waf": "Seguridad"
        },
        {
            "category": "Gobernanza",
            "guid": "9b5e2a28-9823-4faf-ab7e-afa5f6c57221",
            "id": "E02.01",
            "link": "https://learn.microsoft.com/azure/automation/automation-solution-vm-management-config",
            "service": "VM",
            "severity": "Bajo",
            "subcategory": "Optimice su inversión en la nube",
            "text": "Considere la posibilidad de usar etiquetas de automatización para iniciar o detener máquinas virtuales en su entorno para ahorrar costos.",
            "waf": "Seguridad"
        },
        {
            "category": "Administración",
            "guid": "ecdc7506-6f37-4ea9-be87-fc5d3df08a64",
            "id": "E02.01",
            "link": "https://learn.microsoft.com/azure/virtual-machine-scale-sets/overview",
            "service": "VMSS",
            "severity": "Medio",
            "subcategory": "Escalabilidad",
            "text": "Aproveche los conjuntos de escalado de máquinas virtuales de Azure para escalar horizontalmente y horizontalmente en función de la carga.",
            "waf": "Fiabilidad"
        },
        {
            "category": "Gobernanza",
            "guid": "29fd366b-a180-452b-9bd7-954b7700c667",
            "id": "E02.02",
            "link": "https://learn.microsoft.com/azure/cost-management-billing/costs/tutorial-acm-create-budgets?bc=%2Fazure%2Fcloud-adoption-framework%2F_bread%2Ftoc.json&toc=%2Fazure%2Fcloud-adoption-framework%2Ftoc.json",
            "severity": "Medio",
            "subcategory": "Optimice su inversión en la nube",
            "text": "Configure alertas de presupuesto \"real\" y \"pronosticado\".",
            "waf": "Costar"
        },
        {
            "ammp": true,
            "category": "Administración",
            "guid": "89cc5e11-aa4d-4c3b-893d-feb99215266a",
            "id": "F01.01",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#add-diagnostic-settings-to-save-your-wafs-logs",
            "service": "WAF",
            "severity": "Alto",
            "subcategory": "Entrega de aplicaciones",
            "text": "Agregue la configuración de diagnóstico para guardar los registros de WAF de los servicios de entrega de aplicaciones, como Azure Front Door y Azure Application Gateway. Revise periódicamente los registros para comprobar si hay ataques y detecciones de falsos positivos.",
            "waf": "Operaciones"
        },
        {
            "category": "Administración",
            "guid": "7f408960-c626-44cb-a018-347c8d790cdf",
            "id": "F01.02",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#send-logs-to-microsoft-sentinel",
            "service": "WAF",
            "severity": "Medio",
            "subcategory": "Entrega de aplicaciones",
            "text": "Envíe registros de WAF desde los servicios de entrega de aplicaciones, como Azure Front Door y Azure Application Gateway, a Microsoft Sentinel. Detecte ataques e integre la telemetría de WAF en su entorno general de Azure.",
            "waf": "Operaciones"
        },
        {
            "category": "Administración",
            "guid": "7ea02e1c-7166-45a3-bdf5-098891367fcb",
            "id": "F02.01",
            "link": "https://learn.microsoft.com/azure/reliability/cross-region-replication-azure",
            "severity": "Medio",
            "subcategory": "Protección de datos",
            "text": "Considere la posibilidad de replicar entre regiones en Azure para BCDR con regiones emparejadas",
            "waf": "Fiabilidad"
        },
        {
            "category": "Administración",
            "guid": "eba8cf22-45c6-4dc1-9b57-2cceb3b97ce5",
            "id": "F02.02",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-redundancy",
            "service": "Backup",
            "severity": "Medio",
            "subcategory": "Protección de datos",
            "text": "Al usar Azure Backup, tenga en cuenta los diferentes tipos de copia de seguridad (GRS, ZRS Y LRS), ya que la configuración predeterminada es GRS",
            "waf": "Fiabilidad"
        },
        {
            "category": "Administración",
            "guid": "67e7a8ed-4b30-4e38-a3f2-9812b2363cef",
            "id": "F03.01",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/design-logs-deployment",
            "service": "Monitor",
            "severity": "Medio",
            "subcategory": "Monitorización",
            "text": "Use un área de trabajo de registros de un único monitor para administrar las plataformas de forma centralizada, excepto cuando el control de acceso basado en rol de Azure (Azure RBAC), los requisitos de soberanía de datos o las directivas de retención de datos exijan áreas de trabajo independientes.",
            "training": "https://learn.microsoft.com/azure/azure-monitor/logs/design-logs-deployment",
            "waf": "Operaciones"
        },
        {
            "category": "Administración",
            "guid": "e179b599-de0d-4597-9cd4-cd21b088137f",
            "id": "F03.02",
            "severity": "Medio",
            "subcategory": "Monitorización",
            "text": "Asegúrese de que la zona de aterrizaje esté documentada.",
            "waf": "Operaciones"
        },
        {
            "category": "Administración",
            "guid": "5e6c4cfd-3e50-4454-9c24-47ec66138a72",
            "id": "F03.03",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/data-retention-archive?tabs=portal-1%2Cportal-2#how-retention-and-archiving-work",
            "service": "Monitor",
            "severity": "Medio",
            "subcategory": "Monitorización",
            "text": "Use los registros de Azure Monitor cuando los requisitos de retención de registros superen los dos años. Actualmente puede mantener los datos archivados durante un máximo de 7 años.",
            "training": "https://learn.microsoft.com/learn/paths/architect-infrastructure-operations/",
            "waf": "Operaciones"
        },
        {
            "category": "Administración",
            "guid": "00f1ce16-ed30-41d6-b872-e52e3611cc58",
            "id": "F03.04",
            "link": "https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/govern/policy-compliance/regulatory-compliance",
            "service": "Policy",
            "severity": "Medio",
            "subcategory": "Monitorización",
            "text": "Use Azure Policy para el control de acceso y los informes de cumplimiento. Azure Policy proporciona la capacidad de aplicar la configuración de toda la organización para garantizar el cumplimiento coherente de las directivas y la detección rápida de infracciones.",
            "training": "https://learn.microsoft.com/en-us/azure/governance/policy/concepts/effects",
            "waf": "Operaciones"
        },
        {
            "category": "Administración",
            "guid": "e7d7e484-3276-4d8b-bc05-5bcf619e8a13",
            "id": "F03.05",
            "link": "https://learn.microsoft.com/azure/governance/policy/how-to/guest-configuration-create",
            "service": "VM",
            "severity": "Medio",
            "subcategory": "Monitorización",
            "text": "Supervise el desfase de configuración de la máquina virtual (VM) invitada mediante Azure Policy. La habilitación de las capacidades de auditoría de configuración de invitado a través de la directiva ayuda a las cargas de trabajo del equipo de aplicaciones a consumir inmediatamente las capacidades de las funciones con poco esfuerzo.",
            "training": "https://learn.microsoft.com/learn/paths/implement-resource-mgmt-security/",
            "waf": "Operaciones"
        },
        {
            "category": "Administración",
            "guid": "f9887952-5d62-4688-9d70-ba6c97be9951",
            "id": "F03.06",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/management-operational-compliance#update-management-considerations ",
            "service": "VM",
            "severity": "Medio",
            "subcategory": "Cumplimiento operacional",
            "text": "Use Azure Update Manager como mecanismo de aplicación de revisiones para máquinas virtuales Windows y Linux en Azure.",
            "training": "https://learn.microsoft.com/azure/update-manager/overview?tabs=azure-vms",
            "waf": "Operaciones"
        },
        {
            "category": "Administración",
            "guid": "c806c048-26b7-4ddf-b4c2-b4f0c476925d",
            "id": "F03.07",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/management-operational-compliance#update-management-considerations ",
            "service": "VM",
            "severity": "Medio",
            "subcategory": "Cumplimiento operacional",
            "text": "Use Azure Update Manager como mecanismo de aplicación de revisiones para máquinas virtuales Windows y Linux fuera de Azure mediante Azure Arc.",
            "training": "https://learn.microsoft.com/azure/update-manager/overview?tabs=azure-vms",
            "waf": "Operaciones"
        },
        {
            "category": "Administración",
            "guid": "90483845-c986-4cb2-a131-56a12476e49f",
            "id": "F03.08",
            "link": "https://learn.microsoft.com/azure/network-watcher/network-watcher-monitoring-overview",
            "service": "Network Watcher",
            "severity": "Medio",
            "subcategory": "Monitorización",
            "text": "Utilice Network Watcher para supervisar de forma proactiva los flujos de tráfico",
            "training": "https://learn.microsoft.com/learn/modules/configure-network-watcher/",
            "waf": "Operaciones"
        },
        {
            "category": "Administración",
            "guid": "541acdce-9793-477b-adb3-751ab2ab13ad",
            "id": "F03.09",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/lock-resources?tabs=json",
            "severity": "Medio",
            "subcategory": "Monitorización",
            "text": "Utilice bloqueos de recursos para evitar la eliminación accidental de servicios compartidos críticos.",
            "training": "https://learn.microsoft.com/learn/paths/implement-resource-mgmt-security/",
            "waf": "Operaciones"
        },
        {
            "category": "Administración",
            "guid": "a6e55d7d-8a2a-4db1-87d6-326af625ca44",
            "id": "F03.10",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "severity": "Bajo",
            "subcategory": "Monitorización",
            "text": "Use directivas de denegación para complementar las asignaciones de roles de Azure. La combinación de directivas de denegación y asignaciones de roles de Azure garantiza que existan las barreras de protección adecuadas para exigir quién puede implementar y configurar recursos y qué recursos pueden implementar y configurar.",
            "waf": "Operaciones"
        },
        {
            "category": "Administración",
            "guid": "e5695f22-23ac-4e8c-a123-08ca5017f154",
            "id": "F03.11",
            "link": "https://learn.microsoft.com/azure/service-health/alerts-activity-log-service-notifications-portal",
            "severity": "Medio",
            "subcategory": "Monitorización",
            "text": "Incluya eventos de estado de servicios y recursos como parte de la solución general de supervisión de la plataforma. El seguimiento del estado de los servicios y los recursos desde la perspectiva de la plataforma es un componente importante de la administración de recursos en Azure.",
            "waf": "Operaciones"
        },
        {
            "category": "Administración",
            "guid": "d5f345bf-97ab-41a7-819c-6104baa7d48c",
            "id": "F03.12",
            "link": "https://learn.microsoft.com/azure/azure-monitor/alerts/action-groups",
            "severity": "Medio",
            "subcategory": "Monitorización",
            "text": "Incluya alertas y grupos de acciones como parte de la plataforma Azure Service Health para asegurarse de que se pueden realizar las alertas o los problemas",
            "waf": "Operaciones"
        },
        {
            "category": "Administración",
            "guid": "e3ab3693-829e-47e3-8618-3687a0477a20",
            "id": "F03.13",
            "link": "https://learn.microsoft.com/azure/sentinel/quickstart-onboard",
            "severity": "Medio",
            "subcategory": "Monitorización",
            "text": "No envíe entradas de registro sin procesar a los sistemas de supervisión locales. En su lugar, adopte el principio de que los datos nacidos en Azure permanecen en Azure. Si se requiere la integración de SIEM local, envíe alertas críticas en lugar de registros.",
            "waf": "Operaciones"
        },
        {
            "category": "Administración",
            "guid": "9945bda4-3334-4f24-a116-34182ba52752",
            "id": "F03.14",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/design-logs-deployment",
            "service": "Monitor",
            "severity": "Medio",
            "subcategory": "Monitorización",
            "text": "Use un área de trabajo centralizada de Log Analytics de Azure Monitor para recopilar registros y métricas de los recursos de aplicaciones IaaS y PaaS y controlar el acceso a los registros con Azure RBAC.",
            "waf": "Operaciones"
        },
        {
            "category": "Administración",
            "guid": "6944008b-e7d7-4e48-9327-6d8bdc055bcf",
            "id": "F03.15",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-setup-guide/monitoring-reporting?tabs=AzureMonitor",
            "service": "Monitor",
            "severity": "Medio",
            "subcategory": "Monitorización",
            "text": "Use los registros de Azure Monitor para obtener información e informes.",
            "waf": "Operaciones"
        },
        {
            "category": "Administración",
            "guid": "619e8a13-f988-4795-85d6-26886d70ba6c",
            "id": "F03.16",
            "link": "https://learn.microsoft.com/azure/azure-monitor/agents/diagnostics-extension-overview",
            "severity": "Medio",
            "subcategory": "Monitorización",
            "text": "Cuando sea necesario, use cuentas de almacenamiento compartido dentro de la zona de aterrizaje para el almacenamiento de registros de la extensión de diagnóstico de Azure.",
            "waf": "Operaciones"
        },
        {
            "category": "Administración",
            "guid": "97be9951-9048-4384-9c98-6cb2913156a1",
            "id": "F03.17",
            "link": "https://learn.microsoft.com/azure/azure-monitor/alerts/alerts-overview",
            "service": "Monitor",
            "severity": "Medio",
            "subcategory": "Monitorización",
            "text": "Use alertas de Azure Monitor para la generación de alertas operativas.",
            "waf": "Operaciones"
        },
        {
            "category": "Administración",
            "guid": "859c3900-4514-41eb-b010-475d695abd74",
            "id": "F03.18",
            "link": "https://learn.microsoft.com/azure/architecture/best-practices/monitoring",
            "severity": "Medio",
            "subcategory": "Monitorización",
            "text": "Asegúrese de que se han evaluado los requisitos de supervisión y de que se aplican las configuraciones adecuadas de recopilación de datos y alertas.",
            "waf": "Operaciones"
        },
        {
            "category": "Administración",
            "guid": "fed3c55f-a67e-4875-aadd-3aba3f9fde31",
            "id": "F03.19",
            "link": "https://learn.microsoft.com/azure/automation/how-to/region-mappings",
            "service": "Monitor",
            "severity": "Medio",
            "subcategory": "Monitorización",
            "text": "Al usar el seguimiento de cambios e inventario a través de cuentas de Azure Automation, asegúrese de que ha seleccionado las regiones admitidas para vincular el área de trabajo de Log Analytics y las cuentas de automatización.",
            "waf": "Operaciones"
        },
        {
            "category": "Administración",
            "guid": "aa45be6a-8f2d-4896-b0e3-775e6e94e610",
            "id": "F03.19",
            "link": "https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/ready/landing-zone/design-area/management-monitor",
            "severity": "Medio",
            "subcategory": "Monitorización",
            "text": "Establecimiento de la supervisión de los componentes de la plataforma de la zona de aterrizaje, AMBA es una solución de marco que está disponible y proporciona una manera sencilla de escalar las alertas mediante Azure Policy",
            "training": "https://azure.github.io/azure-monitor-baseline-alerts/patterns/alz/",
            "waf": "Operaciones"
        },
        {
            "category": "Administración",
            "guid": "f541acdc-e979-4377-acdb-3751ab2ab13a",
            "id": "F04.01",
            "link": "https://learn.microsoft.com/azure/governance/policy/concepts/guest-configuration",
            "service": "VM",
            "severity": "Medio",
            "subcategory": "Cumplimiento operacional",
            "text": "Use directivas de Azure para implementar automáticamente configuraciones de software a través de extensiones de máquina virtual y aplicar una configuración de máquina virtual de línea base compatible.",
            "waf": "Seguridad"
        },
        {
            "category": "Administración",
            "description": "Las características de configuración de invitado de Azure Policy pueden auditar y corregir la configuración de la máquina (por ejemplo, el sistema operativo, la aplicación, el entorno) para asegurarse de que los recursos se alinean con las configuraciones esperadas, y Update Management puede aplicar la administración de revisiones para las máquinas virtuales.",
            "guid": "da6e55d7-d8a2-4adb-817d-6326af625ca4",
            "id": "F04.02",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/management-operational-compliance#monitoring-for-configuration-drift",
            "service": "VM",
            "severity": "Medio",
            "subcategory": "Cumplimiento operacional",
            "text": "Supervise el desfase de la configuración de seguridad de la máquina virtual a través de Azure Policy.",
            "waf": "Seguridad"
        },
        {
            "category": "Administración",
            "guid": "2476e49f-541a-4cdc-b979-377bcdb3751a",
            "id": "F05.01",
            "link": "https://learn.microsoft.com/azure/site-recovery/site-recovery-overview",
            "service": "VM",
            "severity": "Medio",
            "subcategory": "Proteger y recuperar",
            "text": "Use Azure Site Recovery para escenarios de recuperación ante desastres de Azure a Azure Virtual Machines. Esto le permite replicar cargas de trabajo en todas las regiones.",
            "waf": "Operaciones"
        },
        {
            "category": "Administración",
            "guid": "b2ab13ad-a6e5-45d7-b8a2-adb117d6326a",
            "id": "F05.02",
            "link": "https://learn.microsoft.com/azure/architecture/framework/resiliency/backup-and-recovery",
            "severity": "Medio",
            "subcategory": "Proteger y recuperar",
            "text": "Asegúrese de usar y probar las capacidades nativas de recuperación ante desastres del servicio PaaS.",
            "waf": "Operaciones"
        },
        {
            "category": "Administración",
            "guid": "f625ca44-e569-45f2-823a-ce8cb12308ca",
            "id": "F05.03",
            "link": "https://learn.microsoft.com/azure/backup/backup-center-overview",
            "service": "Backup",
            "severity": "Medio",
            "subcategory": "Proteger y recuperar",
            "text": "Use funcionalidades de copia de seguridad nativas de Azure o una solución de copia de seguridad de terceros compatible con Azure.",
            "waf": "Operaciones"
        },
        {
            "ammp": true,
            "category": "Administración",
            "guid": "826c5c45-bb79-4951-a812-e3bfbfd7326b",
            "id": "F06.01",
            "link": "https://learn.microsoft.com/azure/reliability/availability-zones-overview",
            "service": "VM",
            "severity": "Alto",
            "subcategory": "Tolerancia a fallos",
            "text": "Aproveche las zonas de disponibilidad para las máquinas virtuales en las regiones en las que se admiten.",
            "waf": "Fiabilidad"
        },
        {
            "ammp": true,
            "category": "Administración",
            "guid": "7ccb7c06-5511-42df-8177-d97f08d0337d",
            "id": "F06.02",
            "link": "https://learn.microsoft.com/azure/virtual-machines/availability",
            "service": "VM",
            "severity": "Alto",
            "subcategory": "Tolerancia a fallos",
            "text": "Evite ejecutar una carga de trabajo de producción en una sola máquina virtual.",
            "waf": "Fiabilidad"
        },
        {
            "category": "Administración",
            "guid": "84101f59-1941-4195-a270-e28034290e3a",
            "id": "F06.03",
            "link": "https://learn.microsoft.com/azure/load-balancer/load-balancer-overview",
            "service": "VM",
            "severity": "Medio",
            "subcategory": "Tolerancia a fallos",
            "text": "Azure Load Balancer y Application Gateway distribuyen el tráfico de red entrante entre varios recursos.",
            "waf": "Fiabilidad"
        },
        {
            "category": "Seguridad",
            "guid": "b86ad884-08e3-4727-94b8-75ba18f20459",
            "id": "G01.01",
            "link": "https://learn.microsoft.com/security/benchmark/azure/security-control-incident-response",
            "severity": "Medio",
            "subcategory": "Control de acceso",
            "text": "Determine el plan de respuesta a incidentes para los servicios de Azure antes de permitirlo en producción.",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad",
            "guid": "01365d38-e43f-49cc-ad86-8266abca264f",
            "id": "G01.02",
            "link": "https://www.microsoft.com/security/business/zero-trust",
            "severity": "Medio",
            "subcategory": "Control de acceso",
            "text": "Implemente un enfoque de confianza cero para el acceso a la plataforma Azure, cuando corresponda.",
            "waf": "Seguridad"
        },
        {
            "ammp": true,
            "category": "Seguridad",
            "guid": "5017f154-e3ab-4369-9829-e7e316183687",
            "id": "G02.01",
            "link": "https://learn.microsoft.com/azure/key-vault/general/overview",
            "service": "Key Vault",
            "severity": "Alto",
            "subcategory": "Cifrado y claves",
            "text": "Uso de Azure Key Vault para almacenar los secretos y las credenciales",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad",
            "graph": "ResourceContainers | where type=='microsoft.resources/subscriptions'| parse id with '/subscriptions/' SubscriptionID| project subscriptionId, SubscriptionName = name| join kind=leftouter (Resources| where type == 'microsoft.keyvault/vaults'| project id, name, subscriptionId) on subscriptionId| join kind= leftouter (Resources| where type == 'microsoft.keyvault/vaults'| summarize ResourceCount = count() by subscriptionId) on subscriptionId| extend RCount = iff(isnull(ResourceCount), 0, ResourceCount)| project-away ResourceCount| extend compliant = (RCount <> 1)",
            "guid": "a0477a20-9945-4bda-9333-4f2491163418",
            "id": "G02.02",
            "link": "https://learn.microsoft.com/azure/key-vault/general/overview-throttling",
            "service": "Key Vault",
            "severity": "Medio",
            "subcategory": "Cifrado y claves",
            "text": "Use diferentes instancias de Azure Key Vaults para diferentes aplicaciones y regiones para evitar límites de escala de transacciones y restringir el acceso a los secretos.",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad",
            "guid": "2ba52752-6944-4008-ae7d-7e4843276d8b",
            "id": "G02.03",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "severity": "Medio",
            "subcategory": "Cifrado y claves",
            "text": "Aprovisione Azure Key Vault con las directivas de eliminación temporal y purga habilitadas para permitir la protección de retención de los objetos eliminados.",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad",
            "guid": "dc055bcf-619e-48a1-9f98-879525d62688",
            "id": "G02.04",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "severity": "Medio",
            "subcategory": "Cifrado y claves",
            "text": "Siga un modelo de privilegios mínimos limitando la autorización para eliminar claves, secretos y certificados de forma permanente a roles de identificador personalizados especializados de Microsoft Entra.",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad",
            "guid": "6d70ba6c-97be-4995-8904-83845c986cb2",
            "id": "G02.05",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "severity": "Medio",
            "subcategory": "Cifrado y claves",
            "text": "Automatice el proceso de gestión y renovación de certificados con autoridades de certificación públicas para facilitar la administración.",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad",
            "guid": "913156a1-2476-4e49-b541-acdce979377b",
            "id": "G02.06",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "severity": "Medio",
            "subcategory": "Cifrado y claves",
            "text": "Establezca un proceso automatizado para la rotación de claves y certificados.",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad",
            "guid": "cdb3751a-b2ab-413a-ba6e-55d7d8a2adb1",
            "id": "G02.07",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "severity": "Medio",
            "subcategory": "Cifrado y claves",
            "text": "Habilite el firewall y el punto de conexión de servicio de red virtual o el punto de conexión privado en el almacén para controlar el acceso al almacén de claves.",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad",
            "guid": "17d6326a-f625-4ca4-9e56-95f2223ace8c",
            "id": "G02.08",
            "link": "https://learn.microsoft.com/azure/key-vault/general/monitor-key-vault",
            "service": "Key Vault",
            "severity": "Medio",
            "subcategory": "Cifrado y claves",
            "text": "Use el área de trabajo de Log Analytics de Azure Monitor central de la plataforma para auditar el uso de claves, certificados y secretos en cada instancia de Key Vault.",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad",
            "guid": "b12308ca-5017-4f15-9e3a-b3693829e7e3",
            "id": "G02.09",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "severity": "Medio",
            "subcategory": "Cifrado y claves",
            "text": "Delegue la creación de instancias de Key Vault y el acceso con privilegios, y use Azure Policy para aplicar una configuración coherente y compatible.",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad",
            "guid": "16183687-a047-47a2-8994-5bda43334f24",
            "id": "G02.10",
            "link": "https://learn.microsoft.com/azure/security/fundamentals/encryption-atrest",
            "severity": "Medio",
            "subcategory": "Cifrado y claves",
            "text": "De forma predeterminada, utilice claves administradas por Microsoft para la funcionalidad de cifrado de entidad de seguridad y use claves administradas por el cliente cuando sea necesario.",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad",
            "guid": "91163418-2ba5-4275-8694-4008be7d7e48",
            "id": "G02.11",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "severity": "Medio",
            "subcategory": "Cifrado y claves",
            "text": "Use una instancia de Azure Key Vault por aplicación, por entorno, por región.",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad",
            "guid": "25d62688-6d70-4ba6-a97b-e99519048384",
            "id": "G02.12",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "severity": "Medio",
            "subcategory": "Cifrado y claves",
            "text": "Si desea traer sus propias claves, es posible que esto no sea compatible con todos los servicios considerados. Implemente la mitigación pertinente para que las inconsistencias no obstaculicen los resultados deseados. Elija los pares de regiones y las regiones de recuperación ante desastres adecuados que minimicen la latencia.",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad",
            "guid": "4ac6b67c-b3a4-4ff9-8e87-b07a7ce7bbdb",
            "id": "G02.13",
            "link": "https://learn.microsoft.com/en-us/industry/sovereignty/key-management",
            "service": "Key Vault",
            "severity": "Medio",
            "subcategory": "Cifrado y claves",
            "text": "En el caso de la zona de aterrizaje soberana, use el HSM administrado de Azure Key Vault para almacenar los secretos y las credenciales.",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad",
            "guid": "4e5695f2-223a-4ce8-ab12-308ca5017f15",
            "id": "G03.01",
            "link": "https://learn.microsoft.com/azure/active-directory/reports-monitoring/overview-reports",
            "service": "Entra",
            "severity": "Medio",
            "subcategory": "Operaciones",
            "text": "Use las funcionalidades de informes de Microsoft Entra ID para generar informes de auditoría de control de acceso.",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad",
            "guid": "4e3ab369-3829-4e7e-9161-83687a0477a2",
            "id": "G03.02",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/logs-data-export?tabs=portal",
            "severity": "Medio",
            "subcategory": "Operaciones",
            "text": "Exporte los registros de actividad de Azure a los registros de Azure Monitor para la retención de datos a largo plazo. Exporte a Azure Storage para un almacenamiento a largo plazo superior a dos años, si es necesario.",
            "waf": "Seguridad"
        },
        {
            "ammp": true,
            "category": "Seguridad",
            "guid": "09945bda-4333-44f2-9911-634182ba5275",
            "id": "G03.03",
            "link": "https://learn.microsoft.com/azure/defender-for-cloud/concept-cloud-security-posture-management",
            "service": "Defender",
            "severity": "Alto",
            "subcategory": "Operaciones",
            "text": "Habilite la administración de la posición de seguridad en la nube de Defender para todas las suscripciones.",
            "waf": "Seguridad"
        },
        {
            "ammp": true,
            "category": "Seguridad",
            "guid": "36a72a48-fffe-4c40-9747-0ab5064355ba",
            "id": "G03.04",
            "link": "https://learn.microsoft.com/azure/defender-for-cloud/plan-defender-for-servers-select-plan",
            "service": "Defender",
            "severity": "Alto",
            "subcategory": "Operaciones",
            "text": "Habilite un plan de protección de cargas de trabajo en la nube de Defender para servidores en todas las suscripciones.",
            "waf": "Seguridad"
        },
        {
            "ammp": true,
            "category": "Seguridad",
            "guid": "77425f48-ecba-43a0-aeac-a3ac733ccc6a",
            "id": "G03.05",
            "link": "https://www.microsoft.com/en-gb/security/business/solutions/cloud-workload-protection",
            "service": "Defender",
            "severity": "Alto",
            "subcategory": "Operaciones",
            "text": "Habilite los planes de protección de cargas de trabajo en la nube de Defender para recursos de Azure en todas las suscripciones.",
            "waf": "Seguridad"
        },
        {
            "ammp": true,
            "category": "Seguridad",
            "guid": "24d96b30-61ee-4436-a1cc-d6ef08bc574b",
            "id": "G03.06",
            "link": "https://learn.microsoft.com/mem/configmgr/protect/deploy-use/endpoint-protection",
            "service": "VM",
            "severity": "Alto",
            "subcategory": "Operaciones",
            "text": "Habilite Endpoint Protection en servidores IaaS.",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad",
            "guid": "15833ee7-ad6c-46d3-9331-65c7acbe44ab",
            "id": "G03.07",
            "link": "https://learn.microsoft.com/azure/security-center/",
            "service": "VM",
            "severity": "Medio",
            "subcategory": "Operaciones",
            "text": "Supervise el desfase de revisiones del sistema operativo base a través de los registros de Azure Monitor y Defender for Cloud.",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad",
            "guid": "e5f8d79f-2e87-4768-924c-516775c6ea95",
            "id": "G03.08",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/design-logs-deployment",
            "service": "Monitor",
            "severity": "Medio",
            "subcategory": "Operaciones",
            "text": "Conecte las configuraciones de recursos predeterminadas a un área de trabajo centralizada de Log Analytics de Azure Monitor.",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad",
            "guid": "1761e147-f65e-4d09-bbc2-f464f23e2eba",
            "id": "G03.09",
            "link": "https://learn.microsoft.com/en-us/industry/sovereignty/transparency-logs",
            "service": "Entra",
            "severity": "Medio",
            "subcategory": "Operaciones",
            "text": "En el caso de la zona de aterrizaje soberana, los registros de transparencia están habilitados en el inquilino de Entra ID.",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad",
            "guid": "d21a922d-5ca7-427a-82a6-35f7b21f1bfc",
            "id": "G03.10",
            "link": "https://learn.microsoft.com/en-us/azure/security/fundamentals/customer-lockbox-overview",
            "service": "Entra",
            "severity": "Medio",
            "subcategory": "Operaciones",
            "text": "En el caso de la zona de aterrizaje soberana, la caja de seguridad del cliente está habilitada en el inquilino de Entra ID.",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad",
            "guid": "874a748b-662d-46d1-9051-2a66498f6dfe",
            "id": "G03.11",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/security",
            "severity": "Bajo",
            "subcategory": "Operaciones",
            "text": "Uso de una solución basada en Azure Event Grid para alertas en tiempo real orientadas a registros",
            "waf": "Seguridad"
        },
        {
            "ammp": true,
            "category": "Seguridad",
            "guid": "b03ed428-4617-4067-a787-85468b9ccf3f",
            "id": "G04.01",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-require-secure-transfer",
            "service": "Storage",
            "severity": "Alto",
            "subcategory": "Visión general",
            "text": "La transferencia segura a cuentas de almacenamiento debe estar habilitada",
            "waf": "Seguridad"
        },
        {
            "ammp": true,
            "category": "Seguridad",
            "guid": "159aac9f-863f-4f48-82cf-00c28fa97a0e",
            "id": "G04.02",
            "link": "https://learn.microsoft.com/azure/storage/blobs/data-protection-overview#recommendations-for-basic-data-protection",
            "service": "Storage",
            "severity": "Alto",
            "subcategory": "Visión general",
            "text": "Habilite la eliminación temporal del contenedor para que la cuenta de almacenamiento recupere un contenedor eliminado y su contenido.",
            "waf": "Seguridad"
        },
        {
            "ammp": true,
            "category": "Seguridad",
            "guid": "6f704104-85c1-441f-96d3-c9819911645e",
            "id": "G05.01",
            "link": "https://learn.microsoft.com/azure/active-directory/roles/security-planning",
            "severity": "Alto",
            "subcategory": "Acceso privilegiado seguro",
            "text": "Separe las cuentas de administrador con privilegios para las tareas administrativas de Azure.",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad",
            "guid": "9a19bf39-c95d-444c-9c89-19ca1f6d5215",
            "id": "G06.01",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/service-enablement-framework",
            "severity": "Medio",
            "subcategory": "Marco de habilitación de servicios",
            "text": "Planeación de cómo se implementarán los nuevos servicios de Azure",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad",
            "guid": "ae514b93-3d45-485e-8112-9bd7ba012f7b",
            "id": "G06.02",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/service-enablement-framework",
            "severity": "Medio",
            "subcategory": "Marco de habilitación de servicios",
            "text": "Planeación de cómo se cumplirá la solicitud de servicio para los servicios de Azure",
            "waf": "Seguridad"
        },
        {
            "ammp": true,
            "category": "Automatización de plataformas y DevOps",
            "guid": "e85f4226-bf06-4e35-8a8b-7aee4d2d633a",
            "id": "H01.01",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/platform-automation-devops",
            "severity": "Alto",
            "subcategory": "Topologías de equipo de DevOps",
            "text": "Asegúrese de que cuenta con un equipo multifuncional de la plataforma DevOps para crear, administrar y mantener la arquitectura de la zona de aterrizaje de Azure.",
            "waf": "Operaciones"
        },
        {
            "category": "Automatización de plataformas y DevOps",
            "guid": "634146bf-7085-4419-a7b5-f96d2726f6da",
            "id": "H01.02",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/devops-teams-topologies#design-recommendations",
            "severity": "Bajo",
            "subcategory": "Topologías de equipo de DevOps",
            "text": "Trate de definir funciones para el equipo de la plataforma de zona de aterrizaje de Azure.",
            "waf": "Operaciones"
        },
        {
            "category": "Automatización de plataformas y DevOps",
            "guid": "a9e65070-c59e-4112-8bf6-c11364d4a2a5",
            "id": "H01.03",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/devops-teams-topologies#design-recommendations",
            "severity": "Bajo",
            "subcategory": "Topologías de equipo de DevOps",
            "text": "Trate de definir funciones para que los equipos de carga de trabajo de las aplicaciones sean autosuficientes y no requieran el soporte del equipo de la plataforma DevOps. Logre esto mediante el uso del rol RBAC personalizado.",
            "waf": "Operaciones"
        },
        {
            "ammp": true,
            "category": "Automatización de plataformas y DevOps",
            "guid": "165eb5e9-b434-448a-9e24-178632186212",
            "id": "H01.04",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/infrastructure-as-code",
            "severity": "Alto",
            "subcategory": "Topologías de equipo de DevOps",
            "text": "Use una canalización de CI/CD para implementar artefactos de IaC y garantizar la calidad de la implementación y los entornos de Azure.",
            "waf": "Operaciones"
        },
        {
            "category": "Automatización de plataformas y DevOps",
            "guid": "0cadb8c7-8fa5-4fbf-8f39-d1fadb3b0460",
            "id": "H01.05",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/development-strategy-development-lifecycle#automated-builds",
            "severity": "Medio",
            "subcategory": "Topologías de equipo de DevOps",
            "text": "Incluya pruebas unitarias para IaC y código de aplicación como parte del proceso de compilación.",
            "waf": "Operaciones"
        },
        {
            "ammp": true,
            "category": "Automatización de plataformas y DevOps",
            "guid": "108d5099-a11d-4445-bd8b-e12a5e95412e",
            "id": "H01.06",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/development-strategy-development-lifecycle#automated-builds",
            "service": "Key Vault",
            "severity": "Alto",
            "subcategory": "Topologías de equipo de DevOps",
            "text": "Use secretos de Key Vault para evitar codificar de forma rígida información confidencial, como credenciales (máquinas virtuales, contraseñas de usuario), certificados o claves.",
            "waf": "Operaciones"
        },
        {
            "category": "Automatización de plataformas y DevOps",
            "guid": "a52e0c98-76b9-4a09-a1c9-6b2babf22ac4",
            "id": "H01.07",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/subscription-vending",
            "severity": "Bajo",
            "subcategory": "Topologías de equipo de DevOps",
            "text": "Implemente la automatización de la nueva zona de aterrizaje para aplicaciones y cargas de trabajo a través de la venta de suscripciones",
            "waf": "Operaciones"
        },
        {
            "ammp": true,
            "category": "Automatización de plataformas y DevOps",
            "guid": "cfe363b5-f579-4284-bc56-a42153e4c10b",
            "id": "H02.01",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/infrastructure-as-code",
            "severity": "Alto",
            "subcategory": "Ciclo de vida de desarrollo",
            "text": "Asegúrese de que se utiliza un sistema de control de versiones para el código fuente de las aplicaciones y la IaC desarrollada. Microsoft recomienda Git.",
            "waf": "Operaciones"
        },
        {
            "category": "Automatización de plataformas y DevOps",
            "guid": "c7245dd4-af8a-403a-8bb7-890c1a7cfa9d",
            "id": "H02.02",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/development-strategy-development-lifecycle",
            "severity": "Bajo",
            "subcategory": "Ciclo de vida de desarrollo",
            "text": "Siga una estrategia de ramificación para permitir que los equipos colaboren mejor y administren de manera eficiente el control de versiones de IaC y el código de la aplicación. Revisa opciones como Github Flow.",
            "waf": "Operaciones"
        },
        {
            "category": "Automatización de plataformas y DevOps",
            "guid": "12aeea20-9165-4b3e-bdf2-6795fcd3cdbe",
            "id": "H02.03",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/development-strategy-development-lifecycle",
            "severity": "Medio",
            "subcategory": "Ciclo de vida de desarrollo",
            "text": "Adopte una estrategia de solicitud de incorporación de cambios para ayudar a mantener el control de los cambios de código fusionados en ramas.",
            "waf": "Operaciones"
        },
        {
            "category": "Automatización de plataformas y DevOps",
            "guid": "2676ae46-65ca-444e-8695-fdddeace4cb1",
            "id": "H02.04",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/management-platform",
            "severity": "Medio",
            "subcategory": "Ciclo de vida de desarrollo",
            "text": "Establezca un proceso para usar código para implementar correcciones rápidas. Registre siempre las correcciones rápidas en el trabajo pendiente de su equipo para que cada corrección se pueda volver a trabajar en un momento posterior y pueda limitar la deuda técnica.",
            "waf": "Operaciones"
        },
        {
            "ammp": true,
            "category": "Automatización de plataformas y DevOps",
            "guid": "2cdc9d99-dbcc-4ad4-97f5-e7d358bdfa73",
            "id": "H03.01",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/infrastructure-as-code",
            "severity": "Alto",
            "subcategory": "Estrategia de desarrollo",
            "text": "Aproveche las herramientas de infraestructura declarativa como código, como Azure Bicep, las plantillas de ARM o Terraform, para crear y mantener la arquitectura de la zona de aterrizaje de Azure. Tanto desde el punto de vista de la carga de trabajo de la plataforma como de la aplicación.",
            "waf": "Operaciones"
        },
        {
            "ammp": true,
            "category": "Automatización de plataformas y DevOps",
            "guid": "cc87a3bc-c572-4ad2-92ed-8cabab66160f",
            "id": "H04.01",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/landing-zone-security#secure",
            "severity": "Alto",
            "subcategory": "Seguridad",
            "text": "Integrar la seguridad en el proceso ya combinado de desarrollo y operaciones en DevOps para mitigar los riesgos en el proceso de innovación.",
            "waf": "Operaciones"
        }
    ],
    "metadata": {
        "name": "Azure Landing Zone Review",
        "state": "GA",
        "timestamp": "March 05, 2024",
        "waf": "all"
    },
    "severities": [
        {
            "name": "Alto"
        },
        {
            "name": "Medio"
        },
        {
            "name": "Bajo"
        }
    ],
    "status": [
        {
            "description": "Esta comprobación aún no se ha examinado",
            "name": "No verificado"
        },
        {
            "description": "Hay un elemento de acción asociado a esta comprobación",
            "name": "Abrir"
        },
        {
            "description": "Esta comprobación se ha verificado y no hay más elementos de acción asociados a ella",
            "name": "Cumplido"
        },
        {
            "description": "Recomendación entendida, pero no necesaria por los requisitos actuales",
            "name": "No es necesario"
        },
        {
            "description": "No aplicable para el diseño actual",
            "name": "N/A"
        }
    ],
    "waf": [
        {
            "name": "Fiabilidad"
        },
        {
            "name": "Seguridad"
        },
        {
            "name": "Costar"
        },
        {
            "name": "Operaciones"
        },
        {
            "name": "Rendimiento"
        }
    ],
    "yesno": [
        {
            "name": "Sí"
        },
        {
            "name": "No"
        }
    ]
}
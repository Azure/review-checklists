{
    "categories": [
        {
            "name": "Azure 課金と Microsoft Entra ID テナント"
        },
        {
            "name": "IDおよびアクセス管理"
        },
        {
            "name": "ネットワークトポロジと接続性"
        },
        {
            "name": "安全"
        },
        {
            "name": "管理"
        },
        {
            "name": "リソース編成"
        },
        {
            "name": "プラットフォームの自動化とDevOps"
        },
        {
            "name": "統治"
        }
    ],
    "items": [
        {
            "category": "Azure 課金と Microsoft Entra ID テナント",
            "guid": "70c15989-c726-42c7-b0d3-24b7375b9201",
            "id": "A01.01",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/multi-tenant/considerations-recommendations",
            "service": "Entra",
            "severity": "中程度",
            "subcategory": "Microsoft Entra ID テナント",
            "text": "マルチテナントに関する明確な規制要件またはビジネス要件がない限り、Azure リソースの管理には 1 つの Entra テナントを使用します。",
            "waf": "オペレーションズ"
        },
        {
            "category": "Azure 課金と Microsoft Entra ID テナント",
            "guid": "6309957b-821a-43d1-b9d9-7fcf1802b747",
            "id": "A01.02",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/multi-tenant/automation",
            "service": "Entra",
            "severity": "低い",
            "subcategory": "Microsoft Entra ID テナント",
            "text": "Microsoft Entra ID テナントを管理するためのマルチテナント自動化アプローチがあることを確認する",
            "waf": "オペレーションズ"
        },
        {
            "category": "Azure 課金と Microsoft Entra ID テナント",
            "guid": "78e11934-499a-45ed-8ef7-aae5578f0ecf",
            "id": "A01.03",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/multi-tenant/lighthouse",
            "service": "Entra",
            "severity": "低い",
            "subcategory": "Microsoft Entra ID テナント",
            "text": "マルチテナント管理に Azure Lighthouse を活用する",
            "waf": "オペレーションズ"
        },
        {
            "category": "Azure 課金と Microsoft Entra ID テナント",
            "guid": "5d82e6df-6f61-42f2-82e2-3132d293be3d",
            "id": "A02.01",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-microsoft-customer-agreement#design-recommendations",
            "service": "Entra",
            "severity": "中程度",
            "subcategory": "クラウドソリューションプロバイダー",
            "text": "パートナーによるテナントの管理に Azure Lighthouse が使用されていることを確認する",
            "waf": "費用"
        },
        {
            "category": "Azure 課金と Microsoft Entra ID テナント",
            "guid": "a24d0de3-d4b9-4dfb-8ddd-bbfaf123fa01",
            "id": "A02.02",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-microsoft-customer-agreement#design-recommendations",
            "severity": "低い",
            "subcategory": "クラウドソリューションプロバイダー",
            "text": "サポート要求とエスカレーション プロセスについてCSP パートナーと話し合う",
            "waf": "費用"
        },
        {
            "category": "Azure 課金と Microsoft Entra ID テナント",
            "guid": "32952499-58c8-4e6f-ada5-972e67893d55",
            "id": "A02.03",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-microsoft-customer-agreement#design-recommendations",
            "severity": "中程度",
            "subcategory": "クラウドソリューションプロバイダー",
            "text": "Azure Cost Management を使用したコスト レポートとビューの設定Setup Cost Reporting and Views with Azure Cost Management",
            "waf": "費用"
        },
        {
            "category": "Azure 課金と Microsoft Entra ID テナント",
            "guid": "685cb4f2-ac9c-4b19-9167-993ed0b32415",
            "id": "A03.01",
            "link": "https://learn.microsoft.com/azure/cost-management-billing/manage/direct-ea-administration#manage-notification-contacts",
            "severity": "中程度",
            "subcategory": "エンタープライズ契約",
            "text": "グループ メールボックスへの通知連絡先の構成",
            "waf": "費用"
        },
        {
            "category": "Azure 課金と Microsoft Entra ID テナント",
            "guid": "12cd499f-96e2-4e41-a243-231fb3245a1c",
            "id": "A03.02",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-enterprise-agreement#design-considerations",
            "severity": "低い",
            "subcategory": "エンタープライズ契約",
            "text": "部門とアカウントを使用して、組織の構造を登録階層にマップし、請求の分離に役立てることができます。",
            "waf": "費用"
        },
        {
            "ammp": true,
            "category": "Azure 課金と Microsoft Entra ID テナント",
            "guid": "29213165-f066-46c4-81fc-4214cc19f3d0",
            "id": "A03.03",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-enterprise-agreement#design-considerations",
            "severity": "高い",
            "subcategory": "エンタープライズ契約",
            "text": "アカウントの種類が \"職場または学校アカウント\" であることを確認します",
            "waf": "安全"
        },
        {
            "category": "Azure 課金と Microsoft Entra ID テナント",
            "guid": "ca0fe401-12ad-46fc-8a7e-86293866a9f6",
            "id": "A03.04",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-enterprise-agreement#design-considerations",
            "severity": "中程度",
            "subcategory": "エンタープライズ契約",
            "text": "EA 加入契約で DA View Charges と AO View Charges の両方を有効にして、正しい権限を持つユーザーがコストと課金データを確認できるようにします。",
            "waf": "安全"
        },
        {
            "category": "Azure 課金と Microsoft Entra ID テナント",
            "guid": "5cf9f485-2784-49b3-9824-75d9b8bdb57b",
            "id": "A03.05",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-enterprise-agreement#design-considerations",
            "severity": "低い",
            "subcategory": "エンタープライズ契約",
            "text": "Enterprise Dev/Test サブスクリプションを利用して、非運用ワークロードのコストを削減する",
            "waf": "費用"
        },
        {
            "category": "Azure 課金と Microsoft Entra ID テナント",
            "guid": "2cf08656-13ea-4f7e-a53a-e2c956b1ff6c",
            "id": "A03.06",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-enterprise-agreement#design-considerations",
            "severity": "中程度",
            "subcategory": "エンタープライズ契約",
            "text": "ロールの割り当てを定期的に監査して、Enterprise Agreement 加入契約へのアクセス権を持つユーザーを確認します",
            "waf": "費用"
        },
        {
            "category": "Azure 課金と Microsoft Entra ID テナント",
            "guid": "6ad5c3dd-e5ea-4ff1-81a4-7886ff87845c",
            "id": "A04.01",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-microsoft-customer-agreement#design-recommendations",
            "severity": "低い",
            "subcategory": "Microsoft 顧客契約",
            "text": "契約の請求先アカウント通知の連絡先メールを構成する",
            "waf": "費用"
        },
        {
            "category": "Azure 課金と Microsoft Entra ID テナント",
            "guid": "90e87802-602f-4dfb-acea-67c60689f1d7",
            "id": "A04.02",
            "link": "https://learn.microsoft.com/azure/cost-management-billing/manage/mca-section-invoice",
            "severity": "低い",
            "subcategory": "Microsoft 顧客契約",
            "text": "[課金プロファイル] セクションと [請求書] セクションを使用して、効果的なコスト管理のための契約の請求を構造化します",
            "waf": "費用"
        },
        {
            "category": "Azure 課金と Microsoft Entra ID テナント",
            "guid": "e81a73f0-84c4-4641-b406-14db3b4d1f50",
            "id": "A04.03",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-microsoft-customer-agreement#design-recommendations",
            "severity": "低い",
            "subcategory": "Microsoft 顧客契約",
            "text": "Azure プランを利用して、非運用ワークロードのコストを削減する",
            "waf": "費用"
        },
        {
            "category": "Azure 課金と Microsoft Entra ID テナント",
            "guid": "ae757485-92a4-482a-8bc9-eefe6f5b5ec3",
            "id": "A04.04",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-microsoft-customer-agreement#design-recommendations",
            "severity": "中程度",
            "subcategory": "Microsoft 顧客契約",
            "text": "契約課金 RBAC ロールの割り当てを定期的に監査して、MCA 課金アカウントにアクセスできるユーザーを確認します",
            "waf": "費用"
        },
        {
            "ammp": true,
            "category": "IDおよびアクセス管理",
            "guid": "4348bf81-7573-4512-8f46-9061cc198fea",
            "id": "B01.01",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/identity-access-landing-zones#identity-and-access-management-in-the-azure-landing-zone-accelerator",
            "severity": "高い",
            "subcategory": "Microsoft Entra ID とハイブリッド ID",
            "text": "Azure サービスに対する認証にサービス プリンシパルの代わりにマネージド ID を使用するUse managed identity instead of service principals for authentication to Azure services",
            "training": "https://learn.microsoft.com/azure/active-directory/managed-identities-azure-resources/overview",
            "waf": "安全"
        },
        {
            "category": "IDおよびアクセス管理",
            "guid": "cd163e39-84a5-4b39-97b7-6973abd70d94",
            "id": "B02.01",
            "link": "https://learn.microsoft.com/azure/active-directory/hybrid/how-to-connect-sync-staging-server",
            "severity": "中程度",
            "subcategory": "Microsoft Entra ID",
            "text": "Microsoft Entra Connectを展開する場合は、高可用性/ディザスタリカバリのためにステージングサーバーを活用します",
            "waf": "確実"
        },
        {
            "ammp": true,
            "category": "IDおよびアクセス管理",
            "guid": "984a859c-773e-47d2-9162-3a765a917e1f",
            "id": "B03.01",
            "link": "https://learn.microsoft.com/azure/active-directory/roles/security-emergency-access",
            "service": "Entra",
            "severity": "高い",
            "subcategory": "同一性",
            "text": "テナント全体のアカウント ロックアウトを防ぐために、緊急アクセスまたは非常用アカウントを実装する",
            "training": "https://learn.microsoft.com/learn/modules/azure-ad-privileged-identity-management/",
            "waf": "安全"
        },
        {
            "category": "IDおよびアクセス管理",
            "guid": "1cf0b8da-70bd-44d0-94af-8d99cfc89ae1",
            "id": "B03.02",
            "link": "https://learn.microsoft.com/azure/active-directory/reports-monitoring/concept-activity-logs-azure-monitor",
            "service": "Entra",
            "severity": "中程度",
            "subcategory": "同一性",
            "text": "Microsoft Entra ID ログをプラットフォーム中心の Azure Monitor と統合します。Azure Monitor を使用すると、Azure のログと監視データに関する信頼できる唯一の情報源が得られ、ログの収集と保持に関する要件を満たすクラウド ネイティブ オプションが組織に提供されます。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "category": "IDおよびアクセス管理",
            "guid": "348ef254-c27d-442e-abba-c7571559ab91",
            "id": "B03.03",
            "link": "https://learn.microsoft.com/azure/role-based-access-control/overview",
            "service": "Entra",
            "severity": "高い",
            "subcategory": "同一性",
            "text": "クラウド運用モデルに合わせた RBAC モデルを適用します。管理グループとサブスクリプション全体のスコープと割り当てを行います。",
            "training": "https://learn.microsoft.com/learn/paths/implement-resource-mgmt-security/",
            "waf": "安全"
        },
        {
            "category": "IDおよびアクセス管理",
            "guid": "53e8908a-e28c-484c-93b6-b7808b9fe5c4",
            "id": "B03.04",
            "link": "https://learn.microsoft.com/azure/active-directory/conditional-access/overview",
            "service": "Entra",
            "severity": "低い",
            "subcategory": "同一性",
            "text": "Azure 環境に対する権限を持つすべてのユーザーに Microsoft Entra ID 条件付きアクセス ポリシーを適用する",
            "training": "https://learn.microsoft.com/learn/modules/plan-implement-administer-conditional-access/",
            "waf": "安全"
        },
        {
            "ammp": true,
            "category": "IDおよびアクセス管理",
            "guid": "1049d403-a923-4c34-94d0-0018ac6a9e01",
            "id": "B03.05",
            "link": "https://learn.microsoft.com/azure/active-directory/authentication/concept-mfa-howitworks",
            "service": "Entra",
            "severity": "高い",
            "subcategory": "同一性",
            "text": "Azure 環境に対する権限を持つすべてのユーザーに多要素認証を適用する",
            "training": "https://learn.microsoft.com/learn/modules/secure-aad-users-with-mfa/",
            "waf": "安全"
        },
        {
            "category": "IDおよびアクセス管理",
            "guid": "e6a83de5-de32-4c19-a248-1607d5d1e4e6",
            "id": "B03.06",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/manage/centralize-operations",
            "severity": "中程度",
            "subcategory": "同一性",
            "text": "役割とセキュリティの要件に基づいて、ランディング ゾーン内にデプロイされたリソースを管理するために、一元化された委任された責任を適用します",
            "training": "https://learn.microsoft.com/learn/paths/azure-administrator-manage-identities-governance/",
            "waf": "安全"
        },
        {
            "category": "IDおよびアクセス管理",
            "guid": "14658d35-58fd-4772-99b8-21112df27ee4",
            "id": "B03.07",
            "link": "https://learn.microsoft.com/azure/active-directory/privileged-identity-management/pim-configure",
            "service": "Entra",
            "severity": "中程度",
            "subcategory": "同一性",
            "text": "Microsoft Entra ID Privileged Identity Management (PIM) を適用して、ゼロの永続的なアクセスと最小限の特権を確立します",
            "training": "https://learn.microsoft.com/learn/modules/azure-ad-privileged-identity-management/",
            "waf": "安全"
        },
        {
            "ammp": true,
            "category": "IDおよびアクセス管理",
            "guid": "12e7f983-f630-4472-8dd6-9c5b5c2622f5",
            "id": "B03.08",
            "link": "https://learn.microsoft.com/azure/active-directory/roles/security-planning#identify-microsoft-accounts-in-administrative-roles-that-need-to-be-switched-to-work-or-school-accounts",
            "service": "Entra",
            "severity": "高い",
            "subcategory": "同一性",
            "text": "すべてのアカウントの種類で、認証の種類である職場または学校アカウントのみを使用します。Microsoft アカウントの使用は避けてください",
            "training": "https://learn.microsoft.com/learn/modules/explore-basic-services-identity-types/",
            "waf": "安全"
        },
        {
            "category": "IDおよびアクセス管理",
            "guid": "4b69bad3-3aad-45e8-a68e-1d76667313b4",
            "id": "B03.09",
            "link": "https://learn.microsoft.com/azure/active-directory/fundamentals/active-directory-groups-create-azure-portal",
            "service": "Entra",
            "severity": "中程度",
            "subcategory": "同一性",
            "text": "アクセス許可の割り当てには、グループのみを使用します。グループ管理システムが既に導入されている場合は、オンプレミス グループを Azure-AD 専用グループに追加します。",
            "training": "https://learn.microsoft.com/learn/paths/manage-identity-and-access/",
            "waf": "安全"
        },
        {
            "category": "IDおよびアクセス管理",
            "guid": "f5664b5e-984a-4859-a773-e7d261623a76",
            "id": "B03.10",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/identity-access#prerequisites-for-a-landing-zone---design-recommendations",
            "severity": "中程度",
            "subcategory": "同一性",
            "text": "Azure カスタム RBAC ロールを Azure カスタム RBAC ロールとして使用して、ALZ 全体にわたるきめ細かなアクセスを提供します: Azure プラットフォーム所有者、ネットワーク管理、セキュリティ運用、サブスクリプション所有者、アプリケーション所有者。これらの役割をビジネス内のチームと責任に合わせます。",
            "training": "https://learn.microsoft.com/learn/modules/create-custom-azure-roles-with-rbac/",
            "waf": "安全"
        },
        {
            "category": "IDおよびアクセス管理",
            "guid": "1559ab91-53e8-4908-ae28-c84c33b6b780",
            "id": "B03.11",
            "link": "https://learn.microsoft.com/azure/architecture/reference-architectures/identity/adds-extend-domain#vm-recommendations",
            "severity": "中程度",
            "subcategory": "同一性",
            "text": "Active Directory を Windows Server にデプロイする場合は、可用性ゾーンのある場所を使用し、これらのゾーンに少なくとも 2 つの VM をデプロイします。使用できない場合は、可用性セットにデプロイします",
            "training": "https://learn.microsoft.com/learn/modules/azure-active-directory/",
            "waf": "確実"
        },
        {
            "category": "IDおよびアクセス管理",
            "guid": "8b9fe5c4-1049-4d40-9a92-3c3474d00018",
            "id": "B03.12",
            "link": "https://learn.microsoft.com/azure/active-directory-domain-services/overview",
            "service": "Entra",
            "severity": "中程度",
            "subcategory": "同一性",
            "text": "Entra Domain Servicesを使用している場合は、すべてのワークロードの互換性を評価します",
            "training": "https://learn.microsoft.com/learn/modules/implement-hybrid-identity-windows-server/",
            "waf": "安全"
        },
        {
            "category": "IDおよびアクセス管理",
            "guid": "ac6a9e01-e6a8-43de-9de3-2c1992481607",
            "id": "B03.13",
            "link": "https://learn.microsoft.com/azure/architecture/reference-architectures/identity/adds-extend-domain",
            "severity": "中程度",
            "subcategory": "同一性",
            "text": "ドメイン コントローラーが使用されている場合は、リソースが正しいドメイン コントローラーを使用するように設定されていることを確認します。",
            "training": "https://learn.microsoft.com/learn/paths/implement-windows-server-iaas-virtual-machine-identity/",
            "waf": "安全"
        },
        {
            "category": "IDおよびアクセス管理",
            "guid": "d5d1e4e6-1465-48d3-958f-d77249b82111",
            "id": "B03.14",
            "link": "https://learn.microsoft.com/azure/active-directory/app-proxy/application-proxy",
            "service": "Entra",
            "severity": "中程度",
            "subcategory": "同一性",
            "text": "必要に応じて、Microsoft Entra ID アプリケーション プロキシを使用して、内部アプリケーション (クラウドまたはオンプレミスでホストされている) への安全で認証されたアクセスをリモート ユーザーに付与します。",
            "training": "https://learn.microsoft.com/learn/paths/implement-applications-external-access-azure-ad/",
            "waf": "安全"
        },
        {
            "category": "IDおよびアクセス管理",
            "guid": "35037e68-9349-4c15-b371-228514f4cdff",
            "id": "B03.15",
            "link": "https://learn.microsoft.com/azure/active-directory/roles/best-practices",
            "service": "Entra",
            "severity": "中程度",
            "subcategory": "同一性",
            "text": "Microsoft Entra ID ロールの割り当てにオンプレミスの同期アカウントを使用しないでください。",
            "training": "https://learn.microsoft.com/learn/modules/design-identity-security-strategy/",
            "waf": "安全"
        },
        {
            "category": "IDおよびアクセス管理",
            "guid": "9cf5418b-1520-4b7b-add7-88eb28f833e8",
            "id": "B04.01",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/identity-access-landing-zones#managed-identities",
            "severity": "中程度",
            "subcategory": "ランディング ゾーン",
            "text": "仮想ネットワークを使用してアイデンティティ ネットワークのセグメント化を構成し、ハブにピア バックします。アプリケーション ランディング ゾーン (レガシ) 内での認証の提供。",
            "training": "https://learn.microsoft.com/azure/architecture/example-scenario/identity/adds-extend-domain",
            "waf": "安全"
        },
        {
            "category": "IDおよびアクセス管理",
            "guid": "d4d1ad54-1abc-4919-b267-3f342d3b49e4",
            "id": "B04.02",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/identity-access-landing-zones#rbac-recommendations",
            "severity": "中程度",
            "subcategory": "ランディング ゾーン",
            "text": "可能であれば、Azure RBAC を使用して、リソースへのデータ プレーン アクセスを管理します。例: Key Vault、ストレージ アカウント、データベース サービス全体のデータ操作。",
            "training": "https://learn.microsoft.com/azure/role-based-access-control/overview",
            "waf": "安全"
        },
        {
            "category": "IDおよびアクセス管理",
            "guid": "d505ebcb-79b1-4274-9c0d-a27c8bea489c",
            "id": "B04.03",
            "link": "https://learn.microsoft.com/azure/active-directory/privileged-identity-management/pim-create-roles-and-resource-roles-review",
            "severity": "中程度",
            "subcategory": "ランディング ゾーン",
            "text": "Microsoft Entra ID PIM アクセス レビューを使用して、リソースの権利を定期的に検証します。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "category": "リソース編成",
            "guid": "cacf55bc-e4e4-46be-96bc-57a5f23a269a",
            "id": "C01.01",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/resource-naming",
            "severity": "高い",
            "subcategory": "名前付けとタグ付け",
            "text": "Microsoft のベスト プラクティスの名前付け標準に従うことをお勧めします",
            "waf": "安全"
        },
        {
            "category": "リソース編成",
            "graph": "resourcecontainers| where type == 'microsoft.resources/subscriptions'| extend ManagementGroup = tostring(tags),mgmtChain = properties.managementGroupAncestorsChain| extend compliant =( array_length(mgmtChain) <= 4 and array_length(mgmtChain) > 1)",
            "guid": "2df27ee4-12e7-4f98-9f63-04722dd69c5b",
            "id": "C02.01",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/resource-org-management-groups",
            "severity": "中程度",
            "subcategory": "サブスクリプション",
            "text": "4 レベル以下の合理的にフラットな管理グループ階層を適用します。",
            "training": "https://learn.microsoft.com/learn/modules/azure-architecture-fundamentals/",
            "waf": "安全"
        },
        {
            "category": "リソース編成",
            "guid": "667313b4-f566-44b5-b984-a859c773e7d2",
            "id": "C02.02",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/resource-org-management-groups#management-group-recommendations",
            "severity": "中程度",
            "subcategory": "サブスクリプション",
            "text": "サンドボックス管理グループを適用して、ユーザーがすぐに Azure を試せるようにする",
            "training": "https://learn.microsoft.com/learn/paths/enterprise-scale-architecture/",
            "waf": "安全"
        },
        {
            "category": "リソース編成",
            "guid": "61623a76-5a91-47e1-b348-ef254c27d42e",
            "id": "C02.03",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/resource-org-management-groups#management-group-recommendations",
            "severity": "中程度",
            "subcategory": "サブスクリプション",
            "text": "ルート管理グループの下にプラットフォーム管理グループを適用して、共通のプラットフォーム ポリシーと Azure ロールの割り当てをサポートする",
            "training": "https://learn.microsoft.com/learn/paths/enterprise-scale-architecture/",
            "waf": "安全"
        },
        {
            "category": "リソース編成",
            "guid": "8bbac757-1559-4ab9-853e-8908ae28c84c",
            "id": "C02.04",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/resource-org-management-groups#management-group-recommendations",
            "severity": "中程度",
            "subcategory": "サブスクリプション",
            "text": "接続管理グループで専用の接続サブスクリプションを適用して、Azure Virtual WAN ハブ、プライベート ドメイン ネーム システム (DNS)、ExpressRoute 回線、その他のネットワーク リソースをホストします。",
            "training": "https://learn.microsoft.com/learn/paths/enterprise-scale-architecture/",
            "waf": "安全"
        },
        {
            "category": "リソース編成",
            "graph": "resourcecontainers| where type == 'microsoft.resources/subscriptions'| extend ManagementGroup = tostring(tags),mgmtChain = properties.managementGroupAncestorsChain| extend compliant = (array_length(mgmtChain) > 1)",
            "guid": "33b6b780-8b9f-4e5c-9104-9d403a923c34",
            "id": "C02.05",
            "link": "https://learn.microsoft.com/azure/governance/management-groups/how-to/protect-resource-hierarchy#setting---default-management-group",
            "severity": "中程度",
            "subcategory": "サブスクリプション",
            "text": "サブスクリプションがルート管理グループの下に配置されないように強制する",
            "waf": "安全"
        },
        {
            "category": "リソース編成",
            "guid": "74d00018-ac6a-49e0-8e6a-83de5de32c19",
            "id": "C02.06",
            "link": "https://learn.microsoft.com/azure/governance/management-groups/how-to/protect-resource-hierarchy#setting---require-authorization",
            "severity": "中程度",
            "subcategory": "サブスクリプション",
            "text": "管理グループ階層の設定で Azure RBAC 承認を有効にすることで、特権ユーザーのみがテナント内の管理グループを操作できるようにします",
            "waf": "安全"
        },
        {
            "category": "リソース編成",
            "guid": "92481607-d5d1-4e4e-9146-58d3558fd772",
            "id": "C02.07",
            "link": "https://learn.microsoft.com/azure/governance/management-groups/overview",
            "severity": "中程度",
            "subcategory": "サブスクリプション",
            "text": "ルートレベルの管理グループの下に管理グループを適用し、セキュリティ、コンプライアンス、接続性、機能のニーズに基づいてワークロードの種類を表します。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "category": "リソース編成",
            "guid": "49b82111-2df2-47ee-912e-7f983f630472",
            "id": "C02.08",
            "link": "https://learn.microsoft.com/azure/governance/management-groups/overview",
            "severity": "高い",
            "subcategory": "サブスクリプション",
            "text": "リソース所有者に自分の役割と責任を認識させるプロセスを適用し、レビュー、予算レビュー、ポリシーのコンプライアンスにアクセスし、必要に応じて修復します。",
            "waf": "安全"
        },
        {
            "category": "リソース編成",
            "guid": "2dd69c5b-5c26-422f-94b6-9bad33aad5e8",
            "id": "C02.09",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits",
            "severity": "中程度",
            "subcategory": "サブスクリプション",
            "text": "すべてのサブスクリプション所有者と IT コア チームが、サブスクリプションのクォータと、それらが特定のサブスクリプションのプロビジョニング リソースに与える影響を認識していることを確認します。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "category": "リソース編成",
            "guid": "c68e1d76-6673-413b-9f56-64b5e984a859",
            "id": "C02.10",
            "link": "https://learn.microsoft.com/azure/cost-management-billing/reservations/save-compute-costs-reservations",
            "severity": "高い",
            "subcategory": "サブスクリプション",
            "text": "必要に応じてリザーブドインスタンスを使用して、コストを最適化し、ターゲットリージョンで使用可能な容量を確保します。購入した予約インスタンス VM SKU の使用を Azure Policy で強制します。",
            "training": "https://learn.microsoft.com/learn/paths/improve-reliability-modern-operations/",
            "waf": "安全"
        },
        {
            "ammp": true,
            "category": "リソース編成",
            "guid": "c773e7d2-6162-43a7-95a9-17e1f348ef25",
            "id": "C02.11",
            "link": "https://learn.microsoft.com/azure/architecture/framework/scalability/design-capacity",
            "severity": "高い",
            "subcategory": "サブスクリプション",
            "text": "ダッシュボード、ブック、または手動プロセスを適用して、使用済み容量レベルを監視します",
            "training": "https://learn.microsoft.com/learn/paths/monitor-usage-performance-availability-resources-azure-monitor/",
            "waf": "安全"
        },
        {
            "ammp": true,
            "category": "リソース編成",
            "guid": "ae28c84c-33b6-4b78-88b9-fe5c41049d40",
            "id": "C02.12",
            "link": "https://learn.microsoft.com/azure/cost-management-billing/cost-management-billing-overview",
            "severity": "高い",
            "subcategory": "サブスクリプション",
            "text": "コスト管理のプロセスを適用する",
            "training": "https://learn.microsoft.com/learn/paths/control-spending-manage-bills/",
            "waf": "安全"
        },
        {
            "category": "リソース編成",
            "guid": "3a923c34-74d0-4001-aac6-a9e01e6a83de",
            "id": "C02.13",
            "link": "https://learn.microsoft.com/azure/governance/management-groups/overview",
            "severity": "中程度",
            "subcategory": "サブスクリプション",
            "text": "ドメイン コントローラーなどの ID サービスにサーバーを使用する場合は、ID 管理グループに専用の ID サブスクリプションを確立して、これらのサービスをホストします",
            "training": "https://learn.microsoft.com/learn/paths/enterprise-scale-architecture/",
            "waf": "安全"
        },
        {
            "category": "リソース編成",
            "graph": "resources | extend compliant = isnotnull(['tags']) | project name, id, subscriptionId, resourceGroup, tags, compliant",
            "guid": "5de32c19-9248-4160-9d5d-1e4e614658d3",
            "id": "C02.14",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/track-costs",
            "severity": "中程度",
            "subcategory": "サブスクリプション",
            "text": "タグが課金とコスト管理に使用されていることを確認する",
            "training": "https://learn.microsoft.com/learn/paths/implement-resource-mgmt-security/",
            "waf": "安全"
        },
        {
            "category": "リソース編成",
            "guid": "6cc0ea22-42bb-441e-a345-804ab0a09666",
            "id": "C02.15",
            "link": "https://github.com/Azure/sovereign-landing-zone/blob/main/docs/02-Architecture.md",
            "severity": "中程度",
            "subcategory": "サブスクリプション",
            "text": "ソブリン ランディング ゾーンの場合は、\"ランディング ゾーン\" MG の直下に \"機密企業\" と \"機密オンライン\" 管理グループを配置します。",
            "waf": "安全"
        },
        {
            "category": "リソース編成",
            "guid": "250d81ce-8bbe-4f85-9051-6a18a8221e50",
            "id": "C03.01",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-setup-guide/regions",
            "severity": "高い",
            "subcategory": "地域",
            "text": "デプロイに適した Azure リージョンを選択します。Azure は、多くのリージョンと地域を通じてグローバル カバレッジを提供するグローバル規模のクラウド プラットフォームです。Azure リージョンが異なれば、特性、アクセスと可用性のモデル、コスト、容量、提供されるサービスも異なるため、すべての条件と要件を考慮することが重要です",
            "training": "https://learn.microsoft.com/learn/modules/azure-architecture-fundamentals/",
            "waf": "確実"
        },
        {
            "category": "リソース編成",
            "guid": "19ca3f89-397d-44b1-b5b6-5e18661372ac",
            "id": "C03.02",
            "link": "https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/ready/azure-setup-guide/regions#operate-in-multiple-geographic-regions",
            "severity": "中程度",
            "subcategory": "地域",
            "text": "複数リージョンのデプロイを検討してください。顧客の規模、場所、ユーザーの存在によっては、複数のリージョンで運用することが、サービスを提供し、より近い場所でアプリケーションを実行するための一般的な選択肢となる場合があります。複数リージョンのデプロイを使用することは、geo ディザスター リカバリー機能を提供し、単一リージョンの容量からの依存関係を排除し、一時的および局所的なリソース容量の制約のリスクを軽減するためにも重要です",
            "training": "https://learn.microsoft.com/learn/modules/azure-architecture-fundamentals/",
            "waf": "確実"
        },
        {
            "category": "リソース編成",
            "guid": "4c27d42e-8bba-4c75-9155-9ab9153e8908",
            "id": "C03.03",
            "link": "https://azure.microsoft.com/explore/global-infrastructure/products-by-region/",
            "severity": "中程度",
            "subcategory": "地域",
            "text": "必要なサービスと機能が、選択したデプロイ リージョン内で利用可能であることを確認する",
            "training": "https://learn.microsoft.com/learn/modules/azure-architecture-fundamentals/",
            "waf": "確実"
        },
        {
            "category": "ネットワークトポロジと接続性",
            "guid": "373f482f-3e39-4d39-8aa4-7e566f6082b6",
            "id": "D01.01",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-app-delivery",
            "severity": "中程度",
            "subcategory": "アプリ配信",
            "text": "Application Gateway と Azure Front door を使用して、ワークロードのスポークから配信アプリケーション コンテンツをセキュリティで保護するための計画を作成します。 アプリケーション配信チェックリストを使用して、推奨事項を確認できます。",
            "waf": "オペレーションズ"
        },
        {
            "category": "ネットワークトポロジと接続性",
            "guid": "6138a720-0f1c-4e16-bd30-1d6e872e52e3",
            "id": "D01.02",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/resource-org-management-groups#management-groups-in-the-azure-landing-zone-accelerator",
            "severity": "中程度",
            "subcategory": "アプリ配信",
            "text": "内部向けアプリ (corp) と外部向けアプリ (online) の両方のランディング ゾーン内でアプリ配信を実行します。",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "安全"
        },
        {
            "category": "ネットワークトポロジと接続性",
            "guid": "143b16c3-1d7a-4a9b-9470-4489a8042d88",
            "id": "D01.03",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "service": "VNet",
            "severity": "中程度",
            "subcategory": "アプリ配信",
            "text": "アプリケーション ランディング ゾーン内のすべてのパブリック IP アドレスに対して DDoS ネットワークまたは IP 保護プランを使用します。",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "安全"
        },
        {
            "category": "ネットワークトポロジと接続性",
            "guid": "de0d5973-cd4c-4d21-a088-137f5e6c4cfd",
            "id": "D02.01",
            "link": "https://learn.microsoft.com/azure/virtual-network/network-security-group-how-it-works",
            "service": "ExpressRoute",
            "severity": "中程度",
            "subcategory": "暗号化",
            "text": "ExpressRoute Direct を使用している場合は、組織のルーターと MSEE 間のレイヤー 2 レベルでトラフィックを暗号化するために MACsec を構成します。この図は、この暗号化をフローで示しています。",
            "waf": "安全"
        },
        {
            "category": "ネットワークトポロジと接続性",
            "guid": "ed301d6e-872e-452e-9611-cc58b5a4b151",
            "id": "D02.02",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-erdirect-about",
            "service": "ExpressRoute",
            "severity": "低い",
            "subcategory": "暗号化",
            "text": "MACsec がオプションではないシナリオ (ExpressRoute Direct を使用しない場合など) では、VPN ゲートウェイを使用して、ExpressRoute プライベート ピアリング経由で IPsec トンネルを確立します。",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/",
            "waf": "安全"
        },
        {
            "category": "ネットワークトポロジと接続性",
            "guid": "e8bbac75-7155-49ab-a153-e8908ae28c84",
            "id": "D03.01",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/enterprise-scale/network-topology-and-connectivity",
            "service": "VNet",
            "severity": "中程度",
            "subcategory": "ハブ アンド スポーク",
            "text": "従来のハブアンドスポーク ネットワーク トポロジに基づくネットワーク設計を、最大限の柔軟性を必要とするネットワーク シナリオに活用します。",
            "training": "https://learn.microsoft.com/learn/paths/architect-network-infrastructure/",
            "waf": "安全"
        },
        {
            "ammp": true,
            "category": "ネットワークトポロジと接続性",
            "guid": "7dd61623-a364-4a90-9eca-e48ebd54cd7d",
            "id": "D03.02",
            "link": "https://learn.microsoft.com/azure/architecture/reference-architectures/hybrid-networking/expressroute",
            "service": "VNet",
            "severity": "高い",
            "subcategory": "ハブ アンド スポーク",
            "text": "ExpressRoute ゲートウェイ、VPN ゲートウェイ、Azure Firewall などの共有ネットワーク サービス、または中央ハブ仮想ネットワーク内のパートナーの NVA を確認します。必要に応じて、DNS サーバーも展開します。",
            "waf": "費用"
        },
        {
            "category": "ネットワークトポロジと接続性",
            "guid": "e2e8abac-3571-4559-ab91-53e89f89dc7b",
            "id": "D03.03",
            "link": "https://learn.microsoft.com/azure/architecture/reference-architectures/dmz/nva-ha",
            "service": "NVA",
            "severity": "中程度",
            "subcategory": "ハブ アンド スポーク",
            "text": "パートナー ネットワーク テクノロジまたは NVA をデプロイする場合は、パートナー ベンダーのガイダンスに従ってください",
            "waf": "確実"
        },
        {
            "category": "ネットワークトポロジと接続性",
            "guid": "ce463dbb-bc8a-4c2a-aebc-92a43da1dae2",
            "id": "D03.04",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-howto-coexist-resource-manager#to-enable-transit-routing-between-expressroute-and-azure-vpn",
            "service": "ExpressRoute",
            "severity": "低い",
            "subcategory": "ハブ アンド スポーク",
            "text": "ハブ アンド スポーク シナリオで ExpressRoute と VPN ゲートウェイ間の転送が必要な場合は、Azure Route Server を使用します。",
            "waf": "安全"
        },
        {
            "category": "ネットワークトポロジと接続性",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,subnets=properties.subnets | mv-expand subnets | project id, subnetName = subnets.name, subnetPrefix = subnets.properties.addressPrefix | extend subnetPrefixLength = split(subnetPrefix, '/')[1] | where subnetName == 'RouteServerSubnet' | extend compliant = (subnetPrefixLength <= 27) | distinct id, compliant",
            "guid": "91b9d7d5-91e1-4dcb-8f1f-fa7e465646cc",
            "id": "D03.05",
            "link": "https://learn.microsoft.com/azure/route-server/quickstart-configure-route-server-portal#create-a-route-server-1",
            "service": "ARS",
            "severity": "低い",
            "subcategory": "ハブ アンド スポーク",
            "text": "Route Server を使用する場合は、Route Server サブネットに /27 プレフィックスを使用します。",
            "waf": "安全"
        },
        {
            "category": "ネットワークトポロジと接続性",
            "guid": "cc881471-607c-41cc-a0e6-14658dd558f9",
            "id": "D03.06",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-networks-faq#can-i-create-a-peering-connection-to-a-vnet-in-a-different-region",
            "service": "VNet",
            "severity": "中程度",
            "subcategory": "ハブ アンド スポーク",
            "text": "複数のハブ アンド スポーク トポロジを持つネットワーク アーキテクチャでは、ハブ VNet 間のグローバル仮想ネットワーク ピアリングを使用して、リージョンを相互に接続します。",
            "training": "https://learn.microsoft.com/learn/paths/azure-administrator-manage-virtual-networks/",
            "waf": "パフォーマンス"
        },
        {
            "category": "ネットワークトポロジと接続性",
            "guid": "4722d929-c1b1-4cd6-81f5-4b29bade39ad",
            "id": "D03.07",
            "link": "https://learn.microsoft.com/azure/azure-monitor/insights/network-insights-overview",
            "service": "VNet",
            "severity": "中程度",
            "subcategory": "ハブ アンド スポーク",
            "text": "Azure Monitor for Networks を使用して、Azure 上のネットワークのエンド ツー エンドの状態を監視します。",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-network-monitoring/",
            "waf": "オペレーションズ"
        },
        {
            "category": "ネットワークトポロジと接続性",
            "graph": "resources | where type == 'microsoft.network/virtualnetworks' | mvexpand properties.virtualNetworkPeerings | summarize peeringcount = count() by id | extend compliant = (peeringcount < 450) | distinct id,compliant",
            "guid": "0e7c28ec-9366-4572-83b0-f4664b1d944a",
            "id": "D03.08",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits?toc=/azure/virtual-network/toc.json#azure-resource-manager-virtual-networking-limits",
            "service": "VNet",
            "severity": "中程度",
            "subcategory": "ハブ アンド スポーク",
            "text": "スポーク仮想ネットワークを中央ハブ仮想ネットワークに接続する場合は、ExpressRoute 経由でアドバタイズできるプレフィックスの最大数である VNet ピアリングの制限 (500) (1000) を考慮してください",
            "waf": "確実"
        },
        {
            "category": "ネットワークトポロジと接続性",
            "graph": "resources | where type=='microsoft.network/routetables' | mvexpand properties.routes | summarize routeCount = count() by id | extend compliant = (routeCount < 360) | distinct id,compliant",
            "guid": "3d457936-e9b7-41eb-bdff-314b26450b12",
            "id": "D03.09",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits?toc=/azure/virtual-network/toc.json#azure-resource-manager-virtual-networking-limits",
            "service": "VNet",
            "severity": "中程度",
            "subcategory": "ハブ アンド スポーク",
            "text": "ルート テーブルあたりのルート数の制限 (400) を考慮します。",
            "waf": "確実"
        },
        {
            "ammp": true,
            "category": "ネットワークトポロジと接続性",
            "graph": "resources | where type == 'microsoft.network/virtualnetworks' | mvexpand properties.virtualNetworkPeerings | project id, peeringName=properties_virtualNetworkPeerings.name, compliant = (properties_virtualNetworkPeerings.properties.allowVirtualNetworkAccess == True)",
            "guid": "c76cb5a2-abe2-11ed-afa1-0242ac120002",
            "id": "D03.10",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-network-manage-peering",
            "service": "VNet",
            "severity": "高い",
            "subcategory": "ハブ アンド スポーク",
            "text": "VNet ピアリングを構成するときに [リモート仮想ネットワークへのトラフィックを許可する] 設定を使用します",
            "waf": "確実"
        },
        {
            "category": "ネットワークトポロジと接続性",
            "guid": "359c373e-7dd6-4162-9a36-4a907ecae48e",
            "id": "D04.01",
            "link": "https://learn.microsoft.com/azure/architecture/reference-architectures/hybrid-networking/hub-spoke?tabs=cli",
            "service": "ExpressRoute",
            "severity": "中程度",
            "subcategory": "ハイブリッド",
            "text": "ExpressRoute を Azure へのプライマリ接続として使用する可能性を調査したことを確認します。",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "パフォーマンス"
        },
        {
            "category": "ネットワークトポロジと接続性",
            "description": "AS パスのプリペンドと接続の重みを使用して、Azure からオンプレミスへのトラフィックに影響を与え、独自のルーターの全範囲の BGP 属性を使用して、オンプレミスから Azure へのトラフィックに影響を与えることができます。",
            "guid": "f29812b2-363c-4efe-879b-599de0d5973c",
            "id": "D04.02",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-routing",
            "service": "ExpressRoute",
            "severity": "中程度",
            "subcategory": "ハイブリッド",
            "text": "複数の ExpressRoute 回線、または複数のオンプレミスの場所を使用する場合、特定のパスが優先される場合は、BGP 属性を使用してルーティングを最適化してください。",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "確実"
        },
        {
            "category": "ネットワークトポロジと接続性",
            "graph": "resources| where type == 'microsoft.network/virtualnetworkgateways'| where properties.gatewayType =~ 'vpn' or properties.gatewayType == 'ExpressRoute'| extend SKUName = properties.sku.name, SKUTier = properties.sku.tier, Type = properties.gatewayType| extend compliant = SKUTier !in ('Basic', 'Standard')| project name, id, subscriptionId, resourceGroup, compliant",
            "guid": "d4cd21b0-8813-47f5-b6c4-cfd3e504547c",
            "id": "D04.03",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-routing",
            "service": "ExpressRoute",
            "severity": "中程度",
            "subcategory": "ハイブリッド",
            "text": "帯域幅とパフォーマンスの要件に基づいて、ExpressRoute/VPN ゲートウェイに適切な SKU を使用していることを確認します。",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "パフォーマンス"
        },
        {
            "ammp": true,
            "category": "ネットワークトポロジと接続性",
            "graph": "resources | where type=='microsoft.network/expressroutecircuits' | extend compliant = (tolower(sku.family) == 'metereddata' or tolower(sku.tier) == 'local') | distinct id,compliant",
            "guid": "7025b442-f6e9-4af6-b11f-c9574916016f",
            "id": "D04.04",
            "link": "https://learn.microsoft.com/azure/expressroute/plan-manage-cost",
            "service": "ExpressRoute",
            "severity": "高い",
            "subcategory": "ハイブリッド",
            "text": "無制限のデータ ExpressRoute 回線は、コストに見合った帯域幅に達した場合にのみ使用してください。",
            "waf": "費用"
        },
        {
            "ammp": true,
            "category": "ネットワークトポロジと接続性",
            "graph": "resources | where type=='microsoft.network/connections' | where properties.connectionType == 'ExpressRoute' | project id, gwid=tostring(properties.virtualNetworkGateway1.id), circuitid=tostring(properties.peer.id) | join (resources | where type=='microsoft.network/expressroutecircuits' | project circuitid=tostring(id), circuitsku=sku.tier) on circuitid | project id=gwid, compliant = (circuitsku == 'Local') | summarize compliant=max(compliant) by id",
            "guid": "f4e7926a-ec35-476e-a412-5dd17136bd62",
            "id": "D04.05",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-faqs#expressroute-local",
            "service": "ExpressRoute",
            "severity": "高い",
            "subcategory": "ハイブリッド",
            "text": "回線のピアリングの場所がローカル SKU の Azure リージョンをサポートしている場合は、ExpressRoute のローカル SKU を利用して回線のコストを削減します。",
            "waf": "費用"
        },
        {
            "category": "ネットワークトポロジと接続性",
            "graph": "resources| where type == 'microsoft.network/virtualnetworkgateways'| where properties.gatewayType =~ 'vpn' or properties.gatewayType == 'ExpressRoute'| extend SKUName = properties.sku.name, SKUTier = properties.sku.tier, Type = properties.gatewayType| extend compliant = SKUTier contains 'AZ'| project name, id, subscriptionId, resourceGroup, Type, compliant",
            "guid": "2447ec66-138a-4720-8f1c-e16ed301d6e8",
            "id": "D04.06",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-about-virtual-network-gateways",
            "service": "ExpressRoute",
            "severity": "中程度",
            "subcategory": "ハイブリッド",
            "text": "サポートされている Azure リージョンにゾーン冗長 ExpressRoute ゲートウェイをデプロイします。",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "確実"
        },
        {
            "category": "ネットワークトポロジと接続性",
            "guid": "72e52e36-11cc-458b-9a4b-1511e43a58a9",
            "id": "D04.07",
            "link": "https://learn.microsoft.com/azure/networking/",
            "service": "ExpressRoute",
            "severity": "中程度",
            "subcategory": "ハイブリッド",
            "text": "10 Gbps を超える帯域幅または専用の 10/100 Gbps ポートを必要とするシナリオでは、ExpressRoute Direct を使用します。",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "パフォーマンス"
        },
        {
            "category": "ネットワークトポロジと接続性",
            "guid": "c2299c4d-7b57-4d0c-9555-62f2b3e4563a",
            "id": "D04.08",
            "link": "https://learn.microsoft.com/azure/expressroute/about-fastpath",
            "service": "ExpressRoute",
            "severity": "中程度",
            "subcategory": "ハイブリッド",
            "text": "待機時間を短くする必要がある場合、またはオンプレミスから Azure へのスループットを 10 Gbps を超える必要がある場合は、FastPath を有効にして、データ パスから ExpressRoute ゲートウェイをバイパスします。",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "パフォーマンス"
        },
        {
            "category": "ネットワークトポロジと接続性",
            "graph": "resources | where type=='microsoft.network/virtualnetworkgateways' | where properties.gatewayType == 'Vpn' | extend compliant = (tolower(properties.sku.name) contains 'az') | distinct id, compliant",
            "guid": "4d873974-8b66-42d6-b15f-512a65498f6d",
            "id": "D04.09",
            "link": "https://learn.microsoft.com/azure/vpn-gateway/create-zone-redundant-vnet-gateway",
            "service": "VPN",
            "severity": "中程度",
            "subcategory": "ハイブリッド",
            "text": "ゾーン冗長 VPN ゲートウェイを使用して、ブランチまたはリモートの場所を Azure に接続します (使用可能な場合)。",
            "training": "https://learn.microsoft.com/training/modules/intro-to-azure-vpn-gateway/",
            "waf": "確実"
        },
        {
            "category": "ネットワークトポロジと接続性",
            "guid": "45866df8-cf85-4ca9-bbe2-65ec1478919e",
            "id": "D04.10",
            "link": "https://learn.microsoft.com/azure/vpn-gateway/vpn-gateway-highlyavailable",
            "service": "VPN",
            "severity": "中程度",
            "subcategory": "ハイブリッド",
            "text": "冗長 VPN アプライアンスをオンプレミス (アクティブ/アクティブまたはアクティブ/パッシブ) で使用します。",
            "training": "https://learn.microsoft.com/training/modules/intro-to-azure-vpn-gateway/",
            "waf": "確実"
        },
        {
            "ammp": true,
            "category": "ネットワークトポロジと接続性",
            "guid": "718cb437-b060-2589-8856-2e93a5c6633b",
            "id": "D04.11",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-erdirect-about",
            "service": "ExpressRoute",
            "severity": "高い",
            "subcategory": "ハイブリッド",
            "text": "ExpressRoute Direct を使用する場合は、コストを節約するために、ローカルの Azure リージョンへの ExpressRoute Local 回線の使用を検討してください",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "費用"
        },
        {
            "category": "ネットワークトポロジと接続性",
            "guid": "8042d88e-79d1-47b7-9b22-a5a67e7a8ed4",
            "id": "D04.12",
            "link": "https://learn.microsoft.com/azure/architecture/framework/services/networking/expressroute/reliability",
            "service": "ExpressRoute",
            "severity": "中程度",
            "subcategory": "ハイブリッド",
            "text": "運用環境と非運用環境を分離する場合など、トラフィックの分離または専用の帯域幅が必要な場合は、異なる ExpressRoute 回線を使用します。これにより、ルーティング ドメインが分離され、ノイジー ネイバーのリスクが軽減されます。",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "安全"
        },
        {
            "category": "ネットワークトポロジと接続性",
            "guid": "b30e38c3-f298-412b-8363-cefe179b599d",
            "id": "D04.13",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-monitoring-metrics-alerts",
            "service": "ExpressRoute",
            "severity": "中程度",
            "subcategory": "ハイブリッド",
            "text": "組み込みの Express Route Insights を使用して、ExpressRoute の可用性と使用率を監視します。",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "オペレーションズ"
        },
        {
            "category": "ネットワークトポロジと接続性",
            "guid": "5bf68dc9-325e-4873-bf88-f8214ef2e5d2",
            "id": "D04.14",
            "link": "https://learn.microsoft.com/azure/expressroute/how-to-configure-connection-monitor",
            "service": "ExpressRoute",
            "severity": "中程度",
            "subcategory": "ハイブリッド",
            "text": "接続モニターは、ネットワーク全体 (特にオンプレミスと Azure 間) の接続を監視するために使用します。",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "オペレーションズ"
        },
        {
            "category": "ネットワークトポロジと接続性",
            "guid": "e0d5973c-d4cd-421b-8881-37f5e6c4cfd3",
            "id": "D04.15",
            "link": "https://learn.microsoft.com/azure/expressroute/designing-for-disaster-recovery-with-expressroute-privatepeering#challenges-of-using-multiple-expressroute-circuits",
            "service": "ExpressRoute",
            "severity": "中程度",
            "subcategory": "ハイブリッド",
            "text": "冗長性のために、異なるピアリングの場所からの ExpressRoute 回線を使用します。",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "確実"
        },
        {
            "category": "ネットワークトポロジと接続性",
            "guid": "cf3fe65c-fec0-495a-8edc-9675200f2add",
            "id": "D04.16",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-howto-coexist-resource-manager",
            "service": "ExpressRoute",
            "severity": "中程度",
            "subcategory": "ハイブリッド",
            "text": "ExpressRoute のフェールオーバーとしてサイト間 VPN を使用します (特に、1 つの ExpressRoute 回線のみを使用する場合)。",
            "waf": "確実"
        },
        {
            "ammp": true,
            "category": "ネットワークトポロジと接続性",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,resourceGroup,name,subnets=properties.subnets | mv-expand subnets | project id,resourceGroup,name,subnetName=tostring(subnets.name),routeTableId=tostring(subnets.properties.routeTable.id) | where subnetName == 'GatewaySubnet' | join kind=leftouter (Resources | where type == 'microsoft.network/routetables' | project routeTableName=name,routeTableId=id, disableBgpRoutePropagation=properties.disableBgpRoutePropagation) on routeTableId | project id,compliant = (disableBgpRoutePropagation == False or isnull(disableBgpRoutePropagation))",
            "guid": "72105cc8-aaea-4ee1-8c7a-ad25977afcaf",
            "id": "D04.17",
            "link": "https://learn.microsoft.com/azure/vpn-gateway/vpn-gateway-about-vpn-gateway-settings#gwsub",
            "service": "ExpressRoute",
            "severity": "高い",
            "subcategory": "ハイブリッド",
            "text": "GatewaySubnet でルート テーブルを使用している場合は、ゲートウェイ ルートが伝達されていることを確認します。",
            "waf": "確実"
        },
        {
            "ammp": true,
            "category": "ネットワークトポロジと接続性",
            "guid": "d581a947-69a2-4783-942e-9df3664324c8",
            "id": "D04.18",
            "link": "https://learn.microsoft.com/azure/expressroute/designing-for-high-availability-with-expressroute#active-active-connections",
            "service": "ExpressRoute",
            "severity": "高い",
            "subcategory": "ハイブリッド",
            "text": "ExpressRoute を使用する場合、オンプレミスのルーティングは動的である必要があり、接続障害が発生した場合は、回線の残りの接続に収束する必要があります。負荷は、アクティブ/パッシブもサポートされていますが、理想的にはアクティブ/アクティブとして両方の接続で共有する必要があります。",
            "waf": "確実"
        },
        {
            "ammp": true,
            "category": "ネットワークトポロジと接続性",
            "guid": "558fd772-49b8-4211-82df-27ee412e7f98",
            "id": "D05.01",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-ip-addressing",
            "service": "ExpressRoute",
            "severity": "高い",
            "subcategory": "IPプラン",
            "text": "Azure リージョンとオンプレミスの場所間で重複する IP アドレス空間が使用されていないことを確認します",
            "training": "https://learn.microsoft.com/learn/paths/architect-network-infrastructure/",
            "waf": "安全"
        },
        {
            "category": "ネットワークトポロジと接続性",
            "graph": "resources | where type == 'microsoft.network/virtualnetworks' | extend addressSpace = todynamic(properties.addressSpace) | extend addressPrefix = todynamic(properties.addressSpace.addressPrefixes) | mvexpand addressSpace | mvexpand addressPrefix | project name, id, location, resourceGroup, subscriptionId, cidr = addressPrefix | extend compliant = (cidr matches regex @'^(10\\.|172\\.(1[6-9]|2[0-9]|3[01])\\.|192\\.168\\.)') | project id, compliant, cidr",
            "guid": "3f630472-2dd6-49c5-a5c2-622f54b69bad",
            "id": "D05.02",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-ip-addressing",
            "service": "VNet",
            "severity": "低い",
            "subcategory": "IPプラン",
            "text": "プライベート インターネットのアドレス割り当て範囲 (RFC 1918) の IP アドレスを使用します。",
            "training": "https://learn.microsoft.com/learn/paths/architect-network-infrastructure/",
            "waf": "安全"
        },
        {
            "ammp": true,
            "category": "ネットワークトポロジと接続性",
            "graph": "resources | where type == 'microsoft.network/virtualnetworks' | extend addressSpace = todynamic(properties.addressSpace) | extend addressPrefix = todynamic(properties.addressSpace.addressPrefixes) | mvexpand addressSpace | mvexpand addressPrefix | extend addressMask = split(addressPrefix,'/')[1] | extend compliant = addressMask > 16 | project name, id, subscriptionId, resourceGroup, addressPrefix, compliant",
            "guid": "33aad5e8-c68e-41d7-9667-313b4f5664b5",
            "id": "D05.03",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-ip-addressing",
            "service": "VNet",
            "severity": "高い",
            "subcategory": "IPプラン",
            "text": "IP アドレス空間が無駄にならないようにし、不必要に大きな仮想ネットワーク (/16 など) を作成しないようにします",
            "training": "https://learn.microsoft.com/learn/paths/architect-network-infrastructure/",
            "waf": "パフォーマンス"
        },
        {
            "ammp": true,
            "category": "ネットワークトポロジと接続性",
            "guid": "f348ef25-4c27-4d42-b8bb-ac7571559ab9",
            "id": "D05.04",
            "link": "https://learn.microsoft.com/azure/site-recovery/concepts-on-premises-to-azure-networking#retain-ip-addresses",
            "service": "VNet",
            "severity": "高い",
            "subcategory": "IPプラン",
            "text": "運用サイトと DR サイトで重複する IP アドレス範囲を使用しないでください。",
            "training": "https://learn.microsoft.com/learn/paths/az-104-manage-virtual-networks/",
            "waf": "確実"
        },
        {
            "category": "ネットワークトポロジと接続性",
            "guid": "153e8908-ae28-4c84-a33b-6b7808b9fe5c",
            "id": "D05.05",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-networks-name-resolution-for-vms-and-role-instances",
            "service": "DNS",
            "severity": "中程度",
            "subcategory": "IPプラン",
            "text": "Azure での名前解決のみが必要な環境では、名前解決用の委任されたゾーン ('azure.contoso.com' など) を使用して解決に Azure プライベート DNS を使用します。",
            "training": "https://learn.microsoft.com/learn/paths/az-104-manage-virtual-networks/",
            "waf": "オペレーションズ"
        },
        {
            "category": "ネットワークトポロジと接続性",
            "guid": "41049d40-3a92-43c3-974d-00018ac6a9e0",
            "id": "D05.06",
            "link": "https://learn.microsoft.com/azure/dns/dns-private-resolver-overview",
            "service": "DNS",
            "severity": "中程度",
            "subcategory": "IPプラン",
            "text": "Azure とオンプレミスでの名前解決が必要な環境では、Azure DNS Private Resolver の使用を検討してください。",
            "training": "https://learn.microsoft.com/training/modules/intro-to-azure-dns-private-resolver/",
            "waf": "安全"
        },
        {
            "category": "ネットワークトポロジと接続性",
            "guid": "1e6a83de-5de3-42c1-a924-81607d5d1e4e",
            "id": "D05.07",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-networks-name-resolution-for-vms-and-role-instances",
            "service": "DNS",
            "severity": "低い",
            "subcategory": "IPプラン",
            "text": "独自の DNS (Red Hat OpenShift など) を必要としてデプロイする特別なワークロードでは、優先 DNS ソリューションを使用する必要があります。",
            "waf": "オペレーションズ"
        },
        {
            "ammp": true,
            "category": "ネットワークトポロジと接続性",
            "guid": "614658d3-558f-4d77-849b-821112df27ee",
            "id": "D05.08",
            "link": "https://learn.microsoft.com/azure/dns/private-dns-autoregistration",
            "service": "DNS",
            "severity": "高い",
            "subcategory": "IPプラン",
            "text": "Azure DNS の自動登録を有効にすると、仮想ネットワーク内にデプロイされた仮想マシンの DNS レコードのライフサイクルが自動的に管理されます。",
            "training": "https://learn.microsoft.com/learn/paths/az-104-manage-virtual-networks/",
            "waf": "オペレーションズ"
        },
        {
            "category": "ネットワークトポロジと接続性",
            "guid": "ee1ac551-c4d5-46cf-b035-d0a3c50d87ad",
            "id": "D06.01",
            "link": "https://learn.microsoft.com/azure/bastion/bastion-overview",
            "service": "Bastion",
            "severity": "中程度",
            "subcategory": "インターネット",
            "text": "Azure Bastion を使用してネットワークに安全に接続することを検討してください。",
            "waf": "安全"
        },
        {
            "category": "ネットワークトポロジと接続性",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,subnets=properties.subnets | mv-expand subnets | project id, subnetName = subnets.name, subnetPrefix = subnets.properties.addressPrefix | extend subnetPrefixLength = split(subnetPrefix, '/')[1] | where subnetName == 'AzureBastionSubnet' | extend compliant = (subnetPrefixLength <= 26) | distinct id, compliant",
            "guid": "6eab9eb6-762b-485e-8ea8-15aa5dba0bd0",
            "id": "D06.02",
            "link": "https://learn.microsoft.com/azure/bastion/bastion-faq#subnet",
            "service": "Bastion",
            "severity": "中程度",
            "subcategory": "インターネット",
            "text": "Azure Bastion は、サブネット /26 以上で使用します。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "category": "ネットワークトポロジと接続性",
            "guid": "e6c4cfd3-e504-4547-a244-7ec66138a720",
            "id": "D06.03",
            "link": "https://learn.microsoft.com/azure/app-service/networking-features",
            "service": "Firewall",
            "severity": "高い",
            "subcategory": "インターネット",
            "text": "Azure Firewall を使用して、インターネットへの Azure 送信トラフィック、HTTP/S 以外の受信接続、East/West トラフィック フィルター処理 (組織で必要な場合) を管理します",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "安全"
        },
        {
            "category": "ネットワークトポロジと接続性",
            "guid": "5a4b1511-e43a-458a-ac22-99c4d7b57d0c",
            "id": "D06.04",
            "link": "https://learn.microsoft.com/azure/firewall/",
            "service": "Firewall",
            "severity": "中程度",
            "subcategory": "インターネット",
            "text": "グローバル ネットワーク環境全体のセキュリティ体制を管理するグローバル Azure Firewall ポリシーを作成し、それをすべての Azure Firewall インスタンスに割り当てます。Azure のロールベースのアクセス制御を介して増分ファイアウォール ポリシーをローカルのセキュリティ チームに委任することで、特定のリージョンの要件を満たすきめ細かなポリシーが可能になります。",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "安全"
        },
        {
            "category": "ネットワークトポロジと接続性",
            "guid": "655562f2-b3e4-4563-a4d8-739748b662d6",
            "id": "D06.05",
            "link": "https://learn.microsoft.com/azure/firewall/",
            "service": "Firewall",
            "severity": "低い",
            "subcategory": "インターネット",
            "text": "組織がそのようなソリューションを使用してアウトバウンド接続を保護する場合は、Firewall Manager 内でサポートされているパートナーの SaaS セキュリティ プロバイダーを構成します。",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "安全"
        },
        {
            "category": "ネットワークトポロジと接続性",
            "guid": "1d7aa9b6-4704-4489-a804-2d88e79d17b7",
            "id": "D06.06",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/afds-overview",
            "service": "WAF",
            "severity": "中程度",
            "subcategory": "インターネット",
            "text": "Azure Front Door と WAF ポリシーを使用して、ランディング ゾーンへの受信 HTTP/S 接続に対して Azure リージョン全体でグローバル保護を提供します。",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "安全"
        },
        {
            "category": "ネットワークトポロジと接続性",
            "guid": "3b22a5a6-7e7a-48ed-9b30-e38c3f29812b",
            "id": "D06.07",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "service": "WAF",
            "severity": "低い",
            "subcategory": "インターネット",
            "text": "Azure Front Door と Azure Application Gateway を使用して HTTP/S アプリを保護する場合は、Azure Front Door で WAF ポリシーを使用します。Azure Application Gateway をロックダウンして、Azure Front Door からのトラフィックのみを受信するようにします。",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "安全"
        },
        {
            "ammp": true,
            "category": "ネットワークトポロジと接続性",
            "guid": "2363cefe-179b-4599-be0d-5973cd4cd21b",
            "id": "D06.08",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "service": "WAF",
            "severity": "高い",
            "subcategory": "インターネット",
            "text": "WAF とその他のリバース プロキシは、受信 HTTP/S 接続に必要であり、ランディング ゾーン仮想ネットワーク内にデプロイし、保護してインターネットに公開しているアプリと共にデプロイします。",
            "training": "https://learn.microsoft.com/learn/paths/architect-network-infrastructure/",
            "waf": "安全"
        },
        {
            "ammp": true,
            "category": "ネットワークトポロジと接続性",
            "guid": "088137f5-e6c4-4cfd-9e50-4547c2447ec6",
            "id": "D06.09",
            "link": "https://learn.microsoft.com/azure/ddos-protection/ddos-protection-reference-architectures",
            "service": "VNet",
            "severity": "高い",
            "subcategory": "インターネット",
            "text": "Azure DDoS ネットワークまたは IP Protection プランを使用して、仮想ネットワーク内のパブリック IP アドレス エンドポイントを保護します。",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "安全"
        },
        {
            "ammp": true,
            "category": "ネットワークトポロジと接続性",
            "graph": "resources | where type=='microsoft.network/firewallpolicies' | extend compliant = (properties.dnsSettings.enableProxy == true) | distinct id,compliant",
            "guid": "14d99880-2f88-47e8-a134-62a7d85c94af",
            "id": "D06.10",
            "link": "https://learn.microsoft.com/azure/firewall/fqdn-filtering-network-rules",
            "service": "Firewall",
            "severity": "高い",
            "subcategory": "インターネット",
            "text": "FQDN ベースのネットワーク ルールと DNS プロキシを備えた Azure Firewall を使用して、アプリケーション ルールでサポートされていないプロトコルを介してインターネットへのエグレス トラフィックをフィルター処理します。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "category": "ネットワークトポロジと接続性",
            "graph": "resources | where type=='microsoft.network/firewallpolicies' | extend compliant = (properties.sku.tier == 'Premium') | distinct id,compliant",
            "guid": "c10d51ef-f999-455d-bba0-5c90ece07447",
            "id": "D06.11",
            "link": "https://learn.microsoft.com/azure/firewall/premium-features",
            "service": "Firewall",
            "severity": "高い",
            "subcategory": "インターネット",
            "text": "Azure Firewall Premium を使用して、セキュリティと保護を強化します。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "category": "ネットワークトポロジと接続性",
            "graph": "resources | where type=='microsoft.network/firewallpolicies' | extend compliant = (properties.threatIntelMode == 'Deny') | distinct id,compliant",
            "guid": "e9c8f584-6d5e-473b-8dc5-acc9fbaab4e3",
            "id": "D06.12",
            "link": "https://learn.microsoft.com/azure/firewall/premium-features",
            "service": "Firewall",
            "severity": "高い",
            "subcategory": "インターネット",
            "text": "保護を強化するために、Azure Firewall 脅威インテリジェンス モードを [アラート] と [拒否] に構成します。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "category": "ネットワークトポロジと接続性",
            "graph": "resources | where type=='microsoft.network/firewallpolicies' | extend compliant = (properties.intrusionDetection.mode == 'Deny') | project id, compliant",
            "guid": "b9d0dff5-bdd4-4cd8-88ed-5811610b2b2c",
            "id": "D06.13",
            "link": "https://learn.microsoft.com/azure/firewall/premium-features#idps",
            "service": "Firewall",
            "severity": "高い",
            "subcategory": "インターネット",
            "text": "保護を強化するために、Azure Firewall IDPS モードを [拒否] に構成します。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "category": "ネットワークトポロジと接続性",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,resourceGroup,name,subnets=properties.subnets | mv-expand subnets | project id,name,subnetId=tostring(subnets.id), subnetName=tostring(subnets.name),subnetRT=subnets.properties.routeTable.id | where not (subnetName in ('GatewaySubnet', 'AzureFirewallSubnet', 'RouteServerSubnet', 'AzureBastionSubnet')) | extend hasRT = isnotnull(subnetRT) | distinct id, hasRT, subnetId | join kind=fullouter (resources | where type == 'microsoft.network/virtualnetworks' | mvexpand properties.virtualNetworkPeerings | extend isVWAN=(tolower(split(properties_virtualNetworkPeerings.name, '_')[0]) == 'remotevnettohubpeering') | mv-expand properties.subnets | project id, isVWAN, name, subnetId=tostring(properties_subnets.id), subnetName=tostring(properties_subnets.name) | summarize PeeredToVWAN=max(isVWAN) by id, subnetId | project id, subnetId, isVWANpeer = (PeeredToVWAN == true)) on subnetId | project id=iff(isnotempty(id), id, id1), subnetId=iff(isnotempty(subnetId), subnetId, subnetId1), hasRT, isVWANpeer | extend compliant = (hasRT==true or isVWANpeer==true) | distinct id, subnetId, compliant",
            "guid": "a3784907-9836-4271-aafc-93535f8ec08b",
            "id": "D06.14",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-networks-udr-overview",
            "service": "Firewall",
            "severity": "高い",
            "subcategory": "インターネット",
            "text": "Virtual WAN に接続されていない VNet 内のサブネットの場合は、インターネット トラフィックが Azure Firewall またはネットワーク仮想アプライアンスにリダイレクトされるようにルート テーブルをアタッチします",
            "waf": "安全"
        },
        {
            "ammp": true,
            "category": "ネットワークトポロジと接続性",
            "guid": "b034c01e-110b-463a-b36e-e3346e57f225",
            "id": "D06.15",
            "link": "https://learn.microsoft.com/en-us/azure/virtual-network/ip-services/default-outbound-access",
            "service": "VNet",
            "severity": "高い",
            "subcategory": "インターネット",
            "text": "今後の破壊的変更の前に、ネットワーク送信トラフィックの構成と戦略を評価および確認します。2025 年 9 月 30 日に、新しいデプロイの既定の送信アクセスは廃止され、明示的なアクセス構成のみが許可されます",
            "waf": "確実"
        },
        {
            "ammp": true,
            "category": "ネットワークトポロジと接続性",
            "guid": "d301d6e8-72e5-42e3-911c-c58b5a4b1511",
            "id": "D07.01",
            "link": "https://learn.microsoft.com/azure/virtual-network/vnet-integration-for-azure-services",
            "service": "App Gateway",
            "severity": "高い",
            "subcategory": "PaaS(パーエス)",
            "text": "仮想ネットワークに挿入された Azure PaaS サービスのコントロール プレーン通信が、たとえば、コントロール プレーンのトラフィックをブロックする 0.0.0.0/0 ルートや NSG ルールによって切断されていないことを確認します。",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/?source=learn",
            "waf": "安全"
        },
        {
            "category": "ネットワークトポロジと接続性",
            "guid": "e43a58a9-c229-49c4-b7b5-7d0c655562f2",
            "id": "D07.02",
            "link": "https://learn.microsoft.com/azure/app-service/networking-features",
            "severity": "中程度",
            "subcategory": "PaaS(パーエス)",
            "text": "共有 Azure PaaS サービスには、使用可能な場合は Private Link を使用します。",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "安全"
        },
        {
            "category": "ネットワークトポロジと接続性",
            "guid": "b3e4563a-4d87-4397-98b6-62d6d15f512a",
            "id": "D07.03",
            "link": "https://learn.microsoft.com/azure/app-service/networking-features",
            "service": "ExpressRoute",
            "severity": "中程度",
            "subcategory": "PaaS(パーエス)",
            "text": "オンプレミスからプライベート エンドポイントと ExpressRoute プライベート ピアリングを介して Azure PaaS サービスにアクセスします。この方法では、パブリック インターネット経由のトランジットが回避されます。",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "安全"
        },
        {
            "category": "ネットワークトポロジと接続性",
            "graph": "resources | where type =~ 'microsoft.network/virtualnetworks' | project id,resourceGroup,name,subnets = properties.subnets | mv-expand subnets | project id = subnets.id, resourceGroup, VNet = name, serviceEndpoints = subnets.properties.serviceEndpoints, compliant = (isnull(subnets.properties.serviceEndpoints) or array_length(subnets.properties.serviceEndpoints) == 0) | order by compliant asc",
            "guid": "4704489a-8042-4d88-b79d-17b73b22a5a6",
            "id": "D07.04",
            "link": "https://learn.microsoft.com/azure/app-service/networking-features",
            "service": "VNet",
            "severity": "中程度",
            "subcategory": "PaaS(パーエス)",
            "text": "すべてのサブネットで仮想ネットワーク サービス エンドポイントを既定で有効にしないでください。",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/?source=learn",
            "waf": "安全"
        },
        {
            "category": "ネットワークトポロジと接続性",
            "guid": "7e7a8ed4-b30e-438c-9f29-812b2363cefe",
            "id": "D07.05",
            "link": "https://learn.microsoft.com/azure/app-service/networking-features",
            "service": "Firewall",
            "severity": "中程度",
            "subcategory": "PaaS(パーエス)",
            "text": "Azure Firewall または NVA の IP アドレスの代わりに FQDN を使用して Azure PaaS サービスへのエグレス トラフィックをフィルター処理し、データ流出を防ぎます。Private Link を使用している場合は、すべての FQDN をブロックし、それ以外の場合は必要な PaaS サービスのみを許可できます。",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/?source=learn",
            "waf": "安全"
        },
        {
            "ammp": true,
            "category": "ネットワークトポロジと接続性",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,subnets=properties.subnets | mv-expand subnets | project id, subnetName = subnets.name, subnetPrefix = subnets.properties.addressPrefix | extend subnetPrefixLength = split(subnetPrefix, '/')[1] | where subnetName == 'AzureFirewallSubnet' | extend compliant = (subnetPrefixLength == 26) | distinct id, compliant",
            "guid": "22d6419e-b627-4d95-9e7d-019fa759387f",
            "id": "D08.01",
            "link": "https://learn.microsoft.com/azure/firewall/firewall-faq#why-does-azure-firewall-need-a--26-subnet-size",
            "service": "Firewall",
            "severity": "高い",
            "subcategory": "セグメンテーション",
            "text": "Azure Firewall サブネットに /26 プレフィックスを使用します。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "category": "ネットワークトポロジと接続性",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,subnets=properties.subnets | mv-expand subnets | project id, subnetName = subnets.name, subnetPrefix = subnets.properties.addressPrefix | extend subnetPrefixLength = split(subnetPrefix, '/')[1] | where subnetName == 'GatewaySubnet' | extend compliant = (subnetPrefixLength <= 27) | distinct id, compliant",
            "guid": "f2aad7e3-bb03-4adc-8606-4123d342a917",
            "id": "D08.02",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-howto-add-gateway-resource-manager#add-a-gateway",
            "service": "ExpressRoute",
            "severity": "高い",
            "subcategory": "セグメンテーション",
            "text": "Gateway サブネットに少なくとも /27 プレフィックスを使用する",
            "waf": "安全"
        },
        {
            "category": "ネットワークトポロジと接続性",
            "graph": "resources | where type=='microsoft.network/networksecuritygroups' | mvexpand properties.securityRules | project id,name,ruleAction=properties_securityRules.properties.access,rulePriority=properties_securityRules.properties.priority,ruleDst=properties_securityRules.properties.destinationAddressPrefix,ruleSrc=properties_securityRules.properties.sourceAddressPrefix,ruleProt=properties_securityRules.properties.protocol,ruleDirection=properties_securityRules.properties.direction,rulePort=properties_securityRules.properties.destinationPortRange | summarize StarDenies=countif(ruleAction=='Deny' and ruleDst=='*' and ruleSrc=='*' and ruleProt=='*' and rulePort=='*') by id,tostring(ruleDirection) | where ruleDirection == 'Inbound' | project id,compliant=(StarDenies>0) | union (resources | where type=='microsoft.network/networksecuritygroups' | where array_length(properties.securityRules)==0 | extend compliant=false | project id,compliant)",
            "guid": "11deb39d-8299-4e47-bbe0-0fb5a36318a8",
            "id": "D08.03",
            "link": "https://learn.microsoft.com/azure/virtual-network/service-tags-overview#available-service-tags",
            "service": "NSG",
            "severity": "中程度",
            "subcategory": "セグメンテーション",
            "text": "接続を制限するために、VirtualNetwork サービス タグを使用する NSG 受信の既定の規則に依存しないでください。",
            "waf": "安全"
        },
        {
            "category": "ネットワークトポロジと接続性",
            "guid": "c2447ec6-6138-4a72-80f1-ce16ed301d6e",
            "id": "D08.04",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-landing-zone-network-segmentation",
            "severity": "中程度",
            "subcategory": "セグメンテーション",
            "text": "サブネットの作成をランディングゾーンの所有者に委任します。",
            "training": "https://learn.microsoft.com/learn/paths/implement-resource-mgmt-security/",
            "waf": "安全"
        },
        {
            "category": "ネットワークトポロジと接続性",
            "guid": "872e52e3-611c-4c58-a5a4-b1511e43a58a",
            "id": "D08.05",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "service": "NSG",
            "severity": "中程度",
            "subcategory": "セグメンテーション",
            "text": "NSG を使用して、サブネット間のトラフィックと、プラットフォーム全体の East/West トラフィック (ランディング ゾーン間のトラフィック) を保護します。",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/",
            "waf": "安全"
        },
        {
            "category": "ネットワークトポロジと接続性",
            "graph": "Resources | where type=='microsoft.network/virtualnetworks' | project id,resourceGroup,name,subnets=properties.subnets | mv-expand subnets | project id,name,subnetName=subnets.name,subnetNsg=subnets.properties.networkSecurityGroup | where not (subnetName in ('GatewaySubnet', 'AzureFirewallSubnet', 'RouteServerSubnet', 'AzureBastionSubnet')) | extend compliant = isnotnull(subnetNsg)",
            "guid": "9c2299c4-d7b5-47d0-a655-562f2b3e4563",
            "id": "D08.06",
            "service": "NSG",
            "severity": "中程度",
            "subcategory": "セグメンテーション",
            "text": "アプリケーション チームは、サブネット レベルの NSG でアプリケーション セキュリティ グループを使用して、ランディング ゾーン内の多層 VM を保護する必要があります。",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/",
            "waf": "安全"
        },
        {
            "category": "ネットワークトポロジと接続性",
            "guid": "a4d87397-48b6-462d-9d15-f512a65498f6",
            "id": "D08.07",
            "link": "https://learn.microsoft.com/azure/virtual-network/network-security-group-how-it-works",
            "service": "NSG",
            "severity": "中程度",
            "subcategory": "セグメンテーション",
            "text": "NSG とアプリケーション セキュリティ グループを使用して、ランディング ゾーン内のトラフィックを細かくセグメント化し、中央の NVA を使用してトラフィック フローをフィルター処理しないようにします。",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/",
            "waf": "安全"
        },
        {
            "category": "ネットワークトポロジと接続性",
            "guid": "dfe237de-143b-416c-91d7-aa9b64704489",
            "id": "D08.08",
            "link": "https://learn.microsoft.com/azure/virtual-network/network-security-group-how-it-works",
            "service": "NSG",
            "severity": "中程度",
            "subcategory": "セグメンテーション",
            "text": "VNet フロー ログを有効にして Traffic Analytics にフィードし、内部および外部のトラフィック フローに関する分析情報を取得します。",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-network-monitoring/",
            "waf": "安全"
        },
        {
            "category": "ネットワークトポロジと接続性",
            "guid": "412e7f98-3f63-4047-82dd-69c5b5c2622f",
            "id": "D09.01",
            "link": "https://learn.microsoft.com/azure/virtual-wan/scenario-any-to-any",
            "service": "VWAN",
            "severity": "中程度",
            "subcategory": "仮想WAN",
            "text": "Azure ネットワーク管理を簡素化するために Virtual WAN を検討し、Virtual WAN ルーティング設計の一覧にシナリオが明示的に記述されていることを確認します",
            "training": "https://learn.microsoft.com/learn/modules/introduction-azure-virtual-wan/",
            "waf": "オペレーションズ"
        },
        {
            "category": "ネットワークトポロジと接続性",
            "guid": "54b69bad-33aa-4d5e-ac68-e1d76667313b",
            "id": "D09.02",
            "link": "https://learn.microsoft.com/azure/virtual-wan/virtual-wan-about",
            "service": "VWAN",
            "severity": "中程度",
            "subcategory": "仮想WAN",
            "text": "Azure リージョンごとに Virtual WAN ハブを使用して、共通のグローバル Azure Virtual WAN を介して Azure リージョン間で複数のランディング ゾーンを接続します。",
            "waf": "パフォーマンス"
        },
        {
            "category": "ネットワークトポロジと接続性",
            "guid": "8ac6a9e0-1e6a-483d-b5de-32c199248160",
            "id": "D09.03",
            "link": "https://learn.microsoft.com/azure/virtual-wan/virtual-wan-about",
            "service": "VWAN",
            "severity": "低い",
            "subcategory": "仮想WAN",
            "text": "\"Azure のトラフィックは Azure にとどまる\" という原則に従って、Azure のリソース間の通信が Microsoft バックボーン ネットワーク経由で行われるようにします",
            "waf": "パフォーマンス"
        },
        {
            "category": "ネットワークトポロジと接続性",
            "graph": "resources | where type=='microsoft.network/virtualhubs' | extend compliant = isnotnull(properties.azureFirewall.id) | project id, compliant",
            "guid": "7d5d1e4e-6146-458d-9558-fd77249b8211",
            "id": "D09.04",
            "link": "https://learn.microsoft.com/azure/virtual-wan/virtual-wan-about",
            "service": "VWAN",
            "severity": "中程度",
            "subcategory": "仮想WAN",
            "text": "送信インターネット トラフィックの保護とフィルター処理を行うには、セキュリティで保護されたハブに Azure Firewall をデプロイします",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "安全"
        },
        {
            "category": "ネットワークトポロジと接続性",
            "guid": "6667313b-4f56-464b-9e98-4a859c773e7d",
            "id": "D09.05",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits",
            "service": "VWAN",
            "severity": "中程度",
            "subcategory": "仮想WAN",
            "text": "ネットワーク アーキテクチャが Azure Virtual WAN の制限内にあることを確認します。",
            "waf": "確実"
        },
        {
            "category": "ネットワークトポロジと接続性",
            "guid": "261623a7-65a9-417e-8f34-8ef254c27d42",
            "id": "D09.06",
            "link": "https://learn.microsoft.com/azure/virtual-wan/azure-monitor-insights",
            "service": "VWAN",
            "severity": "中程度",
            "subcategory": "仮想WAN",
            "text": "Azure Monitor Insights for Virtual WAN を使用して、Virtual WAN のエンドツーエンドのトポロジ、状態、主要なメトリックを監視します。",
            "waf": "オペレーションズ"
        },
        {
            "category": "ネットワークトポロジと接続性",
            "guid": "727c77e1-b9aa-4a37-a024-129d042422c1",
            "id": "D09.07",
            "link": "https://learn.microsoft.com/azure/virtual-wan/virtual-wan-faq#is-branch-to-branch-connectivity-allowed-in-virtual-wan",
            "service": "VWAN",
            "severity": "中程度",
            "subcategory": "仮想WAN",
            "text": "IaC デプロイで、これらのフローを明示的にブロックする必要がない限り、Virtual WAN のブランチ間トラフィックが無効にならないようにしてください。",
            "waf": "確実"
        },
        {
            "category": "ネットワークトポロジと接続性",
            "guid": "d49ac006-6670-4bc9-9948-d3e0a3a94f4d",
            "id": "D09.08",
            "link": "https://learn.microsoft.com/azure/virtual-wan/about-virtual-hub-routing-preference",
            "service": "VWAN",
            "severity": "中程度",
            "subcategory": "仮想WAN",
            "text": "AS-Path は ExpressRoute や VPN よりも柔軟性が高いため、ハブ ルーティングの基本設定として使用します。",
            "waf": "確実"
        },
        {
            "category": "ネットワークトポロジと接続性",
            "guid": "2586b854-237e-47f1-84a1-d45d4cd2310d",
            "id": "D09.09",
            "link": "https://learn.microsoft.com/azure/virtual-wan/about-virtual-hub-routing#labels",
            "service": "VWAN",
            "severity": "中程度",
            "subcategory": "仮想WAN",
            "text": "IaC デプロイで Virtual WAN でラベルベースの伝達が構成されていることを確認すると、仮想ハブ間の接続が損なわれます。",
            "waf": "確実"
        },
        {
            "ammp": true,
            "category": "ネットワークトポロジと接続性",
            "guid": "9c75dfef-573c-461c-a698-68598595581a",
            "id": "D09.10",
            "link": "https://learn.microsoft.com/azure/virtual-wan/virtual-wan-faq#what-is-the-recommended-hub-address-space-during-hub-creation",
            "service": "VWAN",
            "severity": "高い",
            "subcategory": "仮想WAN",
            "text": "仮想ハブに十分な IP 空間 (理想的には /23 プレフィックス) を割り当てます。",
            "waf": "確実"
        },
        {
            "ammp": true,
            "category": "統治",
            "guid": "5c986cb2-9131-456a-8247-6e49f541acdc",
            "id": "E01.01",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "service": "Policy",
            "severity": "高い",
            "subcategory": "統治",
            "text": "Azure Policy を戦略的に活用し、環境の制御を定義し、ポリシー イニシアチブを使用して関連するポリシーをグループ化します。",
            "waf": "安全"
        },
        {
            "category": "統治",
            "guid": "e979377b-cdb3-4751-ab2a-b13ada6e55d7",
            "id": "E01.02",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/naming-and-tagging",
            "service": "Policy",
            "severity": "中程度",
            "subcategory": "統治",
            "text": "必要な Azure タグを特定し、\"追加\" ポリシー モードを使用して、Azure Policy を介して使用を強制します。",
            "waf": "安全"
        },
        {
            "category": "統治",
            "guid": "d8a2adb1-17d6-4326-af62-5ca44e5695f2",
            "id": "E01.03",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "service": "Policy",
            "severity": "中程度",
            "subcategory": "統治",
            "text": "規制とコンプライアンスの要件を Azure Policy の定義と Azure ロールの割り当てにマップします。",
            "waf": "安全"
        },
        {
            "category": "統治",
            "guid": "223ace8c-b123-408c-a501-7f154e3ab369",
            "id": "E01.04",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "service": "Policy",
            "severity": "中程度",
            "subcategory": "統治",
            "text": "中間ルート管理グループで Azure Policy 定義を確立し、継承されたスコープで割り当てられるようにする",
            "waf": "安全"
        },
        {
            "category": "統治",
            "guid": "3829e7e3-1618-4368-9a04-77a209945bda",
            "id": "E01.05",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "service": "Policy",
            "severity": "中程度",
            "subcategory": "統治",
            "text": "必要に応じて、ポリシーの割り当てを最下位レベルで管理し、最下位レベルで除外します。",
            "waf": "安全"
        },
        {
            "category": "統治",
            "guid": "43334f24-9116-4341-a2ba-527526944008",
            "id": "E01.06",
            "link": "https://learn.microsoft.com/security/benchmark/azure/mcsb-asset-management#am-2-use-only-approved-services",
            "service": "Policy",
            "severity": "低い",
            "subcategory": "統治",
            "text": "Azure Policy を使用して、ユーザーがサブスクリプション/管理グループ レベルでプロビジョニングできるサービスを制御する",
            "waf": "安全"
        },
        {
            "category": "統治",
            "guid": "be7d7e48-4327-46d8-adc0-55bcf619e8a1",
            "id": "E01.07",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "service": "Policy",
            "severity": "中程度",
            "subcategory": "統治",
            "text": "可能な場合は組み込みのポリシーを使用して、運用上のオーバーヘッドを最小限に抑えます。",
            "waf": "安全"
        },
        {
            "category": "統治",
            "description": "リソース ポリシー共同作成者ロールを特定のスコープに割り当てると、ポリシー管理を関連するチームに委任できます。たとえば、中央の IT チームが管理グループ レベルのポリシーを監督し、アプリケーション チームがサブスクリプションのポリシーを処理することで、組織の標準に準拠した分散ガバナンスが可能になります。",
            "guid": "3f988795-25d6-4268-a6d7-0ba6c97be995",
            "id": "E01.08",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview#azure-rbac-permissions-in-azure-policy",
            "service": "Policy",
            "severity": "中程度",
            "subcategory": "統治",
            "text": "組み込みのリソース ポリシー共同作成者ロールを特定のスコープで割り当てて、アプリケーション レベルのガバナンスを有効にします。",
            "waf": "安全"
        },
        {
            "category": "統治",
            "guid": "19048384-5c98-46cb-8913-156a12476e49",
            "id": "E01.09",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "service": "Policy",
            "severity": "中程度",
            "subcategory": "統治",
            "text": "ルート管理グループのスコープで行われる Azure Policy 割り当ての数を制限して、継承されたスコープでの除外による管理を回避します。",
            "waf": "安全"
        },
        {
            "category": "統治",
            "guid": "5a917e1f-348e-4f25-9c27-d42e8bbac757",
            "id": "E01.10",
            "link": "https://azure.microsoft.com/resources/achieving-compliant-data-residency-and-security-with-azure/",
            "service": "Policy",
            "severity": "中程度",
            "subcategory": "統治",
            "text": "データ主権の要件が存在する場合は、Azure ポリシーをデプロイして適用できます",
            "training": "https://learn.microsoft.com/learn/paths/secure-your-cloud-data/",
            "waf": "安全"
        },
        {
            "category": "統治",
            "guid": "78b22132-b41c-460b-a4d3-df8f73a67dc2",
            "id": "E01.11",
            "link": "https://github.com/Azure/sovereign-landing-zone/blob/main/docs/scenarios/Sovereignty-Policy-Baseline.md",
            "service": "Policy",
            "severity": "中程度",
            "subcategory": "統治",
            "text": "ソブリン・ランディング・ゾーンの場合、主権ポリシー・ベースラインのポリシー・イニシアチブがデプロイされ、正しいMGレベルで割り当てられます。",
            "waf": "安全"
        },
        {
            "category": "統治",
            "guid": "caeea0e9-1024-41df-a52e-d99c3f22a6f4",
            "id": "E01.12",
            "link": "https://learn.microsoft.com/en-us/industry/sovereignty/policy-portfolio-baseline",
            "service": "Policy",
            "severity": "中程度",
            "subcategory": "統治",
            "text": "ソブリン・ランディング・ゾーンについては、ソブリン制御の目標とポリシー・マッピングが文書化されています。",
            "waf": "安全"
        },
        {
            "category": "統治",
            "guid": "9b461617-db7b-4399-8ac6-d4eb7153893a",
            "id": "E01.13",
            "service": "Policy",
            "severity": "中程度",
            "subcategory": "統治",
            "text": "ソブリン ランディング ゾーンでは、\"ソブリン制御の目標からポリシー マッピング\" の CRUD のプロセスが導入されています。",
            "waf": "安全"
        },
        {
            "category": "統治",
            "guid": "9b5e2a28-9823-4faf-ab7e-afa5f6c57221",
            "id": "E02.01",
            "link": "https://learn.microsoft.com/azure/automation/automation-solution-vm-management-config",
            "service": "VM",
            "severity": "低い",
            "subcategory": "クラウドへの投資を最適化",
            "text": "コストを節約するために、環境内の VM を開始/停止するために、自動化タグの使用を検討してください。",
            "waf": "安全"
        },
        {
            "category": "管理",
            "guid": "ecdc7506-6f37-4ea9-be87-fc5d3df08a64",
            "id": "E02.01",
            "link": "https://learn.microsoft.com/azure/virtual-machine-scale-sets/overview",
            "service": "VMSS",
            "severity": "中程度",
            "subcategory": "拡張性",
            "text": "Azure Virtual Machine スケール セットを活用して、負荷に基づいてスケールインおよびスケールアウトします。",
            "waf": "確実"
        },
        {
            "category": "統治",
            "guid": "29fd366b-a180-452b-9bd7-954b7700c667",
            "id": "E02.02",
            "link": "https://learn.microsoft.com/azure/cost-management-billing/costs/tutorial-acm-create-budgets?bc=%2Fazure%2Fcloud-adoption-framework%2F_bread%2Ftoc.json&toc=%2Fazure%2Fcloud-adoption-framework%2Ftoc.json",
            "severity": "中程度",
            "subcategory": "クラウドへの投資を最適化",
            "text": "「実績」と「予測」の予算アラートを設定します。",
            "waf": "費用"
        },
        {
            "ammp": true,
            "category": "管理",
            "guid": "89cc5e11-aa4d-4c3b-893d-feb99215266a",
            "id": "F01.01",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#add-diagnostic-settings-to-save-your-wafs-logs",
            "service": "WAF",
            "severity": "高い",
            "subcategory": "アプリ配信",
            "text": "診断設定を追加して、Azure Front Door や Azure Application Gateway などのアプリケーション配信サービスから WAF ログを保存します。ログを定期的に確認して、攻撃や誤検知がないか確認します。",
            "waf": "オペレーションズ"
        },
        {
            "category": "管理",
            "guid": "7f408960-c626-44cb-a018-347c8d790cdf",
            "id": "F01.02",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#send-logs-to-microsoft-sentinel",
            "service": "WAF",
            "severity": "中程度",
            "subcategory": "アプリ配信",
            "text": "Azure Front Door や Azure Application Gateway などのアプリケーション配信サービスから Microsoft Sentinel に WAF ログを送信します。攻撃を検出し、WAF テレメトリを Azure 環境全体に統合します。",
            "waf": "オペレーションズ"
        },
        {
            "category": "管理",
            "guid": "7ea02e1c-7166-45a3-bdf5-098891367fcb",
            "id": "F02.01",
            "link": "https://learn.microsoft.com/azure/reliability/cross-region-replication-azure",
            "severity": "中程度",
            "subcategory": "データ保護",
            "text": "ペアのリージョンを持つ BCDR の Azure でのリージョン間レプリケーションを検討する",
            "waf": "確実"
        },
        {
            "category": "管理",
            "guid": "eba8cf22-45c6-4dc1-9b57-2cceb3b97ce5",
            "id": "F02.02",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-redundancy",
            "service": "Backup",
            "severity": "中程度",
            "subcategory": "データ保護",
            "text": "Azure Backup を使用する場合は、既定の設定が GRS であるため、さまざまなバックアップの種類 (GRS、ZRS、LRS) を考慮してください",
            "waf": "確実"
        },
        {
            "category": "管理",
            "guid": "67e7a8ed-4b30-4e38-a3f2-9812b2363cef",
            "id": "F03.01",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/design-logs-deployment",
            "service": "Monitor",
            "severity": "中程度",
            "subcategory": "モニタリング",
            "text": "Azure ロールベースのアクセス制御 (Azure RBAC)、データ主権要件、またはデータ保持ポリシーで個別のワークスペースが義務付けられている場合を除き、1 つのモニター ログ ワークスペースを使用してプラットフォームを一元的に管理します。",
            "training": "https://learn.microsoft.com/azure/azure-monitor/logs/design-logs-deployment",
            "waf": "オペレーションズ"
        },
        {
            "category": "管理",
            "guid": "e179b599-de0d-4597-9cd4-cd21b088137f",
            "id": "F03.02",
            "severity": "中程度",
            "subcategory": "モニタリング",
            "text": "ランディング・ゾーンが文書化されていることを確認します。",
            "waf": "オペレーションズ"
        },
        {
            "category": "管理",
            "guid": "5e6c4cfd-3e50-4454-9c24-47ec66138a72",
            "id": "F03.03",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/data-retention-archive?tabs=portal-1%2Cportal-2#how-retention-and-archiving-work",
            "service": "Monitor",
            "severity": "中程度",
            "subcategory": "モニタリング",
            "text": "Azure Monitor ログは、ログの保持要件が 2 年を超える場合に使用します。現在、データをアーカイブ状態に保持できる期間は最大 7 年間です。",
            "training": "https://learn.microsoft.com/learn/paths/architect-infrastructure-operations/",
            "waf": "オペレーションズ"
        },
        {
            "category": "管理",
            "guid": "00f1ce16-ed30-41d6-b872-e52e3611cc58",
            "id": "F03.04",
            "link": "https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/govern/policy-compliance/regulatory-compliance",
            "service": "Policy",
            "severity": "中程度",
            "subcategory": "モニタリング",
            "text": "アクセス制御とコンプライアンス レポートに Azure Policy を使用します。Azure Policy には、一貫したポリシーの遵守と迅速な違反検出を保証するために、組織全体の設定を適用する機能が用意されています。",
            "training": "https://learn.microsoft.com/en-us/azure/governance/policy/concepts/effects",
            "waf": "オペレーションズ"
        },
        {
            "category": "管理",
            "guid": "e7d7e484-3276-4d8b-bc05-5bcf619e8a13",
            "id": "F03.05",
            "link": "https://learn.microsoft.com/azure/governance/policy/how-to/guest-configuration-create",
            "service": "VM",
            "severity": "中程度",
            "subcategory": "モニタリング",
            "text": "Azure Policy を使用して、ゲスト内の仮想マシン (VM) の構成のずれを監視します。ポリシーを使用してゲスト構成監査機能を有効にすると、アプリケーション チームのワークロードは、ほとんど労力をかけずに機能をすぐに使用できます。",
            "training": "https://learn.microsoft.com/learn/paths/implement-resource-mgmt-security/",
            "waf": "オペレーションズ"
        },
        {
            "category": "管理",
            "guid": "f9887952-5d62-4688-9d70-ba6c97be9951",
            "id": "F03.06",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/management-operational-compliance#update-management-considerations ",
            "service": "VM",
            "severity": "中程度",
            "subcategory": "運用コンプライアンス",
            "text": "Azure Update Manager を、Azure の Windows および Linux VM の修正プログラムの適用メカニズムとして使用します。",
            "training": "https://learn.microsoft.com/azure/update-manager/overview?tabs=azure-vms",
            "waf": "オペレーションズ"
        },
        {
            "category": "管理",
            "guid": "c806c048-26b7-4ddf-b4c2-b4f0c476925d",
            "id": "F03.07",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/management-operational-compliance#update-management-considerations ",
            "service": "VM",
            "severity": "中程度",
            "subcategory": "運用コンプライアンス",
            "text": "Azure Arc を使用して、Azure の外部にある Windows および Linux VM の修正プログラムの適用メカニズムとして Azure Update Manager を使用します。",
            "training": "https://learn.microsoft.com/azure/update-manager/overview?tabs=azure-vms",
            "waf": "オペレーションズ"
        },
        {
            "category": "管理",
            "guid": "90483845-c986-4cb2-a131-56a12476e49f",
            "id": "F03.08",
            "link": "https://learn.microsoft.com/azure/network-watcher/network-watcher-monitoring-overview",
            "service": "Network Watcher",
            "severity": "中程度",
            "subcategory": "モニタリング",
            "text": "Network Watcher を使用してトラフィック フローをプロアクティブに監視する",
            "training": "https://learn.microsoft.com/learn/modules/configure-network-watcher/",
            "waf": "オペレーションズ"
        },
        {
            "category": "管理",
            "guid": "541acdce-9793-477b-adb3-751ab2ab13ad",
            "id": "F03.09",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/lock-resources?tabs=json",
            "severity": "中程度",
            "subcategory": "モニタリング",
            "text": "リソースロックを使用して、重要な共有サービスが誤って削除されないようにします。",
            "training": "https://learn.microsoft.com/learn/paths/implement-resource-mgmt-security/",
            "waf": "オペレーションズ"
        },
        {
            "category": "管理",
            "guid": "a6e55d7d-8a2a-4db1-87d6-326af625ca44",
            "id": "F03.10",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "severity": "低い",
            "subcategory": "モニタリング",
            "text": "拒否ポリシーを使用して、Azure ロールの割り当てを補完します。拒否ポリシーと Azure ロールの割り当てを組み合わせることで、リソースをデプロイおよび構成できるユーザーと、そのユーザーがデプロイおよび構成できるリソースを適用するための適切なガードレールが確実に配置されます。",
            "waf": "オペレーションズ"
        },
        {
            "category": "管理",
            "guid": "e5695f22-23ac-4e8c-a123-08ca5017f154",
            "id": "F03.11",
            "link": "https://learn.microsoft.com/azure/service-health/alerts-activity-log-service-notifications-portal",
            "severity": "中程度",
            "subcategory": "モニタリング",
            "text": "サービスとリソースの正常性イベントを、プラットフォーム全体の監視ソリューションの一部として含めます。プラットフォームの観点からサービスとリソースの正常性を追跡することは、Azure でのリソース管理の重要なコンポーネントです。",
            "waf": "オペレーションズ"
        },
        {
            "category": "管理",
            "guid": "d5f345bf-97ab-41a7-819c-6104baa7d48c",
            "id": "F03.12",
            "link": "https://learn.microsoft.com/azure/azure-monitor/alerts/action-groups",
            "severity": "中程度",
            "subcategory": "モニタリング",
            "text": "アラートとアクション グループを Azure Service Health プラットフォームの一部として含め、アラートまたは問題に確実に対処できるようにします",
            "waf": "オペレーションズ"
        },
        {
            "category": "管理",
            "guid": "e3ab3693-829e-47e3-8618-3687a0477a20",
            "id": "F03.13",
            "link": "https://learn.microsoft.com/azure/sentinel/quickstart-onboard",
            "severity": "中程度",
            "subcategory": "モニタリング",
            "text": "未加工のログ エントリをオンプレミスの監視システムに送り返さないでください。代わりに、Azure で生成されたデータは Azure にとどまるという原則を採用します。オンプレミスの SIEM 統合が必要な場合は、ログではなく重要なアラートを送信します。",
            "waf": "オペレーションズ"
        },
        {
            "category": "管理",
            "guid": "9945bda4-3334-4f24-a116-34182ba52752",
            "id": "F03.14",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/design-logs-deployment",
            "service": "Monitor",
            "severity": "中程度",
            "subcategory": "モニタリング",
            "text": "一元化された Azure Monitor Log Analytics ワークスペースを使用して、IaaS および PaaS アプリケーション リソースからログとメトリックを収集し、Azure RBAC でログ アクセスを制御します。",
            "waf": "オペレーションズ"
        },
        {
            "category": "管理",
            "guid": "6944008b-e7d7-4e48-9327-6d8bdc055bcf",
            "id": "F03.15",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-setup-guide/monitoring-reporting?tabs=AzureMonitor",
            "service": "Monitor",
            "severity": "中程度",
            "subcategory": "モニタリング",
            "text": "分析情報とレポートには Azure Monitor ログを使用します。",
            "waf": "オペレーションズ"
        },
        {
            "category": "管理",
            "guid": "619e8a13-f988-4795-85d6-26886d70ba6c",
            "id": "F03.16",
            "link": "https://learn.microsoft.com/azure/azure-monitor/agents/diagnostics-extension-overview",
            "severity": "中程度",
            "subcategory": "モニタリング",
            "text": "必要に応じて、ランディング ゾーン内の共有ストレージ アカウントを Azure 診断拡張機能のログ ストレージに使用します。",
            "waf": "オペレーションズ"
        },
        {
            "category": "管理",
            "guid": "97be9951-9048-4384-9c98-6cb2913156a1",
            "id": "F03.17",
            "link": "https://learn.microsoft.com/azure/azure-monitor/alerts/alerts-overview",
            "service": "Monitor",
            "severity": "中程度",
            "subcategory": "モニタリング",
            "text": "運用アラートの生成には、Azure Monitor アラートを使用します。",
            "waf": "オペレーションズ"
        },
        {
            "category": "管理",
            "guid": "859c3900-4514-41eb-b010-475d695abd74",
            "id": "F03.18",
            "link": "https://learn.microsoft.com/azure/architecture/best-practices/monitoring",
            "severity": "中程度",
            "subcategory": "モニタリング",
            "text": "監視要件が評価され、適切なデータ収集とアラートの構成が適用されていることを確認します",
            "waf": "オペレーションズ"
        },
        {
            "category": "管理",
            "guid": "fed3c55f-a67e-4875-aadd-3aba3f9fde31",
            "id": "F03.19",
            "link": "https://learn.microsoft.com/azure/automation/how-to/region-mappings",
            "service": "Monitor",
            "severity": "中程度",
            "subcategory": "モニタリング",
            "text": "Azure Automation アカウントを介して変更とインベントリの追跡を使用する場合は、Log Analytics ワークスペースと Automation アカウントをリンクするためにサポートされているリージョンを選択していることを確認してください。",
            "waf": "オペレーションズ"
        },
        {
            "category": "管理",
            "guid": "f541acdc-e979-4377-acdb-3751ab2ab13a",
            "id": "F04.01",
            "link": "https://learn.microsoft.com/azure/governance/policy/concepts/guest-configuration",
            "service": "VM",
            "severity": "中程度",
            "subcategory": "運用コンプライアンス",
            "text": "Azure ポリシーを使用して、VM 拡張機能を通じてソフトウェア構成を自動的にデプロイし、準拠したベースライン VM 構成を適用します。",
            "waf": "安全"
        },
        {
            "category": "管理",
            "description": "Azure Policy のゲスト構成機能では、マシンの設定 (OS、アプリケーション、環境など) を監査して修復し、リソースが想定される構成と一致していることを確認できます。",
            "guid": "da6e55d7-d8a2-4adb-817d-6326af625ca4",
            "id": "F04.02",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/management-operational-compliance#monitoring-for-configuration-drift",
            "service": "VM",
            "severity": "中程度",
            "subcategory": "運用コンプライアンス",
            "text": "VM のセキュリティ構成のドリフトを Azure Policy で監視します。",
            "waf": "安全"
        },
        {
            "category": "管理",
            "guid": "2476e49f-541a-4cdc-b979-377bcdb3751a",
            "id": "F05.01",
            "link": "https://learn.microsoft.com/azure/site-recovery/site-recovery-overview",
            "service": "VM",
            "severity": "中程度",
            "subcategory": "保護とリカバリ",
            "text": "Azure から Azure Virtual Machines へのディザスター リカバリー シナリオには、Azure Site Recovery を使用します。これにより、リージョン間でワークロードをレプリケートできます。",
            "waf": "オペレーションズ"
        },
        {
            "category": "管理",
            "guid": "b2ab13ad-a6e5-45d7-b8a2-adb117d6326a",
            "id": "F05.02",
            "link": "https://learn.microsoft.com/azure/architecture/framework/resiliency/backup-and-recovery",
            "severity": "中程度",
            "subcategory": "保護とリカバリ",
            "text": "ネイティブの PaaS サービスのディザスター リカバリー機能を使用し、テストしてください。",
            "waf": "オペレーションズ"
        },
        {
            "category": "管理",
            "guid": "f625ca44-e569-45f2-823a-ce8cb12308ca",
            "id": "F05.03",
            "link": "https://learn.microsoft.com/azure/backup/backup-center-overview",
            "service": "Backup",
            "severity": "中程度",
            "subcategory": "保護とリカバリ",
            "text": "Azure ネイティブのバックアップ機能、または Azure 互換のサード パーティのバックアップ ソリューションを使用します。",
            "waf": "オペレーションズ"
        },
        {
            "ammp": true,
            "category": "管理",
            "guid": "826c5c45-bb79-4951-a812-e3bfbfd7326b",
            "id": "F06.01",
            "link": "https://learn.microsoft.com/azure/reliability/availability-zones-overview",
            "service": "VM",
            "severity": "高い",
            "subcategory": "フォールトトレランス",
            "text": "Availability Zones は、サポートされているリージョンの VM に活用します。",
            "waf": "確実"
        },
        {
            "ammp": true,
            "category": "管理",
            "guid": "7ccb7c06-5511-42df-8177-d97f08d0337d",
            "id": "F06.02",
            "link": "https://learn.microsoft.com/azure/virtual-machines/availability",
            "service": "VM",
            "severity": "高い",
            "subcategory": "フォールトトレランス",
            "text": "運用ワークロードを 1 つの VM で実行することは避けてください。",
            "waf": "確実"
        },
        {
            "category": "管理",
            "guid": "84101f59-1941-4195-a270-e28034290e3a",
            "id": "F06.03",
            "link": "https://learn.microsoft.com/azure/load-balancer/load-balancer-overview",
            "service": "VM",
            "severity": "中程度",
            "subcategory": "フォールトトレランス",
            "text": "Azure Load Balancer と Application Gateway は、受信ネットワーク トラフィックを複数のリソースに分散します。",
            "waf": "確実"
        },
        {
            "category": "安全",
            "guid": "b86ad884-08e3-4727-94b8-75ba18f20459",
            "id": "G01.01",
            "link": "https://learn.microsoft.com/security/benchmark/azure/security-control-incident-response",
            "severity": "中程度",
            "subcategory": "アクセス制御",
            "text": "運用環境に導入する前に、Azure サービスのインシデント対応計画を決定します。",
            "waf": "安全"
        },
        {
            "category": "安全",
            "guid": "01365d38-e43f-49cc-ad86-8266abca264f",
            "id": "G01.02",
            "link": "https://www.microsoft.com/security/business/zero-trust",
            "severity": "中程度",
            "subcategory": "アクセス制御",
            "text": "必要に応じて、Azure プラットフォームへのアクセスにゼロトラスト アプローチを実装します。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "category": "安全",
            "guid": "5017f154-e3ab-4369-9829-e7e316183687",
            "id": "G02.01",
            "link": "https://learn.microsoft.com/azure/key-vault/general/overview",
            "service": "Key Vault",
            "severity": "高い",
            "subcategory": "暗号化とキー",
            "text": "Azure Key Vault を使用してシークレットと資格情報を格納する",
            "waf": "安全"
        },
        {
            "category": "安全",
            "graph": "ResourceContainers | where type=='microsoft.resources/subscriptions'| parse id with '/subscriptions/' SubscriptionID| project subscriptionId, SubscriptionName = name| join kind=leftouter (Resources| where type == 'microsoft.keyvault/vaults'| project id, name, subscriptionId) on subscriptionId| join kind= leftouter (Resources| where type == 'microsoft.keyvault/vaults'| summarize ResourceCount = count() by subscriptionId) on subscriptionId| extend RCount = iff(isnull(ResourceCount), 0, ResourceCount)| project-away ResourceCount| extend compliant = (RCount <> 1)",
            "guid": "a0477a20-9945-4bda-9333-4f2491163418",
            "id": "G02.02",
            "link": "https://learn.microsoft.com/azure/key-vault/general/overview-throttling",
            "service": "Key Vault",
            "severity": "中程度",
            "subcategory": "暗号化とキー",
            "text": "アプリケーションやリージョンごとに異なる Azure Key Vault を使用して、トランザクションのスケール制限を回避し、シークレットへのアクセスを制限します。",
            "waf": "安全"
        },
        {
            "category": "安全",
            "guid": "2ba52752-6944-4008-ae7d-7e4843276d8b",
            "id": "G02.03",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "severity": "中程度",
            "subcategory": "暗号化とキー",
            "text": "論理的な削除ポリシーと消去ポリシーを有効にして Azure Key Vault をプロビジョニングし、削除されたオブジェクトの保持保護を許可します。",
            "waf": "安全"
        },
        {
            "category": "安全",
            "guid": "dc055bcf-619e-48a1-9f98-879525d62688",
            "id": "G02.04",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "severity": "中程度",
            "subcategory": "暗号化とキー",
            "text": "最小特権モデルに従って、キー、シークレット、証明書を完全に削除する承認を特殊なカスタム Microsoft Entra ID ロールに制限します。",
            "waf": "安全"
        },
        {
            "category": "安全",
            "guid": "6d70ba6c-97be-4995-8904-83845c986cb2",
            "id": "G02.05",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "severity": "中程度",
            "subcategory": "暗号化とキー",
            "text": "公的認証局による証明書の管理と更新プロセスを自動化し、管理を容易にします。",
            "waf": "安全"
        },
        {
            "category": "安全",
            "guid": "913156a1-2476-4e49-b541-acdce979377b",
            "id": "G02.06",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "severity": "中程度",
            "subcategory": "暗号化とキー",
            "text": "キーと証明書のローテーションの自動化されたプロセスを確立します。",
            "waf": "安全"
        },
        {
            "category": "安全",
            "guid": "cdb3751a-b2ab-413a-ba6e-55d7d8a2adb1",
            "id": "G02.07",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "severity": "中程度",
            "subcategory": "暗号化とキー",
            "text": "コンテナーでファイアウォールと仮想ネットワーク サービス エンドポイントまたはプライベート エンドポイントを有効にして、キー コンテナーへのアクセスを制御します。",
            "waf": "安全"
        },
        {
            "category": "安全",
            "guid": "17d6326a-f625-4ca4-9e56-95f2223ace8c",
            "id": "G02.08",
            "link": "https://learn.microsoft.com/azure/key-vault/general/monitor-key-vault",
            "service": "Key Vault",
            "severity": "中程度",
            "subcategory": "暗号化とキー",
            "text": "プラットフォーム中央の Azure Monitor Log Analytics ワークスペースを使用して、Key Vault の各インスタンス内のキー、証明書、シークレットの使用状況を監査します。",
            "waf": "安全"
        },
        {
            "category": "安全",
            "guid": "b12308ca-5017-4f15-9e3a-b3693829e7e3",
            "id": "G02.09",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "severity": "中程度",
            "subcategory": "暗号化とキー",
            "text": "Key Vault のインスタンス化と特権アクセスを委任し、Azure Policy を使用して一貫性のある準拠構成を適用します。",
            "waf": "安全"
        },
        {
            "category": "安全",
            "guid": "16183687-a047-47a2-8994-5bda43334f24",
            "id": "G02.10",
            "link": "https://learn.microsoft.com/azure/security/fundamentals/encryption-atrest",
            "severity": "中程度",
            "subcategory": "暗号化とキー",
            "text": "プリンシパル暗号化機能には既定で Microsoft マネージド キーを使用し、必要に応じてカスタマー マネージド キーを使用します。",
            "waf": "安全"
        },
        {
            "category": "安全",
            "guid": "91163418-2ba5-4275-8694-4008be7d7e48",
            "id": "G02.11",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "severity": "中程度",
            "subcategory": "暗号化とキー",
            "text": "Azure Key Vault は、アプリケーションごと、環境ごと、リージョンごとに使用します。",
            "waf": "安全"
        },
        {
            "category": "安全",
            "guid": "25d62688-6d70-4ba6-a97b-e99519048384",
            "id": "G02.12",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "severity": "中程度",
            "subcategory": "暗号化とキー",
            "text": "独自のキーを持ち込む場合、これは考慮されているすべてのサービスでサポートされていない可能性があります。不整合が望ましい結果を妨げないように、関連する軽減策を実装します。待機時間を最小限に抑える適切なリージョン ペアとディザスター リカバリー リージョンを選択します。",
            "waf": "安全"
        },
        {
            "category": "安全",
            "guid": "4ac6b67c-b3a4-4ff9-8e87-b07a7ce7bbdb",
            "id": "G02.13",
            "link": "https://learn.microsoft.com/en-us/industry/sovereignty/key-management",
            "service": "Key Vault",
            "severity": "中程度",
            "subcategory": "暗号化とキー",
            "text": "ソブリン ランディング ゾーンの場合は、Azure Key Vault マネージド HSM を使用してシークレットと資格情報を格納します。",
            "waf": "安全"
        },
        {
            "category": "安全",
            "guid": "4e5695f2-223a-4ce8-ab12-308ca5017f15",
            "id": "G03.01",
            "link": "https://learn.microsoft.com/azure/active-directory/reports-monitoring/overview-reports",
            "service": "Entra",
            "severity": "中程度",
            "subcategory": "オペレーションズ",
            "text": "Microsoft Entra ID レポート機能を使用して、アクセス制御監査レポートを生成します。",
            "waf": "安全"
        },
        {
            "category": "安全",
            "guid": "4e3ab369-3829-4e7e-9161-83687a0477a2",
            "id": "G03.02",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/logs-data-export?tabs=portal",
            "severity": "中程度",
            "subcategory": "オペレーションズ",
            "text": "Azure アクティビティ ログを Azure Monitor ログにエクスポートして、データを長期間保持します。必要に応じて、2 年を超える長期保存のために Azure Storage にエクスポートします。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "category": "安全",
            "guid": "09945bda-4333-44f2-9911-634182ba5275",
            "id": "G03.03",
            "link": "https://learn.microsoft.com/azure/defender-for-cloud/concept-cloud-security-posture-management",
            "service": "Defender",
            "severity": "高い",
            "subcategory": "オペレーションズ",
            "text": "すべてのサブスクリプションに対して Defender Cloud Security Posture Management を有効にします。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "category": "安全",
            "guid": "36a72a48-fffe-4c40-9747-0ab5064355ba",
            "id": "G03.04",
            "link": "https://learn.microsoft.com/azure/defender-for-cloud/plan-defender-for-servers-select-plan",
            "service": "Defender",
            "severity": "高い",
            "subcategory": "オペレーションズ",
            "text": "すべてのサブスクリプションでサーバーに対して Defender Cloud ワークロード保護プランを有効にします。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "category": "安全",
            "guid": "77425f48-ecba-43a0-aeac-a3ac733ccc6a",
            "id": "G03.05",
            "link": "https://www.microsoft.com/en-gb/security/business/solutions/cloud-workload-protection",
            "service": "Defender",
            "severity": "高い",
            "subcategory": "オペレーションズ",
            "text": "すべてのサブスクリプションで Azure リソースの Defender Cloud Workload Protection プランを有効にします。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "category": "安全",
            "guid": "24d96b30-61ee-4436-a1cc-d6ef08bc574b",
            "id": "G03.06",
            "link": "https://learn.microsoft.com/mem/configmgr/protect/deploy-use/endpoint-protection",
            "service": "VM",
            "severity": "高い",
            "subcategory": "オペレーションズ",
            "text": "IaaS サーバーで Endpoint Protection を有効にします。",
            "waf": "安全"
        },
        {
            "category": "安全",
            "guid": "15833ee7-ad6c-46d3-9331-65c7acbe44ab",
            "id": "G03.07",
            "link": "https://learn.microsoft.com/azure/security-center/",
            "service": "VM",
            "severity": "中程度",
            "subcategory": "オペレーションズ",
            "text": "Azure Monitor ログと Defender for Cloud を使用して、基本オペレーティング システムの修正プログラムの適用誤差を監視します。",
            "waf": "安全"
        },
        {
            "category": "安全",
            "guid": "e5f8d79f-2e87-4768-924c-516775c6ea95",
            "id": "G03.08",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/design-logs-deployment",
            "service": "Monitor",
            "severity": "中程度",
            "subcategory": "オペレーションズ",
            "text": "既定のリソース構成を一元化された Azure Monitor Log Analytics ワークスペースに接続します。",
            "waf": "安全"
        },
        {
            "category": "安全",
            "guid": "1761e147-f65e-4d09-bbc2-f464f23e2eba",
            "id": "G03.09",
            "link": "https://learn.microsoft.com/en-us/industry/sovereignty/transparency-logs",
            "service": "Entra",
            "severity": "中程度",
            "subcategory": "オペレーションズ",
            "text": "ソブリン ランディング ゾーンの場合、透過性ログは Entra ID テナントで有効になっています。",
            "waf": "安全"
        },
        {
            "category": "安全",
            "guid": "d21a922d-5ca7-427a-82a6-35f7b21f1bfc",
            "id": "G03.10",
            "link": "https://learn.microsoft.com/en-us/azure/security/fundamentals/customer-lockbox-overview",
            "service": "Entra",
            "severity": "中程度",
            "subcategory": "オペレーションズ",
            "text": "ソブリン ランディング ゾーンの場合、Entra ID テナントでカスタマー ロックボックスが有効になっています。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "category": "安全",
            "guid": "b03ed428-4617-4067-a787-85468b9ccf3f",
            "id": "G04.01",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-require-secure-transfer",
            "service": "Storage",
            "severity": "高い",
            "subcategory": "概要",
            "text": "ストレージ アカウントへの安全な転送を有効にする必要がある",
            "waf": "安全"
        },
        {
            "ammp": true,
            "category": "安全",
            "guid": "159aac9f-863f-4f48-82cf-00c28fa97a0e",
            "id": "G04.02",
            "link": "https://learn.microsoft.com/azure/storage/blobs/data-protection-overview#recommendations-for-basic-data-protection",
            "service": "Storage",
            "severity": "高い",
            "subcategory": "概要",
            "text": "ストレージ アカウントのコンテナーの論理的な削除を有効にして、削除されたコンテナーとその内容を回復します。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "category": "安全",
            "guid": "6f704104-85c1-441f-96d3-c9819911645e",
            "id": "G05.01",
            "link": "https://learn.microsoft.com/azure/active-directory/roles/security-planning",
            "severity": "高い",
            "subcategory": "特権アクセスの保護",
            "text": "Azure 管理タスク用に特権管理者アカウントを分離します。",
            "waf": "安全"
        },
        {
            "category": "安全",
            "guid": "9a19bf39-c95d-444c-9c89-19ca1f6d5215",
            "id": "G06.01",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/service-enablement-framework",
            "severity": "中程度",
            "subcategory": "サービス有効化フレームワーク",
            "text": "新しい Azure サービスの実装方法を計画する",
            "waf": "安全"
        },
        {
            "category": "安全",
            "guid": "ae514b93-3d45-485e-8112-9bd7ba012f7b",
            "id": "G06.02",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/service-enablement-framework",
            "severity": "中程度",
            "subcategory": "サービス有効化フレームワーク",
            "text": "Azure サービスのサービス要求の履行方法を計画する",
            "waf": "安全"
        },
        {
            "ammp": true,
            "category": "プラットフォームの自動化とDevOps",
            "guid": "e85f4226-bf06-4e35-8a8b-7aee4d2d633a",
            "id": "H01.01",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/platform-automation-devops",
            "severity": "高い",
            "subcategory": "DevOps チーム トポロジ",
            "text": "Azure ランディング ゾーン アーキテクチャを構築、管理、保守するための機能横断的な DevOps プラットフォーム チームがあることを確認します。",
            "waf": "オペレーションズ"
        },
        {
            "category": "プラットフォームの自動化とDevOps",
            "guid": "634146bf-7085-4419-a7b5-f96d2726f6da",
            "id": "H01.02",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/devops-teams-topologies#design-recommendations",
            "severity": "低い",
            "subcategory": "DevOps チーム トポロジ",
            "text": "Azure ランディング ゾーン プラットフォーム チームの関数を定義することを目指します。",
            "waf": "オペレーションズ"
        },
        {
            "category": "プラットフォームの自動化とDevOps",
            "guid": "a9e65070-c59e-4112-8bf6-c11364d4a2a5",
            "id": "H01.03",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/devops-teams-topologies#design-recommendations",
            "severity": "低い",
            "subcategory": "DevOps チーム トポロジ",
            "text": "アプリケーション ワークロード チームが自己完結し、DevOps プラットフォーム チームのサポートを必要としない機能を定義することを目指します。これは、カスタム RBAC ロールを使用して実現します。",
            "waf": "オペレーションズ"
        },
        {
            "ammp": true,
            "category": "プラットフォームの自動化とDevOps",
            "guid": "165eb5e9-b434-448a-9e24-178632186212",
            "id": "H01.04",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/infrastructure-as-code",
            "severity": "高い",
            "subcategory": "DevOps チーム トポロジ",
            "text": "CI/CD パイプラインを使用して IaC 成果物をデプロイし、デプロイと Azure 環境の品質を確保します。",
            "waf": "オペレーションズ"
        },
        {
            "category": "プラットフォームの自動化とDevOps",
            "guid": "0cadb8c7-8fa5-4fbf-8f39-d1fadb3b0460",
            "id": "H01.05",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/development-strategy-development-lifecycle#automated-builds",
            "severity": "中程度",
            "subcategory": "DevOps チーム トポロジ",
            "text": "ビルド プロセスの一部として、IaC とアプリケーション コードの単体テストを含めます。",
            "waf": "オペレーションズ"
        },
        {
            "ammp": true,
            "category": "プラットフォームの自動化とDevOps",
            "guid": "108d5099-a11d-4445-bd8b-e12a5e95412e",
            "id": "H01.06",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/development-strategy-development-lifecycle#automated-builds",
            "service": "Key Vault",
            "severity": "高い",
            "subcategory": "DevOps チーム トポロジ",
            "text": "Key Vault シークレットを使用して、資格情報 (仮想マシン、ユーザー パスワード)、証明書、キーなどの機密情報をハードコーディングしないようにします。",
            "waf": "オペレーションズ"
        },
        {
            "category": "プラットフォームの自動化とDevOps",
            "guid": "a52e0c98-76b9-4a09-a1c9-6b2babf22ac4",
            "id": "H01.07",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/subscription-vending",
            "severity": "低い",
            "subcategory": "DevOps チーム トポロジ",
            "text": "アプリケーションとワークロードの File > New > ランディング ゾーンの自動化を実装します。",
            "waf": "オペレーションズ"
        },
        {
            "ammp": true,
            "category": "プラットフォームの自動化とDevOps",
            "guid": "cfe363b5-f579-4284-bc56-a42153e4c10b",
            "id": "H02.01",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/infrastructure-as-code",
            "severity": "高い",
            "subcategory": "開発ライフサイクル",
            "text": "アプリケーションや IaC のソース コードにバージョン管理システムが使用されていることを確認します。Microsoft では Git を推奨しています。",
            "waf": "オペレーションズ"
        },
        {
            "category": "プラットフォームの自動化とDevOps",
            "guid": "c7245dd4-af8a-403a-8bb7-890c1a7cfa9d",
            "id": "H02.02",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/development-strategy-development-lifecycle",
            "severity": "低い",
            "subcategory": "開発ライフサイクル",
            "text": "分岐戦略に従って、チームのコラボレーションを改善し、IaC とアプリケーション コードのバージョン管理を効率的に管理できるようにします。Github Flow などのオプションを確認します。",
            "waf": "オペレーションズ"
        },
        {
            "category": "プラットフォームの自動化とDevOps",
            "guid": "12aeea20-9165-4b3e-bdf2-6795fcd3cdbe",
            "id": "H02.03",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/development-strategy-development-lifecycle",
            "severity": "中程度",
            "subcategory": "開発ライフサイクル",
            "text": "プル要求戦略を採用して、ブランチにマージされたコード変更を制御し続けるのに役立ちます。",
            "waf": "オペレーションズ"
        },
        {
            "ammp": true,
            "category": "プラットフォームの自動化とDevOps",
            "guid": "2cdc9d99-dbcc-4ad4-97f5-e7d358bdfa73",
            "id": "H03.01",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/infrastructure-as-code",
            "severity": "高い",
            "subcategory": "開発戦略",
            "text": "Azure Bicep、ARM テンプレート、Terraform などの宣言型インフラストラクチャ as Code ツールを活用して、Azure ランディング ゾーン アーキテクチャを構築および維持します。プラットフォームとアプリケーションのワークロードの両方の観点から。",
            "waf": "オペレーションズ"
        },
        {
            "ammp": true,
            "category": "プラットフォームの自動化とDevOps",
            "guid": "cc87a3bc-c572-4ad2-92ed-8cabab66160f",
            "id": "H04.01",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/landing-zone-security#secure",
            "severity": "高い",
            "subcategory": "安全",
            "text": "DevOpsの開発と運用のすでに組み合わされているプロセスにセキュリティを統合して、イノベーションプロセスのリスクを軽減します。",
            "waf": "オペレーションズ"
        }
    ],
    "metadata": {
        "name": "Azure Landing Zone Review",
        "state": "GA",
        "timestamp": "January 10, 2024",
        "waf": "all"
    },
    "severities": [
        {
            "name": "高い"
        },
        {
            "name": "中程度"
        },
        {
            "name": "低い"
        }
    ],
    "status": [
        {
            "description": "このチェックはまだ検討されていません",
            "name": "未確認"
        },
        {
            "description": "このチェックにはアクションアイテムが関連付けられています",
            "name": "開ける"
        },
        {
            "description": "このチェックは検証済みで、これ以上のアクションアイテムは関連付けられていません",
            "name": "達成"
        },
        {
            "description": "推奨事項は理解されているが、現在の要件では不要",
            "name": "必要なし"
        },
        {
            "description": "現在のデザインには適用されません",
            "name": "該当なし"
        }
    ],
    "waf": [
        {
            "name": "確実"
        },
        {
            "name": "安全"
        },
        {
            "name": "費用"
        },
        {
            "name": "オペレーションズ"
        },
        {
            "name": "パフォーマンス"
        }
    ],
    "yesno": [
        {
            "name": "はい"
        },
        {
            "name": "いいえ"
        }
    ]
}
{
    "items": [
        {
            "category": "Azure Billing and Microsoft Entra ID Tenants",
            "subcategory": "Microsoft Entra ID Tenants",
            "text": "Use one Entra tenant for managing your Azure resources, unless you have a clear regulatory or business requirement for multi-tenants. ",
            "waf": "Operations",
            "service": "Entra",
            "guid": "70c15989-c726-42c7-b0d3-24b7375b9201",
            "id": "A01.01",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/multi-tenant/considerations-recommendations",
            "training": "https://learn.microsoft.com/training/modules/deploy-resources-scopes-bicep/2-understand-deployment-scopes"
        },
        {
            "category": "Azure Billing and Microsoft Entra ID Tenants",
            "subcategory": "Microsoft Entra ID Tenants",
            "text": "Use Multi-Tenant Automation approach to managing your Microsoft Entra ID Tenants.",
            "waf": "Operations",
            "service": "Entra",
            "guid": "6309957b-821a-43d1-b9d9-7fcf1802b747",
            "id": "A01.02",
            "severity": "Low",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/multi-tenant/automation",
            "training": "https://learn.microsoft.com/entra/architecture/multi-tenant-user-management-introduction/"
        },
        {
            "category": "Azure Billing and Microsoft Entra ID Tenants",
            "subcategory": "Microsoft Entra ID Tenants",
            "text": "Use Azure Lighthouse for Multi-Tenant Management with the same IDs.",
            "waf": "Operations",
            "service": "Entra",
            "guid": "78e11934-499a-45ed-8ef7-aae5578f0ecf",
            "id": "A01.03",
            "severity": "High",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/multi-tenant/lighthouse",
            "training": "https://learn.microsoft.com/azure/lighthouse/concepts/cross-tenant-management-experience"
        },
        {
            "category": "Azure Billing and Microsoft Entra ID Tenants",
            "subcategory": "Cloud Solution Provider",
            "text": "If you give a partner access to administer your tenant, use Azure Lighthouse.",
            "waf": "Cost",
            "service": "Entra",
            "guid": "5d82e6df-6f61-42f2-82e2-3132d293be3d",
            "id": "A02.01",
            "severity": "High",
            "link": "https://learn.microsoft.com/azure/lighthouse/overview",
            "training": "https://learn.microsoft.com/azure/lighthouse/how-to/onboard-customer"
        },
        {
            "category": "Azure Billing and Microsoft Entra ID Tenants",
            "subcategory": "Cloud Solution Provider",
            "text": "If you have a CSP partner, define and document your support request and escalation process.",
            "waf": "Cost",
            "guid": "a24d0de3-d4b9-4dfb-8ddd-bbfaf123fa01",
            "id": "A02.02",
            "severity": "Low",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-cloud-solution-provider#design-recommendations"
        },
        {
            "category": "Azure Billing and Microsoft Entra ID Tenants",
            "subcategory": "Cloud Solution Provider",
            "text": "Setup Cost Reporting and Views with Azure Cost Management.",
            "waf": "Cost",
            "guid": "32952499-58c8-4e6f-ada5-972e67893d55",
            "id": "A02.03",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-microsoft-customer-agreement#design-recommendations",
            "training": "https://learn.microsoft.com/training/modules/analyze-costs-create-budgets-azure-cost-management/"
        },
        {
            "category": "Azure Billing and Microsoft Entra ID Tenants",
            "subcategory": "Enterprise Agreement",
            "text": "Set up a Notification Contact email address to ensure notifications are sent to an appropriate group mailbox.",
            "waf": "Cost",
            "guid": "685cb4f2-ac9c-4b19-9167-993ed0b32415",
            "id": "A03.01",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/cost-management-billing/manage/direct-ea-administration#manage-notification-contacts"
        },
        {
            "category": "Azure Billing and Microsoft Entra ID Tenants",
            "subcategory": "Enterprise Agreement",
            "text": "Use departments and accounts to map your organization's structure to your enrollment hierarchy which can help with separating billing.",
            "waf": "Cost",
            "guid": "12cd499f-96e2-4e41-a243-231fb3245a1c",
            "id": "A03.02",
            "severity": "Low",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-enterprise-agreement#design-considerations",
            "training": "https://learn.microsoft.com/azure/cost-management-billing/manage/understand-ea-roles"
        },
            {
            "category": "Azure Billing and Microsoft Entra ID Tenants",
            "subcategory": "Enterprise Agreement",
            "text": "Assign a budget for each department and account, and establish an alert associated with the budget.",
            "waf": "Cost",
            "guid": "54f0d8b1-22a3-4c0d-8ce2-58b9e086c93a",
            "id": "A03.03",
            "severity": "Low",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-enterprise-agreement#design-considerations",
            "training": "https://learn.microsoft.com/azure/cost-management-billing/manage/understand-ea-roles"
        },
        {
            "category": "Azure Billing and Microsoft Entra ID Tenants",
            "subcategory": "Enterprise Agreement",
            "text": "Enable both DA View Charges and AO View Charges on your EA Enrollments to allow users with the correct permissions to review Cost Management Data.",
            "waf": "Security",
            "guid": "ca0fe401-12ad-46fc-8a7e-86293866a9f6",
            "id": "A03.04",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-enterprise-agreement#design-recommendations",
            "training": "https://learn.microsoft.com/azure/cost-management-billing/costs/assign-access-acm-data#enable-access-to-costs-in-the-azure-portal"
        },
        {
            "category": "Azure Billing and Microsoft Entra ID Tenants",
            "subcategory": "Enterprise Agreement",
            "text": "Use of Enterprise Dev/Test Subscriptions to reduce costs for non-production workloads.",
            "waf": "Cost",
            "guid": "5cf9f485-2784-49b3-9824-75d9b8bdb57b",
            "id": "A03.05",
            "severity": "Low",
            "link": "https://azure.microsoft.com/pricing/offers/ms-azr-0148p",
            "training": "https://learn.microsoft.com/azure/devtest/offer/how-to-manage-monitor-devtest"
        },
        {
            "category": "Azure Billing and Microsoft Entra ID Tenants",
            "subcategory": "Microsoft Customer Agreement",
            "text": "Configure Agreement billing account notification contact email.",
            "waf": "Cost",
            "guid": "6ad5c3dd-e5ea-4ff1-81a4-7886ff87845c",
            "id": "A04.01",
            "severity": "Low",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-microsoft-customer-agreement#design-recommendations",
            "training": "https://learn.microsoft.com/azure/cost-management-billing/manage/mca-setup-account"
        },
        {
            "category": "Azure Billing and Microsoft Entra ID Tenants",
            "subcategory": "Microsoft Customer Agreement",
            "text": "Use Billing Profiles and Invoice sections to structure your agreements billing for effective cost management.",
            "waf": "Cost",
            "guid": "90e87802-602f-4dfb-acea-67c60689f1d7",
            "id": "A04.02",
            "severity": "Low",
            "link": "https://learn.microsoft.com/azure/cost-management-billing/manage/mca-section-invoice",
            "training": "https://learn.microsoft.com/azure/cost-management-billing/understand/mca-overview#billing-profiles"
        },
        {
            "category": "Azure Billing and Microsoft Entra ID Tenants",
            "subcategory": "Microsoft Customer Agreement",
            "text": "Make use of Microsoft Azure plan for dev/test offer to reduce costs for non-production workloads.",
            "waf": "Cost",
            "guid": "e81a73f0-84c4-4641-b406-14db3b4d1f50",
            "id": "A04.03",
            "severity": "Low",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-microsoft-customer-agreement#design-recommendations",
            "training": "https://learn.microsoft.com/azure/devtest/offer/overview-what-is-devtest-offer-visual-studio"
        },
        {
            "category": "Azure Billing and Microsoft Entra ID Tenants",
            "subcategory": "Microsoft Customer Agreement",
            "text": "Define and document a process to periodically audit the agreement billing RBAC role assignments to review who has access to your MCA billing account.",
            "waf": "Cost",
            "guid": "ae757485-92a4-482a-8bc9-eefe6f5b5ec3",
            "id": "A04.04",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-microsoft-customer-agreement#design-recommendations",
            "training": "https://learn.microsoft.com/azure/cost-management-billing/manage/understand-mca-roles"
        },
        {
            "category": "Identity and Access Management",
            "subcategory": "Identity",
            "text": "Enforce a RBAC model that aligns to your cloud operating model. Scope and Assign across Management Groups and Subscriptions.",
            "waf": "Security",
            "service": "Entra",
            "guid": "348ef254-c27d-442e-abba-c7571559ab91",
            "id": "B03.01",
            "severity": "High",
            "link": "https://learn.microsoft.com/azure/role-based-access-control/overview",
            "training": "https://learn.microsoft.com/learn/paths/implement-resource-mgmt-security/"
        },
        {
            "category": "Identity and Access Management",
            "subcategory": "Microsoft Entra ID and Hybrid Identity",
            "text": "Use managed identities instead of service principals for authentication to Azure services. You can check for existing service principals via Entra ID > Sign in Logs > Service principal logins.",
            "waf": "Security",
            "guid": "4348bf81-7573-4512-8f46-9061cc198fea",
            "id": "B03.02",
            "severity": "High",
            "link": "https://learn.microsoft.com/entra/identity/managed-identities-azure-resources/overview",
            "training": "https://learn.microsoft.com/entra/identity/managed-identities-azure-resources/managed-identities-status"
        },
        {
            "category": "Identity and Access Management",
            "subcategory": "Identity",
            "text": "Only use the authentication type Work or school account for all account types. Avoid using the Microsoft account (MSA) account type.",
            "waf": "Security",
            "service": "Entra",
            "guid": "12e7f983-f630-4472-8dd6-9c5b5c2622f5",
            "id": "B03.02",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/modules/explore-basic-services-identity-types/",
            "link": "https://learn.microsoft.com/azure/active-directory/roles/security-planning#identify-microsoft-accounts-in-administrative-roles-that-need-to-be-switched-to-work-or-school-accounts"
        },
        {
            "category": "Identity and Access Management",
            "subcategory": "Identity",
            "text": "Use Microsoft Entra groups to assign permissions. Add on-premises groups to the Entra ID only group if a group management system is already in place.",
            "waf": "Security",
            "service": "Entra",
            "guid": "4b69bad3-3aad-45e8-a68e-1d76667313b4",
            "id": "B03.03",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/paths/manage-identity-and-access/",
            "link": "https://learn.microsoft.com/entra/fundamentals/how-to-manage-groups"
        },
        {
            "category": "Identity and Access Management",
            "subcategory": "Identity",
            "text": "Enforce Microsoft Entra ID Conditional Access policies for any user with rights to Azure environments.",
            "waf": "Security",
            "service": "Entra",
            "guid": "53e8908a-e28c-484c-93b6-b7808b9fe5c4",
            "id": "B03.04",
            "severity": "High",
            "training": "https://learn.microsoft.com/learn/modules/plan-implement-administer-conditional-access/",
            "link": "https://learn.microsoft.com/azure/active-directory/conditional-access/overview"
        },
        {
            "category": "Identity and Access Management",
            "subcategory": "Identity",
            "text": "Enforce multi-factor authentication for any user with rights to the Azure environments.",
            "waf": "Security",
            "service": "Entra",
            "guid": "1049d403-a923-4c34-94d0-0018ac6a9e01",
            "id": "B03.05",
            "severity": "High",
            "training": "https://learn.microsoft.com/entra/identity/authentication/concept-mandatory-multifactor-authentication",
            "link": "https://learn.microsoft.com/azure/active-directory/authentication/concept-mfa-howitworks"
        },
        {
            "category": "Identity and Access Management",
            "subcategory": "Identity",
            "text": "Enforce centralized and delegated responsibilities to manage resources deployed inside the landing zone, based on role and security requirements.",
            "waf": "Security",
            "guid": "e6a83de5-de32-4c19-a248-1607d5d1e4e6",
            "id": "B03.06",
            "severity": "High",
            "training": "https://learn.microsoft.com/learn/paths/azure-administrator-manage-identities-governance/",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/manage/centralize-operations"
        },
        {
            "category": "Identity and Access Management",
            "subcategory": "Identity",
            "text": "Enforce Microsoft Entra ID Privileged Identity Management (PIM) to establish zero standing access and least privilege.",
            "waf": "Security",
            "service": "Entra",
            "guid": "14658d35-58fd-4772-99b8-21112df27ee4",
            "id": "B03.07",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/modules/azure-ad-privileged-identity-management/",
            "link": "https://learn.microsoft.com/azure/active-directory/privileged-identity-management/pim-configure"
        },
                {
            "category": "Identity and Access Management",
            "subcategory": "Identity",
            "text": "Microsoft recommends that you use roles with the fewest permissions. Global Administrator is a highly privileged role that should be limited to emergency scenarios when you can't use an existing role.",
            "waf": "Security",
            "service": "Entra",
            "guid": "d98d954d-7d1c-4a07-92a7-cf3afe8dcbd2",
            "id": "B03.08",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/entra/identity/role-based-access-control/groups-concept",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/identity-access-landing-zones#microsoft-entra-id-recommendations"
        },
        {
            "category": "Identity and Access Management",
            "subcategory": "Identity",
            "text": "When deploying Active Directory Domain Controllers, use a location with Availability Zones and deploy at least two VMs across these zones. If not available, deploy in an Availability Set.",
            "waf": "Reliability",
            "guid": "1559ab91-53e8-4908-ae28-c84c33b6b780",
            "id": "B03.09",
            "severity": "High",
            "training": "https://learn.microsoft.com/learn/modules/azure-active-directory/",
            "link": "https://learn.microsoft.com/azure/architecture/reference-architectures/identity/adds-extend-domain#vm-recommendations"
        },
        {
            "category": "Identity and Access Management",
            "subcategory": "Identity",
            "text": "Deploy your Azure landing zone identity resources in multiple regions.  If using domain controllers, associate each region with an Active Directory site so that resources can resolve to their local domain controllers.",
            "waf": "Reliability",
            "guid": "e8aa1e41-870d-4968-94c6-77be14f510ac",
            "id": "B03.10",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/modules/azure-active-directory/",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/regions#identity"
        },
        {
            "category": "Identity and Access Management",
            "subcategory": "Identity",
            "text": "Use Azure custom RBAC roles for the following key roles to provide fine-grain access across your ALZ: Azure platform owner, network management, security operations, subscription owner, application owner. Align these roles to teams and responsibilities within your business.",
            "waf": "Security",
            "guid": "f5664b5e-984a-4859-a773-e7d261623a76",
            "id": "B03.11",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/modules/create-custom-azure-roles-with-rbac/",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/identity-access#prerequisites-for-a-landing-zone---design-recommendations"
        },
        {
            "category": "Identity and Access Management",
            "subcategory": "Identity",
            "text": "If planning to switch from Active Directory Domain Services to Entra domain services, evaluate the compatibility of all workloads.",
            "waf": "Security",
            "service": "Entra",
            "guid": "8b9fe5c4-1049-4d40-9a92-3c3474d00018",
            "id": "B03.12",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/modules/implement-hybrid-identity-windows-server/",
            "link": "https://learn.microsoft.com/entra/identity/domain-services/overview"
        },
        {
            "category": "Identity and Access Management",
            "subcategory": "Identity",
            "text": "When using Microsoft Entra Domain Services, use replica sets. Replica sets will improve the resiliency of your managed domain and allow you to deploy to additional regions. ",
            "waf": "Reliability",
            "service": "Entra",
            "guid": "0dd4e625-9c4b-4a56-b54a-4357bac12761",
            "id": "B03.13",
            "graph": "resources | where type == 'microsoft.aad/domainservices' | extend replicaSets = properties.replicaSets | where array_length(replicaSets) < 2 | project name=name, id=id, tags=tags, param1=strcat('replicaSetLocation:', replicaSets[0].location)",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/training/modules/understand-azure-active-directory/6-examine-azure-domain-services",
            "link": "https://learn.microsoft.com/entra/identity/domain-services/overview"
        },
        {
            "category": "Identity and Access Management",
            "subcategory": "Identity",
            "text": "Integrate Microsoft Entra ID logs with the platform-central Azure Monitor. Azure Monitor allows for a single source of truth around log and monitoring data in Azure, giving organizations a cloud native options to meet requirements around log collection and retention.",
            "waf": "Security",
            "service": "Entra",
            "guid": "1cf0b8da-70bd-44d0-94af-8d99cfc89ae1",
            "id": "B03.14",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/active-directory/reports-monitoring/concept-activity-logs-azure-monitor",
            "training": "https://learn.microsoft.com/entra/identity/monitoring-health/howto-integrate-activity-logs-with-azure-monitor-logs"
        },
        {
            "category": "Identity and Access Management",
            "subcategory": "Identity",
            "text": "Implement an emergency access or break-glass accounts to prevent tenant-wide account lockout. MFA will be turned on by default for all users in Oct 2024. We recommend updating these accounts to use\u202fpasskey (FIDO2)\u202for\u202fconfigure certificate-based authentication for MFA. ",
            "waf": "Security",
            "service": "Entra",
            "guid": "984a859c-773e-47d2-9162-3a765a917e1f",
            "id": "B03.15",
            "ammp": true,
            "severity": "High",
            "training": "https://learn.microsoft.com/entra/identity/role-based-access-control/security-emergency-access#exclude-at-least-one-account-from-conditional-access-policies",
            "link": "https://learn.microsoft.com/azure/active-directory/roles/security-emergency-access"
        },
        {
            "category": "Identity and Access Management",
            "subcategory": "Microsoft Entra ID",
            "text": "When deploying Microsoft Entra Connect, use a staging sever for high availability/disaster recovery.",
            "waf": "Reliability",
            "guid": "cd163e39-84a5-4b39-97b7-6973abd70d94",
            "id": "B03.16",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/active-directory/hybrid/how-to-connect-sync-staging-server",
            "training": "https://learn.microsoft.com/entra/identity/hybrid/connect/plan-connect-topologies"
        },
        {
            "category": "Identity and Access Management",
            "subcategory": "Identity",
            "text": "Do not use on-premises synced accounts for Microsoft Entra ID role assignments, unless you have a scenario that specifically requires it.",
            "waf": "Security",
            "service": "Entra",
            "guid": "35037e68-9349-4c15-b371-228514f4cdff",
            "id": "B03.17",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/modules/design-identity-security-strategy/",
            "link": "https://learn.microsoft.com/azure/active-directory/roles/best-practices"
        },
        {
            "category": "Identity and Access Management",
            "subcategory": "Identity",
            "text": "When using Microsoft Entra ID Application Proxy to give remote users access to applications, manage it as a Platform resource.",
            "waf": "Security",
            "service": "Entra",
            "guid": "d5d1e4e6-1465-48d3-958f-d77249b82111",
            "id": "B03.18",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/paths/implement-applications-external-access-azure-ad/",
            "link": "https://learn.microsoft.com/azure/active-directory/app-proxy/application-proxy"
        },
        {
            "category": "Identity and Access Management",
            "subcategory": "Landing zones",
            "text": "Configure Identity network segmentation through the use of a virtual Network and peer back to the hub. Providing authentication inside application landing zone (legacy).",
            "waf": "Security",
            "guid": "9cf5418b-1520-4b7b-add7-88eb28f833e8",
            "id": "B04.01",
            "severity": "High",
            "training": "https://learn.microsoft.com/azure/architecture/example-scenario/identity/adds-extend-domain",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/identity-access-landing-zones#identity-and-access-management-in-the-azure-landing-zone-accelerator"
        },
        {
            "category": "Identity and Access Management",
            "subcategory": "Landing zones",
            "text": "Use Azure RBAC to manage data plane access to resources, if possible. E.g. Data Operations across Key Vault, Storage Account and Database Services.",
            "waf": "Security",
            "guid": "d4d1ad54-1abc-4919-b267-3f342d3b49e4",
            "id": "B04.02",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/azure/role-based-access-control/overview",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/identity-access-landing-zones#rbac-recommendations"
        },
        {
            "category": "Identity and Access Management",
            "subcategory": "Landing zones",
            "text": "Use Microsoft Entra ID PIM access reviews to periodically validate resource entitlements.",
            "waf": "Security",
            "guid": "d505ebcb-79b1-4274-9c0d-a27c8bea489c",
            "id": "B04.03",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/active-directory/privileged-identity-management/pim-create-roles-and-resource-roles-review",
            "training": "https://learn.microsoft.com/entra/id-governance/privileged-identity-management/pim-perform-roles-and-resource-roles-review"
        },
        {
            "category": "Identity and Access Management",
            "subcategory": "Landing zones",
            "text": "Restrict and minimize the number of account owners within the enrollment to limit administrator access to subscriptions and associated Azure resources.",
            "waf": "Security",
            "guid": "0ce74f19-9abb-47e4-ae95-6b057a1d2be9",
            "id": "B04.04",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-enterprise-agreement",
            "training": "https://learn.microsoft.com/training/paths/configure-manage-entitlement-microsoft-entra-id/?source=recommendations"
        },
        {
            "category": "Resource Organization",
            "subcategory": "Naming and tagging",
            "text": "Use a well defined naming scheme for resources, such as Microsoft Best Practice Naming Standards.",
            "description": "Consider using the Azure naming tool available at https://aka.ms/azurenamingtool",
            "waf": "Security",
            "guid": "cacf55bc-e4e4-46be-96bc-57a5f23a269a",
            "id": "C01.01",
            "severity": "High",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/resource-naming"
        },
        {
            "category": "Resource Organization",
            "subcategory": "Subscriptions",
            "text": "Enforce reasonably flat management group hierarchy with no more than four levels.",
            "waf": "Security",
            "guid": "2df27ee4-12e7-4f98-9f63-04722dd69c5b",
            "id": "C02.01",
            "severity": "Medium",
            "graph": "resourcecontainers| where type == 'microsoft.resources/subscriptions'| extend ManagementGroup = tostring(tags),mgmtChain = properties.managementGroupAncestorsChain| extend compliant =( array_length(mgmtChain) <= 4 and array_length(mgmtChain) > 1)",
            "training": "https://learn.microsoft.com/learn/modules/azure-architecture-fundamentals/",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/resource-org-management-groups"
        },
        {
            "category": "Resource Organization",
            "subcategory": "Subscriptions",
            "text": "Enforce a sandbox management group to allow users to immediately experiment with Azure.",
            "waf": "Security",
            "guid": "667313b4-f566-44b5-b984-a859c773e7d2",
            "id": "C02.02",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/paths/enterprise-scale-architecture/",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/resource-org-management-groups#management-group-recommendations"
        },
        {
            "category": "Resource Organization",
            "subcategory": "Subscriptions",
            "text": "Enforce a platform management group under the root management group to support common platform policy and Azure role assignment.",
            "waf": "Security",
            "guid": "61623a76-5a91-47e1-b348-ef254c27d42e",
            "id": "C02.03",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/paths/enterprise-scale-architecture/",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/resource-org-management-groups#management-group-recommendations"
        },
        {
            "category": "Resource Organization",
            "subcategory": "Subscriptions",
            "text": "Enforce a dedicated connectivity subscription in the Connectivity management group to host an Azure Virtual WAN hub, private non-AD Domain Name System (DNS), ExpressRoute circuit, and other networking resources.",
            "waf": "Security",
            "guid": "8bbac757-1559-4ab9-853e-8908ae28c84c",
            "id": "C02.04",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/paths/enterprise-scale-architecture/",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/resource-org-management-groups#management-group-recommendations"
        },
        {
            "category": "Resource Organization",
            "subcategory": "Subscriptions",
            "text": "Enforce no subscriptions are placed under the root management group.",
            "waf": "Security",
            "guid": "33b6b780-8b9f-4e5c-9104-9d403a923c34",
            "id": "C02.05",
            "severity": "Medium",
            "graph": "resourcecontainers| where type == 'microsoft.resources/subscriptions'| extend ManagementGroup = tostring(tags),mgmtChain = properties.managementGroupAncestorsChain| extend compliant = (array_length(mgmtChain) > 1)",
            "link": "https://learn.microsoft.com/azure/governance/management-groups/how-to/protect-resource-hierarchy#setting---default-management-group",
            "training": "https://learn.microsoft.com/azure/governance/management-groups/overview"
        },
        {
            "category": "Resource Organization",
            "subcategory": "Subscriptions",
            "text": "Enforce that only privileged users can operate management groups in the tenant by enabling Azure RBAC authorization in the management group hierarchy settings.",
            "waf": "Security",
            "guid": "74d00018-ac6a-49e0-8e6a-83de5de32c19",
            "id": "C02.06",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/governance/management-groups/how-to/protect-resource-hierarchy#setting---require-authorization",
            "training": "https://learn.microsoft.com/training/modules/configure-role-based-access-control/"
        },
        {
            "category": "Resource Organization",
            "subcategory": "Subscriptions",
            "text": "Enforce management groups under the root-level management group to represent the types of workloads, based on their security, compliance, connectivity, and feature needs.",
            "waf": "Security",
            "guid": "92481607-d5d1-4e4e-9146-58d3558fd772",
            "id": "C02.07",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/governance/management-groups/overview"
        },
        {
            "category": "Resource Organization",
            "subcategory": "Subscriptions",
            "text": "Enforce a process to make resource owners aware of their roles and responsibilities, access review, budget review, policy compliance and remediate when necessary.",
            "waf": "Security",
            "guid": "49b82111-2df2-47ee-912e-7f983f630472",
            "id": "C02.08",
            "severity": "High",
            "link": "https://learn.microsoft.com/entra/id-governance/access-reviews-overview",
            "training": "https://learn.microsoft.com/training/modules/plan-implement-manage-access-review/"
        },
        {
            "category": "Resource Organization",
            "subcategory": "Subscriptions",
            "text": "Ensure that all subscription owners and IT core team are aware of subscription quotas and the impact they have on provision resources for a given subscription.",
            "waf": "Security",
            "guid": "2dd69c5b-5c26-422f-94b6-9bad33aad5e8",
            "id": "C02.09",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits",
            "training": "https://learn.microsoft.com/training/modules/configure-subscriptions/"
        },
        {
            "category": "Resource Organization",
            "subcategory": "Subscriptions",
            "text": "Use Reserved Instances where appropriate to optimize cost and ensure available capacity in target regions.",
            "waf": "Security",
            "guid": "c68e1d76-6673-413b-9f56-64b5e984a859",
            "id": "C02.10",
            "severity": "High",
            "training": "https://learn.microsoft.com/learn/paths/improve-reliability-modern-operations/",
            "link": "https://learn.microsoft.com/azure/cost-management-billing/reservations/save-compute-costs-reservations"
        },
        {
            "category": "Resource Organization",
            "subcategory": "Subscriptions",
            "text": "Establish dashboards and/or visualizations to monitor compute and storage capacity metrics. (i.e. CPU, memory, disk space)",
            "waf": "Security",
            "guid": "c773e7d2-6162-43a7-95a9-17e1f348ef25",
            "id": "C02.11",
            "ammp": true,
            "severity": "Medium",
            "training": "https://learn.microsoft.com/training/modules/visualize-data-workbooks/",
            "link": "https://learn.microsoft.com/azure/azure-portal/azure-portal-dashboards"
        },
        {
            "category": "Resource Organization",
            "subcategory": "Subscriptions",
            "text": "As part of your cloud adoption, implement a detailed cost management plan using the 'Managed cloud costs' process.",
            "waf": "Security",
            "guid": "ae28c84c-33b6-4b78-88b9-fe5c41049d40",
            "id": "C02.12",
            "severity": "High",
            "training": "https://learn.microsoft.com/learn/paths/control-spending-manage-bills/",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/get-started/manage-costs"
        },
        {
            "category": "Resource Organization",
            "subcategory": "Subscriptions",
            "text": "If servers will be used for Identity services, like domain controllers, establish a dedicated identity subscription in the identity management group, to host these services. Make sure that resources are set to use the domain controllers available in their region.",
            "waf": "Security",
            "guid": "3a923c34-74d0-4001-aac6-a9e01e6a83de",
            "id": "C02.13",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/paths/enterprise-scale-architecture/",
            "link": "https://learn.microsoft.com/azure/governance/management-groups/overview"
        },
        {
            "category": "Resource Organization",
            "subcategory": "Subscriptions",
            "text": "Ensure tags are used for billing and cost management.",
            "waf": "Security",
            "guid": "5de32c19-9248-4160-9d5d-1e4e614658d3",
            "id": "C02.14",
            "severity": "Medium",
            "graph": "resources | extend compliant = isnotnull(['tags']) | project name, id, subscriptionId, resourceGroup, tags, compliant",
            "training": "https://learn.microsoft.com/learn/paths/implement-resource-mgmt-security/",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/track-costs"
        },
        {
            "category": "Resource Organization",
            "subcategory": "Subscriptions",
            "text": "For Sovereign Landing Zone, have a 'confidential corp' and 'confidential online' management group directly under the 'landing zones' MG.",
            "waf": "Security",
            "guid": "6cc0ea22-42bb-441e-a345-804ab0a09666",
            "id": "C02.15",
            "severity": "Medium",
            "link": "https://github.com/Azure/sovereign-landing-zone/blob/main/docs/02-Architecture.md",
            "training": "https://learn.microsoft.com/industry/sovereignty/slz-overview"
        },
        {
            "category": "Resource Organization",
            "subcategory": "Regions",
            "text": "Select the right Azure region/s for your deployment. Azure is a global-scale cloud platform that provide global coverage through many regions and geographies. Different Azure regions have different characteristics, access and availability models, costs, capacity, and services offered, then it is important to consider all criteria and requirements.",
            "waf": "Reliability",
            "guid": "250d81ce-8bbe-4f85-9051-6a18a8221e50",
            "id": "C03.01",
            "severity": "High",
            "training": "https://learn.microsoft.com/learn/modules/azure-architecture-fundamentals/",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-setup-guide/regions"
        },
        {
            "category": "Resource Organization",
            "subcategory": "Regions",
            "text": "Deploy your Azure landing zone in a multi-region deployment. Depending on customer size, locations, and users presence, operating in multiple regions can be a common choice to deliver services and run applications closer to them. Using a multi-region deployment is also important to provide geo disaster recovery capabilities, to eliminate the dependency from a single region capacity and diminish the risk of a temporary and localized resource capacity constraint.",
            "waf": "Reliability",
            "guid": "19ca3f89-397d-44b1-b5b6-5e18661372ac",
            "id": "C03.02",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/modules/azure-architecture-fundamentals/",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-setup-guide/regions#operate-in-multiple-geographic-regions"
        },
        {
            "category": "Resource Organization",
            "subcategory": "Regions",
            "text": "Ensure required services and features are available within the chosen deployment regions.",
            "waf": "Reliability",
            "guid": "4c27d42e-8bba-4c75-9155-9ab9153e8908",
            "id": "C03.03",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/modules/azure-architecture-fundamentals/",
            "link": "https://azure.microsoft.com/explore/global-infrastructure/products-by-region/"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "App delivery",
            "text": "Document a standard for securing the delivery application content from your Workload spokes using Application Gateway and Azure Front Door.  You can use the Application Delivery checklist to for recommendations.",
            "waf": "Operations",
            "guid": "373f482f-3e39-4d39-8aa4-7e566f6082b6",
            "id": "D01.01",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-app-delivery"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Hub and spoke",
            "text": "Use a hub-and-spoke network topology for network scenarios that require maximum flexibility.",
            "waf": "Security",
            "service": "VNet",
            "guid": "e8bbac75-7155-49ab-a153-e8908ae28c84",
            "id": "D01.02",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/paths/architect-network-infrastructure/",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/enterprise-scale/network-topology-and-connectivity"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Hub and spoke",
            "text": "Deploy your Azure landing zone connectivity resources in multiple regions, so that you can quickly support multi-region application landing zones and disaster recovery scenarios.",
            "waf": "Reliability",
            "service": "VNet",
            "guid": "7bc1c396-2461-4698-b57f-30ca69525252",
            "id": "D01.03",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/regions",
            "training": "https://learn.microsoft.com/training/modules/hub-and-spoke-network-architecture/"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Hub and spoke",
            "text": "Deploy shared networking services, including ExpressRoute gateways, VPN gateways, and Azure Firewall or partner NVAs in the central-hub virtual network. If necessary, also deploy DNS services.",
            "waf": "Cost",
            "service": "VNet",
            "guid": "7dd61623-a364-4a90-9eca-e48ebd54cd7d",
            "id": "D01.04",
            "severity": "High",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/traditional-azure-networking-topology",
            "training": "https://learn.microsoft.com/training/modules/hub-and-spoke-network-architecture/"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Hub and spoke",
            "text": "When deploying partner networking technologies or NVAs, follow the partner vendor's guidance.",
            "waf": "Reliability",
            "service": "NVA",
            "guid": "e2e8abac-3571-4559-ab91-53e89f89dc7b",
            "id": "D01.06",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/architecture/reference-architectures/dmz/nva-ha"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Hub and spoke",
            "text": "If you need transit between ExpressRoute and VPN gateways in hub and spoke scenarios, use Azure Route Server.",
            "waf": "Security",
            "service": "ExpressRoute",
            "guid": "ce463dbb-bc8a-4c2a-aebc-92a43da1dae2",
            "id": "D01.07",
            "severity": "Low",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-howto-coexist-resource-manager#to-enable-transit-routing-between-expressroute-and-azure-vpn",
            "training": "https://learn.microsoft.com/training/modules/intro-to-azure-route-server/"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Hub and spoke",
            "text": "If using Route Server, use a /27 prefix for the Route Server subnet.",
            "waf": "Security",
            "service": "ARS",
            "guid": "91b9d7d5-91e1-4dcb-8f1f-fa7e465646cc",
            "id": "D01.08",
            "severity": "Low",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,subnets=properties.subnets | mv-expand subnets | project id, subnetName = subnets.name, subnetPrefix = subnets.properties.addressPrefix | extend subnetPrefixLength = split(subnetPrefix, '/')[1] | where subnetName == 'RouteServerSubnet' | extend compliant = (subnetPrefixLength <= 27) | distinct id, compliant",
            "link": "https://learn.microsoft.com/azure/route-server/quickstart-configure-route-server-portal#create-a-route-server-1",
            "training": "https://learn.microsoft.com/training/modules/intro-to-azure-route-server/"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Hub and spoke",
            "text": "For network architectures with multiple hub-and-spoke topologies across Azure regions, use global virtual network peerings between the hub VNets to connect the regions to each other.",
            "waf": "Performance",
            "service": "VNet",
            "guid": "cc881471-607c-41cc-a0e6-14658dd558f9",
            "id": "D01.09",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/paths/azure-administrator-manage-virtual-networks/",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-networks-faq#can-i-create-a-peering-connection-to-a-vnet-in-a-different-region"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Hub and spoke",
            "text": "Use Azure Monitor for Networks to monitor the end-to-end state of the networks on Azure.",
            "waf": "Operations",
            "service": "VNet",
            "guid": "4722d929-c1b1-4cd6-81f5-4b29bade39ad",
            "id": "D01.10",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-network-monitoring/",
            "link": "https://learn.microsoft.com/azure/azure-monitor/insights/network-insights-overview"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Hub and spoke",
            "text": "If you have more than 400 spoke networks in a region, deploy an additional hub to bypass VNet peering limits (500) and the maximum number of prefixes that can be advertised via ExpressRoute (1000).",
            "waf": "Reliability",
            "service": "VNet",
            "guid": "0e7c28ec-9366-4572-83b0-f4664b1d944a",
            "id": "D01.11",
            "severity": "Medium",
            "graph": "resources | where type == 'microsoft.network/virtualnetworks' | mvexpand properties.virtualNetworkPeerings | summarize peeringcount = count() by id | extend compliant = (peeringcount < 450) | distinct id,compliant",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits?toc=/azure/virtual-network/toc.json#azure-resource-manager-virtual-networking-limits",
            "training": "https://learn.microsoft.com/training/modules/hub-and-spoke-network-architecture/"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Hub and spoke",
            "text": "Limit the number of routes per route table to 400.",
            "waf": "Reliability",
            "service": "VNet",
            "guid": "3d457936-e9b7-41eb-bdff-314b26450b12",
            "id": "D01.12",
            "severity": "Medium",
            "graph": "resources | where type=='microsoft.network/routetables' | mvexpand properties.routes | summarize routeCount = count() by id | extend compliant = (routeCount < 360) | distinct id,compliant",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits?toc=/azure/virtual-network/toc.json#azure-resource-manager-virtual-networking-limits",
            "training": "https://learn.microsoft.com/training/modules/hub-and-spoke-network-architecture/"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Hub and spoke",
            "text": "Use the setting 'Allow traffic to remote virtual network' when configuring VNet peerings.",
            "waf": "Reliability",
            "service": "VNet",
            "guid": "c76cb5a2-abe2-11ed-afa1-0242ac120002",
            "id": "D01.13",
            "severity": "High",
            "graph": "resources | where type == 'microsoft.network/virtualnetworks' | mvexpand properties.virtualNetworkPeerings | project id, peeringName=properties_virtualNetworkPeerings.name, compliant = (properties_virtualNetworkPeerings.properties.allowVirtualNetworkAccess == True)",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-network-manage-peering",
            "training": "https://learn.microsoft.com/training/modules/hub-and-spoke-network-architecture/"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Hub and spoke",
            "text": "Use Standard Load Balancer SKU with a zone-redundant deployment, Selecting Standard SKU Load Balancer enhances reliability through availability zones and zone resiliency, ensuring deployments withstand zone and region failures. Unlike Basic, it supports global load balancing and offers an SLA.",
            "waf": "Reliability",
            "service": "Load Balancer",
            "guid": "9dcd6250-9c4a-4382-aa9b-5b84c64fc1fe",
            "id": "D01.14",
            "severity": "High",
            "graph": "resources | where type == 'microsoft.network/loadbalancers' | where tolower(sku.name) != 'basic' | mv-expand feIPconfigs = properties.frontendIPConfigurations | extend feConfigName = (feIPconfigs.name), PrivateSubnetId = toupper(feIPconfigs.properties.subnet.id), PrivateIPZones = feIPconfigs.zones, PIPid = toupper(feIPconfigs.properties.publicIPAddress.id), JoinID = toupper(id) | where isnotempty(PrivateSubnetId) | where isnull(PrivateIPZones) or array_length(PrivateIPZones) < 2 | project name, feConfigName, id | union (resources | where type == 'microsoft.network/loadbalancers' | where tolower(sku.name) != 'basic' | mv-expand feIPconfigs = properties.frontendIPConfigurations | extend feConfigName = (feIPconfigs.name), PIPid = toupper(feIPconfigs.properties.publicIPAddress.id), JoinID = toupper(id) | where isnotempty(PIPid) | join kind=innerunique ( resources | where type == 'microsoft.network/publicipaddresses' | where isnull(zones) or array_length(zones) < 2 | extend LBid = toupper(substring(properties.ipConfiguration.id, 0, indexof(properties.ipConfiguration.id, '/frontendIPConfigurations'))), InnerID = toupper(id) ) on $left.PIPid == $right.InnerID) | project name, id, tags, param1='Zones: No Zone or Zonal', param2=strcat('Frontend IP Configuration:', ' ', feConfigName)",
            "link": "https://learn.microsoft.com/azure/reliability/reliability-load-balancer?tabs=graph#zone-redundant"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Hub and spoke",
            "text": "Ensure load balancer backend pool(s) contains at least two instances, Deploying Azure Load Balancers with at least two instances in the backend prevents a single point of failure and supports scalability.",
            "waf": "Reliability",
            "service": "Load Balancer",
            "guid": "48682fb1-1e86-4458-a686-518ebd47393d",
            "id": "D01.15",
            "severity": "High",
            "graph": "resources | where type =~ 'Microsoft.Network/loadBalancers' | extend bep = properties.backendAddressPools | extend BackEndPools = array_length(bep) | where BackEndPools == 0 | project name, id, Param1='backendPools', Param2=toint(0), tags | union (resources | where type =~ 'Microsoft.Network/loadBalancers' | where sku.name == 'Standard' | extend bep = properties.backendAddressPools | extend BackEndPools = toint(array_length(bep)) | mv-expand bip = properties.backendAddressPools | extend BackendAddresses = array_length(bip.properties.loadBalancerBackendAddresses) | where toint(BackendAddresses) <= 1 | project name, id, tags, Param1='backendAddresses', Param2=toint(BackendAddresses)) | union ( resources | where type =~ 'Microsoft.Network/loadBalancers' | where sku.name == 'Basic' | mv-expand properties.backendAddressPools | extend backendPoolId = properties_backendAddressPools.id | project id, name, tags, tostring(backendPoolId), Param1='BackEndPools' | join kind = leftouter ( resources | where type =~ 'Microsoft.Network/networkInterfaces' | mv-expand properties.ipConfigurations | mv-expand properties_ipConfigurations.properties.loadBalancerBackendAddressPools | extend backendPoolId = tostring(properties_ipConfigurations_properties_loadBalancerBackendAddressPools.id) | summarize poolMembers = count() by backendPoolId | project tostring(backendPoolId), poolMembers ) on backendPoolId | where toint(poolMembers) <= 1 | extend BackendAddresses = poolMembers | project id, name, tags, Param1='backendAddresses', Param2=toint(BackendAddresses))",
            "link": "https://learn.microsoft.com/azure/reliability/reliability-load-balancer?tabs=graph#zone-redundant"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Encryption",
            "text": "When you're using ExpressRoute Direct, configure MACsec in order to encrypt traffic at the layer-two level between the organization's routers and MSEE. The diagram shows this encryption in flow.",
            "waf": "Security",
            "service": "ExpressRoute",
            "guid": "de0d5973-cd4c-4d21-a088-137f5e6c4cfd",
            "id": "D02.01",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-howto-macsec",
            "training": "https://learn.microsoft.com/training/modules/design-implement-azure-expressroute/"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Encryption",
            "text": "For scenarios where MACsec isn't an option (for example, not using ExpressRoute Direct), use a VPN gateway to establish IPsec tunnels over ExpressRoute private peering.",
            "waf": "Security",
            "service": "ExpressRoute",
            "guid": "ed301d6e-872e-452e-9611-cc58b5a4b151",
            "id": "D02.02",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/",
            "link": "https://learn.microsoft.com/azure/vpn-gateway/site-to-site-vpn-private-peering"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "IP plan",
            "text": "Ensure no overlapping IP address spaces across Azure regions and on-premises locations are used.",
            "waf": "Security",
            "service": "ExpressRoute",
            "guid": "558fd772-49b8-4211-82df-27ee412e7f98",
            "id": "D03.01",
            "severity": "High",
            "training": "https://learn.microsoft.com/learn/paths/architect-network-infrastructure/",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-ip-addressing"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "IP plan",
            "text": "Use IP addresses from the address allocation ranges for private internets (RFC 1918).",
            "waf": "Security",
            "service": "VNet",
            "guid": "3f630472-2dd6-49c5-a5c2-622f54b69bad",
            "id": "D03.02",
            "severity": "Medium",
            "graph": "resources | where type == 'microsoft.network/virtualnetworks' | extend addressSpace = todynamic(properties.addressSpace) | extend addressPrefix = todynamic(properties.addressSpace.addressPrefixes) | mvexpand addressSpace | mvexpand addressPrefix | project name, id, location, resourceGroup, subscriptionId, cidr = addressPrefix | extend compliant = (cidr matches regex @'^(10\\\\.|172\\\\.(1[6-9]|2[0-9]|3[01])\\\\.|192\\\\.168\\\\.)')  | project id, compliant, cidr",
            "training": "https://learn.microsoft.com/learn/paths/architect-network-infrastructure/",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-ip-addressing"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "IP plan",
            "text": "Ensure that IP address space isn't wasted, don't create unnecessarily large virtual networks (for example /16).",
            "waf": "Performance",
            "service": "VNet",
            "guid": "33aad5e8-c68e-41d7-9667-313b4f5664b5",
            "id": "D03.03",
            "severity": "High",
            "graph": "resources | where type == 'microsoft.network/virtualnetworks' | extend addressSpace = todynamic(properties.addressSpace) | extend addressPrefix = todynamic(properties.addressSpace.addressPrefixes) | mvexpand addressSpace | mvexpand addressPrefix | extend addressMask = split(addressPrefix,'/')[1] | extend compliant = addressMask > 16 | project name, id, subscriptionId, resourceGroup, addressPrefix, compliant",
            "training": "https://learn.microsoft.com/learn/paths/architect-network-infrastructure/",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-ip-addressing"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "IP plan",
            "text": "Do not use overlapping IP address ranges for production and disaster recovery sites.",
            "waf": "Reliability",
            "service": "VNet",
            "guid": "f348ef25-4c27-4d42-b8bb-ac7571559ab9",
            "id": "D03.04",
            "severity": "High",
            "training": "https://learn.microsoft.com/learn/paths/az-104-manage-virtual-networks/",
            "link": "https://learn.microsoft.com/azure/site-recovery/concepts-on-premises-to-azure-networking#retain-ip-addresses"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "IP plan",
            "text": "Use Standard SKU and Zone-Redundant IPs when applicable, Public IP addresses in Azure can be of standard SKU, available as non-zonal, zonal, or zone-redundant. Zone-redundant IPs are accessible across all zones, resisting any single zone failure, thereby providing higher resilience. ",
            "waf": "Reliability",
            "service": "Public IP Addresses",
            "guid": "0c47f486-656d-4699-8c30-edef5b8a93c4",
            "id": "D03.05",
            "graph": "Resources | where type =~ 'Microsoft.Network/publicIPAddresses' and sku.tier =~ 'Regional' | where isempty(zones) or array_length(zones) <= 1 | extend az = case(isempty(zones), 'Non-zonal', array_length(zones) <= 1, strcat('Zonal (', strcat_array(zones, ','), ')'), zones) | project name, id, tags, param1 = strcat('sku: ', sku.name), param2 = strcat('availabilityZone: ', az)",
            "severity": "High",
            "training": "https://learn.microsoft.com/en-gb/training/modules/configure-virtual-networks/6-create-public-ip-addressing",
            "link": "https://learn.microsoft.com/azure/virtual-network/ip-services/public-ip-addresses#availability-zone"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "IP plan",
            "text": "For environments where name resolution in Azure is all that's required, use Azure Private DNS for resolution with a delegated zone for name resolution (such as 'azure.contoso.com').",
            "waf": "Operations",
            "service": "DNS",
            "guid": "153e8908-ae28-4c84-a33b-6b7808b9fe5c",
            "id": "D03.06",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/paths/az-104-manage-virtual-networks/",
            "link": "https://learn.microsoft.com/azure/dns/private-dns-getstarted-portal"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "IP plan",
            "text": "For environments where name resolution across Azure and on-premises is required and there is no existing enterprise DNS service like Active Directory, use Azure DNS Private Resolver to route DNS requests to Azure or to on-premises DNS servers.",
            "waf": "Security",
            "service": "DNS",
            "guid": "41049d40-3a92-43c3-974d-00018ac6a9e0",
            "id": "D03.07",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/training/modules/intro-to-azure-dns-private-resolver/",
            "link": "https://learn.microsoft.com/azure/dns/dns-private-resolver-overview"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "IP plan",
            "text": "Special workloads that require and deploy their own DNS (such as Red Hat OpenShift) should use their preferred DNS solution.",
            "waf": "Operations",
            "service": "DNS",
            "guid": "1e6a83de-5de3-42c1-a924-81607d5d1e4e",
            "id": "D03.08",
            "severity": "Low",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-networks-name-resolution-for-vms-and-role-instances",
            "training": "https://learn.microsoft.com/training/courses/az-700t00"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "IP plan",
            "text": "Enable auto-registration for Azure DNS to automatically manage the lifecycle of the DNS records for the virtual machines deployed within a virtual network.",
            "waf": "Operations",
            "service": "DNS",
            "guid": "614658d3-558f-4d77-849b-821112df27ee",
            "id": "D03.09",
            "severity": "High",
            "training": "https://learn.microsoft.com/learn/paths/az-104-manage-virtual-networks/",
            "link": "https://learn.microsoft.com/azure/dns/private-dns-autoregistration"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "IP plan",
            "text": "Implement a plan for managing DNS resolution between multiple Azure regions and when services fail over to another region",
            "waf": "Reliability",
            "service": "DNS",
            "guid": "18c80eb0-582a-4198-bf5c-d8800b2d263b",
            "id": "D03.10",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/paths/az-104-manage-virtual-networks/",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/private-link-and-dns-integration-at-scale#private-link-and-dns-integration-in-hub-and-spoke-network-architectures"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Internet",
            "text": "Use Azure Bastion to securely connect to your network.",
            "waf": "Security",
            "service": "Bastion",
            "guid": "ee1ac551-c4d5-46cf-b035-d0a3c50d87ad",
            "id": "D05.01",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/bastion/bastion-overview",
            "training": "https://learn.microsoft.com/training/modules/intro-to-azure-bastion/"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Internet",
            "text": "Use Azure Bastion in a subnet /26 or larger.",
            "waf": "Security",
            "service": "Bastion",
            "guid": "6eab9eb6-762b-485e-8ea8-15aa5dba0bd0",
            "id": "D05.02",
            "severity": "Medium",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,subnets=properties.subnets | mv-expand subnets | project id, subnetName = subnets.name, subnetPrefix = subnets.properties.addressPrefix | extend subnetPrefixLength = split(subnetPrefix, '/')[1] | where subnetName == 'AzureBastionSubnet' | extend compliant = (subnetPrefixLength <= 26) | distinct id, compliant",
            "link": "https://learn.microsoft.com/azure/bastion/bastion-faq#subnet",
            "training": "https://learn.microsoft.com/training/modules/intro-to-azure-bastion/"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Internet",
            "text": "Use Azure Front Door and WAF policies to provide global protection across Azure regions for inbound HTTP/S connections to a landing zone.",
            "waf": "Security",
            "service": "WAF",
            "guid": "1d7aa9b6-4704-4489-a804-2d88e79d17b7",
            "id": "D05.03",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/afds-overview"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Internet",
            "text": "When using Azure Front Door and Azure Application Gateway to help protect HTTP/S apps, use WAF policies in Azure Front Door. Lock down Azure Application Gateway to receive traffic only from Azure Front Door.",
            "waf": "Security",
            "service": "WAF",
            "guid": "3b22a5a6-7e7a-48ed-9b30-e38c3f29812b",
            "id": "D05.04",
            "severity": "Low",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Internet",
            "text": "When WAFs and other reverse proxies are required for inbound HTTP/S connections, deploy them within a landing-zone virtual network and together with the apps that they're protecting and exposing to the internet.",
            "waf": "Security",
            "service": "WAF",
            "guid": "2363cefe-179b-4599-be0d-5973cd4cd21b",
            "id": "D05.05",
            "severity": "High",
            "training": "https://learn.microsoft.com/learn/paths/architect-network-infrastructure/",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Internet",
            "text": "Use Azure DDoS Network or IP Protection plans to help protect Public IP Addresses endpoints within the virtual networks including application landing zones.",
            "waf": "Security",
            "service": "VNet",
            "guid": "088137f5-e6c4-4cfd-9e50-4547c2447ec6",
            "id": "D05.06",
            "severity": "High",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "link": "https://learn.microsoft.com/azure/ddos-protection/ddos-protection-reference-architectures"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Internet",
            "text": "Plan for how to manage your network outbound traffic configuration and strategy before the upcoming breaking change. On September 30, 2025, default outbound access for new deployments will be retired and only explicit access configurations will be allowed.",
            "waf": "Reliability",
            "service": "VNet",
            "guid": "b034c01e-110b-463a-b36e-e3346e57f225",
            "id": "D05.07",
            "severity": "High",
            "link": "https://learn.microsoft.com/azure/virtual-network/ip-services/default-outbound-access",
            "training": "https://learn.microsoft.com/training/modules/configure-virtual-networks/"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Internet",
            "text": "Add diagnostic settings to save DDoS related logs for all the protected public IP addresses (DDoS IP or Network Protection).",
            "waf": "Security",
            "service": "VNet",
            "guid": "b1c82a3f-2320-4dfa-8972-7ae4823c8930",
            "id": "D05.08",
            "severity": "High",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "link": "https://learn.microsoft.com/azure/ddos-protection/ddos-protection-reference-architectures"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Internet",
            "text": "Ensure there is a policy assignment to deny Public IP addresses directly tied to Virtual Machines.  Use exclusions if public IPs are needed on specific VMs.",
            "waf": "Security",
            "service": "Policy",
            "guid": "3c5a808d-c695-4c14-a63c-c7ab7a510e41",
            "id": "D05.08",
            "severity": "High",
            "link": "https://github.com/Azure/Enterprise-Scale/wiki/ALZ-Policies#corp",
            "training": "https://learn.microsoft.com/training/modules/configure-azure-policy/"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Hybrid",
            "text": "Use ExpressRoute as the primary connection to Azure.  Use VPNs as a source of backup connectivity.",
            "waf": "Performance",
            "service": "ExpressRoute",
            "guid": "359c373e-7dd6-4162-9a36-4a907ecae48e",
            "id": "D06.01",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/connectivity-to-azure"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Hybrid",
            "text": "When you use multiple ExpressRoute circuits or multiple on-prem locations, use BGP attributes to optimize routing.",
            "description": "You can use AS-path prepending and connection weights to influence traffic from Azure to on-premises, and the full range of BGP attributes in your own routers to influence traffic from on-premises to Azure.",
            "waf": "Reliability",
            "service": "ExpressRoute",
            "guid": "f29812b2-363c-4efe-879b-599de0d5973c",
            "id": "D06.02",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-routing"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Hybrid",
            "text": "Select the right SKU for the ExpressRoute/VPN gateways based on bandwidth and performance requirements.",
            "waf": "Performance",
            "service": "ExpressRoute",
            "guid": "d4cd21b0-8813-47f5-b6c4-cfd3e504547c",
            "id": "D06.03",
            "severity": "Medium",
            "graph": "resources| where type == 'microsoft.network/virtualnetworkgateways'| where properties.gatewayType =~ 'vpn' or properties.gatewayType == 'ExpressRoute'| extend SKUName = properties.sku.name, SKUTier = properties.sku.tier, Type = properties.gatewayType| extend compliant = SKUTier !in ('Basic', 'Standard')| project name, id, subscriptionId, resourceGroup, compliant",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-about-virtual-network-gateways?source=recommendations#gwsku"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Hybrid",
            "text": "Ensure that you're using unlimited-data ExpressRoute circuits only if you reach the bandwidth that justifies their cost.",
            "waf": "Cost",
            "service": "ExpressRoute",
            "guid": "7025b442-f6e9-4af6-b11f-c9574916016f",
            "id": "D06.04",
            "severity": "High",
            "graph": "resources | where type=='microsoft.network/expressroutecircuits' | extend compliant = (tolower(sku.family) == 'metereddata' or tolower(sku.tier) == 'local') | distinct id,compliant",
            "link": "https://learn.microsoft.com/azure/expressroute/plan-manage-cost",
            "training": "https://learn.microsoft.com/training/modules/design-implement-azure-expressroute/"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Hybrid",
            "text": "Leverage the Local SKU of ExpressRoute to reduce the cost of your circuits, if your circuit peering location supports your Azure regions for the Local SKU.",
            "waf": "Cost",
            "service": "ExpressRoute",
            "guid": "f4e7926a-ec35-476e-a412-5dd17136bd62",
            "id": "D06.05",
            "severity": "High",
            "graph": "resources | where type=='microsoft.network/connections' | where properties.connectionType == 'ExpressRoute' | project id, gwid=tostring(properties.virtualNetworkGateway1.id), circuitid=tostring(properties.peer.id) | join (resources | where type=='microsoft.network/expressroutecircuits' | project circuitid=tostring(id), circuitsku=sku.tier) on circuitid | project id=gwid, compliant = (circuitsku == 'Local') | summarize compliant=max(compliant) by id",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-faqs#expressroute-local",
            "training": "https://learn.microsoft.com/training/modules/design-implement-azure-expressroute/"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Hybrid",
            "text": "Deploy a zone-redundant ExpressRoute gateway in the supported Azure regions.",
            "waf": "Reliability",
            "service": "ExpressRoute",
            "guid": "2447ec66-138a-4720-8f1c-e16ed301d6e8",
            "id": "D06.06",
            "severity": "Medium",
            "graph": "resources| where type == 'microsoft.network/virtualnetworkgateways'| where properties.gatewayType =~ 'vpn' or properties.gatewayType == 'ExpressRoute'| extend SKUName = properties.sku.name, SKUTier = properties.sku.tier, Type = properties.gatewayType| extend compliant = SKUTier contains 'AZ'| project name, id, subscriptionId, resourceGroup, Type, compliant",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-about-virtual-network-gateways"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Hybrid",
            "text": "For scenarios that require bandwidth higher than 10 Gbps or dedicated 10/100-Gbps ports, use ExpressRoute Direct.",
            "waf": "Performance",
            "service": "ExpressRoute",
            "guid": "72e52e36-11cc-458b-9a4b-1511e43a58a9",
            "id": "D06.07",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/connectivity-to-azure"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Hybrid",
            "text": "When low latency is required, or throughput from on-premises to Azure must be greater than 10 Gbps, enable FastPath to bypass the ExpressRoute gateway from the data path.",
            "waf": "Performance",
            "service": "ExpressRoute",
            "guid": "c2299c4d-7b57-4d0c-9555-62f2b3e4563a",
            "id": "D06.08",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "link": "https://learn.microsoft.com/azure/expressroute/about-fastpath"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Hybrid",
            "text": "Use zone-redundant VPN gateways to connect branches or remote locations to Azure (where available).",
            "waf": "Reliability",
            "service": "VPN",
            "guid": "4d873974-8b66-42d6-b15f-512a65498f6d",
            "id": "D06.09",
            "severity": "Medium",
            "graph": "resources | where type=='microsoft.network/virtualnetworkgateways' | where properties.gatewayType == 'Vpn' | extend compliant = (tolower(properties.sku.name) contains 'az') | distinct id, compliant",
            "training": "https://learn.microsoft.com/training/modules/intro-to-azure-vpn-gateway/",
            "link": "https://learn.microsoft.com/azure/vpn-gateway/create-zone-redundant-vnet-gateway"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Hybrid",
            "text": "Use redundant VPN appliances on-premises (active/active or active/passive).",
            "waf": "Reliability",
            "service": "VPN",
            "guid": "45866df8-cf85-4ca9-bbe2-65ec1478919e",
            "id": "D06.10",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/training/modules/intro-to-azure-vpn-gateway/",
            "link": "https://learn.microsoft.com/azure/vpn-gateway/vpn-gateway-highlyavailable"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Hybrid",
            "text": "If using ExpressRoute Direct, consider using ExpressRoute Local circuits to the local Azure regions to save costs.",
            "waf": "Cost",
            "service": "ExpressRoute",
            "guid": "718cb437-b060-2589-8856-2e93a5c6633b",
            "id": "D06.11",
            "severity": "High",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-erdirect-about"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Hybrid",
            "text": "When traffic isolation or dedicated bandwidth is required, such as for separating production and nonproduction environments, use different ExpressRoute circuits. It will help you ensure isolated routing domains and alleviate noisy-neighbor risks.",
            "waf": "Security",
            "service": "ExpressRoute",
            "guid": "8042d88e-79d1-47b7-9b22-a5a67e7a8ed4",
            "id": "D06.12",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "link": "https://learn.microsoft.com/azure/architecture/framework/services/networking/expressroute/reliability"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Hybrid",
            "text": "Monitor ExpressRoute availability and utilization using built-in Express Route Insights.",
            "waf": "Operations",
            "service": "ExpressRoute",
            "guid": "b30e38c3-f298-412b-8363-cefe179b599d",
            "id": "D06.13",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-monitoring-metrics-alerts"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Hybrid",
            "text": "Use Connection Monitor for connectivity monitoring across the network, especially between on-premises and Azure.",
            "waf": "Operations",
            "service": "ExpressRoute",
            "guid": "5bf68dc9-325e-4873-bf88-f8214ef2e5d2",
            "id": "D06.14",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "link": "https://learn.microsoft.com/azure/expressroute/how-to-configure-connection-monitor"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Hybrid",
            "text": "Use ExpressRoute circuits from different peering locations for redundancy.",
            "waf": "Reliability",
            "service": "ExpressRoute",
            "guid": "e0d5973c-d4cd-421b-8881-37f5e6c4cfd3",
            "id": "D06.15",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "link": "https://learn.microsoft.com/azure/expressroute/designing-for-disaster-recovery-with-expressroute-privatepeering#need-for-redundant-connectivity-solution",
            "graph": "resources | where type=='microsoft.network/connections' | where properties.connectionType == 'ExpressRoute' | project cxId=id, gwId=tostring(properties.virtualNetworkGateway1.id), circuitId=tostring(properties.peer.id) | join (resources | where type=='microsoft.network/expressroutecircuits' | project circuitId=tostring(id), circuitLocation=tostring(properties.serviceProviderProperties.peeringLocation)) on circuitId | distinct gwId, circuitLocation | summarize countErLocations=count() by id=gwId | extend compliant = (countErLocations >= 2)"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Hybrid",
            "text": "Use site-to-site VPN as failover of ExpressRoute, if only using a single ExpressRoute circuit.",
            "waf": "Reliability",
            "service": "ExpressRoute",
            "guid": "cf3fe65c-fec0-495a-8edc-9675200f2add",
            "id": "D06.16",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-howto-coexist-resource-manager",
            "training": "https://learn.microsoft.com/training/modules/design-implement-azure-expressroute/"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Hybrid",
            "text": "If you are using a route table in the GatewaySubnet, make sure that gateway routes are propagated.",
            "waf": "Reliability",
            "service": "ExpressRoute",
            "guid": "72105cc8-aaea-4ee1-8c7a-ad25977afcaf",
            "id": "D06.17",
            "severity": "High",
            "link": "https://learn.microsoft.com/azure/vpn-gateway/vpn-gateway-about-vpn-gateway-settings#gwsub",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,resourceGroup,name,subnets=properties.subnets | mv-expand subnets | project id,resourceGroup,name,subnetName=tostring(subnets.name),routeTableId=tostring(subnets.properties.routeTable.id) | where subnetName == 'GatewaySubnet' | join kind=leftouter (Resources | where type == 'microsoft.network/routetables' | project routeTableName=name,routeTableId=id, disableBgpRoutePropagation=properties.disableBgpRoutePropagation) on routeTableId | project id,compliant = (disableBgpRoutePropagation == False or isnull(disableBgpRoutePropagation))"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Hybrid",
            "text": "If using ExpressRoute, your on-premises routing should be dynamic: in the event of a connection failure it should converge to the remaining connection of the circuit. Load should be shared across both connections ideally as active/active, although active/passive is supported too.",
            "waf": "Reliability",
            "service": "ExpressRoute",
            "guid": "d581a947-69a2-4783-942e-9df3664324c8",
            "id": "D06.18",
            "severity": "High",
            "link": "https://learn.microsoft.com/azure/expressroute/designing-for-high-availability-with-expressroute#active-active-connections",
            "training": "https://learn.microsoft.com/training/modules/design-implement-azure-expressroute/"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Hybrid",
            "text": "Ensure the two physical links of your ExpressRoute circuit are connected to two distinct edge devices in your network.",
            "waf": "Reliability",
            "service": "ExpressRoute",
            "guid": "b258f058-b9f6-46cd-b28d-990106f0c3f8",
            "id": "D06.19",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "link": "https://learn.microsoft.com/azure/expressroute/designing-for-high-availability-with-expressroute"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Hybrid",
            "text": "Ensure Bidirectional Forwarding Detection (BFD) is enabled and configured on customer or provider edge routing devices.",
            "waf": "Reliability",
            "service": "ExpressRoute",
            "guid": "fe2a1b53-6fbd-4c67-b58a-85d7c7a0afcb",
            "id": "D06.20",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-bfd"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Hybrid",
            "text": "Connect the ExpressRoute Gateway to two or more circuits from different peering locations for higher resiliency.",
            "waf": "Reliability",
            "service": "ExpressRoute",
            "guid": "669b215a-ce43-4371-8f6f-11047f6490f1",
            "id": "D06.22",
            "severity": "High",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "link": "https://learn.microsoft.com/azure/expressroute/designing-for-disaster-recovery-with-expressroute-privatepeering"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Hybrid",
            "text": "Configure diagnostic logs and alerts for ExpressRoute virtual network gateway.",
            "waf": "Operations",
            "service": "ExpressRoute",
            "guid": "3f79ed00-203b-4c95-9efd-691505f5a1f9",
            "id": "D06.23",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "link": "https://learn.microsoft.com/azure/vpn-gateway/vpn-gateway-howto-setup-alerts-virtual-network-gateway-log"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Hybrid",
            "text": "Do not use ExpressRoute circuits for VNet-to-VNet communication.",
            "waf": "Performance",
            "service": "ExpressRoute",
            "guid": "5234c93f-b651-41dd-80c1-234177b91ced",
            "id": "D06.24",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "link": "https://learn.microsoft.com/azure/expressroute/virtual-network-connectivity-guidance"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Hybrid",
            "text": "Do not send Azure traffic to hybrid locations for inspection.  Instead, follow the principle 'traffic in Azure stays in Azure' so that communication across resources in Azure occurs via the Microsoft backbone network.",
            "waf": "Performance",
            "service": "N/A",
            "guid": "8ac6a9e0-1e6a-483d-b5de-32c199248160",
            "id": "D06.25",
            "severity": "Low",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/azure-virtual-desktop/eslz-network-topology-and-connectivity"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Firewall",
            "text": "Use Azure Firewall to govern Azure outbound traffic to the internet, non-HTTP/S inbound connections, and East/West traffic filtering (if the organization requires it).",
            "waf": "Security",
            "service": "Firewall",
            "guid": "e6c4cfd3-e504-4547-a244-7ec66138a720",
            "id": "D07.01",
            "severity": "High",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "link": "https://learn.microsoft.com/azure/firewall/overview"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Firewall",
            "text": "Create a global Azure Firewall policy to govern security posture across the global network environment and assign it to all Azure Firewall instances. Allow for granular policies to meet requirements of specific regions by delegating incremental firewall policies to local security teams via Azure role-based access control.",
            "waf": "Security",
            "service": "Firewall",
            "guid": "5a4b1511-e43a-458a-ac22-99c4d7b57d0c",
            "id": "D07.02",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "link": "https://learn.microsoft.com/azure/firewall-manager/policy-overview"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Firewall",
            "text": "Configure supported partner SaaS security providers within Firewall Manager if the organization wants to use such solutions to help protect outbound connections.",
            "waf": "Security",
            "service": "Firewall",
            "guid": "655562f2-b3e4-4563-a4d8-739748b662d6",
            "id": "D07.03",
            "severity": "Low",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "link": "https://learn.microsoft.com/azure/firewall-manager/deploy-trusted-security-partner"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Firewall",
            "text": "Use application rules to filter outbound traffic on destination host name for supported protocols.  Use FQDN-based network rules and Azure Firewall with DNS proxy to filter egress traffic to the Internet over other protocols.",
            "waf": "Security",
            "service": "Firewall",
            "guid": "14d99880-2f88-47e8-a134-62a7d85c94af",
            "id": "D07.04",
            "severity": "High",
            "graph": "resources | where type=='microsoft.network/firewallpolicies' | extend compliant = (properties.dnsSettings.enableProxy == true) | distinct id,compliant",
            "link": "https://learn.microsoft.com/azure/firewall/fqdn-filtering-network-rules",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Firewall",
            "text": "Use Azure Firewall Premium to enable additional security features.",
            "waf": "Security",
            "service": "Firewall",
            "guid": "c10d51ef-f999-455d-bba0-5c90ece07447",
            "id": "D07.05",
            "severity": "High",
            "graph": "resources | where type=='microsoft.network/firewallpolicies' | extend compliant = (properties.sku.tier == 'Premium') | distinct id,compliant",
            "link": "https://learn.microsoft.com/azure/firewall/premium-features",
            "training": "https://learn.microsoft.com/training/modules/introduction-azure-firewall/"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Firewall",
            "text": "Configure Azure Firewall Threat Intelligence mode to Alert and Deny for additional protection.",
            "waf": "Security",
            "service": "Firewall",
            "guid": "e9c8f584-6d5e-473b-8dc5-acc9fbaab4e3",
            "id": "D07.06",
            "severity": "High",
            "graph": "resources | where type=='microsoft.network/firewallpolicies' | extend compliant = (properties.threatIntelMode == 'Deny') | distinct id,compliant",
            "link": "https://learn.microsoft.com/azure/firewall/premium-features#idps-signature-rules"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Firewall",
            "text": "Configure Azure Firewall IDPS mode to Deny for additional protection.",
            "waf": "Security",
            "service": "Firewall",
            "guid": "b9d0dff5-bdd4-4cd8-88ed-5811610b2b2c",
            "id": "D07.07",
            "severity": "High",
            "graph": "resources | where type=='microsoft.network/firewallpolicies' | extend compliant = (properties.intrusionDetection.mode == 'Deny') | project id, compliant",
            "link": "https://learn.microsoft.com/azure/firewall/premium-features#idps",
            "training": "https://learn.microsoft.com/training/modules/introduction-azure-firewall/"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Firewall",
            "text": "For subnets in VNets not connected to Virtual WAN, attach a route table so that Internet traffic is redirected to Azure Firewall or a Network Virtual Appliance.",
            "waf": "Security",
            "service": "Firewall",
            "guid": "a3784907-9836-4271-aafc-93535f8ec08b",
            "id": "D07.08",
            "severity": "High",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,resourceGroup,name,subnets=properties.subnets | mv-expand subnets | project id,name,subnetId=tostring(subnets.id), subnetName=tostring(subnets.name),subnetRT=subnets.properties.routeTable.id | where not (subnetName in ('GatewaySubnet', 'AzureFirewallSubnet', 'RouteServerSubnet', 'AzureBastionSubnet')) | extend hasRT = isnotnull(subnetRT) | distinct id, hasRT, subnetId | join kind=fullouter (resources | where type == 'microsoft.network/virtualnetworks' | mvexpand properties.virtualNetworkPeerings | extend isVWAN=(tolower(split(properties_virtualNetworkPeerings.name, '_')[0]) == 'remotevnettohubpeering') | mv-expand properties.subnets | project id, isVWAN, name, subnetId=tostring(properties_subnets.id), subnetName=tostring(properties_subnets.name) | summarize PeeredToVWAN=max(isVWAN) by id, subnetId | project id, subnetId, isVWANpeer = (PeeredToVWAN == true)) on subnetId | project id=iff(isnotempty(id), id, id1), subnetId=iff(isnotempty(subnetId), subnetId, subnetId1), hasRT, isVWANpeer | extend compliant = (hasRT==true or isVWANpeer==true) | distinct id, subnetId, compliant",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-networks-udr-overview"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Firewall",
            "text": "Add diagnostic settings to save logs, using the Resource Specific destination table, for all Azure Firewall deployments.",
            "waf": "Operations",
            "service": "Firewall",
            "guid": "715d833d-4708-4527-90ac-1b142c7045ba",
            "id": "D07.09",
            "severity": "High",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "link": "https://learn.microsoft.com/azure/firewall/firewall-structured-logs"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Firewall",
            "text": "Migrate from Azure Firewall Classic rules (if exist) to Firewall Policy.",
            "waf": "Operations",
            "service": "Firewall",
            "guid": "e960fc6b-4ab2-4db6-9609-3745135f9ffa",
            "id": "D07.10",
            "severity": "High",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "link": "https://learn.microsoft.com/azure/firewall-manager/migrate-to-policy"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Segmentation",
            "text": "Use a /26 prefix for your Azure Firewall subnets.",
            "waf": "Security",
            "service": "Firewall",
            "guid": "22d6419e-b627-4d95-9e7d-019fa759387f",
            "id": "D07.11",
            "severity": "High",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,subnets=properties.subnets | mv-expand subnets | project id, subnetName = subnets.name, subnetPrefix = subnets.properties.addressPrefix | extend subnetPrefixLength = split(subnetPrefix, '/')[1] | where subnetName == 'AzureFirewallSubnet' | extend compliant = (subnetPrefixLength == 26) | distinct id, compliant",
            "link": "https://learn.microsoft.com/azure/firewall/firewall-faq#why-does-azure-firewall-need-a--26-subnet-size",
            "training": "https://learn.microsoft.com/training/modules/introduction-azure-firewall/"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Firewall",
            "text": "Arrange rules within the firewall policy into Rule Collection Groups and Rule Collections and based on their frequency of use.",
            "waf": "Performance",
            "service": "Firewall",
            "guid": "828cec2e-af6c-40c2-8fa2-1b681ee63eb7",
            "id": "D07.12",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/firewall-manager/rule-hierarchy",
            "training": "https://learn.microsoft.com/training/modules/intro-to-azure-firewall-manager/"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Firewall",
            "text": "Use IP Groups or IP prefixes to reduce number of IP table rules.",
            "waf": "Performance",
            "service": "Firewall",
            "guid": "0da83bb1-2f39-49af-b5c9-835fc455e3d1",
            "id": "D07.12",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/firewall/ip-groups"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Firewall",
            "text": "Do not use wildcards as a source IP for DNATS, such as * or any, you should specify source IPs for incoming DNATs.",
            "waf": "Performance",
            "service": "Firewall",
            "guid": "c44c6f0e-1642-4a61-a17b-0922f835c93a",
            "id": "D07.13",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/firewall/tutorial-firewall-dnat",
            "training": "https://learn.microsoft.com/training/modules/introduction-to-azure-virtual-networks/"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Firewall",
            "text": "Prevent SNAT Port exhaustion by monitoring SNAT port usage, evaluating NAT Gateway settings, and ensuring seamless failover. If the port count approaches the limit, it\u2019s a sign that SNAT exhaustion might be imminent.",
            "waf": "Performance",
            "service": "Firewall",
            "guid": "7371dc21-251a-47a3-af14-6e01b9da4757",
            "id": "D07.14",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/firewall/integrate-with-nat-gateway",
            "training": "https://learn.microsoft.com/training/modules/introduction-to-azure-virtual-networks/"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Firewall",
            "text": "If you are using Azure Firewall Premium, enable TLS Inspection.",
            "waf": "Performance",
            "service": "Firewall",
            "guid": "346840b8-1064-496e-8396-4b1340172d52",
            "id": "D07.15",
            "severity": "High",
            "link": "https://learn.microsoft.com/azure/firewall/premium-features#tls-inspection"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Firewall",
            "text": "Use web categories to allow or deny outbound access to specific topics.",
            "waf": "Performance",
            "service": "Firewall",
            "guid": "39990a13-915c-45f9-a2d3-562d7d6c4b7c",
            "id": "D07.16",
            "severity": "Low",
            "link": "https://learn.microsoft.com/azure/firewall/premium-features#web-categories"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Firewall",
            "text": "As part of your TLS inspection, plan for receiving traffic from Azure App Gateways for inspection.",
            "waf": "Performance",
            "service": "Firewall",
            "guid": "6eff7e6c-6c4a-43d7-be3f-6641c2cb3d4a",
            "id": "D07.17",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/architecture/example-scenario/gateway/application-gateway-before-azure-firewall",
            "training": "https://learn.microsoft.com/training/modules/configure-azure-application-gateway/"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Firewall",
            "text": "Enable Azure Firewall DNS proxy configuration.",
            "waf": "Security",
            "service": "Firewall",
            "guid": "94f3eede-9aa3-4088-92a3-bb9a56509fad",
            "id": "D07.18",
            "severity": "Medium",
            "graph": "resources | where type =~ 'Microsoft.Network/firewallPolicies' | where array_length(properties.firewalls) > 0 | extend compliant = (properties.dnsSettings.enableProxy =~ 'true') | distinct id, compliant",
            "link": "https://learn.microsoft.com/azure/firewall/dns-details",
            "training": "https://learn.microsoft.com/training/courses/az-700t00/"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Firewall",
            "text": "Implement backups for your firewall rules",
            "waf": "Operations",
            "service": "Firewall",
            "guid": "64e7000e-3c06-485e-b455-ced7f454cba3",
            "id": "D07.20",
            "severity": "Low",
            "link": "https://learn.microsoft.com/azure/well-architected/service-guides/azure-firewall",
            "training": "https://learn.microsoft.com/training/courses/az-104t00/"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Firewall",
            "text": "Deploy Azure Firewall across multiple availability zones. Azure Firewall offers different SLAs depending on its deployment; in a single availability zone or across multiple, potentially improving reliability and performance.",
            "waf": "Reliability",
            "service": "Firewall",
            "guid": "d38ad60c-bc9e-4d49-b699-97e5d4dcf707",
            "id": "D07.21",
            "severity": "High",
            "graph": "resources | where type == 'microsoft.network/azurefirewalls' | where array_length(zones) <= 1 or isnull(zones) | where isempty(properties.virtualHub.id) or isnull(properties.virtualHub.id) | project name, id, tags, param1='multipleZones:false'",
            "link": "https://learn.microsoft.com/azure/firewall/deploy-availability-zone-powershell",
            "training": "https://learn.microsoft.com/training/courses/az-104t00/"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Firewall",
            "text": "Configure DDoS Protection on the Azure Firewall VNet, Associate a DDoS protection plan with the virtual network hosting Azure Firewall to provide enhanced mitigation against DDoS attacks. Azure Firewall Manager integrates the creation of firewall infrastructure and DDoS protection plans. ",
            "waf": "Reliability",
            "service": "Firewall",
            "guid": "e8143efa-0301-4d62-be54-ca7b5ce566dc",
            "id": "D07.22",
            "severity": "High",
            "graph": "resources | where type =~ 'Microsoft.Network/azureFirewalls' | where isempty(properties.virtualHub.id) or isnull(properties.virtualHub.id) | mv-expand ipConfig = properties.ipConfigurations | project name, firewallId = id, tags, vNetName = split(ipConfig.properties.subnet.id, '/', 8)[0], vNetId = tolower(substring(ipConfig.properties.subnet.id, 0, indexof(ipConfig.properties.subnet.id, '/subnet'))) | join kind=fullouter ( resources | where type =~ 'Microsoft.Network/ddosProtectionPlans' | mv-expand vNet = properties.virtualNetworks | project ddosProtectionPlanId = id, vNetId = tolower(vNet.id) ) on vNetId | extend compliant = iif(isempty(ddosProtectionPlanId), false, true) | project name, compliant, id = firewallId, tags, network = strcat('vNet: ', vNetName)",
            "link": "https://learn.microsoft.com/en-gb/azure/ddos-protection/ddos-protection-overview"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "PaaS",
            "text": "Do not disrupt control-plane communication for Azure PaaS services injected into a virtual networks, such as with a 0.0.0.0/0 route or an NSG rule that blocks control plane traffic.",
            "waf": "Security",
            "service": "App Gateway",
            "guid": "d301d6e8-72e5-42e3-911c-c58b5a4b1511",
            "id": "D07.23",
            "severity": "High",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/?source=learn",
            "link": "https://learn.microsoft.com/azure/virtual-network/vnet-integration-for-azure-services"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "PaaS",
            "text": "Use Private Link, where available, for shared Azure PaaS services.",
            "waf": "Security",
            "guid": "e43a58a9-c229-49c4-b7b5-7d0c655562f2",
            "id": "D08.02",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "link": "https://learn.microsoft.com/azure/private-link/private-link-overview"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "PaaS",
            "text": "Access Azure PaaS services from on-premises via private endpoints and ExpressRoute private peering. This method avoids transiting over the public internet.",
            "waf": "Security",
            "service": "ExpressRoute",
            "guid": "b3e4563a-4d87-4397-98b6-62d6d15f512a",
            "id": "D08.03",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "link": "https://learn.microsoft.com/azure/private-link/private-endpoint-overview"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "PaaS",
            "text": "Don't enable virtual network service endpoints by default on all subnets.",
            "waf": "Security",
            "service": "VNet",
            "guid": "4704489a-8042-4d88-b79d-17b73b22a5a6",
            "id": "D08.04",
            "severity": "High",
            "graph": "resources | where type =~ 'microsoft.network/virtualnetworks' | project id,resourceGroup,name,subnets = properties.subnets | mv-expand subnets | project id = subnets.id, resourceGroup, VNet = name, serviceEndpoints = subnets.properties.serviceEndpoints, compliant = (isnull(subnets.properties.serviceEndpoints) or array_length(subnets.properties.serviceEndpoints) == 0) | order by compliant asc",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/?source=learn",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-network-service-endpoints-overview"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "PaaS",
            "text": "Filter egress traffic to Azure PaaS services using FQDNs instead of IP addresses in Azure Firewall or an NVA to prevent data exfiltration. If using Private Link you can block all FQDNs, otherwise allow only the required PaaS services.",
            "waf": "Security",
            "service": "Firewall",
            "guid": "7e7a8ed4-b30e-438c-9f29-812b2363cefe",
            "id": "D08.05",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/?source=learn",
            "link": "azure/private-link/inspect-traffic-with-azure-firewall"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Segmentation",
            "text": "Use at least a /27 prefix for your Gateway subnets.",
            "waf": "Security",
            "service": "ExpressRoute",
            "guid": "f2aad7e3-bb03-4adc-8606-4123d342a917",
            "id": "D09.01",
            "severity": "High",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,subnets=properties.subnets | mv-expand subnets | project id, subnetName = subnets.name, subnetPrefix = subnets.properties.addressPrefix | extend subnetPrefixLength = split(subnetPrefix, '/')[1] | where subnetName == 'GatewaySubnet' | extend compliant = (subnetPrefixLength <= 27) | distinct id, compliant",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-howto-add-gateway-resource-manager#add-a-gateway"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Segmentation",
            "text": "Don't rely on the NSG inbound default rules using the VirtualNetwork service tag to limit connectivity.",
            "waf": "Security",
            "service": "NSG",
            "guid": "11deb39d-8299-4e47-bbe0-0fb5a36318a8",
            "id": "D09.02",
            "severity": "High",
            "graph": "resources | where type=='microsoft.network/networksecuritygroups' | mvexpand properties.securityRules | project id,name,ruleAction=properties_securityRules.properties.access,rulePriority=properties_securityRules.properties.priority,ruleDst=properties_securityRules.properties.destinationAddressPrefix,ruleSrc=properties_securityRules.properties.sourceAddressPrefix,ruleProt=properties_securityRules.properties.protocol,ruleDirection=properties_securityRules.properties.direction,rulePort=properties_securityRules.properties.destinationPortRange | summarize StarDenies=countif(ruleAction=='Deny' and ruleDst=='*' and ruleSrc=='*' and ruleProt=='*' and rulePort=='*') by id,tostring(ruleDirection) | where ruleDirection == 'Inbound' | project id,compliant=(StarDenies>0) | union (resources | where type=='microsoft.network/networksecuritygroups' | where array_length(properties.securityRules)==0 | extend compliant=false | project id,compliant)",
            "link": "https://learn.microsoft.com/azure/virtual-network/service-tags-overview#available-service-tags"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Segmentation",
            "text": "Delegate subnet creation to the landing zone owner.",
            "waf": "Security",
            "guid": "c2447ec6-6138-4a72-80f1-ce16ed301d6e",
            "id": "D09.03",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/paths/implement-resource-mgmt-security/",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-landing-zone-network-segmentation"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Segmentation",
            "text": "Use NSGs to help protect traffic across subnets, as well as east/west traffic across the platform (traffic between landing zones).",
            "waf": "Security",
            "service": "NSG",
            "guid": "872e52e3-611c-4c58-a5a4-b1511e43a58a",
            "id": "D09.04",
            "severity": "Medium",
            "graph": "resources | where type == 'microsoft.network/virtualnetworks' | mv-expand subnet = properties.subnets | where subnet.name !in~ ('GatewaySubnet', 'AzureFirewallSubnet', 'AzureFirewallManagementSubnet', 'RouteServerSubnet') | extend compliant = iff(isnotnull(subnet.properties.networkSecurityGroup.id), true, false) | project id, subnetName = subnet.name, vnetName = name, NSG = subnet.properties.networkSecurityGroup.id, compliant",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-landing-zone-network-segmentation"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Segmentation",
            "text": "Use NSGs and application security groups to micro-segment traffic within the landing zone and avoid using a central NVA to filter traffic flows.",
            "waf": "Security",
            "service": "NSG",
            "guid": "a4d87397-48b6-462d-9d15-f512a65498f6",
            "id": "D09.05",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/",
            "link": "https://learn.microsoft.com/azure/virtual-network/network-security-group-how-it-works"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Segmentation",
            "text": "Enable VNet Flow Logs and feed them into Traffic Analytics to gain insights into internal and external traffic flows.",
            "waf": "Security",
            "service": "NSG",
            "guid": "dfe237de-143b-416c-91d7-aa9b64704489",
            "id": "D09.06",
            "severity": "Medium",
            "graph": "resources | where type =~ 'Microsoft.Network/virtualnetworks' | project subscriptionId, lowerCaseVNetId = tolower(id) | join kind = leftouter (    resources    | where type =~ 'microsoft.network/networkwatchers/flowlogs' and properties.enabled == true and properties.provisioningState =~ 'succeeded'    | where properties.targetResourceId contains '/Microsoft.Network/virtualNetworks/'    | project flowlogId = id, trafficAnalyticsEnabled = properties.flowAnalyticsConfiguration.networkWatcherFlowAnalyticsConfiguration.enabled, lowerCaseTargetVNetId = tolower(properties.targetResourceId)    )    on $left.lowerCaseVNetId == $right.lowerCaseTargetVNetId | extend compliant = iff(isnotempty(lowerCaseTargetVNetId), true, false) | project id = lowerCaseVNetId, flowlogId, trafficAnalyticsEnabled, compliant",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-network-monitoring/",
            "link": "https://learn.microsoft.com/azure/network-watcher/vnet-flow-logs-overview"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Segmentation",
            "text": "Do not implement more than 900 NSG rules per NSG, due to the limit of 1000 rules.",
            "waf": "Reliability",
            "service": "NSG",
            "guid": "0390417d-53dc-44d9-b3f4-c8832f359b41",
            "id": "D09.07",
            "severity": "Medium",
            "graph": "resources | where type == 'microsoft.network/networksecuritygroups' | project id, rules = array_length(properties.securityRules) | project id, compliant = (rules < 900)",
            "training": "https://learn.microsoft.com/azure/virtual-network/network-security-group-how-it-works",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Virtual WAN",
            "text": "Use Virtual WAN if your scenario is explicitly described in the list of Virtual WAN routing designs.",
            "waf": "Operations",
            "service": "VWAN",
            "guid": "412e7f98-3f63-4047-82dd-69c5b5c2622f",
            "id": "D10.01",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/modules/introduction-azure-virtual-wan/",
            "link": "https://learn.microsoft.com/azure/virtual-wan/scenario-any-to-any"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Virtual WAN",
            "text": "Use a Virtual WAN hub per Azure region to connect multiple landing zones together across Azure regions via a common global Azure Virtual WAN.",
            "waf": "Performance",
            "service": "VWAN",
            "guid": "54b69bad-33aa-4d5e-ac68-e1d76667313b",
            "id": "D10.02",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/virtual-wan-network-topology#virtual-wan-network-design-recommendationst",
            "training": "https://learn.microsoft.com/training/modules/introduction-azure-virtual-wan/"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Virtual WAN",
            "text": "For outbound Internet traffic protection and filtering, deploy Azure Firewall in secured hubs.",
            "waf": "Security",
            "service": "VWAN",
            "guid": "7d5d1e4e-6146-458d-9558-fd77249b8211",
            "id": "D10.03",
            "severity": "Medium",
            "graph": "resources | where type=='microsoft.network/virtualhubs' | extend compliant = isnotnull(properties.azureFirewall.id) | project id, compliant",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "link": "https://learn.microsoft.com/azure/virtual-wan/howto-firewall"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Virtual WAN",
            "text": "Ensure that your virtual WAN network architecture aligns to an identified architecture scenario.",
            "waf": "Reliability",
            "service": "VWAN",
            "guid": "6667313b-4f56-464b-9e98-4a859c773e7d",
            "id": "D10.04",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/virtual-wan/migrate-from-hub-spoke-topology",
            "training": "https://learn.microsoft.com/training/modules/introduction-azure-virtual-wan/"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Virtual WAN",
            "text": "Use Azure Monitor Insights for Virtual WAN to monitor the end-to-end topology of the Virtual WAN, status, and key metrics.",
            "waf": "Operations",
            "service": "VWAN",
            "guid": "261623a7-65a9-417e-8f34-8ef254c27d42",
            "id": "D10.05",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/virtual-wan/azure-monitor-insights",
            "training": "https://learn.microsoft.com/training/modules/introduction-azure-virtual-wan/"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Virtual WAN",
            "text": "Do not disable branch-to-branch traffic in Virtual WAN, unless these flows should be explicitly blocked.",
            "waf": "Reliability",
            "service": "VWAN",
            "guid": "727c77e1-b9aa-4a37-a024-129d042422c1",
            "id": "D10.06",
            "severity": "Medium",
            "graph": "resources| where type =~ 'microsoft.network/virtualwans' | extend compliant= (properties.allowBranchToBranchTraffic == 'true') | distinct id,compliant",
            "link": "https://learn.microsoft.com/azure/virtual-wan/virtual-wan-faq#is-branch-to-branch-connectivity-allowed-in-virtual-wan",
            "training": "https://learn.microsoft.com/training/modules/introduction-azure-virtual-wan/"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Virtual WAN",
            "text": "Use AS-Path as hub routing preference, since it is more flexible than ExpressRoute or VPN.",
            "waf": "Reliability",
            "service": "VWAN",
            "guid": "d49ac006-6670-4bc9-9948-d3e0a3a94f4d",
            "id": "D10.07",
            "severity": "Medium",
            "graph": "resources | where type =~ 'microsoft.network/virtualhubs'| extend compliant= (properties.hubRoutingPreference =~ 'ASPath') | distinct id,compliant",
            "link": "https://learn.microsoft.com/azure/virtual-wan/about-virtual-hub-routing-preference",
            "training": "https://learn.microsoft.com/training/modules/introduction-azure-virtual-wan/"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Virtual WAN",
            "text": "Configure label-based propagation in Virtual WAN, otherwise connectivity between virtual hubs will be impaired.",
            "waf": "Reliability",
            "service": "VWAN",
            "guid": "2586b854-237e-47f1-84a1-d45d4cd2310d",
            "id": "D10.08",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/virtual-wan/about-virtual-hub-routing#labels",
            "training": "https://learn.microsoft.com/training/modules/introduction-azure-virtual-wan/"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Virtual WAN",
            "text": "Assign at least a /23 prefix to virtual hubs to ensure enough IP space is available.",
            "waf": "Reliability",
            "service": "VWAN",
            "guid": "9c75dfef-573c-461c-a698-68598595581a",
            "id": "D10.09",
            "severity": "High",
            "graph": "resources | where type =~ 'microsoft.network/virtualhubs' | extend addressSpace = properties.addressPrefix | extend compliant= (toint(substring(addressSpace, indexof(addressSpace, '/') + 1)) < 23) | distinct name, id, compliant",
            "link": "https://learn.microsoft.com/azure/virtual-wan/virtual-wan-faq#what-is-the-recommended-hub-address-space-during-hub-creation",
            "training": "https://learn.microsoft.com/training/modules/introduction-azure-virtual-wan/"
        },
        {
            "category": "Governance",
            "subcategory": "Governance",
            "text": "Leverage Azure Policy strategically, define controls for your environment, using Policy Initiatives to group related policies.",
            "waf": "Security",
            "service": "Policy",
            "guid": "5c986cb2-9131-456a-8247-6e49f541acdc",
            "id": "E01.01",
            "severity": "High",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "training": "https://learn.microsoft.com/training/modules/configure-azure-policy/"
        },
        {
            "category": "Governance",
            "subcategory": "Governance",
            "text": "Map regulatory and compliance requirements to Azure Policy definitions and Azure role assignments.",
            "waf": "Security",
            "service": "Policy",
            "guid": "d8a2adb1-17d6-4326-af62-5ca44e5695f2",
            "id": "E01.03",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "training": "https://learn.microsoft.com/training/modules/governance-security/"
        },
        {
            "category": "Governance",
            "subcategory": "Governance",
            "text": "Establish Azure Policy definitions at the intermediate root management group so that they can be assigned at inherited scopes.",
            "waf": "Security",
            "service": "Policy",
            "guid": "223ace8c-b123-408c-a501-7f154e3ab369",
            "id": "E01.04",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "training": "https://learn.microsoft.com/training/modules/configure-azure-policy/"
        },
        {
            "category": "Governance",
            "subcategory": "Governance",
            "text": "Manage policy assignments at the highest appropriate level with exclusions at bottom levels, if required.",
            "waf": "Security",
            "service": "Policy",
            "guid": "3829e7e3-1618-4368-9a04-77a209945bda",
            "id": "E01.05",
            "severity": "High",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "training": "https://learn.microsoft.com/training/modules/configure-azure-policy/"
        },
        {
            "category": "Governance",
            "subcategory": "Governance",
            "text": "Use Azure Policy to control which services users can provision at the subscription/management group level.",
            "waf": "Security",
            "service": "Policy",
            "guid": "43334f24-9116-4341-a2ba-527526944008",
            "id": "E01.06",
            "severity": "Low",
            "link": "https://learn.microsoft.com/security/benchmark/azure/mcsb-asset-management#am-2-use-only-approved-services",
            "training": "https://learn.microsoft.com/training/modules/configure-azure-policy/"
        },
        {
            "category": "Governance",
            "subcategory": "Governance",
            "text": "Use built-in policies where possible to minimize operational overhead.",
            "waf": "Security",
            "service": "Policy",
            "guid": "be7d7e48-4327-46d8-adc0-55bcf619e8a1",
            "id": "E01.07",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "training": "https://learn.microsoft.com/training/modules/configure-azure-policy/"
        },
        {
            "category": "Governance",
            "subcategory": "Governance",
            "text": "Assign the built-in Resource Policy Contributor role at a particular scope to enable application-level governance.",
            "description": "Assigning the Resource Policy Contributor role to specific scopes allows you to delegate policy management to relevant teams. For instance, a central IT team may oversee management group-level policies, while application teams handle policies for their subscriptions, enabling distributed governance with adherence to organizational standards.",
            "waf": "Security",
            "service": "Policy",
            "guid": "3f988795-25d6-4268-a6d7-0ba6c97be995",
            "id": "E01.08",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview#azure-rbac-permissions-in-azure-policy",
            "training": "https://learn.microsoft.com/training/modules/configure-azure-policy/"
        },
        {
            "category": "Governance",
            "subcategory": "Governance",
            "text": "Limit the number of Azure Policy assignments made at the root management group scope to avoid managing through exclusions at inherited scopes.",
            "waf": "Security",
            "service": "Policy",
            "guid": "19048384-5c98-46cb-8913-156a12476e49",
            "id": "E01.09",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "training": "https://learn.microsoft.com/training/modules/configure-azure-policy/"
        },
        {
            "category": "Governance",
            "subcategory": "Governance",
            "text": "If any data sovereignty requirements exist, Azure Policies should be deployed to enforce them.",
            "waf": "Security",
            "service": "Policy",
            "guid": "5a917e1f-348e-4f25-9c27-d42e8bbac757",
            "id": "E01.10",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/paths/secure-your-cloud-data/",
            "link": "https://learn.microsoft.com/industry/release-plan/2023wave2/cloud-sovereignty/enable-data-sovereignty-policy-baseline"
        },
        {
            "category": "Governance",
            "subcategory": "Governance",
            "text": "For Sovereign Landing Zone, deploy sovereignty policy baseline and assign at correct management group level.",
            "waf": "Security",
            "service": "Policy",
            "guid": "78b22132-b41c-460b-a4d3-df8f73a67dc2",
            "id": "E01.11",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/sovereign-landing-zone"
        },
        {
            "category": "Governance",
            "subcategory": "Governance",
            "text": "For Sovereign Landing Zone, document Sovereign Control objectives to policy mapping.",
            "waf": "Security",
            "service": "Policy",
            "guid": "caeea0e9-1024-41df-a52e-d99c3f22a6f4",
            "id": "E01.12",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/industry/sovereignty/policy-portfolio-baseline"
        },
        {
            "category": "Governance",
            "subcategory": "Governance",
            "text": "For Sovereign Landing Zone, ensure process is in place for management of 'Sovereign Control objectives to policy mapping'.",
            "waf": "Security",
            "service": "Policy",
            "guid": "9b461617-db7b-4399-8ac6-d4eb7153893a",
            "id": "E01.13",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/industry/sovereignty/policy-portfolio-baseline#sovereignty-baseline-policy-initiatives"
        },
        {
            "category": "Governance",
            "subcategory": "Optimize your cloud investment",
            "text": "Configure 'Actual' and 'Forecasted' Budget Alerts.",
            "waf": "Cost",
            "guid": "29fd366b-a180-452b-9bd7-954b7700c667",
            "id": "E02.02",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/cost-management-billing/costs/tutorial-acm-create-budgets?bc=%2Fazure%2Fcloud-adoption-framework%2F_bread%2Ftoc.json&toc=%2Fazure%2Fcloud-adoption-framework%2Ftoc.json",
            "training": "https://learn.microsoft.com/training/modules/analyze-costs-create-budgets-azure-cost-management/"
        },
        {
            "category": "Management",
            "subcategory": "Monitoring",
            "text": "Use a single monitor logs workspace to manage platforms centrally except where Azure role-based access control (Azure RBAC), data sovereignty requirements, or data retention policies mandate separate workspaces.",
            "waf": "Operations",
            "service": "Monitor",
            "guid": "67e7a8ed-4b30-4e38-a3f2-9812b2363cef",
            "id": "F01.01",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/azure/azure-monitor/logs/design-logs-deployment",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/workspace-design#azure-regions"
        },
        {
            "category": "Management",
            "subcategory": "Monitoring",
            "text": "Decide whether to use a single Azure Monitor Logs workspace for all regions or to create multiple workspaces to cover various geographical regions. Each approach has advantages and disadvantages, including potential cross-region networking charges",
            "waf": "Reliability",
            "service": "Monitor",
            "guid": "7418ada9-4199-4c28-8286-d15e9433e8f3",
            "id": "F01.02",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/azure/azure-monitor/logs/design-logs-deployment",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/design-logs-deployment"
        },
        {
            "category": "Management",
            "subcategory": "Monitoring",
            "text": "Export logs to Azure Storage if your log retention requirements exceed twelve years. Use immutable storage with a write-once, read-many policy to make data non-erasable and non-modifiable for a user-specified interval.",
            "waf": "Operations",
            "service": "Monitor",
            "guid": "5e6c4cfd-3e50-4454-9c24-47ec66138a72",
            "id": "F01.03",
            "severity": "High",
            "training": "https://learn.microsoft.com/learn/paths/architect-infrastructure-operations/",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/data-retention-archive?tabs=portal-1%2Cportal-2#how-retention-and-archiving-work"
        },
        {
            "category": "Management",
            "subcategory": "Monitoring",
            "text": "Monitor OS level virtual machine (VM) configuration drift using Azure Policy. Enabling Azure Automanage Machine Configuration audit capabilities through policy helps application team workloads to immediately consume feature capabilities with little effort.",
            "waf": "Operations",
            "service": "VM",
            "guid": "e7d7e484-3276-4d8b-bc05-5bcf619e8a13",
            "id": "F01.04",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/paths/implement-resource-mgmt-security/",
            "link": "https://learn.microsoft.com/azure/governance/machine-configuration/overview"
        },
        {
            "category": "Management",
            "subcategory": "Operational compliance",
            "text": "Use Azure Update Manager as a patching mechanism for Windows and Linux VMs in Azure.",
            "waf": "Operations",
            "service": "VM",
            "guid": "f9887952-5d62-4688-9d70-ba6c97be9951",
            "id": "F01.05",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/azure/update-manager/overview?tabs=azure-vms",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/management-operational-compliance#update-management-considerations"
        },
        {
            "category": "Management",
            "subcategory": "Operational compliance",
            "text": "Use Azure Update Manager as a patching mechanism for Windows and Linux VMs outside of Azure using Azure Arc.",
            "waf": "Operations",
            "service": "VM",
            "guid": "c806c048-26b7-4ddf-b4c2-b4f0c476925d",
            "id": "F01.06",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/azure/update-manager/overview?tabs=azure-vms",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/management-operational-compliance#update-management-considerations "
        },
        {
            "category": "Management",
            "subcategory": "Monitoring",
            "text": "Use Network Watcher to proactively monitor traffic flows.",
            "waf": "Operations",
            "service": "Network Watcher",
            "guid": "90483845-c986-4cb2-a131-56a12476e49f",
            "id": "F01.07",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/modules/configure-network-watcher/",
            "link": "https://learn.microsoft.com/azure/network-watcher/network-watcher-monitoring-overview"
        },
        {
            "category": "Management",
            "subcategory": "Monitoring",
            "text": "Use resource locks to prevent accidental deletion of critical shared services.",
            "waf": "Operations",
            "guid": "541acdce-9793-477b-adb3-751ab2ab13ad",
            "id": "F01.08",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/paths/implement-resource-mgmt-security/",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/lock-resources?tabs=json"
        },
        {
            "category": "Management",
            "subcategory": "Monitoring",
            "text": "Use deny policies to supplement Azure role assignments. The combination of deny policies and Azure role assignments ensures the appropriate guardrails are in place to enforce who can deploy and configure resources and what resources they can deploy and configure.",
            "waf": "Operations",
            "guid": "a6e55d7d-8a2a-4db1-87d6-326af625ca44",
            "id": "F01.09",
            "severity": "Low",
            "link": "https://learn.microsoft.com/azure/governance/policy/concepts/effect-deny",
            "training": "https://learn.microsoft.com/azure/role-based-access-control/deny-assignments?tabs=azure-portal"
        },
        {
            "category": "Management",
            "subcategory": "Monitoring",
            "text": "Include service and resource health events as part of the overall platform monitoring solution. Tracking service and resource health from the platform perspective is an important component of resource management in Azure.",
            "waf": "Operations",
            "guid": "e5695f22-23ac-4e8c-a123-08ca5017f154",
            "id": "F01.10",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/service-health/alerts-activity-log-service-notifications-portal",
            "training": "https://learn.microsoft.com/training/modules/intro-to-azure-service-health/"
        },
        {
            "category": "Management",
            "subcategory": "Monitoring",
            "text": "Include alerts and action groups as part of the Azure Service Health platform to ensure that alerts or issues can be actioned.",
            "waf": "Operations",
            "guid": "d5f345bf-97ab-41a7-819c-6104baa7d48c",
            "id": "F01.11",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/azure-monitor/alerts/action-groups",
            "training": "https://learn.microsoft.com/en-gb/training/modules/incident-response-with-alerting-on-azure/7-actions-and-alert-processing-rules"
        },
        {
            "category": "Management",
            "subcategory": "Monitoring",
            "text": "Don't send raw log entries back to on-premises monitoring systems. Instead, adopt a principle that data born in Azure stays in Azure. If on-premises SIEM integration is required, then send critical alerts instead of logs.",
            "waf": "Operations",
            "guid": "e3ab3693-829e-47e3-8618-3687a0477a20",
            "id": "F01.12",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/sentinel/quickstart-onboard",
            "training": "https://learn.microsoft.com/azure/cloud-adoption-framework/decision-guides/logging-and-reporting/"
        },
        {
            "category": "Management",
            "subcategory": "Monitoring",
            "text": "Use Azure Monitor Logs for insights and reporting.",
            "waf": "Operations",
            "service": "Monitor",
            "guid": "6944008b-e7d7-4e48-9327-6d8bdc055bcf",
            "id": "F01.13",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-setup-guide/monitoring-reporting?tabs=AzureMonitor",
            "training": "https://learn.microsoft.com/training/modules/configure-azure-monitor/"
        },
        {
            "category": "Management",
            "subcategory": "Monitoring",
            "text": "When necessary, use shared storage accounts within the landing zone for Azure diagnostic extension log storage.",
            "waf": "Operations",
            "guid": "619e8a13-f988-4795-85d6-26886d70ba6c",
            "id": "F01.14",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/azure-monitor/agents/diagnostics-extension-overview",
            "training": "https://learn.microsoft.com/training/modules/configure-virtual-machine-extensions/"
        },
        {
            "category": "Management",
            "subcategory": "Monitoring",
            "text": "Use Azure Monitor alerts for the generation of operational alerts.",
            "waf": "Operations",
            "service": "Monitor",
            "guid": "97be9951-9048-4384-9c98-6cb2913156a1",
            "id": "F01.15",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/azure-monitor/alerts/alerts-overview",
            "training": "https://learn.microsoft.com/training/modules/incident-response-with-alerting-on-azure/"
        },
        {
            "category": "Management",
            "subcategory": "Monitoring",
            "text": "Ensure that monitoring requirements have been assessed and that appropriate data collection and alerting configurations are applied.",
            "waf": "Operations",
            "guid": "859c3900-4514-41eb-b010-475d695abd74",
            "id": "F01.16",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/architecture/best-practices/monitoring",
            "training": "https://learn.microsoft.com/training/paths/az-104-monitor-backup-resources/"
        },
        {
            "category": "Management",
            "subcategory": "Monitoring",
            "text": "Deploy AMBA to establish monitoring for platform components of your landing zone - AMBA is a framework solution that is available and provides an easy way to scale alerting by using Azure Policy.",
            "waf": "Operations",
            "guid": "aa45be6a-8f2d-4896-b0e3-775e6e94e610",
            "id": "F01.17",
            "severity": "Medium",
            "training": "https://azure.github.io/azure-monitor-baseline-alerts/patterns/alz/",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/management-monitor"
        },
        {
            "category": "Management",
            "subcategory": "Data Protection",
            "text": "Ensure that storage accounts are zone or region redundant, Redundancy ensures storage accounts meet availability and durability targets amidst failures, weighing lower costs against higher availability. Locally redundant storage offers the least durability at the lowest cost.",
            "waf": "Reliability",
            "guid": "0d83fd81-952c-4d47-a6cb-3a930925ef2e",
            "id": "F01.18",
            "graph": "Resources | where type =~ 'Microsoft.Storage/storageAccounts' | where sku.name in~ ('Standard_LRS', 'Premium_LRS') | project name, id, tags, param1 = strcat('sku: ', sku.name)",
            "severity": "High",
            "link": "https://learn.microsoft.com/en-gb/azure/storage/common/redundancy-migration?tabs=portal",
            "training": "https://learn.microsoft.com/azure/storage/common/storage-redundancy"
        },
        {
            "category": "Management",
            "subcategory": "Data Protection",
            "text": "Employ Azure Site Recovery for Azure-to-Azure VM DR scenarios. Use native PaaS DR capabilities. Use Azure-native backup capabilities.",
            "waf": "Reliability",
            "guid": "7ea02e1c-7166-45a3-bdf5-098891367fcb",
            "id": "F02.01",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/management-business-continuity-disaster-recovery#design-recommendations",
            "training": "https://learn.microsoft.com/training/modules/protect-infrastructure-with-site-recovery/"
        },
        {
            "category": "Management",
            "subcategory": "Data Protection",
            "text": "When using Azure Backup, use the correct backup types (GRS, ZRS & LRS) for your backup, as the default setting is GRS.",
            "waf": "Reliability",
            "service": "Backup",
            "guid": "eba8cf22-45c6-4dc1-9b57-2cceb3b97ce5",
            "id": "F02.02",
            "severity": "Low",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-redundancy",
            "training": "https://learn.microsoft.com/training/modules/design-solution-for-backup-disaster-recovery/"
        },
        {
            "category": "Management",
            "subcategory": "Operational compliance",
            "text": "Use Azure guest policies to automatically deploy software configurations through VM extensions and enforce a compliant baseline VM configuration.",
            "waf": "Security",
            "service": "VM",
            "guid": "f541acdc-e979-4377-acdb-3751ab2ab13a",
            "id": "F03.01",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/governance/policy/concepts/guest-configuration"
        },
        {
            "category": "Management",
            "subcategory": "Operational compliance",
            "text": "Monitor VM security configuration drift via Azure Policy.",
            "service": "VM",
            "description": "Use Azure Policy's guest configuration features  to audit and remediate machine settings (e.g., OS, application, environment) to ensure resources align with expected configurations, and Update Management can enforce patch management for VMs.",
            "waf": "Security",
            "guid": "da6e55d7-d8a2-4adb-817d-6326af625ca4",
            "id": "F03.02",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/management-operational-compliance#monitoring-for-configuration-drift",
            "training": "https://learn.microsoft.com/training/paths/implement-resource-mgmt-security/"
        },
        {
            "category": "Management",
            "subcategory": "Protect and Recover",
            "text": "Use Azure Site Recovery for Azure-to-Azure Virtual Machines disaster recovery scenarios. This enables you to replicate workloads across regions.",
            "waf": "Operations",
            "service": "VM",
            "guid": "2476e49f-541a-4cdc-b979-377bcdb3751a",
            "id": "F04.01",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/site-recovery/site-recovery-overview",
            "training": "https://learn.microsoft.com/training/modules/protect-infrastructure-with-site-recovery/"
        },
        {
            "category": "Management",
            "subcategory": "Protect and Recover",
            "text": "Use native PaaS service disaster recovery capabilities.  Perform failover testing with these capabilities.",
            "waf": "Operations",
            "guid": "b2ab13ad-a6e5-45d7-b8a2-adb117d6326a",
            "id": "F04.02",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/architecture/framework/resiliency/backup-and-recovery",
            "training": "https://learn.microsoft.com/training/modules/explore-iaas-paas-platform-tools-for-high-availability-disaster-recovery/"
        },
        {
            "category": "Management",
            "subcategory": "Protect and Recover",
            "text": "Use Azure-native backup capabilities, or an Azure-compatible, 3rd-party backup solution.",
            "waf": "Operations",
            "service": "Backup",
            "guid": "f625ca44-e569-45f2-823a-ce8cb12308ca",
            "id": "F04.03",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/backup/backup-center-overview",
            "training": "https://learn.microsoft.com/training/modules/design-solution-for-backup-disaster-recovery/"
        },
        {
            "category": "Management",
            "subcategory": "App delivery",
            "text": "Add diagnostic settings to save WAF logs from application delivery services like Azure Front Door and Azure Application Gateway. Regularly review the logs to check for attacks and for false positive detections.",
            "waf": "Operations",
            "service": "WAF",
            "guid": "89cc5e11-aa4d-4c3b-893d-feb99215266a",
            "id": "F06.01",
            "severity": "High",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#add-diagnostic-settings-to-save-your-wafs-logs",
            "training": "https://learn.microsoft.com/training/modules/capture-application-logs-app-service/"
        },
        {
            "category": "Management",
            "subcategory": "App delivery",
            "text": "Send WAF logs from your application delivery services like Azure Front Door and Azure Application Gateway to Microsoft Sentinel. Detect attacks and integrate WAF telemetry into your overall Azure environment.",
            "waf": "Operations",
            "service": "WAF",
            "guid": "7f408960-c626-44cb-a018-347c8d790cdf",
            "id": "F06.02",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#send-logs-to-microsoft-sentinel",
            "training": "https://learn.microsoft.com/training/paths/sc-200-connect-logs-to-azure-sentinel/"
        },
        {
            "category": "Security",
            "subcategory": "Access control",
            "text": "Determine the incident response plan for Azure services before allowing it into production.",
            "waf": "Security",
            "guid": "b86ad884-08e3-4727-94b8-75ba18f20459",
            "id": "G01.01",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/security/benchmark/azure/security-control-incident-response",
            "training": "https://learn.microsoft.com/training/modules/intro-to-azure-incident-readiness/"
        },
        {
            "category": "Security",
            "subcategory": "Access control",
            "text": "Apply a zero-trust approach for access to the Azure platform.",
            "waf": "Security",
            "guid": "01365d38-e43f-49cc-ad86-8266abca264f",
            "id": "G01.02",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/security-zero-trust",
            "training": "https://learn.microsoft.com/training/modules/introduction-zero-trust-best-practice-frameworks/"
        },
        {
            "category": "Security",
            "subcategory": "Encryption and keys",
            "text": "Use Azure Key Vault to store your secrets and credentials.",
            "waf": "Security",
            "service": "Key Vault",
            "guid": "5017f154-e3ab-4369-9829-e7e316183687",
            "id": "G02.01",
            "severity": "High",
            "link": "https://learn.microsoft.com/azure/key-vault/general/overview",
            "training": "https://learn.microsoft.com/training/modules/implement-azure-key-vault/"
        },
        {
            "category": "Security",
            "subcategory": "Encryption and keys",
            "text": "Use different Azure Key Vaults for different applications, environments and regions to avoid transaction scale limits and restrict access to secrets.",
            "waf": "Security",
            "service": "Key Vault",
            "guid": "a0477a20-9945-4bda-9333-4f2491163418",
            "id": "G02.02",
            "severity": "Medium",
            "graph": "ResourceContainers | where type=='microsoft.resources/subscriptions'| parse id with '/subscriptions/' SubscriptionID| project subscriptionId, SubscriptionName = name| join kind=leftouter (Resources| where type == 'microsoft.keyvault/vaults'| project id, name, subscriptionId) on subscriptionId| join kind= leftouter (Resources| where type == 'microsoft.keyvault/vaults'| summarize ResourceCount = count() by subscriptionId) on subscriptionId| extend RCount = iff(isnull(ResourceCount), 0, ResourceCount)| project-away ResourceCount| extend compliant = (RCount <> 1)",
            "link": "https://learn.microsoft.com/azure/key-vault/general/overview-throttling",
            "training": "https://learn.microsoft.com/training/modules/configure-and-manage-azure-key-vault/"
        },
        {
            "category": "Security",
            "subcategory": "Encryption and keys",
            "text": "Provision Azure Key Vault with the soft delete and purge policies enabled to allow retention protection for deleted objects.",
            "waf": "Security",
            "service": "Key Vault",
            "guid": "2ba52752-6944-4008-ae7d-7e4843276d8b",
            "id": "G02.03",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "training": "https://learn.microsoft.com/training/modules/implement-azure-key-vault/"
        },
        {
            "category": "Security",
            "subcategory": "Encryption and keys",
            "text": "Follow a least privilege model by assigning just-in-time eligible RBAC roles for operators, administrators, and other user accounts requiring privileged access to Key Vault using Privileged Identity Management (PIM).",
            "waf": "Security",
            "service": "Key Vault",
            "guid": "dc055bcf-619e-48a1-9f98-879525d62688",
            "id": "G02.04",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "training": "https://learn.microsoft.com/training/modules/implement-azure-key-vault/"
        },
        {
            "category": "Security",
            "subcategory": "Encryption and keys",
            "text": "Automate the certificate management and renewal process with public certificate authorities to ease administration.",
            "waf": "Security",
            "service": "Key Vault",
            "guid": "6d70ba6c-97be-4995-8904-83845c986cb2",
            "id": "G02.05",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "training": "https://learn.microsoft.com/training/modules/configure-and-manage-azure-key-vault/"
        },
        {
            "category": "Security",
            "subcategory": "Encryption and keys",
            "text": "Establish an automated process for key and certificate rotation.",
            "waf": "Security",
            "service": "Key Vault",
            "guid": "913156a1-2476-4e49-b541-acdce979377b",
            "id": "G02.06",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "training": "https://learn.microsoft.com/training/modules/configure-and-manage-azure-key-vault/"
        },
        {
            "category": "Security",
            "subcategory": "Encryption and keys",
            "text": "Enable firewall and virtual network service endpoint or private endpoint on the vault to control access to the key vault.",
            "waf": "Security",
            "service": "Key Vault",
            "guid": "cdb3751a-b2ab-413a-ba6e-55d7d8a2adb1",
            "id": "G02.07",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "training": "https://learn.microsoft.com/training/modules/design-implement-private-access-to-azure-services/"
        },
        {
            "category": "Security",
            "subcategory": "Encryption and keys",
            "text": "Use the platform-central Azure Monitor Log Analytics workspace to audit key, certificate, and secret usage within each instance of Key Vault.",
            "waf": "Security",
            "service": "Key Vault",
            "guid": "17d6326a-f625-4ca4-9e56-95f2223ace8c",
            "id": "G02.08",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/key-vault/general/monitor-key-vault",
            "training": "https://learn.microsoft.com/training/modules/analyze-infrastructure-with-azure-monitor-logs/"
        },
        {
            "category": "Security",
            "subcategory": "Encryption and keys",
            "text": "Delegate Key Vault instantiation and privileged access and use Azure Policy to enforce a consistent compliant configuration.",
            "waf": "Security",
            "service": "Key Vault",
            "guid": "b12308ca-5017-4f15-9e3a-b3693829e7e3",
            "id": "G02.09",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "training": "https://learn.microsoft.com/training/modules/configure-azure-key-vault-networking-settings/"
        },
        {
            "category": "Security",
            "subcategory": "Encryption and keys",
            "text": "Default to Microsoft-managed keys for principal encryption functionality and use customer-managed keys when required.",
            "waf": "Security",
            "guid": "16183687-a047-47a2-8994-5bda43334f24",
            "id": "G02.10",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/security/fundamentals/encryption-atrest",
            "training": "https://learn.microsoft.com/training/modules/implement-azure-key-vault/"
        },
        {
            "category": "Security",
            "subcategory": "Encryption and keys",
            "text": "If you want to bring your own keys, this might not be supported across all considered services. Implement relevant mitigation so that inconsistencies don't hinder desired outcomes. Choose appropriate region pairs and disaster recovery regions that minimize latency.",
            "waf": "Security",
            "service": "Key Vault",
            "guid": "25d62688-6d70-4ba6-a97b-e99519048384",
            "id": "G02.12",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "training": "https://learn.microsoft.com/training/modules/configure-and-manage-azure-key-vault/"
        },
        {
            "category": "Security",
            "subcategory": "Encryption and keys",
            "text": "For Sovereign Landing Zone, use Azure Key Vault managed HSM to store your secrets and credentials.",
            "waf": "Security",
            "service": "Key Vault",
            "guid": "4ac6b67c-b3a4-4ff9-8e87-b07a7ce7bbdb",
            "id": "G02.13",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/industry/sovereignty/key-management",
            "training": "https://learn.microsoft.com/training/modules/configure-and-manage-azure-key-vault/"
        },
        {
            "category": "Security",
            "subcategory": "Operations",
            "text": "Use Microsoft Entra ID reporting capabilities to generate access control audit reports.",
            "waf": "Security",
            "service": "Entra",
            "guid": "4e5695f2-223a-4ce8-ab12-308ca5017f15",
            "id": "G03.01",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/active-directory/reports-monitoring/overview-reports",
            "training": "https://learn.microsoft.com/training/modules/monitor-report-aad-security-events/"
        },
        {
            "category": "Security",
            "subcategory": "Operations",
            "text": "Export Azure activity logs to Azure Monitor Logs for long-term data retention. Export to Azure Storage for long-term storage beyond 12 years, if necessary.",
            "waf": "Security",
            "guid": "4e3ab369-3829-4e7e-9161-83687a0477a2",
            "id": "G03.02",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/logs-data-export?tabs=portal",
            "training": "https://learn.microsoft.com/training/modules/analyze-infrastructure-with-azure-monitor-logs/"
        },
        {
            "category": "Security",
            "subcategory": "Operations",
            "text": "Enable Defender Cloud Security Posture Management (CSPM) plan for all resources in addition to the on-by-default Foundational plan for advanced security posture features .",
            "waf": "Security",
            "service": "Defender",
            "guid": "09945bda-4333-44f2-9911-634182ba5275",
            "id": "G03.03",
            "severity": "High",
            "link": "https://learn.microsoft.com/azure/defender-for-cloud/concept-cloud-security-posture-management",
            "training": "https://learn.microsoft.com/training/modules/microsoft-defender-cloud-security-posture/"
        },
        {
            "category": "Security",
            "subcategory": "Operations",
            "text": "Enable a Microsoft Defender for Servers plan for all cloud servers.",
            "waf": "Security",
            "service": "Defender",
            "guid": "36a72a48-fffe-4c40-9747-0ab5064355ba",
            "id": "G03.04",
            "severity": "High",
            "link": "https://learn.microsoft.com/azure/defender-for-cloud/plan-defender-for-servers-select-plan",
            "training": "https://learn.microsoft.com/training/modules/understand-azure-defender-cloud-workload-protection/"
        },
        {
            "category": "Security",
            "subcategory": "Operations",
            "text": "Enable Defender Cloud Workload Protection Plans for Azure Resources on all subscriptions.",
            "waf": "Security",
            "service": "Defender",
            "guid": "77425f48-ecba-43a0-aeac-a3ac733ccc6a",
            "id": "G03.05",
            "severity": "High",
            "link": "https://learn.microsoft.com/azure/defender-for-cloud/connect-azure-subscription",
            "training": "https://learn.microsoft.com/training/modules/understand-azure-defender-cloud-workload-protection/"
        },
        {
            "category": "Security",
            "subcategory": "Operations",
            "text": "Enable Endpoint Protection on IaaS Servers.",
            "waf": "Security",
            "service": "VM",
            "guid": "24d96b30-61ee-4436-a1cc-d6ef08bc574b",
            "id": "G03.06",
            "severity": "High",
            "link": "https://learn.microsoft.com/mem/configmgr/protect/deploy-use/endpoint-protection",
            "training": "https://learn.microsoft.com/training/modules/design-solutions-securing-server-client-endpoints/"
        },
        {
            "category": "Security",
            "subcategory": "Operations",
            "text": "Monitor base operating system patching drift via Azure Monitor Logs and Defender for Cloud.",
            "waf": "Security",
            "service": "VM",
            "guid": "15833ee7-ad6c-46d3-9331-65c7acbe44ab",
            "id": "G03.07",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/security-center/",
            "training": "https://learn.microsoft.com/training/modules/create-log-analytics-workspace-microsoft-defender-cloud/"
        },
        {
            "category": "Security",
            "subcategory": "Operations",
            "text": "Connect default resource configurations to a centralized Azure Monitor Log Analytics workspace.",
            "waf": "Security",
            "service": "Monitor",
            "guid": "e5f8d79f-2e87-4768-924c-516775c6ea95",
            "id": "G03.08",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/design-logs-deployment",
            "training": "https://learn.microsoft.com/training/modules/analyze-infrastructure-with-azure-monitor-logs/"
        },
        {
            "category": "Security",
            "subcategory": "Operations",
            "text": "Centralized threat detection with correlated logs -  consolidate security data in a central location where it can be correlated across various services via SIEM (security information and event management)",
            "waf": "Security",
            "service": "Entra",
            "guid": "a56888b2-7e83-4404-bd31-b886528502d1",
            "id": "G03.09",
            "severity": "High",
            "graph": "resources| where type == 'microsoft.operationalinsights/workspaces'| extend wsid = properties.customerId| project workspaceResourceId = tolower(id), name, wsid| join (resources| where type == 'microsoft.operationsmanagement/solutions'| where name has 'SecurityInsights'| extend workspaceResourceId = tostring(tolower(properties.workspaceResourceId))| project workspaceResourceId | summarize ResourceCount = count() by workspaceResourceId) on workspaceResourceId| extend RCount = iff(isnull(ResourceCount), 0, ResourceCount)| project-away ResourceCount| extend compliant = (RCount <> 0)",
            "link": "https://learn.microsoft.com/azure/well-architected/security/monitor-threats#centralized-threat-detection-with-correlated-logs"
        },
        {
            "category": "Security",
            "subcategory": "Operations",
            "text": "For Sovereign Landing Zone, enable transparancy logs on the Entra ID tenant.",
            "waf": "Security",
            "service": "Entra",
            "guid": "1761e147-f65e-4d09-bbc2-f464f23e2eba",
            "id": "G03.10",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/industry/sovereignty/transparency-logs"
        },
        {
            "category": "Security",
            "subcategory": "Operations",
            "text": "For Sovereign Landing Zone, enable customer Lockbox on the Entra ID tenant.",
            "waf": "Security",
            "service": "Entra",
            "guid": "d21a922d-5ca7-427a-82a6-35f7b21f1bfc",
            "id": "G03.11",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/security/fundamentals/customer-lockbox-overview"
        },
        {
            "category": "Security",
            "subcategory": "Operations",
            "text": "Use an Azure Event Grid-based solution for log-oriented, real-time alerts.",
            "waf": "Security",
            "guid": "874a748b-662d-46d1-9051-2a66498f6dfe",
            "id": "G03.12",
            "severity": "Low",
            "link": "https://learn.microsoft.com/azure/event-grid/set-alerts",
            "training": "https://learn.microsoft.com/training/modules/azure-event-grid/"
        },
        {
            "category": "Security",
            "subcategory": "Overview",
            "text": "Enable secure transfer to storage accounts.",
            "waf": "Security",
            "service": "Storage",
            "guid": "b03ed428-4617-4067-a787-85468b9ccf3f",
            "id": "G04.01",
            "severity": "High",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-require-secure-transfer",
            "training": "https://learn.microsoft.com/training/modules/secure-azure-storage-account/"
        },
        {
            "category": "Security",
            "subcategory": "Overview",
            "text": "Enable container soft delete for the storage account to recover a deleted container and its contents.",
            "waf": "Security",
            "service": "Storage",
            "guid": "159aac9f-863f-4f48-82cf-00c28fa97a0e",
            "id": "G04.02",
            "severity": "High",
            "link": "https://learn.microsoft.com/azure/storage/blobs/data-protection-overview#recommendations-for-basic-data-protection"
        },
        {
            "category": "Security",
            "subcategory": "Secure privileged access",
            "text": "Separate privileged admin accounts for Azure administrative tasks.",
            "waf": "Security",
            "guid": "6f704104-85c1-441f-96d3-c9819911645e",
            "id": "G05.01",
            "severity": "High",
            "link": "https://learn.microsoft.com/azure/active-directory/roles/security-planning",
            "training": "https://learn.microsoft.com/training/modules/design-solutions-secure-privileged-access/"
        },
        {
            "category": "Security",
            "subcategory": "Service enablement framework",
            "text": "Plan how new azure services will be implemented.",
            "waf": "Security",
            "guid": "9a19bf39-c95d-444c-9c89-19ca1f6d5215",
            "id": "G06.01",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/service-enablement-framework"
        },
        {
            "category": "Security",
            "subcategory": "Service enablement framework",
            "text": "Plan how service request will be fulfilled for Azure services.",
            "waf": "Security",
            "guid": "ae514b93-3d45-485e-8112-9bd7ba012f7b",
            "id": "G06.02",
            "severity": "Low",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/service-enablement-framework"
        },
        {
            "category": "Platform Automation and DevOps",
            "subcategory": "DevOps Team Topologies",
            "text": "Ensure you have a cross functional DevOps Platform Team to build, manage and maintain your Azure Landing Zone architecture.",
            "waf": "Operations",
            "guid": "e85f4226-bf06-4e35-8a8b-7aee4d2d633a",
            "id": "H01.01",
            "severity": "High",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/platform-automation-devops",
            "training": "https://learn.microsoft.com/training/modules/choose-an-agile-approach/"
        },
        {
            "category": "Platform Automation and DevOps",
            "subcategory": "DevOps Team Topologies",
            "text": "Aim to define functions for Azure Landing Zone Platform team.",
            "waf": "Operations",
            "guid": "634146bf-7085-4419-a7b5-f96d2726f6da",
            "id": "H01.02",
            "severity": "Low",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/devops-teams-topologies#design-recommendations",
            "training": "https://learn.microsoft.com/training/paths/az-400-work-git-for-enterprise-devops/"
        },
        {
            "category": "Platform Automation and DevOps",
            "subcategory": "DevOps Team Topologies",
            "text": "Aim to define functions for application workload teams to be self-sufficient and not require DevOps Platform Team support. Achieve this through the use of custom RBAC role.",
            "waf": "Operations",
            "guid": "a9e65070-c59e-4112-8bf6-c11364d4a2a5",
            "id": "H01.03",
            "severity": "Low",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/devops-teams-topologies#design-recommendations",
            "training": "https://learn.microsoft.com/training/paths/az-400-work-git-for-enterprise-devops/"
        },
        {
            "category": "Platform Automation and DevOps",
            "subcategory": "DevOps Team Topologies",
            "text": "Use a CI/CD pipeline to deploy IaC artifacts and ensure the quality of your deployment and Azure environments.",
            "waf": "Operations",
            "guid": "165eb5e9-b434-448a-9e24-178632186212",
            "id": "H01.04",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/infrastructure-as-code",
            "training": "https://learn.microsoft.com/training/modules/manage-multiple-environments-using-bicep-azure-pipelines/"
        },
        {
            "category": "Platform Automation and DevOps",
            "subcategory": "DevOps Team Topologies",
            "text": "Include unit tests for IaC and application code as part of your build process.",
            "waf": "Operations",
            "guid": "0cadb8c7-8fa5-4fbf-8f39-d1fadb3b0460",
            "id": "H01.05",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/development-strategy-development-lifecycle#automated-builds",
            "training": "https://learn.microsoft.com/training/modules/run-quality-tests-build-pipeline/"
        },
        {
            "category": "Platform Automation and DevOps",
            "subcategory": "DevOps Team Topologies",
            "text": "Use Key Vault secrets to avoid hard-coding sensitive information such as credentials (virtual machines user passwords), certificates or keys.",
            "waf": "Operations",
            "service": "Key Vault",
            "guid": "108d5099-a11d-4445-bd8b-e12a5e95412e",
            "id": "H01.06",
            "severity": "High",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/development-strategy-development-lifecycle#automated-builds",
            "training": "https://learn.microsoft.com/training/modules/implement-azure-key-vault/"
        },
        {
            "category": "Platform Automation and DevOps",
            "subcategory": "DevOps Team Topologies",
            "text": "Implement automation for new landing zone for applications and workloads through subscription vending.",
            "waf": "Operations",
            "guid": "a52e0c98-76b9-4a09-a1c9-6b2babf22ac4",
            "id": "H01.07",
            "severity": "Low",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/subscription-vending"
        },
        {
            "category": "Platform Automation and DevOps",
            "subcategory": "Development Lifecycle",
            "text": "Ensure a version control system is used for source code of applications and IaC developed. Microsoft recommends Git.",
            "waf": "Operations",
            "guid": "cfe363b5-f579-4284-bc56-a42153e4c10b",
            "id": "H02.01",
            "severity": "High",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/infrastructure-as-code",
            "training": "https://learn.microsoft.com/training/paths/intro-to-vc-git/"
        },
        {
            "category": "Platform Automation and DevOps",
            "subcategory": "Development Lifecycle",
            "text": "Follow a branching strategy to allow teams to collaborate better and efficiently manage version control of IaC and application Code. Review options such as Github Flow.",
            "waf": "Operations",
            "guid": "c7245dd4-af8a-403a-8bb7-890c1a7cfa9d",
            "id": "H02.02",
            "severity": "Low",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/development-strategy-development-lifecycle",
            "training": "https://learn.microsoft.com/training/modules/manage-git-branches-workflows/"
        },
        {
            "category": "Platform Automation and DevOps",
            "subcategory": "Development Lifecycle",
            "text": "Adopt a pull request strategy to help keep control of code changes merged into branches.",
            "waf": "Operations",
            "guid": "12aeea20-9165-4b3e-bdf2-6795fcd3cdbe",
            "id": "H02.03",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/development-strategy-development-lifecycle",
            "training": "https://learn.microsoft.com/training/modules/review-azure-infrastructure-changes-using-bicep-pull-requests/"
        },
        {
            "category": "Platform Automation and DevOps",
            "subcategory": "Development Lifecycle",
            "text": "Establish a process for using code to implement quick fixes. Always register quick fixes in your team's backlog so each fix can be reworked at a later point, and you can limit technical debt.",
            "waf": "Operations",
            "guid": "2676ae46-65ca-444e-8695-fdddeace4cb1",
            "id": "H02.04",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/management-platform",
            "training": "https://learn.microsoft.com/training/modules/branch-merge-git/"
        },
        {
            "category": "Platform Automation and DevOps",
            "subcategory": "Development Strategy",
            "text": "Leverage Declarative Infrastructure as Code Tools such as Azure Bicep, ARM Templates or Terraform to build and maintain your Azure Landing Zone architecture. Both from a Platform and Application workload perspective.",
            "waf": "Operations",
            "guid": "2cdc9d99-dbcc-4ad4-97f5-e7d358bdfa73",
            "id": "H03.01",
            "severity": "High",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/infrastructure-as-code",
            "training": "https://learn.microsoft.com/training/modules/introduction-to-infrastructure-as-code-using-bicep/"
        },
        {
            "category": "Platform Automation and DevOps",
            "subcategory": "Security",
            "text": "Integrate security into the already combined process of development and operations in DevOps to mitigate risks in the innovation process.",
            "waf": "Operations",
            "guid": "cc87a3bc-c572-4ad2-92ed-8cabab66160f",
            "id": "H04.01",
            "severity": "High",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/landing-zone-security#secure",
            "training": "https://learn.microsoft.com/training/paths/az-400-implement-security-validate-code-bases-compliance/"
        }
    ],
    "categories": [
        {
            "name": "Azure Billing and Microsoft Entra ID Tenants"
        },
        {
            "name": "Identity and Access Management"
        },
        {
            "name": "Network Topology and Connectivity"
        },
        {
            "name": "Security"
        },
        {
            "name": "Management"
        },
        {
            "name": "Resource Organization"
        },
        {
            "name": "Platform Automation and DevOps"
        },
        {
            "name": "Governance"
        }
    ],
    "waf": [
        {
            "name": "Reliability"
        },
        {
            "name": "Security"
        },
        {
            "name": "Cost"
        },
        {
            "name": "Operations"
        },
        {
            "name": "Performance"
        }
    ],
    "yesno": [
        {
            "name": "Yes"
        },
        {
            "name": "No"
        }
    ],
    "status": [
        {
            "name": "Not verified",
            "description": "This check has not been looked at yet"
        },
        {
            "name": "Open",
            "description": "There is an action item associated to this check"
        },
        {
            "name": "Fulfilled",
            "description": "This check has been verified, and there are no further action items associated to it"
        },
        {
            "name": "Not required",
            "description": "Recommendation understood, but not needed by current requirements"
        },
        {
            "name": "N/A",
            "description": "Not applicable for current design"
        }
    ],
    "severities": [
        {
            "name": "High"
        },
        {
            "name": "Medium"
        },
        {
            "name": "Low"
        }
    ],
    "metadata": {
        "name": "Azure Landing Zone Review",
        "state": "GA",
        "waf": "all",
        "timestamp": "October 24, 2024"
    }
}

{
    "categories": [
        {
            "name": "Azure 計費和 Microsoft Entra ID 租戶"
        },
        {
            "name": "身份和訪問管理"
        },
        {
            "name": "網路拓撲和連接"
        },
        {
            "name": "安全"
        },
        {
            "name": "管理"
        },
        {
            "name": "資源組織"
        },
        {
            "name": "平臺自動化和DevOps"
        },
        {
            "name": "統轄"
        }
    ],
    "items": [
        {
            "category": "Azure 計費和 Microsoft Entra ID 租戶",
            "guid": "70c15989-c726-42c7-b0d3-24b7375b9201",
            "id": "A01.01",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/multi-tenant/considerations-recommendations",
            "service": "Entra",
            "severity": "中等",
            "subcategory": "Microsoft Entra ID 租戶",
            "text": "使用一個 Entra 租戶來管理 Azure 資源，除非你對多租戶有明確的法規或業務要求。",
            "waf": "操作"
        },
        {
            "category": "Azure 計費和 Microsoft Entra ID 租戶",
            "guid": "6309957b-821a-43d1-b9d9-7fcf1802b747",
            "id": "A01.02",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/multi-tenant/automation",
            "service": "Entra",
            "severity": "低",
            "subcategory": "Microsoft Entra ID 租戶",
            "text": "確保採用多租戶自動化方法來管理 Microsoft Entra ID 租戶",
            "waf": "操作"
        },
        {
            "category": "Azure 計費和 Microsoft Entra ID 租戶",
            "guid": "78e11934-499a-45ed-8ef7-aae5578f0ecf",
            "id": "A01.03",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/multi-tenant/lighthouse",
            "service": "Entra",
            "severity": "低",
            "subcategory": "Microsoft Entra ID 租戶",
            "text": "利用 Azure Lighthouse 進行多租戶管理",
            "waf": "操作"
        },
        {
            "category": "Azure 計費和 Microsoft Entra ID 租戶",
            "guid": "5d82e6df-6f61-42f2-82e2-3132d293be3d",
            "id": "A02.01",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-microsoft-customer-agreement#design-recommendations",
            "service": "Entra",
            "severity": "中等",
            "subcategory": "雲解決方案供應商",
            "text": "確保合作夥伴使用 Azure Lighthouse 管理租戶",
            "waf": "成本"
        },
        {
            "category": "Azure 計費和 Microsoft Entra ID 租戶",
            "guid": "a24d0de3-d4b9-4dfb-8ddd-bbfaf123fa01",
            "id": "A02.02",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-microsoft-customer-agreement#design-recommendations",
            "severity": "低",
            "subcategory": "雲解決方案供應商",
            "text": "與 CSP 合作夥伴討論支援請求和升級過程",
            "waf": "成本"
        },
        {
            "category": "Azure 計費和 Microsoft Entra ID 租戶",
            "guid": "32952499-58c8-4e6f-ada5-972e67893d55",
            "id": "A02.03",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-microsoft-customer-agreement#design-recommendations",
            "severity": "中等",
            "subcategory": "雲解決方案供應商",
            "text": "使用 Azure 成本管理設置成本報告和檢視",
            "waf": "成本"
        },
        {
            "category": "Azure 計費和 Microsoft Entra ID 租戶",
            "guid": "685cb4f2-ac9c-4b19-9167-993ed0b32415",
            "id": "A03.01",
            "link": "https://learn.microsoft.com/azure/cost-management-billing/manage/direct-ea-administration#manage-notification-contacts",
            "severity": "中等",
            "subcategory": "企業協定",
            "text": "將通知連絡人配置到組郵箱",
            "waf": "成本"
        },
        {
            "category": "Azure 計費和 Microsoft Entra ID 租戶",
            "guid": "12cd499f-96e2-4e41-a243-231fb3245a1c",
            "id": "A03.02",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-enterprise-agreement#design-considerations",
            "severity": "低",
            "subcategory": "企業協定",
            "text": "使用部門和帳戶將組織的結構映射到註冊層次結構，這有助於分離計費。",
            "waf": "成本"
        },
        {
            "category": "Azure 計費和 Microsoft Entra ID 租戶",
            "guid": "ca0fe401-12ad-46fc-8a7e-86293866a9f6",
            "id": "A03.04",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-enterprise-agreement#design-considerations",
            "severity": "中等",
            "subcategory": "企業協定",
            "text": "在EA註冊上啟用DA查看費用和AO查看費用，以允許具有正確許可權的使用者查看成本和計費數據。",
            "waf": "安全"
        },
        {
            "category": "Azure 計費和 Microsoft Entra ID 租戶",
            "guid": "5cf9f485-2784-49b3-9824-75d9b8bdb57b",
            "id": "A03.05",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-enterprise-agreement#design-considerations",
            "severity": "低",
            "subcategory": "企業協定",
            "text": "利用企業開發/測試訂閱來降低非生產工作負載的成本",
            "waf": "成本"
        },
        {
            "category": "Azure 計費和 Microsoft Entra ID 租戶",
            "guid": "6ad5c3dd-e5ea-4ff1-81a4-7886ff87845c",
            "id": "A04.01",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-microsoft-customer-agreement#design-recommendations",
            "severity": "低",
            "subcategory": "Microsoft 客戶協定",
            "text": "配置協定計費帳戶通知聯繫人電子郵件",
            "waf": "成本"
        },
        {
            "category": "Azure 計費和 Microsoft Entra ID 租戶",
            "guid": "90e87802-602f-4dfb-acea-67c60689f1d7",
            "id": "A04.02",
            "link": "https://learn.microsoft.com/azure/cost-management-billing/manage/mca-section-invoice",
            "severity": "低",
            "subcategory": "Microsoft 客戶協定",
            "text": "使用「計費配置檔」和「發票」部分構建協定計費，以實現有效的成本管理",
            "waf": "成本"
        },
        {
            "category": "Azure 計費和 Microsoft Entra ID 租戶",
            "guid": "e81a73f0-84c4-4641-b406-14db3b4d1f50",
            "id": "A04.03",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-microsoft-customer-agreement#design-recommendations",
            "severity": "低",
            "subcategory": "Microsoft 客戶協定",
            "text": "利用 Microsoft Azure 開發/測試計劃產品/服務來降低非生產工作負載的成本",
            "waf": "成本"
        },
        {
            "category": "Azure 計費和 Microsoft Entra ID 租戶",
            "guid": "ae757485-92a4-482a-8bc9-eefe6f5b5ec3",
            "id": "A04.04",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-microsoft-customer-agreement#design-recommendations",
            "severity": "中等",
            "subcategory": "Microsoft 客戶協定",
            "text": "定期審核協定計費 RBAC 角色分配，以查看誰有權訪問你的 MCA 計費帳戶",
            "waf": "成本"
        },
        {
            "ammp": true,
            "category": "身份和訪問管理",
            "guid": "4348bf81-7573-4512-8f46-9061cc198fea",
            "id": "B01.01",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/identity-access-landing-zones#identity-and-access-management-in-the-azure-landing-zone-accelerator",
            "severity": "高",
            "subcategory": "Microsoft Entra ID 和混合標識",
            "text": "使用託管標識而不是服務主體對 Azure 服務進行身份驗證。可以通過 Entra ID >登錄日誌>服務主體登錄來檢查現有服務主體。",
            "training": "https://learn.microsoft.com/azure/active-directory/managed-identities-azure-resources/overview",
            "waf": "安全"
        },
        {
            "category": "身份和訪問管理",
            "guid": "cd163e39-84a5-4b39-97b7-6973abd70d94",
            "id": "B02.01",
            "link": "https://learn.microsoft.com/azure/active-directory/hybrid/how-to-connect-sync-staging-server",
            "severity": "中等",
            "subcategory": "Microsoft Entra ID",
            "text": "部署 Microsoft Entra Connect 時，利用暫存伺服器實現高可用性/災難恢復",
            "waf": "可靠性"
        },
        {
            "ammp": true,
            "category": "身份和訪問管理",
            "guid": "984a859c-773e-47d2-9162-3a765a917e1f",
            "id": "B03.01",
            "link": "https://learn.microsoft.com/azure/active-directory/roles/security-emergency-access",
            "service": "Entra",
            "severity": "高",
            "subcategory": "身份",
            "text": "實施緊急訪問或打破玻璃帳戶，以防止租戶範圍的帳戶鎖定",
            "training": "https://learn.microsoft.com/learn/modules/azure-ad-privileged-identity-management/",
            "waf": "安全"
        },
        {
            "category": "身份和訪問管理",
            "guid": "1cf0b8da-70bd-44d0-94af-8d99cfc89ae1",
            "id": "B03.02",
            "link": "https://learn.microsoft.com/azure/active-directory/reports-monitoring/concept-activity-logs-azure-monitor",
            "service": "Entra",
            "severity": "中等",
            "subcategory": "身份",
            "text": "將 Microsoft Entra ID 日誌與平臺中心 Azure Monitor 集成。Azure Monitor 允許圍繞 Azure 中的日誌和監視數據提供單一事實源，從而為組織提供雲原生選項，以滿足有關日誌收集和保留的要求。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "category": "身份和訪問管理",
            "guid": "348ef254-c27d-442e-abba-c7571559ab91",
            "id": "B03.03",
            "link": "https://learn.microsoft.com/azure/role-based-access-control/overview",
            "service": "Entra",
            "severity": "高",
            "subcategory": "身份",
            "text": "強制實施與雲運營模型一致的 RBAC 模型。跨管理組和訂閱的範圍和分配。",
            "training": "https://learn.microsoft.com/learn/paths/implement-resource-mgmt-security/",
            "waf": "安全"
        },
        {
            "category": "身份和訪問管理",
            "guid": "53e8908a-e28c-484c-93b6-b7808b9fe5c4",
            "id": "B03.04",
            "link": "https://learn.microsoft.com/azure/active-directory/conditional-access/overview",
            "service": "Entra",
            "severity": "低",
            "subcategory": "身份",
            "text": "對任何有權訪問 Azure 環境的用戶強制實施 Microsoft Entra ID 條件訪問策略",
            "training": "https://learn.microsoft.com/learn/modules/plan-implement-administer-conditional-access/",
            "waf": "安全"
        },
        {
            "ammp": true,
            "category": "身份和訪問管理",
            "guid": "1049d403-a923-4c34-94d0-0018ac6a9e01",
            "id": "B03.05",
            "link": "https://learn.microsoft.com/azure/active-directory/authentication/concept-mfa-howitworks",
            "service": "Entra",
            "severity": "高",
            "subcategory": "身份",
            "text": "對有權訪問 Azure 環境的任何使用者強制實施多重身份驗證",
            "training": "https://learn.microsoft.com/learn/modules/secure-aad-users-with-mfa/",
            "waf": "安全"
        },
        {
            "category": "身份和訪問管理",
            "guid": "e6a83de5-de32-4c19-a248-1607d5d1e4e6",
            "id": "B03.06",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/manage/centralize-operations",
            "severity": "中等",
            "subcategory": "身份",
            "text": "根據角色和安全要求，強制實施集中式和委派的職責，以管理登陸區域內部署的資源",
            "training": "https://learn.microsoft.com/learn/paths/azure-administrator-manage-identities-governance/",
            "waf": "安全"
        },
        {
            "category": "身份和訪問管理",
            "guid": "14658d35-58fd-4772-99b8-21112df27ee4",
            "id": "B03.07",
            "link": "https://learn.microsoft.com/azure/active-directory/privileged-identity-management/pim-configure",
            "service": "Entra",
            "severity": "中等",
            "subcategory": "身份",
            "text": "強制實施 Microsoft Entra ID 特權身份管理 （PIM） 以建立零長期訪問許可權和最低許可權",
            "training": "https://learn.microsoft.com/learn/modules/azure-ad-privileged-identity-management/",
            "waf": "安全"
        },
        {
            "ammp": true,
            "category": "身份和訪問管理",
            "guid": "12e7f983-f630-4472-8dd6-9c5b5c2622f5",
            "id": "B03.08",
            "link": "https://learn.microsoft.com/azure/active-directory/roles/security-planning#identify-microsoft-accounts-in-administrative-roles-that-need-to-be-switched-to-work-or-school-accounts",
            "service": "Entra",
            "severity": "高",
            "subcategory": "身份",
            "text": "僅對所有帳戶類型使用身份驗證類型「工作或學校帳戶」。避免使用 Microsoft 帳戶",
            "training": "https://learn.microsoft.com/learn/modules/explore-basic-services-identity-types/",
            "waf": "安全"
        },
        {
            "category": "身份和訪問管理",
            "guid": "4b69bad3-3aad-45e8-a68e-1d76667313b4",
            "id": "B03.09",
            "link": "https://learn.microsoft.com/azure/active-directory/fundamentals/active-directory-groups-create-azure-portal",
            "service": "Entra",
            "severity": "中等",
            "subcategory": "身份",
            "text": "僅使用組來分配許可權。如果組管理系統已到位，則將本地組添加到僅 Entra ID 組。",
            "training": "https://learn.microsoft.com/learn/paths/manage-identity-and-access/",
            "waf": "安全"
        },
        {
            "category": "身份和訪問管理",
            "guid": "f5664b5e-984a-4859-a773-e7d261623a76",
            "id": "B03.10",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/identity-access#prerequisites-for-a-landing-zone---design-recommendations",
            "severity": "中等",
            "subcategory": "身份",
            "text": "將 Azure 自定義 RBAC 角色用於以下關鍵角色，以跨 ALZ 提供精細訪問：Azure 平臺擁有者、網路管理、安全操作、訂閱擁有者、應用程式擁有者。使這些角色與企業中的團隊和職責保持一致。",
            "training": "https://learn.microsoft.com/learn/modules/create-custom-azure-roles-with-rbac/",
            "waf": "安全"
        },
        {
            "category": "身份和訪問管理",
            "guid": "1559ab91-53e8-4908-ae28-c84c33b6b780",
            "id": "B03.11",
            "link": "https://learn.microsoft.com/azure/architecture/reference-architectures/identity/adds-extend-domain#vm-recommendations",
            "severity": "中等",
            "subcategory": "身份",
            "text": "在 Windows Server 上部署 Active Directory 時，請使用具有可用性區域的位置，並在這些區域中部署至少兩個 VM。如果不可用，請在可用性集中部署",
            "training": "https://learn.microsoft.com/learn/modules/azure-active-directory/",
            "waf": "可靠性"
        },
        {
            "guid": "8b9fe5c4-1049-4d40-9a92-3c3474d00018",
            "id": "B03.12",
            "link": "https://learn.microsoft.com/azure/active-directory-domain-services/overview",
            "service": "Entra",
            "severity": "中等",
            "subcategory": "身份和訪問管理",
            "text": "如果計劃從 Active Directory 域服務切換到 Entra 域服務，請評估所有工作負載的相容性",
            "training": "https://learn.microsoft.com/learn/modules/implement-hybrid-identity-windows-server/",
            "waf": "安全"
        },
        {
            "category": "身份和訪問管理",
            "guid": "d5d1e4e6-1465-48d3-958f-d77249b82111",
            "id": "B03.14",
            "link": "https://learn.microsoft.com/azure/active-directory/app-proxy/application-proxy",
            "service": "Entra",
            "severity": "中等",
            "subcategory": "身份",
            "text": "如果需要，請使用 Microsoft Entra ID 應用程式代理為遠端使用者提供對內部應用程式（託管在雲中或本地）的安全和經過身份驗證的訪問。",
            "training": "https://learn.microsoft.com/learn/paths/implement-applications-external-access-azure-ad/",
            "waf": "安全"
        },
        {
            "category": "身份和訪問管理",
            "guid": "35037e68-9349-4c15-b371-228514f4cdff",
            "id": "B03.15",
            "link": "https://learn.microsoft.com/azure/active-directory/roles/best-practices",
            "service": "Entra",
            "severity": "中等",
            "subcategory": "身份",
            "text": "避免將本地同步帳戶用於 Microsoft Entra ID 角色分配。",
            "training": "https://learn.microsoft.com/learn/modules/design-identity-security-strategy/",
            "waf": "安全"
        },
        {
            "category": "身份和訪問管理",
            "guid": "9cf5418b-1520-4b7b-add7-88eb28f833e8",
            "id": "B04.01",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/identity-access-landing-zones#managed-identities",
            "severity": "中等",
            "subcategory": "登陸區域",
            "text": "通過使用虛擬網路配置標識網路分段，並對等回中心。在應用程式登陸區域（舊版）內提供身份驗證。",
            "training": "https://learn.microsoft.com/azure/architecture/example-scenario/identity/adds-extend-domain",
            "waf": "安全"
        },
        {
            "category": "身份和訪問管理",
            "guid": "d4d1ad54-1abc-4919-b267-3f342d3b49e4",
            "id": "B04.02",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/identity-access-landing-zones#rbac-recommendations",
            "severity": "中等",
            "subcategory": "登陸區域",
            "text": "如果可能，請使用 Azure RBAC 管理對資源的數據平面訪問。例如，跨 Key Vault、存儲帳戶和資料庫服務的數據操作。",
            "training": "https://learn.microsoft.com/azure/role-based-access-control/overview",
            "waf": "安全"
        },
        {
            "category": "身份和訪問管理",
            "guid": "d505ebcb-79b1-4274-9c0d-a27c8bea489c",
            "id": "B04.03",
            "link": "https://learn.microsoft.com/azure/active-directory/privileged-identity-management/pim-create-roles-and-resource-roles-review",
            "severity": "中等",
            "subcategory": "登陸區域",
            "text": "使用 Microsoft Entra ID PIM 訪問評審定期驗證資源權利。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "category": "資源組織",
            "guid": "cacf55bc-e4e4-46be-96bc-57a5f23a269a",
            "id": "C01.01",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/resource-naming",
            "severity": "高",
            "subcategory": "命名和標記",
            "text": "建議遵循 Microsoft 最佳實踐命名標準",
            "waf": "安全"
        },
        {
            "category": "資源組織",
            "graph": "resourcecontainers| where type == 'microsoft.resources/subscriptions'| extend ManagementGroup = tostring(tags),mgmtChain = properties.managementGroupAncestorsChain| extend compliant =( array_length(mgmtChain) <= 4 and array_length(mgmtChain) > 1)",
            "guid": "2df27ee4-12e7-4f98-9f63-04722dd69c5b",
            "id": "C02.01",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/resource-org-management-groups",
            "severity": "中等",
            "subcategory": "訂閱",
            "text": "強制實施不超過四個級別的合理扁平化管理組層次結構。",
            "training": "https://learn.microsoft.com/learn/modules/azure-architecture-fundamentals/",
            "waf": "安全"
        },
        {
            "category": "資源組織",
            "guid": "667313b4-f566-44b5-b984-a859c773e7d2",
            "id": "C02.02",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/resource-org-management-groups#management-group-recommendations",
            "severity": "中等",
            "subcategory": "訂閱",
            "text": "強制實施沙箱管理組，允許使用者立即試驗 Azure",
            "training": "https://learn.microsoft.com/learn/paths/enterprise-scale-architecture/",
            "waf": "安全"
        },
        {
            "category": "資源組織",
            "guid": "61623a76-5a91-47e1-b348-ef254c27d42e",
            "id": "C02.03",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/resource-org-management-groups#management-group-recommendations",
            "severity": "中等",
            "subcategory": "訂閱",
            "text": "在根管理組下強制實施平臺管理組，以支援通用平臺策略和 Azure 角色分配",
            "training": "https://learn.microsoft.com/learn/paths/enterprise-scale-architecture/",
            "waf": "安全"
        },
        {
            "category": "資源組織",
            "guid": "8bbac757-1559-4ab9-853e-8908ae28c84c",
            "id": "C02.04",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/resource-org-management-groups#management-group-recommendations",
            "severity": "中等",
            "subcategory": "訂閱",
            "text": "在連接管理組中強制實施專用連接訂閱，以託管 Azure 虛擬 WAN 中心、專用域名系統 （DNS）、ExpressRoute 線路和其他網路資源。",
            "training": "https://learn.microsoft.com/learn/paths/enterprise-scale-architecture/",
            "waf": "安全"
        },
        {
            "category": "資源組織",
            "graph": "resourcecontainers| where type == 'microsoft.resources/subscriptions'| extend ManagementGroup = tostring(tags),mgmtChain = properties.managementGroupAncestorsChain| extend compliant = (array_length(mgmtChain) > 1)",
            "guid": "33b6b780-8b9f-4e5c-9104-9d403a923c34",
            "id": "C02.05",
            "link": "https://learn.microsoft.com/azure/governance/management-groups/how-to/protect-resource-hierarchy#setting---default-management-group",
            "severity": "中等",
            "subcategory": "訂閱",
            "text": "強制在根管理組下放置任何訂閱",
            "waf": "安全"
        },
        {
            "category": "資源組織",
            "guid": "74d00018-ac6a-49e0-8e6a-83de5de32c19",
            "id": "C02.06",
            "link": "https://learn.microsoft.com/azure/governance/management-groups/how-to/protect-resource-hierarchy#setting---require-authorization",
            "severity": "中等",
            "subcategory": "訂閱",
            "text": "通過在管理組層次結構設置中啟用 Azure RBAC 授權，強制只有特權使用者才能在租戶中操作管理組",
            "waf": "安全"
        },
        {
            "category": "資源組織",
            "guid": "92481607-d5d1-4e4e-9146-58d3558fd772",
            "id": "C02.07",
            "link": "https://learn.microsoft.com/azure/governance/management-groups/overview",
            "severity": "中等",
            "subcategory": "訂閱",
            "text": "在根級管理組下強制實施管理組，以根據工作負載的安全性、合規性、連接性和功能需求來表示工作負載的類型。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "category": "資源組織",
            "guid": "49b82111-2df2-47ee-912e-7f983f630472",
            "id": "C02.08",
            "link": "https://learn.microsoft.com/azure/governance/management-groups/overview",
            "severity": "高",
            "subcategory": "訂閱",
            "text": "強制執行流程，使資源擁有者瞭解其角色和職責、訪問審查、預算審查、策略合規性，並在必要時進行修正。",
            "waf": "安全"
        },
        {
            "category": "資源組織",
            "guid": "2dd69c5b-5c26-422f-94b6-9bad33aad5e8",
            "id": "C02.09",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits",
            "severity": "中等",
            "subcategory": "訂閱",
            "text": "確保所有訂閱擁有者和IT核心團隊都瞭解訂閱配額及其對給定訂閱預配資源的影響。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "category": "資源組織",
            "guid": "c68e1d76-6673-413b-9f56-64b5e984a859",
            "id": "C02.10",
            "link": "https://learn.microsoft.com/azure/cost-management-billing/reservations/save-compute-costs-reservations",
            "severity": "高",
            "subcategory": "訂閱",
            "text": "在適當的情況下使用預留實例來優化成本並確保目標區域的可用容量。通過 Azure Policy 強制使用已購買的預留實例 VM SKU。",
            "training": "https://learn.microsoft.com/learn/paths/improve-reliability-modern-operations/",
            "waf": "安全"
        },
        {
            "ammp": true,
            "category": "資源組織",
            "guid": "c773e7d2-6162-43a7-95a9-17e1f348ef25",
            "id": "C02.11",
            "link": "https://learn.microsoft.com/azure/architecture/framework/scalability/design-capacity",
            "severity": "高",
            "subcategory": "訂閱",
            "text": "強制實施儀錶板、工作簿或手動過程以監控已用容量級別",
            "training": "https://learn.microsoft.com/learn/paths/monitor-usage-performance-availability-resources-azure-monitor/",
            "waf": "安全"
        },
        {
            "ammp": true,
            "category": "資源組織",
            "guid": "ae28c84c-33b6-4b78-88b9-fe5c41049d40",
            "id": "C02.12",
            "link": "https://learn.microsoft.com/azure/cost-management-billing/cost-management-billing-overview",
            "severity": "高",
            "subcategory": "訂閱",
            "text": "強制執行成本管理流程",
            "training": "https://learn.microsoft.com/learn/paths/control-spending-manage-bills/",
            "waf": "安全"
        },
        {
            "category": "資源組織",
            "guid": "3a923c34-74d0-4001-aac6-a9e01e6a83de",
            "id": "C02.13",
            "link": "https://learn.microsoft.com/azure/governance/management-groups/overview",
            "severity": "中等",
            "subcategory": "訂閱",
            "text": "如果伺服器將用於標識服務（如域控制器），請在標識管理組中建立專用標識訂閱，以託管這些服務。請確保將資源設置為使用其區域中可用的域控制器。",
            "training": "https://learn.microsoft.com/learn/paths/enterprise-scale-architecture/",
            "waf": "安全"
        },
        {
            "category": "資源組織",
            "graph": "resources | extend compliant = isnotnull(['tags']) | project name, id, subscriptionId, resourceGroup, tags, compliant",
            "guid": "5de32c19-9248-4160-9d5d-1e4e614658d3",
            "id": "C02.14",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/track-costs",
            "severity": "中等",
            "subcategory": "訂閱",
            "text": "確保標籤用於計費和成本管理",
            "training": "https://learn.microsoft.com/learn/paths/implement-resource-mgmt-security/",
            "waf": "安全"
        },
        {
            "category": "資源組織",
            "guid": "6cc0ea22-42bb-441e-a345-804ab0a09666",
            "id": "C02.15",
            "link": "https://github.com/Azure/sovereign-landing-zone/blob/main/docs/02-Architecture.md",
            "severity": "中等",
            "subcategory": "訂閱",
            "text": "對於主權登陸區，在「登陸區」MG下有一個「機密公司」和「機密在線」管理組。",
            "waf": "安全"
        },
        {
            "category": "資源組織",
            "guid": "250d81ce-8bbe-4f85-9051-6a18a8221e50",
            "id": "C03.01",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-setup-guide/regions",
            "severity": "高",
            "subcategory": "地區",
            "text": "為部署選擇正確的 Azure 區域。Azure 是一個全球規模的雲平臺，可通過許多區域和地理位置提供全球覆蓋。不同的 Azure 區域具有不同的特徵、訪問和可用性模型、成本、容量和提供的服務，因此必須考慮所有條件和要求",
            "training": "https://learn.microsoft.com/learn/modules/azure-architecture-fundamentals/",
            "waf": "可靠性"
        },
        {
            "category": "資源組織",
            "guid": "19ca3f89-397d-44b1-b5b6-5e18661372ac",
            "id": "C03.02",
            "link": "https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/ready/azure-setup-guide/regions#operate-in-multiple-geographic-regions",
            "severity": "中等",
            "subcategory": "地區",
            "text": "請考慮多區域部署。根據客戶規模、位置和用戶狀態，在多個區域運營可能是交付服務和運行更靠近這些區域的應用程式的常見選擇。使用多區域部署對於提供異地災難恢復功能、消除單個區域容量的依賴關係以及降低臨時和當地語系化資源容量限制的風險也很重要",
            "training": "https://learn.microsoft.com/learn/modules/azure-architecture-fundamentals/",
            "waf": "可靠性"
        },
        {
            "category": "資源組織",
            "guid": "4c27d42e-8bba-4c75-9155-9ab9153e8908",
            "id": "C03.03",
            "link": "https://azure.microsoft.com/explore/global-infrastructure/products-by-region/",
            "severity": "中等",
            "subcategory": "地區",
            "text": "確保所需的服務和功能在所選部署區域中可用",
            "training": "https://learn.microsoft.com/learn/modules/azure-architecture-fundamentals/",
            "waf": "可靠性"
        },
        {
            "category": "網路拓撲和連接",
            "guid": "373f482f-3e39-4d39-8aa4-7e566f6082b6",
            "id": "D01.01",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-app-delivery",
            "severity": "中等",
            "subcategory": "應用交付",
            "text": "制定計劃，使用應用程式閘道和 Azure Front door 保護工作負載分支中的交付應用程式內容。 您可以使用應用程式交付清單來獲取建議。",
            "waf": "操作"
        },
        {
            "category": "網路拓撲和連接",
            "guid": "6138a720-0f1c-4e16-bd30-1d6e872e52e3",
            "id": "D01.02",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/resource-org-management-groups#management-groups-in-the-azure-landing-zone-accelerator",
            "severity": "中等",
            "subcategory": "應用交付",
            "text": "在面向內部 （corp） 和面向外部的應用 （online） 的登陸區域內執行應用交付。",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "安全"
        },
        {
            "category": "網路拓撲和連接",
            "guid": "143b16c3-1d7a-4a9b-9470-4489a8042d88",
            "id": "D01.03",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "service": "VNet",
            "severity": "中等",
            "subcategory": "應用交付",
            "text": "對應用程式登陸區域中的所有公共IP位址使用 DDoS 網路或IP防護計畫。",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "安全"
        },
        {
            "category": "網路拓撲和連接",
            "guid": "de0d5973-cd4c-4d21-a088-137f5e6c4cfd",
            "id": "D02.01",
            "link": "https://learn.microsoft.com/en-us/azure/expressroute/expressroute-howto-macsec",
            "service": "ExpressRoute",
            "severity": "中等",
            "subcategory": "加密",
            "text": "使用 ExpressRoute Direct 時，請配置 MACsec，以便加密組織路由器和 MSEE 之間的第二層級別的流量。該圖顯示了流中的此加密。",
            "waf": "安全"
        },
        {
            "category": "網路拓撲和連接",
            "guid": "ed301d6e-872e-452e-9611-cc58b5a4b151",
            "id": "D02.02",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-erdirect-about",
            "service": "ExpressRoute",
            "severity": "低",
            "subcategory": "加密",
            "text": "對於無法使用MACsec的方案（例如，不使用ExpressRoute Direct），請使用 VPN 閘道通過 ExpressRoute 專用對等互連建立 IPsec 隧道。",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/",
            "waf": "安全"
        },
        {
            "category": "網路拓撲和連接",
            "guid": "e8bbac75-7155-49ab-a153-e8908ae28c84",
            "id": "D03.01",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/enterprise-scale/network-topology-and-connectivity",
            "service": "VNet",
            "severity": "中等",
            "subcategory": "輪輻式",
            "text": "利用基於傳統中心輻射型網路拓撲的網路設計，滿足需要最大靈活性的網路方案。",
            "training": "https://learn.microsoft.com/learn/paths/architect-network-infrastructure/",
            "waf": "安全"
        },
        {
            "ammp": true,
            "category": "網路拓撲和連接",
            "guid": "7dd61623-a364-4a90-9eca-e48ebd54cd7d",
            "id": "D03.02",
            "link": "https://learn.microsoft.com/azure/architecture/reference-architectures/hybrid-networking/expressroute",
            "service": "VNet",
            "severity": "高",
            "subcategory": "輪輻式",
            "text": "確保共用網路服務（包括 ExpressRoute 閘道、VPN 閘道和 Azure 防火牆或合作夥伴 NVA）位於中心虛擬網路中。如有必要，還可以部署 DNS 伺服器。",
            "waf": "成本"
        },
        {
            "category": "網路拓撲和連接",
            "guid": "e2e8abac-3571-4559-ab91-53e89f89dc7b",
            "id": "D03.03",
            "link": "https://learn.microsoft.com/azure/architecture/reference-architectures/dmz/nva-ha",
            "service": "NVA",
            "severity": "中等",
            "subcategory": "輪輻式",
            "text": "部署合作夥伴網路技術或 NVA 時，請遵循合作夥伴供應商的指導",
            "waf": "可靠性"
        },
        {
            "category": "網路拓撲和連接",
            "guid": "ce463dbb-bc8a-4c2a-aebc-92a43da1dae2",
            "id": "D03.04",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-howto-coexist-resource-manager#to-enable-transit-routing-between-expressroute-and-azure-vpn",
            "service": "ExpressRoute",
            "severity": "低",
            "subcategory": "輪輻式",
            "text": "如果需要在中心輻射型方案中的 ExpressRoute 和 VPN 閘道之間傳輸，請使用 Azure 路由伺服器。",
            "waf": "安全"
        },
        {
            "category": "網路拓撲和連接",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,subnets=properties.subnets | mv-expand subnets | project id, subnetName = subnets.name, subnetPrefix = subnets.properties.addressPrefix | extend subnetPrefixLength = split(subnetPrefix, '/')[1] | where subnetName == 'RouteServerSubnet' | extend compliant = (subnetPrefixLength <= 27) | distinct id, compliant",
            "guid": "91b9d7d5-91e1-4dcb-8f1f-fa7e465646cc",
            "id": "D03.05",
            "link": "https://learn.microsoft.com/azure/route-server/quickstart-configure-route-server-portal#create-a-route-server-1",
            "service": "ARS",
            "severity": "低",
            "subcategory": "輪輻式",
            "text": "如果使用 Route Server，請對 Route Server 子網使用 /27 前置綴。",
            "waf": "安全"
        },
        {
            "category": "網路拓撲和連接",
            "guid": "cc881471-607c-41cc-a0e6-14658dd558f9",
            "id": "D03.06",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-networks-faq#can-i-create-a-peering-connection-to-a-vnet-in-a-different-region",
            "service": "VNet",
            "severity": "中等",
            "subcategory": "輪輻式",
            "text": "對於跨 Azure 區域具有多個中心輻射型拓撲的網路體系結構，請使用中心 VNet 之間的全域虛擬網路對等互連將區域相互連接。",
            "training": "https://learn.microsoft.com/learn/paths/azure-administrator-manage-virtual-networks/",
            "waf": "性能"
        },
        {
            "category": "網路拓撲和連接",
            "guid": "4722d929-c1b1-4cd6-81f5-4b29bade39ad",
            "id": "D03.07",
            "link": "https://learn.microsoft.com/azure/azure-monitor/insights/network-insights-overview",
            "service": "VNet",
            "severity": "中等",
            "subcategory": "輪輻式",
            "text": "使用用於網路的 Azure Monitor 監視 Azure 上網路的端到端狀態。",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-network-monitoring/",
            "waf": "操作"
        },
        {
            "category": "網路拓撲和連接",
            "graph": "resources | where type == 'microsoft.network/virtualnetworks' | mvexpand properties.virtualNetworkPeerings | summarize peeringcount = count() by id | extend compliant = (peeringcount < 450) | distinct id,compliant",
            "guid": "0e7c28ec-9366-4572-83b0-f4664b1d944a",
            "id": "D03.08",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits?toc=/azure/virtual-network/toc.json#azure-resource-manager-virtual-networking-limits",
            "service": "VNet",
            "severity": "中等",
            "subcategory": "輪輻式",
            "text": "將分支虛擬網路連接到中央中心虛擬網路時，請考慮 VNet 對等互連限制 （500），即可通過 ExpressRoute 播發的最大前綴數 （1000）",
            "waf": "可靠性"
        },
        {
            "category": "網路拓撲和連接",
            "graph": "resources | where type=='microsoft.network/routetables' | mvexpand properties.routes | summarize routeCount = count() by id | extend compliant = (routeCount < 360) | distinct id,compliant",
            "guid": "3d457936-e9b7-41eb-bdff-314b26450b12",
            "id": "D03.09",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits?toc=/azure/virtual-network/toc.json#azure-resource-manager-virtual-networking-limits",
            "service": "VNet",
            "severity": "中等",
            "subcategory": "輪輻式",
            "text": "考慮每個路由表的路由限制 （400）。",
            "waf": "可靠性"
        },
        {
            "ammp": true,
            "category": "網路拓撲和連接",
            "graph": "resources | where type == 'microsoft.network/virtualnetworks' | mvexpand properties.virtualNetworkPeerings | project id, peeringName=properties_virtualNetworkPeerings.name, compliant = (properties_virtualNetworkPeerings.properties.allowVirtualNetworkAccess == True)",
            "guid": "c76cb5a2-abe2-11ed-afa1-0242ac120002",
            "id": "D03.10",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-network-manage-peering",
            "service": "VNet",
            "severity": "高",
            "subcategory": "輪輻式",
            "text": "配置 VNet 對等互連時，使用「允許流量流向遠端虛擬網路」設置",
            "waf": "可靠性"
        },
        {
            "category": "網路拓撲和連接",
            "guid": "359c373e-7dd6-4162-9a36-4a907ecae48e",
            "id": "D04.01",
            "link": "https://learn.microsoft.com/azure/architecture/reference-architectures/hybrid-networking/hub-spoke?tabs=cli",
            "service": "ExpressRoute",
            "severity": "中等",
            "subcategory": "混合",
            "text": "確保已調查使用 ExpressRoute 作為與 Azure 的主要連接的可能性。",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "性能"
        },
        {
            "category": "網路拓撲和連接",
            "description": "可以使用 AS 路徑前置和連接權重來影響從 Azure 到本地的流量，並使用自己的路由器中的全部 BGP 屬性來影響從本地到 Azure 的流量。",
            "guid": "f29812b2-363c-4efe-879b-599de0d5973c",
            "id": "D04.02",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-routing",
            "service": "ExpressRoute",
            "severity": "中等",
            "subcategory": "混合",
            "text": "使用多條 ExpressRoute 線路或多個本地位置時，請確保使用 BGP 屬性優化路由（如果首選某些路徑）。",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "可靠性"
        },
        {
            "category": "網路拓撲和連接",
            "graph": "resources| where type == 'microsoft.network/virtualnetworkgateways'| where properties.gatewayType =~ 'vpn' or properties.gatewayType == 'ExpressRoute'| extend SKUName = properties.sku.name, SKUTier = properties.sku.tier, Type = properties.gatewayType| extend compliant = SKUTier !in ('Basic', 'Standard')| project name, id, subscriptionId, resourceGroup, compliant",
            "guid": "d4cd21b0-8813-47f5-b6c4-cfd3e504547c",
            "id": "D04.03",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-routing",
            "service": "ExpressRoute",
            "severity": "中等",
            "subcategory": "混合",
            "text": "確保根據頻寬和性能要求為 ExpressRoute/VPN 閘道使用正確的 SKU。",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "性能"
        },
        {
            "ammp": true,
            "category": "網路拓撲和連接",
            "graph": "resources | where type=='microsoft.network/expressroutecircuits' | extend compliant = (tolower(sku.family) == 'metereddata' or tolower(sku.tier) == 'local') | distinct id,compliant",
            "guid": "7025b442-f6e9-4af6-b11f-c9574916016f",
            "id": "D04.04",
            "link": "https://learn.microsoft.com/azure/expressroute/plan-manage-cost",
            "service": "ExpressRoute",
            "severity": "高",
            "subcategory": "混合",
            "text": "確保僅當達到證明其成本合理的頻寬時，才使用無限數據的ExpressRoute線路。",
            "waf": "成本"
        },
        {
            "ammp": true,
            "category": "網路拓撲和連接",
            "graph": "resources | where type=='microsoft.network/connections' | where properties.connectionType == 'ExpressRoute' | project id, gwid=tostring(properties.virtualNetworkGateway1.id), circuitid=tostring(properties.peer.id) | join (resources | where type=='microsoft.network/expressroutecircuits' | project circuitid=tostring(id), circuitsku=sku.tier) on circuitid | project id=gwid, compliant = (circuitsku == 'Local') | summarize compliant=max(compliant) by id",
            "guid": "f4e7926a-ec35-476e-a412-5dd17136bd62",
            "id": "D04.05",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-faqs#expressroute-local",
            "service": "ExpressRoute",
            "severity": "高",
            "subcategory": "混合",
            "text": "如果線路的對等互連位置支援本地 SKU 的 Azure 區域，則利用 ExpressRoute 的本地 SKU 來降低線路的成本。",
            "waf": "成本"
        },
        {
            "category": "網路拓撲和連接",
            "graph": "resources| where type == 'microsoft.network/virtualnetworkgateways'| where properties.gatewayType =~ 'vpn' or properties.gatewayType == 'ExpressRoute'| extend SKUName = properties.sku.name, SKUTier = properties.sku.tier, Type = properties.gatewayType| extend compliant = SKUTier contains 'AZ'| project name, id, subscriptionId, resourceGroup, Type, compliant",
            "guid": "2447ec66-138a-4720-8f1c-e16ed301d6e8",
            "id": "D04.06",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-about-virtual-network-gateways",
            "service": "ExpressRoute",
            "severity": "中等",
            "subcategory": "混合",
            "text": "在受支援的 Azure 區域中部署區域冗餘 ExpressRoute 閘道。",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "可靠性"
        },
        {
            "category": "網路拓撲和連接",
            "guid": "72e52e36-11cc-458b-9a4b-1511e43a58a9",
            "id": "D04.07",
            "link": "https://learn.microsoft.com/azure/networking/",
            "service": "ExpressRoute",
            "severity": "中等",
            "subcategory": "混合",
            "text": "對於需要高於 10 Gbps 的頻寬或專用 10/100 Gbps 埠的方案，請使用 ExpressRoute Direct。",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "性能"
        },
        {
            "category": "網路拓撲和連接",
            "guid": "c2299c4d-7b57-4d0c-9555-62f2b3e4563a",
            "id": "D04.08",
            "link": "https://learn.microsoft.com/azure/expressroute/about-fastpath",
            "service": "ExpressRoute",
            "severity": "中等",
            "subcategory": "混合",
            "text": "如果需要低延遲，或者從本地到 Azure 的輸送量必須大於 10 Gbps，請啟用 FastPath 以繞過數據路徑的 ExpressRoute 閘道。",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "性能"
        },
        {
            "category": "網路拓撲和連接",
            "graph": "resources | where type=='microsoft.network/virtualnetworkgateways' | where properties.gatewayType == 'Vpn' | extend compliant = (tolower(properties.sku.name) contains 'az') | distinct id, compliant",
            "guid": "4d873974-8b66-42d6-b15f-512a65498f6d",
            "id": "D04.09",
            "link": "https://learn.microsoft.com/azure/vpn-gateway/create-zone-redundant-vnet-gateway",
            "service": "VPN",
            "severity": "中等",
            "subcategory": "混合",
            "text": "使用區域冗餘 VPN 閘道將分支或遠端位置連接到 Azure（如果可用）。",
            "training": "https://learn.microsoft.com/training/modules/intro-to-azure-vpn-gateway/",
            "waf": "可靠性"
        },
        {
            "category": "網路拓撲和連接",
            "guid": "45866df8-cf85-4ca9-bbe2-65ec1478919e",
            "id": "D04.10",
            "link": "https://learn.microsoft.com/azure/vpn-gateway/vpn-gateway-highlyavailable",
            "service": "VPN",
            "severity": "中等",
            "subcategory": "混合",
            "text": "在本地使用冗餘 VPN 設備（主動/主動或主動/被動）。",
            "training": "https://learn.microsoft.com/training/modules/intro-to-azure-vpn-gateway/",
            "waf": "可靠性"
        },
        {
            "ammp": true,
            "category": "網路拓撲和連接",
            "guid": "718cb437-b060-2589-8856-2e93a5c6633b",
            "id": "D04.11",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-erdirect-about",
            "service": "ExpressRoute",
            "severity": "高",
            "subcategory": "混合",
            "text": "如果使用 ExpressRoute Direct，請考慮使用本地 Azure 區域的 ExpressRoute 本地線路來節省成本",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "成本"
        },
        {
            "category": "網路拓撲和連接",
            "guid": "8042d88e-79d1-47b7-9b22-a5a67e7a8ed4",
            "id": "D04.12",
            "link": "https://learn.microsoft.com/azure/architecture/framework/services/networking/expressroute/reliability",
            "service": "ExpressRoute",
            "severity": "中等",
            "subcategory": "混合",
            "text": "當需要流量隔離或專用頻寬時（例如，用於分離生產環境和非生產環境），請使用不同的 ExpressRoute 線路。它將幫助您確保隔離的路由域並減輕干擾鄰居風險。",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "安全"
        },
        {
            "category": "網路拓撲和連接",
            "guid": "b30e38c3-f298-412b-8363-cefe179b599d",
            "id": "D04.13",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-monitoring-metrics-alerts",
            "service": "ExpressRoute",
            "severity": "中等",
            "subcategory": "混合",
            "text": "使用內置的 Express Route Insights 監視 ExpressRoute 的可用性和利用率。",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "操作"
        },
        {
            "category": "網路拓撲和連接",
            "guid": "5bf68dc9-325e-4873-bf88-f8214ef2e5d2",
            "id": "D04.14",
            "link": "https://learn.microsoft.com/azure/expressroute/how-to-configure-connection-monitor",
            "service": "ExpressRoute",
            "severity": "中等",
            "subcategory": "混合",
            "text": "使用連接監視器進行跨網路的連接監視，尤其是在本地和 Azure 之間。",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "操作"
        },
        {
            "category": "網路拓撲和連接",
            "graph": "resources | where type=='microsoft.network/connections' | where properties.connectionType == 'ExpressRoute' | project cxId=id, gwId=tostring(properties.virtualNetworkGateway1.id), circuitId=tostring(properties.peer.id) | join (resources | where type=='microsoft.network/expressroutecircuits' | project circuitId=tostring(id), circuitLocation=tostring(properties.serviceProviderProperties.peeringLocation)) on circuitId | distinct gwId, circuitLocation | summarize countErLocations=count() by id=gwId | extend compliant = (countErLocations >= 2)",
            "guid": "e0d5973c-d4cd-421b-8881-37f5e6c4cfd3",
            "id": "D04.15",
            "link": "https://learn.microsoft.com/azure/expressroute/designing-for-disaster-recovery-with-expressroute-privatepeering#challenges-of-using-multiple-expressroute-circuits",
            "service": "ExpressRoute",
            "severity": "中等",
            "subcategory": "混合",
            "text": "使用來自不同對等互連位置的 ExpressRoute 線路實現冗餘。",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "可靠性"
        },
        {
            "category": "網路拓撲和連接",
            "guid": "cf3fe65c-fec0-495a-8edc-9675200f2add",
            "id": "D04.16",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-howto-coexist-resource-manager",
            "service": "ExpressRoute",
            "severity": "中等",
            "subcategory": "混合",
            "text": "使用網站到網站 VPN 作為 ExpressRoute 的故障轉移，尤其是在僅使用單個 ExpressRoute 線路時。",
            "waf": "可靠性"
        },
        {
            "ammp": true,
            "category": "網路拓撲和連接",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,resourceGroup,name,subnets=properties.subnets | mv-expand subnets | project id,resourceGroup,name,subnetName=tostring(subnets.name),routeTableId=tostring(subnets.properties.routeTable.id) | where subnetName == 'GatewaySubnet' | join kind=leftouter (Resources | where type == 'microsoft.network/routetables' | project routeTableName=name,routeTableId=id, disableBgpRoutePropagation=properties.disableBgpRoutePropagation) on routeTableId | project id,compliant = (disableBgpRoutePropagation == False or isnull(disableBgpRoutePropagation))",
            "guid": "72105cc8-aaea-4ee1-8c7a-ad25977afcaf",
            "id": "D04.17",
            "link": "https://learn.microsoft.com/azure/vpn-gateway/vpn-gateway-about-vpn-gateway-settings#gwsub",
            "service": "ExpressRoute",
            "severity": "高",
            "subcategory": "混合",
            "text": "如果在 GatewaySubnet 中使用路由表，請確保傳播閘道路由。",
            "waf": "可靠性"
        },
        {
            "ammp": true,
            "category": "網路拓撲和連接",
            "guid": "d581a947-69a2-4783-942e-9df3664324c8",
            "id": "D04.18",
            "link": "https://learn.microsoft.com/azure/expressroute/designing-for-high-availability-with-expressroute#active-active-connections",
            "service": "ExpressRoute",
            "severity": "高",
            "subcategory": "混合",
            "text": "如果使用 ExpressRoute，則本地路由應是動態的：如果連接失敗，它應收斂到線路的剩餘連接。理想情況下，負載應在兩個連接之間共用為主動/主動，但也支持主動/被動。",
            "waf": "可靠性"
        },
        {
            "category": "網路拓撲和連接",
            "guid": "b258f058-b9f6-46cd-b28d-990106f0c3f8",
            "id": "D04.19",
            "link": "https://learn.microsoft.com/en-us/azure/expressroute/designing-for-high-availability-with-expressroute",
            "service": "ExpressRoute",
            "severity": "中等",
            "subcategory": "混合",
            "text": "確保 ExpressRoute 線路的兩個物理連結連接到網路中的兩個不同的邊緣設備。",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "可靠性"
        },
        {
            "category": "網路拓撲和連接",
            "guid": "fe2a1b53-6fbd-4c67-b58a-85d7c7a0afcb",
            "id": "D04.20",
            "link": "https://learn.microsoft.com/en-us/azure/expressroute/expressroute-bfd",
            "service": "ExpressRoute",
            "severity": "中等",
            "subcategory": "混合",
            "text": "確保在客戶或供應商邊緣路由設備上啟用並配置雙向轉發檢測 （BFD）。",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "可靠性"
        },
        {
            "category": "網路拓撲和連接",
            "guid": "669b215a-ce43-4371-8f6f-11047f6490f1",
            "id": "D04.22",
            "link": "https://learn.microsoft.com/en-us/azure/expressroute/designing-for-disaster-recovery-with-expressroute-privatepeering",
            "service": "ExpressRoute",
            "severity": "高",
            "subcategory": "混合",
            "text": "將 ExpressRoute 閘道連接到來自不同對等互連位置的兩條或多條線路，以提高復原能力。",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "可靠性"
        },
        {
            "category": "網路拓撲和連接",
            "guid": "3f79ed00-203b-4c95-9efd-691505f5a1f9",
            "id": "D04.23",
            "link": "https://learn.microsoft.com/en-us/azure/vpn-gateway/vpn-gateway-howto-setup-alerts-virtual-network-gateway-log",
            "service": "ExpressRoute",
            "severity": "中等",
            "subcategory": "混合",
            "text": "為 ExpressRoute 虛擬網路閘道配置診斷日誌和警報。",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "操作"
        },
        {
            "category": "網路拓撲和連接",
            "guid": "5234c93f-b651-41dd-80c1-234177b91ced",
            "id": "D04.24",
            "link": "https://learn.microsoft.com/en-us/azure/expressroute/virtual-network-connectivity-guidance",
            "service": "ExpressRoute",
            "severity": "中等",
            "subcategory": "混合",
            "text": "避免使用 ExpressRoute 線路進行 VNet 到 VNet 通信。",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "性能"
        },
        {
            "ammp": true,
            "category": "網路拓撲和連接",
            "guid": "558fd772-49b8-4211-82df-27ee412e7f98",
            "id": "D05.01",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-ip-addressing",
            "service": "ExpressRoute",
            "severity": "高",
            "subcategory": "知識產權計劃",
            "text": "確保在 Azure 區域和本地位置之間不使用重疊的 IP 位址空間",
            "training": "https://learn.microsoft.com/learn/paths/architect-network-infrastructure/",
            "waf": "安全"
        },
        {
            "category": "網路拓撲和連接",
            "graph": "resources | where type == 'microsoft.network/virtualnetworks' | extend addressSpace = todynamic(properties.addressSpace) | extend addressPrefix = todynamic(properties.addressSpace.addressPrefixes) | mvexpand addressSpace | mvexpand addressPrefix | project name, id, location, resourceGroup, subscriptionId, cidr = addressPrefix | extend compliant = (cidr matches regex @'^(10\\\\.|172\\\\.(1[6-9]|2[0-9]|3[01])\\\\.|192\\\\.168\\\\.)')  | project id, compliant, cidr",
            "guid": "3f630472-2dd6-49c5-a5c2-622f54b69bad",
            "id": "D05.02",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-ip-addressing",
            "service": "VNet",
            "severity": "低",
            "subcategory": "知識產權計劃",
            "text": "使用專用 Internet 位址分配範圍 （RFC 1918） 中的 IP 位址。",
            "training": "https://learn.microsoft.com/learn/paths/architect-network-infrastructure/",
            "waf": "安全"
        },
        {
            "ammp": true,
            "category": "網路拓撲和連接",
            "graph": "resources | where type == 'microsoft.network/virtualnetworks' | extend addressSpace = todynamic(properties.addressSpace) | extend addressPrefix = todynamic(properties.addressSpace.addressPrefixes) | mvexpand addressSpace | mvexpand addressPrefix | extend addressMask = split(addressPrefix,'/')[1] | extend compliant = addressMask > 16 | project name, id, subscriptionId, resourceGroup, addressPrefix, compliant",
            "guid": "33aad5e8-c68e-41d7-9667-313b4f5664b5",
            "id": "D05.03",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-ip-addressing",
            "service": "VNet",
            "severity": "高",
            "subcategory": "知識產權計劃",
            "text": "確保IP位址空間不被浪費，不要創建不必要的大型虛擬網路（例如 /16）Ensure that that IP address space is not disdised， don't create un不必要的大型虛擬網路（例如 /16）Ensure that that IP address space is not waste， don't create un不必要的大型虛擬網络（例如 /16）Ensure that that IP address space is",
            "training": "https://learn.microsoft.com/learn/paths/architect-network-infrastructure/",
            "waf": "性能"
        },
        {
            "ammp": true,
            "category": "網路拓撲和連接",
            "guid": "f348ef25-4c27-4d42-b8bb-ac7571559ab9",
            "id": "D05.04",
            "link": "https://learn.microsoft.com/azure/site-recovery/concepts-on-premises-to-azure-networking#retain-ip-addresses",
            "service": "VNet",
            "severity": "高",
            "subcategory": "知識產權計劃",
            "text": "避免對生產網站和DR網站使用重疊的IP位址範圍。",
            "training": "https://learn.microsoft.com/learn/paths/az-104-manage-virtual-networks/",
            "waf": "可靠性"
        },
        {
            "category": "網路拓撲和連接",
            "guid": "153e8908-ae28-4c84-a33b-6b7808b9fe5c",
            "id": "D05.05",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-networks-name-resolution-for-vms-and-role-instances",
            "service": "DNS",
            "severity": "中等",
            "subcategory": "知識產權計劃",
            "text": "對於只需要在 Azure 中進行名稱解析的環境，請使用 Azure 專用 DNS 進行解析，並使用委派區域進行名稱解析（例如“azure.contoso.com”）。",
            "training": "https://learn.microsoft.com/learn/paths/az-104-manage-virtual-networks/",
            "waf": "操作"
        },
        {
            "category": "網路拓撲和連接",
            "guid": "41049d40-3a92-43c3-974d-00018ac6a9e0",
            "id": "D05.06",
            "link": "https://learn.microsoft.com/azure/dns/dns-private-resolver-overview",
            "service": "DNS",
            "severity": "中等",
            "subcategory": "知識產權計劃",
            "text": "對於需要跨 Azure 和本地進行名稱解析的環境，請考慮使用 Azure DNS 專用解析程式。",
            "training": "https://learn.microsoft.com/training/modules/intro-to-azure-dns-private-resolver/",
            "waf": "安全"
        },
        {
            "category": "網路拓撲和連接",
            "guid": "1e6a83de-5de3-42c1-a924-81607d5d1e4e",
            "id": "D05.07",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-networks-name-resolution-for-vms-and-role-instances",
            "service": "DNS",
            "severity": "低",
            "subcategory": "知識產權計劃",
            "text": "需要並部署自己的 DNS（例如 Red Hat OpenShift）的特殊工作負載應使用其首選的 DNS 解決方案。",
            "waf": "操作"
        },
        {
            "ammp": true,
            "category": "網路拓撲和連接",
            "guid": "614658d3-558f-4d77-849b-821112df27ee",
            "id": "D05.08",
            "link": "https://learn.microsoft.com/azure/dns/private-dns-autoregistration",
            "service": "DNS",
            "severity": "高",
            "subcategory": "知識產權計劃",
            "text": "啟用 Azure DNS 的自動註冊，以自動管理虛擬網路中部署的虛擬機的 DNS 記錄的生命週期。",
            "training": "https://learn.microsoft.com/learn/paths/az-104-manage-virtual-networks/",
            "waf": "操作"
        },
        {
            "category": "網路拓撲和連接",
            "guid": "ee1ac551-c4d5-46cf-b035-d0a3c50d87ad",
            "id": "D06.01",
            "link": "https://learn.microsoft.com/azure/bastion/bastion-overview",
            "service": "Bastion",
            "severity": "中等",
            "subcategory": "互聯網",
            "text": "請考慮使用 Azure Bastion 安全地連接到網路。",
            "waf": "安全"
        },
        {
            "category": "網路拓撲和連接",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,subnets=properties.subnets | mv-expand subnets | project id, subnetName = subnets.name, subnetPrefix = subnets.properties.addressPrefix | extend subnetPrefixLength = split(subnetPrefix, '/')[1] | where subnetName == 'AzureBastionSubnet' | extend compliant = (subnetPrefixLength <= 26) | distinct id, compliant",
            "guid": "6eab9eb6-762b-485e-8ea8-15aa5dba0bd0",
            "id": "D06.02",
            "link": "https://learn.microsoft.com/azure/bastion/bastion-faq#subnet",
            "service": "Bastion",
            "severity": "中等",
            "subcategory": "互聯網",
            "text": "在子網 /26 或更大範圍內使用 Azure Bastion。",
            "waf": "安全"
        },
        {
            "category": "網路拓撲和連接",
            "guid": "1d7aa9b6-4704-4489-a804-2d88e79d17b7",
            "id": "D06.03",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/afds-overview",
            "service": "WAF",
            "severity": "中等",
            "subcategory": "互聯網",
            "text": "使用 Azure Front Door 和 WAF 策略跨 Azure 區域為與登陸區域的入站 HTTP/S 連接提供全域保護。",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "安全"
        },
        {
            "category": "網路拓撲和連接",
            "guid": "3b22a5a6-7e7a-48ed-9b30-e38c3f29812b",
            "id": "D06.04",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "service": "WAF",
            "severity": "低",
            "subcategory": "互聯網",
            "text": "使用 Azure Front Door 和 Azure 應用程式閘道幫助保護 HTTP/S 應用時，請使用 Azure Front Door 中的 WAF 策略。鎖定 Azure 應用程式閘道，以便僅接收來自 Azure Front Door 的流量。",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "安全"
        },
        {
            "ammp": true,
            "category": "網路拓撲和連接",
            "guid": "2363cefe-179b-4599-be0d-5973cd4cd21b",
            "id": "D06.05",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "service": "WAF",
            "severity": "高",
            "subcategory": "互聯網",
            "text": "部署 WAF 和其他反向代理是入站 HTTP/S 連接所必需的，將它們部署在登陸區域虛擬網路中，並與它們保護並公開給 Internet 的應用一起部署。",
            "training": "https://learn.microsoft.com/learn/paths/architect-network-infrastructure/",
            "waf": "安全"
        },
        {
            "ammp": true,
            "category": "網路拓撲和連接",
            "guid": "088137f5-e6c4-4cfd-9e50-4547c2447ec6",
            "id": "D06.06",
            "link": "https://learn.microsoft.com/azure/ddos-protection/ddos-protection-reference-architectures",
            "service": "VNet",
            "severity": "高",
            "subcategory": "互聯網",
            "text": "使用 Azure DDoS 網路或 IP 保護計劃來幫助保護虛擬網路中的公共 IP 位址終結點。",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "安全"
        },
        {
            "ammp": true,
            "category": "網路拓撲和連接",
            "guid": "b034c01e-110b-463a-b36e-e3346e57f225",
            "id": "D06.07",
            "link": "https://learn.microsoft.com/en-us/azure/virtual-network/ip-services/default-outbound-access",
            "service": "VNet",
            "severity": "高",
            "subcategory": "互聯網",
            "text": "在即將到來的重大更改之前，評估和審查網路出站流量配置和策略。2025 年 9 月 30 日，新部署的預設出站訪問將停用，僅允許顯式訪問配置",
            "waf": "可靠性"
        },
        {
            "ammp": true,
            "category": "網路拓撲和連接",
            "guid": "b1c82a3f-2320-4dfa-8972-7ae4823c8930",
            "id": "D06.08",
            "link": "https://learn.microsoft.com/azure/ddos-protection/ddos-protection-reference-architectures",
            "service": "VNet",
            "severity": "高",
            "subcategory": "互聯網",
            "text": "添加診斷設置以保存所有受保護的公共IP位址（DDoS IP或網路保護）的 DDoS 相關日誌。",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "安全"
        },
        {
            "ammp": true,
            "category": "網路拓撲和連接",
            "guid": "e6c4cfd3-e504-4547-a244-7ec66138a720",
            "id": "D07.01",
            "link": "https://learn.microsoft.com/azure/app-service/networking-features",
            "service": "Firewall",
            "severity": "高",
            "subcategory": "防火牆",
            "text": "使用 Azure 防火牆管理發往 Internet 的 Azure 出站流量、非 HTTP/S 入站連接和東西向流量篩選（如果組織需要）",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "安全"
        },
        {
            "category": "網路拓撲和連接",
            "guid": "5a4b1511-e43a-458a-ac22-99c4d7b57d0c",
            "id": "D07.02",
            "link": "https://learn.microsoft.com/azure/firewall/",
            "service": "Firewall",
            "severity": "中等",
            "subcategory": "防火牆",
            "text": "創建全域 Azure 防火牆策略以管理全球網路環境中的安全狀況，並將其分配給所有 Azure 防火牆實例。通過 Azure 基於角色的訪問控制將增量防火牆策略委託給本地安全團隊，允許精細策略滿足特定區域的要求。",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "安全"
        },
        {
            "category": "網路拓撲和連接",
            "guid": "655562f2-b3e4-4563-a4d8-739748b662d6",
            "id": "D07.03",
            "link": "https://learn.microsoft.com/azure/firewall/",
            "service": "Firewall",
            "severity": "低",
            "subcategory": "防火牆",
            "text": "如果組織希望使用此類解決方案來幫助保護出站連接，請在 Firewall Manager 中配置受支援的合作夥伴 SaaS 安全提供者。",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "安全"
        },
        {
            "ammp": true,
            "category": "網路拓撲和連接",
            "graph": "resources | where type=='microsoft.network/firewallpolicies' | extend compliant = (properties.dnsSettings.enableProxy == true) | distinct id,compliant",
            "guid": "14d99880-2f88-47e8-a134-62a7d85c94af",
            "id": "D07.04",
            "link": "https://learn.microsoft.com/azure/firewall/fqdn-filtering-network-rules",
            "service": "Firewall",
            "severity": "高",
            "subcategory": "防火牆",
            "text": "使用基於 FQDN 的網路規則和具有 DNS 代理的 Azure 防火牆，通過應用程式規則不支援的協定篩選到 Internet 的出口流量。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "category": "網路拓撲和連接",
            "graph": "resources | where type=='microsoft.network/firewallpolicies' | extend compliant = (properties.sku.tier == 'Premium') | distinct id,compliant",
            "guid": "c10d51ef-f999-455d-bba0-5c90ece07447",
            "id": "D07.05",
            "link": "https://learn.microsoft.com/azure/firewall/premium-features",
            "service": "Firewall",
            "severity": "高",
            "subcategory": "防火牆",
            "text": "使用 Azure 防火牆高級版提供額外的安全性和保護。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "category": "網路拓撲和連接",
            "graph": "resources | where type=='microsoft.network/firewallpolicies' | extend compliant = (properties.threatIntelMode == 'Deny') | distinct id,compliant",
            "guid": "e9c8f584-6d5e-473b-8dc5-acc9fbaab4e3",
            "id": "D07.06",
            "link": "https://learn.microsoft.com/azure/firewall/premium-features",
            "service": "Firewall",
            "severity": "高",
            "subcategory": "防火牆",
            "text": "將 Azure 防火牆威脅情報模式配置為「警報」和「拒絕」，以獲得額外保護。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "category": "網路拓撲和連接",
            "graph": "resources | where type=='microsoft.network/firewallpolicies' | extend compliant = (properties.intrusionDetection.mode == 'Deny') | project id, compliant",
            "guid": "b9d0dff5-bdd4-4cd8-88ed-5811610b2b2c",
            "id": "D07.07",
            "link": "https://learn.microsoft.com/azure/firewall/premium-features#idps",
            "service": "Firewall",
            "severity": "高",
            "subcategory": "防火牆",
            "text": "將 Azure 防火牆 IDPS 模式配置為「拒絕」 ，以獲得額外的保護。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "category": "網路拓撲和連接",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,resourceGroup,name,subnets=properties.subnets | mv-expand subnets | project id,name,subnetId=tostring(subnets.id), subnetName=tostring(subnets.name),subnetRT=subnets.properties.routeTable.id | where not (subnetName in ('GatewaySubnet', 'AzureFirewallSubnet', 'RouteServerSubnet', 'AzureBastionSubnet')) | extend hasRT = isnotnull(subnetRT) | distinct id, hasRT, subnetId | join kind=fullouter (resources | where type == 'microsoft.network/virtualnetworks' | mvexpand properties.virtualNetworkPeerings | extend isVWAN=(tolower(split(properties_virtualNetworkPeerings.name, '_')[0]) == 'remotevnettohubpeering') | mv-expand properties.subnets | project id, isVWAN, name, subnetId=tostring(properties_subnets.id), subnetName=tostring(properties_subnets.name) | summarize PeeredToVWAN=max(isVWAN) by id, subnetId | project id, subnetId, isVWANpeer = (PeeredToVWAN == true)) on subnetId | project id=iff(isnotempty(id), id, id1), subnetId=iff(isnotempty(subnetId), subnetId, subnetId1), hasRT, isVWANpeer | extend compliant = (hasRT==true or isVWANpeer==true) | distinct id, subnetId, compliant",
            "guid": "a3784907-9836-4271-aafc-93535f8ec08b",
            "id": "D07.08",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-networks-udr-overview",
            "service": "Firewall",
            "severity": "高",
            "subcategory": "防火牆",
            "text": "對於未連接到虛擬 WAN 的 VNet 中的子網，請附加路由表，以便將 Internet 流量重定向到 Azure 防火牆或網路虛擬設備",
            "waf": "安全"
        },
        {
            "ammp": true,
            "category": "網路拓撲和連接",
            "guid": "715d833d-4708-4527-90ac-1b142c7045ba",
            "id": "D07.09",
            "link": "https://learn.microsoft.com/en-us/azure/firewall/firewall-structured-logs",
            "service": "Firewall",
            "severity": "中等",
            "subcategory": "防火牆",
            "text": "添加診斷設置，以使用「特定於資源」的目標表保存所有 Azure 防火牆部署的日誌。",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "操作"
        },
        {
            "ammp": true,
            "category": "網路拓撲和連接",
            "guid": "e960fc6b-4ab2-4db6-9609-3745135f9ffa",
            "id": "D07.10",
            "link": "https://learn.microsoft.com/en-us/azure/firewall-manager/migrate-to-policy",
            "service": "Firewall",
            "severity": "重要",
            "subcategory": "防火牆",
            "text": "從 Azure 防火牆經典規則（如果存在）遷移到防火牆策略。",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "操作"
        },
        {
            "ammp": true,
            "category": "網路拓撲和連接",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,subnets=properties.subnets | mv-expand subnets | project id, subnetName = subnets.name, subnetPrefix = subnets.properties.addressPrefix | extend subnetPrefixLength = split(subnetPrefix, '/')[1] | where subnetName == 'AzureFirewallSubnet' | extend compliant = (subnetPrefixLength == 26) | distinct id, compliant",
            "guid": "22d6419e-b627-4d95-9e7d-019fa759387f",
            "id": "D07.11",
            "link": "https://learn.microsoft.com/azure/firewall/firewall-faq#why-does-azure-firewall-need-a--26-subnet-size",
            "service": "Firewall",
            "severity": "高",
            "subcategory": "分割",
            "text": "對 Azure 防火牆子網使用 /26 前置綴。",
            "waf": "安全"
        },
        {
            "category": "網路拓撲和連接",
            "guid": "828cec2e-af6c-40c2-8fa2-1b681ee63eb7",
            "id": "D07.12",
            "link": "https://learn.microsoft.com/en-us/azure/firewall-manager/rule-hierarchy",
            "service": "Firewall",
            "severity": "中等",
            "subcategory": "防火牆",
            "text": "將防火牆策略中的規則排列到規則集合組和規則集合中，並根據它們的使用頻率",
            "waf": "性能"
        },
        {
            "category": "網路拓撲和連接",
            "guid": "0da83bb1-2f39-49af-b5c9-835fc455e3d1",
            "id": "D07.12",
            "link": "https://learn.microsoft.com/en-us/azure/firewall/ip-groups",
            "service": "Firewall",
            "severity": "中等",
            "subcategory": "防火牆",
            "text": "使用IP組或IP前置綴來減少IP表規則的數量",
            "waf": "性能"
        },
        {
            "category": "網路拓撲和連接",
            "guid": "c44c6f0e-1642-4a61-a17b-0922f835c93a",
            "id": "D07.13",
            "link": "https://learn.microsoft.com/en-us/azure/firewall/tutorial-firewall-dnat",
            "service": "Firewall",
            "severity": "中等",
            "subcategory": "防火牆",
            "text": "避免將通配符作為DNATS的源IP，例如*或任何通配符，您應該為傳入的DNAT指定源IP",
            "waf": "性能"
        },
        {
            "category": "網路拓撲和連接",
            "guid": "7371dc21-251a-47a3-af14-6e01b9da4757",
            "id": "D07.14",
            "link": "https://learn.microsoft.com/en-us/azure/nat-gateway/tutorial-hub-spoke-nat-firewall",
            "service": "Firewall",
            "severity": "中等",
            "subcategory": "防火牆",
            "text": "通過監控 SNAT 埠使用方式、評估 NAT 閘道設置和確保無縫故障轉移來防止 SNAT 埠耗盡。如果埠計數接近限制，則表明 SNAT 耗盡可能迫在眉睫。",
            "waf": "性能"
        },
        {
            "category": "網路拓撲和連接",
            "guid": "346840b8-1064-496e-8396-4b1340172d52",
            "id": "D07.15",
            "link": "https://learn.microsoft.com/en-us/azure/firewall/premium-features#tls-inspection",
            "service": "Firewall",
            "severity": "高",
            "subcategory": "防火牆",
            "text": "啟用 TLS 檢查",
            "waf": "性能"
        },
        {
            "category": "網路拓撲和連接",
            "guid": "39990a13-915c-45f9-a2d3-562d7d6c4b7c",
            "id": "D07.16",
            "link": "https://learn.microsoft.com/en-us/azure/firewall/premium-features#web-categories",
            "service": "Firewall",
            "severity": "低",
            "subcategory": "防火牆",
            "text": "使用 Web 類別允許或拒絕對特定主題的出站訪問。",
            "waf": "性能"
        },
        {
            "category": "網路拓撲和連接",
            "guid": "6eff7e6c-6c4a-43d7-be3f-6641c2cb3d4a",
            "id": "D07.17",
            "link": "https://learn.microsoft.com/en-us/azure/architecture/example-scenario/gateway/application-gateway-before-azure-firewall",
            "service": "Firewall",
            "severity": "中等",
            "subcategory": "防火牆",
            "text": "作為 TLS 檢查的一部分，請計劃從 Azure 應用閘道接收流量以進行檢查。",
            "waf": "性能"
        },
        {
            "category": "網路拓撲和連接",
            "guid": "94f3eede-9aa3-4088-92a3-bb9a56509fad",
            "id": "D07.18",
            "link": "https://learn.microsoft.com/en-us/azure/firewall/dns-details",
            "service": "Firewall",
            "severity": "中等",
            "subcategory": "防火牆",
            "text": "啟用 Azure 防火牆 DNS 代理配置",
            "waf": "安全"
        },
        {
            "category": "網路拓撲和連接",
            "guid": "3c5a808d-c695-4c14-a63c-c7ab7a510e41",
            "id": "D07.19",
            "link": "https://github.com/Azure/Enterprise-Scale/wiki/ALZ-Policies#corp",
            "service": "Firewall",
            "severity": "中等",
            "subcategory": "防火牆",
            "text": "確保有策略分配來拒絕直接綁定到虛擬機的公共IP位址",
            "waf": "安全"
        },
        {
            "category": "網路拓撲和連接",
            "guid": "1dc04554-dece-4ffb-a49e-5c683e09f8da",
            "id": "D07.20",
            "link": "https://learn.microsoft.com/en-us/azure/firewall/firewall-diagnostics",
            "service": "Firewall",
            "severity": "低",
            "subcategory": "防火牆",
            "text": "將 Azure 防火牆與 Azure Monitor 集成，並啟用診斷日誌記錄來存儲和分析防火牆日誌。",
            "waf": "監控"
        },
        {
            "category": "網路拓撲和連接",
            "guid": "64e7000e-3c06-485e-b455-ced7f454cba3",
            "id": "D07.21",
            "link": "https://techcommunity.microsoft.com/t5/azure-network-security-blog/runbook-to-manage-azure-firewall-back-ups/ba-p/3066035",
            "service": "Firewall",
            "severity": "低",
            "subcategory": "防火牆",
            "text": "為防火牆規則實施備份",
            "waf": "監控"
        },
        {
            "ammp": true,
            "category": "網路拓撲和連接",
            "guid": "d301d6e8-72e5-42e3-911c-c58b5a4b1511",
            "id": "D07.22",
            "link": "https://learn.microsoft.com/azure/virtual-network/vnet-integration-for-azure-services",
            "service": "App Gateway",
            "severity": "高",
            "subcategory": "PaaS 的",
            "text": "確保注入虛擬網路的 Azure PaaS 服務的控制平面通信不會中斷，例如，使用 0.0.0.0/0 路由或阻止控制平面流量的 NSG 規則。",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/?source=learn",
            "waf": "安全"
        },
        {
            "category": "網路拓撲和連接",
            "guid": "e43a58a9-c229-49c4-b7b5-7d0c655562f2",
            "id": "D08.02",
            "link": "https://learn.microsoft.com/azure/app-service/networking-features",
            "severity": "中等",
            "subcategory": "PaaS 的",
            "text": "將專用連結（如果可用）用於共用的 Azure PaaS 服務。",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "安全"
        },
        {
            "category": "網路拓撲和連接",
            "guid": "b3e4563a-4d87-4397-98b6-62d6d15f512a",
            "id": "D08.03",
            "link": "https://learn.microsoft.com/azure/app-service/networking-features",
            "service": "ExpressRoute",
            "severity": "中等",
            "subcategory": "PaaS 的",
            "text": "通過專用終結點和 ExpressRoute 專用對等互連從本地訪問 Azure PaaS 服務。此方法可避免通過公共 Internet 進行傳輸。",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "安全"
        },
        {
            "category": "網路拓撲和連接",
            "graph": "resources | where type =~ 'microsoft.network/virtualnetworks' | project id,resourceGroup,name,subnets = properties.subnets | mv-expand subnets | project id = subnets.id, resourceGroup, VNet = name, serviceEndpoints = subnets.properties.serviceEndpoints, compliant = (isnull(subnets.properties.serviceEndpoints) or array_length(subnets.properties.serviceEndpoints) == 0) | order by compliant asc",
            "guid": "4704489a-8042-4d88-b79d-17b73b22a5a6",
            "id": "D08.04",
            "link": "https://learn.microsoft.com/azure/app-service/networking-features",
            "service": "VNet",
            "severity": "中等",
            "subcategory": "PaaS 的",
            "text": "默認情況下，不要在所有子網上啟用虛擬網路服務終結點。",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/?source=learn",
            "waf": "安全"
        },
        {
            "category": "網路拓撲和連接",
            "guid": "7e7a8ed4-b30e-438c-9f29-812b2363cefe",
            "id": "D08.05",
            "link": "https://learn.microsoft.com/azure/app-service/networking-features",
            "service": "Firewall",
            "severity": "中等",
            "subcategory": "PaaS 的",
            "text": "使用 FQDN 而不是 Azure 防火牆或 NVA 中的 IP 位址篩選到 Azure PaaS 服務的出口流量，以防止數據外洩。如果使用專用連結，則可以阻止所有 FQDN，否則僅允許所需的 PaaS 服務。",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/?source=learn",
            "waf": "安全"
        },
        {
            "ammp": true,
            "category": "網路拓撲和連接",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,subnets=properties.subnets | mv-expand subnets | project id, subnetName = subnets.name, subnetPrefix = subnets.properties.addressPrefix | extend subnetPrefixLength = split(subnetPrefix, '/')[1] | where subnetName == 'GatewaySubnet' | extend compliant = (subnetPrefixLength <= 27) | distinct id, compliant",
            "guid": "f2aad7e3-bb03-4adc-8606-4123d342a917",
            "id": "D09.01",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-howto-add-gateway-resource-manager#add-a-gateway",
            "service": "ExpressRoute",
            "severity": "高",
            "subcategory": "分割",
            "text": "至少對閘道子網使用 /27 前置綴",
            "waf": "安全"
        },
        {
            "category": "網路拓撲和連接",
            "graph": "resources | where type=='microsoft.network/networksecuritygroups' | mvexpand properties.securityRules | project id,name,ruleAction=properties_securityRules.properties.access,rulePriority=properties_securityRules.properties.priority,ruleDst=properties_securityRules.properties.destinationAddressPrefix,ruleSrc=properties_securityRules.properties.sourceAddressPrefix,ruleProt=properties_securityRules.properties.protocol,ruleDirection=properties_securityRules.properties.direction,rulePort=properties_securityRules.properties.destinationPortRange | summarize StarDenies=countif(ruleAction=='Deny' and ruleDst=='*' and ruleSrc=='*' and ruleProt=='*' and rulePort=='*') by id,tostring(ruleDirection) | where ruleDirection == 'Inbound' | project id,compliant=(StarDenies>0) | union (resources | where type=='microsoft.network/networksecuritygroups' | where array_length(properties.securityRules)==0 | extend compliant=false | project id,compliant)",
            "guid": "11deb39d-8299-4e47-bbe0-0fb5a36318a8",
            "id": "D09.02",
            "link": "https://learn.microsoft.com/azure/virtual-network/service-tags-overview#available-service-tags",
            "service": "NSG",
            "severity": "中等",
            "subcategory": "分割",
            "text": "不要依賴使用 VirtualNetwork 服務標記的 NSG 入站預設規則來限制連接。",
            "waf": "安全"
        },
        {
            "category": "網路拓撲和連接",
            "guid": "c2447ec6-6138-4a72-80f1-ce16ed301d6e",
            "id": "D09.03",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-landing-zone-network-segmentation",
            "severity": "中等",
            "subcategory": "分割",
            "text": "將子網創建委託給登陸區域擁有者。",
            "training": "https://learn.microsoft.com/learn/paths/implement-resource-mgmt-security/",
            "waf": "安全"
        },
        {
            "category": "網路拓撲和連接",
            "guid": "872e52e3-611c-4c58-a5a4-b1511e43a58a",
            "id": "D09.04",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "service": "NSG",
            "severity": "中等",
            "subcategory": "分割",
            "text": "使用 NSG 説明保護跨子網的流量，以及跨平台的東/西流量（登陸區域之間的流量）。",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/",
            "waf": "安全"
        },
        {
            "category": "網路拓撲和連接",
            "graph": "Resources | where type=='microsoft.network/virtualnetworks' | project id,resourceGroup,name,subnets=properties.subnets | mv-expand subnets | project id,name,subnetName=subnets.name,subnetNsg=subnets.properties.networkSecurityGroup | where not (subnetName in ('GatewaySubnet', 'AzureFirewallSubnet', 'RouteServerSubnet', 'AzureBastionSubnet')) | extend compliant = isnotnull(subnetNsg)",
            "guid": "9c2299c4-d7b5-47d0-a655-562f2b3e4563",
            "id": "D09.05",
            "service": "NSG",
            "severity": "中等",
            "subcategory": "分割",
            "text": "應用程式團隊應使用子網級別 NSG 的應用程式安全組來幫助保護登陸區域內的多層 VM。",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/",
            "waf": "安全"
        },
        {
            "category": "網路拓撲和連接",
            "guid": "a4d87397-48b6-462d-9d15-f512a65498f6",
            "id": "D09.06",
            "link": "https://learn.microsoft.com/azure/virtual-network/network-security-group-how-it-works",
            "service": "NSG",
            "severity": "中等",
            "subcategory": "分割",
            "text": "使用 NSG 和應用程式安全組對登陸區域內的流量進行微分段，並避免使用中央 NVA 篩選流量。",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/",
            "waf": "安全"
        },
        {
            "category": "網路拓撲和連接",
            "guid": "dfe237de-143b-416c-91d7-aa9b64704489",
            "id": "D09.07",
            "link": "https://learn.microsoft.com/azure/virtual-network/network-security-group-how-it-works",
            "service": "NSG",
            "severity": "中等",
            "subcategory": "分割",
            "text": "啟用 VNet 流日誌並將其饋送到流量分析中，以深入了解內部和外部流量流。",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-network-monitoring/",
            "waf": "安全"
        },
        {
            "category": "網路拓撲和連接",
            "graph": "resources | where type == 'microsoft.network/networksecuritygroups' | project id, rules = array_length(properties.securityRules) | project id, compliant = (rules < 900)",
            "guid": "0390417d-53dc-44d9-b3f4-c8832f359b41",
            "id": "D09.08",
            "link": "https://learn.microsoft.com/en-us/azure/azure-resource-manager/management/azure-subscription-service-limits",
            "service": "NSG",
            "severity": "中等",
            "subcategory": "分割",
            "text": "考慮每個 NSG 的 NSG 規則限制 （1000）。",
            "training": "https://learn.microsoft.com/en-us/azure/virtual-network/network-security-group-how-it-works",
            "waf": "可靠性"
        },
        {
            "category": "網路拓撲和連接",
            "guid": "412e7f98-3f63-4047-82dd-69c5b5c2622f",
            "id": "D10.01",
            "link": "https://learn.microsoft.com/azure/virtual-wan/scenario-any-to-any",
            "service": "VWAN",
            "severity": "中等",
            "subcategory": "虛擬廣域網",
            "text": "請考慮使用虛擬 WAN 簡化 Azure 網路管理，並確保在虛擬 WAN 路由設計清單中明確描述你的方案",
            "training": "https://learn.microsoft.com/learn/modules/introduction-azure-virtual-wan/",
            "waf": "操作"
        },
        {
            "category": "網路拓撲和連接",
            "guid": "54b69bad-33aa-4d5e-ac68-e1d76667313b",
            "id": "D10.02",
            "link": "https://learn.microsoft.com/azure/virtual-wan/virtual-wan-about",
            "service": "VWAN",
            "severity": "中等",
            "subcategory": "虛擬廣域網",
            "text": "使用每個 Azure 區域的虛擬 WAN 中心，通過通用的全域 Azure 虛擬 WAN 跨 Azure 區域將多個登陸區域連接在一起。",
            "waf": "性能"
        },
        {
            "category": "網路拓撲和連接",
            "guid": "8ac6a9e0-1e6a-483d-b5de-32c199248160",
            "id": "D10.03",
            "link": "https://learn.microsoft.com/azure/virtual-wan/virtual-wan-about",
            "service": "VWAN",
            "severity": "低",
            "subcategory": "虛擬廣域網",
            "text": "遵循“Azure 中的流量保留在 Azure 中”原則，以便通過 Microsoft 主幹網络在 Azure 中跨資源進行通信",
            "waf": "性能"
        },
        {
            "category": "網路拓撲和連接",
            "graph": "resources | where type=='microsoft.network/virtualhubs' | extend compliant = isnotnull(properties.azureFirewall.id) | project id, compliant",
            "guid": "7d5d1e4e-6146-458d-9558-fd77249b8211",
            "id": "D10.04",
            "link": "https://learn.microsoft.com/azure/virtual-wan/virtual-wan-about",
            "service": "VWAN",
            "severity": "中等",
            "subcategory": "虛擬廣域網",
            "text": "對於出站 Internet 流量保護和篩選，請在安全中心部署 Azure 防火牆",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "安全"
        },
        {
            "category": "網路拓撲和連接",
            "guid": "6667313b-4f56-464b-9e98-4a859c773e7d",
            "id": "D10.05",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits",
            "service": "VWAN",
            "severity": "中等",
            "subcategory": "虛擬廣域網",
            "text": "確保網路體系結構在 Azure 虛擬 WAN 限制範圍內。",
            "waf": "可靠性"
        },
        {
            "category": "網路拓撲和連接",
            "guid": "261623a7-65a9-417e-8f34-8ef254c27d42",
            "id": "D10.06",
            "link": "https://learn.microsoft.com/azure/virtual-wan/azure-monitor-insights",
            "service": "VWAN",
            "severity": "中等",
            "subcategory": "虛擬廣域網",
            "text": "使用適用於虛擬 WAN 的 Azure Monitor 見解監視虛擬 WAN 的端到端拓撲、狀態和關鍵指標。",
            "waf": "操作"
        },
        {
            "category": "網路拓撲和連接",
            "guid": "727c77e1-b9aa-4a37-a024-129d042422c1",
            "id": "D10.07",
            "link": "https://learn.microsoft.com/azure/virtual-wan/virtual-wan-faq#is-branch-to-branch-connectivity-allowed-in-virtual-wan",
            "service": "VWAN",
            "severity": "中等",
            "subcategory": "虛擬廣域網",
            "text": "請確保 IaC 部署不會在虛擬 WAN 中禁用分支到分支通信，除非應顯式阻止這些流。",
            "waf": "可靠性"
        },
        {
            "category": "網路拓撲和連接",
            "guid": "d49ac006-6670-4bc9-9948-d3e0a3a94f4d",
            "id": "D10.08",
            "link": "https://learn.microsoft.com/azure/virtual-wan/about-virtual-hub-routing-preference",
            "service": "VWAN",
            "severity": "中等",
            "subcategory": "虛擬廣域網",
            "text": "使用 AS-Path 作為中心路由首選項，因為它比 ExpressRoute 或 VPN 更靈活。",
            "waf": "可靠性"
        },
        {
            "category": "網路拓撲和連接",
            "guid": "2586b854-237e-47f1-84a1-d45d4cd2310d",
            "id": "D10.09",
            "link": "https://learn.microsoft.com/azure/virtual-wan/about-virtual-hub-routing#labels",
            "service": "VWAN",
            "severity": "中等",
            "subcategory": "虛擬廣域網",
            "text": "請確保 IaC 部署在虛擬 WAN 中配置基於標籤的傳播，否則虛擬中心之間的連接將受到損害。",
            "waf": "可靠性"
        },
        {
            "ammp": true,
            "category": "網路拓撲和連接",
            "guid": "9c75dfef-573c-461c-a698-68598595581a",
            "id": "D10.10",
            "link": "https://learn.microsoft.com/azure/virtual-wan/virtual-wan-faq#what-is-the-recommended-hub-address-space-during-hub-creation",
            "service": "VWAN",
            "severity": "高",
            "subcategory": "虛擬廣域網",
            "text": "為虛擬中心分配足夠的IP空間，最好是 /23前置綴。",
            "waf": "可靠性"
        },
        {
            "ammp": true,
            "category": "統轄",
            "guid": "5c986cb2-9131-456a-8247-6e49f541acdc",
            "id": "E01.01",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "service": "Policy",
            "severity": "高",
            "subcategory": "統轄",
            "text": "戰略性地利用 Azure Policy，為環境定義控制，使用策略計劃對相關策略進行分組。",
            "waf": "安全"
        },
        {
            "category": "統轄",
            "guid": "d8a2adb1-17d6-4326-af62-5ca44e5695f2",
            "id": "E01.03",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "service": "Policy",
            "severity": "中等",
            "subcategory": "統轄",
            "text": "將法規和合規性要求映射到 Azure Policy 定義和 Azure 角色分配。",
            "waf": "安全"
        },
        {
            "category": "統轄",
            "guid": "223ace8c-b123-408c-a501-7f154e3ab369",
            "id": "E01.04",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "service": "Policy",
            "severity": "中等",
            "subcategory": "統轄",
            "text": "在中間根管理組建立 Azure Policy 定義，以便可以在繼承的範圍內分配這些定義",
            "waf": "安全"
        },
        {
            "category": "統轄",
            "guid": "3829e7e3-1618-4368-9a04-77a209945bda",
            "id": "E01.05",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "service": "Policy",
            "severity": "中等",
            "subcategory": "統轄",
            "text": "如果需要，在最高適當級別管理策略分配，在最低級別管理排除項。",
            "waf": "安全"
        },
        {
            "category": "統轄",
            "guid": "43334f24-9116-4341-a2ba-527526944008",
            "id": "E01.06",
            "link": "https://learn.microsoft.com/security/benchmark/azure/mcsb-asset-management#am-2-use-only-approved-services",
            "service": "Policy",
            "severity": "低",
            "subcategory": "統轄",
            "text": "使用 Azure Policy 控制使用者可以在訂閱/管理組級別預配哪些服務",
            "waf": "安全"
        },
        {
            "category": "統轄",
            "guid": "be7d7e48-4327-46d8-adc0-55bcf619e8a1",
            "id": "E01.07",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "service": "Policy",
            "severity": "中等",
            "subcategory": "統轄",
            "text": "盡可能使用內置策略，以最大程度地減少操作開銷。",
            "waf": "安全"
        },
        {
            "category": "統轄",
            "description": "通過將「資源策略參與者」角色分配給特定範圍，可以將策略管理委派給相關團隊。例如，中央IT團隊可以監督管理組級別的策略，而應用程式團隊則處理其訂閱的策略，從而在遵守組織標準的情況下實現分散式治理。",
            "guid": "3f988795-25d6-4268-a6d7-0ba6c97be995",
            "id": "E01.08",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview#azure-rbac-permissions-in-azure-policy",
            "service": "Policy",
            "severity": "中等",
            "subcategory": "統轄",
            "text": "在特定範圍內分配內置的「資源策略參與者」角色，以啟用應用程式級治理。",
            "waf": "安全"
        },
        {
            "category": "統轄",
            "guid": "19048384-5c98-46cb-8913-156a12476e49",
            "id": "E01.09",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "service": "Policy",
            "severity": "中等",
            "subcategory": "統轄",
            "text": "限制在根管理組範圍內進行的 Azure Policy 分配數，以避免在繼承範圍內通過排除項進行管理。",
            "waf": "安全"
        },
        {
            "category": "統轄",
            "guid": "5a917e1f-348e-4f25-9c27-d42e8bbac757",
            "id": "E01.10",
            "link": "https://azure.microsoft.com/resources/achieving-compliant-data-residency-and-security-with-azure/",
            "service": "Policy",
            "severity": "中等",
            "subcategory": "統轄",
            "text": "如果存在任何數據主權要求，可以部署 Azure 策略來強制實施這些要求",
            "training": "https://learn.microsoft.com/learn/paths/secure-your-cloud-data/",
            "waf": "安全"
        },
        {
            "category": "統轄",
            "guid": "78b22132-b41c-460b-a4d3-df8f73a67dc2",
            "id": "E01.11",
            "link": "https://github.com/Azure/sovereign-landing-zone/blob/main/docs/scenarios/Sovereignty-Policy-Baseline.md",
            "service": "Policy",
            "severity": "中等",
            "subcategory": "統轄",
            "text": "對於主權登陸區，主權政策基線的政策計劃將在正確的 MG 級別部署和分配。",
            "waf": "安全"
        },
        {
            "category": "統轄",
            "guid": "caeea0e9-1024-41df-a52e-d99c3f22a6f4",
            "id": "E01.12",
            "link": "https://learn.microsoft.com/en-us/industry/sovereignty/policy-portfolio-baseline",
            "service": "Policy",
            "severity": "中等",
            "subcategory": "統轄",
            "text": "對於主權登陸區，記錄了“主權控制目標”到策略映射“。",
            "waf": "安全"
        },
        {
            "category": "統轄",
            "guid": "9b461617-db7b-4399-8ac6-d4eb7153893a",
            "id": "E01.13",
            "service": "Policy",
            "severity": "中等",
            "subcategory": "統轄",
            "text": "對於主權登陸區，CRUD的“主權控制目標到政策映射”的流程已經到位。",
            "waf": "安全"
        },
        {
            "category": "統轄",
            "guid": "29fd366b-a180-452b-9bd7-954b7700c667",
            "id": "E02.02",
            "link": "https://learn.microsoft.com/azure/cost-management-billing/costs/tutorial-acm-create-budgets?bc=%2Fazure%2Fcloud-adoption-framework%2F_bread%2Ftoc.json&toc=%2Fazure%2Fcloud-adoption-framework%2Ftoc.json",
            "severity": "中等",
            "subcategory": "優化雲投資",
            "text": "配置“實際”和“預測”預算警報。",
            "waf": "成本"
        },
        {
            "ammp": true,
            "category": "管理",
            "guid": "89cc5e11-aa4d-4c3b-893d-feb99215266a",
            "id": "F01.01",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#add-diagnostic-settings-to-save-your-wafs-logs",
            "service": "WAF",
            "severity": "高",
            "subcategory": "應用交付",
            "text": "添加診斷設置以保存來自 Azure Front Door 和 Azure 應用程式閘道等應用程式交付服務的 WAF 紀錄。定期查看日誌，以檢查攻擊和誤報檢測。",
            "waf": "操作"
        },
        {
            "category": "管理",
            "guid": "7f408960-c626-44cb-a018-347c8d790cdf",
            "id": "F01.02",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#send-logs-to-microsoft-sentinel",
            "service": "WAF",
            "severity": "中等",
            "subcategory": "應用交付",
            "text": "將 WAF 日誌從應用程式交付服務（如 Azure Front Door 和 Azure 應用程式閘道）發送到 Microsoft Sentinel。檢測攻擊並將 WAF 遙測集成到整個 Azure 環境中。",
            "waf": "操作"
        },
        {
            "category": "管理",
            "guid": "7ea02e1c-7166-45a3-bdf5-098891367fcb",
            "id": "F02.01",
            "link": "https://learn.microsoft.com/azure/reliability/cross-region-replication-azure",
            "severity": "中等",
            "subcategory": "數據保護",
            "text": "考慮在 Azure 中為具有配對區域的 BCDR 進行跨區域複製",
            "waf": "可靠性"
        },
        {
            "category": "管理",
            "guid": "eba8cf22-45c6-4dc1-9b57-2cceb3b97ce5",
            "id": "F02.02",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-redundancy",
            "service": "Backup",
            "severity": "中等",
            "subcategory": "數據保護",
            "text": "使用 Azure 備份時，請考慮不同的備份類型（GRS、ZRS 和 LRS），因為預設設置為 GRS",
            "waf": "可靠性"
        },
        {
            "category": "管理",
            "guid": "67e7a8ed-4b30-4e38-a3f2-9812b2363cef",
            "id": "F03.01",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/design-logs-deployment",
            "service": "Monitor",
            "severity": "中等",
            "subcategory": "監測",
            "text": "使用單個監視器日誌工作區集中管理平臺，但 Azure 基於角色的訪問控制 （Azure RBAC）、數據主權要求或數據保留策略要求使用單獨的工作區的情況除外。",
            "training": "https://learn.microsoft.com/azure/azure-monitor/logs/design-logs-deployment",
            "waf": "操作"
        },
        {
            "category": "管理",
            "guid": "5e6c4cfd-3e50-4454-9c24-47ec66138a72",
            "id": "F03.03",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/data-retention-archive?tabs=portal-1%2Cportal-2#how-retention-and-archiving-work",
            "service": "Monitor",
            "severity": "中等",
            "subcategory": "監測",
            "text": "如果日誌保留要求超過 12 年，請將日誌匯出到 Azure 存儲。將不可變存儲與一次寫入、多次讀取策略結合使用，使數據在使用者指定的時間間隔內不可擦除和不可修改。",
            "training": "https://learn.microsoft.com/learn/paths/architect-infrastructure-operations/",
            "waf": "操作"
        },
        {
            "category": "管理",
            "guid": "e7d7e484-3276-4d8b-bc05-5bcf619e8a13",
            "id": "F03.05",
            "link": "https://learn.microsoft.com/en-us/azure/governance/machine-configuration/overview",
            "service": "VM",
            "severity": "中等",
            "subcategory": "監測",
            "text": "使用 Azure Policy 監視 OS 等級的虛擬機 （VM） 配置偏移。通過策略啟用 Azure Automanage 計算機配置審核功能可幫助應用程式團隊工作負載輕鬆立即使用功能。",
            "training": "https://learn.microsoft.com/learn/paths/implement-resource-mgmt-security/",
            "waf": "操作"
        },
        {
            "category": "管理",
            "guid": "f9887952-5d62-4688-9d70-ba6c97be9951",
            "id": "F03.06",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/management-operational-compliance#update-management-considerations ",
            "service": "VM",
            "severity": "中等",
            "subcategory": "運營合規性",
            "text": "使用 Azure 更新管理員作為 Azure 中 Windows 和 Linux VM 的修補機制。",
            "training": "https://learn.microsoft.com/azure/update-manager/overview?tabs=azure-vms",
            "waf": "操作"
        },
        {
            "category": "管理",
            "guid": "c806c048-26b7-4ddf-b4c2-b4f0c476925d",
            "id": "F03.07",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/management-operational-compliance#update-management-considerations ",
            "service": "VM",
            "severity": "中等",
            "subcategory": "運營合規性",
            "text": "使用 Azure Arc 將 Azure Update Manager 用作 Azure 外部 Windows 和 Linux VM 的修補機制。",
            "training": "https://learn.microsoft.com/azure/update-manager/overview?tabs=azure-vms",
            "waf": "操作"
        },
        {
            "category": "管理",
            "guid": "90483845-c986-4cb2-a131-56a12476e49f",
            "id": "F03.08",
            "link": "https://learn.microsoft.com/azure/network-watcher/network-watcher-monitoring-overview",
            "service": "Network Watcher",
            "severity": "中等",
            "subcategory": "監測",
            "text": "使用網路觀察程序主動監視流量",
            "training": "https://learn.microsoft.com/learn/modules/configure-network-watcher/",
            "waf": "操作"
        },
        {
            "category": "管理",
            "guid": "541acdce-9793-477b-adb3-751ab2ab13ad",
            "id": "F03.09",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/lock-resources?tabs=json",
            "severity": "中等",
            "subcategory": "監測",
            "text": "使用資源鎖防止意外刪除關鍵共享服務。",
            "training": "https://learn.microsoft.com/learn/paths/implement-resource-mgmt-security/",
            "waf": "操作"
        },
        {
            "category": "管理",
            "guid": "a6e55d7d-8a2a-4db1-87d6-326af625ca44",
            "id": "F03.10",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "severity": "低",
            "subcategory": "監測",
            "text": "使用拒絕策略來補充 Azure 角色分配。拒絕策略和 Azure 角色分配的組合可確保適當的防護措施到位，以強制實施誰可以部署和配置資源以及他們可以部署和配置哪些資源。",
            "waf": "操作"
        },
        {
            "category": "管理",
            "guid": "e5695f22-23ac-4e8c-a123-08ca5017f154",
            "id": "F03.11",
            "link": "https://learn.microsoft.com/azure/service-health/alerts-activity-log-service-notifications-portal",
            "severity": "中等",
            "subcategory": "監測",
            "text": "將服務和資源運行狀況事件作為整體平臺監視解決方案的一部分。從平臺角度跟蹤服務和資源運行狀況是 Azure 中資源管理的重要組成部分。",
            "waf": "操作"
        },
        {
            "category": "管理",
            "guid": "d5f345bf-97ab-41a7-819c-6104baa7d48c",
            "id": "F03.12",
            "link": "https://learn.microsoft.com/azure/azure-monitor/alerts/action-groups",
            "severity": "中等",
            "subcategory": "監測",
            "text": "將警報和操作組作為 Azure 服務運行狀況平臺的一部分，以確保可以對警報或問題進行操作",
            "waf": "操作"
        },
        {
            "category": "管理",
            "guid": "e3ab3693-829e-47e3-8618-3687a0477a20",
            "id": "F03.13",
            "link": "https://learn.microsoft.com/azure/sentinel/quickstart-onboard",
            "severity": "中等",
            "subcategory": "監測",
            "text": "不要將原始日誌條目發送回本地監視系統。相反，請採用在 Azure 中生成的數據保留在 Azure 中的原則。如果需要本地 SIEM 集成，請發送關鍵警報而不是日誌。",
            "waf": "操作"
        },
        {
            "category": "管理",
            "guid": "6944008b-e7d7-4e48-9327-6d8bdc055bcf",
            "id": "F03.15",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-setup-guide/monitoring-reporting?tabs=AzureMonitor",
            "service": "Monitor",
            "severity": "中等",
            "subcategory": "監測",
            "text": "使用 Azure Monitor 紀錄獲取見解和報告。",
            "waf": "操作"
        },
        {
            "category": "管理",
            "guid": "619e8a13-f988-4795-85d6-26886d70ba6c",
            "id": "F03.16",
            "link": "https://learn.microsoft.com/azure/azure-monitor/agents/diagnostics-extension-overview",
            "severity": "中等",
            "subcategory": "監測",
            "text": "必要時，請使用登陸區域內的共用存儲帳戶進行 Azure 診斷擴展日誌存儲。",
            "waf": "操作"
        },
        {
            "category": "管理",
            "guid": "97be9951-9048-4384-9c98-6cb2913156a1",
            "id": "F03.17",
            "link": "https://learn.microsoft.com/azure/azure-monitor/alerts/alerts-overview",
            "service": "Monitor",
            "severity": "中等",
            "subcategory": "監測",
            "text": "使用 Azure Monitor 警報生成操作警報。",
            "waf": "操作"
        },
        {
            "category": "管理",
            "guid": "859c3900-4514-41eb-b010-475d695abd74",
            "id": "F03.18",
            "link": "https://learn.microsoft.com/azure/architecture/best-practices/monitoring",
            "severity": "中等",
            "subcategory": "監測",
            "text": "確保已評估監視要求，並應用適當的數據收集和警報配置",
            "waf": "操作"
        },
        {
            "category": "管理",
            "guid": "fed3c55f-a67e-4875-aadd-3aba3f9fde31",
            "id": "F03.19",
            "link": "https://learn.microsoft.com/azure/automation/how-to/region-mappings",
            "service": "Monitor",
            "severity": "中等",
            "subcategory": "監測",
            "text": "通過 Azure 自動化帳戶使用更改和清單跟蹤時，請確保已選擇支援的區域來將 Log Analytics 工作區和自動化帳戶連結在一起。",
            "waf": "操作"
        },
        {
            "category": "管理",
            "guid": "aa45be6a-8f2d-4896-b0e3-775e6e94e610",
            "id": "F03.19",
            "link": "https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/ready/landing-zone/design-area/management-monitor",
            "severity": "中等",
            "subcategory": "監測",
            "text": "為登陸區域的平臺元件建立監視，AMBA 是一種可用的框架解決方案，它提供了一種使用 Azure Policy 縮放警報的簡單方法",
            "training": "https://azure.github.io/azure-monitor-baseline-alerts/patterns/alz/",
            "waf": "操作"
        },
        {
            "category": "管理",
            "guid": "f541acdc-e979-4377-acdb-3751ab2ab13a",
            "id": "F04.01",
            "link": "https://learn.microsoft.com/azure/governance/policy/concepts/guest-configuration",
            "service": "VM",
            "severity": "中等",
            "subcategory": "運營合規性",
            "text": "使用 Azure 策略通過 VM 擴展自動部署軟體配置，並強制實施符合標準的基線 VM 配置。",
            "waf": "安全"
        },
        {
            "category": "管理",
            "description": "Azure Policy 的來賓配置功能可以審核和修正計算機設置（例如，操作系統、應用程式、環境），以確保資源與預期配置一致，更新管理可以對 VM 強制實施修補程式管理。",
            "guid": "da6e55d7-d8a2-4adb-817d-6326af625ca4",
            "id": "F04.02",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/management-operational-compliance#monitoring-for-configuration-drift",
            "service": "VM",
            "severity": "中等",
            "subcategory": "運營合規性",
            "text": "通過 Azure Policy 監視 VM 安全配置偏移。",
            "waf": "安全"
        },
        {
            "category": "管理",
            "guid": "2476e49f-541a-4cdc-b979-377bcdb3751a",
            "id": "F05.01",
            "link": "https://learn.microsoft.com/azure/site-recovery/site-recovery-overview",
            "service": "VM",
            "severity": "中等",
            "subcategory": "保護和恢復",
            "text": "將 Azure Site Recovery 用於 Azure 到 Azure 虛擬機的災難恢復方案。這使您能夠跨區域複製工作負載。",
            "waf": "操作"
        },
        {
            "category": "管理",
            "guid": "b2ab13ad-a6e5-45d7-b8a2-adb117d6326a",
            "id": "F05.02",
            "link": "https://learn.microsoft.com/azure/architecture/framework/resiliency/backup-and-recovery",
            "severity": "中等",
            "subcategory": "保護和恢復",
            "text": "確保使用和測試本機 PaaS 服務容災功能。",
            "waf": "操作"
        },
        {
            "category": "管理",
            "guid": "f625ca44-e569-45f2-823a-ce8cb12308ca",
            "id": "F05.03",
            "link": "https://learn.microsoft.com/azure/backup/backup-center-overview",
            "service": "Backup",
            "severity": "中等",
            "subcategory": "保護和恢復",
            "text": "使用 Azure 本機備份功能或與 Azure 相容的第三方備份解決方案。",
            "waf": "操作"
        },
        {
            "ammp": true,
            "category": "管理",
            "guid": "826c5c45-bb79-4951-a812-e3bfbfd7326b",
            "id": "F06.01",
            "link": "https://learn.microsoft.com/azure/reliability/availability-zones-overview",
            "service": "VM",
            "severity": "高",
            "subcategory": "容錯",
            "text": "在支援可用性區域的區域中對 VM 利用可用性區域。",
            "waf": "可靠性"
        },
        {
            "ammp": true,
            "category": "管理",
            "guid": "7ccb7c06-5511-42df-8177-d97f08d0337d",
            "id": "F06.02",
            "link": "https://learn.microsoft.com/azure/virtual-machines/availability",
            "service": "VM",
            "severity": "高",
            "subcategory": "容錯",
            "text": "避免在單個 VM 上運行生產工作負載。",
            "waf": "可靠性"
        },
        {
            "category": "管理",
            "guid": "84101f59-1941-4195-a270-e28034290e3a",
            "id": "F06.03",
            "link": "https://learn.microsoft.com/azure/load-balancer/load-balancer-overview",
            "service": "VM",
            "severity": "中等",
            "subcategory": "容錯",
            "text": "Azure 負載均衡器和應用程式閘道在多個資源之間分配傳入的網路流量。",
            "waf": "可靠性"
        },
        {
            "category": "安全",
            "guid": "b86ad884-08e3-4727-94b8-75ba18f20459",
            "id": "G01.01",
            "link": "https://learn.microsoft.com/security/benchmark/azure/security-control-incident-response",
            "severity": "中等",
            "subcategory": "存取控制",
            "text": "在允許 Azure 服務投入生產之前，確定 Azure 服務的事件響應計劃。",
            "waf": "安全"
        },
        {
            "category": "安全",
            "guid": "01365d38-e43f-49cc-ad86-8266abca264f",
            "id": "G01.02",
            "link": "https://www.microsoft.com/security/business/zero-trust",
            "severity": "中等",
            "subcategory": "存取控制",
            "text": "在適當的情況下，實施零信任方法來訪問 Azure 平臺。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "category": "安全",
            "guid": "5017f154-e3ab-4369-9829-e7e316183687",
            "id": "G02.01",
            "link": "https://learn.microsoft.com/azure/key-vault/general/overview",
            "service": "Key Vault",
            "severity": "高",
            "subcategory": "加密和金鑰",
            "text": "使用 Azure Key Vault 儲存機密和憑據",
            "waf": "安全"
        },
        {
            "category": "安全",
            "graph": "ResourceContainers | where type=='microsoft.resources/subscriptions'| parse id with '/subscriptions/' SubscriptionID| project subscriptionId, SubscriptionName = name| join kind=leftouter (Resources| where type == 'microsoft.keyvault/vaults'| project id, name, subscriptionId) on subscriptionId| join kind= leftouter (Resources| where type == 'microsoft.keyvault/vaults'| summarize ResourceCount = count() by subscriptionId) on subscriptionId| extend RCount = iff(isnull(ResourceCount), 0, ResourceCount)| project-away ResourceCount| extend compliant = (RCount <> 1)",
            "guid": "a0477a20-9945-4bda-9333-4f2491163418",
            "id": "G02.02",
            "link": "https://learn.microsoft.com/azure/key-vault/general/overview-throttling",
            "service": "Key Vault",
            "severity": "中等",
            "subcategory": "加密和金鑰",
            "text": "對不同的應用程式和區域使用不同的 Azure Key Vault，以避免事務規模限制並限制對機密的訪問。",
            "waf": "安全"
        },
        {
            "category": "安全",
            "guid": "2ba52752-6944-4008-ae7d-7e4843276d8b",
            "id": "G02.03",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "severity": "中等",
            "subcategory": "加密和金鑰",
            "text": "預配啟用軟刪除和清除策略的 Azure Key Vault，以允許對已刪除物件進行保留保護。",
            "waf": "安全"
        },
        {
            "category": "安全",
            "guid": "dc055bcf-619e-48a1-9f98-879525d62688",
            "id": "G02.04",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "severity": "中等",
            "subcategory": "加密和金鑰",
            "text": "通過將永久刪除密鑰、機密和證書的授權限制為專用的自定義 Microsoft Entra ID 角色，遵循最低特權模型。",
            "waf": "安全"
        },
        {
            "category": "安全",
            "guid": "6d70ba6c-97be-4995-8904-83845c986cb2",
            "id": "G02.05",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "severity": "中等",
            "subcategory": "加密和金鑰",
            "text": "使用公共證書頒發機構自動執行證書管理和續訂過程，以簡化管理。",
            "waf": "安全"
        },
        {
            "category": "安全",
            "guid": "913156a1-2476-4e49-b541-acdce979377b",
            "id": "G02.06",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "severity": "中等",
            "subcategory": "加密和金鑰",
            "text": "建立金鑰和證書輪換的自動化流程。",
            "waf": "安全"
        },
        {
            "category": "安全",
            "guid": "cdb3751a-b2ab-413a-ba6e-55d7d8a2adb1",
            "id": "G02.07",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "severity": "中等",
            "subcategory": "加密和金鑰",
            "text": "在保管庫上啟用防火牆和虛擬網路服務終結點或專用終結點，以控制對密鑰保管庫的訪問。",
            "waf": "安全"
        },
        {
            "category": "安全",
            "guid": "17d6326a-f625-4ca4-9e56-95f2223ace8c",
            "id": "G02.08",
            "link": "https://learn.microsoft.com/azure/key-vault/general/monitor-key-vault",
            "service": "Key Vault",
            "severity": "中等",
            "subcategory": "加密和金鑰",
            "text": "使用平臺中心 Azure Monitor Log Analytics 工作區審核每個 Key Vault 實例中的金鑰、證書和機密使用方式。",
            "waf": "安全"
        },
        {
            "category": "安全",
            "guid": "b12308ca-5017-4f15-9e3a-b3693829e7e3",
            "id": "G02.09",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "severity": "中等",
            "subcategory": "加密和金鑰",
            "text": "委託 Key Vault 實例化和特權訪問，並使用 Azure Policy 強制實施一致的合規配置。",
            "waf": "安全"
        },
        {
            "category": "安全",
            "guid": "16183687-a047-47a2-8994-5bda43334f24",
            "id": "G02.10",
            "link": "https://learn.microsoft.com/azure/security/fundamentals/encryption-atrest",
            "severity": "中等",
            "subcategory": "加密和金鑰",
            "text": "對於主體加密功能，預設使用 Microsoft 管理的金鑰，並在需要時使用客戶管理的密鑰。",
            "waf": "安全"
        },
        {
            "category": "安全",
            "guid": "91163418-2ba5-4275-8694-4008be7d7e48",
            "id": "G02.11",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "severity": "中等",
            "subcategory": "加密和金鑰",
            "text": "對每個應用程式、每個環境、每個區域使用 Azure Key Vault。",
            "waf": "安全"
        },
        {
            "category": "安全",
            "guid": "25d62688-6d70-4ba6-a97b-e99519048384",
            "id": "G02.12",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "severity": "中等",
            "subcategory": "加密和金鑰",
            "text": "如果要自帶密鑰，則並非所有考慮的服務都支援此功能。實施相關的緩解措施，以免不一致阻礙預期結果。選擇適當的區域對和災難恢復區域，以最大程度地減少延遲。",
            "waf": "安全"
        },
        {
            "category": "安全",
            "guid": "4ac6b67c-b3a4-4ff9-8e87-b07a7ce7bbdb",
            "id": "G02.13",
            "link": "https://learn.microsoft.com/en-us/industry/sovereignty/key-management",
            "service": "Key Vault",
            "severity": "中等",
            "subcategory": "加密和金鑰",
            "text": "對於主權登陸區域，請使用 Azure Key Vault 託管的 HSM 來儲存機密和憑據。",
            "waf": "安全"
        },
        {
            "category": "安全",
            "guid": "4e5695f2-223a-4ce8-ab12-308ca5017f15",
            "id": "G03.01",
            "link": "https://learn.microsoft.com/azure/active-directory/reports-monitoring/overview-reports",
            "service": "Entra",
            "severity": "中等",
            "subcategory": "操作",
            "text": "使用 Microsoft Entra ID 報告功能生成訪問控制審核報告。",
            "waf": "安全"
        },
        {
            "category": "安全",
            "guid": "4e3ab369-3829-4e7e-9161-83687a0477a2",
            "id": "G03.02",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/logs-data-export?tabs=portal",
            "severity": "中等",
            "subcategory": "操作",
            "text": "將 Azure 活動日誌匯出到 Azure Monitor 紀錄，以便長期保留數據。如有必要，導出到 Azure 存儲，以獲得超過兩年的長期存儲。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "category": "安全",
            "guid": "09945bda-4333-44f2-9911-634182ba5275",
            "id": "G03.03",
            "link": "https://learn.microsoft.com/azure/defender-for-cloud/concept-cloud-security-posture-management",
            "service": "Defender",
            "severity": "高",
            "subcategory": "操作",
            "text": "為所有訂閱啟用Defender雲安全態勢管理。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "category": "安全",
            "guid": "36a72a48-fffe-4c40-9747-0ab5064355ba",
            "id": "G03.04",
            "link": "https://learn.microsoft.com/azure/defender-for-cloud/plan-defender-for-servers-select-plan",
            "service": "Defender",
            "severity": "高",
            "subcategory": "操作",
            "text": "在所有訂閱上為伺服器啟用Defender雲工作負載保護計劃。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "category": "安全",
            "guid": "77425f48-ecba-43a0-aeac-a3ac733ccc6a",
            "id": "G03.05",
            "link": "https://www.microsoft.com/en-gb/security/business/solutions/cloud-workload-protection",
            "service": "Defender",
            "severity": "高",
            "subcategory": "操作",
            "text": "在所有訂閱上為 Azure 資源啟用 Defender 雲工作負載保護計劃。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "category": "安全",
            "guid": "24d96b30-61ee-4436-a1cc-d6ef08bc574b",
            "id": "G03.06",
            "link": "https://learn.microsoft.com/mem/configmgr/protect/deploy-use/endpoint-protection",
            "service": "VM",
            "severity": "高",
            "subcategory": "操作",
            "text": "在 IaaS 伺服器上啟用 Endpoint Protection。",
            "waf": "安全"
        },
        {
            "category": "安全",
            "guid": "15833ee7-ad6c-46d3-9331-65c7acbe44ab",
            "id": "G03.07",
            "link": "https://learn.microsoft.com/azure/security-center/",
            "service": "VM",
            "severity": "中等",
            "subcategory": "操作",
            "text": "通過 Azure Monitor 紀錄和 Defender for Cloud 監視基本作業系統修補偏移。",
            "waf": "安全"
        },
        {
            "category": "安全",
            "guid": "e5f8d79f-2e87-4768-924c-516775c6ea95",
            "id": "G03.08",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/design-logs-deployment",
            "service": "Monitor",
            "severity": "中等",
            "subcategory": "操作",
            "text": "將預設資源配置連接到集中式 Azure Monitor Log Analytics 工作區。",
            "waf": "安全"
        },
        {
            "category": "安全",
            "guid": "1761e147-f65e-4d09-bbc2-f464f23e2eba",
            "id": "G03.09",
            "link": "https://learn.microsoft.com/en-us/industry/sovereignty/transparency-logs",
            "service": "Entra",
            "severity": "中等",
            "subcategory": "操作",
            "text": "對於主權登陸區域，在 Entra ID 租戶上啟用透明日誌。",
            "waf": "安全"
        },
        {
            "category": "安全",
            "guid": "d21a922d-5ca7-427a-82a6-35f7b21f1bfc",
            "id": "G03.10",
            "link": "https://learn.microsoft.com/en-us/azure/security/fundamentals/customer-lockbox-overview",
            "service": "Entra",
            "severity": "中等",
            "subcategory": "操作",
            "text": "對於 Sovereign Landing Zone，在 Entra ID 租戶上啟用了客戶密碼箱。",
            "waf": "安全"
        },
        {
            "category": "安全",
            "guid": "874a748b-662d-46d1-9051-2a66498f6dfe",
            "id": "G03.11",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/security",
            "severity": "低",
            "subcategory": "操作",
            "text": "使用基於 Azure 事件網格的解決方案獲取面向日誌的即時警報",
            "waf": "安全"
        },
        {
            "ammp": true,
            "category": "安全",
            "guid": "b03ed428-4617-4067-a787-85468b9ccf3f",
            "id": "G04.01",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-require-secure-transfer",
            "service": "Storage",
            "severity": "高",
            "subcategory": "概述",
            "text": "應啟用安全傳輸到存儲帳戶",
            "waf": "安全"
        },
        {
            "ammp": true,
            "category": "安全",
            "guid": "159aac9f-863f-4f48-82cf-00c28fa97a0e",
            "id": "G04.02",
            "link": "https://learn.microsoft.com/azure/storage/blobs/data-protection-overview#recommendations-for-basic-data-protection",
            "service": "Storage",
            "severity": "高",
            "subcategory": "概述",
            "text": "為存儲帳戶啟用容器軟刪除，以恢復已刪除的容器及其內容。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "category": "安全",
            "guid": "6f704104-85c1-441f-96d3-c9819911645e",
            "id": "G05.01",
            "link": "https://learn.microsoft.com/azure/active-directory/roles/security-planning",
            "severity": "高",
            "subcategory": "安全特權訪問",
            "text": "為 Azure 管理任務單獨設置特權管理員帳戶。",
            "waf": "安全"
        },
        {
            "category": "安全",
            "guid": "9a19bf39-c95d-444c-9c89-19ca1f6d5215",
            "id": "G06.01",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/service-enablement-framework",
            "severity": "中等",
            "subcategory": "服務支援框架",
            "text": "規劃如何實現新的 Azure 服務",
            "waf": "安全"
        },
        {
            "category": "安全",
            "guid": "ae514b93-3d45-485e-8112-9bd7ba012f7b",
            "id": "G06.02",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/service-enablement-framework",
            "severity": "中等",
            "subcategory": "服務支援框架",
            "text": "規劃如何滿足 Azure 服務的服務請求",
            "waf": "安全"
        },
        {
            "ammp": true,
            "category": "平臺自動化和DevOps",
            "guid": "e85f4226-bf06-4e35-8a8b-7aee4d2d633a",
            "id": "H01.01",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/platform-automation-devops",
            "severity": "高",
            "subcategory": "DevOps 團隊拓撲",
            "text": "確保你有一個跨職能的DevOps平臺團隊來構建、管理和維護 Azure 登陸區域體系結構。",
            "waf": "操作"
        },
        {
            "category": "平臺自動化和DevOps",
            "guid": "634146bf-7085-4419-a7b5-f96d2726f6da",
            "id": "H01.02",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/devops-teams-topologies#design-recommendations",
            "severity": "低",
            "subcategory": "DevOps 團隊拓撲",
            "text": "旨在為 Azure 登陸區域平台團隊定義函數。",
            "waf": "操作"
        },
        {
            "category": "平臺自動化和DevOps",
            "guid": "a9e65070-c59e-4112-8bf6-c11364d4a2a5",
            "id": "H01.03",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/devops-teams-topologies#design-recommendations",
            "severity": "低",
            "subcategory": "DevOps 團隊拓撲",
            "text": "旨在為應用程式工作負載團隊定義功能，使其自給自足，並且不需要 DevOps 平台團隊支援。通過使用自定義 RBAC 角色來實現此目的。",
            "waf": "操作"
        },
        {
            "ammp": true,
            "category": "平臺自動化和DevOps",
            "guid": "165eb5e9-b434-448a-9e24-178632186212",
            "id": "H01.04",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/infrastructure-as-code",
            "severity": "高",
            "subcategory": "DevOps 團隊拓撲",
            "text": "使用 CI/CD 管道部署 IaC 專案，並確保部署和 Azure 環境的品質。",
            "waf": "操作"
        },
        {
            "category": "平臺自動化和DevOps",
            "guid": "0cadb8c7-8fa5-4fbf-8f39-d1fadb3b0460",
            "id": "H01.05",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/development-strategy-development-lifecycle#automated-builds",
            "severity": "中等",
            "subcategory": "DevOps 團隊拓撲",
            "text": "在生成過程中包括 IaC 和應用程式代碼的單元測試。",
            "waf": "操作"
        },
        {
            "ammp": true,
            "category": "平臺自動化和DevOps",
            "guid": "108d5099-a11d-4445-bd8b-e12a5e95412e",
            "id": "H01.06",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/development-strategy-development-lifecycle#automated-builds",
            "service": "Key Vault",
            "severity": "高",
            "subcategory": "DevOps 團隊拓撲",
            "text": "使用 Key Vault 機密可避免對敏感資訊（如憑據（虛擬機器用戶密碼）、證書或密鑰）進行硬編碼。",
            "waf": "操作"
        },
        {
            "category": "平臺自動化和DevOps",
            "guid": "a52e0c98-76b9-4a09-a1c9-6b2babf22ac4",
            "id": "H01.07",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/subscription-vending",
            "severity": "低",
            "subcategory": "DevOps 團隊拓撲",
            "text": "通過訂閱自動售貨為應用程式和工作負載的新登陸區域實現自動化",
            "waf": "操作"
        },
        {
            "ammp": true,
            "category": "平臺自動化和DevOps",
            "guid": "cfe363b5-f579-4284-bc56-a42153e4c10b",
            "id": "H02.01",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/infrastructure-as-code",
            "severity": "高",
            "subcategory": "開發生命週期",
            "text": "確保版本控制系統用於應用程式的原始程式碼和開發的 IaC。Microsoft 推薦 Git。",
            "waf": "操作"
        },
        {
            "category": "平臺自動化和DevOps",
            "guid": "c7245dd4-af8a-403a-8bb7-890c1a7cfa9d",
            "id": "H02.02",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/development-strategy-development-lifecycle",
            "severity": "低",
            "subcategory": "開發生命週期",
            "text": "遵循分支策略，使團隊能夠更好地協作，並有效地管理 IaC 和應用程式代碼的版本控制。查看 Github Flow 等選項。",
            "waf": "操作"
        },
        {
            "category": "平臺自動化和DevOps",
            "guid": "12aeea20-9165-4b3e-bdf2-6795fcd3cdbe",
            "id": "H02.03",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/development-strategy-development-lifecycle",
            "severity": "中等",
            "subcategory": "開發生命週期",
            "text": "採用拉取請求策略來説明控制合併到分支中的代碼更改。",
            "waf": "操作"
        },
        {
            "category": "平臺自動化和DevOps",
            "guid": "2676ae46-65ca-444e-8695-fdddeace4cb1",
            "id": "H02.04",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/management-platform",
            "severity": "中等",
            "subcategory": "開發生命週期",
            "text": "建立使用代碼實現快速修復的流程。始終在團隊的待辦事項中註冊快速修復，以便以後可以重新設計每個修復程式，並且可以限制技術債務。",
            "waf": "操作"
        },
        {
            "ammp": true,
            "category": "平臺自動化和DevOps",
            "guid": "2cdc9d99-dbcc-4ad4-97f5-e7d358bdfa73",
            "id": "H03.01",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/infrastructure-as-code",
            "severity": "高",
            "subcategory": "發展戰略",
            "text": "利用聲明性基礎結構即代碼工具（如 Azure Bicep、ARM 範本或 Terraform）來構建和維護 Azure 登陸區域體系結構。從平臺和應用程式工作負載的角度來看。",
            "waf": "操作"
        },
        {
            "ammp": true,
            "category": "平臺自動化和DevOps",
            "guid": "cc87a3bc-c572-4ad2-92ed-8cabab66160f",
            "id": "H04.01",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/landing-zone-security#secure",
            "severity": "高",
            "subcategory": "安全",
            "text": "將安全性集成到 DevOps 中已經合併的開發和運營流程中，以降低創新流程中的風險。",
            "waf": "操作"
        }
    ],
    "metadata": {
        "name": "Azure Landing Zone Review",
        "state": "GA",
        "timestamp": "April 03, 2024",
        "waf": "all"
    },
    "severities": [
        {
            "name": "高"
        },
        {
            "name": "中等"
        },
        {
            "name": "低"
        }
    ],
    "status": [
        {
            "description": "此檢查尚未查看",
            "name": "未驗證"
        },
        {
            "description": "有一個與此檢查關聯的操作項",
            "name": "打開"
        },
        {
            "description": "此檢查已通過驗證，並且沒有與之關聯的進一步操作項",
            "name": "實現"
        },
        {
            "description": "建議已理解，但當前需求不需要",
            "name": "不需要"
        },
        {
            "description": "不適用於當前設計",
            "name": "不適用"
        }
    ],
    "waf": [
        {
            "name": "可靠性"
        },
        {
            "name": "安全"
        },
        {
            "name": "成本"
        },
        {
            "name": "操作"
        },
        {
            "name": "性能"
        }
    ],
    "yesno": [
        {
            "name": "是的"
        },
        {
            "name": "不"
        }
    ]
}
{
    "categories": [
        {
            "name": "Locatário do Azure e do Active Directory"
        },
        {
            "name": "Gerenciamento de identidades e acesso"
        },
        {
            "name": "Topologia de rede e conectividade"
        },
        {
            "name": "Segurança"
        },
        {
            "name": "Gestão"
        },
        {
            "name": "Organização de Recursos"
        },
        {
            "name": "Automação de Plataforma e DevOps"
        },
        {
            "name": "Governança"
        }
    ],
    "items": [
        {
            "category": "Locatário do Azure e do Active Directory",
            "guid": "70c15989-c726-42c7-b0d3-24b7375b9201",
            "id": "A01.01",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/multi-tenant/considerations-recommendations",
            "severity": "Média",
            "subcategory": "Locatários do Azure AD",
            "text": "Use um locatário do Entra para gerenciar seus recursos do Azure, a menos que você tenha um requisito regulamentar ou comercial claro para multilocatários.",
            "waf": "Operações"
        },
        {
            "category": "Locatário do Azure e do Active Directory",
            "guid": "6309957b-821a-43d1-b9d9-7fcf1802b747",
            "id": "A01.02",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/multi-tenant/automation",
            "severity": "Baixo",
            "subcategory": "Locatários do Azure AD",
            "text": "Verifique se você tem uma abordagem de Automação Multilocatário para gerenciar seus Locatários do Azure AD",
            "waf": "Operações"
        },
        {
            "category": "Locatário do Azure e do Active Directory",
            "guid": "78e11934-499a-45ed-8ef7-aae5578f0ecf",
            "id": "A01.03",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/multi-tenant/lighthouse",
            "severity": "Baixo",
            "subcategory": "Locatários do Azure AD",
            "text": "Aproveite o Farol do Azure para gerenciamento multilocatário",
            "waf": "Operações"
        },
        {
            "category": "Locatário do Azure e do Active Directory",
            "guid": "5d82e6df-6f61-42f2-82e2-3132d293be3d",
            "id": "A02.01",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-microsoft-customer-agreement#design-recommendations",
            "severity": "Média",
            "subcategory": "Provedor de Soluções na Nuvem",
            "text": "Verifique se o Farol do Azure é usado para administrar o locatário por parceiro",
            "waf": "Custar"
        },
        {
            "category": "Locatário do Azure e do Active Directory",
            "guid": "a24d0de3-d4b9-4dfb-8ddd-bbfaf123fa01",
            "id": "A02.02",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-microsoft-customer-agreement#design-recommendations",
            "severity": "Baixo",
            "subcategory": "Provedor de Soluções na Nuvem",
            "text": "Discutir a solicitação de suporte e o processo de escalonamento com o parceiro CSP",
            "waf": "Custar"
        },
        {
            "category": "Locatário do Azure e do Active Directory",
            "guid": "32952499-58c8-4e6f-ada5-972e67893d55",
            "id": "A02.03",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-microsoft-customer-agreement#design-recommendations",
            "severity": "Média",
            "subcategory": "Provedor de Soluções na Nuvem",
            "text": "Configurar relatórios de custos e exibições com o Gerenciamento de Custos do Azure",
            "waf": "Custar"
        },
        {
            "category": "Locatário do Azure e do Active Directory",
            "guid": "685cb4f2-ac9c-4b19-9167-993ed0b32415",
            "id": "A03.01",
            "link": "https://learn.microsoft.com/azure/cost-management-billing/manage/direct-ea-administration#manage-notification-contacts",
            "severity": "Média",
            "subcategory": "Acordo de Empresa",
            "text": "Configurar contatos de notificação para uma caixa de correio de grupo",
            "waf": "Custar"
        },
        {
            "category": "Locatário do Azure e do Active Directory",
            "guid": "12cd499f-96e2-4e41-a243-231fb3245a1c",
            "id": "A03.02",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-enterprise-agreement#design-considerations",
            "severity": "Baixo",
            "subcategory": "Acordo de Empresa",
            "text": "Usar departamentos e contas para mapear a estrutura da sua organização para a hierarquia de inscrição pode ajudar na separação do faturamento.",
            "waf": "Custar"
        },
        {
            "ammp": true,
            "category": "Locatário do Azure e do Active Directory",
            "guid": "29213165-f066-46c4-81fc-4214cc19f3d0",
            "id": "A03.03",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-enterprise-agreement#design-considerations",
            "severity": "Alto",
            "subcategory": "Acordo de Empresa",
            "text": "Verifique se as Contas estão configuradas para serem do tipo 'Conta corporativa e de estudante'",
            "waf": "Segurança"
        },
        {
            "category": "Locatário do Azure e do Active Directory",
            "guid": "ca0fe401-12ad-46fc-8a7e-86293866a9f6",
            "id": "A03.04",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-enterprise-agreement#design-considerations",
            "severity": "Média",
            "subcategory": "Acordo de Empresa",
            "text": "Habilite os Encargos de Exibição de DA e os Encargos de Exibição de AO em suas Inscrições EA para permitir que os usuários com os dados de Custo e Faturamento de revisão de perms corretos.",
            "waf": "Segurança"
        },
        {
            "category": "Locatário do Azure e do Active Directory",
            "guid": "5cf9f485-2784-49b3-9824-75d9b8bdb57b",
            "id": "A03.05",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-enterprise-agreement#design-considerations",
            "severity": "Baixo",
            "subcategory": "Acordo de Empresa",
            "text": "Faça uso de assinaturas corporativas de desenvolvimento/teste para reduzir os custos de cargas de trabalho que não são de produção",
            "waf": "Custar"
        },
        {
            "category": "Locatário do Azure e do Active Directory",
            "guid": "2cf08656-13ea-4f7e-a53a-e2c956b1ff6c",
            "id": "A03.06",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-enterprise-agreement#design-considerations",
            "severity": "Média",
            "subcategory": "Acordo de Empresa",
            "text": "Auditar periodicamente as atribuições de função para revisar quem tem acesso ao seu Registro no Enterprise Agreement",
            "waf": "Custar"
        },
        {
            "category": "Locatário do Azure e do Active Directory",
            "guid": "6ad5c3dd-e5ea-4ff1-81a4-7886ff87845c",
            "id": "A04.01",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-microsoft-customer-agreement#design-recommendations",
            "severity": "Baixo",
            "subcategory": "Contrato de Nuvem da Microsoft",
            "text": "Configurar email de contato de notificação de conta de faturamento do contrato",
            "waf": "Custar"
        },
        {
            "category": "Locatário do Azure e do Active Directory",
            "guid": "90e87802-602f-4dfb-acea-67c60689f1d7",
            "id": "A04.02",
            "link": "https://learn.microsoft.com/azure/cost-management-billing/manage/mca-section-invoice",
            "severity": "Baixo",
            "subcategory": "Contrato de Nuvem da Microsoft",
            "text": "Use as seções Perfis de faturamento e Fatura para estruturar o faturamento de seus contratos para um gerenciamento de custos eficaz",
            "waf": "Custar"
        },
        {
            "category": "Locatário do Azure e do Active Directory",
            "guid": "e81a73f0-84c4-4641-b406-14db3b4d1f50",
            "id": "A04.03",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-microsoft-customer-agreement#design-recommendations",
            "severity": "Baixo",
            "subcategory": "Contrato de Nuvem da Microsoft",
            "text": "Fazer uso do Plano do Azure para reduzir custos para cargas de trabalho que não são de produção",
            "waf": "Custar"
        },
        {
            "category": "Locatário do Azure e do Active Directory",
            "guid": "ae757485-92a4-482a-8bc9-eefe6f5b5ec3",
            "id": "A04.04",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-microsoft-customer-agreement#design-recommendations",
            "severity": "Média",
            "subcategory": "Contrato de Nuvem da Microsoft",
            "text": "Audite periodicamente as atribuições de função RBAC de faturamento do contrato para analisar quem tem acesso à sua conta de faturamento MCA",
            "waf": "Custar"
        },
        {
            "ammp": true,
            "category": "Governança",
            "guid": "5c986cb2-9131-456a-8247-6e49f541acdc",
            "id": "B01.01",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "severity": "Alto",
            "subcategory": "Governança",
            "text": "Aproveite a Política do Azure estrategicamente, defina controles para seu ambiente, usando Iniciativas de Política para agrupar políticas relacionadas.",
            "waf": "Segurança"
        },
        {
            "category": "Governança",
            "guid": "e979377b-cdb3-4751-ab2a-b13ada6e55d7",
            "id": "B01.02",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/naming-and-tagging",
            "severity": "Média",
            "subcategory": "Governança",
            "text": "Identifique as marcas necessárias do Azure e use o modo de política 'anexar' para impor o uso.",
            "waf": "Segurança"
        },
        {
            "category": "Governança",
            "guid": "d8a2adb1-17d6-4326-af62-5ca44e5695f2",
            "id": "B01.03",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "severity": "Média",
            "subcategory": "Governança",
            "text": "Mapeie os requisitos normativos e de conformidade para definições de Política do Azure e atribuições de função do Azure.",
            "waf": "Segurança"
        },
        {
            "category": "Governança",
            "guid": "223ace8c-b123-408c-a501-7f154e3ab369",
            "id": "B01.04",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "severity": "Média",
            "subcategory": "Governança",
            "text": "Estabelecer definições de Política do Azure no grupo de gerenciamento raiz de nível superior para que possam ser atribuídas em escopos herdados",
            "waf": "Segurança"
        },
        {
            "category": "Governança",
            "guid": "3829e7e3-1618-4368-9a04-77a209945bda",
            "id": "B01.05",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "severity": "Média",
            "subcategory": "Governança",
            "text": "Gerencie atribuições de política no nível mais alto apropriado com exclusões nos níveis inferiores, se necessário.",
            "waf": "Segurança"
        },
        {
            "category": "Governança",
            "guid": "43334f24-9116-4341-a2ba-527526944008",
            "id": "B01.06",
            "link": "https://learn.microsoft.com/security/benchmark/azure/mcsb-asset-management#am-2-use-only-approved-services",
            "severity": "Baixo",
            "subcategory": "Governança",
            "text": "Usar a Política do Azure para controlar quais serviços os usuários podem provisionar no nível do grupo de assinatura/gerenciamento",
            "waf": "Segurança"
        },
        {
            "category": "Governança",
            "guid": "be7d7e48-4327-46d8-adc0-55bcf619e8a1",
            "id": "B01.07",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "severity": "Média",
            "subcategory": "Governança",
            "text": "Use políticas internas sempre que possível para minimizar a sobrecarga operacional.",
            "waf": "Segurança"
        },
        {
            "category": "Governança",
            "description": "A atribuição da função Colaborador de Política de Recursos a escopos específicos permite delegar o gerenciamento de políticas a equipes relevantes. Por exemplo, uma equipe central de TI pode supervisionar políticas de nível de grupo de gerenciamento, enquanto as equipes de aplicativos lidam com políticas para suas assinaturas, permitindo a governança distribuída com aderência aos padrões organizacionais.",
            "guid": "3f988795-25d6-4268-a6d7-0ba6c97be995",
            "id": "B01.08",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview#azure-rbac-permissions-in-azure-policy",
            "severity": "Média",
            "subcategory": "Governança",
            "text": "Atribua a função interna de Colaborador de Política de Recursos em um escopo específico para habilitar a governança em nível de aplicativo.",
            "waf": "Segurança"
        },
        {
            "category": "Governança",
            "guid": "19048384-5c98-46cb-8913-156a12476e49",
            "id": "B01.09",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "severity": "Média",
            "subcategory": "Governança",
            "text": "Limite o número de atribuições da Política do Azure feitas no escopo do grupo de gerenciamento raiz para evitar o gerenciamento por meio de exclusões em escopos herdados.",
            "waf": "Segurança"
        },
        {
            "category": "Governança",
            "guid": "9b5e2a28-9823-4faf-ab7e-afa5f6c57221",
            "id": "B02.01",
            "link": "https://learn.microsoft.com/azure/automation/automation-solution-vm-management-config",
            "severity": "Baixo",
            "subcategory": "Otimize seu investimento em nuvem",
            "text": "Considere o uso de tags de automação para iniciar/parar VMs em seu ambiente para economizar custos.",
            "waf": "Segurança"
        },
        {
            "category": "Governança",
            "guid": "29fd366b-a180-452b-9bd7-954b7700c667",
            "id": "B02.02",
            "link": "https://learn.microsoft.com/azure/cost-management-billing/costs/tutorial-acm-create-budgets?bc=%2Fazure%2Fcloud-adoption-framework%2F_bread%2Ftoc.json&toc=%2Fazure%2Fcloud-adoption-framework%2Ftoc.json",
            "severity": "Média",
            "subcategory": "Otimize seu investimento em nuvem",
            "text": "Configure alertas de orçamento 'Real' e 'Previsto'.",
            "waf": "Custar"
        },
        {
            "ammp": true,
            "category": "Gerenciamento de identidades e acesso",
            "guid": "4348bf81-7573-4512-8f46-9061cc198fea",
            "id": "C01.01",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/identity-access-landing-zones#identity-and-access-management-in-the-azure-landing-zone-accelerator",
            "severity": "Alto",
            "subcategory": "Active Directory e identidade híbrida",
            "text": "Usar identidades gerenciadas em vez de entidades de serviço para autenticação nos serviços do Azure",
            "training": "https://learn.microsoft.com/azure/active-directory/managed-identities-azure-resources/overview",
            "waf": "Segurança"
        },
        {
            "category": "Gerenciamento de identidades e acesso",
            "guid": "cd163e39-84a5-4b39-97b7-6973abd70d94",
            "id": "C02.01",
            "link": "https://learn.microsoft.com/azure/active-directory/hybrid/how-to-connect-sync-staging-server",
            "severity": "Média",
            "subcategory": "Azure AD",
            "text": "Ao implantar uma VM do AD Connect, considere ter um servidor de preparo para alta disponibilidade/recuperação de desastres",
            "waf": "Fiabilidade"
        },
        {
            "ammp": true,
            "category": "Gerenciamento de identidades e acesso",
            "guid": "984a859c-773e-47d2-9162-3a765a917e1f",
            "id": "C03.01",
            "link": "https://learn.microsoft.com/azure/active-directory/roles/security-emergency-access",
            "severity": "Alto",
            "subcategory": "Identidade",
            "text": "Implementar um acesso de emergência ou contas de quebra-vidro para evitar o bloqueio de contas em todo o locatário",
            "training": "https://learn.microsoft.com/learn/modules/azure-ad-privileged-identity-management/",
            "waf": "Segurança"
        },
        {
            "category": "Gerenciamento de identidades e acesso",
            "guid": "1cf0b8da-70bd-44d0-94af-8d99cfc89ae1",
            "id": "C03.02",
            "link": "https://learn.microsoft.com/azure/active-directory/reports-monitoring/concept-activity-logs-azure-monitor",
            "severity": "Média",
            "subcategory": "Identidade",
            "text": "Integre os logs do Azure AD com o Azure Monitor central de plataforma. O Azure Monitor permite uma única fonte de verdade sobre dados de log e monitoramento no Azure, oferecendo às organizações opções nativas de nuvem para atender aos requisitos de coleta e retenção de logs.",
            "waf": "Segurança"
        },
        {
            "ammp": true,
            "category": "Gerenciamento de identidades e acesso",
            "guid": "348ef254-c27d-442e-abba-c7571559ab91",
            "id": "C03.03",
            "link": "https://learn.microsoft.com/azure/role-based-access-control/overview",
            "severity": "Alto",
            "subcategory": "Identidade",
            "text": "Aplique um modelo RBAC que se alinhe ao seu modelo operacional de nuvem. Escopo e atribuição entre grupos de gerenciamento e assinaturas.",
            "training": "https://learn.microsoft.com/learn/paths/implement-resource-mgmt-security/",
            "waf": "Segurança"
        },
        {
            "category": "Gerenciamento de identidades e acesso",
            "guid": "53e8908a-e28c-484c-93b6-b7808b9fe5c4",
            "id": "C03.04",
            "link": "https://learn.microsoft.com/azure/active-directory/conditional-access/overview",
            "severity": "Baixo",
            "subcategory": "Identidade",
            "text": "Impor políticas de acesso condicional do Azure AD para qualquer usuário com direitos a ambientes do Azure",
            "training": "https://learn.microsoft.com/learn/modules/plan-implement-administer-conditional-access/",
            "waf": "Segurança"
        },
        {
            "ammp": true,
            "category": "Gerenciamento de identidades e acesso",
            "guid": "1049d403-a923-4c34-94d0-0018ac6a9e01",
            "id": "C03.05",
            "link": "https://learn.microsoft.com/azure/active-directory/authentication/concept-mfa-howitworks",
            "severity": "Alto",
            "subcategory": "Identidade",
            "text": "Impor a autenticação multifator para qualquer usuário com direitos aos ambientes do Azure",
            "training": "https://learn.microsoft.com/learn/modules/secure-aad-users-with-mfa/",
            "waf": "Segurança"
        },
        {
            "category": "Gerenciamento de identidades e acesso",
            "guid": "e6a83de5-de32-4c19-a248-1607d5d1e4e6",
            "id": "C03.06",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/manage/centralize-operations",
            "severity": "Média",
            "subcategory": "Identidade",
            "text": "Impor responsabilidades centralizadas e delegadas para gerenciar recursos implantados dentro da zona de aterrissagem, com base nos requisitos de função e segurança",
            "training": "https://learn.microsoft.com/learn/paths/azure-administrator-manage-identities-governance/",
            "waf": "Segurança"
        },
        {
            "category": "Gerenciamento de identidades e acesso",
            "guid": "14658d35-58fd-4772-99b8-21112df27ee4",
            "id": "C03.07",
            "link": "https://learn.microsoft.com/azure/active-directory/privileged-identity-management/pim-configure",
            "severity": "Média",
            "subcategory": "Identidade",
            "text": "Impor o Gerenciamento de Identidades Privilegiadas (PIM) do Azure AD para estabelecer acesso permanente zero e privilégio mínimo",
            "training": "https://learn.microsoft.com/learn/modules/azure-ad-privileged-identity-management/",
            "waf": "Segurança"
        },
        {
            "ammp": true,
            "category": "Gerenciamento de identidades e acesso",
            "guid": "12e7f983-f630-4472-8dd6-9c5b5c2622f5",
            "id": "C03.08",
            "link": "https://learn.microsoft.com/azure/active-directory/roles/security-planning#identify-microsoft-accounts-in-administrative-roles-that-need-to-be-switched-to-work-or-school-accounts",
            "severity": "Alto",
            "subcategory": "Identidade",
            "text": "Use apenas o tipo de autenticação Conta corporativa ou de estudante para todos os tipos de conta. Evite usar a conta da Microsoft",
            "training": "https://learn.microsoft.com/learn/modules/explore-basic-services-identity-types/",
            "waf": "Segurança"
        },
        {
            "category": "Gerenciamento de identidades e acesso",
            "guid": "4b69bad3-3aad-45e8-a68e-1d76667313b4",
            "id": "C03.09",
            "link": "https://learn.microsoft.com/azure/active-directory/fundamentals/active-directory-groups-create-azure-portal",
            "severity": "Média",
            "subcategory": "Identidade",
            "text": "Use apenas grupos para atribuir permissões. Adicione grupos locais ao grupo somente do Azure-AD se um sistema de gerenciamento de grupo já estiver em vigor.",
            "training": "https://learn.microsoft.com/learn/paths/manage-identity-and-access/",
            "waf": "Segurança"
        },
        {
            "category": "Gerenciamento de identidades e acesso",
            "guid": "f5664b5e-984a-4859-a773-e7d261623a76",
            "id": "C03.10",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/identity-access#prerequisites-for-a-landing-zone---design-recommendations",
            "severity": "Média",
            "subcategory": "Identidade",
            "text": "Considere usar funções personalizadas do Azure para as seguintes funções principais: proprietário da plataforma Azure, gerenciamento de rede, operações de segurança, proprietário da assinatura, proprietário do aplicativo",
            "training": "https://learn.microsoft.com/learn/modules/create-custom-azure-roles-with-rbac/",
            "waf": "Segurança"
        },
        {
            "category": "Gerenciamento de identidades e acesso",
            "guid": "5a917e1f-348e-4f25-9c27-d42e8bbac757",
            "id": "C03.11",
            "link": "https://azure.microsoft.com/resources/achieving-compliant-data-residency-and-security-with-azure/",
            "severity": "Média",
            "subcategory": "Identidade",
            "text": "Se existirem requisitos de soberania de dados, as Políticas do Azure podem ser implantadas para impô-los",
            "training": "https://learn.microsoft.com/learn/paths/secure-your-cloud-data/",
            "waf": "Segurança"
        },
        {
            "category": "Gerenciamento de identidades e acesso",
            "guid": "1559ab91-53e8-4908-ae28-c84c33b6b780",
            "id": "C03.12",
            "link": "https://learn.microsoft.com/azure/active-directory-domain-services/overview",
            "severity": "Média",
            "subcategory": "Identidade",
            "text": "Se os Serviços de Domínios do Active Directory (AADDS) do Azure estiverem em uso, implante o AADDS na região primária porque esse serviço só pode ser projetado em uma assinatura",
            "training": "https://learn.microsoft.com/learn/modules/azure-active-directory/",
            "waf": "Segurança"
        },
        {
            "category": "Gerenciamento de identidades e acesso",
            "guid": "8b9fe5c4-1049-4d40-9a92-3c3474d00018",
            "id": "C03.13",
            "link": "https://learn.microsoft.com/azure/active-directory-domain-services/overview",
            "severity": "Média",
            "subcategory": "Identidade",
            "text": "Se o AADDS estiver em uso, avalie a compatibilidade de todas as cargas de trabalho",
            "training": "https://learn.microsoft.com/learn/modules/implement-hybrid-identity-windows-server/",
            "waf": "Segurança"
        },
        {
            "category": "Gerenciamento de identidades e acesso",
            "guid": "ac6a9e01-e6a8-43de-9de3-2c1992481607",
            "id": "C03.14",
            "link": "https://learn.microsoft.com/azure/architecture/reference-architectures/identity/adds-extend-domain",
            "severity": "Média",
            "subcategory": "Identidade",
            "text": "Se o AD no servidor Windows estiver em uso, todos os recursos necessários poderão acessar o controlador de domínio correto?",
            "training": "https://learn.microsoft.com/learn/paths/implement-windows-server-iaas-virtual-machine-identity/",
            "waf": "Segurança"
        },
        {
            "category": "Gerenciamento de identidades e acesso",
            "guid": "d5d1e4e6-1465-48d3-958f-d77249b82111",
            "id": "C03.15",
            "link": "https://learn.microsoft.com/azure/active-directory/app-proxy/application-proxy",
            "severity": "Média",
            "subcategory": "Identidade",
            "text": "Considere usar o Proxy de Aplicativo do Azure AD como uma VPN ou substituição de proxy reverso para dar aos usuários remotos acesso seguro e autenticado a aplicativos internos (hospedados na nuvem ou localmente).",
            "training": "https://learn.microsoft.com/learn/paths/implement-applications-external-access-azure-ad/",
            "waf": "Segurança"
        },
        {
            "category": "Gerenciamento de identidades e acesso",
            "guid": "35037e68-9349-4c15-b371-228514f4cdff",
            "id": "C03.16",
            "link": "https://learn.microsoft.com/azure/active-directory/roles/best-practices",
            "severity": "Média",
            "subcategory": "Identidade",
            "text": "Evite usar contas sincronizadas locais para atribuições de função do Azure AD.",
            "training": "https://learn.microsoft.com/learn/modules/design-identity-security-strategy/",
            "waf": "Segurança"
        },
        {
            "category": "Gerenciamento de identidades e acesso",
            "guid": "9cf5418b-1520-4b7b-add7-88eb28f833e8",
            "id": "C04.01",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/identity-access-landing-zones#managed-identities",
            "severity": "Baixo",
            "subcategory": "Zonas de desembarque",
            "text": "Configure a segmentação de rede de identidade (ADDS) por meio do uso de uma rede virtual e faça peer back para o hub. Fornecendo autenticação dentro da zona de aterrissagem do aplicativo (legado).",
            "training": "https://learn.microsoft.com/azure/architecture/example-scenario/identity/adds-extend-domain",
            "waf": "Segurança"
        },
        {
            "category": "Gerenciamento de identidades e acesso",
            "guid": "d4d1ad54-1abc-4919-b267-3f342d3b49e4",
            "id": "C04.02",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/identity-access-landing-zones#rbac-recommendations",
            "severity": "Média",
            "subcategory": "Zonas de desembarque",
            "text": "Use o RBAC do Azure para gerenciar o acesso do plano de dados aos recursos, se possível. E.G - Operações de dados em Keyvault, Conta de armazenamento e serviços de banco de dados. ",
            "training": "https://learn.microsoft.com/azure/role-based-access-control/overview",
            "waf": "Segurança"
        },
        {
            "category": "Gerenciamento de identidades e acesso",
            "guid": "d505ebcb-79b1-4274-9c0d-a27c8bea489c",
            "id": "C04.03",
            "link": "https://learn.microsoft.com/azure/active-directory/privileged-identity-management/pim-create-roles-and-resource-roles-review",
            "severity": "Média",
            "subcategory": "Zonas de desembarque",
            "text": "Use as revisões de acesso do Azure AD PIM para validar periodicamente os direitos de recurso.",
            "waf": "Segurança"
        },
        {
            "ammp": true,
            "category": "Gestão",
            "guid": "89cc5e11-aa4d-4c3b-893d-feb99215266a",
            "id": "D01.01",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#add-diagnostic-settings-to-save-your-wafs-logs",
            "severity": "Alto",
            "subcategory": "Entrega de aplicativos",
            "text": "Adicione configurações de diagnóstico para salvar os logs do WAF do Azure Front Door. Analise regularmente os logs para verificar se há ataques e detecções de falsos positivos.",
            "waf": "Operações"
        },
        {
            "category": "Gestão",
            "guid": "7f408960-c626-44cb-a018-347c8d790cdf",
            "id": "D01.02",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#send-logs-to-microsoft-sentinel",
            "severity": "Média",
            "subcategory": "Entrega de aplicativos",
            "text": "Envie logs do Azure Front Door para o Microsoft Sentinel. Detecte ataques e integre a telemetria do Front Door ao seu ambiente geral do Azure.",
            "waf": "Operações"
        },
        {
            "category": "Gestão",
            "guid": "7ea02e1c-7166-45a3-bdf5-098891367fcb",
            "id": "D02.01",
            "link": "https://learn.microsoft.com/azure/reliability/cross-region-replication-azure",
            "severity": "Média",
            "subcategory": "Proteção de Dados",
            "text": "Considere a replicação entre regiões no Azure para BCDR com regiões emparelhadas",
            "waf": "Fiabilidade"
        },
        {
            "category": "Gestão",
            "guid": "eba8cf22-45c6-4dc1-9b57-2cceb3b97ce5",
            "id": "D02.02",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-redundancy",
            "severity": "Média",
            "subcategory": "Proteção de Dados",
            "text": "Ao usar o Backup do Azure, considere os diferentes tipos de backup (GRS, ZRS E LRS), pois a configuração padrão é GRS",
            "waf": "Fiabilidade"
        },
        {
            "category": "Gestão",
            "guid": "67e7a8ed-4b30-4e38-a3f2-9812b2363cef",
            "id": "D03.01",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/design-logs-deployment",
            "severity": "Média",
            "subcategory": "Monitorização",
            "text": "Use um único espaço de trabalho de logs de monitor para gerenciar plataformas centralmente, exceto onde o controle de acesso baseado em função do Azure (RBAC do Azure), os requisitos de soberania de dados ou as políticas de retenção de dados exigem espaços de trabalho separados.",
            "training": "https://learn.microsoft.com/azure/azure-monitor/logs/design-logs-deployment",
            "waf": "Operações"
        },
        {
            "category": "Gestão",
            "guid": "e179b599-de0d-4597-9cd4-cd21b088137f",
            "id": "D03.02",
            "severity": "Média",
            "subcategory": "Monitorização",
            "text": "A zona de pouso está documentada?",
            "waf": "Operações"
        },
        {
            "category": "Gestão",
            "guid": "5e6c4cfd-3e50-4454-9c24-47ec66138a72",
            "id": "D03.03",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/data-retention-archive?tabs=portal-1%2Cportal-2#how-retention-and-archiving-work",
            "severity": "Média",
            "subcategory": "Monitorização",
            "text": "Use os Logs do Azure Monitor quando os requisitos de retenção de log excederem dois anos. Atualmente, você pode manter os dados arquivados por até 7 anos.",
            "training": "https://learn.microsoft.com/learn/paths/architect-infrastructure-operations/",
            "waf": "Operações"
        },
        {
            "category": "Gestão",
            "guid": "00f1ce16-ed30-41d6-b872-e52e3611cc58",
            "id": "D03.04",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/design-logs-deployment",
            "severity": "Média",
            "subcategory": "Monitorização",
            "text": "Use a Política do Azure para controle de acesso e relatórios de conformidade. A Política do Azure fornece a capacidade de impor configurações em toda a organização para garantir a adesão consistente à política e a detecção rápida de violações. ",
            "training": "https://learn.microsoft.com/learn/paths/architect-infrastructure-operations/",
            "waf": "Operações"
        },
        {
            "category": "Gestão",
            "guid": "e7d7e484-3276-4d8b-bc05-5bcf619e8a13",
            "id": "D03.05",
            "link": "https://learn.microsoft.com/azure/governance/policy/how-to/guest-configuration-create",
            "severity": "Média",
            "subcategory": "Monitorização",
            "text": "Monitore o desvio de configuração da máquina virtual (VM) no convidado usando a Política do Azure. Habilitar recursos de auditoria de configuração de convidado por meio de política ajuda as cargas de trabalho da equipe de aplicativos a consumir imediatamente os recursos de recursos com pouco esforço.",
            "training": "https://learn.microsoft.com/learn/paths/implement-resource-mgmt-security/",
            "waf": "Operações"
        },
        {
            "category": "Gestão",
            "guid": "f9887952-5d62-4688-9d70-ba6c97be9951",
            "id": "D03.06",
            "link": "https://learn.microsoft.com/azure/automation/update-management/overview",
            "severity": "Média",
            "subcategory": "Monitorização",
            "text": "Use o Gerenciamento de Atualizações na Automação do Azure como um mecanismo de aplicação de patches de longo prazo para VMs Windows e Linux. ",
            "training": "https://learn.microsoft.com/learn/paths/azure-administrator-manage-compute-resources/",
            "waf": "Operações"
        },
        {
            "category": "Gestão",
            "guid": "90483845-c986-4cb2-a131-56a12476e49f",
            "id": "D03.07",
            "link": "https://learn.microsoft.com/azure/network-watcher/network-watcher-monitoring-overview",
            "severity": "Média",
            "subcategory": "Monitorização",
            "text": "Use o Inspetor de Rede para monitorar proativamente os fluxos de tráfego",
            "training": "https://learn.microsoft.com/learn/modules/configure-network-watcher/",
            "waf": "Operações"
        },
        {
            "category": "Gestão",
            "guid": "541acdce-9793-477b-adb3-751ab2ab13ad",
            "id": "D03.08",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/lock-resources?tabs=json",
            "severity": "Média",
            "subcategory": "Monitorização",
            "text": "Use bloqueios de recursos para evitar a exclusão acidental de serviços compartilhados críticos.",
            "training": "https://learn.microsoft.com/learn/paths/implement-resource-mgmt-security/",
            "waf": "Operações"
        },
        {
            "category": "Gestão",
            "guid": "a6e55d7d-8a2a-4db1-87d6-326af625ca44",
            "id": "D03.09",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "severity": "Baixo",
            "subcategory": "Monitorização",
            "text": "Use políticas de negação para complementar as atribuições de função do Azure. A combinação de políticas de negação e atribuições de função do Azure garante que os guardrails apropriados estejam em vigor para impor quem pode implantar e configurar recursos e quais recursos eles podem implantar e configurar.",
            "waf": "Operações"
        },
        {
            "category": "Gestão",
            "guid": "e5695f22-23ac-4e8c-a123-08ca5017f154",
            "id": "D03.10",
            "link": "https://learn.microsoft.com/azure/service-health/alerts-activity-log-service-notifications-portal",
            "severity": "Média",
            "subcategory": "Monitorização",
            "text": "Inclua eventos de integridade de serviços e recursos como parte da solução geral de monitoramento de plataforma. Controlar a integridade do serviço e do recurso da perspectiva da plataforma é um componente importante do gerenciamento de recursos no Azure.",
            "waf": "Operações"
        },
        {
            "category": "Gestão",
            "guid": "d5f345bf-97ab-41a7-819c-6104baa7d48c",
            "id": "D03.11",
            "link": "https://learn.microsoft.com/azure/azure-monitor/alerts/action-groups",
            "severity": "Média",
            "subcategory": "Monitorização",
            "text": "Inclua alertas e grupos de ação como parte da plataforma de Integridade de Serviço do Azure para garantir que alertas ou problemas possam ser acionados",
            "waf": "Operações"
        },
        {
            "category": "Gestão",
            "guid": "e3ab3693-829e-47e3-8618-3687a0477a20",
            "id": "D03.12",
            "link": "https://learn.microsoft.com/azure/sentinel/quickstart-onboard",
            "severity": "Média",
            "subcategory": "Monitorização",
            "text": "Não envie entradas de log brutas de volta para sistemas de monitoramento locais. Em vez disso, adote um princípio de que os dados nascidos no Azure permanecem no Azure. Se a integração SIEM local for necessária, envie alertas críticos em vez de logs.",
            "waf": "Operações"
        },
        {
            "category": "Gestão",
            "guid": "9945bda4-3334-4f24-a116-34182ba52752",
            "id": "D03.13",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/design-logs-deployment",
            "severity": "Média",
            "subcategory": "Monitorização",
            "text": "Use um espaço de trabalho centralizado do Azure Monitor Log Analytics para coletar logs e métricas de recursos de aplicativos IaaS e PaaS e controlar o acesso ao log com o RBAC do Azure.",
            "waf": "Operações"
        },
        {
            "category": "Gestão",
            "guid": "6944008b-e7d7-4e48-9327-6d8bdc055bcf",
            "id": "D03.14",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-setup-guide/monitoring-reporting?tabs=AzureMonitor",
            "severity": "Média",
            "subcategory": "Monitorização",
            "text": "Use os Logs do Azure Monitor para insights e relatórios.",
            "waf": "Operações"
        },
        {
            "category": "Gestão",
            "guid": "619e8a13-f988-4795-85d6-26886d70ba6c",
            "id": "D03.15",
            "link": "https://learn.microsoft.com/azure/azure-monitor/agents/diagnostics-extension-overview",
            "severity": "Média",
            "subcategory": "Monitorização",
            "text": "Quando necessário, use contas de armazenamento compartilhado na zona de aterrissagem para o armazenamento de log de extensão de diagnóstico do Azure.",
            "waf": "Operações"
        },
        {
            "category": "Gestão",
            "guid": "97be9951-9048-4384-9c98-6cb2913156a1",
            "id": "D03.16",
            "link": "https://learn.microsoft.com/azure/azure-monitor/alerts/alerts-overview",
            "severity": "Média",
            "subcategory": "Monitorização",
            "text": "Use alertas do Azure Monitor para a geração de alertas operacionais.",
            "waf": "Operações"
        },
        {
            "category": "Gestão",
            "guid": "859c3900-4514-41eb-b010-475d695abd74",
            "id": "D03.17",
            "link": "https://learn.microsoft.com/azure/architecture/best-practices/monitoring",
            "severity": "Média",
            "subcategory": "Monitorização",
            "text": "Garantir que os requisitos de monitoramento tenham sido avaliados e que as configurações apropriadas de coleta de dados e alertas sejam aplicadas",
            "waf": "Operações"
        },
        {
            "category": "Gestão",
            "guid": "fed3c55f-a67e-4875-aadd-3aba3f9fde31",
            "id": "D03.18",
            "link": "https://learn.microsoft.com/azure/automation/how-to/region-mappings",
            "severity": "Média",
            "subcategory": "Monitorização",
            "text": "Considere as regiões com suporte para contas vinculadas de espaço de trabalho e automação do Log Analytics",
            "waf": "Operações"
        },
        {
            "category": "Gestão",
            "guid": "f541acdc-e979-4377-acdb-3751ab2ab13a",
            "id": "D04.01",
            "link": "https://learn.microsoft.com/azure/governance/policy/concepts/guest-configuration",
            "severity": "Média",
            "subcategory": "Compatibilidade operacional",
            "text": "Use as políticas do Azure para implantar automaticamente configurações de software por meio de extensões de VM e impor uma configuração de VM de linha de base compatível.",
            "waf": "Segurança"
        },
        {
            "category": "Gestão",
            "description": "Os recursos de configuração de convidado da Política do Azure podem auditar e corrigir as configurações do computador (por exemplo, sistema operacional, aplicativo, ambiente) para garantir que os recursos estejam alinhados com as configurações esperadas, e o Gerenciamento de Atualizações pode impor o gerenciamento de patches para VMs.",
            "guid": "da6e55d7-d8a2-4adb-817d-6326af625ca4",
            "id": "D04.02",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/management-operational-compliance#monitoring-for-configuration-drift",
            "severity": "Média",
            "subcategory": "Compatibilidade operacional",
            "text": "Monitore o desvio de configuração de segurança da VM por meio da Política do Azure.",
            "waf": "Segurança"
        },
        {
            "category": "Gestão",
            "guid": "2476e49f-541a-4cdc-b979-377bcdb3751a",
            "id": "D05.01",
            "link": "https://learn.microsoft.com/azure/site-recovery/site-recovery-overview",
            "severity": "Média",
            "subcategory": "Proteja e recupere",
            "text": "Use o Azure Site Recovery para cenários de recuperação de desastres de Máquinas Virtuais do Azure para Azure. Isso permite que você replique cargas de trabalho entre regiões.",
            "waf": "Operações"
        },
        {
            "category": "Gestão",
            "guid": "b2ab13ad-a6e5-45d7-b8a2-adb117d6326a",
            "id": "D05.02",
            "link": "https://learn.microsoft.com/azure/architecture/framework/resiliency/backup-and-recovery",
            "severity": "Média",
            "subcategory": "Proteja e recupere",
            "text": "Certifique-se de usar e testar os recursos nativos de recuperação de desastres do serviço PaaS.",
            "waf": "Operações"
        },
        {
            "category": "Gestão",
            "guid": "f625ca44-e569-45f2-823a-ce8cb12308ca",
            "id": "D05.03",
            "link": "https://learn.microsoft.com/azure/backup/backup-center-overview",
            "severity": "Média",
            "subcategory": "Proteja e recupere",
            "text": "Use os recursos de backup nativos do Azure ou uma solução de backup de terceiros de terceiros compatível com o Azure.",
            "waf": "Operações"
        },
        {
            "ammp": true,
            "category": "Gestão ",
            "guid": "826c5c45-bb79-4951-a812-e3bfbfd7326b",
            "id": "E01.01",
            "link": "https://learn.microsoft.com/azure/reliability/availability-zones-overview",
            "severity": "Alto",
            "subcategory": "Tolerância a falhas",
            "text": "Aproveite as zonas de disponibilidade para suas VMs em regiões onde elas são suportadas.",
            "waf": "Fiabilidade"
        },
        {
            "ammp": true,
            "category": "Gestão ",
            "guid": "7ccb7c06-5511-42df-8177-d97f08d0337d",
            "id": "E01.02",
            "link": "https://learn.microsoft.com/azure/virtual-machines/availability",
            "severity": "Alto",
            "subcategory": "Tolerância a falhas",
            "text": "Evite executar uma carga de trabalho de produção em uma única VM.",
            "waf": "Fiabilidade"
        },
        {
            "category": "Gestão ",
            "guid": "84101f59-1941-4195-a270-e28034290e3a",
            "id": "E01.03",
            "link": "https://learn.microsoft.com/azure/load-balancer/load-balancer-overview",
            "severity": "Média",
            "subcategory": "Tolerância a falhas",
            "text": "O Balanceador de Carga do Azure e o Gateway de Aplicativo distribuem o tráfego de rede de entrada em vários recursos.",
            "waf": "Fiabilidade"
        },
        {
            "category": "Gestão ",
            "guid": "ecdc7506-6f37-4ea9-be87-fc5d3df08a64",
            "id": "E02.01",
            "link": "https://learn.microsoft.com/azure/virtual-machine-scale-sets/overview",
            "severity": "Média",
            "subcategory": "Escalabilidade",
            "text": "Aproveite os conjuntos de Dimensionamento de Máquina Virtual do Azure para aumentar e diminuir a escala com base na carga.",
            "waf": "Fiabilidade"
        },
        {
            "category": "Topologia de rede e conectividade",
            "guid": "f00a69de-7076-4734-a734-6e4552cad9e1",
            "id": "F01.01",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-latest-version-for-customer-managed-certificates",
            "severity": "Média",
            "subcategory": "Entrega de aplicativos",
            "text": "Se você usar certificados TLS gerenciados pelo cliente com o Azure Front Door, use a versão de certificado 'Mais recente'. Reduza o risco de paralisações causadas pela renovação manual de certificados.",
            "waf": "Operações"
        },
        {
            "category": "Topologia de rede e conectividade",
            "guid": "6138a720-0f1c-4e16-bd30-1d6e872e52e3",
            "id": "F01.02",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/resource-org-management-groups#management-groups-in-the-azure-landing-zone-accelerator",
            "severity": "Média",
            "subcategory": "Entrega de aplicativos",
            "text": "Execute a entrega de aplicativos dentro das zonas de aterrissagem para aplicativos internos (corp) e externos (online).",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "Segurança"
        },
        {
            "category": "Topologia de rede e conectividade",
            "graph": "resources | where type == 'microsoft.network/applicationgateways' | project id, compliant = properties.sku.name in ('Standard_v2', 'WAF_v2') | project id,compliant",
            "guid": "553585a6-abe0-11ed-afa1-0242ac120002",
            "id": "F01.03",
            "link": "https://learn.microsoft.com/azure/application-gateway/overview-v2",
            "severity": "Média",
            "subcategory": "Entrega de aplicativos",
            "text": "Verifique se você está usando o SKU do Application Gateway v2",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "Segurança"
        },
        {
            "category": "Topologia de rede e conectividade",
            "graph": "resources | where type == 'microsoft.network/loadbalancers' | project id, compliant=(tolower(sku.name) == 'standard')",
            "guid": "4e35fbf5-0ae2-48b2-97ce-753353edbd1a",
            "id": "F01.04",
            "link": "https://learn.microsoft.com/azure/load-balancer/load-balancer-overview",
            "severity": "Média",
            "subcategory": "Entrega de aplicativos",
            "text": "Verifique se você está usando a SKU padrão para seus Balanceadores de Carga do Azure",
            "waf": "Segurança"
        },
        {
            "category": "Topologia de rede e conectividade",
            "graph": "resources | where type=='microsoft.network/applicationgateways' | extend subnetId = tostring(properties.gatewayIPConfigurations[0].properties.subnet.id) | project id, subnetId | join (resources | where type=='microsoft.network/virtualnetworks' | project id,subnets=properties.subnets | mv-expand subnets | project id, subnetId = tostring(subnets.id), subnetPrefixLength = split(subnets.properties.addressPrefix, '/')[1]) on subnetId | extend compliant = (subnetPrefixLength <= 26) | distinct id,compliant",
            "guid": "dfc50f87-3800-424c-937b-ed5f186e7c15",
            "id": "F01.05",
            "link": "https://learn.microsoft.com/azure/application-gateway/configuration-infrastructure#size-of-the-subnet",
            "severity": "Média",
            "subcategory": "Entrega de aplicativos",
            "text": "Seus gateways de aplicativo devem ser implantados em sub-redes com prefixos IP iguais ou maiores que /26",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "Segurança"
        },
        {
            "category": "Topologia de rede e conectividade",
            "description": "A administração de proxies reversos em geral e do WAF em particular está mais próxima do aplicativo do que da rede, portanto, eles pertencem à mesma assinatura do aplicativo. Centralizar o Application Gateway e o WAF na assinatura de conectividade pode ser OK se for gerenciado por uma única equipe.",
            "guid": "48b662d6-d15f-4512-a654-98f6dfe237de",
            "id": "F01.06",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "severity": "Média",
            "subcategory": "Entrega de aplicativos",
            "text": "Implante o Gateway de Aplicativo do Azure v2 ou NVAs de parceiros usados para fazer proxy de conexões HTTP(S) de entrada na rede virtual da zona de aterrissagem e com os aplicativos que eles estão protegendo.",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "Segurança"
        },
        {
            "category": "Topologia de rede e conectividade",
            "guid": "143b16c3-1d7a-4a9b-9470-4489a8042d88",
            "id": "F01.07",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "severity": "Média",
            "subcategory": "Entrega de aplicativos",
            "text": "Use uma rede DDoS ou planos de proteção IP para todos os endereços IP públicos nas zonas de aterrissagem do aplicativo.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Segurança"
        },
        {
            "category": "Topologia de rede e conectividade",
            "guid": "e79d17b7-3b22-4a5a-97e7-a8ed4b30e38c",
            "id": "F01.08",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "severity": "Média",
            "subcategory": "Entrega de aplicativos",
            "text": "Use o Azure Front Door com políticas WAF para fornecer e ajudar a proteger aplicativos HTTP/S globais que abrangem várias regiões do Azure.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Segurança"
        },
        {
            "category": "Topologia de rede e conectividade",
            "guid": "3f29812b-2363-4cef-b179-b599de0d5973",
            "id": "F01.09",
            "link": "https://learn.microsoft.com/azure/ddos-protection/ddos-protection-overview",
            "severity": "Média",
            "subcategory": "Entrega de aplicativos",
            "text": "Ao usar o Front Door e o Application Gateway para ajudar a proteger aplicativos HTTP/S, use políticas WAF no Front Door. Bloqueie o Application Gateway para receber tráfego somente do Front Door.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Segurança"
        },
        {
            "ammp": true,
            "category": "Topologia de rede e conectividade",
            "guid": "cd4cd21b-0881-437f-9e6c-4cfd3e504547",
            "id": "F01.10",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "severity": "Alto",
            "subcategory": "Entrega de aplicativos",
            "text": "Use o Gerenciador de Tráfego para fornecer aplicativos globais que abrangem protocolos diferentes de HTTP/S.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Fiabilidade"
        },
        {
            "category": "Topologia de rede e conectividade",
            "guid": "3b4b3e88-a459-4ed5-a22f-644dfbc58204",
            "id": "F01.11",
            "link": "https://learn.microsoft.com/azure/active-directory/app-proxy/application-proxy#how-application-proxy-works",
            "severity": "Baixo",
            "subcategory": "Entrega de aplicativos",
            "text": "Se os usuários precisarem apenas de acesso a aplicativos internos, o Proxy de Aplicativo do Azure AD foi considerado uma alternativa à Área de Trabalho Virtual (AVD) do Azure?",
            "training": "https://learn.microsoft.com/learn/modules/configure-azure-ad-application-proxy/",
            "waf": "Segurança"
        },
        {
            "category": "Topologia de rede e conectividade",
            "guid": "01ca7cf1-5754-442d-babb-8ba6772e5c30",
            "id": "F01.12",
            "link": "https://learn.microsoft.com/azure/active-directory/app-proxy/application-proxy#how-application-proxy-works",
            "severity": "Média",
            "subcategory": "Entrega de aplicativos",
            "text": "Para reduzir o número de portas de firewall abertas para conexões de entrada em sua rede, considere usar o Proxy de Aplicativo do Azure AD para dar aos usuários remotos acesso seguro e autenticado a aplicativos internos.",
            "training": "https://learn.microsoft.com/learn/paths/implement-applications-external-access-azure-ad/",
            "waf": "Segurança"
        },
        {
            "ammp": true,
            "category": "Topologia de rede e conectividade",
            "graph": "resources | where type == 'microsoft.network/frontdoorwebapplicationfirewallpolicies' | project policyName=name, policyId=id,policySku=sku.name, links=properties.securityPolicyLinks, enabledState=properties.policySettings.enabledState, mode=properties.policySettings.mode | mvexpand links | extend securityPolicy=links.id | extend securityPolicyParts=split(securityPolicy, '/') | extend profileId=strcat_array(array_slice(securityPolicyParts, 0, -3), '/') | project id=profileId, compliant=((enabledState=='Enabled') and (mode=='Prevention')), enabledState, mode",
            "guid": "ae248989-b306-4591-9186-de482e3f0f0e",
            "id": "F01.13",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-policy-settings",
            "severity": "Alto",
            "subcategory": "Entrega de aplicativos",
            "text": "Implante seus perfis WAF para Front Door no modo 'Prevenção'.",
            "waf": "Segurança"
        },
        {
            "ammp": true,
            "category": "Topologia de rede e conectividade",
            "guid": "062d5839-4d36-402f-bfa4-02811eb936e9",
            "id": "F01.14",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#avoid-combining-traffic-manager-and-front-door",
            "severity": "Alto",
            "subcategory": "Entrega de aplicativos",
            "text": "Evite combinar o Gerenciador de Tráfego do Azure e o Azure Front Door.",
            "waf": "Segurança"
        },
        {
            "ammp": true,
            "category": "Topologia de rede e conectividade",
            "guid": "5efeb96a-003f-4b18-8fcd-b4d84459c2b2",
            "id": "F01.15",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-the-same-domain-name-on-front-door-and-your-origin",
            "severity": "Alto",
            "subcategory": "Entrega de aplicativos",
            "text": "Use o mesmo nome de domínio no Azure Front Door e sua origem. Nomes de host incompatíveis podem causar bugs sutis.",
            "waf": "Segurança"
        },
        {
            "category": "Topologia de rede e conectividade",
            "guid": "0b5a380c-4bfb-47bc-b1d7-dcfef363a61b",
            "id": "F01.16",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#disable-health-probes-when-theres-only-one-origin-in-an-origin-group",
            "severity": "Baixo",
            "subcategory": "Entrega de aplicativos",
            "text": "Desabilite os testes de integridade quando houver apenas uma origem em um grupo de origem do Azure Front Door.",
            "waf": "Desempenho"
        },
        {
            "category": "Topologia de rede e conectividade",
            "guid": "5567048e-e5d7-4206-9c55-b5ed45d2cc0c",
            "id": "F01.17",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#select-good-health-probe-endpoints",
            "severity": "Média",
            "subcategory": "Entrega de aplicativos",
            "text": "Selecione bons pontos de extremidade de teste de integridade para o Azure Front Door. Considere a criação de pontos de extremidade de integridade que verifiquem todas as dependências do seu aplicativo.",
            "waf": "Fiabilidade"
        },
        {
            "category": "Topologia de rede e conectividade",
            "guid": "a13f72f3-8f5c-4864-95e5-75bf37fbbeb1",
            "id": "F01.18",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-head-health-probes",
            "severity": "Baixo",
            "subcategory": "Entrega de aplicativos",
            "text": "Use testes de integridade do HEAD com o Azure Front Door para reduzir o tráfego que o Front Door envia para seu aplicativo.",
            "waf": "Desempenho"
        },
        {
            "ammp": true,
            "category": "Topologia de rede e conectividade",
            "graph": "resources | where type=='microsoft.network/loadbalancers' | extend countOutRules=array_length(properties.outboundRules) | extend compliant = (countOutRules == 0) | distinct id,compliant",
            "guid": "97a2fd46-64b0-1dfa-b72d-9c8869496d75",
            "id": "F01.19",
            "link": "https://learn.microsoft.com/azure/nat-gateway/nat-overview#outbound-connectivity",
            "severity": "Alto",
            "subcategory": "Entrega de aplicativos",
            "text": "Usar o Gateway NAT do Azure em vez das regras de saída do Load Balancer para melhor escalabilidade do SNAT",
            "waf": "Fiabilidade"
        },
        {
            "ammp": true,
            "category": "Topologia de rede e conectividade",
            "guid": "af95c92d-d723-4f4a-98d7-8722324efd4d",
            "id": "F01.20",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-managed-tls-certificates",
            "severity": "Alto",
            "subcategory": "Entrega de aplicativos",
            "text": "Use certificados TLS gerenciados com o Azure Front Door. Reduza o custo operacional e o risco de paralisações devido a renovações de certificados.",
            "waf": "Operações"
        },
        {
            "category": "Topologia de rede e conectividade",
            "guid": "189ea962-3969-4863-8f5a-5ad808c2cf4b",
            "id": "F01.21",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#define-your-waf-configuration-as-code",
            "severity": "Média",
            "subcategory": "Entrega de aplicativos",
            "text": "Defina sua configuração do WAF do Azure Front Door como código. Usando o código, você pode adotar mais facilmente novas versões do conjunto de regras e obter proteção adicional.",
            "waf": "Operações"
        },
        {
            "category": "Topologia de rede e conectividade",
            "guid": "de0d5973-cd4c-4d21-a088-137f5e6c4cfd",
            "id": "F02.01",
            "link": "https://learn.microsoft.com/azure/virtual-network/network-security-group-how-it-works",
            "severity": "Média",
            "subcategory": "Encriptação",
            "text": "Quando estiver usando o ExpressRoute Direct, configure o MACsec para criptografar o tráfego no nível de camada dois entre os roteadores da organização e o MSEE. O diagrama mostra essa criptografia no fluxo.",
            "waf": "Segurança"
        },
        {
            "category": "Topologia de rede e conectividade",
            "guid": "ed301d6e-872e-452e-9611-cc58b5a4b151",
            "id": "F02.02",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-erdirect-about",
            "severity": "Baixo",
            "subcategory": "Encriptação",
            "text": "Para cenários em que MACsec não é uma opção (por exemplo, não usar o ExpressRoute Direct), use um gateway VPN para estabelecer túneis IPsec sobre emparelhamento privado da Rota Expressa. ",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/",
            "waf": "Segurança"
        },
        {
            "category": "Topologia de rede e conectividade",
            "guid": "e8bbac75-7155-49ab-a153-e8908ae28c84",
            "id": "F03.01",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/enterprise-scale/network-topology-and-connectivity",
            "severity": "Média",
            "subcategory": "Hub e falou",
            "text": "Considere um design de rede baseado na topologia de rede hub-and-spoke tradicional para cenários de rede que exigem flexibilidade máxima.",
            "training": "https://learn.microsoft.com/learn/paths/architect-network-infrastructure/",
            "waf": "Segurança"
        },
        {
            "ammp": true,
            "category": "Topologia de rede e conectividade",
            "guid": "7dd61623-a364-4a90-9eca-e48ebd54cd7d",
            "id": "F03.02",
            "link": "https://learn.microsoft.com/azure/architecture/reference-architectures/hybrid-networking/expressroute",
            "severity": "Alto",
            "subcategory": "Hub e falou",
            "text": "Verifique se os serviços de rede compartilhados, incluindo gateways de Rota Expressa, gateways VPN e Firewall do Azure ou NVAs de parceiros na rede virtual de hub central. Se necessário, implante também controladores de domínio do Active Directory e servidores DNS.",
            "waf": "Custar"
        },
        {
            "category": "Topologia de rede e conectividade",
            "guid": "e2e8abac-3571-4559-ab91-53e89f89dc7b",
            "id": "F03.03",
            "link": "https://learn.microsoft.com/azure/architecture/reference-architectures/dmz/nva-ha",
            "severity": "Média",
            "subcategory": "Hub e falou",
            "text": "Ao implantar tecnologias de rede de parceiros ou NVAs, siga as orientações do fornecedor parceiro",
            "waf": "Fiabilidade"
        },
        {
            "category": "Topologia de rede e conectividade",
            "guid": "ce463dbb-bc8a-4c2a-aebc-92a43da1dae2",
            "id": "F03.04",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-howto-coexist-resource-manager#to-enable-transit-routing-between-expressroute-and-azure-vpn",
            "severity": "Baixo",
            "subcategory": "Hub e falou",
            "text": "Se você precisar transitar entre gateways ExpressRoute e VPN em cenários de hub e spoke, use o Servidor de Rota do Azure.",
            "waf": "Segurança"
        },
        {
            "category": "Topologia de rede e conectividade",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,subnets=properties.subnets | mv-expand subnets | project id, subnetName = subnets.name, subnetPrefix = subnets.properties.addressPrefix | extend subnetPrefixLength = split(subnetPrefix, '/')[1] | where subnetName == 'RouteServerSubnet' | extend compliant = (subnetPrefixLength <= 27) | distinct id, compliant",
            "guid": "91b9d7d5-91e1-4dcb-8f1f-fa7e465646cc",
            "id": "F03.05",
            "link": "https://learn.microsoft.com/azure/route-server/quickstart-configure-route-server-portal#create-a-route-server-1",
            "severity": "Baixo",
            "subcategory": "Hub e falou",
            "text": "Se estiver usando o Servidor de Rotas, use um prefixo /27 para a sub-rede do Servidor de Rotas.",
            "waf": "Segurança"
        },
        {
            "category": "Topologia de rede e conectividade",
            "guid": "cc881471-607c-41cc-a0e6-14658dd558f9",
            "id": "F03.06",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-networks-faq#can-i-create-a-peering-connection-to-a-vnet-in-a-different-region",
            "severity": "Média",
            "subcategory": "Hub e falou",
            "text": "Para arquiteturas de rede com várias topologias de hub e spoke em regiões do Azure, use emparelhamentos de rede virtual global entre as VNets de hub para conectar as regiões umas às outras. ",
            "training": "https://learn.microsoft.com/learn/paths/azure-administrator-manage-virtual-networks/",
            "waf": "Desempenho"
        },
        {
            "category": "Topologia de rede e conectividade",
            "guid": "4722d929-c1b1-4cd6-81f5-4b29bade39ad",
            "id": "F03.07",
            "link": "https://learn.microsoft.com/azure/azure-monitor/insights/network-insights-overview",
            "severity": "Média",
            "subcategory": "Hub e falou",
            "text": "Use o Azure Monitor for Networks para monitorar o estado de ponta a ponta das redes no Azure.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-network-monitoring/",
            "waf": "Operações"
        },
        {
            "category": "Topologia de rede e conectividade",
            "graph": "resources | where type == 'microsoft.network/virtualnetworks' | mvexpand properties.virtualNetworkPeerings | summarize peeringcount = count() by id | extend compliant = (peeringcount < 450) | distinct id,compliant",
            "guid": "0e7c28ec-9366-4572-83b0-f4664b1d944a",
            "id": "F03.08",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits?toc=/azure/virtual-network/toc.json#azure-resource-manager-virtual-networking-limits",
            "severity": "Média",
            "subcategory": "Hub e falou",
            "text": "Ao conectar redes virtuais spoke à rede virtual do hub central, considere os limites de emparelhamento de VNet (500), o número máximo de prefixos que podem ser anunciados via Rota Expressa (1000)",
            "waf": "Fiabilidade"
        },
        {
            "category": "Topologia de rede e conectividade",
            "graph": "resources | where type=='microsoft.network/routetables' | mvexpand properties.routes | summarize routeCount = count() by id | extend compliant = (routeCount < 360) | distinct id,compliant",
            "guid": "3d457936-e9b7-41eb-bdff-314b26450b12",
            "id": "F03.09",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits?toc=/azure/virtual-network/toc.json#azure-resource-manager-virtual-networking-limits",
            "severity": "Média",
            "subcategory": "Hub e falou",
            "text": "Considere o limite de rotas por tabela de rotas (400).",
            "waf": "Fiabilidade"
        },
        {
            "ammp": true,
            "category": "Topologia de rede e conectividade",
            "graph": "resources | where type == 'microsoft.network/virtualnetworks' | mvexpand properties.virtualNetworkPeerings | project id, peeringName=properties_virtualNetworkPeerings.name, compliant = (properties_virtualNetworkPeerings.properties.allowVirtualNetworkAccess == True)",
            "guid": "c76cb5a2-abe2-11ed-afa1-0242ac120002",
            "id": "F03.10",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-network-manage-peering",
            "severity": "Alto",
            "subcategory": "Hub e falou",
            "text": "Use a configuração 'Permitir tráfego para rede virtual remota' ao configurar emparelhamentos de rede virtual",
            "waf": "Fiabilidade"
        },
        {
            "category": "Topologia de rede e conectividade",
            "guid": "359c373e-7dd6-4162-9a36-4a907ecae48e",
            "id": "F04.01",
            "link": "https://learn.microsoft.com/azure/architecture/reference-architectures/hybrid-networking/hub-spoke?tabs=cli",
            "severity": "Média",
            "subcategory": "Híbrido",
            "text": "Verifique se você investigou a possibilidade de usar a Rota Expressa como conexão primária com o Azure.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Desempenho"
        },
        {
            "category": "Topologia de rede e conectividade",
            "description": "Você pode usar os pesos de conexão e prependente de caminho AS para influenciar o tráfego do Azure para o local e toda a gama de atributos BGP em seus próprios roteadores para influenciar o tráfego do local para o Azure.",
            "guid": "f29812b2-363c-4efe-879b-599de0d5973c",
            "id": "F04.02",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-routing",
            "severity": "Média",
            "subcategory": "Híbrido",
            "text": "Ao usar vários circuitos de Rota Expressa ou vários locais locais, certifique-se de otimizar o roteamento com atributos BGP, se determinados caminhos forem preferidos.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Fiabilidade"
        },
        {
            "category": "Topologia de rede e conectividade",
            "graph": "resources| where type == 'microsoft.network/virtualnetworkgateways'| where properties.gatewayType =~ 'vpn' or properties.gatewayType == 'ExpressRoute'| extend SKUName = properties.sku.name, SKUTier = properties.sku.tier, Type = properties.gatewayType| extend compliant = SKUTier !in ('Basic', 'Standard')| project name, id, subscriptionId, resourceGroup, compliant",
            "guid": "d4cd21b0-8813-47f5-b6c4-cfd3e504547c",
            "id": "F04.03",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-routing",
            "severity": "Média",
            "subcategory": "Híbrido",
            "text": "Verifique se você está usando a SKU certa para os gateways ExpressRoute/VPN com base nos requisitos de largura de banda e desempenho.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Desempenho"
        },
        {
            "ammp": true,
            "category": "Topologia de rede e conectividade",
            "graph": "resources | where type=='microsoft.network/expressroutecircuits' | extend compliant = (tolower(sku.family) == 'metereddata' or tolower(sku.tier) == 'local') | distinct id,compliant",
            "guid": "7025b442-f6e9-4af6-b11f-c9574916016f",
            "id": "F04.04",
            "link": "https://learn.microsoft.com/azure/expressroute/plan-manage-cost",
            "severity": "Alto",
            "subcategory": "Híbrido",
            "text": "Certifique-se de que você está usando circuitos de Rota Expressa de dados ilimitados somente se atingir a largura de banda que justifica seu custo.",
            "waf": "Custar"
        },
        {
            "ammp": true,
            "category": "Topologia de rede e conectividade",
            "graph": "resources | where type=='microsoft.network/connections' | where properties.connectionType == 'ExpressRoute' | project id, gwid=tostring(properties.virtualNetworkGateway1.id), circuitid=tostring(properties.peer.id) | join (resources | where type=='microsoft.network/expressroutecircuits' | project circuitid=tostring(id), circuitsku=sku.tier) on circuitid | project id=gwid, compliant = (circuitsku == 'Local') | summarize compliant=max(compliant) by id",
            "guid": "f4e7926a-ec35-476e-a412-5dd17136bd62",
            "id": "F04.05",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-faqs#expressroute-local",
            "severity": "Alto",
            "subcategory": "Híbrido",
            "text": "Aproveite a SKU Local da Rota Expressa para reduzir o custo de seus circuitos, se o local de emparelhamento de seus circuitos oferecer suporte às regiões do Azure para a SKU Local.",
            "waf": "Custar"
        },
        {
            "category": "Topologia de rede e conectividade",
            "graph": "resources| where type == 'microsoft.network/virtualnetworkgateways'| where properties.gatewayType =~ 'vpn' or properties.gatewayType == 'ExpressRoute'| extend SKUName = properties.sku.name, SKUTier = properties.sku.tier, Type = properties.gatewayType| extend compliant = SKUTier contains 'AZ'| project name, id, subscriptionId, resourceGroup, Type, compliant",
            "guid": "2447ec66-138a-4720-8f1c-e16ed301d6e8",
            "id": "F04.06",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-about-virtual-network-gateways",
            "severity": "Média",
            "subcategory": "Híbrido",
            "text": "Implante um gateway de Rota Expressa com redundância de zona nas regiões do Azure com suporte.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Fiabilidade"
        },
        {
            "category": "Topologia de rede e conectividade",
            "guid": "72e52e36-11cc-458b-9a4b-1511e43a58a9",
            "id": "F04.07",
            "link": "https://learn.microsoft.com/azure/networking/",
            "severity": "Média",
            "subcategory": "Híbrido",
            "text": "Para cenários que exigem largura de banda superior a 10 Gbps ou portas dedicadas de 10/100 Gbps, use o ExpressRoute Direct.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Desempenho"
        },
        {
            "category": "Topologia de rede e conectividade",
            "guid": "c2299c4d-7b57-4d0c-9555-62f2b3e4563a",
            "id": "F04.08",
            "link": "https://learn.microsoft.com/azure/expressroute/about-fastpath",
            "severity": "Média",
            "subcategory": "Híbrido",
            "text": "Quando a baixa latência for necessária ou a taxa de transferência do local para o Azure precisar ser maior que 10 Gbps, habilite o FastPath para ignorar o gateway da Rota Expressa a partir do caminho de dados.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Desempenho"
        },
        {
            "category": "Topologia de rede e conectividade",
            "graph": "resources | where type=='microsoft.network/virtualnetworkgateways' | where properties.gatewayType == 'Vpn' | extend compliant = (tolower(properties.sku.name) contains 'az') | distinct id, compliant",
            "guid": "4d873974-8b66-42d6-b15f-512a65498f6d",
            "id": "F04.09",
            "link": "https://learn.microsoft.com/azure/vpn-gateway/create-zone-redundant-vnet-gateway",
            "severity": "Média",
            "subcategory": "Híbrido",
            "text": "Use gateways VPN para conectar filiais ou locais remotos ao Azure. Para maior resiliência, implante gateways com redundância de zona (quando disponíveis).",
            "training": "https://learn.microsoft.com/training/modules/intro-to-azure-vpn-gateway/",
            "waf": "Fiabilidade"
        },
        {
            "ammp": true,
            "category": "Topologia de rede e conectividade",
            "guid": "718cb437-b060-2589-8856-2e93a5c6633b",
            "id": "F04.10",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-erdirect-about",
            "severity": "Alto",
            "subcategory": "Híbrido",
            "text": "Se estiver usando o ExpressRoute Direct, considere usar circuitos locais do ExpressRoute para as regiões locais do Azure para economizar custos",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Custar"
        },
        {
            "category": "Topologia de rede e conectividade",
            "guid": "8042d88e-79d1-47b7-9b22-a5a67e7a8ed4",
            "id": "F04.11",
            "link": "https://learn.microsoft.com/azure/architecture/framework/services/networking/expressroute/reliability",
            "severity": "Média",
            "subcategory": "Híbrido",
            "text": "Quando o isolamento de tráfego ou a largura de banda dedicada forem necessários, como para separar ambientes de produção e de não produção, use circuitos de Rota Expressa diferentes. Ele ajudará você a garantir domínios de roteamento isolados e aliviar os riscos de vizinhos barulhentos.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Segurança"
        },
        {
            "category": "Topologia de rede e conectividade",
            "guid": "b30e38c3-f298-412b-8363-cefe179b599d",
            "id": "F04.12",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-monitoring-metrics-alerts",
            "severity": "Média",
            "subcategory": "Híbrido",
            "text": "Monitore a disponibilidade e a utilização do ExpressRoute usando o Express Route Insights integrado.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Operações"
        },
        {
            "category": "Topologia de rede e conectividade",
            "guid": "5bf68dc9-325e-4873-bf88-f8214ef2e5d2",
            "id": "F04.13",
            "link": "https://learn.microsoft.com/azure/expressroute/how-to-configure-connection-monitor",
            "severity": "Média",
            "subcategory": "Híbrido",
            "text": "Use o Monitor de Conexão para monitoramento de conectividade em todo o ambiente.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Operações"
        },
        {
            "category": "Topologia de rede e conectividade",
            "guid": "e0d5973c-d4cd-421b-8881-37f5e6c4cfd3",
            "id": "F04.14",
            "link": "https://learn.microsoft.com/azure/expressroute/designing-for-disaster-recovery-with-expressroute-privatepeering#challenges-of-using-multiple-expressroute-circuits",
            "severity": "Média",
            "subcategory": "Híbrido",
            "text": "Use circuitos de Rota Expressa de diferentes locais de emparelhamento para redundância.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Fiabilidade"
        },
        {
            "ammp": true,
            "category": "Topologia de rede e conectividade",
            "guid": "2df4930f-6a43-49a3-926b-309f02c302f0",
            "id": "F04.15",
            "link": "https://learn.microsoft.com/azure/architecture/reference-architectures/identity/adds-extend-domain#vm-recommendations",
            "severity": "Alto",
            "subcategory": "Híbrido",
            "text": "Se você estiver implantando pelo menos duas VMs executando o AD DS como controladores de domínio, adicione-as a zonas de disponibilidade diferentes. Se não estiver disponível na região, implante em um Conjunto de Disponibilidade.",
            "waf": "Fiabilidade"
        },
        {
            "ammp": true,
            "category": "Topologia de rede e conectividade",
            "guid": "558fd772-49b8-4211-82df-27ee412e7f98",
            "id": "F05.01",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-ip-addressing",
            "severity": "Alto",
            "subcategory": "Plano IP",
            "text": "Certifique-se de que nenhum espaço de endereço IP sobreposto entre regiões do Azure e locais locais seja usado",
            "training": "https://learn.microsoft.com/learn/paths/architect-network-infrastructure/",
            "waf": "Segurança"
        },
        {
            "category": "Topologia de rede e conectividade",
            "graph": "resources | where type == 'microsoft.network/virtualnetworks' | extend addressSpace = todynamic(properties.addressSpace) | extend addressPrefix = todynamic(properties.addressSpace.addressPrefixes) | mvexpand addressSpace | mvexpand addressPrefix | project name, id, location, resourceGroup, subscriptionId, cidr = addressPrefix | extend compliant = (cidr matches regex @'^(10\\\\.|172\\\\.(1[6-9]|2[0-9]|3[01])\\\\.|192\\\\.168\\\\.)')  | project id, compliant, cidr",
            "guid": "3f630472-2dd6-49c5-a5c2-622f54b69bad",
            "id": "F05.02",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-ip-addressing",
            "severity": "Baixo",
            "subcategory": "Plano IP",
            "text": "Use endereços IP dos intervalos de alocação de endereços para internets privadas (RFC 1918).",
            "training": "https://learn.microsoft.com/learn/paths/architect-network-infrastructure/",
            "waf": "Segurança"
        },
        {
            "ammp": true,
            "category": "Topologia de rede e conectividade",
            "graph": "resources | where type == 'microsoft.network/virtualnetworks' | extend addressSpace = todynamic(properties.addressSpace) | extend addressPrefix = todynamic(properties.addressSpace.addressPrefixes) | mvexpand addressSpace | mvexpand addressPrefix | extend addressMask = split(addressPrefix,'/')[1] | extend compliant = addressMask > 16 | project name, id, subscriptionId, resourceGroup, addressPrefix, compliant",
            "guid": "33aad5e8-c68e-41d7-9667-313b4f5664b5",
            "id": "F05.03",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-ip-addressing",
            "severity": "Alto",
            "subcategory": "Plano IP",
            "text": "Certifique-se de que o espaço de endereço IP não seja desperdiçado, não crie redes virtuais desnecessariamente grandes (por exemplo, /16) ",
            "training": "https://learn.microsoft.com/learn/paths/architect-network-infrastructure/",
            "waf": "Desempenho"
        },
        {
            "ammp": true,
            "category": "Topologia de rede e conectividade",
            "guid": "f348ef25-4c27-4d42-b8bb-ac7571559ab9",
            "id": "F05.04",
            "link": "https://learn.microsoft.com/azure/site-recovery/concepts-on-premises-to-azure-networking#retain-ip-addresses",
            "severity": "Alto",
            "subcategory": "Plano IP",
            "text": "Evite usar intervalos de endereços IP sobrepostos para sites de produção e DR.",
            "training": "https://learn.microsoft.com/learn/paths/az-104-manage-virtual-networks/",
            "waf": "Fiabilidade"
        },
        {
            "category": "Topologia de rede e conectividade",
            "guid": "153e8908-ae28-4c84-a33b-6b7808b9fe5c",
            "id": "F05.05",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-networks-name-resolution-for-vms-and-role-instances",
            "severity": "Média",
            "subcategory": "Plano IP",
            "text": "Para ambientes em que a resolução de nomes no Azure é tudo o que é necessário, use o DNS Privado do Azure para resolução com uma zona delegada para resolução de nomes (como 'azure.contoso.com').",
            "training": "https://learn.microsoft.com/learn/paths/az-104-manage-virtual-networks/",
            "waf": "Operações"
        },
        {
            "category": "Topologia de rede e conectividade",
            "guid": "41049d40-3a92-43c3-974d-00018ac6a9e0",
            "id": "F05.06",
            "link": "https://learn.microsoft.com/azure/dns/dns-private-resolver-overview",
            "severity": "Média",
            "subcategory": "Plano IP",
            "text": "Para ambientes em que a resolução de nomes no Azure e no local é necessária, considere usar o Resolvedor Privado de DNS do Azure.",
            "training": "https://learn.microsoft.com/training/modules/intro-to-azure-dns-private-resolver/",
            "waf": "Segurança"
        },
        {
            "category": "Topologia de rede e conectividade",
            "guid": "1e6a83de-5de3-42c1-a924-81607d5d1e4e",
            "id": "F05.07",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-networks-name-resolution-for-vms-and-role-instances",
            "severity": "Baixo",
            "subcategory": "Plano IP",
            "text": "Cargas de trabalho especiais que exigem e implantam seu próprio DNS (como o Red Hat OpenShift) devem usar sua solução DNS preferida.",
            "waf": "Operações"
        },
        {
            "ammp": true,
            "category": "Topologia de rede e conectividade",
            "guid": "614658d3-558f-4d77-849b-821112df27ee",
            "id": "F05.08",
            "link": "https://learn.microsoft.com/azure/dns/private-dns-autoregistration",
            "severity": "Alto",
            "subcategory": "Plano IP",
            "text": "Habilite o registro automático para o DNS do Azure para gerenciar automaticamente o ciclo de vida dos registros DNS das máquinas virtuais implantadas em uma rede virtual.",
            "training": "https://learn.microsoft.com/learn/paths/az-104-manage-virtual-networks/",
            "waf": "Operações"
        },
        {
            "category": "Topologia de rede e conectividade",
            "guid": "ee1ac551-c4d5-46cf-b035-d0a3c50d87ad",
            "id": "F06.01",
            "link": "https://learn.microsoft.com/azure/bastion/bastion-overview",
            "severity": "Média",
            "subcategory": "Internet",
            "text": "Considere usar o Bastião do Azure para se conectar com segurança à sua rede.",
            "waf": "Segurança"
        },
        {
            "category": "Topologia de rede e conectividade",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,subnets=properties.subnets | mv-expand subnets | project id, subnetName = subnets.name, subnetPrefix = subnets.properties.addressPrefix | extend subnetPrefixLength = split(subnetPrefix, '/')[1] | where subnetName == 'AzureBastionSubnet' | extend compliant = (subnetPrefixLength <= 26) | distinct id, compliant",
            "guid": "6eab9eb6-762b-485e-8ea8-15aa5dba0bd0",
            "id": "F06.02",
            "link": "https://learn.microsoft.com/azure/bastion/bastion-faq#subnet",
            "severity": "Média",
            "subcategory": "Internet",
            "text": "Use o Bastião do Azure em uma sub-rede /26 ou maior.",
            "waf": "Segurança"
        },
        {
            "ammp": true,
            "category": "Topologia de rede e conectividade",
            "guid": "e6c4cfd3-e504-4547-a244-7ec66138a720",
            "id": "F06.03",
            "link": "https://learn.microsoft.com/azure/app-service/networking-features",
            "severity": "Alto",
            "subcategory": "Internet",
            "text": "Usar o Firewall do Azure para controlar o tráfego de saída do Azure para a Internet, conexões de entrada não HTTP/S e filtragem de tráfego Leste/Oeste (se a organização exigir)",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Segurança"
        },
        {
            "category": "Topologia de rede e conectividade",
            "guid": "5a4b1511-e43a-458a-ac22-99c4d7b57d0c",
            "id": "F06.04",
            "link": "https://learn.microsoft.com/azure/firewall/",
            "severity": "Média",
            "subcategory": "Internet",
            "text": "Crie uma política global do Firewall do Azure para controlar a postura de segurança no ambiente de rede global e atribua-a a todas as instâncias do Firewall do Azure. Permita que as políticas granulares atendam aos requisitos de regiões específicas delegando políticas de firewall incrementais a equipes de segurança locais por meio do controle de acesso baseado em função do Azure.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Segurança"
        },
        {
            "category": "Topologia de rede e conectividade",
            "guid": "655562f2-b3e4-4563-a4d8-739748b662d6",
            "id": "F06.05",
            "link": "https://learn.microsoft.com/azure/firewall/",
            "severity": "Baixo",
            "subcategory": "Internet",
            "text": "Configure provedores de segurança SaaS de parceiros com suporte no Firewall Manager se a organização quiser usar essas soluções para ajudar a proteger conexões de saída.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Segurança"
        },
        {
            "category": "Topologia de rede e conectividade",
            "guid": "1d7aa9b6-4704-4489-a804-2d88e79d17b7",
            "id": "F06.06",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/afds-overview",
            "severity": "Média",
            "subcategory": "Internet",
            "text": "Use as políticas do Azure Front Door e do WAF para fornecer proteção global entre as regiões do Azure para conexões HTTP/S de entrada para uma zona de aterrissagem.",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "Segurança"
        },
        {
            "category": "Topologia de rede e conectividade",
            "guid": "3b22a5a6-7e7a-48ed-9b30-e38c3f29812b",
            "id": "F06.07",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "severity": "Baixo",
            "subcategory": "Internet",
            "text": "Ao usar o Azure Front Door e o Gateway de Aplicativo do Azure para ajudar a proteger aplicativos HTTP/S, use políticas de WAF no Azure Front Door. Bloqueie o Gateway de Aplicativo do Azure para receber tráfego somente do Azure Front Door.",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "Segurança"
        },
        {
            "ammp": true,
            "category": "Topologia de rede e conectividade",
            "guid": "2363cefe-179b-4599-be0d-5973cd4cd21b",
            "id": "F06.08",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "severity": "Alto",
            "subcategory": "Internet",
            "text": "Implantar WAFs e outros proxies reversos são necessários para conexões HTTP/S de entrada, implantá-los em uma rede virtual de zona de aterrissagem e junto com os aplicativos que eles estão protegendo e expondo à Internet.",
            "training": "https://learn.microsoft.com/learn/paths/architect-network-infrastructure/",
            "waf": "Segurança"
        },
        {
            "ammp": true,
            "category": "Topologia de rede e conectividade",
            "guid": "088137f5-e6c4-4cfd-9e50-4547c2447ec6",
            "id": "F06.09",
            "link": "https://learn.microsoft.com/azure/ddos-protection/ddos-protection-reference-architectures",
            "severity": "Alto",
            "subcategory": "Internet",
            "text": "Use os planos de Proteção de IP ou Rede DDoS do Azure para ajudar a proteger os pontos de extremidade de Endereços IP Públicos nas redes virtuais.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Segurança"
        },
        {
            "ammp": true,
            "category": "Topologia de rede e conectividade",
            "graph": "resources | where type=='microsoft.network/firewallpolicies' | extend compliant = (properties.dnsSettings.enableProxy == true) | distinct id,compliant",
            "guid": "14d99880-2f88-47e8-a134-62a7d85c94af",
            "id": "F06.10",
            "link": "https://learn.microsoft.com/azure/firewall/fqdn-filtering-network-rules",
            "severity": "Alto",
            "subcategory": "Internet",
            "text": "Use regras de rede baseadas em FQDN e o Firewall do Azure com proxy DNS para filtrar o tráfego de saída para a Internet em protocolos sem suporte pelas regras de aplicativo.",
            "waf": "Segurança"
        },
        {
            "ammp": true,
            "category": "Topologia de rede e conectividade",
            "graph": "resources | where type=='microsoft.network/firewallpolicies' | extend compliant = (properties.sku.tier == 'Premium') | distinct id,compliant",
            "guid": "c10d51ef-f999-455d-bba0-5c90ece07447",
            "id": "F06.11",
            "link": "https://learn.microsoft.com/azure/firewall/premium-features",
            "severity": "Alto",
            "subcategory": "Internet",
            "text": "Use o Firewall do Azure Premium para segurança e proteção adicionais.",
            "waf": "Segurança"
        },
        {
            "ammp": true,
            "category": "Topologia de rede e conectividade",
            "graph": "resources | where type=='microsoft.network/firewallpolicies' | extend compliant = (properties.threatIntelMode == 'Deny') | distinct id,compliant",
            "guid": "e9c8f584-6d5e-473b-8dc5-acc9fbaab4e3",
            "id": "F06.12",
            "link": "https://learn.microsoft.com/azure/firewall/premium-features",
            "severity": "Alto",
            "subcategory": "Internet",
            "text": "Configure o modo de Inteligência de Ameaças do Firewall do Azure para Alertar e Negar para obter proteção adicional.",
            "waf": "Segurança"
        },
        {
            "ammp": true,
            "category": "Topologia de rede e conectividade",
            "graph": "resources | where type=='microsoft.network/firewallpolicies' | extend compliant = (properties.intrusionDetection.mode == 'Deny') | project id, compliant",
            "guid": "b9d0dff5-bdd4-4cd8-88ed-5811610b2b2c",
            "id": "F06.13",
            "link": "https://learn.microsoft.com/azure/firewall/premium-features#idps",
            "severity": "Alto",
            "subcategory": "Internet",
            "text": "Configure o modo IDPS do Firewall do Azure para Negar para obter proteção adicional.",
            "waf": "Segurança"
        },
        {
            "ammp": true,
            "category": "Topologia de rede e conectividade",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,resourceGroup,name,subnets=properties.subnets | mv-expand subnets | project id,name,subnetId=tostring(subnets.id), subnetName=tostring(subnets.name),subnetRT=subnets.properties.routeTable.id | where not (subnetName in ('GatewaySubnet', 'AzureFirewallSubnet', 'RouteServerSubnet', 'AzureBastionSubnet')) | extend hasRT = isnotnull(subnetRT) | distinct id, hasRT, subnetId | join kind=fullouter (resources | where type == 'microsoft.network/virtualnetworks' | mvexpand properties.virtualNetworkPeerings | extend isVWAN=(tolower(split(properties_virtualNetworkPeerings.name, '_')[0]) == 'remotevnettohubpeering') | mv-expand properties.subnets | project id, isVWAN, name, subnetId=tostring(properties_subnets.id), subnetName=tostring(properties_subnets.name) | summarize PeeredToVWAN=max(isVWAN) by id, subnetId | project id, subnetId, isVWANpeer = (PeeredToVWAN == true)) on subnetId | project id=iff(isnotempty(id), id, id1), subnetId=iff(isnotempty(subnetId), subnetId, subnetId1), hasRT, isVWANpeer | extend compliant = (hasRT==true or isVWANpeer==true) | distinct id, subnetId, compliant",
            "guid": "a3784907-9836-4271-aafc-93535f8ec08b",
            "id": "F06.14",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-networks-udr-overview",
            "severity": "Alto",
            "subcategory": "Internet",
            "text": "Para sub-redes em redes virtuais não conectadas à WAN Virtual, anexe uma tabela de rotas para que o tráfego da Internet seja redirecionado para o Firewall do Azure ou para um Dispositivo Virtual de Rede",
            "waf": "Segurança"
        },
        {
            "ammp": true,
            "category": "Topologia de rede e conectividade",
            "guid": "d301d6e8-72e5-42e3-911c-c58b5a4b1511",
            "id": "F07.01",
            "link": "https://learn.microsoft.com/azure/virtual-network/vnet-integration-for-azure-services",
            "severity": "Alto",
            "subcategory": "Paas",
            "text": "Verifique se a comunicação do plano de controle para os serviços de PaaS do Azure injetados em uma rede virtual não está interrompida, por exemplo, com uma rota 0.0.0.0/0 ou uma regra NSG que bloqueia o tráfego do plano de controle.",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/?source=learn",
            "waf": "Segurança"
        },
        {
            "category": "Topologia de rede e conectividade",
            "guid": "e43a58a9-c229-49c4-b7b5-7d0c655562f2",
            "id": "F07.02",
            "link": "https://learn.microsoft.com/azure/app-service/networking-features",
            "severity": "Média",
            "subcategory": "Paas",
            "text": "Use o Link Privado, quando disponível, para serviços de PaaS compartilhados do Azure.",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "Segurança"
        },
        {
            "category": "Topologia de rede e conectividade",
            "guid": "b3e4563a-4d87-4397-98b6-62d6d15f512a",
            "id": "F07.03",
            "link": "https://learn.microsoft.com/azure/app-service/networking-features",
            "severity": "Média",
            "subcategory": "Paas",
            "text": "Acesse os serviços de PaaS do Azure locais por meio de pontos de extremidade privados e emparelhamento privado da Rota Expressa. Esse método evita o trânsito pela internet pública.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Segurança"
        },
        {
            "category": "Topologia de rede e conectividade",
            "graph": "resources | where type =~ 'microsoft.network/virtualnetworks' | project id,resourceGroup,name,subnets = properties.subnets | mv-expand subnets | project id = subnets.id, resourceGroup, VNet = name, serviceEndpoints = subnets.properties.serviceEndpoints, compliant = (isnull(subnets.properties.serviceEndpoints) or array_length(subnets.properties.serviceEndpoints) == 0) | order by compliant asc",
            "guid": "4704489a-8042-4d88-b79d-17b73b22a5a6",
            "id": "F07.04",
            "link": "https://learn.microsoft.com/azure/app-service/networking-features",
            "severity": "Média",
            "subcategory": "Paas",
            "text": "Não habilite pontos de extremidade de serviço de rede virtual por padrão em todas as sub-redes.",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/?source=learn",
            "waf": "Segurança"
        },
        {
            "category": "Topologia de rede e conectividade",
            "guid": "7e7a8ed4-b30e-438c-9f29-812b2363cefe",
            "id": "F07.05",
            "link": "https://learn.microsoft.com/azure/app-service/networking-features",
            "severity": "Média",
            "subcategory": "Paas",
            "text": "Filtre o tráfego de saída para os serviços de PaaS do Azure usando FQDNs em vez de endereços IP no Firewall do Azure ou em um NVA para impedir a exfiltração de dados. Se estiver usando o Private Link, você poderá bloquear todos os FQDNs, caso contrário, permita apenas os serviços de PaaS necessários.",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/?source=learn",
            "waf": "Segurança"
        },
        {
            "ammp": true,
            "category": "Topologia de rede e conectividade",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,subnets=properties.subnets | mv-expand subnets | project id, subnetName = subnets.name, subnetPrefix = subnets.properties.addressPrefix | extend subnetPrefixLength = split(subnetPrefix, '/')[1] | where subnetName == 'AzureFirewallSubnet' | extend compliant = (subnetPrefixLength == 26) | distinct id, compliant",
            "guid": "22d6419e-b627-4d95-9e7d-019fa759387f",
            "id": "F08.01",
            "link": "https://learn.microsoft.com/azure/firewall/firewall-faq#why-does-azure-firewall-need-a--26-subnet-size",
            "severity": "Alto",
            "subcategory": "Segmentação",
            "text": "Use um prefixo /26 para suas sub-redes do Firewall do Azure.",
            "waf": "Segurança"
        },
        {
            "ammp": true,
            "category": "Topologia de rede e conectividade",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,subnets=properties.subnets | mv-expand subnets | project id, subnetName = subnets.name, subnetPrefix = subnets.properties.addressPrefix | extend subnetPrefixLength = split(subnetPrefix, '/')[1] | where subnetName == 'GatewaySubnet' | extend compliant = (subnetPrefixLength <= 27) | distinct id, compliant",
            "guid": "f2aad7e3-bb03-4adc-8606-4123d342a917",
            "id": "F08.02",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-howto-add-gateway-resource-manager#add-a-gateway",
            "severity": "Alto",
            "subcategory": "Segmentação",
            "text": "Use pelo menos um prefixo /27 para suas sub-redes do Gateway",
            "waf": "Segurança"
        },
        {
            "category": "Topologia de rede e conectividade",
            "graph": "resources | where type=='microsoft.network/networksecuritygroups' | mvexpand properties.securityRules | project id,name,ruleAction=properties_securityRules.properties.access,rulePriority=properties_securityRules.properties.priority,ruleDst=properties_securityRules.properties.destinationAddressPrefix,ruleSrc=properties_securityRules.properties.sourceAddressPrefix,ruleProt=properties_securityRules.properties.protocol,ruleDirection=properties_securityRules.properties.direction,rulePort=properties_securityRules.properties.destinationPortRange | summarize StarDenies=countif(ruleAction=='Deny' and ruleDst=='*' and ruleSrc=='*' and ruleProt=='*' and rulePort=='*') by id,tostring(ruleDirection) | where ruleDirection == 'Inbound' | project id,compliant=(StarDenies>0) | union (resources | where type=='microsoft.network/networksecuritygroups' | where array_length(properties.securityRules)==0 | extend compliant=false | project id,compliant)",
            "guid": "11deb39d-8299-4e47-bbe0-0fb5a36318a8",
            "id": "F08.03",
            "link": "https://learn.microsoft.com/azure/virtual-network/service-tags-overview#available-service-tags",
            "severity": "Média",
            "subcategory": "Segmentação",
            "text": "Não confie nas regras padrão de entrada do NSG usando a marca de serviço VirtualNetwork para limitar a conectividade.",
            "waf": "Segurança"
        },
        {
            "category": "Topologia de rede e conectividade",
            "guid": "c2447ec6-6138-4a72-80f1-ce16ed301d6e",
            "id": "F08.04",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-landing-zone-network-segmentation",
            "severity": "Média",
            "subcategory": "Segmentação",
            "text": "Delegue a criação da sub-rede ao proprietário da zona de aterrissagem. ",
            "training": "https://learn.microsoft.com/learn/paths/implement-resource-mgmt-security/",
            "waf": "Segurança"
        },
        {
            "category": "Topologia de rede e conectividade",
            "guid": "872e52e3-611c-4c58-a5a4-b1511e43a58a",
            "id": "F08.05",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "severity": "Média",
            "subcategory": "Segmentação",
            "text": "Use NSGs para ajudar a proteger o tráfego entre sub-redes, bem como o tráfego leste/oeste através da plataforma (tráfego entre zonas de pouso).",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/",
            "waf": "Segurança"
        },
        {
            "category": "Topologia de rede e conectividade",
            "graph": "Resources | where type=='microsoft.network/virtualnetworks' | project id,resourceGroup,name,subnets=properties.subnets | mv-expand subnets | project id,name,subnetName=subnets.name,subnetNsg=subnets.properties.networkSecurityGroup | where not (subnetName in ('GatewaySubnet', 'AzureFirewallSubnet', 'RouteServerSubnet', 'AzureBastionSubnet')) | extend compliant = isnotnull(subnetNsg)",
            "guid": "9c2299c4-d7b5-47d0-a655-562f2b3e4563",
            "id": "F08.06",
            "severity": "Média",
            "subcategory": "Segmentação",
            "text": "A equipe de aplicativos deve usar grupos de segurança de aplicativos nos NSGs de nível de sub-rede para ajudar a proteger VMs de várias camadas dentro da zona de aterrissagem.",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/",
            "waf": "Segurança"
        },
        {
            "category": "Topologia de rede e conectividade",
            "guid": "a4d87397-48b6-462d-9d15-f512a65498f6",
            "id": "F08.07",
            "link": "https://learn.microsoft.com/azure/virtual-network/network-security-group-how-it-works",
            "severity": "Média",
            "subcategory": "Segmentação",
            "text": "Use NSGs e grupos de segurança de aplicativos para microssegmentar o tráfego dentro da zona de aterrissagem e evite usar um NVA central para filtrar os fluxos de tráfego.",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/",
            "waf": "Segurança"
        },
        {
            "category": "Topologia de rede e conectividade",
            "guid": "dfe237de-143b-416c-91d7-aa9b64704489",
            "id": "F08.08",
            "link": "https://learn.microsoft.com/azure/virtual-network/network-security-group-how-it-works",
            "severity": "Média",
            "subcategory": "Segmentação",
            "text": "Habilite os logs de fluxo NSG e alimente-os na Análise de Tráfego para obter insights sobre fluxos de tráfego internos e externos.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-network-monitoring/",
            "waf": "Segurança"
        },
        {
            "category": "Topologia de rede e conectividade",
            "guid": "412e7f98-3f63-4047-82dd-69c5b5c2622f",
            "id": "F09.01",
            "link": "https://learn.microsoft.com/azure/virtual-wan/scenario-any-to-any",
            "severity": "Média",
            "subcategory": "Virtual WAN",
            "text": "Considere a WAN Virtual para gerenciamento simplificado de rede do Azure e verifique se seu cenário está explicitamente descrito na lista de designs de roteamento de WAN Virtual",
            "training": "https://learn.microsoft.com/learn/modules/introduction-azure-virtual-wan/",
            "waf": "Operações"
        },
        {
            "category": "Topologia de rede e conectividade",
            "guid": "54b69bad-33aa-4d5e-ac68-e1d76667313b",
            "id": "F09.02",
            "link": "https://learn.microsoft.com/azure/virtual-wan/virtual-wan-about",
            "severity": "Média",
            "subcategory": "Virtual WAN",
            "text": "Use um hub de WAN Virtual por região do Azure para conectar várias zonas de aterrissagem entre regiões do Azure por meio de uma WAN Virtual do Azure global comum.",
            "waf": "Desempenho"
        },
        {
            "category": "Topologia de rede e conectividade",
            "guid": "8ac6a9e0-1e6a-483d-b5de-32c199248160",
            "id": "F09.03",
            "link": "https://learn.microsoft.com/azure/virtual-wan/virtual-wan-about",
            "severity": "Baixo",
            "subcategory": "Virtual WAN",
            "text": "Siga o princípio 'o tráfego no Azure permanece no Azure' para que a comunicação entre recursos no Azure ocorra por meio da rede de backbone da Microsoft",
            "waf": "Desempenho"
        },
        {
            "category": "Topologia de rede e conectividade",
            "graph": "resources | where type=='microsoft.network/virtualhubs' | extend compliant = isnotnull(properties.azureFirewall.id) | project id, compliant",
            "guid": "7d5d1e4e-6146-458d-9558-fd77249b8211",
            "id": "F09.04",
            "link": "https://learn.microsoft.com/azure/virtual-wan/virtual-wan-about",
            "severity": "Média",
            "subcategory": "Virtual WAN",
            "text": "Para proteção e filtragem do tráfego de saída da Internet, implante o Firewall do Azure em hubs seguros",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Segurança"
        },
        {
            "category": "Topologia de rede e conectividade",
            "guid": "6667313b-4f56-464b-9e98-4a859c773e7d",
            "id": "F09.05",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits",
            "severity": "Média",
            "subcategory": "Virtual WAN",
            "text": "Verifique se a arquitetura de rede está dentro dos limites da WAN Virtual do Azure.",
            "waf": "Fiabilidade"
        },
        {
            "category": "Topologia de rede e conectividade",
            "guid": "261623a7-65a9-417e-8f34-8ef254c27d42",
            "id": "F09.06",
            "link": "https://learn.microsoft.com/azure/virtual-wan/azure-monitor-insights",
            "severity": "Média",
            "subcategory": "Virtual WAN",
            "text": "Use o Azure Monitor Insights para WAN Virtual para monitorar a topologia de ponta a ponta da WAN Virtual, o status e as principais métricas.",
            "waf": "Operações"
        },
        {
            "category": "Topologia de rede e conectividade",
            "guid": "727c77e1-b9aa-4a37-a024-129d042422c1",
            "id": "F09.07",
            "link": "https://learn.microsoft.com/azure/virtual-wan/virtual-wan-faq#is-branch-to-branch-connectivity-allowed-in-virtual-wan",
            "severity": "Média",
            "subcategory": "Virtual WAN",
            "text": "Certifique-se de que suas implantações de IaC não desabilitem o tráfego de ramificação para filial na WAN Virtual, a menos que esses fluxos devam ser explicitamente bloqueados.",
            "waf": "Fiabilidade"
        },
        {
            "category": "Topologia de rede e conectividade",
            "guid": "d49ac006-6670-4bc9-9948-d3e0a3a94f4d",
            "id": "F09.08",
            "link": "https://learn.microsoft.com/azure/virtual-wan/about-virtual-hub-routing-preference",
            "severity": "Média",
            "subcategory": "Virtual WAN",
            "text": "Use o AS-Path como preferência de roteamento de hub, já que ele é mais flexível do que o ExpressRoute ou o VPN.",
            "waf": "Fiabilidade"
        },
        {
            "category": "Topologia de rede e conectividade",
            "guid": "2586b854-237e-47f1-84a1-d45d4cd2310d",
            "id": "F09.09",
            "link": "https://learn.microsoft.com/azure/virtual-wan/about-virtual-hub-routing#labels",
            "severity": "Média",
            "subcategory": "Virtual WAN",
            "text": "Certifique-se de que suas implantações IaC estejam configurando a propagação baseada em rótulo na WAN Virtual, caso contrário, a conectividade entre hubs virtuais será prejudicada.",
            "waf": "Fiabilidade"
        },
        {
            "ammp": true,
            "category": "Topologia de rede e conectividade",
            "guid": "9c75dfef-573c-461c-a698-68598595581a",
            "id": "F09.10",
            "link": "https://learn.microsoft.com/azure/virtual-wan/virtual-wan-faq#what-is-the-recommended-hub-address-space-during-hub-creation",
            "severity": "Alto",
            "subcategory": "Virtual WAN",
            "text": "Atribua espaço IP suficiente a hubs virtuais, idealmente um prefixo /23.",
            "waf": "Fiabilidade"
        },
        {
            "ammp": true,
            "category": "Topologia de rede e conectividade",
            "guid": "2e30abab-5478-417c-81bf-bf1ad4ed1ed4",
            "id": "G01.01",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-end-to-end-tls",
            "severity": "Alto",
            "subcategory": "Entrega de aplicativos",
            "text": "Use o TLS de ponta a ponta com o Azure Front Door. Use o TLS para conexões de seus clientes com o Front Door e do Front Door com sua origem.",
            "waf": "Segurança"
        },
        {
            "category": "Topologia de rede e conectividade",
            "guid": "10aa45af-166f-44c4-9f36-b6d592dac2ca",
            "id": "G01.02",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-http-to-https-redirection",
            "severity": "Média",
            "subcategory": "Entrega de aplicativos",
            "text": "Use o redirecionamento HTTP para HTTPS com o Azure Front Door. Ofereça suporte a clientes mais antigos redirecionando-os para uma solicitação HTTPS automaticamente.",
            "waf": "Segurança"
        },
        {
            "ammp": true,
            "category": "Topologia de rede e conectividade",
            "guid": "28b9ee82-b2c7-45aa-bc98-6de6f59a095d",
            "id": "G01.03",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#enable-the-waf",
            "severity": "Alto",
            "subcategory": "Entrega de aplicativos",
            "text": "Habilite o WAF do Azure Front Door. Proteja seu aplicativo contra uma série de ataques.",
            "waf": "Segurança"
        },
        {
            "ammp": true,
            "category": "Topologia de rede e conectividade",
            "guid": "2902d8cc-1b0c-4495-afad-624ab70f7bd6",
            "id": "G01.04",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#tune-your-waf",
            "severity": "Alto",
            "subcategory": "Entrega de aplicativos",
            "text": "Ajuste o WAF do Azure Front Door para sua carga de trabalho. Reduza as detecções de falsos positivos.",
            "waf": "Segurança"
        },
        {
            "ammp": true,
            "category": "Topologia de rede e conectividade",
            "guid": "17ba124b-127d-42b6-9322-388d5b2bbcfc",
            "id": "G01.05",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#use-prevention-mode",
            "severity": "Alto",
            "subcategory": "Entrega de aplicativos",
            "text": "Use o modo de prevenção com o WAF do Azure Front Door. O modo de prevenção garante que o WAF bloqueie solicitações maliciosas.",
            "waf": "Segurança"
        },
        {
            "ammp": true,
            "category": "Topologia de rede e conectividade",
            "guid": "49a98f2b-ec22-4a87-9415-6a10b00d6555",
            "id": "G01.06",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#enable-default-rule-sets",
            "severity": "Alto",
            "subcategory": "Entrega de aplicativos",
            "text": "Habilite os conjuntos de regras padrão do WAF do Azure Front Door. Os conjuntos de regras padrão detectam e bloqueiam ataques comuns.",
            "waf": "Segurança"
        },
        {
            "ammp": true,
            "category": "Topologia de rede e conectividade",
            "guid": "147a13d4-2a2f-4824-a524-f5855b52b946",
            "id": "G01.07",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#enable-bot-management-rules",
            "severity": "Alto",
            "subcategory": "Entrega de aplicativos",
            "text": "Habilite as regras de gerenciamento de bot do WAF do Azure Front Door. As regras de bot detectam bots bons e ruins.",
            "waf": "Segurança"
        },
        {
            "category": "Topologia de rede e conectividade",
            "guid": "d7dcdcb9-0d99-44b9-baab-ac7570ede79a",
            "id": "G01.08",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#use-the-latest-ruleset-versions",
            "severity": "Média",
            "subcategory": "Entrega de aplicativos",
            "text": "Use as versões mais recentes do conjunto de regras do WAF do Azure Front Door. As atualizações do conjunto de regras são atualizadas regularmente para levar em conta o cenário atual de ameaças.",
            "waf": "Segurança"
        },
        {
            "category": "Topologia de rede e conectividade",
            "guid": "b9620385-1cde-418f-914b-a84a06982ffc",
            "id": "G01.09",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#add-rate-limiting",
            "severity": "Média",
            "subcategory": "Entrega de aplicativos",
            "text": "Adicione o limite de taxa ao WAF do Azure Front Door. A limitação de taxa bloqueia clientes que enviam acidentalmente ou intencionalmente grandes quantidades de tráfego em um curto período de tempo.",
            "waf": "Segurança"
        },
        {
            "category": "Topologia de rede e conectividade",
            "guid": "6dc36c52-0124-4ffe-9eaf-23ec1282dedb",
            "id": "G01.10",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#use-a-high-threshold-for-rate-limits",
            "severity": "Média",
            "subcategory": "Entrega de aplicativos",
            "text": "Use um limite alto para os limites de taxa do WAF do Azure Front Door. Limites de limite de taxa alta evitam o bloqueio de tráfego legítimo, ao mesmo tempo em que fornecem proteção contra um número extremamente alto de solicitações que podem sobrecarregar sua infraestrutura. ",
            "waf": "Segurança"
        },
        {
            "category": "Topologia de rede e conectividade",
            "guid": "388a3d0e-0a43-4367-90b2-3dd2aeece5ee",
            "id": "G01.11",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#geo-filter-traffic",
            "severity": "Baixo",
            "subcategory": "Entrega de aplicativos",
            "text": "Filtre geograficamente o tráfego usando o WAF do Azure Front Door. Permita o tráfego apenas de regiões esperadas e bloqueie o tráfego de outras regiões.",
            "waf": "Segurança"
        },
        {
            "category": "Topologia de rede e conectividade",
            "guid": "00acd8a9-6975-414f-8491-2be6309893b8",
            "id": "G01.12",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#specify-the-unknown-zz-location",
            "severity": "Média",
            "subcategory": "Entrega de aplicativos",
            "text": "Especifique o local desconhecido (ZZ) ao filtrar geograficamente o tráfego com o WAF do Azure Front Door. Evite bloquear acidentalmente solicitações legítimas quando os endereços IP não puderem ser correspondidos geograficamente.",
            "waf": "Segurança"
        },
        {
            "ammp": true,
            "category": "Automação de Plataforma e DevOps",
            "guid": "e85f4226-bf06-4e35-8a8b-7aee4d2d633a",
            "id": "H01.01",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/platform-automation-devops",
            "severity": "Alto",
            "subcategory": "Topologias de equipe de DevOps",
            "text": "Verifique se você tem uma equipe de plataforma de DevOps multifuncional para criar, gerenciar e manter sua arquitetura de zona de aterrissagem do Azure.",
            "waf": "Operações"
        },
        {
            "category": "Automação de Plataforma e DevOps",
            "guid": "634146bf-7085-4419-a7b5-f96d2726f6da",
            "id": "H01.02",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/devops-teams-topologies#design-recommendations",
            "severity": "Baixo",
            "subcategory": "Topologias de equipe de DevOps",
            "text": "Objetivo de definir funções para a equipe da Plataforma de Zona de Aterrissagem do Azure.",
            "waf": "Operações"
        },
        {
            "category": "Automação de Plataforma e DevOps",
            "guid": "a9e65070-c59e-4112-8bf6-c11364d4a2a5",
            "id": "H01.03",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/devops-teams-topologies#design-recommendations",
            "severity": "Baixo",
            "subcategory": "Topologias de equipe de DevOps",
            "text": "Objetivo de definir funções para que as equipes de carga de trabalho de aplicativos sejam autossuficientes e não exijam suporte da equipe da plataforma DevOps. Consiga isso por meio do uso da função RBAC personalizada.",
            "waf": "Operações"
        },
        {
            "ammp": true,
            "category": "Automação de Plataforma e DevOps",
            "guid": "165eb5e9-b434-448a-9e24-178632186212",
            "id": "H01.04",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/infrastructure-as-code",
            "severity": "Alto",
            "subcategory": "Topologias de equipe de DevOps",
            "text": "Use um pipeline de CI/CD para implantar artefatos IaC e garantir a qualidade de sua implantação e ambientes do Azure.",
            "waf": "Operações"
        },
        {
            "category": "Automação de Plataforma e DevOps",
            "guid": "0cadb8c7-8fa5-4fbf-8f39-d1fadb3b0460",
            "id": "H01.05",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/development-strategy-development-lifecycle#automated-builds",
            "severity": "Média",
            "subcategory": "Topologias de equipe de DevOps",
            "text": "Inclua testes de unidade para IaC e código de aplicativo como parte do processo de compilação.",
            "waf": "Operações"
        },
        {
            "ammp": true,
            "category": "Automação de Plataforma e DevOps",
            "guid": "108d5099-a11d-4445-bd8b-e12a5e95412e",
            "id": "H01.06",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/development-strategy-development-lifecycle#automated-builds",
            "severity": "Alto",
            "subcategory": "Topologias de equipe de DevOps",
            "text": "Use segredos do Cofre de Chaves para evitar a codificação de informações confidenciais, como credenciais (máquinas virtuais, senhas de usuário), certificados ou chaves.",
            "waf": "Operações"
        },
        {
            "category": "Automação de Plataforma e DevOps",
            "guid": "a52e0c98-76b9-4a09-a1c9-6b2babf22ac4",
            "id": "H01.07",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/subscription-vending",
            "severity": "Baixo",
            "subcategory": "Topologias de equipe de DevOps",
            "text": "Implemente a automação para File > New > Landing Zone para aplicativos e cargas de trabalho.",
            "waf": "Operações"
        },
        {
            "ammp": true,
            "category": "Automação de Plataforma e DevOps",
            "guid": "cfe363b5-f579-4284-bc56-a42153e4c10b",
            "id": "H02.01",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/infrastructure-as-code",
            "severity": "Alto",
            "subcategory": "Ciclo de vida do desenvolvimento",
            "text": "Garantir que um sistema de controle de versão seja utilizado para o código-fonte das aplicações e IaC desenvolvido. A Microsoft recomenda o Git.",
            "waf": "Operações"
        },
        {
            "category": "Automação de Plataforma e DevOps",
            "guid": "c7245dd4-af8a-403a-8bb7-890c1a7cfa9d",
            "id": "H02.02",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/development-strategy-development-lifecycle",
            "severity": "Baixo",
            "subcategory": "Ciclo de vida do desenvolvimento",
            "text": "Siga uma estratégia de ramificação para permitir que as equipes colaborem melhor e gerenciem com eficiência o controle de versão do IaC e do código do aplicativo. Revise opções como o Github Flow.",
            "waf": "Operações"
        },
        {
            "category": "Automação de Plataforma e DevOps",
            "guid": "12aeea20-9165-4b3e-bdf2-6795fcd3cdbe",
            "id": "H02.03",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/development-strategy-development-lifecycle",
            "severity": "Média",
            "subcategory": "Ciclo de vida do desenvolvimento",
            "text": "Adote uma estratégia de solicitação pull para ajudar a manter o controle das alterações de código mescladas em ramificações.",
            "waf": "Operações"
        },
        {
            "ammp": true,
            "category": "Automação de Plataforma e DevOps",
            "guid": "2cdc9d99-dbcc-4ad4-97f5-e7d358bdfa73",
            "id": "H03.01",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/infrastructure-as-code",
            "severity": "Alto",
            "subcategory": "Estratégia de Desenvolvimento",
            "text": "Aproveite a Infraestrutura Declarativa como Ferramentas de Código, como o Azure Bicep, Modelos ARM ou Terraform para criar e manter sua arquitetura de Zona de Aterrissagem do Azure. Tanto do ponto de vista da carga de trabalho da plataforma quanto do aplicativo.",
            "waf": "Operações"
        },
        {
            "ammp": true,
            "category": "Automação de Plataforma e DevOps",
            "guid": "cc87a3bc-c572-4ad2-92ed-8cabab66160f",
            "id": "H04.01",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/landing-zone-security#secure",
            "severity": "Alto",
            "subcategory": "Segurança",
            "text": " Integre a segurança ao processo já combinado de desenvolvimento e operações em DevOps para mitigar riscos no processo de inovação.",
            "waf": "Operações"
        },
        {
            "ammp": true,
            "category": "Organização de Recursos",
            "guid": "cacf55bc-e4e4-46be-96bc-57a5f23a269a",
            "id": "I01.01",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/resource-naming",
            "severity": "Alto",
            "subcategory": "Nomeação e marcação",
            "text": "Recomenda-se seguir os padrões de nomenclatura de práticas recomendadas da Microsoft",
            "waf": "Segurança"
        },
        {
            "category": "Organização de Recursos",
            "graph": "resourcecontainers| where type == 'microsoft.resources/subscriptions'| extend ManagementGroup = tostring(tags),mgmtChain = properties.managementGroupAncestorsChain| extend compliant =( array_length(mgmtChain) <= 4 and array_length(mgmtChain) > 1)",
            "guid": "2df27ee4-12e7-4f98-9f63-04722dd69c5b",
            "id": "I02.01",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/resource-org-management-groups",
            "severity": "Média",
            "subcategory": "Assinaturas",
            "text": "Impor hierarquia de grupo de gerenciamento razoavelmente simples com no máximo quatro níveis.",
            "training": "https://learn.microsoft.com/learn/modules/azure-architecture-fundamentals/",
            "waf": "Segurança"
        },
        {
            "category": "Organização de Recursos",
            "graph": "resources | extend compliant = isnotnull(['tags']) | project name, id, subscriptionId, resourceGroup, tags, compliant",
            "guid": "5c2622f5-4b69-4bad-93aa-d5e8c68e1d76",
            "id": "I02.02",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/decision-guides/resource-tagging/?toc=/azure/azure-resource-manager/management/toc.json",
            "severity": "Média",
            "subcategory": "Assinaturas",
            "text": "Impor ou acrescentar marcas de recurso por meio da Política do Azure",
            "training": "https://learn.microsoft.com/learn/paths/implement-resource-mgmt-security/",
            "waf": "Segurança"
        },
        {
            "category": "Organização de Recursos",
            "guid": "667313b4-f566-44b5-b984-a859c773e7d2",
            "id": "I02.03",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/resource-org-management-groups#management-group-recommendations",
            "severity": "Média",
            "subcategory": "Assinaturas",
            "text": "Impor um grupo de gerenciamento de área restrita para permitir que os usuários experimentem imediatamente o Azure",
            "training": "https://learn.microsoft.com/learn/paths/enterprise-scale-architecture/",
            "waf": "Segurança"
        },
        {
            "category": "Organização de Recursos",
            "guid": "61623a76-5a91-47e1-b348-ef254c27d42e",
            "id": "I02.04",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/resource-org-management-groups#management-group-recommendations",
            "severity": "Média",
            "subcategory": "Assinaturas",
            "text": "Impor um grupo de gerenciamento de plataforma sob o grupo de gerenciamento raiz para dar suporte à política de plataforma comum e à atribuição de função do Azure",
            "training": "https://learn.microsoft.com/learn/paths/enterprise-scale-architecture/",
            "waf": "Segurança"
        },
        {
            "category": "Organização de Recursos",
            "guid": "8bbac757-1559-4ab9-853e-8908ae28c84c",
            "id": "I02.05",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/resource-org-management-groups#management-group-recommendations",
            "severity": "Média",
            "subcategory": "Assinaturas",
            "text": "Aplique uma assinatura de conectividade dedicada no grupo de gerenciamento da Plataforma para hospedar um hub de WAN Virtual do Azure, DNS (Sistema de Nomes de Domínio) privado, circuito de Rota Expressa e outros recursos de rede.",
            "training": "https://learn.microsoft.com/learn/paths/enterprise-scale-architecture/",
            "waf": "Segurança"
        },
        {
            "category": "Organização de Recursos",
            "graph": "resourcecontainers| where type == 'microsoft.resources/subscriptions'| extend ManagementGroup = tostring(tags),mgmtChain = properties.managementGroupAncestorsChain| extend compliant = (array_length(mgmtChain) > 1)",
            "guid": "33b6b780-8b9f-4e5c-9104-9d403a923c34",
            "id": "I02.06",
            "link": "https://learn.microsoft.com/azure/governance/management-groups/how-to/protect-resource-hierarchy#setting---default-management-group",
            "severity": "Média",
            "subcategory": "Assinaturas",
            "text": "Impor que nenhuma assinatura seja colocada no grupo de gerenciamento raiz",
            "waf": "Segurança"
        },
        {
            "category": "Organização de Recursos",
            "guid": "74d00018-ac6a-49e0-8e6a-83de5de32c19",
            "id": "I02.07",
            "link": "https://learn.microsoft.com/azure/governance/management-groups/how-to/protect-resource-hierarchy#setting---require-authorization",
            "severity": "Média",
            "subcategory": "Assinaturas",
            "text": "Impor que apenas usuários privilegiados possam operar grupos de gerenciamento no locatário habilitando a autorização RBAC do Azure nas configurações de hierarquia do grupo de gerenciamento",
            "waf": "Segurança"
        },
        {
            "category": "Organização de Recursos",
            "guid": "92481607-d5d1-4e4e-9146-58d3558fd772",
            "id": "I02.08",
            "link": "https://learn.microsoft.com/azure/governance/management-groups/overview",
            "severity": "Média",
            "subcategory": "Assinaturas",
            "text": "Aplique grupos de gerenciamento sob o grupo de gerenciamento de nível raiz para representar os tipos de cargas de trabalho, com base em suas necessidades de segurança, conformidade, conectividade e recursos.",
            "waf": "Segurança"
        },
        {
            "ammp": true,
            "category": "Organização de Recursos",
            "guid": "49b82111-2df2-47ee-912e-7f983f630472",
            "id": "I02.09",
            "link": "https://learn.microsoft.com/azure/governance/management-groups/overview",
            "severity": "Alto",
            "subcategory": "Assinaturas",
            "text": "Aplique um processo para conscientizar os proprietários de recursos sobre suas funções e responsabilidades, acessar a revisão, revisar o orçamento, a conformidade com a política e corrigir quando necessário.",
            "waf": "Segurança"
        },
        {
            "category": "Organização de Recursos",
            "guid": "2dd69c5b-5c26-422f-94b6-9bad33aad5e8",
            "id": "I02.10",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits",
            "severity": "Média",
            "subcategory": "Assinaturas",
            "text": "Certifique-se de que todos os proprietários de assinatura e a equipe principal de TI estejam cientes das limitações de recursos de assinatura como parte das sessões de design de carga de trabalho.",
            "waf": "Segurança"
        },
        {
            "ammp": true,
            "category": "Organização de Recursos",
            "guid": "c68e1d76-6673-413b-9f56-64b5e984a859",
            "id": "I02.11",
            "link": "https://learn.microsoft.com/azure/cost-management-billing/reservations/save-compute-costs-reservations",
            "severity": "Alto",
            "subcategory": "Assinaturas",
            "text": "Use instâncias reservadas quando apropriado para otimizar o custo e garantir a capacidade disponível nas regiões de destino. Imponha o uso de SKUs de VM de Instância Reservada compradas por meio da Política do Azure.",
            "training": "https://learn.microsoft.com/learn/paths/improve-reliability-modern-operations/",
            "waf": "Segurança"
        },
        {
            "ammp": true,
            "category": "Organização de Recursos",
            "guid": "c773e7d2-6162-43a7-95a9-17e1f348ef25",
            "id": "I02.12",
            "link": "https://learn.microsoft.com/azure/architecture/framework/scalability/design-capacity",
            "severity": "Alto",
            "subcategory": "Assinaturas",
            "text": "Impor um painel, pasta de trabalho ou processo manual para monitorar os níveis de capacidade usados",
            "training": "https://learn.microsoft.com/learn/paths/monitor-usage-performance-availability-resources-azure-monitor/",
            "waf": "Segurança"
        },
        {
            "category": "Organização de Recursos",
            "guid": "4c27d42e-8bba-4c75-9155-9ab9153e8908",
            "id": "I02.13",
            "link": "https://azure.microsoft.com/global-infrastructure/services/",
            "severity": "Média",
            "subcategory": "Assinaturas",
            "text": "Verifique se os serviços e recursos necessários estão disponíveis nas regiões de implantação escolhidas",
            "training": "https://learn.microsoft.com/learn/modules/azure-architecture-fundamentals/",
            "waf": "Segurança"
        },
        {
            "ammp": true,
            "category": "Organização de Recursos",
            "guid": "ae28c84c-33b6-4b78-88b9-fe5c41049d40",
            "id": "I02.14",
            "link": "https://learn.microsoft.com/azure/cost-management-billing/cost-management-billing-overview",
            "severity": "Alto",
            "subcategory": "Assinaturas",
            "text": "Impor um processo para gerenciamento de custos",
            "training": "https://learn.microsoft.com/learn/paths/control-spending-manage-bills/",
            "waf": "Segurança"
        },
        {
            "category": "Organização de Recursos",
            "guid": "3a923c34-74d0-4001-aac6-a9e01e6a83de",
            "id": "I02.15",
            "link": "https://learn.microsoft.com/azure/governance/management-groups/overview",
            "severity": "Média",
            "subcategory": "Assinaturas",
            "text": "Se AD no Windows Server, estabeleça uma assinatura de identidade dedicada no grupo de gerenciamento de plataforma para hospedar controladores de domínio do Active Directory do Windows Server",
            "training": "https://learn.microsoft.com/learn/paths/enterprise-scale-architecture/",
            "waf": "Segurança"
        },
        {
            "category": "Organização de Recursos",
            "graph": "resources | extend compliant = isnotnull(['tags']) | project name, id, subscriptionId, resourceGroup, tags, compliant",
            "guid": "5de32c19-9248-4160-9d5d-1e4e614658d3",
            "id": "I02.16",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/track-costs",
            "severity": "Média",
            "subcategory": "Assinaturas",
            "text": "Garantir que as tags sejam usadas para faturamento e gerenciamento de custos",
            "training": "https://learn.microsoft.com/learn/paths/implement-resource-mgmt-security/",
            "waf": "Segurança"
        },
        {
            "category": "Segurança",
            "guid": "b86ad884-08e3-4727-94b8-75ba18f20459",
            "id": "J01.01",
            "link": "https://learn.microsoft.com/security/benchmark/azure/security-control-incident-response",
            "severity": "Média",
            "subcategory": "Controle de acesso",
            "text": "Determine o plano de resposta a incidentes para os serviços do Azure antes de permitir que ele entre em produção.",
            "waf": "Segurança"
        },
        {
            "category": "Segurança",
            "guid": "01365d38-e43f-49cc-ad86-8266abca264f",
            "id": "J01.02",
            "link": "https://www.microsoft.com/security/business/zero-trust",
            "severity": "Média",
            "subcategory": "Controle de acesso",
            "text": "Implemente uma abordagem de confiança zero para acesso à plataforma Azure, quando apropriado.",
            "waf": "Segurança"
        },
        {
            "ammp": true,
            "category": "Segurança",
            "guid": "5017f154-e3ab-4369-9829-e7e316183687",
            "id": "J02.01",
            "link": "https://learn.microsoft.com/azure/key-vault/general/overview",
            "severity": "Alto",
            "subcategory": "Criptografia e chaves",
            "text": "Usar o Cofre de Chaves do Azure para armazenar seus segredos e credenciais",
            "waf": "Segurança"
        },
        {
            "category": "Segurança",
            "graph": "ResourceContainers | where type=='microsoft.resources/subscriptions'| parse id with '/subscriptions/' SubscriptionID| project subscriptionId, SubscriptionName = name| join kind=leftouter (Resources| where type == 'microsoft.keyvault/vaults'| project id, name, subscriptionId) on subscriptionId| join kind= leftouter (Resources| where type == 'microsoft.keyvault/vaults'| summarize ResourceCount = count() by subscriptionId) on subscriptionId| extend RCount = iff(isnull(ResourceCount), 0, ResourceCount)| project-away ResourceCount| extend compliant = (RCount <> 1)",
            "guid": "a0477a20-9945-4bda-9333-4f2491163418",
            "id": "J02.02",
            "link": "https://learn.microsoft.com/azure/key-vault/general/overview-throttling",
            "severity": "Média",
            "subcategory": "Criptografia e chaves",
            "text": "Use diferentes Cofres de Chaves do Azure para diferentes aplicativos e regiões para evitar limites de escala de transação e restringir o acesso a segredos.",
            "waf": "Segurança"
        },
        {
            "category": "Segurança",
            "guid": "2ba52752-6944-4008-ae7d-7e4843276d8b",
            "id": "J02.03",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "severity": "Média",
            "subcategory": "Criptografia e chaves",
            "text": "Provisione o Cofre de Chaves do Azure com as políticas de exclusão e limpeza suaves habilitadas para permitir a proteção de retenção para objetos excluídos.",
            "waf": "Segurança"
        },
        {
            "category": "Segurança",
            "guid": "dc055bcf-619e-48a1-9f98-879525d62688",
            "id": "J02.04",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "severity": "Média",
            "subcategory": "Criptografia e chaves",
            "text": "Siga um modelo de privilégios mínimos limitando a autorização para excluir permanentemente chaves, segredos e certificados para funções personalizadas especializadas do Azure Active Directory (Azure AD).",
            "waf": "Segurança"
        },
        {
            "category": "Segurança",
            "guid": "6d70ba6c-97be-4995-8904-83845c986cb2",
            "id": "J02.05",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "severity": "Média",
            "subcategory": "Criptografia e chaves",
            "text": "Automatize o processo de gerenciamento e renovação de certificados com autoridades de certificação públicas para facilitar a administração.",
            "waf": "Segurança"
        },
        {
            "category": "Segurança",
            "guid": "913156a1-2476-4e49-b541-acdce979377b",
            "id": "J02.06",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "severity": "Média",
            "subcategory": "Criptografia e chaves",
            "text": "Estabeleça um processo automatizado para rotação de chaves e certificados.",
            "waf": "Segurança"
        },
        {
            "category": "Segurança",
            "guid": "cdb3751a-b2ab-413a-ba6e-55d7d8a2adb1",
            "id": "J02.07",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "severity": "Média",
            "subcategory": "Criptografia e chaves",
            "text": "Habilite o firewall e o ponto de extremidade do serviço de rede virtual ou o ponto de extremidade privado no cofre para controlar o acesso ao cofre de chaves.",
            "waf": "Segurança"
        },
        {
            "category": "Segurança",
            "guid": "17d6326a-f625-4ca4-9e56-95f2223ace8c",
            "id": "J02.08",
            "link": "https://learn.microsoft.com/azure/key-vault/general/monitor-key-vault",
            "severity": "Média",
            "subcategory": "Criptografia e chaves",
            "text": "Use o espaço de trabalho central do Azure Monitor Log Analytics para auditar o uso de chaves, certificados e segredos em cada instância do Cofre de Chaves.",
            "waf": "Segurança"
        },
        {
            "category": "Segurança",
            "guid": "b12308ca-5017-4f15-9e3a-b3693829e7e3",
            "id": "J02.09",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "severity": "Média",
            "subcategory": "Criptografia e chaves",
            "text": "Delegue instanciação do Cofre da Chave e acesso privilegiado e use a Política do Azure para impor uma configuração consistente e compatível.",
            "waf": "Segurança"
        },
        {
            "category": "Segurança",
            "guid": "16183687-a047-47a2-8994-5bda43334f24",
            "id": "J02.10",
            "link": "https://learn.microsoft.com/azure/security/fundamentals/encryption-atrest",
            "severity": "Média",
            "subcategory": "Criptografia e chaves",
            "text": "O padrão é chaves gerenciadas pela Microsoft para a funcionalidade de criptografia principal e use chaves gerenciadas pelo cliente quando necessário.",
            "waf": "Segurança"
        },
        {
            "category": "Segurança",
            "guid": "91163418-2ba5-4275-8694-4008be7d7e48",
            "id": "J02.11",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "severity": "Média",
            "subcategory": "Criptografia e chaves",
            "text": "Use um Cofre de Chaves do Azure por aplicativo, por ambiente, por região.",
            "waf": "Segurança"
        },
        {
            "category": "Segurança",
            "guid": "25d62688-6d70-4ba6-a97b-e99519048384",
            "id": "J02.12",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "severity": "Média",
            "subcategory": "Criptografia e chaves",
            "text": "Se você quiser trazer suas próprias chaves, isso pode não ser suportado em todos os serviços considerados. Implemente mitigações relevantes para que as inconsistências não prejudiquem os resultados desejados. Escolha pares de regiões apropriados e regiões de recuperação de desastres que minimizem a latência.",
            "waf": "Segurança"
        },
        {
            "category": "Segurança",
            "guid": "4e5695f2-223a-4ce8-ab12-308ca5017f15",
            "id": "J03.01",
            "link": "https://learn.microsoft.com/azure/active-directory/reports-monitoring/overview-reports",
            "severity": "Média",
            "subcategory": "Operações",
            "text": "Use os recursos de relatórios do Azure AD para gerar relatórios de auditoria de controle de acesso.",
            "waf": "Segurança"
        },
        {
            "category": "Segurança",
            "guid": "4e3ab369-3829-4e7e-9161-83687a0477a2",
            "id": "J03.02",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/logs-data-export?tabs=portal",
            "severity": "Média",
            "subcategory": "Operações",
            "text": "Exporte logs de atividade do Azure para os Logs do Monitor do Azure para retenção de dados de longo prazo. Exporte para o Armazenamento do Azure para armazenamento de longo prazo além de dois anos, se necessário.",
            "waf": "Segurança"
        },
        {
            "ammp": true,
            "category": "Segurança",
            "guid": "09945bda-4333-44f2-9911-634182ba5275",
            "id": "J03.03",
            "link": "https://learn.microsoft.com/azure/defender-for-cloud/concept-cloud-security-posture-management",
            "severity": "Alto",
            "subcategory": "Operações",
            "text": "Habilite o Defender Cloud Security Posture Management para todas as assinaturas.",
            "waf": "Segurança"
        },
        {
            "ammp": true,
            "category": "Segurança",
            "guid": "36a72a48-fffe-4c40-9747-0ab5064355ba",
            "id": "J03.04",
            "link": "https://learn.microsoft.com/azure/defender-for-cloud/plan-defender-for-servers-select-plan",
            "severity": "Alto",
            "subcategory": "Operações",
            "text": "Habilite um Plano de Proteção de Carga de Trabalho do Defender Cloud para Servidores em todas as assinaturas.",
            "waf": "Segurança"
        },
        {
            "ammp": true,
            "category": "Segurança",
            "guid": "77425f48-ecba-43a0-aeac-a3ac733ccc6a",
            "id": "J03.05",
            "link": "https://www.microsoft.com/en-gb/security/business/solutions/cloud-workload-protection",
            "severity": "Alto",
            "subcategory": "Operações",
            "text": "Habilite os Planos de Proteção de Carga de Trabalho do Defender Cloud para Recursos do Azure em todas as assinaturas.",
            "waf": "Segurança"
        },
        {
            "ammp": true,
            "category": "Segurança",
            "guid": "24d96b30-61ee-4436-a1cc-d6ef08bc574b",
            "id": "J03.06",
            "link": "https://learn.microsoft.com/mem/configmgr/protect/deploy-use/endpoint-protection",
            "severity": "Alto",
            "subcategory": "Operações",
            "text": "Habilite o Endpoint Protection em servidores IaaS.",
            "waf": "Segurança"
        },
        {
            "category": "Segurança",
            "guid": "15833ee7-ad6c-46d3-9331-65c7acbe44ab",
            "id": "J03.07",
            "link": "https://learn.microsoft.com/azure/security-center/",
            "severity": "Média",
            "subcategory": "Operações",
            "text": "Monitore o desvio de patches do sistema operacional base por meio do Azure Monitor Logs e do Defender for Cloud.",
            "waf": "Segurança"
        },
        {
            "category": "Segurança",
            "guid": "e5f8d79f-2e87-4768-924c-516775c6ea95",
            "id": "J03.08",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/design-logs-deployment",
            "severity": "Média",
            "subcategory": "Operações",
            "text": "Conecte configurações de recursos padrão a um espaço de trabalho centralizado do Azure Monitor Log Analytics.",
            "waf": "Segurança"
        },
        {
            "ammp": true,
            "category": "Segurança",
            "guid": "b03ed428-4617-4067-a787-85468b9ccf3f",
            "id": "J04.01",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-require-secure-transfer",
            "severity": "Alto",
            "subcategory": "Visão geral",
            "text": "A transferência segura para contas de armazenamento deve ser habilitada",
            "waf": "Segurança"
        },
        {
            "ammp": true,
            "category": "Segurança",
            "guid": "159aac9f-863f-4f48-82cf-00c28fa97a0e",
            "id": "J04.02",
            "link": "https://learn.microsoft.com/azure/storage/blobs/data-protection-overview#recommendations-for-basic-data-protection",
            "severity": "Alto",
            "subcategory": "Visão geral",
            "text": "Habilite a exclusão flexível do contêiner para que a conta de armazenamento recupere um contêiner excluído e seu conteúdo.",
            "waf": "Segurança"
        },
        {
            "ammp": true,
            "category": "Segurança",
            "guid": "6f704104-85c1-441f-96d3-c9819911645e",
            "id": "J05.01",
            "link": "https://learn.microsoft.com/azure/active-directory/roles/security-planning",
            "severity": "Alto",
            "subcategory": "Acesso privilegiado seguro",
            "text": "Separe contas de administrador privadas para tarefas administrativas do Azure.",
            "waf": "Segurança"
        },
        {
            "category": "Segurança",
            "guid": "9a19bf39-c95d-444c-9c89-19ca1f6d5215",
            "id": "J06.01",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/service-enablement-framework",
            "severity": "Média",
            "subcategory": "Estrutura de habilitação de serviço",
            "text": "Planejar como os novos serviços do azure serão implementados",
            "waf": "Segurança"
        },
        {
            "category": "Segurança",
            "guid": "ae514b93-3d45-485e-8112-9bd7ba012f7b",
            "id": "J06.02",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/service-enablement-framework",
            "severity": "Média",
            "subcategory": "Estrutura de habilitação de serviço",
            "text": "Planejar como a solicitação de serviço será atendida para os serviços do Azure",
            "waf": "Segurança"
        }
    ],
    "metadata": {
        "name": "Azure Landing Zone Review",
        "state": "GA",
        "timestamp": "September 19, 2023"
    },
    "severities": [
        {
            "name": "Alto"
        },
        {
            "name": "Média"
        },
        {
            "name": "Baixo"
        }
    ],
    "status": [
        {
            "description": "Esta verificação ainda não foi analisada",
            "name": "Não verificado"
        },
        {
            "description": "Há um item de ação associado a essa verificação",
            "name": "Abrir"
        },
        {
            "description": "Essa verificação foi verificada e não há outros itens de ação associados a ela",
            "name": "Cumprido"
        },
        {
            "description": "Recomendação compreendida, mas não necessária pelos requisitos atuais",
            "name": "Não é necessário"
        },
        {
            "description": "Não aplicável ao projeto atual",
            "name": "N/A"
        }
    ],
    "waf": [
        {
            "name": "Fiabilidade"
        },
        {
            "name": "Segurança"
        },
        {
            "name": "Custar"
        },
        {
            "name": "Operações"
        },
        {
            "name": "Desempenho"
        }
    ],
    "yesno": [
        {
            "name": "Sim"
        },
        {
            "name": "Não"
        }
    ]
}
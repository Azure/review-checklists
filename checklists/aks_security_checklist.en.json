{
    "items": [
      {
        "category": "Security",
        "subcategory": "HA/BCDR",
        "text": "Use Availability Zones if they are supported in your Azure region",
        "guid": "578a219a-46be-4b54-9350-24922634292b",
        "ha": 1,
        "severity": "Medium",
        "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant= isnotnull(zones) | distinct id,compliant",
        "link": "https://docs.microsoft.com/azure/aks/availability-zones"
      },
      {
        "category": "Security",
        "subcategory": "HA/BCDR",
        "text": "Use the SLA-backed AKS offering",
        "guid": "71d41e36-10cc-457b-9a4b-1410d4395898",
        "cost": -2,
        "ha": 2,
        "severity": "High",
        "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (sku.tier=='Paid') | distinct id,compliant",
        "link": "https://docs.microsoft.com/azure/aks/uptime-sla"
      },
      {
        "category": "Security",
        "subcategory": "HA/BCDR",
        "text": "Use Disruption Budgets in your pod and deployment definitions",
        "guid": "c1288b3c-6a57-4cfc-9444-51e1a3d3453a",
        "simple": -1,
        "ha": 1,
        "severity": "Low",
        "link": "https://docs.microsoft.com/azure/aks/operator-best-practices-scheduler"
      },
      {
        "category": "Security",
        "subcategory": "Identity and Access",
        "text": "Use managed identities instead of Service Principals",
        "guid": "ed127dd1-42b0-46b2-8c69-99a646f3389a",
        "simple": 1,
        "severity": "High",
        "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (properties.servicePrincipalProfile.clientId=='msi') | distinct id,compliant",
        "link": "https://docs.microsoft.com/azure/aks/use-managed-identity"
      },
      {
        "category": "Security",
        "subcategory": "Identity and Access",
        "text": "Integrate authentication with AAD (using the managed integration)",
        "guid": "7e42c78e-78c0-46a6-8a21-94956e698dc4",
        "simple": 1,
        "severity": "Medium",
        "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = isnotnull(properties.aadProfile) | distinct id,compliant",
        "link": "https://docs.microsoft.com/azure/aks/managed-aad"
      },
      {
        "category": "Security",
        "subcategory": "Identity and Access",
        "text": "Limit access to admin kubeconfig (get-credentials --admin)",
        "guid": "a2fe27b2-e287-401a-8352-beedf79b488d",
        "security": 1,
        "simple": -1,
        "severity": "Medium",
        "link": "https://docs.microsoft.com/azure/aks/control-kubeconfig-access"
      },
      {
        "category": "Security",
        "subcategory": "Identity and Access",
        "text": "Integrate authorization with AAD RBAC",
        "guid": "eec4962c-c3bd-421b-b77f-26e5e6b3bec3",
        "security": 1,
        "simple": -1,
        "severity": "Medium",
        "link": "https://docs.microsoft.com/azure/aks/manage-azure-rbac"
      },
      {
        "category": "Security",
        "subcategory": "Identity and Access",
        "text": "Use namespaces for restricting RBAC privilege in Kubernetes",
        "guid": "d4f3537c-1346-4dc5-9027-a71ffe1bd05d",
        "security": 1,
        "simple": -1,
        "ha": 1,
        "severity": "High",
        "link": "https://docs.microsoft.com/azure/aks/operator-best-practices-identity"
      },
      {
        "category": "Security",
        "subcategory": "Identity and Access",
        "text": "For POD Identity Access Management use Azure AD Workload Identity (preview)",
        "guid": "d2e0d5d7-71d4-41e3-910c-c57b4a4b1410",
        "security": 1,
        "simple": -1,
        "severity": "Medium",
        "link": "https://learn.microsoft.com/azure/aks/workload-identity-migration-sidecar"
      },
      {
        "category": "Security",
        "subcategory": "Identity and Access",
        "text": "For AKS non-interactive logins use kubelogin (preview)",
        "guid": "d2e0d5d7-71d4-41e3-910c-c57b4a4b1410",
        "security": 1,
        "simple": -1,
        "severity": "Medium",
        "link": "https://learn.microsoft.com/azure/aks/managed-aad#non-interactive-sign-in-with-kubelogin"
      },
      {
        "category": "Security",
        "subcategory": "Identity and Access",
        "text": "Disable AKS local accounts",
        "guid": "d2e0d5d7-71d4-41e3-910c-c57b4a4b1410",
        "security": 1,
        "simple": -1,
        "severity": "Medium",
        "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (properties.disableLocalAccounts==true) | distinct id,compliant",
        "link": "https://learn.microsoft.com/azure/aks/managed-aad#disable-local-accounts"
      },
      {
        "category": "Security",
        "subcategory": "Identity and Access",
        "text": "Configure if required Just-in-time cluster access",
        "guid": "d2e0d5d7-71d4-41e3-910c-c57b4a4b1410",
        "security": 1,
        "simple": -1,
        "severity": "Low",
        "link": "https://learn.microsoft.com/azure/aks/managed-aad#configure-just-in-time-cluster-access-with-azure-ad-and-aks"
      },
      {
        "category": "Security",
        "subcategory": "Identity and Access",
        "text": "Configure if required AAD conditional access for AKS",
        "guid": "d2e0d5d7-71d4-41e3-910c-c57b4a4b1410",
        "security": 1,
        "simple": -1,
        "severity": "Low",
        "link": "https://learn.microsoft.com/azure/aks/managed-aad#use-conditional-access-with-azure-ad-and-aks"
      },
      {
        "category": "Security",
        "subcategory": "Identity and Access",
        "text": "If required for Windows AKS workloads configure gMSA ",
        "guid": "d2e0d5d7-71d4-41e3-910c-c57b4a4b1410",
        "security": 1,
        "simple": -1,
        "severity": "Low",
        "link": "https://learn.microsoft.com/azure/aks/use-group-managed-service-accounts"
      },
      {
        "category": "Security",
        "subcategory": "Identity and Access",
        "text": "For finer control consider using a managed Kubelet Identity",
        "guid": "d2e0d5d7-71d4-41e3-910c-c57b4a4b1410",
        "security": 1,
        "simple": -1,
        "severity": "Medium",
        "link": "https://learn.microsoft.com/azure/aks/use-managed-identity#use-a-pre-created-kubelet-managed-identity"
      },
      {
        "category": "Security",
        "subcategory": "IPAM",
        "text": "If using private-IP LoadBalancer services, use a dedicated subnet (not the AKS subnet)",
        "guid": "13c00567-4b1e-4945-a459-c373e7ed6162",
        "security": 1,
        "simple": -1,
        "severity": "Low",
        "link": "https://docs.microsoft.com/azure/aks/internal-lb"
      },
      {
        "category": "Security",
        "subcategory": "Net-Sec",
        "text": "Filter egress traffic with AzFW/NVA if your security requirements mandate it",
        "guid": "3b365a91-7ecb-4e48-bbe5-4cd7df2e8bba",
        "security": 2,
        "simple": -2,
        "severity": "High",
        "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (properties.networkProfile.outboundType=='userDefinedRouting') | distinct id,compliant",
        "link": "https://docs.microsoft.com/azure/aks/limit-egress-traffic"
      },
      {
        "category": "Security",
        "subcategory": "Net-Sec",
        "text": "If using a public API endpoint, restrict the IP addresses that can access it",
        "guid": "c4581559-bb91-463e-a908-aed8c44ce3b2",
        "security": 1,
        "simple": -1,
        "severity": "Medium",
        "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = ((isnull(properties.apiServerAccessProfile.enablePrivateCluster) or properties.apiServerAccessProfile.enablePrivateCluster==false) and isnotnull(properties.apiServerAccessProfile.authorizedIPRanges)) | distinct id,compliant",
        "link": "https://docs.microsoft.com/azure/aks/api-server-authorized-ip-ranges"
      },
      {
        "category": "Security",
        "subcategory": "Scalability",
        "text": "Use an ingress controller to expose web-based apps instead of exposing them with LoadBalancer-type services",
        "guid": "b3808b9f-a1cf-4204-ad01-3a923ce474db",
        "scale": 1,
        "simple": -1,
        "severity": "Medium",
        "link": "https://docs.microsoft.com/azure/aks/concepts-network"
      },
      {
        "category": "Security",
        "subcategory": "Scalability",
        "text": "Use Azue NAT Gateway as outboundType for scaling egress traffic",
        "guid": "b3808b9f-a1cf-4204-ad01-3a923ce474db",
        "scale": 1,
        "simple": -1,
        "severity": "Low",
        "link": "https://learn.microsoft.com/azure/aks/nat-gateway"
      },
      {
        "category": "Security",
        "subcategory": "Best practices",
        "text": "If using AGIC, do not share an AppGW across clusters",
        "guid": "cbd8ac2a-aebc-4a2a-94da-1dbf3dc99248",
        "security": 1,
        "simple": -1,
        "severity": "Medium",
        "link": "https://azure.github.io/application-gateway-kubernetes-ingress/setup/install-existing/"
      },
      {
        "category": "Security",
        "subcategory": "Cost",
        "text": "Use Private Endpoints (preferred) or Virtual Network Service Endpoints to access PaaS services from the cluster",
        "guid": "c3c39c98-6bb2-4c12-859a-114b5e3df584",
        "security": 1,
        "simple": -1,
        "severity": "Medium",
        "link": "https://docs.microsoft.com/azure/private-link/private-link-overview"
      },
      {
        "category": "Security",
        "subcategory": "Net-Sec",
        "text": "Use private clusters if your requirements mandate it",
        "guid": "ecccd979-3b6b-4cda-9b50-eb2eb03dda6d",
        "security": 1,
        "simple": -1,
        "severity": "High",
        "graph": "where type=='microsoft.containerservice/managedclusters' | where isnotnull(properties.apiServerAccessProfile.enablePrivateCluster) | extend compliant = (properties.apiServerAccessProfile.enablePrivateCluster==true) | distinct id, compliant",
        "link": "https://docs.microsoft.com/azure/aks/private-clusters"
      },
      {
        "category": "Security",
        "subcategory": "Net-Sec",
        "text": "For Windows 2019 and 2022 AKS nodes Calico Network Policies can be used ",
        "guid": "ecccd979-3b6b-4cda-9b50-eb2eb03dda6d",
        "security": 1,
        "simple": -1,
        "severity": "Medium",
        "graph": "where type=='microsoft.containerservice/managedclusters' | where isnotnull(properties.apiServerAccessProfile.enablePrivateCluster) | extend compliant = (properties.apiServerAccessProfile.enablePrivateCluster==true) | distinct id, compliant",
        "link": "https://learn.microsoft.com/azure/aks/use-network-policies"
      },
      {
        "category": "Security",
        "subcategory": "Net-Sec",
        "text": "Enable a Kubernetes Network Policy option (Calico/Azure)",
        "guid": "58d7c892-ddb1-407d-9769-ae669ca48e4a",
        "security": 1,
        "severity": "High",
        "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = isnotnull(properties.networkProfile.networkPolicy) | distinct id,compliant",
        "link": "https://docs.microsoft.com/azure/aks/use-network-policies"
      },
      {
        "category": "Security",
        "subcategory": "Net-Sec",
        "text": "Use Kubernetes network policies to increase intra-cluster security",
        "guid": "85e2223e-ce8b-4b12-907c-a5f16f158e3e",
        "security": 1,
        "simple": -1,
        "severity": "High",
        "link": "https://docs.microsoft.com/azure/aks/operator-best-practices-network"
      },
      {
        "category": "Security",
        "subcategory": "Net-Sec",
        "text": "Use a WAF for web workloads (UIs or APIs)",
        "guid": "a3a92c2d-e7e2-4165-a3a8-7af4a7a1f893",
        "security": 2,
        "cost": -1,
        "simple": -1,
        "severity": "High",
        "link": "https://docs.microsoft.com/azure/aks/operator-best-practices-network"
      },
      {
        "category": "Security",
        "subcategory": "Net-Sec",
        "text": "Use DDoS Standard in the AKS Virtual Network",
        "guid": "9bda4776-8f24-4c11-9775-c2ea55b46a94",
        "security": 2,
        "cost": -2,
        "severity": "Medium",
        "graph": "Resources | where type=~'microsoft.containerservice/managedclusters' | project resourceGroup,name,pools=properties.agentPoolProfiles | mv-expand pools | project subnetId=tostring(pools.vnetSubnetID) | where isnotempty(subnetId) | join (Resources | where type=='microsoft.network/virtualnetworks' | project id,resourceGroup,name,enableDdosProtection=tostring(properties.enableDdosProtection),subnets=properties.subnets | mv-expand subnets | project id,resourceGroup,name,enableDdosProtection,subnetId=tostring(subnets.id)) on subnetId | distinct id,resourceGroup,name,enableDdosProtection | extend compliant = (enableDdosProtection == 'true')",
        "link": "https://docs.microsoft.com/azure/virtual-network/ddos-protection-overview"
      },
      {
        "category": "Security",
        "subcategory": "Net-Sec",
        "text": "If required add company HTTP Proxy",
        "guid": "9bda4776-8f24-4c11-9775-c2ea55b46a94",
        "security": 2,
        "cost": -2,
        "severity": "Low",
        "graph": "Resources | where type=~'microsoft.containerservice/managedclusters' | project resourceGroup,name,pools=properties.agentPoolProfiles | mv-expand pools | project subnetId=tostring(pools.vnetSubnetID) | where isnotempty(subnetId) | join (Resources | where type=='microsoft.network/virtualnetworks' | project id,resourceGroup,name,enableDdosProtection=tostring(properties.enableDdosProtection),subnets=properties.subnets | mv-expand subnets | project id,resourceGroup,name,enableDdosProtection,subnetId=tostring(subnets.id)) on subnetId | distinct id,resourceGroup,name,enableDdosProtection | extend compliant = (enableDdosProtection == 'true')",
        "link": "https://learn.microsoft.com/azure/aks/http-proxy"
      },
      {
        "category": "Security",
        "subcategory": "Best practices",
        "text": "Do not use AKS Application Routing Add-On",
        "guid": "8008ae7d-7e4b-4475-a6c8-bdbf59bce65d",
        "scale": 1,
        "simple": -1,
        "severity": "High",
        "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (isnull(properties.addonProfiles.httpApplicationRouting) or properties.addonProfiles.httpApplicationRouting.enabled==false) | distinct id,compliant",
        "link": "https://docs.microsoft.com/azure/aks/http-application-routing"
      },
      {
        "category": "Security",
        "subcategory": "Security",
        "text": "Consider using a service mesh for advanced microservice communication management and mTLS ",
        "guid": "e9855d04-c3c3-49c9-a6bb-2c12159a114b",
        "security": 1,
        "simple": -2,
        "severity": "Medium",
        "link": "https://docs.microsoft.com/azure/aks/servicemesh-about"
      },
      {
        "category": "Security",
        "subcategory": "Best practices",
        "text": "If using Azure CNI, consider using different Subnets for NodePools",
        "guid": "e9855d04-c3c3-49c9-a6bb-2c12159a114b",
        "security": 1,
        "simple": -2,
        "severity": "Medium",
        "link": "https://learn.microsoft.com/azure/aks/use-multiple-node-pools#add-a-node-pool-with-a-unique-subnet"
      },
      {
        "category": "Security",
        "subcategory": "Secrets",
        "text": "Store your secrets in Azure Key Vault with the CSI Secrets Store driver",
        "guid": "5e3df584-eccc-4d97-a3b6-bcda3b50eb2e",
        "security": 1,
        "simple": -1,
        "severity": "Medium",
        "link": "https://github.com/Azure/secrets-store-csi-driver-provider-azure"
      },
      {
        "category": "Security",
        "subcategory": "Secrets",
        "text": "If user Service Principals for the cluster, refresh credentials periodically (like quarterly)",
        "guid": "b03dda6d-58d7-4c89-8ddb-107d5769ae66",
        "security": 1,
        "severity": "High",
        "link": "https://docs.microsoft.com/azure/aks/update-credentials"
      },
      {
        "category": "Security",
        "subcategory": "Compliance",
        "text": "Use Azure Policy for Kubernetes to ensure cluster compliance",
        "guid": "9ca48e4a-85e2-4223-bce8-bb12307ca5f1",
        "security": 1,
        "simple": -1,
        "severity": "Medium",
        "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (isnotnull(properties.addonProfiles.azurepolicy) and properties.addonProfiles.azurepolicy.enabled==true) | distinct id,compliant",
        "link": "https://docs.microsoft.com/azure/governance/policy/concepts/policy-for-kubernetes"
      },
      {
        "category": "Security",
        "subcategory": "Compliance",
        "text": "Separate applications from the control plane with user/system nodepools",
        "guid": "6f158e3e-a3a9-42c2-be7e-2165c3a87af4",
        "security": 1,
        "cost": -1,
        "simple": -1,
        "severity": "Medium",
        "graph": "where type=='microsoft.containerservice/managedclusters' | project id,resourceGroup,name,pools=properties.agentPoolProfiles | project id,name,resourceGroup,poolcount=array_length(pools) | extend compliant = (poolcount > 1)",
        "link": "https://docs.microsoft.com/azure/aks/use-system-pools"
      },
      {
        "category": "Security",
        "subcategory": "Compliance",
        "text": "Add taint to your system nodepool to make it dedicated",
        "guid": "a7a1f893-9bda-4477-98f2-4c116775c2ea",
        "simple": -1,
        "ha": 1,
        "severity": "Low",
        "link": "https://docs.microsoft.com/azure/aks/use-system-pools"
      },
      {
        "category": "Security",
        "subcategory": "Compliance",
        "text": "Use a private registry for your images, such as ACR",
        "guid": "55b46a94-8008-4ae7-b7e4-b475b6c8bdbf",
        "security": 1,
        "simple": -1,
        "severity": "Medium",
        "link": "https://docs.microsoft.com/azure/container-registry/"
      },
      {
        "category": "Security",
        "subcategory": "Compliance",
        "text": "Scan your images for vulnerabilities",
        "guid": "59bce65d-e8a0-43f9-9879-468d66a786d6",
        "security": 1,
        "cost": -1,
        "severity": "Medium",
        "link": "https://docs.microsoft.com/azure/security-center/container-security"
      },
      {
        "category": "Security",
        "subcategory": "Compliance",
        "text": "Use Azure Defender (formerly Azure Security Center) to detect security posture vulnerabiities",
        "guid": "cc639637-a652-42ac-89e8-06965388e9de",
        "security": 1,
        "cost": -1,
        "severity": "Medium",
        "link": "https://docs.microsoft.com/azure/security-center/container-security"
      },
      {
        "category": "Security",
        "subcategory": "Compliance",
        "text": "If required configure FIPS",
        "guid": "cc639637-a652-42ac-89e8-06965388e9de",
        "security": 1,
        "cost": -1,
        "severity": "Low",
        "link": "https://learn.microsoft.com/azure/aks/use-multiple-node-pools#add-a-fips-enabled-node-pool"
      },
      {
        "category": "Security",
        "subcategory": "Secrets",
        "text": "If required add Key Management Service etcd encryption",
        "guid": "cc639637-a652-42ac-89e8-06965388e9de",
        "security": 1,
        "cost": -1,
        "severity": "Medium",
        "link": "https://learn.microsoft.com/azure/aks/use-kms-etcd-encryption"
      },
      {
        "category": "Security",
        "subcategory": "Secrets",
        "text": "If required consider using Confidential Compute for AKS",
        "guid": "cc639637-a652-42ac-89e8-06965388e9de",
        "security": 1,
        "cost": -1,
        "severity": "Low",
        "link": "https://learn.microsoft.com/azure/confidential-computing/confidential-nodes-aks-overview"
      },
      {
        "category": "Security",
        "subcategory": "Secrets",
        "text": "Enable Defender for Containers",
        "guid": "cc639637-a652-42ac-89e8-06965388e9de",
        "security": 1,
        "cost": -1,
        "severity": "Medium",
        "link": "https://learn.microsoft.com/azure/defender-for-cloud/defender-for-containers-enable"
      },
      {
        "category": "Security",
        "subcategory": "Compliance",
        "text": "Define app separation requirements (namespace/nodepool/cluster)",
        "guid": "d167dd18-2b0a-4c24-8b99-9a646f8389a7",
        "security": 1,
        "severity": "High",
        "link": "https://docs.microsoft.com/azure/aks/operator-best-practices-cluster-isolation"
      },
      {
        "category": "Security",
        "subcategory": "Compliance",
        "text": "Check regularly Azure Advisor for recommendations on your cluster",
        "guid": "337453a3-cc63-4963-9a65-22ac19e80696",
        "simple": -1,
        "ha": 1,
        "severity": "Low",
        "link": "https://docs.microsoft.com/azure/advisor/advisor-get-started"
      },
      {
        "category": "Security",
        "subcategory": "Compliance",
        "text": "Enable AKS auto-certificate rotation",
        "guid": "5388e9de-d167-4dd1-a2b0-ac241b999a64",
        "simple": 1,
        "severity": "Low",
        "link": "https://learn.microsoft.com/azure/aks/certificate-rotation"
      },
      {
        "category": "Security",
        "subcategory": "Monitoring",
        "text": "Monitor your cluster metrics with Container Insights (or other tools like Prometheus)",
        "guid": "6f8389a7-f82c-4b8e-a8c0-aa63a25a4956",
        "simple": -1,
        "ha": 1,
        "severity": "High",
        "link": "https://docs.microsoft.com/azure/azure-monitor/insights/container-insights-overview"
      },
      {
        "category": "Security",
        "subcategory": "Monitoring",
        "text": "Store and analyze your cluster logs with Container Insights (or other tools like Telegraf/ElasticSearch)",
        "guid": "eaa8dc4a-2436-47b3-9697-15b1752beee0",
        "simple": -1,
        "ha": 1,
        "severity": "High",
        "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (isnotnull(properties.addonProfiles.omsagent) and properties.addonProfiles.omsagent.enabled==true) | distinct id,compliant",
        "link": "https://docs.microsoft.com/azure/azure-monitor/insights/container-insights-overview"
      },
      {
        "category": "Security",
        "subcategory": "Alerting",
        "text": "Configure alerts on the most critical metrics (see Container Insights for recommendations)",
        "guid": "67f7a9ed-5b31-4f38-a3f3-9812b2463cff",
        "simple": -1,
        "ha": 1,
        "severity": "High",
        "link": "https://docs.microsoft.com/azure/azure-monitor/insights/container-insights-metric-alerts"
      },
      {
        "category": "Security",
        "subcategory": "Compliance",
        "text": "Have a regular process to upgrade your kubernetes version periodically (quarterly, for example), or use the AKS autoupgrade feature",
        "guid": "e189c599-df0d-45a7-9dd4-ce32c1881370",
        "security": 1,
        "simple": -1,
        "severity": "High",
        "link": "https://docs.microsoft.com/azure/aks/supported-kubernetes-versions"
      },
      {
        "category": "Security",
        "subcategory": "Compliance",
        "text": "Use kured for Linux node upgrades in case you are not using node-image upgrade",
        "guid": "6f7c4c0d-4e51-4464-ad24-57ed67138b82",
        "simple": -1,
        "severity": "High",
        "link": "https://docs.microsoft.com/azure/aks/node-updates-kured"
      },
      {
        "category": "Security",
        "subcategory": "Compliance",
        "text": "Have a regular process to upgrade the cluster node images periodically (weekly, for example)",
        "guid": "139c9580-ade3-426a-ba09-cf157d9f6477",
        "security": 1,
        "simple": -1,
        "severity": "High",
        "link": "https://docs.microsoft.com/azure/aks/node-image-upgrade"
      },
      {
        "category": "Security",
        "subcategory": "Compliance",
        "text": "Consider gitops to deploy applications or cluster configuration to multiple clusters",
        "guid": "0102ce16-ee30-41e6-b882-e52e4621dd68",
        "severity": "Low",
        "link": "https://docs.microsoft.com/azure/architecture/example-scenario/bedrock/bedrock-automated-deployments"
      },
      {
        "category": "Security",
        "subcategory": "Compliance",
        "text": "Consider using AKS command invoke on private clusters",
        "guid": "0102ce16-ee30-41e6-b882-e52e4621dd68",
        "severity": "Low",
        "link": "https://learn.microsoft.com/azure/aks/command-invoke"
      },
      {
        "category": "Security",
        "subcategory": "Compliance",
        "text": "For planned events consider using Node Auto Drain",
        "guid": "31d7aaab-7571-4449-ab80-53d89e89d17b",
        "security": 1,
        "severity": "Low",
        "link": "https://learn.microsoft.com/azure/aks/node-auto-repair#node-autodrain"
      },
      {
        "category": "Security",
        "subcategory": "Compliance",
        "text": "Develop own governanance practices to make sure no changes are performed by operators in the node RG (aka 'infra RG')",
        "guid": "31d7aaab-7571-4449-ab80-53d89e89d17b",
        "security": 1,
        "severity": "High",
        "link": "https://docs.microsoft.com/azure/aks/faq"
      },
      {
        "category": "Security",
        "subcategory": "Compliance",
        "text": "Do not use deprecated Kubernetes APIs in your YAML manifests",
        "guid": "b2463cff-e189-4c59-adf0-d5a73dd4ce32",
        "simple": -1,
        "ha": 1,
        "severity": "Medium",
        "link": "https://kubernetes.io/docs/setup/release/notes/"
      },
      {
        "category": "Security",
        "subcategory": "Compliance",
        "text": "Keep windows containers patch level in sync with host patch level",
        "guid": "67138b82-0102-4ce1-9ee3-01e6e882e52e",
        "severity": "Low",
        "link": "https://docs.microsoft.com/virtualization/windowscontainers/deploy-containers/version-compatibility?tabs=windows-server-20H2%2Cwindows-10-20H2"
      },
      {
        "category": "Security",
        "subcategory": "Monitoring",
        "text": "Monitor CPU and memory utilization of the nodes",
        "guid": "4621dd68-c5a5-4be2-bdb1-1726769ef669",
        "simple": -1,
        "ha": 1,
        "severity": "Medium",
        "link": "https://docs.microsoft.com/azure/azure-monitor/containers/container-insights-analyze"
      },
      {
        "category": "Security",
        "subcategory": "Monitoring",
        "text": "If using Azure CNI, monitor % of pod IPs consumed per node",
        "guid": "1a4835ac-9422-423e-ae80-b123081a5417",
        "simple": -1,
        "ha": 1,
        "severity": "Medium",
        "link": "https://docs.microsoft.com/azure/aks/configure-azure-cni"
      },
      {
        "category": "Security",
        "subcategory": "Monitoring",
        "text": "Monitor OS disk queue depth in nodes",
        "description": "I/O in the OS disk is a critical resource. If the OS in the nodes gets throttled on I/O, this could lead to unpredictable behavior, typically ending up in node being declared NotReady",
        "guid": "415833ea-3ad3-4c2d-b733-165c3acbe04b",
        "simple": -1,
        "ha": 1,
        "severity": "Medium",
        "link": "https://docs.microsoft.com/azure/virtual-machines/premium-storage-performance"
      },
      {
        "category": "Security",
        "subcategory": "Monitoring",
        "text": "If not using egress filtering with AzFW/NVA, monitor standard ALB allocated SNAT ports",
        "guid": "be209d39-fda4-4777-a424-d116785c2fa5",
        "simple": -1,
        "ha": 1,
        "severity": "Medium",
        "link": "https://docs.microsoft.com/azure/aks/load-balancer-standard"
      },
      {
        "category": "Security",
        "subcategory": "Monitoring",
        "text": "Subscribe to resource health notifications for your AKS cluster",
        "guid": "74c2ee76-569b-4a79-a57e-dedf91b022c9",
        "ha": 1,
        "severity": "Medium",
        "link": "https://docs.microsoft.com/azure/aks/aks-resource-health"
      },
      {
        "category": "Security",
        "subcategory": "Compliance",
        "text": "Send master logs (aka API logs) to Azure Monitor or your preferred log management solution",
        "description": "Via Diagnostic Settings at the cluster level",
        "guid": "5b56ad48-408f-4e72-934c-476ba280dcf5",
        "cost": -1,
        "ha": 1,
        "severity": "Low",
        "link": "https://docs.microsoft.com/azure/aks/monitor-aks"
      },
      {
        "category": "Security",
        "subcategory": "Scalability",
        "text": "For long running operation on an AKS cluster consider event termination",
        "description": "Larger nodes will bring higher performance and features such as ephemeral disks and accelerated networking, but they will increase the blast radius and decrease the scaling granularity",
        "guid": "5ae124ba-34df-4585-bcdc-e9bd3bb0cdb3",
        "cost": 1,
        "severity": "Low",
        "link": "https://learn.microsoft.com/azure/aks/manage-abort-operations"
      },
      {
        "category": "Security",
        "subcategory": "Scalability",
        "text": "If required consider using Azure Dedicated Hosts for AKS nodes",
        "description": "Larger nodes will bring higher performance and features such as ephemeral disks and accelerated networking, but they will increase the blast radius and decrease the scaling granularity",
        "guid": "5ae124ba-34df-4585-bcdc-e9bd3bb0cdb3",
        "cost": 1,
        "severity": "Low",
        "link": "https://learn.microsoft.com/azure/aks/use-azure-dedicated-hosts"
      },
      {
        "category": "Security",
        "subcategory": "Resources",
        "text": "Configure requests and limits in your pod specs",
        "guid": "b54eb2eb-03dd-4aa3-9927-18e2edb11726",
        "simple": -1,
        "ha": 1,
        "severity": "High",
        "link": "https://docs.microsoft.com/azure/aks/operator-best-practices-scheduler"
      },
      {
        "category": "Security",
        "subcategory": "Resources",
        "text": "Enforce resource quotas for namespaces",
        "guid": "769ef669-1a48-435a-a942-223ece80b123",
        "simple": -1,
        "ha": 1,
        "severity": "Medium",
        "link": "https://docs.microsoft.com/azure/aks/operator-best-practices-scheduler"
      },
      {
        "category": "Security",
        "subcategory": "Infrastructure as Code",
        "text": "Use automation through ARM/TF to create your Azure resources",
        "guid": "3acbe04b-be20-49d3-afda-47778424d116",
        "simple": -1,
        "ha": 1,
        "severity": "Medium",
        "link": "https://docs.microsoft.com/azure/developer/terraform/create-k8s-cluster-with-tf-and-aks"
      },
      {
        "category": "Security",
        "subcategory": "Development",
        "text": "Use canary or blue/green deployments",
        "guid": "785c2fa5-5b56-4ad4-a408-fe72734c476b",
        "cost": 1,
        "severity": "Medium",
        "link": "https://docs.microsoft.com/azure/architecture/reference-architectures/containers/aks/secure-baseline-aks"
      }
    ],
    "categories": [
      {
        "name": "Identity and Access Management"
      },
      {
        "name": "Network Topology and Connectivity"
      },
      {
        "name": "BC and DR"
      },
      {
        "name": "Governance and Security"
      },
      {
        "name": "Cost Governance"
      },
      {
        "name": "Operations"
      },
      {
        "name": "Application Deployment"
      }
    ],
    "status": [
      {
        "name": "Not verified",
        "description": "This check has not been looked at yet"
      },
      {
        "name": "Open",
        "description": "There is an action item associated to this check"
      },
      {
        "name": "Fulfilled",
        "description": "This check has been verified, and there are no further action items associated to it"
      },
      {
        "name": "Not required",
        "description": "Recommendation understood, but not needed by current requirements"
      },
      {
        "name": "N/A",
        "description": "Not applicable for current design"
      }
    ],
    "severities": [
      {
        "name": "High"
      },
      {
        "name": "Medium"
      },
      {
        "name": "Low"
      }
    ],
    "metadata": {
      "name": "Azure AKS Security Review"
    }
  }
  
  
{
    "items": [
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "f00a69de-7076-4734-a734-6e4552cad9e1",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-latest-version-for-customer-managed-certificates",
            "service": "Front Door",
            "severity": "中程度",
            "text": "Azure Front Door でカスタマー マネージド TLS 証明書を使用する場合は、\"最新\" の証明書バージョンを使用します。証明書の手動更新によって引き起こされる停止のリスクを軽減",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "graph": "resources | where type == 'microsoft.network/applicationgateways' | project id, compliant = properties.sku.name in ('Standard_v2', 'WAF_v2') | project id,compliant",
            "guid": "553585a6-abe0-11ed-afa1-0242ac120002",
            "link": "https://learn.microsoft.com/azure/application-gateway/overview-v2",
            "service": "App Gateway",
            "severity": "中程度",
            "text": "Application Gateway v2 SKU を使用していることを確認する",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "安全"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "graph": "resources | where type == 'microsoft.network/loadbalancers' | project id, compliant=(tolower(sku.name) == 'standard')",
            "guid": "4e35fbf5-0ae2-48b2-97ce-753353edbd1a",
            "link": "https://learn.microsoft.com/azure/load-balancer/load-balancer-overview",
            "service": "Load Balancer",
            "severity": "中程度",
            "text": "Azure Load Balancer に Standard SKU を使用していることを確認する",
            "waf": "安全"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "9432621a-8397-4654-a882-5bc856b7ef83",
            "link": "https://learn.microsoft.com/azure/load-balancer/load-balancer-standard-availability-zones",
            "service": "Load Balancer",
            "severity": "中程度",
            "text": "Load Balancer フロントエンドの IP アドレスがゾーン冗長であることを確認します (ゾーン フロントエンドが必要な場合を除く)。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "graph": "resources | where type=='microsoft.network/applicationgateways' | extend subnetId = tostring(properties.gatewayIPConfigurations[0].properties.subnet.id) | project id, subnetId | join (resources | where type=='microsoft.network/virtualnetworks' | project id,subnets=properties.subnets | mv-expand subnets | mv-expand subnets.properties.addressPrefixes | project id, subnetId = tostring(subnets.id), prefix1 = subnets.properties.addressPrefix, prefix2 = subnets.properties.addressPrefixes | mv-expand prefix2 | extend prefix = iff(isnotnull(prefix1), prefix1, prefix2) | extend subnetPrefixLength = split(prefix, '/')[1])on subnetId | extend compliant = (subnetPrefixLength <= 24 or subnetPrefixLength == 64) | distinct id,compliant",
            "guid": "dfc50f87-3800-424c-937b-ed5f186e7c15",
            "link": "https://learn.microsoft.com/azure/application-gateway/configuration-infrastructure#size-of-the-subnet",
            "service": "App Gateway",
            "severity": "中程度",
            "text": "Application Gateway v2 は、IP プレフィックスが /24 以上のサブネットにデプロイする必要があります",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "安全"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "description": "リバースプロキシ全般、特にWAFの管理は、ネットワークよりもアプリケーションに近いため、アプリと同じサブスクリプションに属します。Application Gateway と WAF を接続サブスクリプションに一元化することは、1 つのチームによって管理されている場合は問題ない場合があります。",
            "guid": "48b662d6-d15f-4512-a654-98f6dfe237de",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "service": "App Gateway",
            "severity": "中程度",
            "text": "ランディング ゾーン仮想ネットワーク内およびそれらがセキュリティで保護しているアプリと共に、受信 HTTP(S) 接続のプロキシに使用される Azure Application Gateway v2 またはパートナーの NVA をデプロイします。",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "安全"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "f109e1f3-c79b-4f14-82de-6b5c22314d08",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "service": "App Gateway",
            "severity": "中程度",
            "text": "アプリケーション ランディング ゾーン内のすべてのパブリック IP アドレスに対して DDoS ネットワークまたは IP 保護プランを使用します。",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "安全"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "graph": "resources | where type =~ 'microsoft.network/applicationGateways' | extend compliant = (isnotnull(properties.autoscaleConfiguration) and properties.autoscaleConfiguration.minCapacity >= 2) | distinct id,compliant",
            "guid": "135bf4ac-f9db-461f-b76b-2ee9e30b12c0",
            "link": "https://learn.microsoft.com/azure/application-gateway/application-gateway-autoscaling-zone-redundant",
            "service": "App Gateway",
            "severity": "中程度",
            "text": "最小数のインスタンスが 2 つになる自動スケーリングを構成します。",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "確実"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "graph": "resources | where type =~ 'microsoft.network/applicationGateways' | extend compliant = (isnotnull(zones) and array_length(zones) > 1) | distinct id,compliant",
            "guid": "060c6964-52b5-48db-af8b-83e4b2d85349",
            "link": "https://learn.microsoft.com/azure/reliability/migrate-app-gateway-v2",
            "service": "App Gateway",
            "severity": "中程度",
            "text": "Application Gateway を複数の可用性ゾーンにデプロイする",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "確実"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "e79d17b7-3b22-4a5a-97e7-a8ed4b30e38c",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "service": "Front Door",
            "severity": "中程度",
            "text": "Azure Front Door と WAF ポリシーを使用して、複数の Azure リージョンにまたがるグローバル HTTP/S アプリを配信し、保護します。",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "安全"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "3f29812b-2363-4cef-b179-b599de0d5973",
            "link": "https://learn.microsoft.com/azure/ddos-protection/ddos-protection-overview",
            "service": "Front Door",
            "severity": "中程度",
            "text": "Front Door と Application Gateway を使用して HTTP/S アプリを保護する場合は、Front Door で WAF ポリシーを使用します。Application Gateway をロックダウンして、Front Door からのトラフィックのみを受信します。",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "安全"
        },
        {
            "ammp": true,
            "arm-service": "microsoft.network/trafficManagerProfiles",
            "checklist": "Azure Application Delivery Networking",
            "guid": "cd4cd21b-0881-437f-9e6c-4cfd3e504547",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "service": "Traffic Manager",
            "severity": "高い",
            "text": "Traffic Manager を使用して、HTTP/S 以外のプロトコルにまたがるグローバル アプリを配信します。",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "確実"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "3b4b3e88-a459-4ed5-a22f-644dfbc58204",
            "link": "https://learn.microsoft.com/azure/active-directory/app-proxy/application-proxy#how-application-proxy-works",
            "service": "Entra",
            "severity": "低い",
            "text": "ユーザーが内部アプリケーションへのアクセスのみを必要とする場合、Microsoft Entra ID アプリケーション プロキシは Azure Virtual Desktop (AVD) の代替として検討されていますか?",
            "training": "https://learn.microsoft.com/learn/modules/configure-azure-ad-application-proxy/",
            "waf": "安全"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "01ca7cf1-5754-442d-babb-8ba6772e5c30",
            "link": "https://learn.microsoft.com/azure/active-directory/app-proxy/application-proxy#how-application-proxy-works",
            "service": "Entra",
            "severity": "中程度",
            "text": "ネットワーク内の着信接続用に開かれているファイアウォール ポートの数を減らすには、Microsoft Entra ID アプリケーション プロキシを使用して、リモート ユーザーに内部アプリケーションへの安全で認証されたアクセスを提供することを検討してください。",
            "training": "https://learn.microsoft.com/learn/paths/implement-applications-external-access-azure-ad/",
            "waf": "安全"
        },
        {
            "ammp": true,
            "checklist": "Azure Application Delivery Networking",
            "graph": "resources | where type == 'microsoft.network/frontdoorwebapplicationfirewallpolicies' | project policyName=name, policyId=id,policySku=sku.name, links=properties.securityPolicyLinks, enabledState=properties.policySettings.enabledState, mode=properties.policySettings.mode | mvexpand links | extend securityPolicy=links.id | extend securityPolicyParts=split(securityPolicy, '/') | extend profileId=strcat_array(array_slice(securityPolicyParts, 0, -3), '/') | project id=profileId, compliant=((enabledState=='Enabled') and (mode=='Prevention')), enabledState, mode",
            "guid": "ae248989-b306-4591-9186-de482e3f0f0e",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-policy-settings",
            "service": "Front Door",
            "severity": "高い",
            "text": "Front Door の WAF ポリシーを \"防止\" モードでデプロイします。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "checklist": "Azure Application Delivery Networking",
            "guid": "062d5839-4d36-402f-bfa4-02811eb936e9",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#avoid-combining-traffic-manager-and-front-door",
            "service": "Front Door",
            "severity": "高い",
            "text": "Azure Traffic Manager と Azure Front Door の組み合わせは避けてください。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "checklist": "Azure Application Delivery Networking",
            "guid": "5efeb96a-003f-4b18-8fcd-b4d84459c2b2",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-the-same-domain-name-on-front-door-and-your-origin",
            "service": "Front Door",
            "severity": "高い",
            "text": "Azure Front Door と配信元で同じドメイン名を使用します。ホスト名が一致しないと、微妙なバグが発生する可能性があります。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "graph": "cdnresources | where type =~ 'microsoft.cdn/profiles/origingroups/origins' | extend frontDoorId = substring(id, 0, indexof(id, '/origingroups')) | extend originGroupId = substring(id, 0, indexof(id, '/origins')) | join kind=inner (cdnresources | where type =~ 'microsoft.cdn/profiles/origingroups' | extend originGroupName = name | extend hasHealthProbe = isnotnull(properties.healthProbeSettings)) on $left.originGroupId == $right.id | summarize numberOrigins = count() by originGroupId, subscriptionId, frontDoorId, hasHealthProbe, originGroupName | extend compliant = not(numberOrigins == 1 and hasHealthProbe) | project id = frontDoorId, compliant",
            "guid": "0b5a380c-4bfb-47bc-b1d7-dcfef363a61b",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#disable-health-probes-when-theres-only-one-origin-in-an-origin-group",
            "service": "Front Door",
            "severity": "低い",
            "text": "Azure Front Door 配信元グループに配信元が 1 つしかない場合は、正常性プローブを無効にします。",
            "waf": "パフォーマンス"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "5567048e-e5d7-4206-9c55-b5ed45d2cc0c",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#select-good-health-probe-endpoints",
            "service": "Front Door",
            "severity": "中程度",
            "text": "Azure Front Door に適した正常性プローブ エンドポイントを選択します。アプリケーションのすべての依存関係をチェックする正常性エンドポイントを構築することを検討してください。",
            "waf": "確実"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "graph": "cdnresources | where type =~ 'microsoft.cdn/profiles/origingroups' | extend frontDoorId = substring(id, 0, indexof(id, '/origingroups/')) | extend compliant = (isnull(properties['healthProbeSettings']['probeRequestType']) or toupper(properties['healthProbeSettings']['probeRequestType']) == 'HEAD') | project compliant, id=frontDoorId",
            "guid": "a13f72f3-8f5c-4864-95e5-75bf37fbbeb1",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-head-health-probes",
            "service": "Front Door",
            "severity": "低い",
            "text": "Azure Front Door で HEAD 正常性プローブを使用して、Front Door がアプリケーションに送信するトラフィックを減らします。",
            "waf": "パフォーマンス"
        },
        {
            "ammp": true,
            "checklist": "Azure Application Delivery Networking",
            "graph": "resources | where type=='microsoft.network/loadbalancers' | extend countOutRules=array_length(properties.outboundRules) | extend compliant = (countOutRules == 0) | distinct id,compliant",
            "guid": "97a2fd46-64b0-1dfa-b72d-9c8869496d75",
            "link": "https://learn.microsoft.com/azure/nat-gateway/nat-overview#outbound-connectivity",
            "service": "Load Balancer",
            "severity": "高い",
            "text": "Load Balancer の送信規則の代わりに Azure NAT Gateway を使用して、SNAT のスケーラビリティを向上させる",
            "waf": "確実"
        },
        {
            "ammp": true,
            "checklist": "Azure Application Delivery Networking",
            "graph": "cdnresources | where type =~ 'microsoft.cdn/profiles/customdomains' | extend frontDoorId = substring(id, 0, indexof(id, '/customdomains')) | extend compliant = (isnull(properties['tlsSettings']['certificateType']) or tolower(properties['tlsSettings']['certificateType']) =~ 'customercertificate') | project compliant, id = frontDoorId",
            "guid": "af95c92d-d723-4f4a-98d7-8722324efd4d",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-managed-tls-certificates",
            "service": "Front Door",
            "severity": "高い",
            "text": "Azure Front Door でマネージド TLS 証明書を使用します。運用コストと、証明書の更新による停止のリスクを軽減します。",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "189ea962-3969-4863-8f5a-5ad808c2cf4b",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#define-your-waf-configuration-as-code",
            "service": "Front Door",
            "severity": "中程度",
            "text": "Azure Front Door WAF の構成をコードとして定義します。コードを使用すると、新しいルール セット バージョンをより簡単に採用し、追加の保護を得ることができます。",
            "waf": "オペレーションズ"
        },
        {
            "ammp": true,
            "checklist": "Azure Application Delivery Networking",
            "guid": "2e30abab-5478-417c-81bf-bf1ad4ed1ed4",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-end-to-end-tls",
            "service": "Front Door",
            "severity": "高い",
            "text": "Azure Front Door でエンド ツー エンドの TLS を使用します。クライアントから Front Door への接続、および Front Door から配信元への接続には TLS を使用します。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "10aa45af-166f-44c4-9f36-b6d592dac2ca",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-http-to-https-redirection",
            "service": "Front Door",
            "severity": "中程度",
            "text": "Azure Front Door で HTTP から HTTPS へのリダイレクトを使用します。古いクライアントをHTTPSリクエストに自動的にリダイレクトすることでサポートします。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "checklist": "Azure Application Delivery Networking",
            "guid": "28b9ee82-b2c7-45aa-bc98-6de6f59a095d",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#enable-the-waf",
            "service": "Front Door",
            "severity": "高い",
            "text": "Azure Front Door WAF を有効にします。さまざまな攻撃からアプリケーションを保護します。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "checklist": "Azure Application Delivery Networking",
            "guid": "2902d8cc-1b0c-4495-afad-624ab70f7bd6",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#tune-your-waf",
            "service": "Front Door",
            "severity": "高い",
            "text": "ワークロードに合わせて Azure Front Door WAF を調整します。誤検知を減らします。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "checklist": "Azure Application Delivery Networking",
            "guid": "17ba124b-127d-42b6-9322-388d5b2bbcfc",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/application-gateway-waf-request-size-limits#request-body-inspection",
            "service": "Front Door",
            "severity": "高い",
            "text": "Azure Front Door WAF ポリシーで要求本文検査機能を有効にします。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "checklist": "Azure Application Delivery Networking",
            "guid": "49a98f2b-ec22-4a87-9415-6a10b00d6555",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#enable-default-rule-sets",
            "service": "Front Door",
            "severity": "高い",
            "text": "Azure Front Door WAF の既定の規則セットを有効にします。既定のルール セットは、一般的な攻撃を検出してブロックします。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "checklist": "Azure Application Delivery Networking",
            "guid": "147a13d4-2a2f-4824-a524-f5855b52b946",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#enable-bot-management-rules",
            "service": "Front Door",
            "severity": "高い",
            "text": "Azure Front Door WAF ボット保護ルール セットを有効にします。ボットルールは、良いボットと悪いボットを検出します。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "d7dcdcb9-0d99-44b9-baab-ac7570ede79a",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#use-the-latest-ruleset-versions",
            "service": "Front Door",
            "severity": "中程度",
            "text": "最新の Azure Front Door WAF ルール セット バージョンを使用します。ルール セットの更新は、現在の脅威の状況を考慮して定期的に更新されます。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "b9620385-1cde-418f-914b-a84a06982ffc",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#add-rate-limiting",
            "service": "Front Door",
            "severity": "中程度",
            "text": "Azure Front Door WAF にレート制限を追加します。レート制限は、クライアントが短期間に大量のトラフィックを誤ってまたは意図的に送信することをブロックします。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "6dc36c52-0124-4ffe-9eaf-23ec1282dedb",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#use-a-high-threshold-for-rate-limits",
            "service": "Front Door",
            "severity": "中程度",
            "text": "Azure Front Door WAF のレート制限には、高いしきい値を使用します。高いレート制限しきい値は、正当なトラフィックのブロックを回避しながら、インフラストラクチャを圧倒する可能性のある非常に多数の要求に対する保護を提供します。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "388a3d0e-0a43-4367-90b2-3dd2aeece5ee",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#geo-filter-traffic",
            "service": "Front Door",
            "severity": "低い",
            "text": "すべての地域からのトラフィックが想定されていない場合は、地域フィルタを使用して、想定外の国からのトラフィックをブロックします。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "00acd8a9-6975-414f-8491-2be6309893b8",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#specify-the-unknown-zz-location",
            "service": "Front Door",
            "severity": "中程度",
            "text": "Azure Front Door WAF を使用してトラフィックをジオフィルター処理するときに、不明な (ZZ) 場所を指定します。IP アドレスを地理的に一致させることができない場合に、正当な要求を誤ってブロックしないようにします。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "checklist": "Azure Application Delivery Networking",
            "graph": "resources | where type == 'microsoft.network/applicationgatewaywebapplicationfirewallpolicies' | mv-expand properties.managedRules.managedRuleSets | project id, rulesettype = properties_managedRules_managedRuleSets.ruleSetType | extend compliant1 = (rulesettype == 'Microsoft_BotManagerRuleSet') | project id, compliant1 | summarize compliant = max(compliant1) by id",
            "guid": "2f8e81eb-8e68-4026-8b1f-70f9b05f7cf9",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/bot-protection",
            "service": "App Gateway",
            "severity": "高い",
            "text": "Azure Application Gateway WAF ボット保護ルール セットを有効にする ボット ルールは、良いボットと悪いボットを検出します。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "checklist": "Azure Application Delivery Networking",
            "guid": "8ea8e0d4-84e8-4b33-aeab-493f6391b4d6",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/application-gateway-waf-request-size-limits#request-body-inspection",
            "service": "App Gateway",
            "severity": "高い",
            "text": "Azure Application Gateway WAF ポリシーで有効になっている要求本文検査機能を有効にします。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "checklist": "Azure Application Delivery Networking",
            "guid": "a4dd86d3-5ffa-408c-b660-cce073d085b8",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/best-practices#tune-your-waf",
            "service": "App Gateway",
            "severity": "高い",
            "text": "ワークロードに合わせて Azure Application Gateway WAF を調整します。誤検知を減らします。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "checklist": "Azure Application Delivery Networking",
            "graph": "resources | where type == 'microsoft.network/frontdoorwebapplicationfirewallpolicies' | project policyName=name, policyId=id,policySku=sku.name, links=properties.securityPolicyLinks, enabledState=properties.policySettings.enabledState, mode=properties.policySettings.mode | mvexpand links | extend securityPolicy=links.id | extend securityPolicyParts=split(securityPolicy, '/') | extend profileId=strcat_array(array_slice(securityPolicyParts, 0, -3), '/') | project id=profileId, compliant=((enabledState=='Enabled') and (mode=='Prevention')), enabledState, mode",
            "guid": "baf8e317-2397-4d49-b3d1-0dcc16d8778d",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-policy-settings",
            "service": "App Gateway",
            "severity": "高い",
            "text": "Application Gateway の WAF ポリシーを \"防止\" モードでデプロイします。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "43fae595-8a32-4299-a69e-0f32c454dcc9",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/rate-limiting-overview",
            "service": "App Gateway",
            "severity": "中程度",
            "text": "Azure Application Gateway WAF にレート制限を追加します。レート制限は、クライアントが短期間に大量のトラフィックを誤ってまたは意図的に送信することをブロックします。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "041e0ad8-7b12-4694-a0b7-a0e25ee2470f",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/rate-limiting-overview#rate-limiting-details",
            "service": "App Gateway",
            "severity": "中程度",
            "text": "Azure Application Gateway の WAF レート制限には高いしきい値を使用します。高いレート制限しきい値は、正当なトラフィックのブロックを回避しながら、インフラストラクチャを圧倒する可能性のある非常に多数の要求に対する保護を提供します。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "99937189-ff78-492a-b9ca-18d828d82b37",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/best-practices#geo-filtering-best-practices",
            "service": "App Gateway",
            "severity": "低い",
            "text": "すべての地域からのトラフィックが想定されていない場合は、地域フィルタを使用して、想定外の国からのトラフィックをブロックします。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "349a15c1-52f4-4319-9078-3895d95ecafd",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/geomatch-custom-rules",
            "service": "App Gateway",
            "severity": "中程度",
            "text": "Azure Application Gateway WAF でトラフィックを geo フィルタリングするときに、不明 (ZZ) の場所を指定します。IP アドレスを地理的に一致させることができない場合に、正当な要求を誤ってブロックしないようにします。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "6c19dfd5-a61c-436c-9001-491b9b3d0228",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/best-practices#use-the-latest-ruleset-versions",
            "service": "App Gateway",
            "severity": "中程度",
            "text": "最新バージョンの Azure Application Gateway WAF ルール セットを使用します。ルール セットの更新は、現在の脅威の状況を考慮して定期的に更新されます。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "f84106a2-2e9e-42ac-add6-d3416ecfed53",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/best-practices#add-diagnostic-settings-to-save-your-wafs-logs",
            "service": "App Gateway",
            "severity": "中程度",
            "text": "診断設定を追加して、Azure Application Gateway の WAF ログを保存します。",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "4cea4050-7946-4a7c-89e6-b021b73c352d",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#add-diagnostic-settings-to-save-your-wafs-logs",
            "service": "Front Door",
            "severity": "中程度",
            "text": "診断設定を追加して、Azure Front Door WAF ログを保存します。",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "92664c60-47e3-4591-8b1b-8d557656e686",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/best-practices#send-logs-to-microsoft-sentinel",
            "service": "App Gateway",
            "severity": "中程度",
            "text": "Azure Application Gateway WAF ログを Microsoft Sentinel に送信します。",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "845f5f91-9c21-4674-a725-5ce890850e20",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#send-logs-to-microsoft-sentinel",
            "service": "Front Door",
            "severity": "中程度",
            "text": "Azure Front Door WAF ログを Microsoft Sentinel に送信します。",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "ba0e9b26-6e0d-4ec8-8541-023c00afd5b7",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/best-practices#define-your-waf-configuration-as-code",
            "service": "App Gateway",
            "severity": "中程度",
            "text": "Azure Application Gateway の WAF 構成をコードとして定義します。コードを使用すると、新しいルール セット バージョンをより簡単に採用し、追加の保護を得ることができます。",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "f17ec301-8470-4afd-aabc-c1fdfe47dcc0",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/policy-overview",
            "service": "App Gateway",
            "severity": "中程度",
            "text": "従来のWAF構成のかわりにWAFポリシーを使用します。",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "d4eb8667-f8cb-4cdd-94e6-2f967ba98f88",
            "link": "https://learn.microsoft.com/azure/virtual-wan/scenario-secured-hub-app-gateway",
            "service": "App Gateway",
            "severity": "中程度",
            "text": "バックエンドの受信トラフィックをフィルター処理して、Application Gateway サブネットからの接続 (NSG など) のみを受け入れるようにします。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "7d3df025-59a3-447d-ac25-3f5750d35de1",
            "link": "https://learn.microsoft.com/azure/frontdoor/origin-security?tabs=app-service-functions",
            "service": "Front Door",
            "severity": "中程度",
            "text": "配信元が Azure Front Door インスタンスからのトラフィックのみを受け取るようにします。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "a66f0fd8-2ca4-422e-8df3-235148127ca2",
            "link": "https://learn.microsoft.com/azure/application-gateway/ssl-overview",
            "service": "App Gateway",
            "severity": "高い",
            "text": "バックエンド・サーバーへのトラフィックを暗号化する必要があります。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "3dba65cb-834d-44d8-a3ca-a6aa2f1587be",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/overview",
            "service": "App Gateway",
            "severity": "高い",
            "text": "Web アプリケーション ファイアウォールを使用する必要があります。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "0158fcb6-0bc1-4687-832f-cc7c359c22d2",
            "link": "https://learn.microsoft.com/azure/application-gateway/redirect-overview",
            "service": "App Gateway",
            "severity": "中程度",
            "text": "HTTPをHTTPSにリダイレクトする",
            "waf": "安全"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "bb697864-1b4c-43af-8667-90cc69aaed5f",
            "link": "https://learn.microsoft.com/azure/application-gateway/how-application-gateway-works#modifications-to-the-request",
            "service": "App Gateway",
            "severity": "中程度",
            "text": "ゲートウェイ管理の Cookie を使用して、ユーザー セッションから同じサーバーにトラフィックを送信して処理する",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "ff353ad8-15fb-4ae8-9fc5-a85a36d36a35",
            "link": "https://learn.microsoft.com/azure/application-gateway/configuration-http-settings",
            "service": "App Gateway",
            "severity": "高い",
            "text": "計画されたサービス更新中に接続ドレインを有効にして、バックエンド プールの既存のメンバーへの接続が失われないようにします",
            "waf": "安全"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "c8741f03-45a4-4183-a6b8-139e0773b8b5",
            "link": "https://learn.microsoft.com/azure/application-gateway/custom-error",
            "service": "App Gateway",
            "severity": "低い",
            "text": "カスタムエラーページを作成して、パーソナライズされたユーザーエクスペリエンスを表示する",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "f850d46f-f5d7-4b17-b48c-a780741402e1",
            "link": "https://learn.microsoft.com/azure/application-gateway/rewrite-http-headers-url",
            "service": "App Gateway",
            "severity": "中程度",
            "text": "HTTPリクエストとレスポンスヘッダーを編集して、クライアントとサーバー間のルーティングと情報交換を容易にします",
            "waf": "安全"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "eadc3164-4a0f-461c-85f1-1a372c04dfd1",
            "link": "https://learn.microsoft.com/azure/frontdoor/front-door-overview",
            "service": "App Gateway",
            "severity": "中程度",
            "text": "Front Door を構成して、グローバルな Web トラフィック ルーティングとトップレベルのエンド ユーザーのパフォーマンスを最適化し、迅速なグローバル フェールオーバーを通じて信頼性を確保します",
            "waf": "パフォーマンス"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "29dcc19f-a8fa-4c35-8281-290577538793",
            "link": "https://learn.microsoft.com/azure/load-balancer/load-balancer-overview",
            "service": "App Gateway",
            "severity": "中程度",
            "text": "トランスポート層の負荷分散を使用する",
            "waf": "パフォーマンス"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "276898c1-af5e-4819-9e8e-049c7801ab9d",
            "link": "https://learn.microsoft.com/azure/application-gateway/multiple-site-overview",
            "service": "App Gateway",
            "severity": "中程度",
            "text": "1 つのゲートウェイ上の複数の Web アプリケーションのホスト名またはドメイン名に基づいてルーティングを構成する",
            "waf": "安全"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "5fe365b6-58e8-47ed-a8cf-5163850380a2",
            "link": "https://learn.microsoft.com/azure/application-gateway/create-ssl-portal",
            "service": "App Gateway",
            "severity": "中程度",
            "text": "SSL証明書管理を一元化して、バックエンドサーバーファームからの暗号化と復号化のオーバーヘッドを削減",
            "waf": "安全"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "fa64b4dd-35c2-4047-ac5c-45dfbf8b0db9",
            "link": "https://learn.microsoft.com/azure/application-gateway/application-gateway-websocket",
            "service": "App Gateway",
            "severity": "低い",
            "text": "Application Gateway を使用して WebSocket と HTTP/2 プロトコルをネイティブにサポートする",
            "waf": "安全"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "d7941d4a-7b6f-458f-8714-2f8f8c059ad4",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-error-handling-policies",
            "service": "APIM",
            "severity": "中程度",
            "text": "グローバルレベルでのエラー処理ポリシーの実装",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "0b0c0765-ff37-4369-90bd-3eb23ce71b08",
            "link": "https://learn.microsoft.com/azure/api-management/set-edit-policies?tabs=form#use-base-element-to-set-policy-evaluation-order",
            "service": "APIM",
            "severity": "中程度",
            "text": "すべての API ポリシーに要素が含まれている<base/>ことを確認します。",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "a5c45b03-93b6-42fe-b16b-8fccb6a79902",
            "link": "https://learn.microsoft.com/azure/api-management/policy-fragments",
            "service": "APIM",
            "severity": "中程度",
            "text": "ポリシーフラグメントを使用して、複数の API で同じポリシー定義を繰り返さないようにする",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "c3818a95-6ff3-4474-88dc-e809b46dad6a",
            "link": "https://learn.microsoft.com/azure/api-management/monetization-support",
            "service": "APIM",
            "severity": "中程度",
            "text": "API の収益化を計画している場合は、「収益化のサポート」の記事でおすすめの方法をご確認ください",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "a7d0840a-c8c4-4e83-adec-5ca578eb4049",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-use-azure-monitor#resource-logs",
            "service": "APIM",
            "severity": "高い",
            "text": "診断設定を有効にしてログを Azure Monitor にエクスポートする",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "8691fa38-45ed-4299-a247-fecd98d35deb",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-app-insights",
            "service": "APIM",
            "severity": "中程度",
            "text": "Application Insights を有効にして、より詳細なテレメトリを実現する",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "55fd27bb-76ac-4a91-bc37-049e885be6b7",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-use-azure-monitor",
            "service": "APIM",
            "severity": "高い",
            "text": "最も重要なメトリックに関するアラートを構成する",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "39460bdb-156f-4dc2-a87f-1e8c11ab0998",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/api-management-security-baseline?toc=%2Fazure%2Fapi-management%2F&bc=%2Fazure%2Fapi-management%2Fbreadcrumb%2Ftoc.json#certificate-management-in-azure-key-vault",
            "service": "APIM",
            "severity": "高い",
            "text": "カスタム SSL 証明書が Azure Key Vault に格納され、安全にアクセスして更新できるようにする",
            "waf": "安全"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "e9217997-5f6c-479d-8576-8f2adf706ec8",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/api-management-security-baseline?toc=%2Fazure%2Fapi-management%2F&bc=%2Fazure%2Fapi-management%2Fbreadcrumb%2Ftoc.json#azure-ad-authentication-required-for-data-plane-access",
            "service": "APIM",
            "severity": "高い",
            "text": "Azure AD を使用して API (データ プレーン) への受信要求を保護する",
            "waf": "安全"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "5e5f64ba-c90e-480e-8888-398d96cf0bfb",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-aad",
            "service": "APIM",
            "severity": "中程度",
            "text": "Azure AD を使用して開発者ポータルでユーザーを認証する",
            "waf": "安全"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "f8e574ce-280f-49c8-b2ef-68279b081cf3",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-create-groups",
            "service": "APIM",
            "severity": "中程度",
            "text": "適切なグループを作成して、製品の可視性を制御します",
            "waf": "安全"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "06862505-2d9a-4874-9491-2837b00a3475",
            "link": "https://learn.microsoft.com/azure/api-management/backends",
            "service": "APIM",
            "severity": "中程度",
            "text": "バックエンド機能を使用して、冗長な API バックエンド構成を排除します",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "03b125d5-b69b-4739-b7fd-84b86da4933e",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-properties?tabs=azure-portal",
            "service": "APIM",
            "severity": "中程度",
            "text": "名前付き値を使用して、ポリシーで使用できる共通の値を格納します",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "beae759e-4ddb-4326-bf26-47f87d3454b6",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-deploy-multi-region",
            "service": "APIM",
            "severity": "中程度",
            "text": "複数の Azure リージョンにデプロイする",
            "waf": "確実"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "9c8d1664-dd9a-49d4-bd83-950af0af4044",
            "link": "https://learn.microsoft.com/azure/api-management/high-availability",
            "service": "APIM",
            "severity": "中程度",
            "text": "リージョンごとに 2 つの可用性ゾーンに分散した少なくとも 2 つのスケール ユニットをデプロイして、最適な可用性とパフォーマンスを実現します",
            "waf": "確実"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "8d2db6e8-85c6-4118-a52c-ae76a4f27934",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/api-management-security-baseline?toc=%2Fazure%2Fapi-management%2F&bc=%2Fazure%2Fapi-management%2Fbreadcrumb%2Ftoc.json#service-native-backup-capability",
            "service": "APIM",
            "severity": "高い",
            "text": "自動バックアップ・ルーチンがあることを確認する",
            "waf": "確実"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "8210699f-8d43-45c2-8f19-57e54134bd8f",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-log-event-hubs",
            "service": "APIM",
            "severity": "低い",
            "text": "高パフォーマンス レベルでログを記録する必要がある場合は、Event Hubs ポリシーを検討してください",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "121bfc39-fa7b-4096-b93b-ab56c1bc0bed",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-sample-flexible-throttling",
            "service": "APIM",
            "severity": "中程度",
            "text": "調整ポリシーを適用して、毎秒の要求数を制御する",
            "training": "https://learn.microsoft.com/training/modules/protect-apis-on-api-management/",
            "waf": "パフォーマンス"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "bb5f356b-3daf-47a2-a9ee-867a8100bbd5",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-autoscale",
            "service": "APIM",
            "severity": "中程度",
            "text": "負荷が増加したときにインスタンスの数をスケールアウトするように自動スケーリングを構成する",
            "waf": "パフォーマンス"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "84b94abb-59b6-4b9d-8587-3413669468e8",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-provision-self-hosted-gateway",
            "service": "APIM",
            "severity": "中程度",
            "text": "セルフホステッド ゲートウェイをデプロイする場所は、Azure のバックエンド API に近いリージョンがありません。",
            "waf": "パフォーマンス"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "7519e385-a88b-4d34-966b-6269d686e890",
            "link": "https://learn.microsoft.com/azure/api-management/front-door-api-management",
            "service": "APIM",
            "severity": "中程度",
            "text": "複数リージョンのデプロイに APIM の前で Azure Front Door を使用するUse Azure Front Door in front of APIM for multi-region deployment",
            "waf": "パフォーマンス"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "cd45c90e-7690-4753-930b-bf290c69c074",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/api-management-security-baseline?toc=%2Fazure%2Fapi-management%2F&bc=%2Fazure%2Fapi-management%2Fbreadcrumb%2Ftoc.json#virtual-network-integration",
            "service": "APIM",
            "severity": "中程度",
            "text": "仮想ネットワーク (VNet) 内にサービスをデプロイするDeploy the service within a Virtual Network (VNet)",
            "waf": "安全"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "02661582-b3d1-48d1-9d7b-c6a918a0ca33",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/api-management-security-baseline?toc=%2Fazure%2Fapi-management%2F&bc=%2Fazure%2Fapi-management%2Fbreadcrumb%2Ftoc.json#network-security-group-support",
            "service": "APIM",
            "severity": "中程度",
            "text": "ネットワーク セキュリティ グループ (NSG) をサブネットにデプロイして、APIM との間のトラフィックを制限または監視します。",
            "waf": "安全"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "67437a28-2721-4a2c-becd-caa54c8237a5",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/api-management-security-baseline?toc=%2Fazure%2Fapi-management%2F&bc=%2Fazure%2Fapi-management%2Fbreadcrumb%2Ftoc.json#azure-private-link",
            "service": "APIM",
            "severity": "中程度",
            "text": "プライベート エンドポイントをデプロイして、APIM が VNet にデプロイされていない場合に受信トラフィックをフィルター処理します。",
            "waf": "安全"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "d698adbd-3288-44cb-b10a-9b572da395ae",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/api-management-security-baseline?toc=%2Fazure%2Fapi-management%2F&bc=%2Fazure%2Fapi-management%2Fbreadcrumb%2Ftoc.json#disable-public-network-access",
            "service": "APIM",
            "severity": "高い",
            "text": "パブリックネットワークアクセスの無効化",
            "waf": "安全"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "0674d750-0c6f-4ac0-8717-ceec04d0bdbd",
            "link": "https://learn.microsoft.com/azure/api-management/automation-manage-api-management",
            "service": "APIM",
            "severity": "中程度",
            "text": "PowerShell 自動化スクリプトで管理を簡素化",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "c385bfcd-49fd-4786-81ba-cedbb4c57345",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/app-platform/api-management/platform-automation-and-devops#design-recommendations",
            "service": "APIM",
            "severity": "中程度",
            "text": "Cloud Adaption Framework APIM Landing Zone Accelerator から DevOps のベスト プラクティスを確認する",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "6c3a27c0-197f-426c-9ffa-86fed51d9ab6",
            "link": "https://learn.microsoft.com/azure/api-management/visual-studio-code-tutorial",
            "service": "APIM",
            "severity": "中程度",
            "text": "Visual Studio Code APIM 拡張機能の使用を促進して API 開発を迅速化する",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "354f1c03-8112-4965-85ad-c0074bddf231",
            "link": "https://learn.microsoft.com/azure/api-management/devops-api-development-templates",
            "service": "APIM",
            "severity": "中程度",
            "text": "DevOpsとCI/CDをワークフローに実装する",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "b6439493-426a-45f3-9697-cf65baee208d",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-mutual-certificates-for-clients",
            "service": "APIM",
            "severity": "中程度",
            "text": "クライアント証明書認証を使用した API の保護",
            "waf": "安全"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "2a67d143-1033-4c0a-8732-680896478f08",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-mutual-certificates",
            "service": "APIM",
            "severity": "中程度",
            "text": "クライアント証明書認証を使用したバックエンド サービスのセキュリティ保護",
            "waf": "安全"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "074435f5-4a46-41ac-b521-d6114cb5d845",
            "link": "https://learn.microsoft.com/azure/api-management/mitigate-owasp-api-threats",
            "service": "APIM",
            "severity": "中程度",
            "text": "「OWASP API Security Top 10 の脅威を軽減するための推奨事項」の記事を確認し、API に適用できるものを確認してください",
            "waf": "安全"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "5507c4b8-a7f8-41d6-9661-418c987100c9",
            "link": "https://learn.microsoft.com/azure/api-management/authorizations-overview",
            "service": "APIM",
            "severity": "中程度",
            "text": "承認機能を使用して、バックエンド API の OAuth 2.0 トークンの管理を簡素化します",
            "waf": "安全"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "2deee033-b906-4bc2-9f26-c8d3699fe091",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-manage-protocols-ciphers",
            "service": "APIM",
            "severity": "高い",
            "text": "転送中の情報を暗号化する場合は、最新のTLSバージョンを使用します。可能であれば、古くて不要なプロトコルと暗号を無効にします。",
            "waf": "安全"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "f8af3d94-1d2b-4070-846f-849197524258",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/api-management-security-baseline?toc=%2Fazure%2Fapi-management%2F&bc=%2Fazure%2Fapi-management%2Fbreadcrumb%2Ftoc.json#im-8-restrict-the-exposure-of-credential-and-secrets",
            "service": "APIM",
            "severity": "高い",
            "text": "シークレット (名前付きの値) が Azure Key Vault に格納され、安全にアクセスして更新できるようにします",
            "waf": "安全"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "791abd8b-7706-4e31-9569-afefde724be3",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/api-management-security-baseline?toc=%2Fazure%2Fapi-management%2F&bc=%2Fazure%2Fapi-management%2Fbreadcrumb%2Ftoc.json#managed-identities",
            "service": "APIM",
            "severity": "中程度",
            "text": "可能な限りマネージド ID を使用して、他の Azure リソースに対する認証を行う",
            "waf": "安全"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "220c4ca6-6688-476b-b2b5-425a78e6fb87",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/api-management-security-baseline?toc=%2Fazure%2Fapi-management%2F&bc=%2Fazure%2Fapi-management%2Fbreadcrumb%2Ftoc.json#ns-6-deploy-web-application-firewall",
            "service": "APIM",
            "severity": "高い",
            "text": "Web アプリケーション ファイアウォール (WAF) を使用して Application Gateway を APIM の前にデプロイする",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "70c15989-c726-42c7-b0d3-24b7375b9201",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/multi-tenant/considerations-recommendations",
            "service": "Entra",
            "severity": "中程度",
            "text": "マルチテナントに関する明確な規制要件またはビジネス要件がない限り、Azure リソースの管理には 1 つの Entra テナントを使用します。",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "6309957b-821a-43d1-b9d9-7fcf1802b747",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/multi-tenant/automation",
            "service": "Entra",
            "severity": "低い",
            "text": "Microsoft Entra ID テナントを管理するためのマルチテナント自動化アプローチがあることを確認する",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "78e11934-499a-45ed-8ef7-aae5578f0ecf",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/multi-tenant/lighthouse",
            "service": "Entra",
            "severity": "低い",
            "text": "マルチテナント管理に Azure Lighthouse を活用する",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "5d82e6df-6f61-42f2-82e2-3132d293be3d",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-microsoft-customer-agreement#design-recommendations",
            "service": "Entra",
            "severity": "中程度",
            "text": "パートナーによるテナントの管理に Azure Lighthouse が使用されていることを確認する",
            "waf": "費用"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "984a859c-773e-47d2-9162-3a765a917e1f",
            "link": "https://learn.microsoft.com/azure/active-directory/roles/security-emergency-access",
            "service": "Entra",
            "severity": "高い",
            "text": "テナント全体のアカウント ロックアウトを防ぐために、緊急アクセスまたは非常用アカウントを実装する",
            "training": "https://learn.microsoft.com/learn/modules/azure-ad-privileged-identity-management/",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "1cf0b8da-70bd-44d0-94af-8d99cfc89ae1",
            "link": "https://learn.microsoft.com/azure/active-directory/reports-monitoring/concept-activity-logs-azure-monitor",
            "service": "Entra",
            "severity": "中程度",
            "text": "Microsoft Entra ID ログをプラットフォーム中心の Azure Monitor と統合します。Azure Monitor を使用すると、Azure のログと監視データに関する信頼できる唯一の情報源が得られ、ログの収集と保持に関する要件を満たすクラウド ネイティブ オプションが組織に提供されます。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "348ef254-c27d-442e-abba-c7571559ab91",
            "link": "https://learn.microsoft.com/azure/role-based-access-control/overview",
            "service": "Entra",
            "severity": "高い",
            "text": "クラウド運用モデルに合わせた RBAC モデルを適用します。管理グループとサブスクリプション全体のスコープと割り当てを行います。",
            "training": "https://learn.microsoft.com/learn/paths/implement-resource-mgmt-security/",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "53e8908a-e28c-484c-93b6-b7808b9fe5c4",
            "link": "https://learn.microsoft.com/azure/active-directory/conditional-access/overview",
            "service": "Entra",
            "severity": "低い",
            "text": "Azure 環境に対する権限を持つすべてのユーザーに Microsoft Entra ID 条件付きアクセス ポリシーを適用する",
            "training": "https://learn.microsoft.com/learn/modules/plan-implement-administer-conditional-access/",
            "waf": "安全"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "1049d403-a923-4c34-94d0-0018ac6a9e01",
            "link": "https://learn.microsoft.com/azure/active-directory/authentication/concept-mfa-howitworks",
            "service": "Entra",
            "severity": "高い",
            "text": "Azure 環境に対する権限を持つすべてのユーザーに多要素認証を適用する",
            "training": "https://learn.microsoft.com/learn/modules/secure-aad-users-with-mfa/",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "14658d35-58fd-4772-99b8-21112df27ee4",
            "link": "https://learn.microsoft.com/azure/active-directory/privileged-identity-management/pim-configure",
            "service": "Entra",
            "severity": "中程度",
            "text": "Microsoft Entra ID Privileged Identity Management (PIM) を適用して、ゼロの永続的なアクセスと最小限の特権を確立します",
            "training": "https://learn.microsoft.com/learn/modules/azure-ad-privileged-identity-management/",
            "waf": "安全"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "12e7f983-f630-4472-8dd6-9c5b5c2622f5",
            "link": "https://learn.microsoft.com/azure/active-directory/roles/security-planning#identify-microsoft-accounts-in-administrative-roles-that-need-to-be-switched-to-work-or-school-accounts",
            "service": "Entra",
            "severity": "高い",
            "text": "すべてのアカウントの種類で、認証の種類である職場または学校アカウントのみを使用します。Microsoft アカウントの使用は避けてください",
            "training": "https://learn.microsoft.com/learn/modules/explore-basic-services-identity-types/",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "4b69bad3-3aad-45e8-a68e-1d76667313b4",
            "link": "https://learn.microsoft.com/azure/active-directory/fundamentals/active-directory-groups-create-azure-portal",
            "service": "Entra",
            "severity": "中程度",
            "text": "アクセス許可の割り当てには、グループのみを使用します。グループ管理システムが既に導入されている場合は、オンプレミス グループを Azure-AD 専用グループに追加します。",
            "training": "https://learn.microsoft.com/learn/paths/manage-identity-and-access/",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "8b9fe5c4-1049-4d40-9a92-3c3474d00018",
            "link": "https://learn.microsoft.com/azure/active-directory-domain-services/overview",
            "service": "Entra",
            "severity": "中程度",
            "text": "Entra Domain Servicesを使用している場合は、すべてのワークロードの互換性を評価します",
            "training": "https://learn.microsoft.com/learn/modules/implement-hybrid-identity-windows-server/",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "d5d1e4e6-1465-48d3-958f-d77249b82111",
            "link": "https://learn.microsoft.com/azure/active-directory/app-proxy/application-proxy",
            "service": "Entra",
            "severity": "中程度",
            "text": "必要に応じて、Microsoft Entra ID アプリケーション プロキシを使用して、内部アプリケーション (クラウドまたはオンプレミスでホストされている) への安全で認証されたアクセスをリモート ユーザーに付与します。",
            "training": "https://learn.microsoft.com/learn/paths/implement-applications-external-access-azure-ad/",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "35037e68-9349-4c15-b371-228514f4cdff",
            "link": "https://learn.microsoft.com/azure/active-directory/roles/best-practices",
            "service": "Entra",
            "severity": "中程度",
            "text": "Microsoft Entra ID ロールの割り当てにオンプレミスの同期アカウントを使用しないでください。",
            "training": "https://learn.microsoft.com/learn/modules/design-identity-security-strategy/",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "143b16c3-1d7a-4a9b-9470-4489a8042d88",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "service": "VNet",
            "severity": "中程度",
            "text": "アプリケーション ランディング ゾーン内のすべてのパブリック IP アドレスに対して DDoS ネットワークまたは IP 保護プランを使用します。",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "guid": "de0d5973-cd4c-4d21-a088-137f5e6c4cfd",
            "link": "https://learn.microsoft.com/en-us/azure/expressroute/expressroute-howto-macsec",
            "service": "ExpressRoute",
            "severity": "中程度",
            "text": "ExpressRoute Direct を使用している場合は、組織のルーターと MSEE 間のレイヤー 2 レベルでトラフィックを暗号化するために MACsec を構成します。この図は、この暗号化をフローで示しています。",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "guid": "ed301d6e-872e-452e-9611-cc58b5a4b151",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-erdirect-about",
            "service": "ExpressRoute",
            "severity": "低い",
            "text": "MACsec がオプションではないシナリオ (ExpressRoute Direct を使用しない場合など) では、VPN ゲートウェイを使用して、ExpressRoute プライベート ピアリング経由で IPsec トンネルを確立します。",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "e8bbac75-7155-49ab-a153-e8908ae28c84",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/enterprise-scale/network-topology-and-connectivity",
            "service": "VNet",
            "severity": "中程度",
            "text": "従来のハブアンドスポーク ネットワーク トポロジに基づくネットワーク設計を、最大限の柔軟性を必要とするネットワーク シナリオに活用します。",
            "training": "https://learn.microsoft.com/learn/paths/architect-network-infrastructure/",
            "waf": "安全"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "7dd61623-a364-4a90-9eca-e48ebd54cd7d",
            "link": "https://learn.microsoft.com/azure/architecture/reference-architectures/hybrid-networking/expressroute",
            "service": "VNet",
            "severity": "高い",
            "text": "ExpressRoute ゲートウェイ、VPN ゲートウェイ、Azure Firewall などの共有ネットワーク サービス、または中央ハブ仮想ネットワーク内のパートナーの NVA を確認します。必要に応じて、DNS サーバーも展開します。",
            "waf": "費用"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "e2e8abac-3571-4559-ab91-53e89f89dc7b",
            "link": "https://learn.microsoft.com/azure/architecture/reference-architectures/dmz/nva-ha",
            "service": "NVA",
            "severity": "中程度",
            "text": "パートナー ネットワーク テクノロジまたは NVA をデプロイする場合は、パートナー ベンダーのガイダンスに従ってください",
            "waf": "確実"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "guid": "ce463dbb-bc8a-4c2a-aebc-92a43da1dae2",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-howto-coexist-resource-manager#to-enable-transit-routing-between-expressroute-and-azure-vpn",
            "service": "ExpressRoute",
            "severity": "低い",
            "text": "ハブ アンド スポーク シナリオで ExpressRoute と VPN ゲートウェイ間の転送が必要な場合は、Azure Route Server を使用します。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,subnets=properties.subnets | mv-expand subnets | project id, subnetName = subnets.name, subnetPrefix = subnets.properties.addressPrefix | extend subnetPrefixLength = split(subnetPrefix, '/')[1] | where subnetName == 'RouteServerSubnet' | extend compliant = (subnetPrefixLength <= 27) | distinct id, compliant",
            "guid": "91b9d7d5-91e1-4dcb-8f1f-fa7e465646cc",
            "link": "https://learn.microsoft.com/azure/route-server/quickstart-configure-route-server-portal#create-a-route-server-1",
            "service": "ARS",
            "severity": "低い",
            "text": "Route Server を使用する場合は、Route Server サブネットに /27 プレフィックスを使用します。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "cc881471-607c-41cc-a0e6-14658dd558f9",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-networks-faq#can-i-create-a-peering-connection-to-a-vnet-in-a-different-region",
            "service": "VNet",
            "severity": "中程度",
            "text": "複数のハブ アンド スポーク トポロジを持つネットワーク アーキテクチャでは、ハブ VNet 間のグローバル仮想ネットワーク ピアリングを使用して、リージョンを相互に接続します。",
            "training": "https://learn.microsoft.com/learn/paths/azure-administrator-manage-virtual-networks/",
            "waf": "パフォーマンス"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "4722d929-c1b1-4cd6-81f5-4b29bade39ad",
            "link": "https://learn.microsoft.com/azure/azure-monitor/insights/network-insights-overview",
            "service": "VNet",
            "severity": "中程度",
            "text": "Azure Monitor for Networks を使用して、Azure 上のネットワークのエンド ツー エンドの状態を監視します。",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-network-monitoring/",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type == 'microsoft.network/virtualnetworks' | mvexpand properties.virtualNetworkPeerings | summarize peeringcount = count() by id | extend compliant = (peeringcount < 450) | distinct id,compliant",
            "guid": "0e7c28ec-9366-4572-83b0-f4664b1d944a",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits?toc=/azure/virtual-network/toc.json#azure-resource-manager-virtual-networking-limits",
            "service": "VNet",
            "severity": "中程度",
            "text": "スポーク仮想ネットワークを中央ハブ仮想ネットワークに接続する場合は、ExpressRoute 経由でアドバタイズできるプレフィックスの最大数である VNet ピアリングの制限 (500) (1000) を考慮してください",
            "waf": "確実"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/routetables' | mvexpand properties.routes | summarize routeCount = count() by id | extend compliant = (routeCount < 360) | distinct id,compliant",
            "guid": "3d457936-e9b7-41eb-bdff-314b26450b12",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits?toc=/azure/virtual-network/toc.json#azure-resource-manager-virtual-networking-limits",
            "service": "VNet",
            "severity": "中程度",
            "text": "ルート テーブルあたりのルート数の制限 (400) を考慮します。",
            "waf": "確実"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type == 'microsoft.network/virtualnetworks' | mvexpand properties.virtualNetworkPeerings | project id, peeringName=properties_virtualNetworkPeerings.name, compliant = (properties_virtualNetworkPeerings.properties.allowVirtualNetworkAccess == True)",
            "guid": "c76cb5a2-abe2-11ed-afa1-0242ac120002",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-network-manage-peering",
            "service": "VNet",
            "severity": "高い",
            "text": "VNet ピアリングを構成するときに [リモート仮想ネットワークへのトラフィックを許可する] 設定を使用します",
            "waf": "確実"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "guid": "359c373e-7dd6-4162-9a36-4a907ecae48e",
            "link": "https://learn.microsoft.com/azure/architecture/reference-architectures/hybrid-networking/hub-spoke?tabs=cli",
            "service": "ExpressRoute",
            "severity": "中程度",
            "text": "ExpressRoute を Azure へのプライマリ接続として使用する可能性を調査したことを確認します。",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "パフォーマンス"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "description": "AS パスのプリペンドと接続の重みを使用して、Azure からオンプレミスへのトラフィックに影響を与え、独自のルーターの全範囲の BGP 属性を使用して、オンプレミスから Azure へのトラフィックに影響を与えることができます。",
            "guid": "f29812b2-363c-4efe-879b-599de0d5973c",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-routing",
            "service": "ExpressRoute",
            "severity": "中程度",
            "text": "複数の ExpressRoute 回線、または複数のオンプレミスの場所を使用する場合、特定のパスが優先される場合は、BGP 属性を使用してルーティングを最適化してください。",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "確実"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources| where type == 'microsoft.network/virtualnetworkgateways'| where properties.gatewayType =~ 'vpn' or properties.gatewayType == 'ExpressRoute'| extend SKUName = properties.sku.name, SKUTier = properties.sku.tier, Type = properties.gatewayType| extend compliant = SKUTier !in ('Basic', 'Standard')| project name, id, subscriptionId, resourceGroup, compliant",
            "guid": "d4cd21b0-8813-47f5-b6c4-cfd3e504547c",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-routing",
            "service": "ExpressRoute",
            "severity": "中程度",
            "text": "帯域幅とパフォーマンスの要件に基づいて、ExpressRoute/VPN ゲートウェイに適切な SKU を使用していることを確認します。",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "パフォーマンス"
        },
        {
            "ammp": true,
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/expressroutecircuits' | extend compliant = (tolower(sku.family) == 'metereddata' or tolower(sku.tier) == 'local') | distinct id,compliant",
            "guid": "7025b442-f6e9-4af6-b11f-c9574916016f",
            "link": "https://learn.microsoft.com/azure/expressroute/plan-manage-cost",
            "service": "ExpressRoute",
            "severity": "高い",
            "text": "無制限のデータ ExpressRoute 回線は、コストに見合った帯域幅に達した場合にのみ使用してください。",
            "waf": "費用"
        },
        {
            "ammp": true,
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/connections' | where properties.connectionType == 'ExpressRoute' | project id, gwid=tostring(properties.virtualNetworkGateway1.id), circuitid=tostring(properties.peer.id) | join (resources | where type=='microsoft.network/expressroutecircuits' | project circuitid=tostring(id), circuitsku=sku.tier) on circuitid | project id=gwid, compliant = (circuitsku == 'Local') | summarize compliant=max(compliant) by id",
            "guid": "f4e7926a-ec35-476e-a412-5dd17136bd62",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-faqs#expressroute-local",
            "service": "ExpressRoute",
            "severity": "高い",
            "text": "回線のピアリングの場所がローカル SKU の Azure リージョンをサポートしている場合は、ExpressRoute のローカル SKU を利用して回線のコストを削減します。",
            "waf": "費用"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources| where type == 'microsoft.network/virtualnetworkgateways'| where properties.gatewayType =~ 'vpn' or properties.gatewayType == 'ExpressRoute'| extend SKUName = properties.sku.name, SKUTier = properties.sku.tier, Type = properties.gatewayType| extend compliant = SKUTier contains 'AZ'| project name, id, subscriptionId, resourceGroup, Type, compliant",
            "guid": "2447ec66-138a-4720-8f1c-e16ed301d6e8",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-about-virtual-network-gateways",
            "service": "ExpressRoute",
            "severity": "中程度",
            "text": "サポートされている Azure リージョンにゾーン冗長 ExpressRoute ゲートウェイをデプロイします。",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "確実"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "guid": "72e52e36-11cc-458b-9a4b-1511e43a58a9",
            "link": "https://learn.microsoft.com/azure/networking/",
            "service": "ExpressRoute",
            "severity": "中程度",
            "text": "10 Gbps を超える帯域幅または専用の 10/100 Gbps ポートを必要とするシナリオでは、ExpressRoute Direct を使用します。",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "パフォーマンス"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "guid": "c2299c4d-7b57-4d0c-9555-62f2b3e4563a",
            "link": "https://learn.microsoft.com/azure/expressroute/about-fastpath",
            "service": "ExpressRoute",
            "severity": "中程度",
            "text": "待機時間を短くする必要がある場合、またはオンプレミスから Azure へのスループットを 10 Gbps を超える必要がある場合は、FastPath を有効にして、データ パスから ExpressRoute ゲートウェイをバイパスします。",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "パフォーマンス"
        },
        {
            "arm-service": "microsoft.network/vpnGateways",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/virtualnetworkgateways' | where properties.gatewayType == 'Vpn' | extend compliant = (tolower(properties.sku.name) contains 'az') | distinct id, compliant",
            "guid": "4d873974-8b66-42d6-b15f-512a65498f6d",
            "link": "https://learn.microsoft.com/azure/vpn-gateway/create-zone-redundant-vnet-gateway",
            "service": "VPN",
            "severity": "中程度",
            "text": "ゾーン冗長 VPN ゲートウェイを使用して、ブランチまたはリモートの場所を Azure に接続します (使用可能な場合)。",
            "training": "https://learn.microsoft.com/training/modules/intro-to-azure-vpn-gateway/",
            "waf": "確実"
        },
        {
            "arm-service": "microsoft.network/vpnGateways",
            "checklist": "Azure Landing Zone Review",
            "guid": "45866df8-cf85-4ca9-bbe2-65ec1478919e",
            "link": "https://learn.microsoft.com/azure/vpn-gateway/vpn-gateway-highlyavailable",
            "service": "VPN",
            "severity": "中程度",
            "text": "冗長 VPN アプライアンスをオンプレミス (アクティブ/アクティブまたはアクティブ/パッシブ) で使用します。",
            "training": "https://learn.microsoft.com/training/modules/intro-to-azure-vpn-gateway/",
            "waf": "確実"
        },
        {
            "ammp": true,
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "guid": "718cb437-b060-2589-8856-2e93a5c6633b",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-erdirect-about",
            "service": "ExpressRoute",
            "severity": "高い",
            "text": "ExpressRoute Direct を使用する場合は、コストを節約するために、ローカルの Azure リージョンへの ExpressRoute Local 回線の使用を検討してください",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "費用"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "guid": "8042d88e-79d1-47b7-9b22-a5a67e7a8ed4",
            "link": "https://learn.microsoft.com/azure/architecture/framework/services/networking/expressroute/reliability",
            "service": "ExpressRoute",
            "severity": "中程度",
            "text": "運用環境と非運用環境を分離する場合など、トラフィックの分離または専用の帯域幅が必要な場合は、異なる ExpressRoute 回線を使用します。これにより、ルーティング ドメインが分離され、ノイジー ネイバーのリスクが軽減されます。",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "guid": "b30e38c3-f298-412b-8363-cefe179b599d",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-monitoring-metrics-alerts",
            "service": "ExpressRoute",
            "severity": "中程度",
            "text": "組み込みの Express Route Insights を使用して、ExpressRoute の可用性と使用率を監視します。",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "オペレーションズ"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "guid": "5bf68dc9-325e-4873-bf88-f8214ef2e5d2",
            "link": "https://learn.microsoft.com/azure/expressroute/how-to-configure-connection-monitor",
            "service": "ExpressRoute",
            "severity": "中程度",
            "text": "接続モニターは、ネットワーク全体 (特にオンプレミスと Azure 間) の接続を監視するために使用します。",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "オペレーションズ"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/connections' | where properties.connectionType == 'ExpressRoute' | project cxId=id, gwId=tostring(properties.virtualNetworkGateway1.id), circuitId=tostring(properties.peer.id) | join (resources | where type=='microsoft.network/expressroutecircuits' | project circuitId=tostring(id), circuitLocation=tostring(properties.serviceProviderProperties.peeringLocation)) on circuitId | distinct gwId, circuitLocation | summarize countErLocations=count() by id=gwId | extend compliant = (countErLocations >= 2)",
            "guid": "e0d5973c-d4cd-421b-8881-37f5e6c4cfd3",
            "link": "https://learn.microsoft.com/azure/expressroute/designing-for-disaster-recovery-with-expressroute-privatepeering#challenges-of-using-multiple-expressroute-circuits",
            "service": "ExpressRoute",
            "severity": "中程度",
            "text": "冗長性のために、異なるピアリングの場所からの ExpressRoute 回線を使用します。",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "確実"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "guid": "cf3fe65c-fec0-495a-8edc-9675200f2add",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-howto-coexist-resource-manager",
            "service": "ExpressRoute",
            "severity": "中程度",
            "text": "ExpressRoute のフェールオーバーとしてサイト間 VPN を使用します (特に、1 つの ExpressRoute 回線のみを使用する場合)。",
            "waf": "確実"
        },
        {
            "ammp": true,
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,resourceGroup,name,subnets=properties.subnets | mv-expand subnets | project id,resourceGroup,name,subnetName=tostring(subnets.name),routeTableId=tostring(subnets.properties.routeTable.id) | where subnetName == 'GatewaySubnet' | join kind=leftouter (Resources | where type == 'microsoft.network/routetables' | project routeTableName=name,routeTableId=id, disableBgpRoutePropagation=properties.disableBgpRoutePropagation) on routeTableId | project id,compliant = (disableBgpRoutePropagation == False or isnull(disableBgpRoutePropagation))",
            "guid": "72105cc8-aaea-4ee1-8c7a-ad25977afcaf",
            "link": "https://learn.microsoft.com/azure/vpn-gateway/vpn-gateway-about-vpn-gateway-settings#gwsub",
            "service": "ExpressRoute",
            "severity": "高い",
            "text": "GatewaySubnet でルート テーブルを使用している場合は、ゲートウェイ ルートが伝達されていることを確認します。",
            "waf": "確実"
        },
        {
            "ammp": true,
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "guid": "d581a947-69a2-4783-942e-9df3664324c8",
            "link": "https://learn.microsoft.com/azure/expressroute/designing-for-high-availability-with-expressroute#active-active-connections",
            "service": "ExpressRoute",
            "severity": "高い",
            "text": "ExpressRoute を使用する場合、オンプレミスのルーティングは動的である必要があり、接続障害が発生した場合は、回線の残りの接続に収束する必要があります。負荷は、アクティブ/パッシブもサポートされていますが、理想的にはアクティブ/アクティブとして両方の接続で共有する必要があります。",
            "waf": "確実"
        },
        {
            "ammp": true,
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "guid": "558fd772-49b8-4211-82df-27ee412e7f98",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-ip-addressing",
            "service": "ExpressRoute",
            "severity": "高い",
            "text": "Azure リージョンとオンプレミスの場所間で重複する IP アドレス空間が使用されていないことを確認します",
            "training": "https://learn.microsoft.com/learn/paths/architect-network-infrastructure/",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type == 'microsoft.network/virtualnetworks' | extend addressSpace = todynamic(properties.addressSpace) | extend addressPrefix = todynamic(properties.addressSpace.addressPrefixes) | mvexpand addressSpace | mvexpand addressPrefix | project name, id, location, resourceGroup, subscriptionId, cidr = addressPrefix | extend compliant = (cidr matches regex @'^(10\\\\.|172\\\\.(1[6-9]|2[0-9]|3[01])\\\\.|192\\\\.168\\\\.)')  | project id, compliant, cidr",
            "guid": "3f630472-2dd6-49c5-a5c2-622f54b69bad",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-ip-addressing",
            "service": "VNet",
            "severity": "低い",
            "text": "プライベート インターネットのアドレス割り当て範囲 (RFC 1918) の IP アドレスを使用します。",
            "training": "https://learn.microsoft.com/learn/paths/architect-network-infrastructure/",
            "waf": "安全"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type == 'microsoft.network/virtualnetworks' | extend addressSpace = todynamic(properties.addressSpace) | extend addressPrefix = todynamic(properties.addressSpace.addressPrefixes) | mvexpand addressSpace | mvexpand addressPrefix | extend addressMask = split(addressPrefix,'/')[1] | extend compliant = addressMask > 16 | project name, id, subscriptionId, resourceGroup, addressPrefix, compliant",
            "guid": "33aad5e8-c68e-41d7-9667-313b4f5664b5",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-ip-addressing",
            "service": "VNet",
            "severity": "高い",
            "text": "IP アドレス空間が無駄にならないようにし、不必要に大きな仮想ネットワーク (/16 など) を作成しないようにします",
            "training": "https://learn.microsoft.com/learn/paths/architect-network-infrastructure/",
            "waf": "パフォーマンス"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "f348ef25-4c27-4d42-b8bb-ac7571559ab9",
            "link": "https://learn.microsoft.com/azure/site-recovery/concepts-on-premises-to-azure-networking#retain-ip-addresses",
            "service": "VNet",
            "severity": "高い",
            "text": "運用サイトと DR サイトで重複する IP アドレス範囲を使用しないでください。",
            "training": "https://learn.microsoft.com/learn/paths/az-104-manage-virtual-networks/",
            "waf": "確実"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "153e8908-ae28-4c84-a33b-6b7808b9fe5c",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-networks-name-resolution-for-vms-and-role-instances",
            "service": "DNS",
            "severity": "中程度",
            "text": "Azure での名前解決のみが必要な環境では、名前解決用の委任されたゾーン ('azure.contoso.com' など) を使用して解決に Azure プライベート DNS を使用します。",
            "training": "https://learn.microsoft.com/learn/paths/az-104-manage-virtual-networks/",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "41049d40-3a92-43c3-974d-00018ac6a9e0",
            "link": "https://learn.microsoft.com/azure/dns/dns-private-resolver-overview",
            "service": "DNS",
            "severity": "中程度",
            "text": "Azure とオンプレミスでの名前解決が必要な環境では、Azure DNS Private Resolver の使用を検討してください。",
            "training": "https://learn.microsoft.com/training/modules/intro-to-azure-dns-private-resolver/",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "1e6a83de-5de3-42c1-a924-81607d5d1e4e",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-networks-name-resolution-for-vms-and-role-instances",
            "service": "DNS",
            "severity": "低い",
            "text": "独自の DNS (Red Hat OpenShift など) を必要としてデプロイする特別なワークロードでは、優先 DNS ソリューションを使用する必要があります。",
            "waf": "オペレーションズ"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "614658d3-558f-4d77-849b-821112df27ee",
            "link": "https://learn.microsoft.com/azure/dns/private-dns-autoregistration",
            "service": "DNS",
            "severity": "高い",
            "text": "Azure DNS の自動登録を有効にすると、仮想ネットワーク内にデプロイされた仮想マシンの DNS レコードのライフサイクルが自動的に管理されます。",
            "training": "https://learn.microsoft.com/learn/paths/az-104-manage-virtual-networks/",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "ee1ac551-c4d5-46cf-b035-d0a3c50d87ad",
            "link": "https://learn.microsoft.com/azure/bastion/bastion-overview",
            "service": "Bastion",
            "severity": "中程度",
            "text": "Azure Bastion を使用してネットワークに安全に接続することを検討してください。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,subnets=properties.subnets | mv-expand subnets | project id, subnetName = subnets.name, subnetPrefix = subnets.properties.addressPrefix | extend subnetPrefixLength = split(subnetPrefix, '/')[1] | where subnetName == 'AzureBastionSubnet' | extend compliant = (subnetPrefixLength <= 26) | distinct id, compliant",
            "guid": "6eab9eb6-762b-485e-8ea8-15aa5dba0bd0",
            "link": "https://learn.microsoft.com/azure/bastion/bastion-faq#subnet",
            "service": "Bastion",
            "severity": "中程度",
            "text": "Azure Bastion は、サブネット /26 以上で使用します。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "e6c4cfd3-e504-4547-a244-7ec66138a720",
            "link": "https://learn.microsoft.com/azure/app-service/networking-features",
            "service": "Firewall",
            "severity": "高い",
            "text": "Azure Firewall を使用して、インターネットへの Azure 送信トラフィック、HTTP/S 以外の受信接続、East/West トラフィック フィルター処理 (組織で必要な場合) を管理します",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "5a4b1511-e43a-458a-ac22-99c4d7b57d0c",
            "link": "https://learn.microsoft.com/azure/firewall/",
            "service": "Firewall",
            "severity": "中程度",
            "text": "グローバル ネットワーク環境全体のセキュリティ体制を管理するグローバル Azure Firewall ポリシーを作成し、それをすべての Azure Firewall インスタンスに割り当てます。Azure のロールベースのアクセス制御を介して増分ファイアウォール ポリシーをローカルのセキュリティ チームに委任することで、特定のリージョンの要件を満たすきめ細かなポリシーが可能になります。",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "655562f2-b3e4-4563-a4d8-739748b662d6",
            "link": "https://learn.microsoft.com/azure/firewall/",
            "service": "Firewall",
            "severity": "低い",
            "text": "組織がそのようなソリューションを使用してアウトバウンド接続を保護する場合は、Firewall Manager 内でサポートされているパートナーの SaaS セキュリティ プロバイダーを構成します。",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "1d7aa9b6-4704-4489-a804-2d88e79d17b7",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/afds-overview",
            "service": "WAF",
            "severity": "中程度",
            "text": "Azure Front Door と WAF ポリシーを使用して、ランディング ゾーンへの受信 HTTP/S 接続に対して Azure リージョン全体でグローバル保護を提供します。",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "3b22a5a6-7e7a-48ed-9b30-e38c3f29812b",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "service": "WAF",
            "severity": "低い",
            "text": "Azure Front Door と Azure Application Gateway を使用して HTTP/S アプリを保護する場合は、Azure Front Door で WAF ポリシーを使用します。Azure Application Gateway をロックダウンして、Azure Front Door からのトラフィックのみを受信するようにします。",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "安全"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "2363cefe-179b-4599-be0d-5973cd4cd21b",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "service": "WAF",
            "severity": "高い",
            "text": "WAF とその他のリバース プロキシは、受信 HTTP/S 接続に必要であり、ランディング ゾーン仮想ネットワーク内にデプロイし、保護してインターネットに公開しているアプリと共にデプロイします。",
            "training": "https://learn.microsoft.com/learn/paths/architect-network-infrastructure/",
            "waf": "安全"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "088137f5-e6c4-4cfd-9e50-4547c2447ec6",
            "link": "https://learn.microsoft.com/azure/ddos-protection/ddos-protection-reference-architectures",
            "service": "VNet",
            "severity": "高い",
            "text": "Azure DDoS ネットワークまたは IP Protection プランを使用して、仮想ネットワーク内のパブリック IP アドレス エンドポイントを保護します。",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "安全"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/firewallpolicies' | extend compliant = (properties.dnsSettings.enableProxy == true) | distinct id,compliant",
            "guid": "14d99880-2f88-47e8-a134-62a7d85c94af",
            "link": "https://learn.microsoft.com/azure/firewall/fqdn-filtering-network-rules",
            "service": "Firewall",
            "severity": "高い",
            "text": "FQDN ベースのネットワーク ルールと DNS プロキシを備えた Azure Firewall を使用して、アプリケーション ルールでサポートされていないプロトコルを介してインターネットへのエグレス トラフィックをフィルター処理します。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/firewallpolicies' | extend compliant = (properties.sku.tier == 'Premium') | distinct id,compliant",
            "guid": "c10d51ef-f999-455d-bba0-5c90ece07447",
            "link": "https://learn.microsoft.com/azure/firewall/premium-features",
            "service": "Firewall",
            "severity": "高い",
            "text": "Azure Firewall Premium を使用して、セキュリティと保護を強化します。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/firewallpolicies' | extend compliant = (properties.threatIntelMode == 'Deny') | distinct id,compliant",
            "guid": "e9c8f584-6d5e-473b-8dc5-acc9fbaab4e3",
            "link": "https://learn.microsoft.com/azure/firewall/premium-features",
            "service": "Firewall",
            "severity": "高い",
            "text": "保護を強化するために、Azure Firewall 脅威インテリジェンス モードを [アラート] と [拒否] に構成します。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/firewallpolicies' | extend compliant = (properties.intrusionDetection.mode == 'Deny') | project id, compliant",
            "guid": "b9d0dff5-bdd4-4cd8-88ed-5811610b2b2c",
            "link": "https://learn.microsoft.com/azure/firewall/premium-features#idps",
            "service": "Firewall",
            "severity": "高い",
            "text": "保護を強化するために、Azure Firewall IDPS モードを [拒否] に構成します。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,resourceGroup,name,subnets=properties.subnets | mv-expand subnets | project id,name,subnetId=tostring(subnets.id), subnetName=tostring(subnets.name),subnetRT=subnets.properties.routeTable.id | where not (subnetName in ('GatewaySubnet', 'AzureFirewallSubnet', 'RouteServerSubnet', 'AzureBastionSubnet')) | extend hasRT = isnotnull(subnetRT) | distinct id, hasRT, subnetId | join kind=fullouter (resources | where type == 'microsoft.network/virtualnetworks' | mvexpand properties.virtualNetworkPeerings | extend isVWAN=(tolower(split(properties_virtualNetworkPeerings.name, '_')[0]) == 'remotevnettohubpeering') | mv-expand properties.subnets | project id, isVWAN, name, subnetId=tostring(properties_subnets.id), subnetName=tostring(properties_subnets.name) | summarize PeeredToVWAN=max(isVWAN) by id, subnetId | project id, subnetId, isVWANpeer = (PeeredToVWAN == true)) on subnetId | project id=iff(isnotempty(id), id, id1), subnetId=iff(isnotempty(subnetId), subnetId, subnetId1), hasRT, isVWANpeer | extend compliant = (hasRT==true or isVWANpeer==true) | distinct id, subnetId, compliant",
            "guid": "a3784907-9836-4271-aafc-93535f8ec08b",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-networks-udr-overview",
            "service": "Firewall",
            "severity": "高い",
            "text": "Virtual WAN に接続されていない VNet 内のサブネットの場合は、インターネット トラフィックが Azure Firewall またはネットワーク仮想アプライアンスにリダイレクトされるようにルート テーブルをアタッチします",
            "waf": "安全"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "b034c01e-110b-463a-b36e-e3346e57f225",
            "link": "https://learn.microsoft.com/en-us/azure/virtual-network/ip-services/default-outbound-access",
            "service": "VNet",
            "severity": "高い",
            "text": "今後の破壊的変更の前に、ネットワーク送信トラフィックの構成と戦略を評価および確認します。2025 年 9 月 30 日に、新しいデプロイの既定の送信アクセスは廃止され、明示的なアクセス構成のみが許可されます",
            "waf": "確実"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "b1c82a3f-2320-4dfa-8972-7ae4823c8930",
            "link": "https://learn.microsoft.com/azure/ddos-protection/ddos-protection-reference-architectures",
            "service": "VNet",
            "severity": "高い",
            "text": "診断設定を追加して、保護されているすべてのパブリック IP アドレス (DDoS IP またはネットワーク保護) の DDoS 関連ログを保存します。",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "安全"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "715d833d-4708-4527-90ac-1b142c7045ba",
            "link": "https://learn.microsoft.com/en-us/azure/firewall/firewall-structured-logs",
            "service": "Firewall",
            "severity": "中程度",
            "text": "すべての Azure Firewall デプロイのログを保存するための診断設定を、リソース固有の宛先テーブルに追加します。",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "オペレーションズ"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "e960fc6b-4ab2-4db6-9609-3745135f9ffa",
            "link": "https://learn.microsoft.com/en-us/azure/firewall-manager/migrate-to-policy",
            "service": "Firewall",
            "severity": "大事な",
            "text": "Azure Firewall クラシック規則 (存在する場合) からファイアウォール ポリシーに移行します。",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "オペレーションズ"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "d301d6e8-72e5-42e3-911c-c58b5a4b1511",
            "link": "https://learn.microsoft.com/azure/virtual-network/vnet-integration-for-azure-services",
            "service": "App Gateway",
            "severity": "高い",
            "text": "仮想ネットワークに挿入された Azure PaaS サービスのコントロール プレーン通信が、たとえば、コントロール プレーンのトラフィックをブロックする 0.0.0.0/0 ルートや NSG ルールによって切断されていないことを確認します。",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/?source=learn",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "guid": "b3e4563a-4d87-4397-98b6-62d6d15f512a",
            "link": "https://learn.microsoft.com/azure/app-service/networking-features",
            "service": "ExpressRoute",
            "severity": "中程度",
            "text": "オンプレミスからプライベート エンドポイントと ExpressRoute プライベート ピアリングを介して Azure PaaS サービスにアクセスします。この方法では、パブリック インターネット経由のトランジットが回避されます。",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type =~ 'microsoft.network/virtualnetworks' | project id,resourceGroup,name,subnets = properties.subnets | mv-expand subnets | project id = subnets.id, resourceGroup, VNet = name, serviceEndpoints = subnets.properties.serviceEndpoints, compliant = (isnull(subnets.properties.serviceEndpoints) or array_length(subnets.properties.serviceEndpoints) == 0) | order by compliant asc",
            "guid": "4704489a-8042-4d88-b79d-17b73b22a5a6",
            "link": "https://learn.microsoft.com/azure/app-service/networking-features",
            "service": "VNet",
            "severity": "中程度",
            "text": "すべてのサブネットで仮想ネットワーク サービス エンドポイントを既定で有効にしないでください。",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/?source=learn",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "7e7a8ed4-b30e-438c-9f29-812b2363cefe",
            "link": "https://learn.microsoft.com/azure/app-service/networking-features",
            "service": "Firewall",
            "severity": "中程度",
            "text": "Azure Firewall または NVA の IP アドレスの代わりに FQDN を使用して Azure PaaS サービスへのエグレス トラフィックをフィルター処理し、データ流出を防ぎます。Private Link を使用している場合は、すべての FQDN をブロックし、それ以外の場合は必要な PaaS サービスのみを許可できます。",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/?source=learn",
            "waf": "安全"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,subnets=properties.subnets | mv-expand subnets | project id, subnetName = subnets.name, subnetPrefix = subnets.properties.addressPrefix | extend subnetPrefixLength = split(subnetPrefix, '/')[1] | where subnetName == 'AzureFirewallSubnet' | extend compliant = (subnetPrefixLength == 26) | distinct id, compliant",
            "guid": "22d6419e-b627-4d95-9e7d-019fa759387f",
            "link": "https://learn.microsoft.com/azure/firewall/firewall-faq#why-does-azure-firewall-need-a--26-subnet-size",
            "service": "Firewall",
            "severity": "高い",
            "text": "Azure Firewall サブネットに /26 プレフィックスを使用します。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,subnets=properties.subnets | mv-expand subnets | project id, subnetName = subnets.name, subnetPrefix = subnets.properties.addressPrefix | extend subnetPrefixLength = split(subnetPrefix, '/')[1] | where subnetName == 'GatewaySubnet' | extend compliant = (subnetPrefixLength <= 27) | distinct id, compliant",
            "guid": "f2aad7e3-bb03-4adc-8606-4123d342a917",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-howto-add-gateway-resource-manager#add-a-gateway",
            "service": "ExpressRoute",
            "severity": "高い",
            "text": "Gateway サブネットに少なくとも /27 プレフィックスを使用する",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/networksecuritygroups' | mvexpand properties.securityRules | project id,name,ruleAction=properties_securityRules.properties.access,rulePriority=properties_securityRules.properties.priority,ruleDst=properties_securityRules.properties.destinationAddressPrefix,ruleSrc=properties_securityRules.properties.sourceAddressPrefix,ruleProt=properties_securityRules.properties.protocol,ruleDirection=properties_securityRules.properties.direction,rulePort=properties_securityRules.properties.destinationPortRange | summarize StarDenies=countif(ruleAction=='Deny' and ruleDst=='*' and ruleSrc=='*' and ruleProt=='*' and rulePort=='*') by id,tostring(ruleDirection) | where ruleDirection == 'Inbound' | project id,compliant=(StarDenies>0) | union (resources | where type=='microsoft.network/networksecuritygroups' | where array_length(properties.securityRules)==0 | extend compliant=false | project id,compliant)",
            "guid": "11deb39d-8299-4e47-bbe0-0fb5a36318a8",
            "link": "https://learn.microsoft.com/azure/virtual-network/service-tags-overview#available-service-tags",
            "service": "NSG",
            "severity": "中程度",
            "text": "接続を制限するために、VirtualNetwork サービス タグを使用する NSG 受信の既定の規則に依存しないでください。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "872e52e3-611c-4c58-a5a4-b1511e43a58a",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "service": "NSG",
            "severity": "中程度",
            "text": "NSG を使用して、サブネット間のトラフィックと、プラットフォーム全体の East/West トラフィック (ランディング ゾーン間のトラフィック) を保護します。",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "graph": "Resources | where type=='microsoft.network/virtualnetworks' | project id,resourceGroup,name,subnets=properties.subnets | mv-expand subnets | project id,name,subnetName=subnets.name,subnetNsg=subnets.properties.networkSecurityGroup | where not (subnetName in ('GatewaySubnet', 'AzureFirewallSubnet', 'RouteServerSubnet', 'AzureBastionSubnet')) | extend compliant = isnotnull(subnetNsg)",
            "guid": "9c2299c4-d7b5-47d0-a655-562f2b3e4563",
            "service": "NSG",
            "severity": "中程度",
            "text": "アプリケーション チームは、サブネット レベルの NSG でアプリケーション セキュリティ グループを使用して、ランディング ゾーン内の多層 VM を保護する必要があります。",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "a4d87397-48b6-462d-9d15-f512a65498f6",
            "link": "https://learn.microsoft.com/azure/virtual-network/network-security-group-how-it-works",
            "service": "NSG",
            "severity": "中程度",
            "text": "NSG とアプリケーション セキュリティ グループを使用して、ランディング ゾーン内のトラフィックを細かくセグメント化し、中央の NVA を使用してトラフィック フローをフィルター処理しないようにします。",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "dfe237de-143b-416c-91d7-aa9b64704489",
            "link": "https://learn.microsoft.com/azure/virtual-network/network-security-group-how-it-works",
            "service": "NSG",
            "severity": "中程度",
            "text": "VNet フロー ログを有効にして Traffic Analytics にフィードし、内部および外部のトラフィック フローに関する分析情報を取得します。",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-network-monitoring/",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type == 'microsoft.network/networksecuritygroups' | project id, rules = array_length(properties.securityRules) | project id, compliant = (rules < 900)",
            "guid": "0390417d-53dc-44d9-b3f4-c8832f359b41",
            "link": "https://learn.microsoft.com/en-us/azure/azure-resource-manager/management/azure-subscription-service-limits",
            "service": "NSG",
            "severity": "中程度",
            "text": "NSG あたりの NSG ルールの制限 (1000) を検討します。",
            "training": "https://learn.microsoft.com/en-us/azure/virtual-network/network-security-group-how-it-works",
            "waf": "確実"
        },
        {
            "arm-service": "microsoft.network/virtualWans",
            "checklist": "Azure Landing Zone Review",
            "guid": "412e7f98-3f63-4047-82dd-69c5b5c2622f",
            "link": "https://learn.microsoft.com/azure/virtual-wan/scenario-any-to-any",
            "service": "VWAN",
            "severity": "中程度",
            "text": "Azure ネットワーク管理を簡素化するために Virtual WAN を検討し、Virtual WAN ルーティング設計の一覧にシナリオが明示的に記述されていることを確認します",
            "training": "https://learn.microsoft.com/learn/modules/introduction-azure-virtual-wan/",
            "waf": "オペレーションズ"
        },
        {
            "arm-service": "microsoft.network/virtualWans",
            "checklist": "Azure Landing Zone Review",
            "guid": "54b69bad-33aa-4d5e-ac68-e1d76667313b",
            "link": "https://learn.microsoft.com/azure/virtual-wan/virtual-wan-about",
            "service": "VWAN",
            "severity": "中程度",
            "text": "Azure リージョンごとに Virtual WAN ハブを使用して、共通のグローバル Azure Virtual WAN を介して Azure リージョン間で複数のランディング ゾーンを接続します。",
            "waf": "パフォーマンス"
        },
        {
            "arm-service": "microsoft.network/virtualWans",
            "checklist": "Azure Landing Zone Review",
            "guid": "8ac6a9e0-1e6a-483d-b5de-32c199248160",
            "link": "https://learn.microsoft.com/azure/virtual-wan/virtual-wan-about",
            "service": "VWAN",
            "severity": "低い",
            "text": "\"Azure のトラフィックは Azure にとどまる\" という原則に従って、Azure のリソース間の通信が Microsoft バックボーン ネットワーク経由で行われるようにします",
            "waf": "パフォーマンス"
        },
        {
            "arm-service": "microsoft.network/virtualWans",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/virtualhubs' | extend compliant = isnotnull(properties.azureFirewall.id) | project id, compliant",
            "guid": "7d5d1e4e-6146-458d-9558-fd77249b8211",
            "link": "https://learn.microsoft.com/azure/virtual-wan/virtual-wan-about",
            "service": "VWAN",
            "severity": "中程度",
            "text": "送信インターネット トラフィックの保護とフィルター処理を行うには、セキュリティで保護されたハブに Azure Firewall をデプロイします",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.network/virtualWans",
            "checklist": "Azure Landing Zone Review",
            "guid": "6667313b-4f56-464b-9e98-4a859c773e7d",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits",
            "service": "VWAN",
            "severity": "中程度",
            "text": "ネットワーク アーキテクチャが Azure Virtual WAN の制限内にあることを確認します。",
            "waf": "確実"
        },
        {
            "arm-service": "microsoft.network/virtualWans",
            "checklist": "Azure Landing Zone Review",
            "guid": "261623a7-65a9-417e-8f34-8ef254c27d42",
            "link": "https://learn.microsoft.com/azure/virtual-wan/azure-monitor-insights",
            "service": "VWAN",
            "severity": "中程度",
            "text": "Azure Monitor Insights for Virtual WAN を使用して、Virtual WAN のエンドツーエンドのトポロジ、状態、主要なメトリックを監視します。",
            "waf": "オペレーションズ"
        },
        {
            "arm-service": "microsoft.network/virtualWans",
            "checklist": "Azure Landing Zone Review",
            "guid": "727c77e1-b9aa-4a37-a024-129d042422c1",
            "link": "https://learn.microsoft.com/azure/virtual-wan/virtual-wan-faq#is-branch-to-branch-connectivity-allowed-in-virtual-wan",
            "service": "VWAN",
            "severity": "中程度",
            "text": "IaC デプロイで、これらのフローを明示的にブロックする必要がない限り、Virtual WAN のブランチ間トラフィックが無効にならないようにしてください。",
            "waf": "確実"
        },
        {
            "arm-service": "microsoft.network/virtualWans",
            "checklist": "Azure Landing Zone Review",
            "guid": "d49ac006-6670-4bc9-9948-d3e0a3a94f4d",
            "link": "https://learn.microsoft.com/azure/virtual-wan/about-virtual-hub-routing-preference",
            "service": "VWAN",
            "severity": "中程度",
            "text": "AS-Path は ExpressRoute や VPN よりも柔軟性が高いため、ハブ ルーティングの基本設定として使用します。",
            "waf": "確実"
        },
        {
            "arm-service": "microsoft.network/virtualWans",
            "checklist": "Azure Landing Zone Review",
            "guid": "2586b854-237e-47f1-84a1-d45d4cd2310d",
            "link": "https://learn.microsoft.com/azure/virtual-wan/about-virtual-hub-routing#labels",
            "service": "VWAN",
            "severity": "中程度",
            "text": "IaC デプロイで Virtual WAN でラベルベースの伝達が構成されていることを確認すると、仮想ハブ間の接続が損なわれます。",
            "waf": "確実"
        },
        {
            "ammp": true,
            "arm-service": "microsoft.network/virtualWans",
            "checklist": "Azure Landing Zone Review",
            "guid": "9c75dfef-573c-461c-a698-68598595581a",
            "link": "https://learn.microsoft.com/azure/virtual-wan/virtual-wan-faq#what-is-the-recommended-hub-address-space-during-hub-creation",
            "service": "VWAN",
            "severity": "高い",
            "text": "仮想ハブに十分な IP 空間 (理想的には /23 プレフィックス) を割り当てます。",
            "waf": "確実"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "5c986cb2-9131-456a-8247-6e49f541acdc",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "service": "Policy",
            "severity": "高い",
            "text": "Azure Policy を戦略的に活用し、環境の制御を定義し、ポリシー イニシアチブを使用して関連するポリシーをグループ化します。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "e979377b-cdb3-4751-ab2a-b13ada6e55d7",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/naming-and-tagging",
            "service": "Policy",
            "severity": "中程度",
            "text": "必要な Azure タグを特定し、\"追加\" ポリシー モードを使用して、Azure Policy を介して使用を強制します。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "d8a2adb1-17d6-4326-af62-5ca44e5695f2",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "service": "Policy",
            "severity": "中程度",
            "text": "規制とコンプライアンスの要件を Azure Policy の定義と Azure ロールの割り当てにマップします。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "223ace8c-b123-408c-a501-7f154e3ab369",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "service": "Policy",
            "severity": "中程度",
            "text": "中間ルート管理グループで Azure Policy 定義を確立し、継承されたスコープで割り当てられるようにする",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "3829e7e3-1618-4368-9a04-77a209945bda",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "service": "Policy",
            "severity": "中程度",
            "text": "必要に応じて、ポリシーの割り当てを最下位レベルで管理し、最下位レベルで除外します。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "43334f24-9116-4341-a2ba-527526944008",
            "link": "https://learn.microsoft.com/security/benchmark/azure/mcsb-asset-management#am-2-use-only-approved-services",
            "service": "Policy",
            "severity": "低い",
            "text": "Azure Policy を使用して、ユーザーがサブスクリプション/管理グループ レベルでプロビジョニングできるサービスを制御する",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "be7d7e48-4327-46d8-adc0-55bcf619e8a1",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "service": "Policy",
            "severity": "中程度",
            "text": "可能な場合は組み込みのポリシーを使用して、運用上のオーバーヘッドを最小限に抑えます。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "description": "リソース ポリシー共同作成者ロールを特定のスコープに割り当てると、ポリシー管理を関連するチームに委任できます。たとえば、中央の IT チームが管理グループ レベルのポリシーを監督し、アプリケーション チームがサブスクリプションのポリシーを処理することで、組織の標準に準拠した分散ガバナンスが可能になります。",
            "guid": "3f988795-25d6-4268-a6d7-0ba6c97be995",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview#azure-rbac-permissions-in-azure-policy",
            "service": "Policy",
            "severity": "中程度",
            "text": "組み込みのリソース ポリシー共同作成者ロールを特定のスコープで割り当てて、アプリケーション レベルのガバナンスを有効にします。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "19048384-5c98-46cb-8913-156a12476e49",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "service": "Policy",
            "severity": "中程度",
            "text": "ルート管理グループのスコープで行われる Azure Policy 割り当ての数を制限して、継承されたスコープでの除外による管理を回避します。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "5a917e1f-348e-4f25-9c27-d42e8bbac757",
            "link": "https://azure.microsoft.com/resources/achieving-compliant-data-residency-and-security-with-azure/",
            "service": "Policy",
            "severity": "中程度",
            "text": "データ主権の要件が存在する場合は、Azure ポリシーをデプロイして適用できます",
            "training": "https://learn.microsoft.com/learn/paths/secure-your-cloud-data/",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "78b22132-b41c-460b-a4d3-df8f73a67dc2",
            "link": "https://github.com/Azure/sovereign-landing-zone/blob/main/docs/scenarios/Sovereignty-Policy-Baseline.md",
            "service": "Policy",
            "severity": "中程度",
            "text": "ソブリン・ランディング・ゾーンの場合、主権ポリシー・ベースラインのポリシー・イニシアチブがデプロイされ、正しいMGレベルで割り当てられます。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "caeea0e9-1024-41df-a52e-d99c3f22a6f4",
            "link": "https://learn.microsoft.com/en-us/industry/sovereignty/policy-portfolio-baseline",
            "service": "Policy",
            "severity": "中程度",
            "text": "ソブリン・ランディング・ゾーンについては、ソブリン制御の目標とポリシー・マッピングが文書化されています。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "9b461617-db7b-4399-8ac6-d4eb7153893a",
            "service": "Policy",
            "severity": "中程度",
            "text": "ソブリン ランディング ゾーンでは、\"ソブリン制御の目標からポリシー マッピング\" の CRUD のプロセスが導入されています。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "9b5e2a28-9823-4faf-ab7e-afa5f6c57221",
            "link": "https://learn.microsoft.com/azure/automation/automation-solution-vm-management-config",
            "service": "VM",
            "severity": "低い",
            "text": "コストを節約するために、環境内の VM を開始/停止するために、自動化タグの使用を検討してください。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "ecdc7506-6f37-4ea9-be87-fc5d3df08a64",
            "link": "https://learn.microsoft.com/azure/virtual-machine-scale-sets/overview",
            "service": "VMSS",
            "severity": "中程度",
            "text": "Azure Virtual Machine スケール セットを活用して、負荷に基づいてスケールインおよびスケールアウトします。",
            "waf": "確実"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "89cc5e11-aa4d-4c3b-893d-feb99215266a",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#add-diagnostic-settings-to-save-your-wafs-logs",
            "service": "WAF",
            "severity": "高い",
            "text": "診断設定を追加して、Azure Front Door や Azure Application Gateway などのアプリケーション配信サービスから WAF ログを保存します。ログを定期的に確認して、攻撃や誤検知がないか確認します。",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "7f408960-c626-44cb-a018-347c8d790cdf",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#send-logs-to-microsoft-sentinel",
            "service": "WAF",
            "severity": "中程度",
            "text": "Azure Front Door や Azure Application Gateway などのアプリケーション配信サービスから Microsoft Sentinel に WAF ログを送信します。攻撃を検出し、WAF テレメトリを Azure 環境全体に統合します。",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "eba8cf22-45c6-4dc1-9b57-2cceb3b97ce5",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-redundancy",
            "service": "Backup",
            "severity": "中程度",
            "text": "Azure Backup を使用する場合は、既定の設定が GRS であるため、さまざまなバックアップの種類 (GRS、ZRS、LRS) を考慮してください",
            "waf": "確実"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "67e7a8ed-4b30-4e38-a3f2-9812b2363cef",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/design-logs-deployment",
            "service": "Monitor",
            "severity": "中程度",
            "text": "Azure ロールベースのアクセス制御 (Azure RBAC)、データ主権要件、またはデータ保持ポリシーで個別のワークスペースが義務付けられている場合を除き、1 つのモニター ログ ワークスペースを使用してプラットフォームを一元的に管理します。",
            "training": "https://learn.microsoft.com/azure/azure-monitor/logs/design-logs-deployment",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "5e6c4cfd-3e50-4454-9c24-47ec66138a72",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/data-retention-archive?tabs=portal-1%2Cportal-2#how-retention-and-archiving-work",
            "service": "Monitor",
            "severity": "中程度",
            "text": "Azure Monitor ログは、ログの保持要件が 2 年を超える場合に使用します。現在、データをアーカイブ状態に保持できる期間は最大 7 年間です。",
            "training": "https://learn.microsoft.com/learn/paths/architect-infrastructure-operations/",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "00f1ce16-ed30-41d6-b872-e52e3611cc58",
            "link": "https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/govern/policy-compliance/regulatory-compliance",
            "service": "Policy",
            "severity": "中程度",
            "text": "アクセス制御とコンプライアンス レポートに Azure Policy を使用します。Azure Policy には、一貫したポリシーの遵守と迅速な違反検出を保証するために、組織全体の設定を適用する機能が用意されています。",
            "training": "https://learn.microsoft.com/en-us/azure/governance/policy/concepts/effects",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "e7d7e484-3276-4d8b-bc05-5bcf619e8a13",
            "link": "https://learn.microsoft.com/azure/governance/policy/how-to/guest-configuration-create",
            "service": "VM",
            "severity": "中程度",
            "text": "Azure Policy を使用して、ゲスト内の仮想マシン (VM) の構成のずれを監視します。ポリシーを使用してゲスト構成監査機能を有効にすると、アプリケーション チームのワークロードは、ほとんど労力をかけずに機能をすぐに使用できます。",
            "training": "https://learn.microsoft.com/learn/paths/implement-resource-mgmt-security/",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "f9887952-5d62-4688-9d70-ba6c97be9951",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/management-operational-compliance#update-management-considerations ",
            "service": "VM",
            "severity": "中程度",
            "text": "Azure Update Manager を、Azure の Windows および Linux VM の修正プログラムの適用メカニズムとして使用します。",
            "training": "https://learn.microsoft.com/azure/update-manager/overview?tabs=azure-vms",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "c806c048-26b7-4ddf-b4c2-b4f0c476925d",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/management-operational-compliance#update-management-considerations ",
            "service": "VM",
            "severity": "中程度",
            "text": "Azure Arc を使用して、Azure の外部にある Windows および Linux VM の修正プログラムの適用メカニズムとして Azure Update Manager を使用します。",
            "training": "https://learn.microsoft.com/azure/update-manager/overview?tabs=azure-vms",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "90483845-c986-4cb2-a131-56a12476e49f",
            "link": "https://learn.microsoft.com/azure/network-watcher/network-watcher-monitoring-overview",
            "service": "Network Watcher",
            "severity": "中程度",
            "text": "Network Watcher を使用してトラフィック フローをプロアクティブに監視する",
            "training": "https://learn.microsoft.com/learn/modules/configure-network-watcher/",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "9945bda4-3334-4f24-a116-34182ba52752",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/design-logs-deployment",
            "service": "Monitor",
            "severity": "中程度",
            "text": "一元化された Azure Monitor Log Analytics ワークスペースを使用して、IaaS および PaaS アプリケーション リソースからログとメトリックを収集し、Azure RBAC でログ アクセスを制御します。",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "6944008b-e7d7-4e48-9327-6d8bdc055bcf",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-setup-guide/monitoring-reporting?tabs=AzureMonitor",
            "service": "Monitor",
            "severity": "中程度",
            "text": "分析情報とレポートには Azure Monitor ログを使用します。",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "97be9951-9048-4384-9c98-6cb2913156a1",
            "link": "https://learn.microsoft.com/azure/azure-monitor/alerts/alerts-overview",
            "service": "Monitor",
            "severity": "中程度",
            "text": "運用アラートの生成には、Azure Monitor アラートを使用します。",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "fed3c55f-a67e-4875-aadd-3aba3f9fde31",
            "link": "https://learn.microsoft.com/azure/automation/how-to/region-mappings",
            "service": "Monitor",
            "severity": "中程度",
            "text": "Azure Automation アカウントを介して変更とインベントリの追跡を使用する場合は、Log Analytics ワークスペースと Automation アカウントをリンクするためにサポートされているリージョンを選択していることを確認してください。",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "f541acdc-e979-4377-acdb-3751ab2ab13a",
            "link": "https://learn.microsoft.com/azure/governance/policy/concepts/guest-configuration",
            "service": "VM",
            "severity": "中程度",
            "text": "Azure ポリシーを使用して、VM 拡張機能を通じてソフトウェア構成を自動的にデプロイし、準拠したベースライン VM 構成を適用します。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "description": "Azure Policy のゲスト構成機能では、マシンの設定 (OS、アプリケーション、環境など) を監査して修復し、リソースが想定される構成と一致していることを確認できます。",
            "guid": "da6e55d7-d8a2-4adb-817d-6326af625ca4",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/management-operational-compliance#monitoring-for-configuration-drift",
            "service": "VM",
            "severity": "中程度",
            "text": "VM のセキュリティ構成のドリフトを Azure Policy で監視します。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "2476e49f-541a-4cdc-b979-377bcdb3751a",
            "link": "https://learn.microsoft.com/azure/site-recovery/site-recovery-overview",
            "service": "VM",
            "severity": "中程度",
            "text": "Azure から Azure Virtual Machines へのディザスター リカバリー シナリオには、Azure Site Recovery を使用します。これにより、リージョン間でワークロードをレプリケートできます。",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "f625ca44-e569-45f2-823a-ce8cb12308ca",
            "link": "https://learn.microsoft.com/azure/backup/backup-center-overview",
            "service": "Backup",
            "severity": "中程度",
            "text": "Azure ネイティブのバックアップ機能、または Azure 互換のサード パーティのバックアップ ソリューションを使用します。",
            "waf": "オペレーションズ"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "826c5c45-bb79-4951-a812-e3bfbfd7326b",
            "link": "https://learn.microsoft.com/azure/reliability/availability-zones-overview",
            "service": "VM",
            "severity": "高い",
            "text": "Availability Zones は、サポートされているリージョンの VM に活用します。",
            "waf": "確実"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "7ccb7c06-5511-42df-8177-d97f08d0337d",
            "link": "https://learn.microsoft.com/azure/virtual-machines/availability",
            "service": "VM",
            "severity": "高い",
            "text": "運用ワークロードを 1 つの VM で実行することは避けてください。",
            "waf": "確実"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "84101f59-1941-4195-a270-e28034290e3a",
            "link": "https://learn.microsoft.com/azure/load-balancer/load-balancer-overview",
            "service": "VM",
            "severity": "中程度",
            "text": "Azure Load Balancer と Application Gateway は、受信ネットワーク トラフィックを複数のリソースに分散します。",
            "waf": "確実"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "5017f154-e3ab-4369-9829-e7e316183687",
            "link": "https://learn.microsoft.com/azure/key-vault/general/overview",
            "service": "Key Vault",
            "severity": "高い",
            "text": "Azure Key Vault を使用してシークレットと資格情報を格納する",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "graph": "ResourceContainers | where type=='microsoft.resources/subscriptions'| parse id with '/subscriptions/' SubscriptionID| project subscriptionId, SubscriptionName = name| join kind=leftouter (Resources| where type == 'microsoft.keyvault/vaults'| project id, name, subscriptionId) on subscriptionId| join kind= leftouter (Resources| where type == 'microsoft.keyvault/vaults'| summarize ResourceCount = count() by subscriptionId) on subscriptionId| extend RCount = iff(isnull(ResourceCount), 0, ResourceCount)| project-away ResourceCount| extend compliant = (RCount <> 1)",
            "guid": "a0477a20-9945-4bda-9333-4f2491163418",
            "link": "https://learn.microsoft.com/azure/key-vault/general/overview-throttling",
            "service": "Key Vault",
            "severity": "中程度",
            "text": "アプリケーションやリージョンごとに異なる Azure Key Vault を使用して、トランザクションのスケール制限を回避し、シークレットへのアクセスを制限します。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "2ba52752-6944-4008-ae7d-7e4843276d8b",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "severity": "中程度",
            "text": "論理的な削除ポリシーと消去ポリシーを有効にして Azure Key Vault をプロビジョニングし、削除されたオブジェクトの保持保護を許可します。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "dc055bcf-619e-48a1-9f98-879525d62688",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "severity": "中程度",
            "text": "最小特権モデルに従って、キー、シークレット、証明書を完全に削除する承認を特殊なカスタム Microsoft Entra ID ロールに制限します。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "6d70ba6c-97be-4995-8904-83845c986cb2",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "severity": "中程度",
            "text": "公的認証局による証明書の管理と更新プロセスを自動化し、管理を容易にします。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "913156a1-2476-4e49-b541-acdce979377b",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "severity": "中程度",
            "text": "キーと証明書のローテーションの自動化されたプロセスを確立します。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "cdb3751a-b2ab-413a-ba6e-55d7d8a2adb1",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "severity": "中程度",
            "text": "コンテナーでファイアウォールと仮想ネットワーク サービス エンドポイントまたはプライベート エンドポイントを有効にして、キー コンテナーへのアクセスを制御します。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "17d6326a-f625-4ca4-9e56-95f2223ace8c",
            "link": "https://learn.microsoft.com/azure/key-vault/general/monitor-key-vault",
            "service": "Key Vault",
            "severity": "中程度",
            "text": "プラットフォーム中央の Azure Monitor Log Analytics ワークスペースを使用して、Key Vault の各インスタンス内のキー、証明書、シークレットの使用状況を監査します。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "b12308ca-5017-4f15-9e3a-b3693829e7e3",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "severity": "中程度",
            "text": "Key Vault のインスタンス化と特権アクセスを委任し、Azure Policy を使用して一貫性のある準拠構成を適用します。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "91163418-2ba5-4275-8694-4008be7d7e48",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "severity": "中程度",
            "text": "Azure Key Vault は、アプリケーションごと、環境ごと、リージョンごとに使用します。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "25d62688-6d70-4ba6-a97b-e99519048384",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "severity": "中程度",
            "text": "独自のキーを持ち込む場合、これは考慮されているすべてのサービスでサポートされていない可能性があります。不整合が望ましい結果を妨げないように、関連する軽減策を実装します。待機時間を最小限に抑える適切なリージョン ペアとディザスター リカバリー リージョンを選択します。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "4ac6b67c-b3a4-4ff9-8e87-b07a7ce7bbdb",
            "link": "https://learn.microsoft.com/en-us/industry/sovereignty/key-management",
            "service": "Key Vault",
            "severity": "中程度",
            "text": "ソブリン ランディング ゾーンの場合は、Azure Key Vault マネージド HSM を使用してシークレットと資格情報を格納します。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "4e5695f2-223a-4ce8-ab12-308ca5017f15",
            "link": "https://learn.microsoft.com/azure/active-directory/reports-monitoring/overview-reports",
            "service": "Entra",
            "severity": "中程度",
            "text": "Microsoft Entra ID レポート機能を使用して、アクセス制御監査レポートを生成します。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "09945bda-4333-44f2-9911-634182ba5275",
            "link": "https://learn.microsoft.com/azure/defender-for-cloud/concept-cloud-security-posture-management",
            "service": "Defender",
            "severity": "高い",
            "text": "すべてのサブスクリプションに対して Defender Cloud Security Posture Management を有効にします。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "36a72a48-fffe-4c40-9747-0ab5064355ba",
            "link": "https://learn.microsoft.com/azure/defender-for-cloud/plan-defender-for-servers-select-plan",
            "service": "Defender",
            "severity": "高い",
            "text": "すべてのサブスクリプションでサーバーに対して Defender Cloud ワークロード保護プランを有効にします。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "77425f48-ecba-43a0-aeac-a3ac733ccc6a",
            "link": "https://www.microsoft.com/en-gb/security/business/solutions/cloud-workload-protection",
            "service": "Defender",
            "severity": "高い",
            "text": "すべてのサブスクリプションで Azure リソースの Defender Cloud Workload Protection プランを有効にします。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "24d96b30-61ee-4436-a1cc-d6ef08bc574b",
            "link": "https://learn.microsoft.com/mem/configmgr/protect/deploy-use/endpoint-protection",
            "service": "VM",
            "severity": "高い",
            "text": "IaaS サーバーで Endpoint Protection を有効にします。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "15833ee7-ad6c-46d3-9331-65c7acbe44ab",
            "link": "https://learn.microsoft.com/azure/security-center/",
            "service": "VM",
            "severity": "中程度",
            "text": "Azure Monitor ログと Defender for Cloud を使用して、基本オペレーティング システムの修正プログラムの適用誤差を監視します。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "e5f8d79f-2e87-4768-924c-516775c6ea95",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/design-logs-deployment",
            "service": "Monitor",
            "severity": "中程度",
            "text": "既定のリソース構成を一元化された Azure Monitor Log Analytics ワークスペースに接続します。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "1761e147-f65e-4d09-bbc2-f464f23e2eba",
            "link": "https://learn.microsoft.com/en-us/industry/sovereignty/transparency-logs",
            "service": "Entra",
            "severity": "中程度",
            "text": "ソブリン ランディング ゾーンの場合、透過性ログは Entra ID テナントで有効になっています。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "d21a922d-5ca7-427a-82a6-35f7b21f1bfc",
            "link": "https://learn.microsoft.com/en-us/azure/security/fundamentals/customer-lockbox-overview",
            "service": "Entra",
            "severity": "中程度",
            "text": "ソブリン ランディング ゾーンの場合、Entra ID テナントでカスタマー ロックボックスが有効になっています。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "b03ed428-4617-4067-a787-85468b9ccf3f",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-require-secure-transfer",
            "service": "Storage",
            "severity": "高い",
            "text": "ストレージ アカウントへの安全な転送を有効にする必要がある",
            "waf": "安全"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "159aac9f-863f-4f48-82cf-00c28fa97a0e",
            "link": "https://learn.microsoft.com/azure/storage/blobs/data-protection-overview#recommendations-for-basic-data-protection",
            "service": "Storage",
            "severity": "高い",
            "text": "ストレージ アカウントのコンテナーの論理的な削除を有効にして、削除されたコンテナーとその内容を回復します。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "108d5099-a11d-4445-bd8b-e12a5e95412e",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/development-strategy-development-lifecycle#automated-builds",
            "service": "Key Vault",
            "severity": "高い",
            "text": "Key Vault シークレットを使用して、資格情報 (仮想マシン、ユーザー パスワード)、証明書、キーなどの機密情報をハードコーディングしないようにします。",
            "waf": "オペレーションズ"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "ab5351f6-383a-45ed-9c5e-b143b16db40a",
            "link": "https://learn.microsoft.com/azure/aks/use-windows-hpc",
            "service": "AKS",
            "severity": "低い",
            "text": "AKS Windows ワークロードで必要な場合は、HostProcess コンテナーを使用できます",
            "waf": "確実"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "a280dcf5-90ce-465d-b8e1-3f9ccbd46926",
            "link": "https://learn.microsoft.com/azure/azure-functions/functions-kubernetes-keda",
            "service": "AKS",
            "severity": "低い",
            "text": "イベント ドリブン ワークロードを実行する場合は KEDA を使用します",
            "waf": "パフォーマンス"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "26886d20-b66c-457b-a591-19bf8e8f5c58",
            "link": "https://dapr.io/",
            "service": "AKS",
            "severity": "低い",
            "text": "Dapr を使用してマイクロサービス開発を容易にする",
            "waf": "オペレーションズ"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (sku.tier=='Paid') | distinct id,compliant",
            "guid": "71d41e36-10cc-457b-9a4b-1410d4395898",
            "link": "https://learn.microsoft.com/azure/aks/uptime-sla",
            "service": "AKS",
            "severity": "高い",
            "text": "SLA でサポートされる AKS オファリングを使用する",
            "waf": "確実"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "c1288b3c-6a57-4cfc-9444-51e1a3d3453a",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-scheduler",
            "service": "AKS",
            "severity": "低い",
            "text": "ポッドとデプロイ定義でのディスラプション バジェットの使用",
            "waf": "確実"
        },
        {
            "checklist": "Azure AKS Review",
            "guid": "3c763963-7a55-42d5-a15e-401955387e5c",
            "link": "https://learn.microsoft.com/azure/container-registry/container-registry-geo-replication",
            "service": "ACR",
            "severity": "高い",
            "text": "プライベート レジストリを使用する場合は、複数のリージョンにイメージを格納するようにリージョン レプリケーションを構成します",
            "waf": "確実"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "f82cb8eb-8c0a-4a63-a25a-4956eaa8dc4a",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/aks/eslz-cost-governance-with-kubecost",
            "service": "AKS",
            "severity": "低い",
            "text": "kubecost などの外部アプリケーションを使用して、さまざまなユーザーにコストを割り当てます",
            "waf": "費用"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "4d3dfbab-9924-4831-a68d-fdf0d72f462c",
            "link": "https://learn.microsoft.com/azure/aks/scale-down-mode",
            "service": "AKS",
            "severity": "低い",
            "text": "スケールダウンモードを使用してノードを削除/割り当て解除する",
            "waf": "費用"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "87e651ea-bc4a-4a87-a6df-c06a4b570ebc",
            "link": "https://learn.microsoft.com/azure/aks/gpu-multi-instance",
            "service": "AKS",
            "severity": "中程度",
            "text": "必要に応じて、AKS クラスターで複数インスタンスの分割 GPU を使用する",
            "waf": "費用"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "2b72a08b-0410-4cd6-9093-e068a5cf27e8",
            "link": "https://learn.microsoft.com/azure/aks/start-stop-nodepools",
            "service": "AKS",
            "severity": "低い",
            "text": "Dev/Test クラスターを実行している場合は、NodePool Start/Stop を使用します。",
            "waf": "費用"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (isnotnull(properties.addonProfiles.azurepolicy) and properties.addonProfiles.azurepolicy.enabled==true) | distinct id,compliant",
            "guid": "9ca48e4a-85e2-4223-bce8-bb12307ca5f1",
            "link": "https://learn.microsoft.com/azure/governance/policy/concepts/policy-for-kubernetes",
            "service": "AKS",
            "severity": "中程度",
            "text": "Azure Policy for Kubernetes を使用してクラスターのコンプライアンスを確保する",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | project id,resourceGroup,name,pools=properties.agentPoolProfiles | project id,name,resourceGroup,poolcount=array_length(pools) | extend compliant = (poolcount > 1)",
            "guid": "6f158e3e-a3a9-42c2-be7e-2165c3a87af4",
            "link": "https://learn.microsoft.com/azure/aks/use-system-pools",
            "service": "AKS",
            "severity": "中程度",
            "text": "ユーザー/システムノードプールを使用してコントロールプレーンからアプリケーションを分離する",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "a7a1f893-9bda-4477-98f2-4c116775c2ea",
            "link": "https://learn.microsoft.com/azure/aks/use-system-pools",
            "service": "AKS",
            "severity": "低い",
            "text": "システム ノードプールにテイントを追加して専用にする",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "55b46a94-8008-4ae7-b7e4-b475b6c8bdbf",
            "link": "https://learn.microsoft.com/azure/container-registry/",
            "service": "AKS",
            "severity": "中程度",
            "text": "イメージにはプライベート レジストリ (ACR など) を使用する",
            "waf": "安全"
        },
        {
            "checklist": "Azure AKS Review",
            "guid": "59bce65d-e8a0-43f9-9879-468d66a786d6",
            "link": "https://learn.microsoft.com/azure/security-center/container-security",
            "service": "ACR",
            "severity": "中程度",
            "text": "イメージをスキャンして脆弱性を検出する",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "d167dd18-2b0a-4c24-8b99-9a646f8389a7",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-cluster-isolation",
            "service": "AKS",
            "severity": "高い",
            "text": "アプリの分離要件を定義する (名前空間/ノードプール/クラスター)",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "5e3df584-eccc-4d97-a3b6-bcda3b50eb2e",
            "link": "https://github.com/Azure/secrets-store-csi-driver-provider-azure",
            "service": "AKS",
            "severity": "中程度",
            "text": "CSI シークレット ストア ドライバーを使用して Azure Key Vault にシークレットを格納する",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "b03dda6d-58d7-4c89-8ddb-107d5769ae66",
            "link": "https://learn.microsoft.com/azure/aks/update-credentials",
            "service": "AKS",
            "severity": "高い",
            "text": "クラスターにサービス プリンシパルを使用する場合は、資格情報を定期的に (四半期ごとなど) 更新します",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "e7ba73a3-0508-4f80-806f-527db30cee96",
            "link": "https://learn.microsoft.com/azure/aks/use-kms-etcd-encryption",
            "service": "AKS",
            "severity": "中程度",
            "text": "必要に応じて、キー管理サービスの etcd 暗号化を追加します",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "ec8e4e42-0344-41b0-b865-9123e8956d31",
            "link": "https://learn.microsoft.com/azure/confidential-computing/confidential-nodes-aks-overview",
            "service": "AKS",
            "severity": "低い",
            "text": "必要に応じて、Confidential Compute for AKS の使用を検討してください",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "c9e95ffe-6dd1-4a17-8c5f-110389ca9b21",
            "link": "https://learn.microsoft.com/azure/defender-for-cloud/defender-for-containers-enable",
            "service": "AKS",
            "severity": "中程度",
            "text": "Defender for Containers の使用を検討する",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (properties.servicePrincipalProfile.clientId=='msi') | distinct id,compliant",
            "guid": "ed127dd1-42b0-46b2-8c69-99a646f3389a",
            "link": "https://learn.microsoft.com/azure/aks/use-managed-identity",
            "service": "AKS",
            "severity": "高い",
            "text": "サービス プリンシパルの代わりにマネージド ID を使用するUse managed identities instead of Service Principals",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = isnotnull(properties.aadProfile) | distinct id,compliant",
            "guid": "7e42c78e-78c0-46a6-8a21-94956e698dc4",
            "link": "https://learn.microsoft.com/azure/aks/managed-aad",
            "service": "AKS",
            "severity": "中程度",
            "text": "認証と AAD の統合 (マネージド統合を使用)",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "a2fe27b2-e287-401a-8352-beedf79b488d",
            "link": "https://learn.microsoft.com/azure/aks/control-kubeconfig-access",
            "service": "AKS",
            "severity": "中程度",
            "text": "管理者 kubeconfig へのアクセスを制限する (get-credentials --admin)",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "eec4962c-c3bd-421b-b77f-26e5e6b3bec3",
            "link": "https://learn.microsoft.com/azure/aks/manage-azure-rbac",
            "service": "AKS",
            "severity": "中程度",
            "text": "承認と AAD RBAC の統合",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "d4f3537c-1346-4dc5-9027-a71ffe1bd05d",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-identity",
            "service": "AKS",
            "severity": "高い",
            "text": "Kubernetes で RBAC 特権を制限するために名前空間を使用する",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "d2e0d5d7-71d4-41e3-910c-c57b4a4b1410",
            "link": "https://learn.microsoft.com/azure/aks/workload-identity-migration-sidecar",
            "service": "AKS",
            "severity": "中程度",
            "text": "ポッド ID アクセス管理の場合は、Azure AD ワークロード ID (プレビュー) を使用します",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "f4dcf690-1b30-407d-abab-6f8aa780d3a3",
            "link": "https://learn.microsoft.com/azure/aks/managed-aad#non-interactive-sign-in-with-kubelogin",
            "service": "AKS",
            "severity": "中程度",
            "text": "AKS 非対話型ログインの場合は、kubelogin (プレビュー) を使用します",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (properties.disableLocalAccounts==true) | distinct id,compliant",
            "guid": "b085b1f2-3119-4771-8c9a-bbf4411810ec",
            "link": "https://learn.microsoft.com/azure/aks/managed-aad#disable-local-accounts",
            "service": "AKS",
            "severity": "中程度",
            "text": "AKS ローカル アカウントを無効にする",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "36abb0db-c118-4f4c-9880-3f30f9a2deb6",
            "link": "https://learn.microsoft.com/azure/aks/managed-aad#configure-just-in-time-cluster-access-with-azure-ad-and-aks",
            "service": "AKS",
            "severity": "低い",
            "text": "必要に応じて Just-In-Time クラスター アクセスを構成する",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "c4d7f4c6-79bf-45d0-aa05-ce8fc717e150",
            "link": "https://learn.microsoft.com/azure/aks/managed-aad#use-conditional-access-with-azure-ad-and-aks",
            "service": "AKS",
            "severity": "低い",
            "text": "必要に応じて AKS の AAD 条件付きアクセスを構成する",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "e1123a7c-a333-4eb4-a120-4ee3f293c9f3",
            "link": "https://learn.microsoft.com/azure/aks/use-group-managed-service-accounts",
            "service": "AKS",
            "severity": "低い",
            "text": "Windows AKS ワークロードで必要な場合は、gMSA を構成します",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "1f711a74-3672-470b-b8b8-a2148d640d79",
            "link": "https://learn.microsoft.com/azure/aks/use-managed-identity#use-a-pre-created-kubelet-managed-identity",
            "service": "AKS",
            "severity": "中程度",
            "text": "より細かく制御するには、マネージドKubelet Identityの使用を検討してください",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "cbd8ac2a-aebc-4a2a-94da-1dbf3dc99248",
            "link": "https://azure.github.io/application-gateway-kubernetes-ingress/setup/install-existing/",
            "service": "AKS",
            "severity": "中程度",
            "text": "AGIC を使用している場合は、クラスター間で AppGW を共有しないでください",
            "waf": "確実"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (isnull(properties.addonProfiles.httpApplicationRouting) or properties.addonProfiles.httpApplicationRouting.enabled==false) | distinct id,compliant",
            "guid": "8008ae7d-7e4b-4475-a6c8-bdbf59bce65d",
            "link": "https://learn.microsoft.com/azure/aks/http-application-routing",
            "service": "AKS",
            "severity": "高い",
            "text": "AKS HTTP ルーティング アドオンを使用せず、代わりにアプリケーション ルーティング アドオンでマネージド NGINX イングレスを使用します。",
            "waf": "確実"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "7bacd7b9-c025-4a9d-a5d2-25d6bc5439d9",
            "link": "https://learn.microsoft.com/azure/virtual-network/accelerated-networking-overview",
            "service": "AKS",
            "severity": "中程度",
            "text": "Windows ワークロードの場合は、高速ネットワークを使用します",
            "waf": "パフォーマンス"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (tolower(properties.networkProfile.loadBalancerSku)=='standard') | distinct id,compliant",
            "guid": "ba7da7be-9952-4914-a384-5d997cb39132",
            "link": "https://learn.microsoft.com/azure/aks/load-balancer-standard",
            "service": "AKS",
            "severity": "高い",
            "text": "標準のALBを使用する(基本的なALBとは対照的)",
            "waf": "確実"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "22fbe8d6-9b40-47ef-9011-25bb1a555a6b",
            "link": "https://learn.microsoft.com/azure/aks/use-multiple-node-pools#add-a-node-pool-with-a-unique-subnet",
            "service": "AKS",
            "severity": "中程度",
            "text": "Azure CNI を使用する場合は、NodePool に異なるサブネットを使用することを検討してください",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "c3c39c98-6bb2-4c12-859a-114b5e3df584",
            "link": "https://learn.microsoft.com/azure/private-link/private-link-overview",
            "service": "AKS",
            "severity": "中程度",
            "text": "プライベート エンドポイント (推奨) または Virtual Network サービス エンドポイントを使用して、クラスターから PaaS サービスにアクセスする",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (properties.networkProfile.networkPlugin=='azure') | distinct id,compliant",
            "guid": "a0f61565-9de5-458f-a372-49c831112dbd",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-network",
            "service": "AKS",
            "severity": "高い",
            "text": "要件に最適な CNI ネットワーク プラグインを選択する (Azure CNI を推奨)",
            "waf": "確実"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "7faf12e7-0943-4f63-8472-2da29c2b1cd6",
            "link": "https://learn.microsoft.com/azure/aks/configure-azure-cni",
            "service": "AKS",
            "severity": "高い",
            "text": "Azure CNI を使用する場合は、ノードあたりのポッドの最大数を考慮して、サブネットのサイズを適切に設定します",
            "waf": "パフォーマンス"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "22f54b29-bade-43aa-b1e8-c38ec9366673",
            "link": "https://learn.microsoft.com/azure/aks/configure-azure-cni",
            "service": "AKS",
            "severity": "高い",
            "text": "Azure CNI を使用している場合は、最大ポッド数/ノード (既定値は 30) を確認します",
            "waf": "パフォーマンス"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "description": "内部アプリの場合、組織は多くの場合、ファイアウォールで AKS サブネット全体を開きます。これにより、ノードへのネットワーク アクセスも開かれ、場合によってはポッドへのネットワーク アクセスも開かれます (Azure CNI を使用している場合)。LoadBalancer の IP が別のサブネットにある場合は、この IP のみをアプリ クライアントで使用できる必要があります。もう 1 つの理由は、AKS サブネット内の IP アドレスが希少なリソースである場合、その IP アドレスをサービスに使用すると、クラスターの最大スケーラビリティが低下することです。",
            "guid": "13c00567-4b1e-4945-a459-c373e7ed6162",
            "link": "https://learn.microsoft.com/azure/aks/internal-lb",
            "service": "AKS",
            "severity": "低い",
            "text": "プライベート IP LoadBalancer サービスを使用する場合は、(AKS サブネットではなく) 専用サブネットを使用します",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "43f63047-22d9-429c-8b1c-d622f54b29ba",
            "link": "https://learn.microsoft.com/azure/aks/configure-azure-cni",
            "service": "AKS",
            "severity": "高い",
            "text": "それに応じて、サービスの IP アドレス範囲のサイズを設定します (クラスターのスケーラビリティが制限されます)。",
            "waf": "確実"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "57bf217f-6dc8-481c-81e2-785773e9c00f",
            "link": "https://learn.microsoft.com/azure/aks/use-byo-cni",
            "service": "AKS",
            "severity": "低い",
            "text": "必要に応じて、独自のCNIプラグインを追加します",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "4b3bb365-9458-44d9-9ed1-5c8f52890364",
            "link": "https://learn.microsoft.com/azure/aks/use-multiple-node-pools#assign-a-public-ip-per-node-for-your-node-pools",
            "service": "AKS",
            "severity": "低い",
            "text": "必要に応じて、AKS でノードごとにパブリック IP を構成する",
            "waf": "パフォーマンス"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "b3808b9f-a1cf-4204-ad01-3a923ce474db",
            "link": "https://learn.microsoft.com/azure/aks/concepts-network",
            "service": "AKS",
            "severity": "中程度",
            "text": "イングレス コントローラーを使用して、LoadBalancer タイプのサービスで公開する代わりに、Web ベースのアプリを公開します",
            "waf": "確実"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "ccb534e7-416e-4a1d-8e93-533b53199085",
            "link": "https://learn.microsoft.com/azure/aks/nat-gateway",
            "service": "AKS",
            "severity": "低い",
            "text": "エグレス トラフィックをスケーリングするために Azure NAT Gateway を outboundType として使用する",
            "waf": "確実"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "8ee9a69a-1b58-4b1e-9c61-476e110a160b",
            "link": "https://learn.microsoft.com/azure/aks/configure-azure-cni#dynamic-allocation-of-ips-and-enhanced-subnet-support",
            "service": "AKS",
            "severity": "中程度",
            "text": "Azure CNI IP の枯渇を回避するために IP の動的割り当てを使用する",
            "waf": "確実"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (properties.networkProfile.outboundType=='userDefinedRouting') | distinct id,compliant",
            "guid": "3b365a91-7ecb-4e48-bbe5-4cd7df2e8bba",
            "link": "https://learn.microsoft.com/azure/aks/limit-egress-traffic",
            "service": "AKS",
            "severity": "高い",
            "text": "セキュリティ要件で義務付けられている場合は、AzFW/NVA を使用してエグレス トラフィックをフィルター処理します",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = ((isnull(properties.apiServerAccessProfile.enablePrivateCluster) or properties.apiServerAccessProfile.enablePrivateCluster==false) and isnotnull(properties.apiServerAccessProfile.authorizedIPRanges)) | distinct id,compliant",
            "guid": "c4581559-bb91-463e-a908-aed8c44ce3b2",
            "link": "https://learn.microsoft.com/azure/aks/api-server-authorized-ip-ranges",
            "service": "AKS",
            "severity": "中程度",
            "text": "パブリック API エンドポイントを使用している場合は、アクセスできる IP アドレスを制限します",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | where isnotnull(properties.apiServerAccessProfile.enablePrivateCluster) | extend compliant = (properties.apiServerAccessProfile.enablePrivateCluster==true) | distinct id, compliant",
            "guid": "ecccd979-3b6b-4cda-9b50-eb2eb03dda6d",
            "link": "https://learn.microsoft.com/azure/aks/private-clusters",
            "service": "AKS",
            "severity": "高い",
            "text": "要件で必要な場合は、プライベート クラスターを使用します",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | where isnotnull(properties.apiServerAccessProfile.enablePrivateCluster) | extend compliant = (properties.apiServerAccessProfile.enablePrivateCluster==true) | distinct id, compliant",
            "guid": "ce7f2a7c-297c-47c6-adea-a6ff838db665",
            "link": "https://learn.microsoft.com/azure/aks/use-network-policies",
            "service": "AKS",
            "severity": "中程度",
            "text": "Windows 2019 および 2022 AKS ノードでは、Calico ネットワーク ポリシーを使用できます",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = isnotnull(properties.networkProfile.networkPolicy) | distinct id,compliant",
            "guid": "58d7c892-ddb1-407d-9769-ae669ca48e4a",
            "link": "https://learn.microsoft.com/azure/aks/use-network-policies",
            "service": "AKS",
            "severity": "高い",
            "text": "Kubernetes ネットワーク ポリシー オプションを有効にする (Calico/Azure)",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "85e2223e-ce8b-4b12-907c-a5f16f158e3e",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-network",
            "service": "AKS",
            "severity": "高い",
            "text": "Kubernetesネットワークポリシーを使用してクラスタ内のセキュリティを強化",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "a3a92c2d-e7e2-4165-a3a8-7af4a7a1f893",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-network",
            "service": "AKS",
            "severity": "高い",
            "text": "Web ワークロード (UI または API) に WAF を使用するUse a WAF for a web workloads (UI or API)",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "Resources | where type=~'microsoft.containerservice/managedclusters' | project resourceGroup,name,pools=properties.agentPoolProfiles | mv-expand pools | project subnetId=tostring(pools.vnetSubnetID) | where isnotempty(subnetId) | join (Resources | where type=='microsoft.network/virtualnetworks' | project id,resourceGroup,name,enableDdosProtection=tostring(properties.enableDdosProtection),subnets=properties.subnets | mv-expand subnets | project id,resourceGroup,name,enableDdosProtection,subnetId=tostring(subnets.id)) on subnetId | distinct id,resourceGroup,name,enableDdosProtection | extend compliant = (enableDdosProtection == 'true')",
            "guid": "9bda4776-8f24-4c11-9775-c2ea55b46a94",
            "link": "https://learn.microsoft.com/azure/virtual-network/ddos-protection-overview",
            "service": "AKS",
            "severity": "中程度",
            "text": "AKS Virtual Network で DDoS Standard を使用するUse DDoS Standard in the AKS Virtual Network",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "Resources | where type=~'microsoft.containerservice/managedclusters' | project resourceGroup,name,pools=properties.agentPoolProfiles | mv-expand pools | project subnetId=tostring(pools.vnetSubnetID) | where isnotempty(subnetId) | join (Resources | where type=='microsoft.network/virtualnetworks' | project id,resourceGroup,name,enableDdosProtection=tostring(properties.enableDdosProtection),subnets=properties.subnets | mv-expand subnets | project id,resourceGroup,name,enableDdosProtection,subnetId=tostring(subnets.id)) on subnetId | distinct id,resourceGroup,name,enableDdosProtection | extend compliant = (enableDdosProtection == 'true')",
            "guid": "6c46b91a-1107-4485-ad66-3183e2a8c266",
            "link": "https://learn.microsoft.com/azure/aks/http-proxy",
            "service": "AKS",
            "severity": "低い",
            "text": "必要に応じて、会社の HTTP プロキシを追加します",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "e9855d04-c3c3-49c9-a6bb-2c12159a114b",
            "link": "https://learn.microsoft.com/azure/aks/servicemesh-about",
            "service": "AKS",
            "severity": "中程度",
            "text": "高度なマイクロサービス通信管理にサービスメッシュの使用を検討する",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "67f7a9ed-5b31-4f38-a3f3-9812b2463cff",
            "link": "https://learn.microsoft.com/azure/azure-monitor/insights/container-insights-metric-alerts",
            "service": "AKS",
            "severity": "高い",
            "text": "最も重要なメトリックに関するアラートを構成します (推奨事項については、「Container Insights」を参照してください)",
            "waf": "オペレーションズ"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "337453a3-cc63-4963-9a65-22ac19e80696",
            "link": "https://learn.microsoft.com/azure/advisor/advisor-get-started",
            "service": "AKS",
            "severity": "低い",
            "text": "Azure Advisor でクラスターの推奨事項を定期的に確認する",
            "waf": "オペレーションズ"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "3aa70560-e7e7-4968-be3d-628af35b2ced",
            "link": "https://learn.microsoft.com/azure/aks/certificate-rotation",
            "service": "AKS",
            "severity": "低い",
            "text": "AKS 自動証明書のローテーションを有効にする",
            "waf": "オペレーションズ"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "e189c599-df0d-45a7-9dd4-ce32c1881370",
            "link": "https://learn.microsoft.com/azure/aks/supported-kubernetes-versions",
            "service": "AKS",
            "severity": "高い",
            "text": "kubernetes のバージョンを定期的に (四半期ごとなど) アップグレードする定期的なプロセスを行うか、AKS 自動アップグレード機能を使用します",
            "waf": "オペレーションズ"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "6f7c4c0d-4e51-4464-ad24-57ed67138b82",
            "link": "https://learn.microsoft.com/azure/aks/node-updates-kured",
            "service": "AKS",
            "severity": "高い",
            "text": "ノードイメージのアップグレードを使用していない場合は、Linuxノードのアップグレードにkuredを使用します",
            "waf": "オペレーションズ"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "139c9580-ade3-426a-ba09-cf157d9f6477",
            "link": "https://learn.microsoft.com/azure/aks/node-image-upgrade",
            "service": "AKS",
            "severity": "高い",
            "text": "クラスタノードイメージを定期的に(毎週など)アップグレードする定期的なプロセスを用意します",
            "waf": "オペレーションズ"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "0102ce16-ee30-41e6-b882-e52e4621dd68",
            "link": "https://learn.microsoft.com/azure/architecture/example-scenario/bedrock/bedrock-automated-deployments",
            "service": "AKS",
            "severity": "低い",
            "text": "アプリケーションまたはクラスター構成を複数のクラスターにデプロイするために gitop を検討してください",
            "waf": "オペレーションズ"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "d7672c26-7602-4482-85a4-14527fbe855c",
            "link": "https://learn.microsoft.com/azure/aks/command-invoke",
            "service": "AKS",
            "severity": "低い",
            "text": "プライベート クラスターで AKS コマンド呼び出しを使用することを検討する",
            "waf": "オペレーションズ"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "31d7aaab-7571-4449-ab80-53d89e89d17b",
            "link": "https://learn.microsoft.com/azure/aks/node-auto-repair#node-autodrain",
            "service": "AKS",
            "severity": "低い",
            "text": "計画されたイベントの場合は、ノードの自動ドレインの使用を検討してください",
            "waf": "オペレーションズ"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "ed0fda7f-211b-47c7-8b6e-c18873fb473c",
            "link": "https://learn.microsoft.com/azure/aks/faq",
            "service": "AKS",
            "severity": "高い",
            "text": "独自のガバナンスプラクティスを開発して、ノードRG(別名「インフラRG」)のオペレーターによって変更が実行されないようにします",
            "waf": "オペレーションズ"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (properties.nodeResourceGroup !startswith 'MC_') | distinct id,compliant",
            "guid": "73b32a5a-67f7-4a9e-b5b3-1f38c3f39812",
            "link": "https://learn.microsoft.com/azure/aks/cluster-configuration",
            "service": "AKS",
            "severity": "低い",
            "text": "カスタムノードRG(別名「インフラRG」)名を使用",
            "waf": "オペレーションズ"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "b2463cff-e189-4c59-adf0-d5a73dd4ce32",
            "link": "https://kubernetes.io/docs/setup/release/notes/",
            "service": "AKS",
            "severity": "中程度",
            "text": "非推奨の Kubernetes API を YAML マニフェストで使用しないでください",
            "waf": "オペレーションズ"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "c1881370-6f7c-44c0-b4e5-14648d2457ed",
            "link": "https://learn.microsoft.com/azure-stack/aks-hci/adapt-apps-mixed-os-clusters",
            "service": "AKS",
            "severity": "低い",
            "text": "Windows ノードのテイント",
            "waf": "オペレーションズ"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "67138b82-0102-4ce1-9ee3-01e6e882e52e",
            "link": "https://learn.microsoft.com/virtualization/windowscontainers/deploy-containers/version-compatibility?tabs=windows-server-20H2%2Cwindows-10-20H2",
            "service": "AKS",
            "severity": "低い",
            "text": "Windows コンテナーのパッチ レベルをホストのパッチ レベルと同期させる",
            "waf": "オペレーションズ"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "description": "クラスタレベルでの診断設定経由",
            "guid": "5b56ad48-408f-4e72-934c-476ba280dcf5",
            "link": "https://learn.microsoft.com/azure/aks/monitor-aks",
            "service": "AKS",
            "severity": "低い",
            "text": "マスター ログ (API ログ) を Azure Monitor または任意のログ管理ソリューションに送信する",
            "waf": "オペレーションズ"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "64d1a846-e28a-4b6b-9a33-22a635c15a21",
            "link": "https://learn.microsoft.com/azure/aks/node-pool-snapshot",
            "service": "AKS",
            "severity": "低い",
            "text": "必要に応じて、nodePool スナップショットを使用します",
            "waf": "費用"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "c5a5b252-1e44-4a59-a9d2-399c4d7b68d0",
            "link": "https://learn.microsoft.com/azure/aks/spot-node-pool",
            "service": "AKS",
            "severity": "低い",
            "text": "時間的制約のないワークロードのスポット ノード プールを検討する",
            "waf": "オペレーションズ"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (isnotnull(properties.addonProfiles.aciConnectorLinux) and properties.addonProfiles.aciConnectorLinux.enabled==true) | distinct id,compliant",
            "guid": "c755562f-2b4e-4456-9b4d-874a748b662e",
            "link": "https://learn.microsoft.com/azure/aks/concepts-scale",
            "service": "AKS",
            "severity": "低い",
            "text": "クイック バーストのために AKS 仮想ノードを検討する",
            "waf": "オペレーションズ"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "6f8389a7-f82c-4b8e-a8c0-aa63a25a4956",
            "link": "https://learn.microsoft.com/azure/azure-monitor/insights/container-insights-overview",
            "service": "AKS",
            "severity": "高い",
            "text": "Container Insights (または Prometheus などの他のツール) を使用してクラスター メトリックを監視する",
            "waf": "オペレーションズ"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (isnotnull(properties.addonProfiles.omsagent) and properties.addonProfiles.omsagent.enabled==true) | distinct id,compliant",
            "guid": "eaa8dc4a-2436-47b3-9697-15b1752beee0",
            "link": "https://learn.microsoft.com/azure/azure-monitor/insights/container-insights-overview",
            "service": "AKS",
            "severity": "高い",
            "text": "Container Insights(またはTelegraf/ElasticSearchなどの他のツール)を使用してクラスターログを保存および分析します",
            "waf": "オペレーションズ"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "4621dd68-c5a5-4be2-bdb1-1726769ef669",
            "link": "https://learn.microsoft.com/azure/azure-monitor/containers/container-insights-analyze",
            "service": "AKS",
            "severity": "中程度",
            "text": "ノードの CPU とメモリの使用率を監視する",
            "waf": "オペレーションズ"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "1a4835ac-9422-423e-ae80-b123081a5417",
            "link": "https://learn.microsoft.com/azure/aks/configure-azure-cni",
            "service": "AKS",
            "severity": "中程度",
            "text": "Azure CNI を使用している場合は、ノードごとに消費されるポッド IP の割合を監視します",
            "waf": "オペレーションズ"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "description": "OS ディスクの I/O は重要なリソースです。ノード内の OS が I/O で調整されると、予期しない動作が発生し、通常はノードが NotReady と宣言される可能性があります",
            "guid": "415833ea-3ad3-4c2d-b733-165c3acbe04b",
            "link": "https://learn.microsoft.com/azure/virtual-machines/premium-storage-performance",
            "service": "AKS",
            "severity": "中程度",
            "text": "ノード内の OS ディスク キューの深さを監視する",
            "waf": "オペレーションズ"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "be209d39-fda4-4777-a424-d116785c2fa5",
            "link": "https://learn.microsoft.com/azure/aks/load-balancer-standard",
            "service": "AKS",
            "severity": "中程度",
            "text": "AzFW/NVA でエグレス フィルター処理を使用しない場合は、標準の ALB によって割り当てられた SNAT ポートを監視します",
            "waf": "オペレーションズ"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "74c2ee76-569b-4a79-a57e-dedf91b022c9",
            "link": "https://learn.microsoft.com/azure/aks/aks-resource-health",
            "service": "AKS",
            "severity": "中程度",
            "text": "AKS クラスターのリソース正常性通知をサブスクライブするSubscribe to resource health notifications for your AKS cluster",
            "waf": "オペレーションズ"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "b54eb2eb-03dd-4aa3-9927-18e2edb11726",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-scheduler",
            "service": "AKS",
            "severity": "高い",
            "text": "ポッド仕様で要求と制限を構成する",
            "waf": "オペレーションズ"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "769ef669-1a48-435a-a942-223ece80b123",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-scheduler",
            "service": "AKS",
            "severity": "中程度",
            "text": "名前空間のリソースクォータを適用する",
            "waf": "オペレーションズ"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "081a5417-4158-433e-a3ad-3c2de733165c",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits",
            "service": "AKS",
            "severity": "高い",
            "text": "サブスクリプションにノードプールをスケールアウトするのに十分なクォータがあることを確認する",
            "waf": "オペレーションズ"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (isnotnull(properties.autoScalerProfile)) | distinct id,compliant",
            "guid": "90ce65de-8e13-4f9c-abd4-69266abca264",
            "link": "https://learn.microsoft.com/azure/aks/concepts-scale",
            "service": "AKS",
            "severity": "中程度",
            "text": "Cluster Autoscaler を使用する",
            "waf": "パフォーマンス"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (isnotnull(properties.austoscalerProfile)) | distinct id,compliant",
            "guid": "831c2872-c693-4b39-a887-a561bada49bc",
            "link": "https://learn.microsoft.com/azure/aks/custom-node-configuration",
            "service": "AKS",
            "severity": "低い",
            "text": "AKS ノード プールのノード構成をカスタマイズする",
            "waf": "パフォーマンス"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "faa19bfe-9d55-4d04-a3c4-919ca1b2d121",
            "link": "https://learn.microsoft.com/azure/aks/concepts-scale",
            "service": "AKS",
            "severity": "中程度",
            "text": "必要に応じてHorizontal Pod Autoscalerを使用します",
            "waf": "パフォーマンス"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "description": "ノードが大きくなると、パフォーマンスが向上し、エフェメラル ディスクや高速ネットワークなどの機能が提供されますが、爆発半径が大きくなり、スケーリングの粒度が低下します",
            "guid": "5ae124ba-34df-4585-bcdc-e9bd3bb0cdb3",
            "link": "https://blog.cloudtrooper.net/2020/10/23/which-vm-size-should-i-choose-as-aks-node/",
            "service": "AKS",
            "severity": "高い",
            "text": "大きすぎず小さすぎない適切なノードサイズを検討してください",
            "waf": "パフォーマンス"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "38800e6a-ae01-40a2-9fbc-ae5a06e5462d",
            "link": "https://learn.microsoft.com/azure/aks/quotas-skus-regions#service-quotas-and-limits",
            "service": "AKS",
            "severity": "低い",
            "text": "スケーラビリティのために 5,000 を超えるノードが必要な場合は、追加の AKS クラスターの使用を検討してください",
            "waf": "パフォーマンス"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "9583c0f6-6083-43f6-aa6b-df7102c901bb",
            "link": "https://learn.microsoft.com/azure/event-grid/event-schema-aks",
            "service": "AKS",
            "severity": "低い",
            "text": "AKS 自動化のために EventGrid イベントをサブスクライブすることを検討する",
            "waf": "パフォーマンス"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "c5016d8c-c6c9-4165-89ae-673ef0fff19d",
            "link": "https://learn.microsoft.com/azure/aks/manage-abort-operations",
            "service": "AKS",
            "severity": "低い",
            "text": "AKS クラスターで実行時間の長い操作を行う場合は、イベントの終了を検討してください",
            "waf": "パフォーマンス"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "c4e37133-f186-4ce1-aed9-9f1b32f6e021",
            "link": "https://learn.microsoft.com/azure/aks/use-azure-dedicated-hosts",
            "service": "AKS",
            "severity": "低い",
            "text": "必要に応じて、AKS ノードに Azure Dedicated Hosts を使用することを検討してください",
            "waf": "パフォーマンス"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | project id,resourceGroup,name,pools=properties.agentPoolProfiles | mvexpand pools | extend compliant = (pools.osDiskType=='Ephemeral') | project id,name=strcat(name,'-',pools.name), resourceGroup, compliant",
            "guid": "24367b33-6971-45b1-952b-eee0b9b588de",
            "link": "https://learn.microsoft.com/azure/aks/cluster-configuration",
            "service": "AKS",
            "severity": "高い",
            "text": "エフェメラル OS ディスクを使用する",
            "waf": "パフォーマンス"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "f0ce315f-1120-4166-8206-94f2cf3a4d07",
            "link": "https://learn.microsoft.com/azure/virtual-machines/disks-types",
            "service": "AKS",
            "severity": "高い",
            "text": "非エフェメラル ディスクの場合、複数のポッドを実行するには高いパフォーマンスが必要であり、既定の AKS ログ ローテーションしきい値で巨大なログが生成されるため、多くのポッド/ノードを実行する場合は、ノードに高い IOPS とより大きな OS ディスクを使用します",
            "waf": "パフォーマンス"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "39c486ce-d5af-4062-89d5-18bb5fd795db",
            "link": "https://learn.microsoft.com/azure/aks/use-ultra-disks",
            "service": "AKS",
            "severity": "低い",
            "text": "ハイパー パフォーマンス ストレージ オプションの場合は、AKS 上の Ultra Disks を使用します",
            "waf": "パフォーマンス"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "9f7547c1-747d-4c56-868a-714435bd19dd",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-multi-region",
            "service": "AKS",
            "severity": "中程度",
            "text": "クラスター内に状態を保持することは避け、外部 (AzStorage、AzSQL、Cosmos など) にデータを格納します",
            "waf": "パフォーマンス"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "24429eb7-2281-4376-85cc-57b4a4b18142",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-storage",
            "service": "AKS",
            "severity": "中程度",
            "text": "AzFiles Standard を使用する場合は、パフォーマンス上の理由から AzFiles Premium や ANF を検討してください",
            "waf": "パフォーマンス"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "83958a8c-2689-4b32-ab57-cfc64546135a",
            "link": "https://learn.microsoft.com/azure/aks/availability-zones#azure-disk-availability-zone-support",
            "service": "AKS",
            "severity": "中程度",
            "text": "Azure ディスクと AZ を使用する場合は、適切なゾーンにストレージをプロビジョニングするために VolumeBindingMode:WaitForFirstConsumer を使用して LRS ディスクのゾーン内にノードプールを配置するか、複数のゾーンにまたがるノードプールに ZRS ディスクを使用することを検討してください",
            "waf": "パフォーマンス"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "ストレージに関連する Microsoft クラウド セキュリティ ベンチマークのガイダンスを適用する",
            "guid": "d237de14-3b16-4c21-b7aa-9b64604489a8",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/storage-security-baseline",
            "service": "Azure Storage",
            "severity": "中程度",
            "text": "\"ストレージの Azure セキュリティ ベースライン\" を検討する",
            "waf": "安全"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "既定では、Azure Storage にはパブリック IP アドレスがあり、インターネットにアクセス可能です。プライベート エンドポイントを使用すると、アクセスが必要な Azure コンピューティング リソースにのみ Azure Storage を安全に公開できるため、パブリック インターネットへの露出を排除できます",
            "guid": "f42d78e7-9d17-4a73-a22a-5a67e7a8ed4b",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-private-endpoints",
            "service": "Azure Storage",
            "severity": "高い",
            "text": "Azure Storage にプライベート エンドポイントを使用することを検討する",
            "waf": "安全"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "新しく作成されたストレージ アカウントは、RBAC や監査などがすべて有効になるように、ARM デプロイ モデルを使用して作成されます。サブスクリプションにクラシック デプロイ モデルの古いストレージ アカウントがないことを確認する",
            "guid": "30e37c3e-2971-41b2-963c-eee079b598de",
            "link": "https://learn.microsoft.com/azure/virtual-machines/migration-classic-resource-manager-overview#migration-of-storage-accounts",
            "service": "Azure Storage",
            "severity": "中程度",
            "text": "古いストレージ アカウントで \"クラシック デプロイ モデル\" が使用されていないことを確認する",
            "waf": "安全"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "Microsoft Defender を活用して、不審なアクティビティや構成ミスについて学習します。",
            "guid": "fc5972cd-4cd2-41b0-a803-7f5e6b4bfd3d",
            "link": "https://learn.microsoft.com/azure/storage/common/azure-defender-storage-configure",
            "service": "Azure Storage",
            "severity": "高い",
            "text": "すべてのストレージ アカウントに対して Microsoft Defender を有効にする",
            "waf": "安全"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "論理的な削除メカニズムを使用すると、誤って削除された BLOB を回復できます。",
            "guid": "503547c1-447e-4c66-828a-7100f1ce16dd",
            "link": "https://learn.microsoft.com/azure/storage/blobs/soft-delete-blob-overview",
            "service": "Azure Storage",
            "severity": "中程度",
            "text": "BLOB の \"論理的な削除\" を有効にする",
            "waf": "安全"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "たとえば、機密性、プライバシー、コンプライアンス上の理由などから、削除された情報がすぐに削除されるようにアプリケーションで確認する必要がある場合など、特定の BLOB コンテナーに対して \"論理的な削除\" を選択的に無効にすることを検討してください。",
            "guid": "3f1d5e87-2e52-4e36-81cc-58b4a4b1510e",
            "link": "https://learn.microsoft.com/azure/storage/blobs/soft-delete-blob-enable",
            "service": "Azure Storage",
            "severity": "中程度",
            "text": "BLOB の '論理的な削除' を無効にする",
            "waf": "安全"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "コンテナーの論理的な削除を使用すると、コンテナーが削除された後に回復できます (たとえば、偶発的な削除操作から回復します)。",
            "guid": "43a58a9c-2289-4c3d-9b57-d0c655462f2a",
            "link": "https://learn.microsoft.com/azure/storage/blobs/soft-delete-container-overview",
            "service": "Azure Storage",
            "severity": "高い",
            "text": "コンテナーの \"論理的な削除\" を有効にする",
            "waf": "安全"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "たとえば、機密性、プライバシー、コンプライアンス上の理由などから、削除された情報がすぐに削除されるようにアプリケーションで確認する必要がある場合など、特定の BLOB コンテナーに対して \"論理的な削除\" を選択的に無効にすることを検討してください。",
            "guid": "3e3453a3-c863-4964-ab65-2d6c15f51296",
            "link": "https://learn.microsoft.com/azure/storage/blobs/soft-delete-container-enable",
            "service": "Azure Storage",
            "severity": "中程度",
            "text": "コンテナーの \"論理的な削除\" を無効にする",
            "waf": "安全"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "削除前に削除ロックを最初に解除するようにユーザーに強制することで、ストレージ アカウントが誤って削除されないようにします",
            "guid": "5398e6de-d227-4dd1-92b0-6c21d7999a64",
            "link": "https://learn.microsoft.com/azure/storage/common/lock-account-resource",
            "service": "Azure Storage",
            "severity": "高い",
            "text": "ストレージ アカウントでのリソース ロックの有効化",
            "waf": "安全"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "BLOB の \"訴訟ホールド\" または \"時間ベースの保持\" ポリシーを検討して、BLOB、コンテナー、またはストレージ アカウントを削除できないようにします。「不可能」は実際には「不可能」を意味することに注意してください。ストレージ アカウントに不変の BLOB が含まれる場合、そのストレージ アカウントを \"取り除く\" 唯一の方法は、Azure サブスクリプションを取り消すことです。",
            "guid": "6f4389a8-f42c-478e-98c0-6a73a22a4956",
            "link": "https://learn.microsoft.com/azure/storage/blobs/immutable-storage-overview",
            "service": "Azure Storage",
            "severity": "高い",
            "text": "不変の BLOB を検討する",
            "waf": "安全"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "ストレージ アカウントへの保護されていない HTTP/80 アクセスを無効にして、すべてのデータ転送が暗号化され、整合性が保護され、サーバーが認証されるようにすることを検討してください。",
            "guid": "e7a8dc4a-20e2-47c3-b297-11b1352beee0",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-require-secure-transfer",
            "service": "Azure Storage",
            "severity": "高い",
            "text": "HTTPS を要求する (つまり、ストレージ アカウントのポート 80 を無効にする)",
            "waf": "安全"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "ストレージ アカウントでカスタム ドメイン (ホスト名) を構成する場合は、TLS/HTTPS が必要かどうかを確認します。その場合は、ストレージ アカウントの前に Azure CDN を配置する必要があります。",
            "guid": "79b588de-fc49-472c-b3cd-21bf77036e5e",
            "link": "https://learn.microsoft.com/azure/storage/blobs/storage-custom-domain-name",
            "service": "Azure Storage",
            "severity": "高い",
            "text": "HTTPS を適用する (HTTP を無効にする) 場合は、ストレージ アカウントにカスタム ドメイン (CNAME) を使用していないことを確認します。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "クライアントが SAS トークンを使用して BLOB データにアクセスするときに HTTPS を要求すると、資格情報が失われるリスクを最小限に抑えることができます。",
            "guid": "6b4bed3d-5035-447c-8347-dc56028a71ff",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-sas-overview",
            "service": "Azure Storage",
            "severity": "中程度",
            "text": "Shared Access Signature (SAS) トークンを HTTPS 接続のみに制限する",
            "waf": "安全"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "AAD トークンは、可能な限り、共有アクセス署名よりも優先する必要があります",
            "guid": "e1ce15dd-3f0d-45e7-92d4-1e3611cc57b4",
            "link": "https://learn.microsoft.com/azure/storage/common/authorize-data-access",
            "service": "Azure Storage",
            "severity": "高い",
            "text": "BLOB アクセスに Azure Active Directory (Azure AD) トークンを使用する",
            "waf": "安全"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "ユーザー、グループ、またはアプリケーションにロールを割り当てる場合は、タスクの実行に必要なアクセス許可のみをセキュリティ プリンシパルに付与します。リソースへのアクセスを制限することで、意図しないデータの誤用と悪意のあるデータの誤用の両方を防ぐことができます。",
            "guid": "a4b1410d-4395-48a8-a228-9b3d6b57cfc6",
            "service": "Azure Storage",
            "severity": "中程度",
            "text": "IaM アクセス許可の最小特権",
            "waf": "安全"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "ユーザー委任 SAS は、Azure Active Directory (Azure AD) 資格情報と、SAS に指定されたアクセス許可によってセキュリティで保護されます。ユーザー委任 SAS は、そのスコープと機能の点でサービス SAS に似ていますが、サービス SAS よりもセキュリティ上の利点があります。",
            "guid": "55461e1a-3e34-453a-9c86-39648b652d6c",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-sas-overview?toc=%2Fazure%2Fstorage%2Fblobs%2Ftoc.json#best-practices-when-using-sas",
            "service": "Azure Storage",
            "severity": "高い",
            "text": "SAS を使用する場合は、ストレージ アカウント キー ベースの SAS よりも \"ユーザー委任 SAS\" を優先します。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "ストレージ アカウント キー (\"共有キー\") には、監査機能がほとんどありません。誰がいつキーのコピーを取得したかを監視できますが、キーが複数の人の手に渡ると、使用状況を特定のユーザーに帰属させることは不可能です。AAD 認証のみに依存することで、ストレージへのアクセスをユーザーに結び付けやすくなります。",
            "guid": "15f51296-5398-4e6d-bd22-7dd142b06c21",
            "link": "https://learn.microsoft.com/rest/api/storageservices/authorize-with-shared-key",
            "service": "Azure Storage",
            "severity": "高い",
            "text": "ストレージ アカウント キーを無効にして、AAD アクセス (およびユーザー委任 SAS) のみがサポートされるようにすることを検討してください。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "アクティビティ ログ データを使用して、ストレージ アカウントのセキュリティ (ストレージ アカウント キー、アクセス ポリシーなど) が \"いつ、誰が、何を、\"どのように\" 表示または変更されているかを特定します。",
            "guid": "d7999a64-6f43-489a-af42-c78e78c06a73",
            "link": "https://learn.microsoft.com/azure/storage/blobs/blob-storage-monitoring-scenarios#audit-account-activity",
            "service": "Azure Storage",
            "severity": "高い",
            "text": "Azure Monitor を使用して、ストレージ アカウントに対するコントロール プレーン操作を監査することを検討してください",
            "waf": "安全"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "キーの有効期限ポリシーを使用すると、アカウントアクセスキーのローテーションのリマインダーを設定できます。リマインダーは、指定した間隔が経過し、キーがまだローテーションされていない場合に表示されます。",
            "guid": "a22a4956-e7a8-4dc4-a20e-27c3e29711b1",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-account-keys-manage?tabs=azure-portal#create-a-key-expiration-policy",
            "service": "Azure Storage",
            "severity": "中程度",
            "text": "ストレージ アカウント キーを使用する場合は、\"キーの有効期限ポリシー\" を有効にすることを検討してください",
            "waf": "安全"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "SAS 有効期限ポリシーでは、SAS が有効である推奨間隔を指定します。SAS 有効期限ポリシーは、サービス SAS またはアカウント SAS に適用されます。ユーザーがサービス SAS またはアカウント SAS を、推奨間隔よりも長い有効期間で生成すると、警告が表示されます。",
            "guid": "352beee0-79b5-488d-bfc4-972cd3cd21bf",
            "link": "https://learn.microsoft.com/azure/storage/common/sas-expiration-policy",
            "service": "Azure Storage",
            "severity": "中程度",
            "text": "SAS 有効期限ポリシーの構成を検討する",
            "waf": "安全"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "保存されているアクセス ポリシーを使用すると、ストレージ アカウント キーを再生成することなく、サービス SAS のアクセス許可を取り消すことができます。",
            "guid": "77036e5e-6b4b-4ed3-b503-547c1347dc56",
            "link": "https://learn.microsoft.com/rest/api/storageservices/define-stored-access-policy",
            "service": "Azure Storage",
            "severity": "中程度",
            "text": "保存されているアクセス ポリシーに SAS をリンクすることを検討する",
            "waf": "安全"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "guid": "028a71ff-e1ce-415d-b3f0-d5e772d41e36",
            "link": "https://microsoft.github.io/code-with-engineering-playbook/continuous-integration/dev-sec-ops/secret-management/recipes/detect-secrets-ado/",
            "service": "Azure Storage",
            "severity": "中程度",
            "text": "チェックインされた接続文字列とストレージ アカウント キーを検出するようにアプリケーションのソース コード リポジトリを構成することを検討してください。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "理想的には、アプリケーションでマネージド ID を使用して Azure Storage に対する認証を行う必要があります。それが不可能な場合は、ストレージ資格情報 (接続文字列、ストレージ アカウント キー、SAS、サービス プリンシパル資格情報) を Azure KeyVault または同等のサービスに用意することを検討してください。",
            "guid": "11cc57b4-a4b1-4410-b439-58a8c2289b3d",
            "link": "https://learn.microsoft.com/azure/architecture/framework/security/design-storage-keys",
            "service": "Azure Storage",
            "severity": "高い",
            "text": "接続文字列を Azure KeyVault に格納することを検討する (マネージド ID が不可能なシナリオの場合)",
            "waf": "安全"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "アドホック SAS サービス SAS またはアカウント SAS で、有効期限が近づいています。このように、SAS が侵害された場合でも、有効期間は短時間です。この方法は、保存されているアクセス ポリシーを参照できない場合に特に重要です。また、有効期限が近いと、BLOB にアップロードできる時間が制限されるため、BLOB に書き込めるデータの量も制限されます。",
            "guid": "27138b82-1102-4cac-9eae-01e6e842e52f",
            "link": "https://learn.microsoft.com/rest/api/storageservices/delegate-access-with-shared-access-signature",
            "service": "Azure Storage",
            "severity": "高い",
            "text": "アドホックSASの有効期間を短くする",
            "waf": "安全"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "SAS を作成するときは、できるだけ具体的かつ制限的にしてください。1 つのリソースと操作には、より広範なアクセスを提供する SAS よりも SAS を優先します。",
            "guid": "4721d928-c1b1-4cd5-81e5-4a29a9de399c",
            "link": "https://learn.microsoft.com/rest/api/storageservices/delegate-access-with-shared-access-signature",
            "service": "Azure Storage",
            "severity": "中程度",
            "text": "SAS に狭いスコープを適用する",
            "waf": "安全"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "SAS には、SAS を使用してリソースを要求する権限をクライアント IP アドレスまたはアドレス範囲に与えるパラメーターを含めることができます。",
            "guid": "fd7b28dc-9355-4562-82bf-e4564b0d834a",
            "link": "https://learn.microsoft.com/rest/api/storageservices/create-account-sas",
            "service": "Azure Storage",
            "severity": "中程度",
            "text": "可能な限り、SAS のスコープを特定のクライアント IP アドレスに設定することを検討してください",
            "waf": "安全"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "SAS は、クライアントがアップロードするデータの量を制限できません。時間の経過に伴うストレージ容量の価格モデルを考えると、クライアントが悪意を持って大きなコンテンツをアップロードしたかどうかを検証することは理にかなっているかもしれません。",
            "guid": "348b263e-6dd6-4051-8a36-498f6dbad38e",
            "service": "Azure Storage",
            "severity": "低い",
            "text": "クライアントが SAS を使用してファイルをアップロードした後、アップロードされたデータを確認することを検討してください。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "\"ローカル ユーザー アカウント\" を使用して SFTP 経由で BLOB ストレージにアクセスする場合、\"通常の\" RBAC 制御は適用されません。NFS または REST 経由の BLOB アクセスは、SFTP アクセスよりも制限が厳しい場合があります。残念ながら、2023 年初頭の時点で、SFTP エンドポイントで現在サポートされている ID 管理の形式はローカル ユーザーだけです",
            "guid": "ad53cc7c-e1d7-4aaa-a357-1449ab8053d8",
            "link": "https://learn.microsoft.com/azure/storage/blobs/secure-file-transfer-protocol-support#sftp-permission-model",
            "service": "Azure Storage",
            "severity": "高い",
            "text": "SFTP: SFTPアクセスの「ローカルユーザー」の数を制限し、時間の経過とともにアクセスが必要かどうかを監査します。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "guid": "9f89dc7b-33be-42a1-a27f-7b9e91be1f38",
            "link": "https://learn.microsoft.com/azure/storage/blobs/secure-file-transfer-protocol-known-issues#authentication-and-authorization",
            "service": "Azure Storage",
            "severity": "中程度",
            "text": "SFTP: SFTP エンドポイントは、POSIX ライクな ACL をサポートしていません。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "ストレージは、CORS (Cross-Origin Resource Sharing)、つまり、異なるドメインの Web アプリが同一生成元ポリシーを緩めることを可能にする HTTP 機能をサポートしています。CORS を有効にする場合は、CorsRules を最小の特権に保ちます。",
            "guid": "cef39812-bd46-43cb-aac8-ac199ebb91a3",
            "link": "https://learn.microsoft.com/rest/api/storageservices/cross-origin-resource-sharing--cors--support-for-the-azure-storage-services",
            "service": "Azure Storage",
            "severity": "高い",
            "text": "過度に広範な CORS ポリシーを避ける",
            "waf": "安全"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "保存データは常にサーバー側で暗号化され、さらにクライアント側でも暗号化される場合があります。サーバー側の暗号化は、プラットフォーム マネージド キー (既定) またはカスタマー マネージド キーを使用して行われる場合があります。クライアント側の暗号化は、クライアントが BLOB ごとに暗号化/暗号化解除キーを Azure Storage に提供するか、クライアント側で暗号化を完全に処理することによって行われます。そのため、機密性の保証を Azure Storage にまったく依存しません。",
            "guid": "3d90cae2-cc88-4137-86f7-c0cbafe61464",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-service-encryption",
            "service": "Azure Storage",
            "severity": "高い",
            "text": "保存データの暗号化方法を決定します。データのスレッド モデルを理解します。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "guid": "8dd457e9-2713-48b8-8110-2cac6eae01e6",
            "link": "https://learn.microsoft.com/azure/storage/common/customer-managed-keys-overview?toc=%2Fazure%2Fstorage%2Fblobs%2Ftoc.json&bc=%2Fazure%2Fstorage%2Fblobs%2Fbreadcrumb%2Ftoc.json",
            "service": "Azure Storage",
            "severity": "中程度",
            "text": "どのプラットフォーム暗号化を使用するか、または使用するかを決定します。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "guid": "e842e52f-4721-4d92-ac1b-1cd521e54a29",
            "link": "https://learn.microsoft.com/azure/storage/blobs/encryption-customer-provided-keys",
            "service": "Azure Storage",
            "severity": "中程度",
            "text": "クライアント側の暗号化を使用するかどうかを決定します。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "Resource Graph エクスプローラー (resources | where type == 'microsoft.storage/storageaccounts' | where properties['allowBlobPublicAccess'] == true) を利用して、匿名 BLOB アクセスを許可するストレージ アカウントを検索します。",
            "guid": "659ae558-b937-4d49-a5e1-112dbd7ba012",
            "link": "https://learn.microsoft.com/azure/storage/blobs/anonymous-read-access-configure?tabs=portal#allow-or-disallow-public-read-access-for-a-storage-account",
            "service": "Azure Storage",
            "severity": "高い",
            "text": "パブリック BLOB アクセスが必要かどうか、または特定のストレージ アカウントに対して無効にできるかどうかを検討します。",
            "waf": "安全"
        },
        {
            "checklist": "Redis Resiliency checklist",
            "guid": "65285269-440b-44be-9d3e-0844276d4bdc",
            "link": "https://learn.microsoft.com/azure/azure-cache-for-redis/cache-how-to-zone-redundancy",
            "service": "Redis",
            "text": "Azure Cache for Redis では、Premium レベルと Enterprise レベルでゾーン冗長構成がサポートされています。ゾーン冗長キャッシュでは、同じリージョン内の異なる Azure Availability Zones にノードを配置できます。これにより、データセンターや AZ の停止が単一障害点として排除され、キャッシュの全体的な可用性が向上します。",
            "waf": "確実"
        },
        {
            "checklist": "Redis Resiliency checklist",
            "guid": "bc178bdc-5a06-4ca7-8443-51e19dd34429",
            "link": "https://learn.microsoft.com/en-us/azure/azure-cache-for-redis/cache-high-availability#persistence",
            "service": "Redis",
            "text": "キャッシュ データはメモリに格納されるため、まれに複数のノードで計画外の障害が発生すると、すべてのデータがドロップされる可能性があります。データの完全な損失を回避するために、Redis 永続化では、メモリ内データのスナップショットを定期的に取得し、ストレージ アカウントに格納できます。",
            "waf": "確実"
        },
        {
            "checklist": "Redis Resiliency checklist",
            "guid": "eb722823-7a15-41c5-ab4e-4f1814387e5c",
            "link": "https://learn.microsoft.com/en-us/azure/azure-cache-for-redis/cache-high-availability#storage-account-for-persistence",
            "service": "Redis",
            "text": "geo 冗長ストレージ アカウントを使用して Azure Cache for Redis データを保持するか、geo 冗長性を使用できない場合はゾーン冗長を使用します",
            "waf": "確実"
        },
        {
            "checklist": "Redis Resiliency checklist",
            "guid": "a8c26c9b-32ab-45bd-bc69-98a135e33789",
            "link": "https://learn.microsoft.com/azure/azure-cache-for-redis/cache-how-to-geo-replication",
            "service": "Redis",
            "text": "geo レプリケーションは、2 つ以上の Azure Cache for Redis インスタンス (通常は 2 つの Azure リージョンにまたがる) をリンクするためのメカニズムです。geo レプリケーションは、主にリージョン間のディザスター リカバリー用に設計されています。2 つの Premium レベルのキャッシュ インスタンスは、プライマリ キャッシュへの読み取りと書き込みを提供する方法で geo レプリケーションを介して接続され、そのデータはセカンダリ キャッシュにレプリケートされます。",
            "waf": "確実"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "32e42e36-11c8-418b-8a0b-c510e43a18a9",
            "service": "AVS",
            "severity": "高い",
            "text": "ADDS ドメイン コントローラーがネイティブ Azure の ID サブスクリプションにデプロイされていることを確認する",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "75089c20-990d-4927-b105-885576f76fc2",
            "service": "AVS",
            "severity": "中程度",
            "text": "Azure ベースのリソース (Azure VMware Solution を含む) からの認証要求を Azure にローカルに保持するように ADDS サイトとサービスが構成されていることを確認します",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "de3aad1e-7c28-4ec9-9666-b7570449aa80",
            "service": "AVS",
            "severity": "高い",
            "text": "vCenterがADDに接続されていることを確認し、「名前付きユーザーアカウント」に基づく認証を有効にします",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "cd289ced-6b17-4db8-8554-61e2aee3553a",
            "service": "AVS",
            "severity": "中程度",
            "text": "vCenter から ADDS への接続でセキュア プロトコル (LDAPS) が使用されていることを確認します",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "b9d37dac-43bc-46cd-8d79-a9b24604489a",
            "service": "AVS",
            "severity": "中程度",
            "text": "vCenter IdP の CloudAdmin アカウントは、緊急アカウント(非常用アカウント)としてのみ使用されます",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "53d88e89-d17b-473b-82a5-a67e7a9ed5b3",
            "service": "AVS",
            "severity": "高い",
            "text": "NSX-Manager が外部 ID プロバイダ (LDAPS) と統合されていることを確認します。",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "ae0e37ce-e297-411b-b352-caaab79b198d",
            "service": "AVS",
            "severity": "中程度",
            "text": "VMware vSphere 内で使用するために RBAC モデルが作成されているか",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "ab81932c-9fc9-4d1b-a780-36f5e6bfbb9e",
            "service": "AVS",
            "severity": "中程度",
            "text": "RBAC アクセス許可は、特定のユーザーではなく、ADDS グループに付与する必要があります",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "d503547c-c447-4e82-9128-a71f0f1cac6d",
            "service": "AVS",
            "severity": "高い",
            "text": "Azure の Azure VMware Solution リソースに対する RBAC アクセス許可は、限られた所有者のセットのみに \"ロックダウン\" されます",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "fd9f0df4-68dc-4976-b9a9-e6a79f7682c5",
            "service": "AVS",
            "severity": "高い",
            "text": "すべてのカスタム ロールのスコープが CloudAdmin で許可された承認で設定されていることを確認する",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "9ef1d5e8-32e4-42e3-911c-818b0a0bc510",
            "link": "https://github.com/Azure/AzureCAT-AVS/tree/main/networking",
            "service": "AVS",
            "severity": "高い",
            "text": "お客様のユース ケースに適した Azure VMware Solution 接続モデルが選択されているか",
            "waf": "パフォーマンス"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "eb710a37-cbc1-4055-8dd5-a936a8bb7cf5",
            "service": "AVS",
            "severity": "高い",
            "text": "オンプレミスから Azure への ExpressRoute または VPN 接続が \"接続モニター\" を使用して監視されていることを確認する",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "976e24f2-a7f8-426c-9253-2a92a2a7ed99",
            "service": "AVS",
            "severity": "中程度",
            "text": "Azure VMware Solution バックエンドの ExpressRoute 接続を監視するために、Azure ネイティブ リソースから Azure VMware Solution 仮想マシンへの接続モニターが作成されていることを確認します",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "f41ce6a0-64f3-4805-bc65-3ab50df01265",
            "service": "AVS",
            "severity": "中程度",
            "text": "エンド 2 エンドの接続を監視するために、オンプレミス リソースから Azure VMware Solution 仮想マシンへの接続モニターが作成されていることを確認します",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "563b4dc7-4a74-48b6-933a-d1a0916a6649",
            "service": "AVS",
            "severity": "高い",
            "text": "ルート サーバーを使用する場合は、ルート サーバーから ExR ゲートウェイ、オンプレミスに伝達されるルートが 1000 を超えないようにします (ARS 制限)。",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "6128a71f-0f1c-4ac6-b9ef-1d5e832e42e3",
            "service": "AVS",
            "severity": "高い",
            "text": "Azure Portal で Azure VMware Solution リソースを管理するロールに対して Privileged Identity Management が実装されていますか (永続的なアクセス許可は許可されません)",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "c4e2436b-b336-4d71-9f17-960eee0b9b5c",
            "service": "AVS",
            "severity": "高い",
            "text": "Privileged Identity Management 監査レポートは、Azure VMware Solution PIM ロールに対して実装する必要がある",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "78c447a8-26b2-4863-af0f-1cac599ef1d5",
            "service": "AVS",
            "severity": "中程度",
            "text": "Privileged Identity Management を使用している場合は、Azure VMware Solution のホストの自動置換通知用の有効な SMTP レコードを使用して、有効な Entra ID が有効なアカウントが作成されていることを確認します。(常任許可が必要)",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "8defc4d7-21d3-41d2-90fb-707ae9eab40e",
            "service": "AVS",
            "severity": "高い",
            "text": "CloudAdmin アカウントの使用を緊急アクセスのみに制限する",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "d329f798-bc17-48bd-a5a0-6ca7144351d1",
            "service": "AVS",
            "severity": "中程度",
            "text": "vCenter Server でカスタム RBAC ロールを作成して、vCenter 内に最小特権モデルを実装します",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "9dd24429-eb72-4281-97a1-51c5bb4e4f18",
            "service": "AVS",
            "severity": "中程度",
            "text": "cloudadmin (vCenter) と admin (NSX) の資格情報を定期的にローテーションするように定義されたプロセスです。",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "586cb291-ec16-4a1d-876e-f9f141acdce5",
            "service": "AVS",
            "severity": "高い",
            "text": "一元化された ID プロバイダーを使用して、Azure VMware Solution で実行されているワークロード (VM) に使用する",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "79377bcd-b375-41ab-8ab0-ead66e15d3d4",
            "service": "AVS",
            "severity": "中程度",
            "text": "East-West トラフィック フィルタリングは NSX-T 内に実装されていますか",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "a2adb1c3-d232-46af-825c-a44e1695fddd",
            "service": "AVS",
            "severity": "高い",
            "text": "Azure VMware Solution 上のワークロードは、インターネットに直接公開されません。トラフィックは、Azure Application Gateway、Azure Firewall、またはサード パーティのソリューションによってフィルター処理され、検査されます",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "eace4cb1-deb4-4c65-8c3f-c14eeab36938",
            "service": "AVS",
            "severity": "高い",
            "text": "監査とログ記録は、Azure VMware Solution および Azure VMware Solution ベースのワークロードへの受信インターネット要求に対して実装されます",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "29e3eec2-1836-487a-8077-a2b5945bda43",
            "service": "AVS",
            "severity": "中程度",
            "text": "セッション監視は、疑わしい/悪意のあるアクティビティを特定するために、Azure VMware Solution または Azure VMware Solution ベースのワークロードからの送信インターネット接続に実装されます",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "334fdf91-c234-4182-a652-75269440b4be",
            "service": "AVS",
            "severity": "中程度",
            "text": "Azure の ExR/VPN Gateway サブネットで DDoS Standard 保護が有効になっているか",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "3d3e0843-276d-44bd-a015-bcf219e4a1eb",
            "service": "AVS",
            "severity": "中程度",
            "text": "専用の特権アクセス ワークステーション (PAW) を使用して、Azure VMware Solution、vCenter、NSX Manager、HCX Manager を管理する",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "9ccbd869-266a-4cca-874f-aa19bf39d95d",
            "service": "AVS",
            "severity": "中程度",
            "text": "Azure VMware Solution で実行されているワークロードに対して Advanced Threat Detection (Microsoft Defender for Cloud 別名 ASC) を有効にする",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "44c7c891-9ca1-4f6d-9315-ae524ba34d45",
            "service": "AVS",
            "severity": "中程度",
            "text": "Azure ARC for Servers を使用して、Azure ネイティブ テクノロジを使用して Azure VMware Solution で実行されているワークロードを適切に管理します (Azure ARC for Azure VMware Solution はまだ利用できません)",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "85e12139-bd7b-4b01-8f7b-95ef6e043e2a",
            "service": "AVS",
            "severity": "低い",
            "text": "Azure VMware Solution 上のワークロードで、実行時に十分なデータ暗号化 (ゲスト内ディスク暗号化や SQL TDE など) が使用されるようにします。(保存時の vSAN 暗号化がデフォルトです)",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "a3592718-e6e2-4051-9267-6ae46691e883",
            "service": "AVS",
            "severity": "低い",
            "text": "ゲスト内暗号化を使用する場合は、可能な場合は Azure Key Vault に暗号化キーを格納します",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "5ac94222-3e13-4810-9230-81a941741583",
            "service": "AVS",
            "severity": "中程度",
            "text": "Azure VMware Solution で実行されているワークロードには、拡張セキュリティ更新プログラムのサポートの使用を検討してください (Azure VMware Solution は ESU の対象です)",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "3ef7ad7c-6d37-4331-95c7-acbe44bbe609",
            "service": "AVS",
            "severity": "高い",
            "text": "適切な vSAN データ冗長化方式(RAID 仕様)が使用されていることを確認します。",
            "waf": "確実"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "d88408f3-7273-44c8-96ba-280214590146",
            "service": "AVS",
            "severity": "高い",
            "text": "許容障害ポリシーが vSAN ストレージのニーズを満たすために設定されていることを確認します",
            "waf": "確実"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "d89f2e87-7784-424d-9167-85c6fa95b96a",
            "service": "AVS",
            "severity": "高い",
            "text": "十分なクォータを要求し、拡張とディザスタリカバリの要件を考慮していることを確認します",
            "waf": "確実"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "5d38e53f-9ccb-4d86-a266-acca274faa19",
            "service": "AVS",
            "severity": "中程度",
            "text": "ESXiへのアクセス制限を理解し、サードパーティのソリューションに影響を与える可能性のあるアクセス制限があることを確認してください。",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "bf39d95d-44c7-4c89-89ca-1f6d5315ae52",
            "service": "AVS",
            "severity": "中程度",
            "text": "ESXi ホストの密度と効率に関するポリシーがあることを確認し、新しいノードを要求するためのリード タイムを念頭に置いてください",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "4ba34d45-85e1-4213-abd7-bb012f7b95ef",
            "service": "AVS",
            "severity": "中程度",
            "text": "Azure VMware Solution の適切なコスト管理プロセスが整っていることを確認する - Azure Cost Management を使用できます",
            "waf": "費用"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "6e043e2a-a359-4271-ae6e-205172676ae4",
            "service": "AVS",
            "severity": "低い",
            "text": "Azure VMware Solution を使用するためのコストを最適化するために Azure 予約インスタンスが使用されているか",
            "waf": "費用"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "6691e883-5ac9-4422-83e1-3810523081a9",
            "service": "AVS",
            "severity": "中程度",
            "text": "他の Azure Native Services を使用する場合は、Azure Private-Link の使用を検討してください",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "db611712-6904-40b4-aa3d-3e0803276d4b",
            "service": "AVS",
            "severity": "高い",
            "text": "必要なすべてのリソースが同じ Azure 可用性ゾーン内に存在することを確認する",
            "waf": "パフォーマンス"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "48b262d6-cc5f-4512-a253-98e6db9d37da",
            "service": "AVS",
            "severity": "中程度",
            "text": "Azure VMware Solution ゲスト VM ワークロードに対して Microsoft Defender for Cloud を有効にする",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "41741583-3ef7-4ad7-a6d3-733165c7acbe",
            "service": "AVS",
            "severity": "中程度",
            "text": "Azure Arc 対応サーバーを使用して Azure VMware Solution ゲスト VM のワークロードを管理する",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "88f03a4d-2cd4-463c-abbc-868295abc91a",
            "service": "AVS",
            "severity": "高い",
            "text": "Azure VMware Solution での診断ログとメトリック ログを有効にするEnable Diagnostic and metric logging on Azure VMware Solution",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "4ed90dae-2cc8-44c4-9b6b-781cbafe6c46",
            "service": "AVS",
            "severity": "中程度",
            "text": "Log Analytics エージェントを Azure VMware Solution ゲスト VM ワークロードにデプロイする",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "589d457a-927c-4397-9d11-02cad6aae11e",
            "service": "AVS",
            "severity": "中程度",
            "text": "Azure VMware Solution VM ワークロードのバックアップ ポリシーとソリューションが文書化され、実装されていることを確認します",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "ee29711b-d352-4caa-ab79-b198dab81932",
            "service": "AVS",
            "severity": "中程度",
            "text": "Microsoft Defender for Cloud を使用して、Azure VMware Solution で実行されているワークロードのコンプライアンス監視を行う",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "c9fc9d1b-b780-436f-9e6b-fbb9ed503547",
            "service": "AVS",
            "severity": "中程度",
            "text": "適用可能なコンプライアンス ベースラインは Microsoft Defender for Cloud に追加されていますか",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "cc447e82-6128-4a71-b0f1-cac6d9ef1d5e",
            "service": "AVS",
            "severity": "高い",
            "text": "Azure VMware Solution のデプロイに使用する Azure リージョンを選択するときにデータ所在地が評価されましたか",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "832e42e3-611c-4818-a0a0-bc510e43a18a",
            "service": "AVS",
            "severity": "高い",
            "text": "データ処理への影響 (サービス プロバイダー/サービス コンシューマー モデル) が明確で文書化されているか",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "547c1747-dc56-4068-a714-435cd19dd244",
            "service": "AVS",
            "severity": "中程度",
            "text": "コンプライアンス上の理由で必要な場合にのみ、vSAN に CMK (カスタマー マネージド キー) を使用することを検討してください。",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "e43a18a9-cd28-49ce-b6b1-7db8255461e2",
            "service": "AVS",
            "severity": "高い",
            "text": "Azure VMware Solution のコア監視分析情報を有効にするダッシュボードを作成するCreate dashboards to enable a core Azure VMware Solution monitoring insights",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "6b84ee5d-f47d-42d9-8881-b1cd5d1e54a2",
            "service": "AVS",
            "severity": "高い",
            "text": "Azure VMware Solution のパフォーマンス (CPU >80%、平均メモリ >80%、vSAN >70%) に関する自動アラートの重大しきい値の警告アラートを作成する",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "9659e396-80e7-4828-ac93-5657d02bff45",
            "service": "AVS",
            "severity": "高い",
            "text": "vSAN の消費量が 75% を下回っているかどうかを監視するための重要なアラートが作成されていることを確認します (これは VMware からのサポートしきい値です)。",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "64b0d934-a348-4726-be79-d6b5c3a36495",
            "service": "AVS",
            "severity": "高い",
            "text": "Azure Service Health のアラートと通知に対してアラートが構成されていることを確認する",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "b6abad38-aad5-43cc-99e1-d86667357c54",
            "service": "AVS",
            "severity": "中程度",
            "text": "処理のために Azure Storage アカウントまたは Azure EventHub に送信するように Azure VMware Solution ログを構成する",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "9674c5ed-85b8-459c-9733-be2b1a27b775",
            "service": "AVS",
            "severity": "低い",
            "text": "VMware vSphere での詳細な分析情報が必要な場合:vRealize Operations や vRealize Network Insights がソリューションで使用されていますか?",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "a91be1f3-88f0-43a4-b2cd-463cbbbc8682",
            "service": "AVS",
            "severity": "高い",
            "text": "仮想マシンの vSAN ストレージ ポリシーはシック プロビジョニングを適用するため、このポリシーがデフォルトのストレージ ポリシーではないことを確認します",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "d9ef1d5e-832d-442e-9611-c818b0afbc51",
            "service": "AVS",
            "severity": "中程度",
            "text": "vSAN は有限のリソースであるため、vSphere コンテンツ ライブラリが vSAN に配置されていないことを確認する",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "0e43a18a-9cd2-489b-bd6b-17db8255461e",
            "service": "AVS",
            "severity": "中程度",
            "text": "バックアップ ソリューションのデータ リポジトリが vSAN ストレージの外部に保存されていることを確認します。Azure ネイティブまたはディスク プールでバックアップされるデータストア上",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "2aee3453-aec8-4339-848b-262d6cc5f512",
            "service": "AVS",
            "severity": "中程度",
            "text": "Azure Arc for Servers を使用して Azure VMware Solution で実行されているワークロードがハイブリッド管理されていることを確認する (Arc for Azure VMware Solution はプレビュー段階です)",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "925398e6-da9d-437d-ac43-bc6cd1d79a9b",
            "service": "AVS",
            "severity": "中程度",
            "text": "Azure VMware Solution で実行されているワークロードが Azure Log Analytics と Azure Monitor を使用して監視されていることを確認する",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "24604489-a8f4-42d7-ae78-cb6a33bd2a09",
            "service": "AVS",
            "severity": "中程度",
            "text": "Azure VMware Solution で実行されているワークロードを、既存の更新プログラム管理ツールまたは Azure Update Management に含める",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "17e7a8d9-0ae0-4e27-aee2-9711bd352caa",
            "service": "AVS",
            "severity": "中程度",
            "text": "Azure Policy を使用して、Azure の管理、監視、セキュリティ ソリューションに Azure VMware Solution ワークロードをオンボードする",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "aee3553a-fc83-4392-98b2-62d6cc5f5129",
            "service": "AVS",
            "severity": "中程度",
            "text": "Azure VMware Solution で実行されているワークロードが Microsoft Defender for Cloud にオンボードされていることを確認する",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "25398e6d-b9d3-47da-a43b-c6cd1d79a9b2",
            "service": "AVS",
            "severity": "中程度",
            "text": "vSAN は有限のリソースであるため、バックアップが vSAN に保存されないようにする",
            "waf": "確実"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "5e6bfbb9-ed50-4354-9cc4-47e826028a71",
            "service": "AVS",
            "severity": "中程度",
            "text": "すべてのDRソリューションが検討され、ビジネスに最適なソリューションが決定されましたか?[SRM/JetStream/Zerto/Veeam/...]",
            "waf": "確実"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "f0f1cac6-d9ef-41d5-b832-d42e3611c818",
            "service": "AVS",
            "severity": "中程度",
            "text": "ディザスター リカバリー テクノロジがネイティブの Azure IaaS の場合は、Azure Site Recovery を使用します",
            "waf": "確実"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "b0afbc51-0e43-4a18-a9cd-289bed6b17db",
            "service": "AVS",
            "severity": "高い",
            "text": "いずれかの災害ソリューションで自動復旧計画を使用し、手動タスクを可能な限り回避します",
            "waf": "確実"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "8255461e-2aee-4345-9aec-8339248b262d",
            "service": "AVS",
            "severity": "中程度",
            "text": "地政学的リージョンのペアをセカンダリディザスタリカバリ環境として使用する",
            "waf": "確実"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "6cc5f512-9253-498e-9da9-d37dac43bc6c",
            "service": "AVS",
            "severity": "高い",
            "text": "リージョン間で 2 つの異なるアドレス空間を使用します (例: 10.0.0.0/16 と 192.168.0.0/16)。",
            "waf": "確実"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "d1d79a9b-2460-4448-aa8f-42d78e78cb6a",
            "service": "AVS",
            "severity": "中程度",
            "text": "ExpressRoute Global Reach は、プライマリとセカンダリの Azure VMware Solution プライベート クラウド間の接続に使用されますか、それともネットワーク仮想アプライアンスを介してルーティングされますか?",
            "waf": "確実"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "33bd2a09-17e7-4a8d-a0ae-0e27cee29711",
            "service": "AVS",
            "severity": "中程度",
            "text": "すべてのバックアップソリューションが検討され、ビジネスに最適なソリューションが決定されましたか?[ MABS/CommVault/Metallic.io/Veeam/ . ]",
            "waf": "確実"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "bd352caa-ab79-4b18-adab-81932c9fc9d1",
            "service": "AVS",
            "severity": "中程度",
            "text": "バックアップ ソリューションを Azure VMware Solution プライベート クラウドと同じリージョンにデプロイする",
            "waf": "確実"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "bb77036f-5e6b-4fbb-aed5-03547cc447e8",
            "service": "AVS",
            "severity": "中程度",
            "text": "バックアップ ソリューションを vSan の外部の Azure ネイティブ コンポーネントにデプロイする",
            "waf": "確実"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "26028a71-f0f1-4cac-9d9e-f1d5e832d42e",
            "service": "AVS",
            "severity": "低い",
            "text": "Azure プラットフォームによって管理されている VMware コンポーネントの復元を要求するプロセスは用意されていますか?",
            "waf": "確実"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "4604489a-8f42-4d78-b78c-b7a33bd2a0a1",
            "service": "AVS",
            "severity": "低い",
            "text": "手動デプロイの場合、すべての構成とデプロイを文書化する必要があります",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "7e7a8d90-ae0e-437c-be29-711bd352caaa",
            "service": "AVS",
            "severity": "低い",
            "text": "手動デプロイの場合は、Azure VMware Solution プライベート クラウドでの偶発的なアクションを防ぐために、リソース ロックの実装を検討してください",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "b79b198d-ab81-4932-a9fc-9d1bb78036f5",
            "service": "AVS",
            "severity": "低い",
            "text": "自動デプロイの場合は、最小限のプライベート クラウドをデプロイし、必要に応じてスケーリングします",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "e6bfbb9e-d503-4547-ac44-7e826128a71f",
            "service": "AVS",
            "severity": "低い",
            "text": "自動デプロイの場合は、デプロイを開始する前にクォータを要求または予約します",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "0f1cac6d-9ef1-4d5e-a32e-42e3611c818b",
            "service": "AVS",
            "severity": "低い",
            "text": "自動デプロイの場合は、適切なガバナンスのために、自動化または Azure Policy を使用して関連するリソース ロックが作成されていることを確認します",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "e2cc95d4-8c6b-4791-bca0-f6c56589e558",
            "service": "AVS",
            "severity": "低い",
            "text": "ExR 認証キーに人間が理解できる名前を実装して、キーの目的/用途を簡単に識別できるようにします",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "255461e2-aee3-4553-afc8-339248b262d6",
            "service": "AVS",
            "severity": "低い",
            "text": "Azure VMware Solution と ExpressRoute のデプロイに個別のサービス プリンシパルを使用する場合は、キー コンテナーを使用してシークレットと承認キーを格納します",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "cc5f5129-2539-48e6-bb9d-37dac43bc6cd",
            "service": "AVS",
            "severity": "低い",
            "text": "Azure VMware Solution では限られた数の並列操作しかサポートされないため、Azure VMware Solution に多くのリソースをデプロイする必要がある場合に、IaC でアクションをシリアル化するためのリソースの依存関係を定義します。",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "1d79a9b2-4604-4489-a8f4-2d78e78cb7a3",
            "service": "AVS",
            "severity": "低い",
            "text": "単一の Tier-1 ゲートウェイで NSX-T セグメントの自動構成を実行する場合は、NSX-Manager API ではなく Azure Portal API を使用します",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "3bd2a0a1-7e7a-48d9-8ae0-e37cee29711b",
            "service": "AVS",
            "severity": "中程度",
            "text": "自動スケールアウトを使用する場合は、Azure VMware Solution を実行しているサブスクリプションに対して十分な Azure VMware Solution クォータを申請してください",
            "waf": "パフォーマンス"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "d352caaa-b79b-4198-bab8-1932c9fc9d1b",
            "service": "AVS",
            "severity": "中程度",
            "text": "自動スケールインを使用する場合は、そのようなアクションを実行する前に、ストレージ ポリシーの要件を必ず考慮してください",
            "waf": "パフォーマンス"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "b78036f5-e6bf-4bb9-bd50-3547cc447e82",
            "service": "AVS",
            "severity": "中程度",
            "text": "スケーリング操作は、一度に 1 つのスケール操作しか実行できないため、常に 1 つの SDDC 内でシリアル化する必要があります (複数のクラスタが使用されている場合でも)",
            "waf": "パフォーマンス"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "bf15bce2-19e4-4a0e-a588-79424d226786",
            "service": "AVS",
            "severity": "中程度",
            "text": "アーキテクチャで使用されるサードパーティソリューションでのスケーリング操作を検討および検証します(サポートされているかどうか)",
            "waf": "パフォーマンス"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "d20b56c5-7be5-4851-a0f8-3835c586cb29",
            "service": "AVS",
            "severity": "中程度",
            "text": "自動化で環境のスケールイン/スケールアウトの上限を定義して適用する",
            "waf": "パフォーマンス"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "1dc15a1c-075e-4e9f-841a-cccd579376bc",
            "service": "AVS",
            "severity": "中程度",
            "text": "監視ルールを実装して、自動スケーリング操作を監視し、成功と失敗を監視して、適切な (自動化された) 応答を有効にします",
            "waf": "オペレーションズ"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "c5972cd4-cd21-4b07-9036-f5e6b4bfd3d5",
            "link": "https://learn.microsoft.com/azure/active-directory/app-proxy/application-proxy#how-application-proxy-works",
            "service": "AVS",
            "severity": "高い",
            "text": "MONを使用する場合は、同時に構成されたVMの制限(HCXのMON制限[400 - 標準、1000 - 大規模アプライアンス])に注意してください",
            "training": "https://learn.microsoft.com/learn/modules/configure-azure-ad-application-proxy/",
            "waf": "確実"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "be1f38cf-03a8-422b-b463-cbbbc8ac299e",
            "link": "https://learn.microsoft.com/azure/active-directory/app-proxy/application-proxy#how-application-proxy-works",
            "service": "AVS",
            "severity": "高い",
            "text": "MON を使用する場合、100 を超えるネットワーク拡張で MON を有効にすることはできません",
            "training": "https://learn.microsoft.com/learn/paths/implement-applications-external-access-azure-ad/",
            "waf": "確実"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "bc91a43d-90da-4e2c-a881-4706f7c1cbaf",
            "service": "AVS",
            "severity": "中程度",
            "text": "移行に VPN 接続を使用する場合は、それに応じて MTU サイズを調整します。",
            "waf": "パフォーマンス"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "e614658d-d457-4e92-9139-b821102cad6e",
            "service": "AVS",
            "severity": "中程度",
            "text": "Azure に接続する接続性の低いリージョン (500 Mbps 以下) の場合は、HCX WAN 最適化アプライアンスのデプロイを検討してください",
            "waf": "パフォーマンス"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "ae01e6e8-43e5-42f4-922d-928c1b1cd521",
            "service": "AVS",
            "severity": "中程度",
            "text": "移行がオンプレミスアプライアンスから開始され、クラウドアプライアンスから開始されていないことを確認します(逆移行は実行しないでください)",
            "waf": "確実"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "e54a29a9-de39-4ac0-b7c2-8dc935657202",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-policy-settings",
            "service": "AVS",
            "severity": "中程度",
            "text": "Azure NetApp Files を使用して Azure VMware Solution のストレージを拡張する場合は、VM に直接接続するのではなく、これを VMware データストアとして使用することを検討してください。",
            "waf": "確実"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "bff4564b-0d93-44a3-98b2-63e7dd60513a",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#avoid-combining-traffic-manager-and-front-door",
            "service": "AVS",
            "severity": "中程度",
            "text": "専用の ExpressRoute ゲートウェイが外部データ ストレージ ソリューションに使用されていることを確認する",
            "waf": "確実"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "3649906e-bad3-48ea-b53c-c7de1d8aaab3",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-the-same-domain-name-on-front-door-and-your-origin",
            "service": "AVS",
            "severity": "中程度",
            "text": "外部データ ストレージ ソリューションに使用されている ExpressRoute ゲートウェイで FastPath が有効になっていることを確認します",
            "waf": "確実"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "571549ab-8153-4d89-b89d-c7b33be2b1a2",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#disable-health-probes-when-theres-only-one-origin-in-an-origin-group",
            "service": "AVS",
            "severity": "高い",
            "text": "ストレッチ クラスタを使用している場合は、選択したディザスタ リカバリ ソリューションがベンダーによってサポートされていることを確認します",
            "waf": "確実"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "4c486b6d-8bdc-4059-acf7-5ee8a1309888",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#select-good-health-probe-endpoints",
            "service": "AVS",
            "severity": "高い",
            "text": "ストレッチ クラスターを使用する場合は、提供される SLA が要件を満たしていることを確認します",
            "waf": "確実"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "9579d66b-896d-471f-a6ca-7be9955d04c3",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-head-health-probes",
            "service": "AVS",
            "severity": "高い",
            "text": "ストレッチ クラスターを使用している場合は、両方の ExpressRoute 回線が接続ハブに接続されていることを確認します。",
            "waf": "確実"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "c49d987c-b3d1-4325-aa12-4b6e4d0685ed",
            "link": "https://learn.microsoft.com/azure/nat-gateway/nat-overview#outbound-connectivity",
            "service": "AVS",
            "severity": "高い",
            "text": "ストレッチ クラスターを使用している場合は、両方の ExpressRoute 回線で GlobalReach が有効になっていることを確認します。",
            "waf": "確実"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "dce9793b-7bcd-4b3b-91eb-2ec14eea6e59",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-managed-tls-certificates",
            "service": "AVS",
            "severity": "高い",
            "text": "サイトの耐障害性の設定を適切に検討し、必要に応じてビジネスに合わせて変更しましたか?",
            "waf": "確実"
        },
        {
            "checklist": "Azure App Service Review",
            "guid": "b32e1aa1-4813-4602-88fe-27ca2891f421",
            "link": "https://learn.microsoft.com/en-us/azure/architecture/reference-architectures/app-service-web-app/zone-redundant?source=recommendations",
            "service": "App Services",
            "severity": "低い",
            "text": "ベスト プラクティスについては、「ベースラインの高可用性ゾーン冗長 Web アプリケーション アーキテクチャ」を参照してください",
            "waf": "確実"
        },
        {
            "checklist": "Azure App Service Review",
            "guid": "e4b31c6a-2e3f-4df1-8e8b-9c3aa5a27820",
            "link": "https://learn.microsoft.com/en-us/azure/app-service/overview-hosting-plans",
            "service": "App Services",
            "severity": "中程度",
            "text": "Premium レベルと Standard レベルを使用します。これらの層では、ステージング スロットと自動バックアップがサポートされています。",
            "waf": "確実"
        },
        {
            "checklist": "Azure App Service Review",
            "guid": "a7e2e6c2-491f-4fa4-a82b-521d0bc3b202",
            "link": "https://learn.microsoft.com/en-us/azure/reliability/migrate-app-service",
            "service": "App Services",
            "severity": "高い",
            "text": "リージョンで適用可能な場合は Availability Zones を活用します (Premium v2 または v3 レベルが必要)",
            "waf": "確実"
        },
        {
            "checklist": "Azure App Service Review",
            "guid": "1275e4a9-7b6a-43c3-a9cd-5ee18d8995ad",
            "link": "https://learn.microsoft.com/en-us/azure/app-service/monitor-instances-health-check",
            "service": "App Services",
            "severity": "中程度",
            "text": "ヘルスチェックの実装",
            "waf": "確実"
        },
        {
            "checklist": "Azure App Service Review",
            "guid": "35a91c5d-4ad6-4d9b-8e0f-c47db9e6d1e7",
            "link": "https://learn.microsoft.com/en-us/azure/app-service/manage-backup",
            "service": "App Services",
            "severity": "高い",
            "text": "「Azure App Service のバックアップと復元のベスト プラクティス」を参照してください",
            "waf": "確実"
        },
        {
            "checklist": "Azure App Service Review",
            "guid": "e68cd0ec-afc6-4bd8-a27f-7860ad9a0db2",
            "link": "https://learn.microsoft.com/en-us/azure/architecture/framework/services/compute/azure-app-service/reliability",
            "service": "App Services",
            "severity": "高い",
            "text": "Azure App Service の信頼性に関するベスト プラクティスを実装する",
            "waf": "確実"
        },
        {
            "checklist": "Azure App Service Review",
            "guid": "bd2a865c-0835-4418-bb58-4df91a5a9b3f",
            "link": "https://learn.microsoft.com/en-us/azure/app-service/manage-disaster-recovery#recover-app-content-only",
            "service": "App Services",
            "severity": "低い",
            "text": "災害時に App Service アプリを別のリージョンに移動する方法を理解する",
            "waf": "確実"
        },
        {
            "checklist": "Azure App Service Review",
            "guid": "f3d2f1e4-e6d4-4b7a-a5a5-e2a9b2c6f293",
            "link": "https://learn.microsoft.com/en-us/azure/reliability/reliability-app-service",
            "service": "App Services",
            "severity": "高い",
            "text": "Azure App Service の信頼性サポートについて理解する",
            "waf": "確実"
        },
        {
            "checklist": "Azure App Service Review",
            "guid": "c7b5f3d1-0569-4fd2-9f32-c0b64e9c0c5e",
            "link": "https://learn.microsoft.com/en-us/azure/azure-functions/dedicated-plan#always-on",
            "service": "App Services",
            "severity": "中程度",
            "text": "App Service プランで実行されている Function Apps に対して \"Always On\" が有効になっていることを確認する",
            "waf": "確実"
        },
        {
            "checklist": "Azure App Service Review",
            "guid": "a3b4d5f6-758c-4f9d-9e1a-d7c6b7e8f9ab",
            "link": "https://learn.microsoft.com/en-us/azure/app-service/monitor-instances-health-check",
            "service": "App Services",
            "severity": "中程度",
            "text": "正常性チェックを使用した App Service インスタンスの監視",
            "waf": "確実"
        },
        {
            "checklist": "Azure App Service Review",
            "guid": "c7d3e5f9-a19c-4833-8ca6-1dcb0128e129",
            "link": "https://learn.microsoft.com/en-us/azure/azure-monitor/app/availability-overview",
            "service": "App Services",
            "severity": "中程度",
            "text": "Application Insights の可用性テストを使用して Web アプリまたは Web サイトの可用性と応答性を監視する",
            "waf": "確実"
        },
        {
            "checklist": "Azure App Service Review",
            "guid": "b4e3f2d5-a5c6-4d7e-8b2f-c5d9e7a8f0ea",
            "link": "https://learn.microsoft.com/en-us/azure/azure-monitor/app/availability-standard-tests",
            "service": "App Services",
            "severity": "低い",
            "text": "Application Insights Standard テストを使用して、Web アプリまたは Web サイトの可用性と応答性を監視する",
            "waf": "確実"
        },
        {
            "checklist": "Azure App Service Review",
            "description": "Azure Key Vault を使用して、アプリケーションに必要なシークレットを格納します。 Key Vault は、シークレットを格納するための安全で監査された環境を提供し、Key Vault SDK または App Service Key Vault リファレンスを通じて App Service と適切に統合されています。",
            "guid": "834ac932-223e-4ce8-8b12-3071a5416415",
            "link": "https://learn.microsoft.com/azure/app-service/app-service-key-vault-references",
            "service": "App Services",
            "severity": "高い",
            "text": "Key Vault を使用してシークレットを格納する",
            "waf": "安全"
        },
        {
            "checklist": "Azure App Service Review",
            "description": "マネージド ID を使用して、Key Vault SDK または App Service Key Vault 参照を使用して Key Vault に接続します。",
            "guid": "833ea3ad-2c2d-4e73-8165-c3acbef4abe1",
            "link": "https://learn.microsoft.com/azure/app-service/app-service-key-vault-references",
            "service": "App Services",
            "severity": "高い",
            "text": "マネージド ID を使用して Key Vault に接続する",
            "waf": "安全"
        },
        {
            "checklist": "Azure App Service Review",
            "description": "App Service TLS 証明書を Key Vault に格納します。",
            "guid": "f8d39fda-4776-4831-9c11-5775c2ea55b4",
            "link": "https://learn.microsoft.com/azure/app-service/configure-ssl-certificate",
            "service": "App Services",
            "severity": "高い",
            "text": "Key Vault を使用して TLS 証明書を格納します。",
            "waf": "安全"
        },
        {
            "checklist": "Azure App Service Review",
            "description": "機密情報を処理するシステムは分離する必要があります。 そのためには、個別の App Service プランまたは App Service Environment を使用し、異なるサブスクリプションまたは管理グループの使用を検討してください。",
            "guid": "6ad48408-ee72-4734-a475-ba18fdbf590c",
            "link": "https://learn.microsoft.com/azure/app-service/overview-hosting-plans",
            "service": "App Services",
            "severity": "中程度",
            "text": "機密情報を処理するシステムを分離する",
            "waf": "安全"
        },
        {
            "checklist": "Azure App Service Review",
            "description": "App Service のローカル ディスクは暗号化されていないため、機密データを格納しないでください。 (例: D:\\\\Local and %TMP%)。",
            "guid": "e65de8e0-3f9b-4cbd-9682-66abca264f9a",
            "link": "https://learn.microsoft.com/azure/app-service/operating-system-functionality#file-access",
            "service": "App Services",
            "severity": "中程度",
            "text": "機密データをローカルディスクに保存しない",
            "waf": "安全"
        },
        {
            "checklist": "Azure App Service Review",
            "description": "認証された Web アプリケーションの場合は、Azure AD や Azure AD B2C などの確立された ID プロバイダーを使用します。 選択したアプリケーション フレームワークを利用して、このプロバイダーと統合するか、App Service の認証/承認機能を使用します。",
            "guid": "919ca0b2-c121-459e-814b-933df574eccc",
            "link": "https://learn.microsoft.com/azure/app-service/overview-authentication-authorization",
            "service": "App Services",
            "severity": "中程度",
            "text": "認証に確立された ID プロバイダーを使用する",
            "waf": "安全"
        },
        {
            "checklist": "Azure App Service Review",
            "description": "適切に管理され、セキュリティで保護された DevOps デプロイ パイプラインなど、制御された信頼できる環境から App Service にコードをデプロイします。これにより、バージョン管理されておらず、悪意のあるホストからデプロイされることが確認されていないコードが回避されます。",
            "guid": "3f9bcbd4-6826-46ab-aa26-4f9a19aed9c5",
            "link": "https://learn.microsoft.com/azure/app-service/deploy-best-practices",
            "service": "App Services",
            "severity": "高い",
            "text": "信頼できる環境からのデプロイ",
            "waf": "安全"
        },
        {
            "checklist": "Azure App Service Review",
            "description": "FTP/FTPS と WebDeploy/SCM の両方の基本認証を無効にします。 これにより、これらのサービスへのアクセスが無効になり、デプロイに Azure AD で保護されたエンドポイントの使用が強制されます。 SCM サイトは、Azure AD 資格情報を使用して開くこともできます。",
            "guid": "5d04c2c3-919c-4a0b-8c12-159e114b933d",
            "link": "https://learn.microsoft.com/azure/app-service/deploy-configure-credentials#disable-basic-authentication",
            "service": "App Services",
            "severity": "高い",
            "text": "基本認証の無効化",
            "waf": "安全"
        },
        {
            "checklist": "Azure App Service Review",
            "description": "可能な場合は、マネージド ID を使用して Azure AD のセキュリティで保護されたリソースに接続します。 これが不可能な場合は、Key Vault にシークレットを格納し、代わりにマネージド ID を使用して Key Vault に接続します。",
            "guid": "f574eccc-d9bd-43ba-bcda-3b54eb2eb03d",
            "link": "https://learn.microsoft.com/azure/app-service/overview-managed-identity?tabs=portal%2Chttp",
            "service": "App Services",
            "severity": "高い",
            "text": "マネージド ID を使用してリソースに接続する",
            "waf": "安全"
        },
        {
            "checklist": "Azure App Service Review",
            "description": "Azure Container Registry に格納されているイメージを使用する場合は、マネージド ID を使用してこれらをプルします。",
            "guid": "d9a25827-18d2-4ddb-8072-5769ee6691a4",
            "link": "https://learn.microsoft.com/azure/app-service/configure-custom-container#use-managed-identity-to-pull-image-from-azure-container-registry",
            "service": "App Services",
            "severity": "高い",
            "text": "マネージド ID を使用してコンテナーをプルするPull containers using a Managed Identity",
            "waf": "安全"
        },
        {
            "checklist": "Azure App Service Review",
            "description": "App Service の診断設定を構成することで、ログ記録と監視の中央の宛先として、すべてのテレメトリを Log Analytics に送信できます。これにより、HTTP ログ、アプリケーション ログ、プラットフォーム ログなどの App Service のランタイム アクティビティを監視できます。",
            "guid": "47768314-c115-4775-a2ea-55b46ad48408",
            "link": "https://learn.microsoft.com/azure/app-service/troubleshoot-diagnostic-logs",
            "service": "App Services",
            "severity": "中程度",
            "text": "App Service ランタイム ログを Log Analytics に送信する",
            "waf": "安全"
        },
        {
            "checklist": "Azure App Service Review",
            "description": "ログ記録と監視の中央の宛先としてアクティビティ ログを Log Analytics に送信するための診断設定を設定します。これにより、App Service リソース自体のコントロール プレーンのアクティビティを監視できます。",
            "guid": "ee72734b-475b-4a18-bdbf-590ce65de8e0",
            "link": "https://learn.microsoft.com/azure/azure-monitor/essentials/activity-log",
            "service": "App Services",
            "severity": "中程度",
            "text": "App Service アクティビティ ログを Log Analytics に送信する",
            "waf": "安全"
        },
        {
            "checklist": "Azure App Service Review",
            "description": "リージョンの VNet 統合、ネットワーク セキュリティ グループ、および UDR の組み合わせを使用して、送信ネットワーク アクセスを制御します。 トラフィックは、Azure Firewall などの NVA にルーティングする必要があります。 ファイアウォールのログを必ず監視してください。",
            "guid": "c12159e1-14b9-433d-b574-ecccd9bd3baf",
            "link": "https://learn.microsoft.com/azure/app-service/overview-vnet-integration",
            "service": "App Services",
            "severity": "中程度",
            "text": "送信ネットワーク アクセスを制御する必要がある",
            "waf": "安全"
        },
        {
            "checklist": "Azure App Service Review",
            "description": "VNet 統合を使用し、VNet NAT ゲートウェイまたは Azure Firewall などの NVA を使用することで、安定した送信 IP を提供できます。 これにより、受信側は必要に応じて IP に基づいて許可リストに登録できます。 多くの場合、Azure サービスへの通信では、IP アドレスに依存する必要はなく、代わりにサービス エンドポイントなどのメカニズムを使用する必要があります。 (また、受信側でプライベート エンドポイントを使用すると、SNAT の発生が回避され、安定した送信 IP 範囲が提供されます)。",
            "guid": "cda3b54e-b2eb-403d-b9a2-582718d2ddb1",
            "link": "https://learn.microsoft.com/azure/app-service/networking/nat-gateway-integration",
            "service": "App Services",
            "severity": "低い",
            "text": "インターネットアドレスへの送信通信のIPを安定させる",
            "waf": "安全"
        },
        {
            "checklist": "Azure App Service Review",
            "description": "App Service のアクセス制限、サービス エンドポイント、またはプライベート エンドポイントの組み合わせを使用して、受信ネットワーク アクセスを制御します。Web アプリ自体と SCM サイトに対して異なるアクセス制限を要求し、構成できます。",
            "guid": "0725769e-e669-41a4-a34a-c932223ece80",
            "link": "https://learn.microsoft.com/azure/app-service/networking-features#access-restrictions",
            "service": "App Services",
            "severity": "高い",
            "text": "受信ネットワーク アクセスを制御する必要がある",
            "waf": "安全"
        },
        {
            "checklist": "Azure App Service Review",
            "description": "Application Gateway や Azure Front Door などの Web アプリケーション ファイアウォールを使用して、悪意のある受信トラフィックから保護します。 WAFのログを必ず監視してください。",
            "guid": "b123071a-5416-4415-a33e-a3ad2c2de732",
            "link": "https://learn.microsoft.com/azure/app-service/networking/app-gateway-with-service-endpoints",
            "service": "App Services",
            "severity": "高い",
            "text": "App Service の前で WAF を使用するUse a WAF in Front of App Service",
            "waf": "安全"
        },
        {
            "checklist": "Azure App Service Review",
            "description": "WAFのみへのアクセスをロックダウンすることで、WAFをバイパスできないようにします。 アクセス制限、サービス・エンドポイントおよびプライベート・エンドポイントを組み合わせて使用します。",
            "guid": "165c3acb-ef4a-4be1-b8d3-9fda47768314",
            "link": "https://learn.microsoft.com/azure/app-service/networking-features#access-restrictions",
            "service": "App Services",
            "severity": "高い",
            "text": "WAFをバイパスすることは避けてください",
            "waf": "安全"
        },
        {
            "checklist": "Azure App Service Review",
            "description": "App Service の構成で最小 TLS ポリシーを 1.2 に設定します。",
            "graph": "appserviceresources | where type =~ 'microsoft.web/sites/config' | extend compliant = (properties.MinTlsVersion>=1.2) | distinct id,compliant",
            "guid": "c115775c-2ea5-45b4-9ad4-8408ee72734b",
            "link": "https://learn.microsoft.com/azure/app-service/configure-ssl-bindings#enforce-tls-versions",
            "service": "App Services",
            "severity": "中程度",
            "text": "最小 TLS ポリシーを 1.2 に設定します。",
            "waf": "安全"
        },
        {
            "checklist": "Azure App Service Review",
            "description": "HTTPS のみを使用するように App Service を構成します。 これにより、App Service は HTTP から HTTPS にリダイレクトされます。 HTTP Strict Transport Security (HSTS) をコード内または WAF から使用して、サイトに HTTPS を使用してのみアクセスする必要があることをブラウザーに通知することを強く検討してください。",
            "graph": "where (type=='microsoft.web/sites' and (kind == 'app' or kind == 'app,linux' )) | extend compliant = (properties.httpsOnly==true) | distinct id,compliant",
            "guid": "475ba18f-dbf5-490c-b65d-e8e03f9bcbd4",
            "link": "https://learn.microsoft.com/azure/app-service/configure-ssl-bindings#enforce-https",
            "service": "App Services",
            "severity": "高い",
            "text": "HTTPS のみを使用",
            "waf": "安全"
        },
        {
            "checklist": "Azure App Service Review",
            "description": "CORS 構成では、すべての配信元がサービスにアクセスできるため、ワイルドカードを使用しないでください (これにより、CORS の目的が損なわれます)。具体的には、サービスにアクセスできると予想される配信元のみを許可します。",
            "guid": "68266abc-a264-4f9a-89ae-d9c55d04c2c3",
            "link": "https://learn.microsoft.com/azure/app-service/app-service-web-tutorial-rest-api",
            "service": "App Services",
            "severity": "高い",
            "text": "ワイルドカードは CORS に使用しないでください",
            "waf": "安全"
        },
        {
            "checklist": "Azure App Service Review",
            "description": "リモート デバッグは、サービスに追加のポートが開き、攻撃対象領域が増加するため、運用環境でオンにしないでください。このサービスは、48 時間後に自動的にリモート デバッグをオフにすることに注意してください。",
            "graph": "appserviceresources | where type =~ 'microsoft.web/sites/config' | extend compliant = (properties.RemoteDebuggingEnabled == false) | distinct id,compliant",
            "guid": "d9bd3baf-cda3-4b54-bb2e-b03dd9a25827",
            "link": "https://learn.microsoft.com/azure/app-service/configure-common#configure-general-settings",
            "service": "App Services",
            "severity": "高い",
            "text": "リモートデバッグをオフにする",
            "waf": "安全"
        },
        {
            "checklist": "Azure App Service Review",
            "description": "Defender for App Service を有効にします。 これは(他の脅威の中でも)既知の悪意のあるIPアドレスへの通信を検出します。 操作の一環として、Defender for App Service からの推奨事項を確認します。",
            "guid": "18d2ddb1-0725-4769-be66-91a4834ac932",
            "link": "https://learn.microsoft.com/azure/defender-for-cloud/defender-for-app-service-introduction",
            "service": "App Services",
            "severity": "中程度",
            "text": "Defender for Cloud を有効にする - Defender for App Service",
            "waf": "安全"
        },
        {
            "checklist": "Azure App Service Review",
            "description": "Azure は、ネットワーク上で DDoS Basic 保護を提供しており、通常のトラフィック パターンを学習し、異常な動作を検出できるインテリジェントな DDoS Standard 機能によって改善できます。DDoS Standard は仮想ネットワークに適用されるため、Application Gateway や NVA など、アプリの前にあるネットワーク リソース用に構成する必要があります。",
            "guid": "223ece80-b123-4071-a541-6415833ea3ad",
            "link": "https://learn.microsoft.com/azure/ddos-protection/ddos-protection-overview",
            "service": "App Services",
            "severity": "中程度",
            "text": "WAF VNet で DDoS Protection Standard を有効にするEnable DDOS Protection Standard on the WAF VNet",
            "waf": "安全"
        },
        {
            "checklist": "Azure App Service Review",
            "description": "Azure Container Registry に格納されているイメージを使用する場合は、プライベート エンドポイントとアプリ設定 \"WEBSITE_PULL_IMAGE_OVER_VNET\" を使用して、Azure Container Registry から仮想ネットワーク経由でイメージをプルします。",
            "guid": "2c2de732-165c-43ac-aef4-abe1f8d39fda",
            "link": "https://learn.microsoft.com/azure/app-service/configure-custom-container#use-an-image-from-a-network-protected-registry",
            "service": "App Services",
            "severity": "中程度",
            "text": "Virtual Network 経由でコンテナーをプルする",
            "waf": "安全"
        },
        {
            "checklist": "Azure App Service Review",
            "description": "ペネトレーションテストのルールに従って、Webアプリケーションでペネトレーションテストを実施します。",
            "guid": "eb2eb03d-d9a2-4582-918d-2ddb10725769",
            "link": "https://learn.microsoft.com/azure/security/fundamentals/pen-testing",
            "service": "App Services",
            "severity": "中程度",
            "text": "ペネトレーションテストの実施",
            "waf": "安全"
        },
        {
            "checklist": "Azure App Service Review",
            "description": "DevSecOps プラクティスに従って脆弱性が検証およびスキャンされた信頼できるコードをデプロイします。",
            "guid": "19aed9c5-5d04-4c2c-9919-ca0b2c12159e",
            "link": "https://learn.microsoft.com/azure/architecture/solution-ideas/articles/devsecops-in-azure",
            "service": "App Services",
            "severity": "中程度",
            "text": "検証済みコードのデプロイ",
            "waf": "安全"
        },
        {
            "checklist": "Azure App Service Review",
            "description": "サポートされているプラットフォーム、プログラミング言語、プロトコル、およびフレームワークの最新バージョンを使用します。",
            "guid": "114b933d-f574-4ecc-ad9b-d3bafcda3b54",
            "link": "https://learn.microsoft.com/azure/app-service/overview-patch-os-runtime",
            "service": "App Services",
            "severity": "高い",
            "text": "最新のプラットフォーム、言語、プロトコル、フレームワークを使用",
            "waf": "安全"
        }
    ],
    "metadata": {
        "name": "WAF checklist",
        "timestamp": "March 18, 2024"
    },
    "severities": [
        {
            "name": "高い"
        },
        {
            "name": "中程度"
        },
        {
            "name": "低い"
        }
    ],
    "status": [
        {
            "description": "このチェックはまだ検討されていません",
            "name": "未確認"
        },
        {
            "description": "このチェックにはアクションアイテムが関連付けられています",
            "name": "開ける"
        },
        {
            "description": "このチェックは検証済みで、これ以上のアクションアイテムは関連付けられていません",
            "name": "達成"
        },
        {
            "description": "現在のデザインには適用されません",
            "name": "該当なし"
        },
        {
            "description": "必要なし",
            "name": "必要なし"
        }
    ]
}
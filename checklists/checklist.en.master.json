{
    "items": [
        {
            "category": "Storage",
            "checklist": "Azure Stack HCI Review",
            "guid": "9f519499-5820-4060-88fe-cab4538c9dd0",
            "link": "https://learn.microsoft.com/windows-server/storage/storage-spaces/storage-spaces-direct-hardware-requirements",
            "services": [
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Physical",
            "text": "All planned storage pools should use direct-attached storage (SATA, SAS, NVMe)",
            "waf": "Performance"
        },
        {
            "category": "Storage",
            "checklist": "Azure Stack HCI Review",
            "guid": "f7c015e0-7d97-4283-b006-567afeb2b5ca",
            "link": "https://learn.microsoft.com/azure-stack/hci/concepts/drive-symmetry-considerations#understand-capacity-imbalance",
            "services": [
                "ACR",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Physical",
            "text": "Disks are symmetrical across all nodes",
            "waf": "Performance"
        },
        {
            "category": "Storage",
            "checklist": "Azure Stack HCI Review",
            "guid": "f785b143-2c1e-4466-9baa-dde8ba4c7aaa",
            "link": "https://learn.microsoft.com/azure-stack/hci/concepts/fault-tolerance#parity",
            "services": [
                "Storage",
                "Backup"
            ],
            "severity": "Medium",
            "subcategory": "S2D",
            "text": "Parity type disk redundancy should only be used for low I/O volumes (backup/archive)",
            "waf": "Performance"
        },
        {
            "category": "Storage",
            "checklist": "Azure Stack HCI Review",
            "guid": "8a705965-9840-43cc-93b3-06d089406bb4",
            "link": "https://learn.microsoft.com/windows-server/storage/storage-spaces/storage-spaces-direct-hardware-requirements#physical-deployments",
            "services": [
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "S2D",
            "text": "Ensure there at least 2 capacity disks with available capacity in the Storage Pool",
            "waf": "Reliability"
        },
        {
            "category": "Storage",
            "checklist": "Azure Stack HCI Review",
            "guid": "2a4f629a-d623-4610-a8e3-d6fd66057d8e",
            "link": "https://learn.microsoft.com/windows-server/storage/storage-spaces/delimit-volume-allocation",
            "services": [
                "Storage"
            ],
            "severity": "Low",
            "subcategory": "S2D",
            "text": "'Delimited allocation' has been considered to improve volume resiliency in a multi-node failure",
            "waf": "Reliability"
        },
        {
            "category": "Storage",
            "checklist": "Azure Stack HCI Review",
            "guid": "960eb9be-1f0f-4fc1-9b31-fcf1cf9e34e6",
            "link": "https://learn.microsoft.com/azure-stack/hci/concepts/plan-volumes#choosing-how-many-volumes-to-create",
            "services": [
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "S2D",
            "text": "CSVs are created in multiples of node count",
            "waf": "Performance"
        },
        {
            "category": "Storage",
            "checklist": "Azure Stack HCI Review",
            "guid": "859ba2b9-a3a8-4ca1-bb61-165effbf1c03",
            "link": "https://learn.microsoft.com/azure-stack/hci/concepts/cache",
            "services": [
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "S2D",
            "text": "If a cache tier is implemented, the number of capacity drives is a multiple of the number of cache drives",
            "waf": "Performance"
        },
        {
            "category": "Storage",
            "checklist": "Azure Stack HCI Review",
            "guid": "d8a65f05-db06-461d-81dc-7899ad3f8f1e",
            "link": "https://learn.microsoft.com/azure-stack/hci/concepts/plan-volumes#reserve-capacity",
            "services": [
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "S2D",
            "text": "A minimum of 1 type of each disk type per node has been factored as a reserve disk",
            "waf": "Reliability"
        },
        {
            "category": "Storage",
            "checklist": "Azure Stack HCI Review",
            "description": "VMFleet is a tool that can be used to measure the performance of a storage subsystem, best used to baseline performance prior to workload deployment",
            "guid": "9d138f1d-5363-476e-bbd7-acfa500bdc0c",
            "link": "https://github.com/microsoft/diskspd/wiki/VMFleet",
            "services": [
                "Storage"
            ],
            "severity": "Low",
            "subcategory": "S2D",
            "text": "VMFleet has been run prior to workload deployment to baseline storage performance",
            "waf": "Performance"
        },
        {
            "category": "Storage",
            "checklist": "Azure Stack HCI Review",
            "guid": "13c12e2a-c938-4dd1-9223-507d5e17f9c5",
            "services": [
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Host OS",
            "text": "OS drives use a dedicated storage controller",
            "waf": "Reliability"
        },
        {
            "category": "Storage",
            "checklist": "Azure Stack HCI Review",
            "guid": "a631e7dc-8879-45bd-b0a7-e5927b805428",
            "link": "https://learn.microsoft.com/azure-stack/hci/manage/use-csv-cache",
            "services": [
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Host OS",
            "text": "CSV in-memory read caching is enabled and properly configured",
            "waf": "Performance"
        },
        {
            "category": "Networking",
            "checklist": "Azure Stack HCI Review",
            "guid": "c062cd9a-f1db-4f83-aab3-9cb03f56c140",
            "link": "https://learn.microsoft.com/azure-stack/hci/concepts/host-network-requirements#switch-embedded-teaming-set",
            "services": [
                "ACR"
            ],
            "severity": "Medium",
            "subcategory": "Host",
            "text": "NICs are symmetrical across nodes",
            "waf": "Reliability"
        },
        {
            "category": "Networking",
            "checklist": "Azure Stack HCI Review",
            "guid": "ea8054db-a558-4533-80c8-5d9cf447ba19",
            "services": [
                "Storage"
            ],
            "severity": "High",
            "subcategory": "Host",
            "text": "Storage networking is redundant",
            "waf": "Reliability"
        },
        {
            "category": "Networking",
            "checklist": "Azure Stack HCI Review",
            "guid": "15d976c5-e267-49a1-8b00-62010bfa5188",
            "link": "https://learn.microsoft.com/azure-stack/hci/deploy/network-atc",
            "services": [],
            "severity": "Medium",
            "subcategory": "Host",
            "text": "Host networking configuration is managed by Network ATC and intents are healthy",
            "waf": "Reliability"
        },
        {
            "category": "Networking",
            "checklist": "Azure Stack HCI Review",
            "guid": "676c53ad-b29a-4de1-9d03-d7d2674405b8",
            "link": "https://learn.microsoft.com/azure-stack/hci/concepts/network-hud-overview",
            "services": [],
            "severity": "Low",
            "subcategory": "Host",
            "text": "Network HUD has been configured",
            "waf": "Reliability"
        },
        {
            "category": "Networking",
            "checklist": "Azure Stack HCI Review",
            "guid": "8f6d58d9-6c1a-4ec1-b2d7-b2c6ba8f3949",
            "link": "https://learn.microsoft.com/azure-stack/hci/concepts/host-network-requirements",
            "services": [
                "VNet",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Host",
            "text": "Storage NICs are assigned static IP addresses on separate subnets and VLANs",
            "waf": "Reliability"
        },
        {
            "category": "Networking",
            "checklist": "Azure Stack HCI Review",
            "guid": "824e53ec-953e-40c2-a6b8-52970b5b0f74",
            "link": "https://learn.microsoft.com/azure-stack/hci/plan/two-node-switched-converged",
            "services": [],
            "severity": "Medium",
            "subcategory": "Host",
            "text": "For switchless designs, dual link full mesh connectivity has been implemented",
            "waf": "Reliability"
        },
        {
            "category": "Networking",
            "checklist": "Azure Stack HCI Review",
            "guid": "dbc85d0e-0ebd-4589-a789-0fa8ceb1d0f0",
            "link": "https://learn.microsoft.com/azure-stack/hci/concepts/physical-network-requirements#using-switchless",
            "services": [
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Host",
            "text": "If the cluster is made up of more than 3 nodes, a switched storage network has been implemented",
            "waf": "Reliability"
        },
        {
            "category": "Networking",
            "checklist": "Azure Stack HCI Review",
            "guid": "603c6d71-59d2-419c-a312-8edc6e799c6a",
            "services": [
                "Storage"
            ],
            "severity": "High",
            "subcategory": "Host",
            "text": "RDMA is enabled on the Storage networking",
            "waf": "Performance"
        },
        {
            "category": "Networking",
            "checklist": "Azure Stack HCI Review",
            "guid": "9e260eae-bca1-4827-a259-76ee63fda8d6",
            "link": "https://github.com/microsoft/SDN/blob/master/Diagnostics/Test-Rdma.ps1",
            "services": [],
            "severity": "Medium",
            "subcategory": "Host",
            "text": "Test-RDMA.ps1 has been run to validate the RDMA configuration",
            "waf": "Performance"
        },
        {
            "category": "Networking",
            "checklist": "Azure Stack HCI Review",
            "description": "This ensures that Management traffic is not exposed to the VM traffic",
            "guid": "abc85d0e-0ebd-4589-a777-0fa8ceb1d0f0",
            "link": "",
            "services": [
                "VM"
            ],
            "severity": "Medium",
            "subcategory": "Host",
            "text": "If a VMSwitch is shared for Compute and Management traffic, require that Management traffic is tagged with a VLAN ID",
            "waf": "Security"
        },
        {
            "category": "Networking",
            "checklist": "Azure Stack HCI Review",
            "description": "This ensures you have at least 3 NCs active at all times during NC upgrades.",
            "guid": "eb36f5f4-0fa7-4a2c-85f3-1b1c7c7817c0",
            "services": [
                "VM"
            ],
            "severity": "Medium",
            "subcategory": "SDN",
            "text": "There are at least 3 Network Controller VMs deployed",
            "waf": "Reliability"
        },
        {
            "category": "Networking",
            "checklist": "Azure Stack HCI Review",
            "guid": "8bc78c85-6028-4a43-af2d-082a0a344909",
            "link": "https://learn.microsoft.com/windows-server/networking/sdn/manage/update-backup-restore",
            "services": [
                "Backup"
            ],
            "severity": "High",
            "subcategory": "SDN",
            "text": "Backups of SDN infrastructure are configured and tested",
            "waf": "Operations"
        },
        {
            "category": "Management and Monitoring",
            "checklist": "Azure Stack HCI Review",
            "guid": "51eaa4b6-b9a7-43e1-a7dc-634d3107bc6d",
            "services": [
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Cluster",
            "text": "SCOM Managed Instance has been considered for more complex monitoring and alerting scenarios",
            "waf": "Operations"
        },
        {
            "category": "Management and Monitoring",
            "checklist": "Azure Stack HCI Review",
            "guid": "831f5aca-99ef-41e7-8263-9509f5093b43",
            "link": "https://learn.microsoft.com/azure-stack/hci/manage/setup-hci-system-alerts",
            "services": [
                "Monitor"
            ],
            "severity": "High",
            "subcategory": "Cluster",
            "text": "Alerts have been configured for the cluster, either using Azure Monitor, SCOM, or a third-party solution",
            "waf": "Operations"
        },
        {
            "category": "Management and Monitoring",
            "checklist": "Azure Stack HCI Review",
            "guid": "f95d0e7e-9f61-476d-bf65-59f2454d1d39",
            "link": "https://learn.microsoft.com/azure-stack/hci/manage/monitor-hci-single?tabs=22h2-and-later",
            "services": [
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Cluster",
            "text": "Insights has been enabled at the cluster level and all nodes are reporting data",
            "waf": "Operations"
        },
        {
            "category": "Management and Monitoring",
            "checklist": "Azure Stack HCI Review",
            "guid": "f4250fcb-ff53-40c9-b304-3560464fd90c",
            "link": "https://learn.microsoft.com/azure-stack/hci/manage/monitor-hci-single?tabs=22h2-and-later",
            "services": [
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Cluster",
            "text": "Azure Monitoring Agent has been deployed to hosts and an appropriate Data Collection Rule has been configured",
            "waf": "Operations"
        },
        {
            "category": "Management and Monitoring",
            "checklist": "Azure Stack HCI Review",
            "guid": "6143af1d-0d1a-4163-b1c9-662f7459bb98",
            "services": [
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Hardware",
            "text": "Relevant hardware monitoring has been configured",
            "waf": "Operations"
        },
        {
            "category": "Management and Monitoring",
            "checklist": "Azure Stack HCI Review",
            "guid": "9cbdf225-549a-41cf-9c97-794766a6f2b0",
            "link": "https://learn.microsoft.com/azure-stack/hci/manage/health-service-overview",
            "services": [
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Hardware",
            "text": "Relevant hardware alerting has been configured",
            "waf": "Operations"
        },
        {
            "category": "Operations",
            "checklist": "Azure Stack HCI Review",
            "guid": "c0da5bbd-0f0d-4a26-98ec-38c9cc42b323",
            "services": [
                "VM"
            ],
            "severity": "Low",
            "subcategory": "VM Management - Resource Bridge",
            "text": "The Azure CLI has been installed on every node to enable RB management from WAC",
            "waf": "Operations"
        },
        {
            "category": "Networking",
            "checklist": "Azure Stack HCI Review",
            "guid": "a8ecf23c-c048-4fa9-b87b-51ebfb409863",
            "services": [
                "VM"
            ],
            "severity": "Low",
            "subcategory": "VM Management - Resource Bridge",
            "text": "DHCP is available in the cluster to support Guest Configuration at VM deployment from Azure",
            "waf": "Operations"
        },
        {
            "category": "Backup and Disaster Recovery",
            "checklist": "Azure Stack HCI Review",
            "guid": "074541e3-fe08-458a-8062-32d13dcc10c6",
            "link": "https://learn.microsoft.com/azure/backup/back-up-azure-stack-hyperconverged-infrastructure-virtual-machines",
            "services": [
                "VM",
                "ASR",
                "Backup"
            ],
            "severity": "High",
            "subcategory": "VM",
            "text": "Backups of HCI VMs have been configured using MABS or a third-party solution",
            "waf": "Operations"
        },
        {
            "category": "Operations",
            "checklist": "Azure Stack HCI Review",
            "guid": "48f7ae57-1035-4101-8a38-fbe163d03e8a",
            "services": [],
            "severity": "High",
            "subcategory": "Cluster Configuration",
            "text": "Cluster configuration or a configuration script has been documented and maintained",
            "waf": "Operations"
        },
        {
            "category": "Operations",
            "checklist": "Azure Stack HCI Review",
            "guid": "f2a6a19a-ffe6-444d-badb-cb336c8e7b50",
            "link": "https://learn.microsoft.com/azure-stack/hci/manage/witness",
            "services": [],
            "severity": "High",
            "subcategory": "Cluster Configuration",
            "text": "A cluster witness has been configured for clusters with less than 5 nodes",
            "waf": "Reliability"
        },
        {
            "category": "Operations",
            "checklist": "Azure Stack HCI Review",
            "guid": "a47339fe-62c5-44a0-bb83-3d46ef16292f",
            "link": "https://learn.microsoft.com/azure-stack/hci/manage/update-cluster",
            "services": [],
            "severity": "Medium",
            "subcategory": "Cluster Configuration",
            "text": "Cluster-Aware Updating has been configured for Windows and hardware updates (if available)",
            "waf": "Operations"
        },
        {
            "category": "Operations",
            "checklist": "Azure Stack HCI Review",
            "guid": "7f1d6fe8-3079-44ea-8ea6-14494d1aa470",
            "link": "https://learn.microsoft.com/azure-stack/hci/deploy/validate",
            "services": [],
            "severity": "High",
            "subcategory": "Cluster Configuration",
            "text": "Cluster validation has been run against the configured cluster",
            "waf": "Reliability"
        },
        {
            "category": "Operations",
            "checklist": "Azure Stack HCI Review",
            "guid": "81693af0-5638-4aa2-a153-1d6189df30a7",
            "link": "https://learn.microsoft.com/azure-stack/hci/manage/azure-benefits",
            "services": [
                "VM"
            ],
            "severity": "Medium",
            "subcategory": "Cluster Configuration",
            "text": "Azure Benefits has been enabled at the cluster and VM levels",
            "waf": "Cost"
        },
        {
            "category": "Operations",
            "checklist": "Azure Stack HCI Review",
            "guid": "8c967ee8-8170-4537-a28d-33431cd3632a",
            "link": "https://learn.microsoft.com/azure-stack/hci/manage/use-environment-checker",
            "services": [],
            "severity": "Medium",
            "subcategory": "Cluster Configuration",
            "text": "The Environment Checker module has been run to validate the environment",
            "waf": "Reliability"
        },
        {
            "category": "Operations",
            "checklist": "Azure Stack HCI Review",
            "guid": "43ffbfab-766e-4950-a102-78b479136e4d",
            "link": "https://learn.microsoft.com/azure-stack/hci/manage/azure-benefits",
            "services": [
                "AzurePolicy"
            ],
            "severity": "Medium",
            "subcategory": "Cluster Configuration",
            "text": "Group Policy inheritance on the HCI cluster and node Active Directory organizational unit has been blocked or applied policies have been evaluated for compatibility issues (usually WinRM and PowerShell execution policy)",
            "waf": "Operations"
        },
        {
            "category": "Operations",
            "checklist": "Azure Stack HCI Review",
            "guid": "e6a3f3a7-4a7d-49e2-985a-6e39dd284027",
            "services": [],
            "severity": "Medium",
            "subcategory": "Cluster Configuration",
            "text": "WAC is on the latest release and configured to automatically upgrade extensions",
            "waf": "Reliability"
        },
        {
            "category": "Networking",
            "checklist": "Azure Stack HCI Review",
            "guid": "d1caa31f-cc26-42b2-b92f-2b667c0e6020",
            "link": "https://learn.microsoft.com/azure/architecture/hybrid/azure-stack-hci-dr",
            "services": [
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Stretch Clustering",
            "text": "There is sub 5ms latency between each site if synchronous replication is being configured AAD",
            "waf": "Performance"
        },
        {
            "category": "Networking",
            "checklist": "Azure Stack HCI Review",
            "guid": "3277558e-3155-4088-b49a-78594cb4ce1a",
            "services": [
                "VNet",
                "Storage"
            ],
            "severity": "High",
            "subcategory": "Stretch Clustering",
            "text": "Management, Replication and Storage networks excluded from stretched VLANs configurations, are routed, and in different subnets",
            "waf": "Reliability"
        },
        {
            "category": "Operations",
            "checklist": "Azure Stack HCI Review",
            "guid": "baed6066-8531-44ba-bd94-38cbabbf4099",
            "services": [],
            "severity": "High",
            "subcategory": "Stretch Clustering",
            "text": "There is a plan detailed for site failure and recovery",
            "waf": "Operations"
        },
        {
            "category": "Networking",
            "checklist": "Azure Stack HCI Review",
            "guid": "8e62945f-b9ac-4a5c-a4e4-836f527010b4",
            "services": [
                "ACR"
            ],
            "severity": "Medium",
            "subcategory": "Stretch Clustering",
            "text": "Separate vLANs and networks are used for each replication network across both sites",
            "waf": "Reliability"
        },
        {
            "category": "Operations",
            "checklist": "Azure Stack HCI Review",
            "guid": "8e62945f-b9ac-4a5c-a4e4-836f527010b5",
            "link": "https://learn.microsoft.com/azure/architecture/hybrid/azure-stack-hci-dr#cost-optimization",
            "services": [
                "Storage"
            ],
            "severity": "High",
            "subcategory": "Stretch Clustering",
            "text": "Use either a cloud witness or a file share witness in a third site for cluster quorum for clusters with less than 5 nodes",
            "waf": "Reliability"
        },
        {
            "category": "Operations",
            "checklist": "Azure Stack HCI Review",
            "guid": "8e62945f-b9ac-4a5c-a4e4-836f527010b6",
            "link": "https://learn.microsoft.com/azure/architecture/hybrid/azure-stack-hci-dr#cost-optimization",
            "services": [],
            "severity": "High",
            "subcategory": "Stretch Clustering",
            "text": "When using data deduplication, only enable it on the primary/source volumes",
            "waf": "Reliability"
        },
        {
            "category": "Operations",
            "checklist": "Azure Stack HCI Review",
            "guid": "ac527887-f6f4-40a3-b883-e04d704f013b",
            "link": "https://learn.microsoft.com/windows-server/storage/storage-replica/stretch-cluster-replication-using-shared-storage#provision-operating-system-features-roles-storage-and-network",
            "services": [
                "Storage"
            ],
            "severity": "High",
            "subcategory": "Stretch Clustering",
            "text": "Storage backing log volumes must be faster (ideally) or at least as fast as capacity storage",
            "waf": "Reliability"
        },
        {
            "category": "Backup and Disaster Recovery",
            "checklist": "Azure Stack HCI Review",
            "guid": "8ea49f70-1038-4283-b0c4-230165d3eabc",
            "link": "https://learn.microsoft.com/azure-stack/hci/manage/azure-site-recovery",
            "services": [
                "ASR",
                "Backup"
            ],
            "severity": "Medium",
            "subcategory": "Disaster Recovery",
            "text": "Azure Site Recovery has been considered for DR purposes",
            "waf": "Operations"
        },
        {
            "category": "Security",
            "checklist": "Azure Stack HCI Review",
            "guid": "03e65fdc-2628-4a1a-ba2e-a5174340ba52",
            "link": "https://learn.microsoft.com/windows/security/operating-system-security/data-protection/bitlocker/protecting-cluster-shared-volumes-and-storage-area-networks-with-bitlocker",
            "services": [],
            "severity": "Medium",
            "subcategory": "Host",
            "text": "BitLocker has been enabled on CSVs for volume encryption, where appropriate",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Stack HCI Review",
            "guid": "9645d2e6-ba28-453c-b6d5-d9ef29fc34be",
            "link": "https://learn.microsoft.com/windows-server/storage/file-server/smb-security",
            "services": [],
            "severity": "Medium",
            "subcategory": "Host",
            "text": "SMB encryption has been enabled, where appropriate",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Stack HCI Review",
            "guid": "8f03437a-5068-4486-9a78-0402ce771298",
            "link": "https://learn.microsoft.com/microsoft-365/security/defender-endpoint/microsoft-defender-antivirus-on-windows-server",
            "services": [
                "Defender"
            ],
            "severity": "Medium",
            "subcategory": "Host",
            "text": "Microsoft Defender Antivirus has been enabled on all nodes",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Stack HCI Review",
            "guid": "dba6b211-fc02-43b3-b7c8-f163c188332e",
            "link": "https://learn.microsoft.com/windows/security/identity-protection/credential-guard/credential-guard-manage",
            "services": [],
            "severity": "Medium",
            "subcategory": "Host",
            "text": "Credential Guard has been configured, where appropriate",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Container Registry Security Review",
            "description": "Disable image export to prevent data exfiltration. Note that this will prevent image import of images into another ACR instance.",
            "guid": "ab91932c-9fc9-4d1b-a880-37f5e6bfcb9e",
            "link": "https://learn.microsoft.com/azure/container-registry/data-loss-prevention",
            "service": "ACR",
            "services": [
                "ACR"
            ],
            "severity": "High",
            "subcategory": "Data Protection",
            "text": "Disable Azure Container Registry image export",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Container Registry Security Review",
            "description": "Enable audit compliance visibility by enabling Azure Policy for Azure Container Registry",
            "guid": "d503547c-d447-4e82-9128-a7100f1cac6d",
            "link": "https://learn.microsoft.com/azure/container-registry/container-registry-azure-policy",
            "service": "ACR",
            "services": [
                "AzurePolicy",
                "ACR"
            ],
            "severity": "High",
            "subcategory": "Data Protection",
            "text": "Enable Azure Policies for Azure Container Registry",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Container Registry Security Review",
            "description": "The Azure Key Vault (AKV) is used to store a signing key that can be utilized by?notation?with the notation AKV plugin (azure-kv) to sign and verify container images and other artifacts. The Azure Container Registry (ACR) allows you to attach these signatures using the?az?or?oras?CLI commands.",
            "guid": "d345293c-7639-4637-a551-c5c04e401955",
            "link": "https://learn.microsoft.com/azure/container-registry/container-registry-tutorial-sign-build-push",
            "service": "ACR",
            "services": [
                "AKV",
                "ACR"
            ],
            "severity": "High",
            "subcategory": "Data Protection",
            "text": "Sign and Verify containers with notation (Notary v2)",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Container Registry Security Review",
            "description": "Azure Container Registry automatically encrypts images and other artifacts that you store. By default, Azure automatically encrypts the registry content at rest by using service-managed keys. By using a customer-managed key, you can supplement default encryption with an additional encryption layer.",
            "guid": "0bd05dc2-efd5-4d76-8d41-d2500cc47b49",
            "link": "https://learn.microsoft.com/azure/container-registry/tutorial-customer-managed-keys",
            "service": "ACR",
            "services": [
                "AKV",
                "ACR"
            ],
            "severity": "Medium",
            "subcategory": "Data Protection",
            "text": "Encrypt registry with a customer managed key",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Container Registry Security Review",
            "description": "Use managed identities to secure ACRPull/Push RBAC access from client applications",
            "guid": "8f42d78e-79dc-47b3-9bd2-a1a27e7a8e90",
            "link": "https://learn.microsoft.com/azure/container-registry/container-registry-authentication-managed-identity",
            "service": "ACR",
            "services": [
                "Entra",
                "ACR",
                "RBAC"
            ],
            "severity": "High",
            "subcategory": "Identity and Access Control",
            "text": "Use Managed Identities to connect instead of Service Principals",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Container Registry Security Review",
            "description": "The local Administrator account is disabled by default and should not be enabled. Use either Token or RBAC-based access methods instead",
            "guid": "be0e38ce-e297-411b-b363-caaab79b198d",
            "link": "https://learn.microsoft.com/azure/container-registry/container-registry-authentication-managed-identity",
            "service": "ACR",
            "services": [
                "Entra",
                "ACR",
                "RBAC"
            ],
            "severity": "High",
            "subcategory": "Identity and Access Control",
            "text": "Disable local authentication for management plane access",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Container Registry Security Review",
            "description": "Disable Administrator account and assign RBAC roles to principals for ACR Pull/Push operations",
            "guid": "387e5ced-126c-4d13-8af5-b20c6998a646",
            "link": "https://learn.microsoft.com/azure/container-registry/container-registry-roles?tabs=azure-cli",
            "service": "ACR",
            "services": [
                "Entra",
                "ACR",
                "RBAC"
            ],
            "severity": "High",
            "subcategory": "Identity and Access Control",
            "text": "Assign AcrPull & AcrPush RBAC roles rather than granting Administrative access to identity principals",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Container Registry Security Review",
            "description": "Disable anonymous pull/push access",
            "guid": "e338997e-41c7-47d7-acf6-a62a1194956d",
            "link": "https://learn.microsoft.com/azure/container-registry/anonymous-pull-access#configure-anonymous-pull-access",
            "service": "ACR",
            "services": [
                "Entra",
                "ACR"
            ],
            "severity": "Medium",
            "subcategory": "Identity and Access Control",
            "text": "Disable Anonymous pull access",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Container Registry Security Review",
            "description": "Token authentication doesn't support assignment to an AAD principal. Any tokens provided are able to be used by anyone who can access the token",
            "guid": "698dc3a2-fd27-4b2e-8870-1a1252beedf6",
            "link": "https://learn.microsoft.com/azure/container-registry/container-registry-authentication?tabs=azure-cli",
            "service": "ACR",
            "services": [
                "Entra",
                "ACR"
            ],
            "severity": "High",
            "subcategory": "Identity and Access Control",
            "text": "Disable repository-scoped access tokens",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Container Registry Security Review",
            "description": "Deploy container images to an ACR behind a Private endpoint within a trusted network",
            "guid": "b3bec3d4-f343-47c1-936d-b55f27a71eee",
            "service": "ACR",
            "services": [
                "Entra",
                "ACR",
                "PrivateLink",
                "EventHubs"
            ],
            "severity": "High",
            "subcategory": "Identity and Access Control",
            "text": "Deploy images from a trusted environment",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Container Registry Security Review",
            "description": "Only tokens with an ACR audience can be used for authentication. Used when enabling Conditional access policies for ACR",
            "guid": "3a041fd3-2947-498b-8288-b3c6a56ceb54",
            "link": "https://learn.microsoft.com/azure/container-registry/container-registry-enable-conditional-access-policy",
            "service": "ACR",
            "services": [
                "AzurePolicy",
                "Entra",
                "ACR"
            ],
            "severity": "Medium",
            "subcategory": "Identity and Access Control",
            "text": "Disable Azure ARM audience tokens for authentication",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Container Registry Security Review",
            "description": "Set up a diagnostic setting to send 'repositoryEvents' & 'LoginEvents' to Log Analytics as the central destination for logging and monitoring. This allows you to monitor control plane activity on the ACR resource itself.",
            "guid": "8a488cde-c486-42bc-9bd2-1be77f26e5e6",
            "link": "https://learn.microsoft.com/azure/container-registry/monitor-service",
            "service": "ACR",
            "services": [
                "Entra",
                "ACR",
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Logging and Monitoring",
            "text": "Enable diagnostics logging",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Container Registry Security Review",
            "description": "Service supports disabling public network access either through using service-level IP ACL filtering rule (not NSG or Azure Firewall) or using a 'Disable Public Network Access' toggle switch",
            "guid": "21d41d25-00b7-407a-b9ea-b40fd3290798",
            "link": "https://learn.microsoft.com/azure/container-registry/container-registry-private-link",
            "service": "ACR",
            "services": [
                "VNet",
                "ACR",
                "Firewall",
                "PrivateLink"
            ],
            "severity": "Medium",
            "subcategory": "Network Security",
            "text": "Control inbound network access with Private Link",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Container Registry Security Review",
            "description": "Disable public network access if inbound network access is secured using Private Link",
            "guid": "cd289ced-6b17-4db8-8554-62f2aee4553a",
            "link": "https://learn.microsoft.com/azure/container-registry/container-registry-access-selected-networks#disable-public-network-access",
            "service": "ACR",
            "services": [
                "ACR",
                "PrivateLink"
            ],
            "severity": "Medium",
            "subcategory": "Network Security",
            "text": "Disable Public Network access",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Container Registry Security Review",
            "description": "Only the ACR Premium SKU supports Private Link access",
            "guid": "fc833934-8b26-42d6-ac5f-512925498f6d",
            "link": "https://learn.microsoft.com/azure/container-registry/container-registry-skus",
            "service": "ACR",
            "services": [
                "ACR",
                "PrivateLink"
            ],
            "severity": "Medium",
            "subcategory": "Network Security",
            "text": "Use an Azure Container Registry SKU that supports Private Link (Premium SKU)",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Container Registry Security Review",
            "description": "Azure Defender for containers or equivalent service should be used to scan container images for vulnerabilities",
            "guid": "bad37dac-43bc-46ce-8d7a-a9b24604489a",
            "link": "https://learn.microsoft.com/azure/defender-for-cloud/defender-for-containers-introduction",
            "service": "ACR",
            "services": [
                "ACR",
                "Defender"
            ],
            "severity": "Low",
            "subcategory": "Network Security",
            "text": "Enable Defender for Containers to scan Azure Container Registry for vulnerabilities",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Container Registry Security Review",
            "description": "Deploy trusted code that was validated and scanned for vulnerabilities according to DevSecOps practices.",
            "guid": "4451e1a2-d345-4293-a763-9637a551c5c0",
            "service": "ACR",
            "services": [
                "ACR"
            ],
            "severity": "Medium",
            "subcategory": "Vulnerability Management",
            "text": "Deploy validated container images",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Container Registry Security Review",
            "description": "Use the latest versions of supported platforms, programming languages, protocols, and frameworks.",
            "guid": "4e401955-387e-45ce-b126-cd132af5b20c",
            "service": "ACR",
            "services": [
                "ACR"
            ],
            "severity": "High",
            "subcategory": "Vulnerability Management",
            "text": "Use up-to-date platforms, languages, protocols and frameworks",
            "waf": "Security"
        },
        {
            "category": "Operations Management",
            "checklist": "DataBricks Review Checklist",
            "guid": "65285269-440c-44be-9d3e-0844276d4bdc",
            "link": "https://github.com/Azure/fta-resiliencyplaybooks/blob/main/pass-foudations-playbooks-ADB_v1.docx",
            "services": [],
            "severity": "High",
            "subcategory": "Best Practices",
            "text": "Reference Databricks HA/DR playbook",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "DataBricks Review Checklist",
            "guid": "89d558b9-37d3-4974-b111-2dbd7aaf12e6",
            "link": "https://learn.microsoft.com/azure/databricks/security/secrets/secret-scopes",
            "services": [
                "Backup"
            ],
            "severity": "Medium",
            "subcategory": "Backup",
            "text": "Backup Your Workspace Configuration including ARM templates and Secret Scopes",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "DataBricks Review Checklist",
            "guid": "b94ee5ef-47d2-4d92-a81b-1cd6d1f54b29",
            "link": "https://techcommunity.microsoft.com/t5/fasttrack-for-azure/sharing-metadata-across-different-databricks-workspaces-using/ba-p/3679757",
            "services": [
                "ACR",
                "Backup"
            ],
            "severity": "Medium",
            "subcategory": "Backup",
            "text": "Share MetaData Across different Databricks Workspaces using Hive External Metastore",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "DataBricks Review Checklist",
            "guid": "769e3969-0e78-428a-a936-657d03b0f466",
            "link": "https://techcommunity.microsoft.com/t5/fasttrack-for-azure/disaster-recovery-strategy-in-azure-databricks-using-the-hive/ba-p/3684581",
            "services": [
                "ASR",
                "Backup"
            ],
            "severity": "Medium",
            "subcategory": "Backup",
            "text": "Plan Disaster Recovery Strategy in Databricks using the Hive External Metastore",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "DataBricks Review Checklist",
            "guid": "4b1d944a-3598-437e-b79d-6c6d3a364a5b",
            "link": "https://www.databricks.com/blog/2021/04/20/attack-of-the-delta-clones-against-disaster-recovery-availability-complexity.html",
            "services": [
                "Backup"
            ],
            "severity": "Medium",
            "subcategory": "Backup",
            "text": "Backup your data with deep and shallow clones",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "DataBricks Review Checklist",
            "description": "Download the blob using Secondary Endpoint in RAGRS Storage Account",
            "guid": "7abae48a-bd54-4cd7-ae2e-86768357c559",
            "link": "https://techcommunity.microsoft.com/t5/azure-paas-blog/download-the-blob-using-secondary-endpoint-in-ragrs-storage/ba-p/2403750",
            "services": [
                "Storage",
                "Backup"
            ],
            "severity": "Medium",
            "subcategory": "Backup",
            "text": "Backup your data to Azure Storage RA-GRS",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "DataBricks Review Checklist",
            "guid": "675c5ee8-5b85-49c7-944c-e3b1a28b875a",
            "link": "https://learn.microsoft.com/azure/databricks/dev-tools/index-ci-cd",
            "services": [
                "Backup"
            ],
            "severity": "High",
            "subcategory": "Backup",
            "text": "Backup your code with DevOps",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "DataBricks Review Checklist",
            "guid": "a1bf1038-9f03-4a4d-8ce4-63dbbbc8682a",
            "link": "https://learn.microsoft.com/azure/databricks/administration-guide/disaster-recovery",
            "services": [
                "ASR"
            ],
            "severity": "High",
            "subcategory": "Disaster Recovery",
            "text": "Plan for Disaster recovery using Active/Active or Active/Passive Configuration",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "DataBricks Review Checklist",
            "description": "Migration package to log all Databricks resources for backup and/or migrating to another Databricks workspace",
            "guid": "5abc92a4-eda1-4dae-8cc8-5c47c6b781cc",
            "link": "https://github.com/databrickslabs/migrate",
            "services": [
                "Backup"
            ],
            "severity": "Medium",
            "subcategory": "Migration",
            "text": "Use Databricks Migration tools",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "DataBricks Review Checklist",
            "guid": "a0e6c465-89d5-458b-a37d-3974d1112dbd",
            "link": "https://github.com/databrickslabs/databricks-sync",
            "services": [],
            "severity": "Low",
            "subcategory": "Migration",
            "text": "Use Databricks Sync",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "DNS Review Checklist",
            "guid": "a96b96ad-8840-48f3-9273-4c876ba28021",
            "link": "https://learn.microsoft.com/azure/dns/private-dns-resiliency",
            "services": [
                "DNS",
                "VNet"
            ],
            "severity": "High",
            "subcategory": "Azure Private DNS",
            "text": "Verify that Zones are linked to Vnets in multiple regions",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "DNS Review Checklist",
            "guid": "45901465-d38e-453f-accb-d969266acca2",
            "link": "https://learn.microsoft.com/azure/dns/private-dns-resiliency",
            "services": [
                "DNS"
            ],
            "severity": "High",
            "subcategory": "Azure Private DNS",
            "text": "If different Zones are used between regions, verify a plan for making sure that Zones are up to date in a DR failover situation",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "DNS Review Checklist",
            "guid": "74faa19b-f39d-495d-94c7-c8919ca1f6d5",
            "link": "https://learn.microsoft.com/azure/reliability/reliability-traffic-manager?toc=%2Fazure%2Fdns%2Ftoc.json",
            "services": [
                "DNS",
                "TrafficManager",
                "ASR"
            ],
            "severity": "Medium",
            "subcategory": "Azure DNS",
            "text": "Plan for disaster recovery with Azure DNS and Traffic Manager",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "DNS Review Checklist",
            "guid": "315ae524-ba34-4d45-a5e1-2139bd7bb012",
            "link": "https://learn.microsoft.com/azure/dns/private-resolver-reliability#availability-zones",
            "services": [
                "DNS"
            ],
            "severity": "Medium",
            "subcategory": "Azure DNS Resolver",
            "text": "Enable availability zones with Private Resolver",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "DNS Review Checklist",
            "guid": "f7b95e06-e154-4e2a-a359-2828e6e20517",
            "link": "https://learn.microsoft.com/azure/dns/tutorial-dns-private-resolver-failover",
            "services": [
                "DNS",
                "ASR"
            ],
            "severity": "Medium",
            "subcategory": "Azure DNS Resolver",
            "text": "Plan for failover with Private Resolvers in a Disaster Recovery",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "DNS Review Checklist",
            "guid": "2676ae46-691e-4883-9ad9-42223e138105",
            "link": "https://learn.microsoft.com/azure/reliability/reliability-virtual-machines?toc=%2Fazure%2Fvirtual-machines%2Ftoc.json&bc=%2Fazure%2Fvirtual-machines%2Fbreadcrumb%2Ftoc.json&tabs=graph",
            "services": [
                "DNS",
                "VM"
            ],
            "severity": "Medium",
            "subcategory": "VM Based DNS Service",
            "text": "Follow VM Guidance for resillency of VM",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "DNS Review Checklist",
            "guid": "23081a94-1741-4583-9ff7-ad7c6d373316",
            "link": "https://www.windows-active-directory.com/azure-ad-dns-for-custom-domain-names-with-advanced-dns-settings.html",
            "services": [
                "DNS",
                "Entra",
                "VM"
            ],
            "severity": "Medium",
            "subcategory": "VM Based DNS Service",
            "text": "IF AD based DNS, follow the Identity -> Windows Server AD path",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerregistry/registries",
            "checklist": "WAF checklist",
            "description": "Disable image export to prevent data exfiltration. Note that this will prevent image import of images into another ACR instance.",
            "guid": "ab91932c-9fc9-4d1b-a880-37f5e6bfcb9e",
            "link": "https://learn.microsoft.com/azure/container-registry/data-loss-prevention",
            "service": "ACR",
            "services": [
                "WAF",
                "ACR"
            ],
            "severity": "High",
            "text": "Disable Azure Container Registry image export",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.containerregistry/registries",
            "checklist": "WAF checklist",
            "description": "Enable audit compliance visibility by enabling Azure Policy for Azure Container Registry",
            "guid": "d503547c-d447-4e82-9128-a7100f1cac6d",
            "link": "https://learn.microsoft.com/azure/container-registry/container-registry-azure-policy",
            "service": "ACR",
            "services": [
                "WAF",
                "AzurePolicy",
                "ACR"
            ],
            "severity": "High",
            "text": "Enable Azure Policies for Azure Container Registry",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.containerregistry/registries",
            "checklist": "WAF checklist",
            "description": "The Azure Key Vault (AKV) is used to store a signing key that can be utilized by?notation?with the notation AKV plugin (azure-kv) to sign and verify container images and other artifacts. The Azure Container Registry (ACR) allows you to attach these signatures using the?az?or?oras?CLI commands.",
            "guid": "d345293c-7639-4637-a551-c5c04e401955",
            "link": "https://learn.microsoft.com/azure/container-registry/container-registry-tutorial-sign-build-push",
            "service": "ACR",
            "services": [
                "WAF",
                "AKV",
                "ACR"
            ],
            "severity": "High",
            "text": "Sign and Verify containers with notation (Notary v2)",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.containerregistry/registries",
            "checklist": "WAF checklist",
            "description": "Azure Container Registry automatically encrypts images and other artifacts that you store. By default, Azure automatically encrypts the registry content at rest by using service-managed keys. By using a customer-managed key, you can supplement default encryption with an additional encryption layer.",
            "guid": "0bd05dc2-efd5-4d76-8d41-d2500cc47b49",
            "link": "https://learn.microsoft.com/azure/container-registry/tutorial-customer-managed-keys",
            "service": "ACR",
            "services": [
                "WAF",
                "AKV",
                "ACR"
            ],
            "severity": "Medium",
            "text": "Encrypt registry with a customer managed key",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.containerregistry/registries",
            "checklist": "WAF checklist",
            "description": "Use managed identities to secure ACRPull/Push RBAC access from client applications",
            "guid": "8f42d78e-79dc-47b3-9bd2-a1a27e7a8e90",
            "link": "https://learn.microsoft.com/azure/container-registry/container-registry-authentication-managed-identity",
            "service": "ACR",
            "services": [
                "WAF",
                "Entra",
                "ACR",
                "RBAC"
            ],
            "severity": "High",
            "text": "Use Managed Identities to connect instead of Service Principals",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.containerregistry/registries",
            "checklist": "WAF checklist",
            "description": "The local Administrator account is disabled by default and should not be enabled. Use either Token or RBAC-based access methods instead",
            "guid": "be0e38ce-e297-411b-b363-caaab79b198d",
            "link": "https://learn.microsoft.com/azure/container-registry/container-registry-authentication-managed-identity",
            "service": "ACR",
            "services": [
                "WAF",
                "RBAC"
            ],
            "severity": "High",
            "text": "Disable local authentication for management plane access",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.containerregistry/registries",
            "checklist": "WAF checklist",
            "description": "Disable Administrator account and assign RBAC roles to principals for ACR Pull/Push operations",
            "guid": "387e5ced-126c-4d13-8af5-b20c6998a646",
            "link": "https://learn.microsoft.com/azure/container-registry/container-registry-roles?tabs=azure-cli",
            "service": "ACR",
            "services": [
                "WAF",
                "Entra",
                "ACR",
                "RBAC"
            ],
            "severity": "High",
            "text": "Assign AcrPull & AcrPush RBAC roles rather than granting Administrative access to identity principals",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.containerregistry/registries",
            "checklist": "WAF checklist",
            "description": "Disable anonymous pull/push access",
            "guid": "e338997e-41c7-47d7-acf6-a62a1194956d",
            "link": "https://learn.microsoft.com/azure/container-registry/anonymous-pull-access#configure-anonymous-pull-access",
            "service": "ACR",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Disable Anonymous pull access",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.containerregistry/registries",
            "checklist": "WAF checklist",
            "description": "Token authentication doesn't support assignment to an AAD principal. Any tokens provided are able to be used by anyone who can access the token",
            "guid": "698dc3a2-fd27-4b2e-8870-1a1252beedf6",
            "link": "https://learn.microsoft.com/azure/container-registry/container-registry-authentication?tabs=azure-cli",
            "service": "ACR",
            "services": [
                "WAF",
                "Entra"
            ],
            "severity": "High",
            "text": "Disable repository-scoped access tokens",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.containerregistry/registries",
            "checklist": "WAF checklist",
            "description": "Deploy container images to an ACR behind a Private endpoint within a trusted network",
            "guid": "b3bec3d4-f343-47c1-936d-b55f27a71eee",
            "service": "ACR",
            "services": [
                "WAF",
                "ACR",
                "PrivateLink",
                "EventHubs"
            ],
            "severity": "High",
            "text": "Deploy images from a trusted environment",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.containerregistry/registries",
            "checklist": "WAF checklist",
            "description": "Only tokens with an ACR audience can be used for authentication. Used when enabling Conditional access policies for ACR",
            "guid": "3a041fd3-2947-498b-8288-b3c6a56ceb54",
            "link": "https://learn.microsoft.com/azure/container-registry/container-registry-enable-conditional-access-policy",
            "service": "ACR",
            "services": [
                "WAF",
                "Entra",
                "AzurePolicy",
                "ACR"
            ],
            "severity": "Medium",
            "text": "Disable Azure ARM audience tokens for authentication",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.containerregistry/registries",
            "checklist": "WAF checklist",
            "description": "Set up a diagnostic setting to send 'repositoryEvents' & 'LoginEvents' to Log Analytics as the central destination for logging and monitoring. This allows you to monitor control plane activity on the ACR resource itself.",
            "guid": "8a488cde-c486-42bc-9bd2-1be77f26e5e6",
            "link": "https://learn.microsoft.com/azure/container-registry/monitor-service",
            "service": "ACR",
            "services": [
                "WAF",
                "Entra",
                "ACR",
                "Monitor"
            ],
            "severity": "Medium",
            "text": "Enable diagnostics logging",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.containerregistry/registries",
            "checklist": "WAF checklist",
            "description": "Service supports disabling public network access either through using service-level IP ACL filtering rule (not NSG or Azure Firewall) or using a 'Disable Public Network Access' toggle switch",
            "guid": "21d41d25-00b7-407a-b9ea-b40fd3290798",
            "link": "https://learn.microsoft.com/azure/container-registry/container-registry-private-link",
            "service": "ACR",
            "services": [
                "WAF",
                "VNet",
                "Firewall",
                "PrivateLink"
            ],
            "severity": "Medium",
            "text": "Control inbound network access with Private Link",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.containerregistry/registries",
            "checklist": "WAF checklist",
            "description": "Disable public network access if inbound network access is secured using Private Link",
            "guid": "cd289ced-6b17-4db8-8554-62f2aee4553a",
            "link": "https://learn.microsoft.com/azure/container-registry/container-registry-access-selected-networks#disable-public-network-access",
            "service": "ACR",
            "services": [
                "WAF",
                "PrivateLink"
            ],
            "severity": "Medium",
            "text": "Disable Public Network access",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.containerregistry/registries",
            "checklist": "WAF checklist",
            "description": "Only the ACR Premium SKU supports Private Link access",
            "guid": "fc833934-8b26-42d6-ac5f-512925498f6d",
            "link": "https://learn.microsoft.com/azure/container-registry/container-registry-skus",
            "service": "ACR",
            "services": [
                "WAF",
                "ACR",
                "PrivateLink"
            ],
            "severity": "Medium",
            "text": "Use an Azure Container Registry SKU that supports Private Link (Premium SKU)",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.containerregistry/registries",
            "checklist": "WAF checklist",
            "description": "Azure Defender for containers or equivalent service should be used to scan container images for vulnerabilities",
            "guid": "bad37dac-43bc-46ce-8d7a-a9b24604489a",
            "link": "https://learn.microsoft.com/azure/defender-for-cloud/defender-for-containers-introduction",
            "service": "ACR",
            "services": [
                "WAF",
                "ACR",
                "Defender"
            ],
            "severity": "Low",
            "text": "Enable Defender for Containers to scan Azure Container Registry for vulnerabilities",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.containerregistry/registries",
            "checklist": "WAF checklist",
            "description": "Deploy trusted code that was validated and scanned for vulnerabilities according to DevSecOps practices.",
            "guid": "4451e1a2-d345-4293-a763-9637a551c5c0",
            "service": "ACR",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Deploy validated container images",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.containerregistry/registries",
            "checklist": "WAF checklist",
            "description": "Use the latest versions of supported platforms, programming languages, protocols, and frameworks.",
            "guid": "4e401955-387e-45ce-b126-cd132af5b20c",
            "service": "ACR",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Use up-to-date platforms, languages, protocols and frameworks",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "graph": "resources | where type=~'Microsoft.ServiceFabric/managedClusters' | extend compliant = (sku=~'{\"name\":\"Standard\"}') | distinct id,compliant",
            "guid": "182840d2-9ef8-4238-8fd6-0d76186830ac",
            "link": "https://learn.microsoft.com/azure/service-fabric/overview-managed-cluster#service-fabric-managed-cluster-skus",
            "service": "Azure Service Fabric",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Use Standard SKU for production scenarios.",
            "waf": "Reliability"
        },
        {
            "checklist": "WAF checklist",
            "graph": "resources | where type=~'Microsoft.ServiceFabric/clusters' | extend nodeTypes= array_concat(properties.nodeTypes) | mv-expand nodeTypes | summarize BronzeDurabilityCount = countif(nodeTypes.durabilityLevel == 'Bronze') by id | extend compliant = (BronzeDurabilityCount == 0) | distinct id,compliant",
            "guid": "182840d2-9ef8-4238-8fd6-0d76186830ac",
            "link": "https://learn.microsoft.com/azure/service-fabric/service-fabric-cluster-capacity#durability-characteristics-of-the-cluster",
            "service": "Azure Service Fabric",
            "services": [
                "WAF",
                "VM"
            ],
            "severity": "Medium",
            "text": "Use durability level Silver (5 VMs) or greater for production scenarios",
            "waf": "Reliability"
        },
        {
            "checklist": "WAF checklist",
            "graph": "resources | where type=~'Microsoft.ServiceFabric/managedClusters' | extend compliant= ( properties.zonalResiliency =~ 'true') | distinct id,compliant",
            "guid": "2363878d-55c4-4cbd-9bc2-94523c85f12e",
            "link": "https://learn.microsoft.com/azure/service-fabric/how-to-managed-cluster-availability-zones",
            "service": "Azure Service Fabric",
            "services": [
                "WAF",
                "ACR"
            ],
            "severity": "Medium",
            "text": "Consider using Availability Zones for your Service Fabric clusters. Service Fabric managed cluster supports deployments that span across multiple Availability Zones to provide zone resiliency. This configuration will ensure high-availability of the critical system services and your applications to protect from single-points-of-failure.",
            "waf": "Reliability"
        },
        {
            "checklist": "WAF checklist",
            "guid": "5ba74cc8-3ca2-44d5-9a67-bdc8e102e7b4",
            "link": "https://learn.microsoft.com/azure/service-fabric/service-fabric-api-management-overview",
            "service": "Azure Service Fabric",
            "services": [
                "WAF",
                "APIM"
            ],
            "severity": "Medium",
            "text": "Consider using Azure API Management to expose and offload cross-cutting functionality for APIs hosted on the cluster. API Management can integrate with Service Fabric directly.",
            "waf": "Reliability"
        },
        {
            "checklist": "WAF checklist",
            "guid": "ef17bb8f-4e2c-488b-8ceb-a07c3d750dd3",
            "link": "https://learn.microsoft.com/azure/service-fabric/service-fabric-reliable-services-introduction",
            "service": "Azure Service Fabric",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "For stateful workload scenarios, consider using Reliable Services. The Reliable Services model allows your services to stay up even in unreliable environments where your machines fail or hit network issues, or in cases where the services themselves encounter errors and crash or fail. For stateful services, your state is preserved even in the presence of network or other failures.",
            "waf": "Reliability"
        },
        {
            "checklist": "WAF checklist",
            "graph": "resources | where type=~'Microsoft.Compute/virtualMachineScaleSets' | extend vmssExtension= array_concat(properties.virtualMachineProfile.extensionProfile.extensions) | mv-expand vmssExtension | where vmssExtension.properties.publisher matches regex '^Microsoft.Azure.ServiceFabric.*' | summarize arg_max(id, *) | summarize compliant = countif(sku.name matches regex '^Standard_[^d]*$' ) by id",
            "guid": "4da21268-f775-4c89-a271-eb80543c8df7",
            "service": "Azure Service Fabric",
            "services": [
                "WAF",
                "VM"
            ],
            "severity": "Medium",
            "text": "Avoid VM SKUs with temp disk offerings. Service Fabric uses managed disks by default, so avoiding temp disk offerings ensures you don't pay for unneeded resources.",
            "waf": "Cost"
        },
        {
            "checklist": "WAF checklist",
            "guid": "1890b796-f300-41a3-a8d4-29738c1f4ad0",
            "link": "https://learn.microsoft.com/azure/service-fabric/how-to-managed-cluster-stateless-node-type#temporary-disk-support",
            "service": "Azure Service Fabric",
            "services": [
                "WAF",
                "VM"
            ],
            "severity": "Medium",
            "text": "If you need to select a certain VM SKU for capacity reasons and it happens to offer temp disk, consider using temporary disk support for your stateless workloads.",
            "waf": "Cost"
        },
        {
            "checklist": "WAF checklist",
            "guid": "5247bb32-6778-49c7-8b40-e171c9a3ce1e",
            "service": "Azure Service Fabric",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Align SKU selection and managed disk size with workload requirements. Matching your selection to your workload demands ensures you don't pay for unneeded resources.",
            "waf": "Cost"
        },
        {
            "checklist": "WAF checklist",
            "guid": "6028759b-446a-41bc-8b0e-7728e61ca704",
            "link": "https://learn.microsoft.com/azure/service-fabric/how-to-managed-cluster-networking#manage-nsg-rules",
            "service": "Azure Service Fabric",
            "services": [
                "WAF",
                "VNet",
                "APIM"
            ],
            "severity": "Medium",
            "text": "Ensure Network Security Groups (NSG) are configured to restrict traffic flow between subnets and node types. For example, you may have an API Management instance (one subnet), a frontend subnet (exposing a website directly), and a backend subnet (accessible only to frontend).",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "graph": "resources | where type=~'Microsoft.Compute/virtualMachineScaleSets' | extend vmssExtension= array_concat(properties.virtualMachineProfile.extensionProfile.extensions) | mv-expand vmssExtension | where vmssExtension.properties.publisher matches regex '^Microsoft.Azure.ServiceFabric.*' | summarize arg_max(id, *) | extend compliant = (isnotnull(properties.virtualMachineProfile.osProfile.secrets))",
            "guid": "4e98c903-14cf-4c72-9c45-b8b23bc4cbd8",
            "link": "https://learn.microsoft.com/azure/service-fabric/service-fabric-best-practices-security#deploy-key-vault-certificates-to-service-fabric-cluster-virtual-machine-scale-sets",
            "service": "Azure Service Fabric",
            "services": [
                "WAF",
                "AKV",
                "Entra",
                "VM",
                "Storage"
            ],
            "severity": "Medium",
            "text": "Deploy Key Vault certificates to Service Fabric cluster virtual machine scale sets. Centralizing storage of application secrets in Azure Key Vault allows you to control their distribution. Key Vault greatly reduces the chances that secrets may be accidentally leaked.",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "001cbb6f-d88d-4431-8434-d01333397776",
            "link": "https://learn.microsoft.com/azure/service-fabric/service-fabric-best-practices-security#apply-an-access-control-list-acl-to-your-certificate-for-your-service-fabric-cluster",
            "service": "Azure Service Fabric",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Apply an Access Control List (ACL) to your client certificate for your Service Fabric cluster. Using an ACL provides an additional level of authentication.",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "4b74b7a5-bb1e-4fca-948c-037ba95fb73b",
            "link": "https://learn.microsoft.com/azure/service-fabric/service-fabric-resource-governance#resource-governance-mechanism",
            "service": "Azure Service Fabric",
            "services": [
                "WAF",
                "ACR"
            ],
            "severity": "Medium",
            "text": "Use resource requests and limits to govern resource usage across the nodes in your cluster. Enforcing resource limits helps ensure that one service doesn't consume too many resources and starve other services.",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "cd9233ba-f3aa-4353-8d2f-7ea4a64160e6",
            "link": "",
            "service": "Azure Service Fabric",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Encrypt Service Fabric package secret values. Encryption on your secret values provides an additional level of security.",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "44b989d4-9f72-42b6-99da-ec2a79f83299",
            "link": "",
            "service": "Azure Service Fabric",
            "services": [
                "WAF",
                "AKV"
            ],
            "severity": "Medium",
            "text": "Include client certificates in Service Fabric applications. Having your applications use client certificates for authentication provides opportunities for security at both the cluster and workload level.",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "28e66ff7-4a77-4b2c-910d-0335f141208a",
            "link": "https://learn.microsoft.com/azure/service-fabric/how-to-managed-identity-managed-cluster-virtual-machine-scale-sets",
            "service": "Azure Service Fabric",
            "services": [
                "WAF",
                "Entra"
            ],
            "severity": "Medium",
            "text": "Authenticate Service Fabric applications to Azure Resources using Managed Identity. Using Managed Identity allow you to securely manage the credentials in your code for authenticating to various services without saving them locally on a developer workstation or in source control.",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "f16c413c-00a6-43aa-852c-b97292c33a56",
            "link": "https://learn.microsoft.com/azure/service-fabric/service-fabric-best-practices-security#hosting-untrusted-applications-in-a-service-fabric-cluster",
            "service": "Azure Service Fabric",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Follow Service Fabric best practices when hosting untrusted applications. Following the best practices provides a security standard to follow.",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.network/applicationGateways",
            "checklist": "WAF checklist",
            "graph": "resources | where type == 'microsoft.network/applicationgateways' | project id, compliant = properties.sku.name in ('Standard_v2', 'WAF_v2') | project id,compliant",
            "guid": "553585a6-abe0-11ed-afa1-0242ac120002",
            "link": "https://learn.microsoft.com/azure/application-gateway/overview-v2",
            "service": "App Gateway",
            "services": [
                "WAF",
                "AppGW"
            ],
            "severity": "Medium",
            "text": "Ensure you are using Application Gateway v2 SKU",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Network/loadBalancers",
            "checklist": "WAF checklist",
            "graph": "resources | where type == 'microsoft.network/loadbalancers' | project id, compliant=(tolower(sku.name) == 'standard')",
            "guid": "4e35fbf5-0ae2-48b2-97ce-753353edbd1a",
            "link": "https://learn.microsoft.com/azure/load-balancer/load-balancer-overview",
            "service": "Load Balancer",
            "services": [
                "WAF",
                "LoadBalancer"
            ],
            "severity": "Medium",
            "text": "Ensure you are using the Standard SKU for your Azure Load Balancers",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Network/loadBalancers",
            "checklist": "WAF checklist",
            "guid": "9432621a-8397-4654-a882-5bc856b7ef83",
            "link": "https://learn.microsoft.com/azure/load-balancer/load-balancer-standard-availability-zones",
            "service": "Load Balancer",
            "services": [
                "WAF",
                "LoadBalancer"
            ],
            "severity": "Medium",
            "text": "Ensure your Load Balancers frontend IP addresses are zone-redundant (unless you require zonal frontends).",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.network/applicationGateways",
            "checklist": "WAF checklist",
            "graph": "resources | where type=='microsoft.network/applicationgateways' | extend subnetId = tostring(properties.gatewayIPConfigurations[0].properties.subnet.id) | project id, subnetId | join (resources | where type=='microsoft.network/virtualnetworks' | project id,subnets=properties.subnets | mv-expand subnets | mv-expand subnets.properties.addressPrefixes | project id, subnetId = tostring(subnets.id), prefix1 = subnets.properties.addressPrefix, prefix2 = subnets.properties.addressPrefixes | mv-expand prefix2 | extend prefix = iff(isnotnull(prefix1), prefix1, prefix2) | extend subnetPrefixLength = split(prefix, '/')[1])on subnetId | extend compliant = (subnetPrefixLength <= 24 or subnetPrefixLength == 64) | distinct id,compliant",
            "guid": "dfc50f87-3800-424c-937b-ed5f186e7c15",
            "link": "https://learn.microsoft.com/azure/application-gateway/configuration-infrastructure#size-of-the-subnet",
            "service": "App Gateway",
            "services": [
                "WAF",
                "VNet",
                "AppGW"
            ],
            "severity": "Medium",
            "text": "Your Application Gateways v2 should be deployed in subnets with IP prefixes equal or larger than /24",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.network/applicationGateways",
            "checklist": "WAF checklist",
            "description": "Administration of reverse proxies in general and WAF in particular is closer to the application than to networking, so they belong in the same subscription as the app. Centralizing the Application Gateway and WAF in the connectivity subscription might be OK if it is managed by one single team.",
            "guid": "48b662d6-d15f-4512-a654-98f6dfe237de",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "service": "App Gateway",
            "services": [
                "WAF",
                "VNet",
                "Entra",
                "Subscriptions",
                "NVA",
                "AppGW"
            ],
            "severity": "Medium",
            "text": "Deploy Azure Application Gateway v2 or partner NVAs used for proxying inbound HTTP(S) connections within the landing-zone virtual network and with the apps that they're securing.",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.network/applicationGateways",
            "checklist": "WAF checklist",
            "guid": "f109e1f3-c79b-4f14-82de-6b5c22314d08",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "service": "App Gateway",
            "services": [
                "WAF",
                "DDoS"
            ],
            "severity": "Medium",
            "text": "Use a DDoS Network or IP protection plans for all Public IP addresses in application landing zones.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.network/applicationGateways",
            "checklist": "WAF checklist",
            "graph": "resources | where type =~ 'microsoft.network/applicationGateways' | extend compliant = (isnotnull(properties.autoscaleConfiguration) and properties.autoscaleConfiguration.minCapacity >= 2) | distinct id,compliant",
            "guid": "135bf4ac-f9db-461f-b76b-2ee9e30b12c0",
            "link": "https://learn.microsoft.com/azure/application-gateway/application-gateway-autoscaling-zone-redundant",
            "service": "App Gateway",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Configure autoscaling with a minimum amount of instances of two.",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/applicationGateways",
            "checklist": "WAF checklist",
            "graph": "resources | where type =~ 'microsoft.network/applicationGateways' | extend compliant = (isnotnull(zones) and array_length(zones) > 1) | distinct id,compliant",
            "guid": "060c6964-52b5-48db-af8b-83e4b2d85349",
            "link": "https://learn.microsoft.com/azure/reliability/migrate-app-gateway-v2",
            "service": "App Gateway",
            "services": [
                "WAF",
                "ACR",
                "AppGW"
            ],
            "severity": "Medium",
            "text": "Deploy Application Gateway across Availability Zones",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "WAF checklist",
            "guid": "3f29812b-2363-4cef-b179-b599de0d5973",
            "link": "https://learn.microsoft.com/azure/ddos-protection/ddos-protection-overview",
            "service": "Front Door",
            "services": [
                "WAF",
                "AzurePolicy",
                "FrontDoor",
                "AppGW"
            ],
            "severity": "Medium",
            "text": "When using Front Door and Application Gateway to help protect HTTP/S apps, use WAF policies in Front Door. Lock down Application Gateway to receive traffic only from Front Door.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Security"
        },
        {
            "ammp": true,
            "arm-service": "microsoft.network/trafficManagerProfiles",
            "checklist": "WAF checklist",
            "guid": "cd4cd21b-0881-437f-9e6c-4cfd3e504547",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "service": "Traffic Manager",
            "services": [
                "WAF",
                "TrafficManager"
            ],
            "severity": "High",
            "text": "Use Traffic Manager to deliver global apps that span protocols other than HTTP/S.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Reliability"
        },
        {
            "checklist": "WAF checklist",
            "guid": "3b4b3e88-a459-4ed5-a22f-644dfbc58204",
            "link": "https://learn.microsoft.com/azure/active-directory/app-proxy/application-proxy#how-application-proxy-works",
            "service": "Entra",
            "services": [
                "WAF",
                "Entra",
                "AVD"
            ],
            "severity": "Low",
            "text": "If users only need access to internal applications, has Microsoft Entra ID Application Proxy been considered as an alternative to Azure Virtual Desktop (AVD)?",
            "training": "https://learn.microsoft.com/learn/modules/configure-azure-ad-application-proxy/",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "01ca7cf1-5754-442d-babb-8ba6772e5c30",
            "link": "https://learn.microsoft.com/azure/active-directory/app-proxy/application-proxy#how-application-proxy-works",
            "service": "Entra",
            "services": [
                "WAF",
                "Entra"
            ],
            "severity": "Medium",
            "text": "To reduce the number of firewall ports open for incoming connections in your network, consider using Microsoft Entra ID Application Proxy to give remote users secure and authenticated access to internal applications.",
            "training": "https://learn.microsoft.com/learn/paths/implement-applications-external-access-azure-ad/",
            "waf": "Security"
        },
        {
            "ammp": true,
            "arm-service": "Microsoft.Network/loadBalancers",
            "checklist": "WAF checklist",
            "graph": "resources | where type=='microsoft.network/loadbalancers' | extend countOutRules=array_length(properties.outboundRules) | extend compliant = (countOutRules == 0) | distinct id,compliant",
            "guid": "97a2fd46-64b0-1dfa-b72d-9c8869496d75",
            "link": "https://learn.microsoft.com/azure/nat-gateway/nat-overview#outbound-connectivity",
            "service": "Load Balancer",
            "services": [
                "WAF",
                "LoadBalancer"
            ],
            "severity": "High",
            "text": "Use Azure NAT Gateway instead of Load Balancer outbound rules for better SNAT scalability",
            "waf": "Reliability"
        },
        {
            "ammp": true,
            "arm-service": "microsoft.network/applicationGateways",
            "checklist": "WAF checklist",
            "graph": "resources | where type == 'microsoft.network/applicationgatewaywebapplicationfirewallpolicies' | mv-expand properties.managedRules.managedRuleSets | project id, rulesettype = properties_managedRules_managedRuleSets.ruleSetType | extend compliant1 = (rulesettype == 'Microsoft_BotManagerRuleSet') | project id, compliant1 | summarize compliant = max(compliant1) by id",
            "guid": "2f8e81eb-8e68-4026-8b1f-70f9b05f7cf9",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/bot-protection",
            "service": "App Gateway",
            "services": [
                "WAF",
                "AppGW"
            ],
            "severity": "High",
            "text": "Enable the Azure Application Gateway WAF bot protection rule set. The bot rules detect good and bad bots.",
            "waf": "Security"
        },
        {
            "ammp": true,
            "arm-service": "microsoft.network/applicationGateways",
            "checklist": "WAF checklist",
            "graph": "resources | where type =~ 'microsoft.network/applicationgatewaywebapplicationfirewallpolicies' | extend compliant = (properties['policySettings']['requestBodyCheck'] == 'true' and properties['policySettings']['state'] =~ 'Enabled') | distinct id, name, compliant",
            "guid": "8ea8e0d4-84e8-4b33-aeab-493f6391b4d6",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/application-gateway-waf-request-size-limits#request-body-inspection",
            "service": "App Gateway",
            "services": [
                "WAF",
                "AzurePolicy",
                "AppGW"
            ],
            "severity": "High",
            "text": "Ensure if request body inspection feature is enabled in Azure Application Gateway WAF policy.",
            "waf": "Security"
        },
        {
            "ammp": true,
            "arm-service": "microsoft.network/applicationGateways",
            "checklist": "WAF checklist",
            "guid": "a4dd86d3-5ffa-408c-b660-cce073d085b8",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/best-practices#tune-your-waf",
            "service": "App Gateway",
            "services": [
                "WAF",
                "AppGW"
            ],
            "severity": "High",
            "text": "Tune the Azure Application Gateway WAF in detection mode for your workload. Reduce false positive detections.",
            "waf": "Security"
        },
        {
            "ammp": true,
            "arm-service": "microsoft.network/applicationGateways",
            "checklist": "WAF checklist",
            "guid": "baf8e317-2397-4d49-b3d1-0dcc16d8778d",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/policy-overview?source=recommendations",
            "service": "App Gateway",
            "services": [
                "WAF",
                "AzurePolicy",
                "AppGW"
            ],
            "severity": "High",
            "text": "Deploy your WAF policy for Application Gateway in 'Prevention' mode.",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.network/applicationGateways",
            "checklist": "WAF checklist",
            "guid": "43fae595-8a32-4299-a69e-0f32c454dcc9",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/rate-limiting-overview",
            "service": "App Gateway",
            "services": [
                "WAF",
                "AppGW"
            ],
            "severity": "Medium",
            "text": "Add rate limiting to the Azure Application Gateway WAF. Rate limiting blocks clients accidentally or intentionally sending large amounts of traffic in a short period of time.",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.network/applicationGateways",
            "checklist": "WAF checklist",
            "guid": "041e0ad8-7b12-4694-a0b7-a0e25ee2470f",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/rate-limiting-overview#rate-limiting-details",
            "service": "App Gateway",
            "services": [
                "WAF",
                "AppGW"
            ],
            "severity": "Medium",
            "text": "Use a high threshold for Azure Application Gateway WAF rate limits. High rate limit thresholds avoid blocking legitimate traffic, while still providing protection against extremely high numbers of requests that might overwhelm your infrastructure. ",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.network/applicationGateways",
            "checklist": "WAF checklist",
            "guid": "99937189-ff78-492a-b9ca-18d828d82b37",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/best-practices#geo-filtering-best-practices",
            "service": "App Gateway",
            "services": [
                "WAF"
            ],
            "severity": "Low",
            "text": "If you are not expecting traffic from all geographical regions, use geo-filters to block traffic from non-expected countries.",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.network/applicationGateways",
            "checklist": "WAF checklist",
            "guid": "349a15c1-52f4-4319-9078-3895d95ecafd",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/geomatch-custom-rules",
            "service": "App Gateway",
            "services": [
                "WAF",
                "AppGW"
            ],
            "severity": "Medium",
            "text": "Specify the unknown (ZZ) location when geo-filtering traffic with the Azure Application Gateway WAF. Avoid accidentally blocking legitimate requests when IP addresses can't be geo-matched.",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.network/applicationGateways",
            "checklist": "WAF checklist",
            "guid": "6c19dfd5-a61c-436c-9001-491b9b3d0228",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/best-practices#use-the-latest-ruleset-versions",
            "service": "App Gateway",
            "services": [
                "WAF",
                "AppGW"
            ],
            "severity": "Medium",
            "text": "Use the latest Azure Application Gateway WAF rule set version. Rule set updates are regularly updated to take account of the current threat landscape.",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.network/applicationGateways",
            "checklist": "WAF checklist",
            "guid": "f84106a2-2e9e-42ac-add6-d3416ecfed53",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/best-practices#add-diagnostic-settings-to-save-your-wafs-logs",
            "service": "App Gateway",
            "services": [
                "WAF",
                "AppGW"
            ],
            "severity": "Medium",
            "text": "Add diagnostic settings to save your Azure Application Gateway WAF logs.",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.network/applicationGateways",
            "checklist": "WAF checklist",
            "guid": "92664c60-47e3-4591-8b1b-8d557656e686",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/best-practices#send-logs-to-microsoft-sentinel",
            "service": "App Gateway",
            "services": [
                "WAF",
                "Sentinel",
                "AppGW"
            ],
            "severity": "Medium",
            "text": "Send Azure Application Gateway WAF logs to Microsoft Sentinel.",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.network/applicationGateways",
            "checklist": "WAF checklist",
            "guid": "ba0e9b26-6e0d-4ec8-8541-023c00afd5b7",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/best-practices#define-your-waf-configuration-as-code",
            "service": "App Gateway",
            "services": [
                "WAF",
                "AppGW"
            ],
            "severity": "Medium",
            "text": "Define your Azure Application Gateway WAF configuration as code. By using code, you can more easily adopt new rule set version and gain additional protection.",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.network/applicationGateways",
            "checklist": "WAF checklist",
            "guid": "f17ec301-8470-4afd-aabc-c1fdfe47dcc0",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/policy-overview",
            "service": "App Gateway",
            "services": [
                "WAF",
                "AzurePolicy"
            ],
            "severity": "Medium",
            "text": "Use WAF Policies instead of the legacy WAF configuration.",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.network/applicationGateways",
            "checklist": "WAF checklist",
            "guid": "d4eb8667-f8cb-4cdd-94e6-2f967ba98f88",
            "link": "https://learn.microsoft.com/azure/virtual-wan/scenario-secured-hub-app-gateway",
            "service": "App Gateway",
            "services": [
                "WAF",
                "ExpressRoute",
                "VNet",
                "VPN",
                "AppGW"
            ],
            "severity": "Medium",
            "text": "Filter inbound traffic in the backends so that they only accept connections from the Application Gateway subnet, for example with NSGs.",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.network/applicationGateways",
            "checklist": "WAF checklist",
            "guid": "a66f0fd8-2ca4-422e-8df3-235148127ca2",
            "link": "https://learn.microsoft.com/azure/application-gateway/ssl-overview",
            "service": "App Gateway",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "You should encrypt traffic to the backend servers.",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.network/applicationGateways",
            "checklist": "WAF checklist",
            "guid": "3dba65cb-834d-44d8-a3ca-a6aa2f1587be",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/overview",
            "service": "App Gateway",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "You should use a Web Application Firewall.",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.network/applicationGateways",
            "checklist": "WAF checklist",
            "guid": "0158fcb6-0bc1-4687-832f-cc7c359c22d2",
            "link": "https://learn.microsoft.com/azure/application-gateway/redirect-overview",
            "service": "App Gateway",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Redirect HTTP to HTTPS",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.network/applicationGateways",
            "checklist": "WAF checklist",
            "guid": "bb697864-1b4c-43af-8667-90cc69aaed5f",
            "link": "https://learn.microsoft.com/azure/application-gateway/how-application-gateway-works#modifications-to-the-request",
            "service": "App Gateway",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Use gateway-managed cookies to direct traffic from a user session to the same server for processing",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.network/applicationGateways",
            "checklist": "WAF checklist",
            "guid": "ff353ad8-15fb-4ae8-9fc5-a85a36d36a35",
            "link": "https://learn.microsoft.com/azure/application-gateway/configuration-http-settings",
            "service": "App Gateway",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Enable connection draining during planned service updates to prevent connection loss to existing members of the backend pool",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.network/applicationGateways",
            "checklist": "WAF checklist",
            "guid": "c8741f03-45a4-4183-a6b8-139e0773b8b5",
            "link": "https://learn.microsoft.com/azure/application-gateway/custom-error",
            "service": "App Gateway",
            "services": [
                "WAF"
            ],
            "severity": "Low",
            "text": "Create custom error pages to display a personalized user experience",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.network/applicationGateways",
            "checklist": "WAF checklist",
            "guid": "f850d46f-f5d7-4b17-b48c-a780741402e1",
            "link": "https://learn.microsoft.com/azure/application-gateway/rewrite-http-headers-url",
            "service": "App Gateway",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Edit HTTP requests and response headers for easier routing and information exchange between the client and server",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.network/applicationGateways",
            "checklist": "WAF checklist",
            "guid": "eadc3164-4a0f-461c-85f1-1a372c04dfd1",
            "link": "https://learn.microsoft.com/azure/frontdoor/front-door-overview",
            "service": "App Gateway",
            "services": [
                "WAF",
                "FrontDoor"
            ],
            "severity": "Medium",
            "text": "Configure Front Door to optimize global web traffic routing and top-tier end-user performance, and reliability through quick global failover",
            "waf": "Performance"
        },
        {
            "arm-service": "microsoft.network/applicationGateways",
            "checklist": "WAF checklist",
            "guid": "29dcc19f-a8fa-4c35-8281-290577538793",
            "link": "https://learn.microsoft.com/azure/load-balancer/load-balancer-overview",
            "service": "App Gateway",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Use transport layer load balancing",
            "waf": "Performance"
        },
        {
            "arm-service": "microsoft.network/applicationGateways",
            "checklist": "WAF checklist",
            "guid": "276898c1-af5e-4819-9e8e-049c7801ab9d",
            "link": "https://learn.microsoft.com/azure/application-gateway/multiple-site-overview",
            "service": "App Gateway",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Configure routing based on host or domain name for multiple web applications on a single gateway",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.network/applicationGateways",
            "checklist": "WAF checklist",
            "guid": "5fe365b6-58e8-47ed-a8cf-5163850380a2",
            "link": "https://learn.microsoft.com/azure/application-gateway/create-ssl-portal",
            "service": "App Gateway",
            "services": [
                "WAF",
                "Entra"
            ],
            "severity": "Medium",
            "text": "Centralize SSL certificate management to reduce encryption and decryption overhead from a backend server farm",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.network/applicationGateways",
            "checklist": "WAF checklist",
            "guid": "fa64b4dd-35c2-4047-ac5c-45dfbf8b0db9",
            "link": "https://learn.microsoft.com/azure/application-gateway/application-gateway-websocket",
            "service": "App Gateway",
            "services": [
                "WAF",
                "AppGW"
            ],
            "severity": "Low",
            "text": "Use Application Gateway for native support for WebSocket and HTTP/2 protocols",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.DBforPostgreSQL/servers",
            "checklist": "WAF checklist",
            "guid": "65285269-441c-44bf-9d3e-0844276d4bdc",
            "link": "https://learn.microsoft.com/azure/postgresql/flexible-server/overview",
            "service": "PostgreSQL",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Leverage Flexible Server",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.DBforPostgreSQL/servers",
            "checklist": "WAF checklist",
            "guid": "016ccf31-ae5a-41eb-9888-9535e227896d",
            "link": "https://learn.microsoft.com/azure/postgresql/flexible-server/overview#architecture-and-high-availability",
            "service": "PostgreSQL",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Leverage Availability Zones where regionally applicable",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.DBforPostgreSQL/servers",
            "checklist": "WAF checklist",
            "guid": "31b67c67-be59-4519-8083-845d587cb391",
            "link": "https://learn.microsoft.com/azure/postgresql/single-server/concepts-business-continuity#cross-region-read-replicas",
            "service": "PostgreSQL",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Leverage cross-region read replicas for BCDR",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "21c30d25-ffb7-4f6a-b9ea-b3fec328f787",
            "link": "https://github.com/Azure/fta-resiliencyplaybooks/blob/main/paas-foundations-playbooks-cog_svcs_v1.docx",
            "service": "Cognitive Services",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Leverage FTA HandBook for Cognitive Services",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "78c34698-16b2-4763-aefe-1b9b599de0d5",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/concepts/advanced-prompt-engineering?pivots=programming-language-chat-completions",
            "service": "Cognitive Services",
            "services": [
                "WAF",
                "Backup"
            ],
            "severity": "Medium",
            "text": "Backup Your Prompts",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "750ab2ab-039d-4a6d-95d7-c892adb107d5",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/business-continuity-disaster-recovery",
            "service": "Cognitive Services",
            "services": [
                "WAF",
                "ASR"
            ],
            "severity": "High",
            "text": "Business Continuity and Disaster Recovery (BCDR) considerations with Azure OpenAI Service",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "325af625-ca44-4e46-a5e2-223ace8bb123",
            "link": "https://github.com/abacaj/chatgpt-backup#backup-your-chatgpt-conversations",
            "service": "Cognitive Services",
            "services": [
                "WAF",
                "Backup"
            ],
            "severity": "Medium",
            "text": "Backup Your ChatGPT conversations",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "07ca5f17-f154-4e3a-a369-2829e7e31618",
            "link": "https://learn.microsoft.com/azure/ai-services/speech-service/how-to-custom-speech-continuous-integration-continuous-deployment",
            "service": "Cognitive Services",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "CI/CD for custom speech",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "3687a046-7a1f-4893-9bda-43324f248116",
            "link": "https://learn.microsoft.com/azure/ai-services/qnamaker/tutorials/export-knowledge-base",
            "service": "Cognitive Services",
            "services": [
                "WAF"
            ],
            "severity": "Low",
            "text": "Move a knowledge base using export-import",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Web/sites",
            "checklist": "WAF checklist",
            "guid": "3b7a56de-5020-4642-b3cb-c976e80b6d6d",
            "link": "https://learn.microsoft.com/azure/logic-apps/single-tenant-overview-compare",
            "service": "Logic Apps",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Select the right Logic App hosting plan based on your business & SLO requirements",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Web/sites",
            "checklist": "WAF checklist",
            "guid": "3d7008bd-6bc1-4b03-8aa8-ec2a3b55786a",
            "link": "https://learn.microsoft.com/azure/logic-apps/set-up-zone-redundancy-availability-zones?tabs=standard#next-steps",
            "service": "Logic Apps",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Protect logic apps from region failures with zone redundancy and availability zones",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Web/sites",
            "checklist": "WAF checklist",
            "guid": "1cda768f-a206-445d-8234-56f6a6e7286e",
            "link": "https://learn.microsoft.com/azure/logic-apps/business-continuity-disaster-recovery-guidance?toc=%2Fazure%2Freliability%2Ftoc.json&bc=%2Fazure%2Freliability%2Fbreadcrumb%2Ftoc.json",
            "service": "Logic Apps",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Consider a Cross-Region DR strategy for critical workloads",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Web/sites",
            "checklist": "WAF checklist",
            "guid": "82118ec5-ed6f-4c68-9471-eb0da98a1b34",
            "link": "https://learn.microsoft.com/azure/app-service/environment/intro",
            "service": "Logic Apps",
            "services": [
                "WAF",
                "AppSvc"
            ],
            "severity": "High",
            "text": "If deploying to an Isolated environment, use or migrate to App Service Environment (ASE) v3",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Web/sites",
            "checklist": "WAF checklist",
            "guid": "74275fa5-9e08-4c7e-b096-13b538fe1501",
            "link": "https://learn.microsoft.com/training/modules/deploy-azure-functions/",
            "service": "Logic Apps",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Leverage Azure DevOps or GitHub to streamline CI/CD and safeguard your Logic App code",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.Web/sites",
            "checklist": "WAF checklist",
            "guid": "4238f409-2ea0-43be-a06b-2a993c98aa7b",
            "link": "https://learn.microsoft.com/en-us/azure/azure-functions/functions-scale#overview-of-plans",
            "service": "Azure Functions",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Select the right Function hosting plan based on your business & SLO requirements",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Web/sites",
            "checklist": "WAF checklist",
            "guid": "a9808100-d640-4f77-ac56-1ec0600f6752",
            "link": "https://learn.microsoft.com/en-us/azure/azure-functions/functions-scale#overview-of-plans",
            "query": "resources | where type =~ 'Microsoft.Web/sites' and kind has 'functionapp' and tolower(kind) !contains 'workflow' | extend aspResourceId = tostring(properties.serverFarmId), managedEnvId = tostring(properties.managedEnvironmentId), sku = tostring(properties.sku) | extend sku = iif(isnotempty(sku), sku, iif(isnotempty(managedEnvId), 'ContainerApps', '')) | where sku !in ('Dynamic', 'FlexConsumption', '') | extend aspName = tostring(split(aspResourceId, '/').[-1]), managedEnvName = tostring(split(managedEnvId, '/').[-1]) | extend HostingPlan = tostring(iif(isnotempty(aspName), aspName, managedEnvName)) | project functionAppName = name, functionAppId = id, HostingPlan, sku | join kind=inner ( resources | where type =~ 'Microsoft.Web/serverfarms' or type =~ 'Microsoft.App/managedEnvironments' | extend HostingPlan = tostring(name), zoneRedundant = tostring(properties.zoneRedundant), compliant = tobool(properties.zoneRedundant) | project HostingPlan, resourceId = id, zoneRedundant, compliant ) on HostingPlan | project functionAppName, functionAppId, sku, HostingPlan, resourceId, zoneRedundant, compliant",
            "service": "Azure Functions",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Leverage Availability Zones where regionally applicable (not available for Consumption tier)",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Web/sites",
            "checklist": "WAF checklist",
            "guid": "5969d03e-eacf-4042-b127-73c55e3575fa",
            "link": "https://learn.microsoft.com/en-us/azure/reliability/reliability-functions?tabs=azure-portal#cross-region-disaster-recovery-and-business-continuity",
            "service": "Azure Functions",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Consider a Cross-Region DR strategy for critical workloads",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Web/sites",
            "checklist": "WAF checklist",
            "guid": "47a0aae0-d8a0-43b1-9791-e934dee3754c",
            "link": "https://learn.microsoft.com/en-us/azure/app-service/environment/intro",
            "service": "Azure Functions",
            "services": [
                "WAF",
                "AppSvc"
            ],
            "severity": "High",
            "text": "If deploying to an Isolated environment, use or migrate to App Service Environment (ASE) v3",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Web/sites",
            "checklist": "WAF checklist",
            "guid": "17232891-f89f-4eaa-90f1-3b34bf798ed5",
            "link": "https://learn.microsoft.com/en-us/azure/azure-functions/dedicated-plan#always-on",
            "query": "resources | where type =~ 'Microsoft.Web/sites' and kind has 'functionapp' | where tolower(kind) !contains 'workflow' | where isnotempty(properties.serverFarmId) | extend sku = tostring(properties.sku) | where isnotempty(sku) | where sku !in ('Dynamic', 'FlexConsumption', 'ElasticPremium') | extend alwaysOn = properties.siteConfig.alwaysOn | project functionAppName = name, functionAppId = id, serverFarmId = tostring(properties.serverFarmId), sku, alwaysOn, compliant = tobool(alwaysOn)",
            "service": "Azure Functions",
            "services": [
                "WAF",
                "AppSvc"
            ],
            "severity": "High",
            "text": "Ensure 'Always On' is enabled for all Function Apps running on App Service Plan",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Web/sites",
            "checklist": "WAF checklist",
            "guid": "40a325c2-7c0e-49e6-86d8-c273b4dc21ba",
            "link": "https://learn.microsoft.com/en-us/azure/azure-functions/storage-considerations?tabs=azure-cli#shared-storage-accounts",
            "service": "Azure Functions",
            "services": [
                "WAF",
                "Storage"
            ],
            "severity": "Medium",
            "text": "Pair a Function App to its own storage account. Try not to re-use storage accounts for Function Apps unless they are tightly coupled",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Web/sites",
            "checklist": "WAF checklist",
            "guid": "bb42650c-257d-4cb0-822a-131138b8e6f0",
            "link": "https://learn.microsoft.com/en-us/training/modules/deploy-azure-functions/",
            "service": "Azure Functions",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Leverage Azure DevOps or GitHub to streamline CI/CD and safeguard your Function App code",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.documentdb/databaseAccounts",
            "checklist": "WAF checklist",
            "guid": "43e52f47-22d9-428c-8b1c-d521e54a29a9",
            "link": "https://github.com/Azure/fta-resiliencyplaybooks/blob/main/pass-foundations-playbooks-CosmosDB_v1.docx",
            "service": "CosmosDB",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "FTA Resiliency Playbook",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.documentdb/databaseAccounts",
            "checklist": "WAF checklist",
            "guid": "de39ac0e-7c28-4dc9-9565-7202bff4564b",
            "link": "https://learn.microsoft.com/azure/cosmos-db/high-availability#slas",
            "service": "CosmosDB",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Leverage Availablity Zones where regionally applicable and ofcourse if the service offers it",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.documentdb/databaseAccounts",
            "checklist": "WAF checklist",
            "guid": "0d934a34-8b26-43e7-bd60-513a3649906e",
            "link": "https://learn.microsoft.com/azure/cosmos-db/high-availability#replica-outages",
            "service": "CosmosDB",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Run multiple replicas of the database (>1 ) in Prod",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.documentdb/databaseAccounts",
            "checklist": "WAF checklist",
            "description": "Multi-region writes capability allows you to take advantage of the provisioned throughput for your databases and containers across the globe",
            "guid": "bad38ead-53cc-47de-8d8a-aab3571449ab",
            "link": "https://learn.microsoft.com/azure/cosmos-db/high-availability#multiple-write-regions",
            "service": "CosmosDB",
            "services": [
                "WAF",
                "ACR"
            ],
            "severity": "Medium",
            "text": "Leverage Multi-Region Writes",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.documentdb/databaseAccounts",
            "checklist": "WAF checklist",
            "description": "Span Cosmos account across two or more regions with multi-region writes",
            "guid": "8153d89f-89dc-47b3-9be2-b1a27f7b9e91",
            "link": "https://learn.microsoft.com/azure/cosmos-db/high-availability#slas",
            "service": "CosmosDB",
            "services": [
                "WAF",
                "ACR"
            ],
            "severity": "Medium",
            "text": "Distribute your data globally",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.documentdb/databaseAccounts",
            "checklist": "WAF checklist",
            "description": "Choose from various consistency levels such as Eventual, Consistent Prefix, Session, Bounded Staleness and strong",
            "guid": "9f8ea848-25ec-4140-bc32-2758e6ee9ac0",
            "link": "https://learn.microsoft.com/azure/cosmos-db/consistency-levels",
            "service": "CosmosDB",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Choose from several well-defined consistency models",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.documentdb/databaseAccounts",
            "checklist": "WAF checklist",
            "description": "Maintain business continuity during regional outages. Azure Cosmos DB supports service-managed failover during a regional outage. During a regional outage, Azure Cosmos DB continues to maintain its latency, availability, consistency, and throughput SLAs. To help make sure that your entire application is highly available, Azure Cosmos DB offers a manual failover API to simulate a regional outage. By using this API, you can carry out regular business continuity drills.",
            "guid": "a47e4d1e-bb79-43f9-bf87-69e1032b72fe",
            "link": "https://learn.microsoft.com/azure/cosmos-db/how-to-manage-database-account#automatic-failover",
            "service": "CosmosDB",
            "services": [
                "WAF",
                "CosmosDB"
            ],
            "severity": "Medium",
            "text": "Enable Service managed failover",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.documentdb/databaseAccounts",
            "checklist": "WAF checklist",
            "description": "Azure Cosmos DB automatically takes backups of your data at regular intervals. The automatic backups are taken without affecting the performance or availability of the database operations. All the backups are stored separately in a storage service.",
            "guid": "3499c9c1-133d-42f7-a4b1-a5bd06ff1a90",
            "link": "https://learn.microsoft.com/azure/cosmos-db/online-backup-and-restore",
            "service": "CosmosDB",
            "services": [
                "WAF",
                "CosmosDB",
                "Storage",
                "Backup"
            ],
            "severity": "Medium",
            "text": "Enable Automatic Backups",
            "training": "https://learn.microsoft.com/learn/modules/explore-basic-services-identity-types/",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.documentdb/databaseAccounts",
            "checklist": "WAF checklist",
            "description": "This mode is the default backup mode for all existing accounts. In this mode, backup is taken at a periodic interval and the data is restored by creating a request with the support team. In this mode, you configure a backup interval and retention for your account. The maximum retention period extends to a month. The minimum backup interval can be one hour.",
            "guid": "a6eb33f6-005c-4d92-9286-7655672d6121",
            "link": "https://learn.microsoft.com/azure/cosmos-db/periodic-backup-restore-introduction",
            "service": "CosmosDB",
            "services": [
                "WAF",
                "Backup"
            ],
            "severity": "Medium",
            "text": "Perform Periodic Backups",
            "training": "https://learn.microsoft.com/learn/paths/manage-identity-and-access/",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.documentdb/databaseAccounts",
            "checklist": "WAF checklist",
            "description": "Continous 7 day retention and 30 day retention backups. Azure Cosmos DB performs data backup in the background without consuming any extra provisioned throughput (RUs) or affecting the performance and availability of your database. Continuous backups are taken in every region where the account exists.",
            "guid": "d43918a8-cd28-49be-b6b1-7cb8245461e1",
            "link": "https://learn.microsoft.com/azure/cosmos-db/continuous-backup-restore-introduction",
            "service": "CosmosDB",
            "services": [
                "WAF",
                "CosmosDB",
                "Backup"
            ],
            "severity": "Medium",
            "text": "Continous Backup with point-in-time restore in Azure Cosmos DB",
            "training": "https://learn.microsoft.com/learn/modules/create-custom-azure-roles-with-rbac/",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.eventhub/namespaces",
            "checklist": "WAF checklist",
            "description": "Azure Event Hub provides encryption of data at rest. If you use your own key, the data is still encrypted using the Microsoft-managed key, but in addition the Microsoft-managed key will be encrypted using the customer-managed key. ",
            "guid": "7aaf12e7-b94e-4f6e-847d-2d92981b1cd6",
            "link": "https://learn.microsoft.com/azure/event-hubs/configure-customer-managed-key",
            "service": "Event Hubs",
            "services": [
                "WAF",
                "EventHubs"
            ],
            "severity": "Low",
            "text": "Use customer-managed key option in data at rest encryption when required",
            "training": "https://learn.microsoft.com/learn/modules/plan-implement-administer-conditional-access/",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.eventhub/namespaces",
            "checklist": "WAF checklist",
            "description": "Azure Event Hubs namespaces permit clients to send and receive data with TLS 1.0 and above. To enforce stricter security measures, you can configure your Event Hubs namespace to require that clients send and receive data with a newer version of TLS. If an Event Hubs namespace requires a minimum version of TLS, then any requests made with an older version will fail. ",
            "guid": "d2f54b29-769e-43a6-a0e7-828ac936657e",
            "link": "https://learn.microsoft.com/azure/event-hubs/transport-layer-security-configure-minimum-version",
            "service": "Event Hubs",
            "services": [
                "WAF",
                "EventHubs"
            ],
            "severity": "Medium",
            "text": "Enforce a minimum required version of Transport Layer Security (TLS) for requests ",
            "training": "https://learn.microsoft.com/learn/modules/secure-aad-users-with-mfa/",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.eventhub/namespaces",
            "checklist": "WAF checklist",
            "description": "When you create an Event Hubs namespace, a policy rule named RootManageSharedAccessKey is automatically created for the namespace. This policy has manage permissions for the entire namespace. It�s recommended that you treat this rule like an administrative root account and don�t use it in your application. Using AAD as an authentication provider with RBAC is recommended. ",
            "guid": "13b0f566-4b1e-4944-a459-837ee79d6c6d",
            "link": "https://learn.microsoft.com/azure/event-hubs/authorize-access-shared-access-signature#shared-access-authorization-policies",
            "service": "Event Hubs",
            "services": [
                "WAF",
                "AzurePolicy",
                "Entra",
                "RBAC",
                "EventHubs",
                "TrafficManager"
            ],
            "severity": "Medium",
            "text": "Avoid using root account when it is not necessary",
            "training": "https://learn.microsoft.com/learn/paths/azure-administrator-manage-identities-governance/",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.eventhub/namespaces",
            "checklist": "WAF checklist",
            "description": "Managed identities for Azure resources can authorize access to Event Hubs resources using Azure AD credentials from applications running in Azure Virtual Machines (VMs), Function apps, Virtual Machine Scale Sets, and other services. By using managed identities for Azure resources together with Azure AD authentication, you can avoid storing credentials with your applications that run in the cloud. ",
            "guid": "3a365a5c-7acb-4e48-abd5-4cd79f2e8776",
            "link": "https://learn.microsoft.com/azure/event-hubs/authenticate-managed-identity?tabs=latest",
            "service": "Event Hubs",
            "services": [
                "WAF",
                "AKV",
                "Entra",
                "EventHubs",
                "VM",
                "Storage"
            ],
            "severity": "Medium",
            "text": "When possible, your application should be using a managed identity to authenticate to Azure Event Hub. If not, consider having the storage credential (SAS, service principal credential) in Azure Key Vault or an equivalent service",
            "training": "https://learn.microsoft.com/learn/modules/azure-ad-privileged-identity-management/",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.eventhub/namespaces",
            "checklist": "WAF checklist",
            "description": "When creating permissions, provide fine-grained control over a client's access to Azure Event Hub. Permissions in Azure Event Hub can and should be scoped to the individual resource level e.g. consumer group, event hub entity, event hub namespaces, etc.",
            "guid": "8357c559-675c-45ee-a5b8-6ad8844ce3b2",
            "link": "https://learn.microsoft.com/azure/event-hubs/authorize-access-azure-active-directory#azure-built-in-roles-for-azure-event-hubs",
            "service": "Event Hubs",
            "services": [
                "WAF",
                "RBAC",
                "EventHubs"
            ],
            "severity": "High",
            "text": "Use least privilege data plane RBAC",
            "training": "https://learn.microsoft.com/learn/modules/explore-basic-services-identity-types/",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.eventhub/namespaces",
            "checklist": "WAF checklist",
            "description": "Azure Event Hub resource logs include operational logs, virtual network and Kafka logs. Runtime audit logs capture aggregated diagnostic information for all data plane access operations (such as send or receive events) in Event Hubs.",
            "guid": "b38b875b-a1cf-4104-a900-3a4d3ce474db",
            "link": "https://learn.microsoft.com/azure/event-hubs/monitor-event-hubs-reference",
            "service": "Event Hubs",
            "services": [
                "WAF",
                "VNet",
                "Monitor",
                "EventHubs"
            ],
            "severity": "Medium",
            "text": "Enable logging for security investigation. Use Azure Monitor to captured metrics and logs such as resource logs, runtime audit logs and Kafka logs",
            "training": "https://learn.microsoft.com/learn/paths/manage-identity-and-access/",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.eventhub/namespaces",
            "checklist": "WAF checklist",
            "description": "Azure Event Hub by default has a public IP address and is Internet-reachable. Private endpoints allow traffic between your virtual network and Azure Event Hub traverses over the Microsoft backbone network. In addition to that, you should disable public endpoints if those are not used. ",
            "guid": "5abca2a4-eda1-4dae-8cc9-5d48c6b791dc",
            "link": "https://learn.microsoft.com/azure/event-hubs/private-link-service",
            "service": "Event Hubs",
            "services": [
                "WAF",
                "VNet",
                "EventHubs",
                "PrivateLink"
            ],
            "severity": "Medium",
            "text": "Consider using private endpoints to access Azure Event Hub and disable public network access when applicable.",
            "training": "https://learn.microsoft.com/learn/modules/azure-ad-privileged-identity-management/",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.eventhub/namespaces",
            "checklist": "WAF checklist",
            "description": "With IP firewall, you can restrict public endpoint further to only a set of IPv4 addresses or IPv4 address ranges in CIDR (Classless Inter-Domain Routing) notation. ",
            "guid": "a0e6c465-89e5-458b-a37d-3974d1112dbd",
            "link": "https://learn.microsoft.com/azure/event-hubs/event-hubs-ip-filtering",
            "service": "Event Hubs",
            "services": [
                "WAF",
                "EventHubs"
            ],
            "severity": "Medium",
            "text": "Consider only allowing access to Azure Event Hub namespace from specific IP addresses or ranges",
            "training": "https://learn.microsoft.com/learn/paths/implement-resource-mgmt-security/",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.eventhub/namespaces",
            "checklist": "WAF checklist",
            "guid": "31d41e36-11c8-417b-8afb-c410d4391898",
            "link": "https://github.com/Azure/fta-resiliencyplaybooks/blob/main/paas-foundations-playbooks-AEH_v1.docx",
            "service": "Event Hubs",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Leverage FTA Resillency HandBook",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.eventhub/namespaces",
            "checklist": "WAF checklist",
            "description": " This will be turned on automatically for a new EH namespace created from the portal with Premium, Dedicated, or Standard SKUs in a zone-enabled region. Both the EH metadata and the event data itself are replicated across zones",
            "guid": "f15bce21-9e4a-40eb-9787-9424d226786d",
            "link": "https://learn.microsoft.com/azure/event-hubs/event-hubs-premium-overview#high-availability-with-availability-zones",
            "service": "Event Hubs",
            "services": [
                "WAF",
                "ACR",
                "EventHubs"
            ],
            "severity": "High",
            "text": "Leverage Availability Zones if regionally applicable",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.eventhub/namespaces",
            "checklist": "WAF checklist",
            "guid": "20b56c56-ad58-4519-8f82-735c586bb281",
            "link": "https://learn.microsoft.com/azure/event-hubs/compare-tiers",
            "service": "Event Hubs",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Use the Premium or Dedicated SKUs   for predicable performance",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.eventhub/namespaces",
            "checklist": "WAF checklist",
            "description": "The built-in geo-disaster recovery feature, when enabled, ensures that the entire configuration of anamespace (Event Hubs, Consumer Groups and settings) is continuously replicated from a primary namespace to a secondary namespace, and it allows a once-only failover move from the primary to the secondary at any time. Active/Passive feature is designed to make it easier to recover from and abandon a failed Azure region without having to change application configurations",
            "guid": "dc15a1c0-75ee-49f1-90ac-ccd579376bcd",
            "link": "https://learn.microsoft.com/azure/event-hubs/event-hubs-geo-dr?tabs=portal",
            "service": "Event Hubs",
            "services": [
                "WAF",
                "EventHubs",
                "ASR"
            ],
            "severity": "High",
            "text": "Plan for Geo Disaster Recovery using Active Passive configuration",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.eventhub/namespaces",
            "checklist": "WAF checklist",
            "description": "Should be used for DR configurations where an outage or loss of event data in the downed region cannot be tolerated. For these cases, follow the replication guidance and do not use the built-in geo-disaster recovery capability (active/passive). With Active/Active, Maintain multiple Event Hubs in different regions and namespaces, and events will be replicated between the hubs",
            "guid": "6e31b67d-67ba-4591-89c0-9e805d597c7e",
            "link": "https://learn.microsoft.com/azure/event-hubs/event-hubs-federation-overview",
            "service": "Event Hubs",
            "services": [
                "WAF",
                "EventHubs",
                "ASR"
            ],
            "severity": "Medium",
            "text": "For Business Critical Applications, use Active Active configuration",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.eventhub/namespaces",
            "checklist": "WAF checklist",
            "guid": "9ced16ad-d186-4f0a-a241-a999a68af77c",
            "link": "https://learn.microsoft.com/azure/architecture/serverless/event-hubs-functions/resilient-design",
            "service": "Event Hubs",
            "services": [
                "WAF",
                "EventHubs"
            ],
            "severity": "Medium",
            "text": "Design Resilient Event Hubs",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "ab5351f6-383a-45ed-9c5e-b143b16db40a",
            "link": "https://learn.microsoft.com/azure/aks/use-windows-hpc",
            "service": "AKS",
            "services": [
                "WAF",
                "AKS"
            ],
            "severity": "Low",
            "text": "If required for AKS Windows workloads HostProcess containers can be used",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "a280dcf5-90ce-465d-b8e1-3f9ccbd46926",
            "link": "https://learn.microsoft.com/azure/azure-functions/functions-kubernetes-keda",
            "service": "AKS",
            "services": [
                "WAF"
            ],
            "severity": "Low",
            "text": "Use KEDA if running event-driven workloads",
            "waf": "Performance"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "26886d20-b66c-457b-a591-19bf8e8f5c58",
            "link": "https://dapr.io/",
            "service": "AKS",
            "services": [
                "WAF"
            ],
            "severity": "Low",
            "text": "Use Dapr to ease microservice development",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (sku.tier=='Paid') | distinct id,compliant",
            "guid": "71d41e36-10cc-457b-9a4b-1410d4395898",
            "link": "https://learn.microsoft.com/azure/aks/uptime-sla",
            "service": "AKS",
            "services": [
                "WAF",
                "AKS"
            ],
            "severity": "High",
            "text": "Use the SLA-backed AKS offering",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "c1288b3c-6a57-4cfc-9444-51e1a3d3453a",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-scheduler",
            "service": "AKS",
            "services": [
                "WAF",
                "Cost"
            ],
            "severity": "Low",
            "text": "Use Disruption Budgets in your pod and deployment definitions",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerregistry/registries",
            "checklist": "WAF checklist",
            "guid": "3c763963-7a55-42d5-a15e-401955387e5c",
            "link": "https://learn.microsoft.com/azure/container-registry/container-registry-geo-replication",
            "service": "ACR",
            "services": [
                "WAF",
                "ACR"
            ],
            "severity": "High",
            "text": "If using a private registry, configure region replication to store images in multiple regions",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "f82cb8eb-8c0a-4a63-a25a-4956eaa8dc4a",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/aks/eslz-cost-governance-with-kubecost",
            "service": "AKS",
            "services": [
                "WAF",
                "Cost"
            ],
            "severity": "Low",
            "text": "Use an external application such as kubecost to allocate costs to different users",
            "waf": "Cost"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "4d3dfbab-9924-4831-a68d-fdf0d72f462c",
            "link": "https://learn.microsoft.com/azure/aks/scale-down-mode",
            "service": "AKS",
            "services": [
                "WAF"
            ],
            "severity": "Low",
            "text": "Use scale down mode to delete/deallocate nodes",
            "waf": "Cost"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "87e651ea-bc4a-4a87-a6df-c06a4b570ebc",
            "link": "https://learn.microsoft.com/azure/aks/gpu-multi-instance",
            "service": "AKS",
            "services": [
                "WAF",
                "AKS"
            ],
            "severity": "Medium",
            "text": "When required use multi-instance partitioning GPU on AKS Clusters",
            "waf": "Cost"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "2b72a08b-0410-4cd6-9093-e068a5cf27e8",
            "link": "https://learn.microsoft.com/azure/aks/start-stop-nodepools",
            "service": "AKS",
            "services": [
                "WAF"
            ],
            "severity": "Low",
            "text": "If running a Dev/Test cluster use NodePool Start/Stop",
            "waf": "Cost"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (isnotnull(properties.addonProfiles.azurepolicy) and properties.addonProfiles.azurepolicy.enabled==true) | distinct id,compliant",
            "guid": "9ca48e4a-85e2-4223-bce8-bb12307ca5f1",
            "link": "https://learn.microsoft.com/azure/governance/policy/concepts/policy-for-kubernetes",
            "service": "AKS",
            "services": [
                "WAF",
                "AzurePolicy",
                "AKS"
            ],
            "severity": "Medium",
            "text": "Use Azure Policy for Kubernetes to ensure cluster compliance",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "graph": "where type=='microsoft.containerservice/managedclusters' | project id,resourceGroup,name,pools=properties.agentPoolProfiles | project id,name,resourceGroup,poolcount=array_length(pools) | extend compliant = (poolcount > 1)",
            "guid": "6f158e3e-a3a9-42c2-be7e-2165c3a87af4",
            "link": "https://learn.microsoft.com/azure/aks/use-system-pools",
            "service": "AKS",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Separate applications from the control plane with user/system node pools",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "a7a1f893-9bda-4477-98f2-4c116775c2ea",
            "link": "https://learn.microsoft.com/azure/aks/use-system-pools",
            "service": "AKS",
            "services": [
                "WAF"
            ],
            "severity": "Low",
            "text": "Add taint to your system nodepool to make it dedicated",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "55b46a94-8008-4ae7-b7e4-b475b6c8bdbf",
            "link": "https://learn.microsoft.com/azure/container-registry/",
            "service": "AKS",
            "services": [
                "WAF",
                "ACR"
            ],
            "severity": "Medium",
            "text": "Use a private registry for your images, such as ACR",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.containerregistry/registries",
            "checklist": "WAF checklist",
            "guid": "59bce65d-e8a0-43f9-9879-468d66a786d6",
            "link": "https://learn.microsoft.com/azure/security-center/container-security",
            "service": "ACR",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Scan your images for vulnerabilities",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "d167dd18-2b0a-4c24-8b99-9a646f8389a7",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-cluster-isolation",
            "service": "AKS",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Define app separation requirements (namespace/nodepool/cluster)",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "5e3df584-eccc-4d97-a3b6-bcda3b50eb2e",
            "link": "https://github.com/Azure/secrets-store-csi-driver-provider-azure",
            "service": "AKS",
            "services": [
                "WAF",
                "AKV"
            ],
            "severity": "Medium",
            "text": "Store your secrets in Azure Key Vault with the CSI Secrets Store driver",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "b03dda6d-58d7-4c89-8ddb-107d5769ae66",
            "link": "https://learn.microsoft.com/azure/aks/update-credentials",
            "service": "AKS",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "If using Service Principals for the cluster, refresh credentials periodically (like quarterly)",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "e7ba73a3-0508-4f80-806f-527db30cee96",
            "link": "https://learn.microsoft.com/azure/aks/use-kms-etcd-encryption",
            "service": "AKS",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "If required add Key Management Service etcd encryption",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "ec8e4e42-0344-41b0-b865-9123e8956d31",
            "link": "https://learn.microsoft.com/azure/confidential-computing/confidential-nodes-aks-overview",
            "service": "AKS",
            "services": [
                "WAF",
                "AKS"
            ],
            "severity": "Low",
            "text": "If required consider using Confidential Compute for AKS",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "c9e95ffe-6dd1-4a17-8c5f-110389ca9b21",
            "link": "https://learn.microsoft.com/azure/defender-for-cloud/defender-for-containers-enable",
            "service": "AKS",
            "services": [
                "WAF",
                "Defender"
            ],
            "severity": "Medium",
            "text": "Consider using Defender for Containers",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (properties.servicePrincipalProfile.clientId=='msi') | distinct id,compliant",
            "guid": "ed127dd1-42b0-46b2-8c69-99a646f3389a",
            "link": "https://learn.microsoft.com/azure/aks/use-managed-identity",
            "service": "AKS",
            "services": [
                "WAF",
                "Entra"
            ],
            "severity": "High",
            "text": "Use managed identities instead of Service Principals",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = isnotnull(properties.aadProfile) | distinct id,compliant",
            "guid": "7e42c78e-78c0-46a6-8a21-94956e698dc4",
            "link": "https://learn.microsoft.com/azure/aks/managed-aad",
            "service": "AKS",
            "services": [
                "WAF",
                "Entra"
            ],
            "severity": "Medium",
            "text": "Integrate authentication with AAD (using the managed integration)",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "a2fe27b2-e287-401a-8352-beedf79b488d",
            "link": "https://learn.microsoft.com/azure/aks/control-kubeconfig-access",
            "service": "AKS",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Limit access to admin kubeconfig (get-credentials --admin)",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "eec4962c-c3bd-421b-b77f-26e5e6b3bec3",
            "link": "https://learn.microsoft.com/azure/aks/manage-azure-rbac",
            "service": "AKS",
            "services": [
                "WAF",
                "Entra",
                "RBAC"
            ],
            "severity": "Medium",
            "text": "Integrate authorization with AAD RBAC",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "d4f3537c-1346-4dc5-9027-a71ffe1bd05d",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-identity",
            "service": "AKS",
            "services": [
                "WAF",
                "RBAC",
                "AKS"
            ],
            "severity": "High",
            "text": "Use namespaces for restricting RBAC privilege in Kubernetes",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "d2e0d5d7-71d4-41e3-910c-c57b4a4b1410",
            "link": "https://learn.microsoft.com/azure/aks/workload-identity-migration-sidecar",
            "service": "AKS",
            "services": [
                "WAF",
                "Entra"
            ],
            "severity": "Medium",
            "text": "For Pod Identity Access Management use Azure AD Workload Identity (preview)",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "f4dcf690-1b30-407d-abab-6f8aa780d3a3",
            "link": "https://learn.microsoft.com/azure/aks/managed-aad#non-interactive-sign-in-with-kubelogin",
            "service": "AKS",
            "services": [
                "WAF",
                "AKS"
            ],
            "severity": "Medium",
            "text": "For AKS non-interactive logins use kubelogin (preview)",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (properties.disableLocalAccounts==true) | distinct id,compliant",
            "guid": "b085b1f2-3119-4771-8c9a-bbf4411810ec",
            "link": "https://learn.microsoft.com/azure/aks/managed-aad#disable-local-accounts",
            "service": "AKS",
            "services": [
                "WAF",
                "AKS"
            ],
            "severity": "Medium",
            "text": "Disable AKS local accounts",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "36abb0db-c118-4f4c-9880-3f30f9a2deb6",
            "link": "https://learn.microsoft.com/azure/aks/managed-aad#configure-just-in-time-cluster-access-with-azure-ad-and-aks",
            "service": "AKS",
            "services": [
                "WAF"
            ],
            "severity": "Low",
            "text": "Configure if required Just-in-time cluster access",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "c4d7f4c6-79bf-45d0-aa05-ce8fc717e150",
            "link": "https://learn.microsoft.com/azure/aks/managed-aad#use-conditional-access-with-azure-ad-and-aks",
            "service": "AKS",
            "services": [
                "WAF",
                "Entra",
                "AKS"
            ],
            "severity": "Low",
            "text": "Configure if required AAD conditional access for AKS",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "e1123a7c-a333-4eb4-a120-4ee3f293c9f3",
            "link": "https://learn.microsoft.com/azure/aks/use-group-managed-service-accounts",
            "service": "AKS",
            "services": [
                "WAF",
                "AKS"
            ],
            "severity": "Low",
            "text": "If required for Windows AKS workloads configure gMSA ",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "1f711a74-3672-470b-b8b8-a2148d640d79",
            "link": "https://learn.microsoft.com/azure/aks/use-managed-identity#use-a-pre-created-kubelet-managed-identity",
            "service": "AKS",
            "services": [
                "WAF",
                "Entra"
            ],
            "severity": "Medium",
            "text": "For finer control consider using a managed Kubelet Identity",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "cbd8ac2a-aebc-4a2a-94da-1dbf3dc99248",
            "link": "https://azure.github.io/application-gateway-kubernetes-ingress/setup/install-existing/",
            "service": "AKS",
            "services": [
                "WAF",
                "ACR",
                "AppGW"
            ],
            "severity": "Medium",
            "text": "If using AGIC, do not share an AppGW across clusters",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (isnull(properties.addonProfiles.httpApplicationRouting) or properties.addonProfiles.httpApplicationRouting.enabled==false) | distinct id,compliant",
            "guid": "8008ae7d-7e4b-4475-a6c8-bdbf59bce65d",
            "link": "https://learn.microsoft.com/azure/aks/http-application-routing",
            "service": "AKS",
            "services": [
                "WAF",
                "AKS"
            ],
            "severity": "High",
            "text": "Do not use AKS HTTP Routing Add-On, use instead the managed NGINX ingress with the application routing add-on.",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "7bacd7b9-c025-4a9d-a5d2-25d6bc5439d9",
            "link": "https://learn.microsoft.com/azure/virtual-network/accelerated-networking-overview",
            "service": "AKS",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "For Windows workloads use Accelerated Networking",
            "waf": "Performance"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (tolower(properties.networkProfile.loadBalancerSku)=='standard') | distinct id,compliant",
            "guid": "ba7da7be-9952-4914-a384-5d997cb39132",
            "link": "https://learn.microsoft.com/azure/aks/load-balancer-standard",
            "service": "AKS",
            "services": [
                "WAF",
                "LoadBalancer"
            ],
            "severity": "High",
            "text": "Use the standard ALB (as opposed to the basic one)",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "22fbe8d6-9b40-47ef-9011-25bb1a555a6b",
            "link": "https://learn.microsoft.com/azure/aks/use-multiple-node-pools#add-a-node-pool-with-a-unique-subnet",
            "service": "AKS",
            "services": [
                "WAF",
                "VNet"
            ],
            "severity": "Medium",
            "text": "If using Azure CNI, consider using different Subnets for NodePools",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "c3c39c98-6bb2-4c12-859a-114b5e3df584",
            "link": "https://learn.microsoft.com/azure/private-link/private-link-overview",
            "service": "AKS",
            "services": [
                "WAF",
                "VNet",
                "PrivateLink"
            ],
            "severity": "Medium",
            "text": "Use Private Endpoints (preferred) or Virtual Network Service Endpoints to access PaaS services from the cluster",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (properties.networkProfile.networkPlugin=='azure') | distinct id,compliant",
            "guid": "a0f61565-9de5-458f-a372-49c831112dbd",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-network",
            "service": "AKS",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Choose the best CNI network plugin for your requirements (Azure CNI recommended)",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "7faf12e7-0943-4f63-8472-2da29c2b1cd6",
            "link": "https://learn.microsoft.com/azure/aks/configure-azure-cni",
            "service": "AKS",
            "services": [
                "WAF",
                "VNet"
            ],
            "severity": "High",
            "text": "If using Azure CNI, size your subnet accordingly considering the maximum number of pods per node",
            "waf": "Performance"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "22f54b29-bade-43aa-b1e8-c38ec9366673",
            "link": "https://learn.microsoft.com/azure/aks/configure-azure-cni",
            "service": "AKS",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "If using Azure CNI, check the maximum pods/node (default 30)",
            "waf": "Performance"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "description": "For internal apps organizations often open the whole AKS subnet in their firewalls. This opens network access to the nodes too, and potentially to the pods as well (if using Azure CNI). If LoadBalancer IPs are in a different subnet, only this one needs to be available to the app clients. Another reason is that if the IP addresses in the AKS subnet are a scarce resource, consuming its IP addresses for services will reduce the maximum scalability of the cluster .",
            "guid": "13c00567-4b1e-4945-a459-c373e7ed6162",
            "link": "https://learn.microsoft.com/azure/aks/internal-lb",
            "service": "AKS",
            "services": [
                "WAF",
                "VNet",
                "AKS"
            ],
            "severity": "Low",
            "text": "If using private-IP LoadBalancer services, use a dedicated subnet (not the AKS subnet)",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "43f63047-22d9-429c-8b1c-d622f54b29ba",
            "link": "https://learn.microsoft.com/azure/aks/configure-azure-cni",
            "service": "AKS",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Size the service IP address range accordingly (it is going to limit the cluster scalability)",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "57bf217f-6dc8-481c-81e2-785773e9c00f",
            "link": "https://learn.microsoft.com/azure/aks/use-byo-cni",
            "service": "AKS",
            "services": [
                "WAF"
            ],
            "severity": "Low",
            "text": "If required add your own CNI plugin",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "4b3bb365-9458-44d9-9ed1-5c8f52890364",
            "link": "https://learn.microsoft.com/azure/aks/use-multiple-node-pools#assign-a-public-ip-per-node-for-your-node-pools",
            "service": "AKS",
            "services": [
                "WAF",
                "AKS"
            ],
            "severity": "Low",
            "text": "If required configure Public IP per node in AKS",
            "waf": "Performance"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "b3808b9f-a1cf-4204-ad01-3a923ce474db",
            "link": "https://learn.microsoft.com/azure/aks/concepts-network",
            "service": "AKS",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Use an ingress controller to expose web-based apps instead of exposing them with LoadBalancer-type services",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "ccb534e7-416e-4a1d-8e93-533b53199085",
            "link": "https://learn.microsoft.com/azure/aks/nat-gateway",
            "service": "AKS",
            "services": [
                "WAF"
            ],
            "severity": "Low",
            "text": "Use Azure NAT Gateway as outboundType for scaling egress traffic",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "8ee9a69a-1b58-4b1e-9c61-476e110a160b",
            "link": "https://learn.microsoft.com/azure/aks/configure-azure-cni#dynamic-allocation-of-ips-and-enhanced-subnet-support",
            "service": "AKS",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Use Dynamic allocations of IPs in order to avoid Azure CNI IP exhaustion",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (properties.networkProfile.outboundType=='userDefinedRouting') | distinct id,compliant",
            "guid": "3b365a91-7ecb-4e48-bbe5-4cd7df2e8bba",
            "link": "https://learn.microsoft.com/azure/aks/limit-egress-traffic",
            "service": "AKS",
            "services": [
                "WAF",
                "NVA"
            ],
            "severity": "High",
            "text": "Filter egress traffic with AzFW/NVA if your security requirements mandate it",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = ((isnull(properties.apiServerAccessProfile.enablePrivateCluster) or properties.apiServerAccessProfile.enablePrivateCluster==false) and isnotnull(properties.apiServerAccessProfile.authorizedIPRanges)) | distinct id,compliant",
            "guid": "c4581559-bb91-463e-a908-aed8c44ce3b2",
            "link": "https://learn.microsoft.com/azure/aks/api-server-authorized-ip-ranges",
            "service": "AKS",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "If using a public API endpoint, restrict the IP addresses that can access it",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "graph": "where type=='microsoft.containerservice/managedclusters' | where isnotnull(properties.apiServerAccessProfile.enablePrivateCluster) | extend compliant = (properties.apiServerAccessProfile.enablePrivateCluster==true) | distinct id, compliant",
            "guid": "ecccd979-3b6b-4cda-9b50-eb2eb03dda6d",
            "link": "https://learn.microsoft.com/azure/aks/private-clusters",
            "service": "AKS",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Use private clusters if your requirements mandate it",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "graph": "where type=='microsoft.containerservice/managedclusters' | where isnotnull(properties.apiServerAccessProfile.enablePrivateCluster) | extend compliant = (properties.apiServerAccessProfile.enablePrivateCluster==true) | distinct id, compliant",
            "guid": "ce7f2a7c-297c-47c6-adea-a6ff838db665",
            "link": "https://learn.microsoft.com/azure/aks/use-network-policies",
            "service": "AKS",
            "services": [
                "WAF",
                "AzurePolicy",
                "AKS"
            ],
            "severity": "Medium",
            "text": "For Windows 2019 and 2022 AKS nodes Calico Network Policies can be used ",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = isnotnull(properties.networkProfile.networkPolicy) | distinct id,compliant",
            "guid": "58d7c892-ddb1-407d-9769-ae669ca48e4a",
            "link": "https://learn.microsoft.com/azure/aks/use-network-policies",
            "service": "AKS",
            "services": [
                "WAF",
                "AzurePolicy",
                "AKS"
            ],
            "severity": "High",
            "text": "Enable a Kubernetes Network Policy option (Calico/Azure)",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "85e2223e-ce8b-4b12-907c-a5f16f158e3e",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-network",
            "service": "AKS",
            "services": [
                "WAF",
                "AzurePolicy",
                "AKS"
            ],
            "severity": "High",
            "text": "Use Kubernetes network policies to increase intra-cluster security",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "a3a92c2d-e7e2-4165-a3a8-7af4a7a1f893",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-network",
            "service": "AKS",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Use a WAF for web workloads (UIs or APIs)",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "graph": "Resources | where type=~'microsoft.containerservice/managedclusters' | project resourceGroup,name,pools=properties.agentPoolProfiles | mv-expand pools | project subnetId=tostring(pools.vnetSubnetID) | where isnotempty(subnetId) | join (Resources | where type=='microsoft.network/virtualnetworks' | project id,resourceGroup,name,enableDdosProtection=tostring(properties.enableDdosProtection),subnets=properties.subnets | mv-expand subnets | project id,resourceGroup,name,enableDdosProtection,subnetId=tostring(subnets.id)) on subnetId | distinct id,resourceGroup,name,enableDdosProtection | extend compliant = (enableDdosProtection == 'true')",
            "guid": "9bda4776-8f24-4c11-9775-c2ea55b46a94",
            "link": "https://learn.microsoft.com/azure/virtual-network/ddos-protection-overview",
            "service": "AKS",
            "services": [
                "WAF",
                "VNet",
                "AKS",
                "DDoS"
            ],
            "severity": "Medium",
            "text": "Use DDoS Standard in the AKS Virtual Network",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "graph": "Resources | where type=~'microsoft.containerservice/managedclusters' | project resourceGroup,name,pools=properties.agentPoolProfiles | mv-expand pools | project subnetId=tostring(pools.vnetSubnetID) | where isnotempty(subnetId) | join (Resources | where type=='microsoft.network/virtualnetworks' | project id,resourceGroup,name,enableDdosProtection=tostring(properties.enableDdosProtection),subnets=properties.subnets | mv-expand subnets | project id,resourceGroup,name,enableDdosProtection,subnetId=tostring(subnets.id)) on subnetId | distinct id,resourceGroup,name,enableDdosProtection | extend compliant = (enableDdosProtection == 'true')",
            "guid": "6c46b91a-1107-4485-ad66-3183e2a8c266",
            "link": "https://learn.microsoft.com/azure/aks/http-proxy",
            "service": "AKS",
            "services": [
                "WAF"
            ],
            "severity": "Low",
            "text": "If required add company HTTP Proxy",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "e9855d04-c3c3-49c9-a6bb-2c12159a114b",
            "link": "https://learn.microsoft.com/azure/aks/servicemesh-about",
            "service": "AKS",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Consider using a service mesh for advanced microservice communication management",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "67f7a9ed-5b31-4f38-a3f3-9812b2463cff",
            "link": "https://learn.microsoft.com/azure/azure-monitor/insights/container-insights-metric-alerts",
            "service": "AKS",
            "services": [
                "WAF",
                "Monitor"
            ],
            "severity": "High",
            "text": "Configure alerts on the most critical metrics (see Container Insights for recommendations)",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "337453a3-cc63-4963-9a65-22ac19e80696",
            "link": "https://learn.microsoft.com/azure/advisor/advisor-get-started",
            "service": "AKS",
            "services": [
                "WAF",
                "Entra"
            ],
            "severity": "Low",
            "text": "Check regularly Azure Advisor for recommendations on your cluster",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "3aa70560-e7e7-4968-be3d-628af35b2ced",
            "link": "https://learn.microsoft.com/azure/aks/certificate-rotation",
            "service": "AKS",
            "services": [
                "WAF",
                "AKS"
            ],
            "severity": "Low",
            "text": "Enable AKS auto-certificate rotation",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "e189c599-df0d-45a7-9dd4-ce32c1881370",
            "link": "https://learn.microsoft.com/azure/aks/supported-kubernetes-versions",
            "service": "AKS",
            "services": [
                "WAF",
                "AKS"
            ],
            "severity": "High",
            "text": "Have a regular process to upgrade your kubernetes version periodically (quarterly, for example), or use the AKS autoupgrade feature",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "6f7c4c0d-4e51-4464-ad24-57ed67138b82",
            "link": "https://learn.microsoft.com/azure/aks/node-updates-kured",
            "service": "AKS",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Use kured for Linux node upgrades in case you are not using node-image upgrade",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "139c9580-ade3-426a-ba09-cf157d9f6477",
            "link": "https://learn.microsoft.com/azure/aks/node-image-upgrade",
            "service": "AKS",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Have a regular process to upgrade the cluster node images periodically (weekly, for example)",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "0102ce16-ee30-41e6-b882-e52e4621dd68",
            "link": "https://learn.microsoft.com/azure/architecture/example-scenario/bedrock/bedrock-automated-deployments",
            "service": "AKS",
            "services": [
                "WAF"
            ],
            "severity": "Low",
            "text": "Consider gitops to deploy applications or cluster configuration to multiple clusters",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "d7672c26-7602-4482-85a4-14527fbe855c",
            "link": "https://learn.microsoft.com/azure/aks/command-invoke",
            "service": "AKS",
            "services": [
                "WAF",
                "AKS"
            ],
            "severity": "Low",
            "text": "Consider using AKS command invoke on private clusters",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "31d7aaab-7571-4449-ab80-53d89e89d17b",
            "link": "https://learn.microsoft.com/azure/aks/node-auto-repair#node-autodrain",
            "service": "AKS",
            "services": [
                "WAF"
            ],
            "severity": "Low",
            "text": "For planned events consider using Node Auto Drain",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "ed0fda7f-211b-47c7-8b6e-c18873fb473c",
            "link": "https://learn.microsoft.com/azure/aks/faq",
            "service": "AKS",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Develop own governance practices to make sure no changes are performed by operators in the node RG (aka 'infra RG')",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (properties.nodeResourceGroup !startswith 'MC_') | distinct id,compliant",
            "guid": "73b32a5a-67f7-4a9e-b5b3-1f38c3f39812",
            "link": "https://learn.microsoft.com/azure/aks/cluster-configuration",
            "service": "AKS",
            "services": [
                "WAF"
            ],
            "severity": "Low",
            "text": "Use custom Node RG (aka 'Infra RG') name",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "b2463cff-e189-4c59-adf0-d5a73dd4ce32",
            "link": "https://kubernetes.io/docs/setup/release/notes/",
            "service": "AKS",
            "services": [
                "WAF",
                "AKS"
            ],
            "severity": "Medium",
            "text": "Do not use deprecated Kubernetes APIs in your YAML manifests",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "c1881370-6f7c-44c0-b4e5-14648d2457ed",
            "link": "https://learn.microsoft.com/azure-stack/aks-hci/adapt-apps-mixed-os-clusters",
            "service": "AKS",
            "services": [
                "WAF"
            ],
            "severity": "Low",
            "text": "Taint Windows nodes",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "67138b82-0102-4ce1-9ee3-01e6e882e52e",
            "link": "https://learn.microsoft.com/virtualization/windowscontainers/deploy-containers/version-compatibility?tabs=windows-server-20H2%2Cwindows-10-20H2",
            "service": "AKS",
            "services": [
                "WAF"
            ],
            "severity": "Low",
            "text": "Keep windows containers patch level in sync with host patch level",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "description": "Via Diagnostic Settings at the cluster level",
            "guid": "5b56ad48-408f-4e72-934c-476ba280dcf5",
            "link": "https://learn.microsoft.com/azure/aks/monitor-aks",
            "service": "AKS",
            "services": [
                "WAF",
                "Monitor"
            ],
            "severity": "Low",
            "text": "Send master logs (aka API logs) to Azure Monitor or your preferred log management solution",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "64d1a846-e28a-4b6b-9a33-22a635c15a21",
            "link": "https://learn.microsoft.com/azure/aks/node-pool-snapshot",
            "service": "AKS",
            "services": [
                "WAF"
            ],
            "severity": "Low",
            "text": "If required use nodePool snapshots",
            "waf": "Cost"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "c5a5b252-1e44-4a59-a9d2-399c4d7b68d0",
            "link": "https://learn.microsoft.com/azure/aks/spot-node-pool",
            "service": "AKS",
            "services": [
                "WAF"
            ],
            "severity": "Low",
            "text": "Consider spot node pools for non time-sensitive workloads",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (isnotnull(properties.addonProfiles.aciConnectorLinux) and properties.addonProfiles.aciConnectorLinux.enabled==true) | distinct id,compliant",
            "guid": "c755562f-2b4e-4456-9b4d-874a748b662e",
            "link": "https://learn.microsoft.com/azure/aks/concepts-scale",
            "service": "AKS",
            "services": [
                "WAF",
                "AKS"
            ],
            "severity": "Low",
            "text": "Consider AKS virtual node for quick bursting",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "6f8389a7-f82c-4b8e-a8c0-aa63a25a4956",
            "link": "https://learn.microsoft.com/azure/azure-monitor/insights/container-insights-overview",
            "service": "AKS",
            "services": [
                "WAF",
                "Monitor"
            ],
            "severity": "High",
            "text": "Monitor your cluster metrics with Container Insights (or other tools like Prometheus)",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (isnotnull(properties.addonProfiles.omsagent) and properties.addonProfiles.omsagent.enabled==true) | distinct id,compliant",
            "guid": "eaa8dc4a-2436-47b3-9697-15b1752beee0",
            "link": "https://learn.microsoft.com/azure/azure-monitor/insights/container-insights-overview",
            "service": "AKS",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Store and analyze your cluster logs with Container Insights (or other tools like Telegraf/ElasticSearch)",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "4621dd68-c5a5-4be2-bdb1-1726769ef669",
            "link": "https://learn.microsoft.com/azure/azure-monitor/containers/container-insights-analyze",
            "service": "AKS",
            "services": [
                "WAF",
                "Monitor"
            ],
            "severity": "Medium",
            "text": "Monitor CPU and memory utilization of the nodes",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "1a4835ac-9422-423e-ae80-b123081a5417",
            "link": "https://learn.microsoft.com/azure/aks/configure-azure-cni",
            "service": "AKS",
            "services": [
                "WAF",
                "Monitor"
            ],
            "severity": "Medium",
            "text": "If using Azure CNI, monitor % of pod IPs consumed per node",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "description": "I/O in the OS disk is a critical resource. If the OS in the nodes gets throttled on I/O, this could lead to unpredictable behavior, typically ending up in node being declared NotReady",
            "guid": "415833ea-3ad3-4c2d-b733-165c3acbe04b",
            "link": "https://learn.microsoft.com/azure/virtual-machines/premium-storage-performance",
            "service": "AKS",
            "services": [
                "WAF",
                "ServiceBus",
                "EventHubs",
                "Monitor",
                "Storage"
            ],
            "severity": "Medium",
            "text": "Monitor OS disk queue depth in nodes",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "be209d39-fda4-4777-a424-d116785c2fa5",
            "link": "https://learn.microsoft.com/azure/aks/load-balancer-standard",
            "service": "AKS",
            "services": [
                "WAF",
                "NVA",
                "Monitor",
                "LoadBalancer"
            ],
            "severity": "Medium",
            "text": "If not using egress filtering with AzFW/NVA, monitor standard ALB allocated SNAT ports",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "74c2ee76-569b-4a79-a57e-dedf91b022c9",
            "link": "https://learn.microsoft.com/azure/aks/aks-resource-health",
            "service": "AKS",
            "services": [
                "WAF",
                "AKS"
            ],
            "severity": "Medium",
            "text": "Subscribe to resource health notifications for your AKS cluster",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "b54eb2eb-03dd-4aa3-9927-18e2edb11726",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-scheduler",
            "service": "AKS",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Configure requests and limits in your pod specs",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "769ef669-1a48-435a-a942-223ece80b123",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-scheduler",
            "service": "AKS",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Enforce resource quotas for namespaces",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "081a5417-4158-433e-a3ad-3c2de733165c",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits",
            "service": "AKS",
            "services": [
                "WAF",
                "Subscriptions"
            ],
            "severity": "High",
            "text": "Ensure your subscription has enough quota to scale out your nodepools",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "f4fd0602-7ab5-46f1-b66a-e9dea9654a65",
            "link": "https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/",
            "service": "AKS",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Configure Liveness and Readiness probes for all deployments",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (isnotnull(properties.autoScalerProfile)) | distinct id,compliant",
            "guid": "90ce65de-8e13-4f9c-abd4-69266abca264",
            "link": "https://learn.microsoft.com/azure/aks/concepts-scale",
            "service": "AKS",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Use the Cluster Autoscaler",
            "waf": "Performance"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (isnotnull(properties.austoscalerProfile)) | distinct id,compliant",
            "guid": "831c2872-c693-4b39-a887-a561bada49bc",
            "link": "https://learn.microsoft.com/azure/aks/custom-node-configuration",
            "service": "AKS",
            "services": [
                "WAF",
                "AKS"
            ],
            "severity": "Low",
            "text": "Customize node configuration for AKS node pools",
            "waf": "Performance"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "faa19bfe-9d55-4d04-a3c4-919ca1b2d121",
            "link": "https://learn.microsoft.com/azure/aks/concepts-scale",
            "service": "AKS",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Use the Horizontal Pod Autoscaler when required",
            "waf": "Performance"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "description": "Larger nodes will bring higher performance and features such as ephemeral disks and accelerated networking, but they will increase the blast radius and decrease the scaling granularity",
            "guid": "5ae124ba-34df-4585-bcdc-e9bd3bb0cdb3",
            "link": "https://blog.cloudtrooper.net/2020/10/23/which-vm-size-should-i-choose-as-aks-node/",
            "service": "AKS",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Consider an appropriate node size, not too large or too small",
            "waf": "Performance"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "38800e6a-ae01-40a2-9fbc-ae5a06e5462d",
            "link": "https://learn.microsoft.com/azure/aks/quotas-skus-regions#service-quotas-and-limits",
            "service": "AKS",
            "services": [
                "WAF",
                "AKS"
            ],
            "severity": "Low",
            "text": "If more than 5000 nodes are required for scalability then consider using an additional AKS cluster",
            "waf": "Performance"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "9583c0f6-6083-43f6-aa6b-df7102c901bb",
            "link": "https://learn.microsoft.com/azure/event-grid/event-schema-aks",
            "service": "AKS",
            "services": [
                "WAF",
                "AKS"
            ],
            "severity": "Low",
            "text": "Consider subscribing to EventGrid Events for AKS automation",
            "waf": "Performance"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "c5016d8c-c6c9-4165-89ae-673ef0fff19d",
            "link": "https://learn.microsoft.com/azure/aks/manage-abort-operations",
            "service": "AKS",
            "services": [
                "WAF",
                "AKS"
            ],
            "severity": "Low",
            "text": "For long running operation on an AKS cluster consider event termination",
            "waf": "Performance"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "c4e37133-f186-4ce1-aed9-9f1b32f6e021",
            "link": "https://learn.microsoft.com/azure/aks/use-azure-dedicated-hosts",
            "service": "AKS",
            "services": [
                "WAF",
                "AKS"
            ],
            "severity": "Low",
            "text": "If required consider using Azure Dedicated Hosts for AKS nodes",
            "waf": "Performance"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "graph": "where type=='microsoft.containerservice/managedclusters' | project id,resourceGroup,name,pools=properties.agentPoolProfiles | mvexpand pools | extend compliant = (pools.osDiskType=='Ephemeral') | project id,name=strcat(name,'-',pools.name), resourceGroup, compliant",
            "guid": "24367b33-6971-45b1-952b-eee0b9b588de",
            "link": "https://learn.microsoft.com/azure/aks/cluster-configuration",
            "service": "AKS",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Use ephemeral OS disks",
            "waf": "Performance"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "f0ce315f-1120-4166-8206-94f2cf3a4d07",
            "link": "https://learn.microsoft.com/azure/virtual-machines/disks-types",
            "service": "AKS",
            "services": [
                "WAF",
                "AKS"
            ],
            "severity": "High",
            "text": "For non-ephemeral disks, use high IOPS and larger OS disks for the nodes when running many pods/node since it requires high performance for running multiple pods and will generate huge logs with default AKS log rotation thresholds",
            "waf": "Performance"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "39c486ce-d5af-4062-89d5-18bb5fd795db",
            "link": "https://learn.microsoft.com/azure/aks/use-ultra-disks",
            "service": "AKS",
            "services": [
                "WAF",
                "AKS",
                "Storage"
            ],
            "severity": "Low",
            "text": "For hyper performance storage option use Ultra Disks on AKS",
            "waf": "Performance"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "9f7547c1-747d-4c56-868a-714435bd19dd",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-multi-region",
            "service": "AKS",
            "services": [
                "WAF",
                "Storage",
                "SQL"
            ],
            "severity": "Medium",
            "text": "Avoid keeping state in the cluster, and store data outside (AzStorage, AzSQL, Cosmos, etc)",
            "waf": "Performance"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "24429eb7-2281-4376-85cc-57b4a4b18142",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-storage",
            "service": "AKS",
            "services": [
                "WAF",
                "Storage"
            ],
            "severity": "Medium",
            "text": "If using AzFiles Standard, consider AzFiles Premium and/or ANF for performance reasons",
            "waf": "Performance"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "83958a8c-2689-4b32-ab57-cfc64546135a",
            "link": "https://learn.microsoft.com/azure/aks/availability-zones#azure-disk-availability-zone-support",
            "service": "AKS",
            "services": [
                "WAF",
                "Storage"
            ],
            "severity": "Medium",
            "text": "If using Azure Disks and AZs, consider having nodepools within a zone for LRS disk with VolumeBindingMode:WaitForFirstConsumer for provisioning storage in right zone or use ZRS disk for nodepools spanning multiple zones",
            "waf": "Performance"
        },
        {
            "arm-service": "Microsoft.Purview/accounts",
            "checklist": "WAF checklist",
            "guid": "1fc2fc14-eea6-4e69-b8d9-a3edc218e687",
            "link": "https://polite-sea-0995b240f.2.azurestaticapps.net/technical-delivery-playbook/azure-services/analytics/purview/",
            "service": "Purview",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Leverage FTA Resillency Handbook",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Purview/accounts",
            "checklist": "WAF checklist",
            "guid": "ab067acb-49e5-4b96-8332-4ecf8cc13318",
            "link": "https://learn.microsoft.com/purview/disaster-recovery",
            "service": "Purview",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Plan for Data Center level outage",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Purview/accounts",
            "checklist": "WAF checklist",
            "description": "1. Create the new account 2. Migrate configuration items 3. Run scans 4. Migrate custom typedefs and custom assets 5. Migrate relationships 6. Migrate glossary terms 7. Assign classifications to assets 8. Assign contacts to assets",
            "guid": "da611702-69f4-4fb4-aa3d-3ef7f3176c4b",
            "link": "https://learn.microsoft.com/purview/disaster-recovery",
            "service": "Purview",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Practice Failover for BCDR",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Purview/accounts",
            "checklist": "WAF checklist",
            "guid": "97b15b8a-219a-44ab-bb57-879024d22678",
            "link": "https://learn.microsoft.com/purview/disaster-recovery",
            "service": "Purview",
            "services": [
                "WAF",
                "Backup"
            ],
            "severity": "High",
            "text": "Plan a backup strategy and take regular backups",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Purview/accounts",
            "checklist": "WAF checklist",
            "guid": "6d20b56c-56a9-4581-89bf-8d8e5c586b7d",
            "link": "https://learn.microsoft.com/purview/manage-kafka-dotnet",
            "service": "Purview",
            "services": [
                "WAF",
                "EventHubs"
            ],
            "severity": "Low",
            "text": "Use Microsoft Purview's Event Hubs to subscribe and create entities to another account",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Purview/accounts",
            "checklist": "WAF checklist",
            "guid": "8cdc15ac-c075-4ee9-a130-a8889579e76b",
            "link": "https://learn.microsoft.com/purview/deployment-best-practices",
            "service": "Purview",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Follow Purview accounts architectures and deployment best practices",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Purview/accounts",
            "checklist": "WAF checklist",
            "guid": "896e710a-7da7-4be9-a56d-14d3c49d997c",
            "link": "https://learn.microsoft.com/purview/concept-best-practices-collections",
            "service": "Purview",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Follow Collection Architectures and best practices",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Purview/accounts",
            "checklist": "WAF checklist",
            "guid": "b3d1325a-a225-4c6f-9e06-85edddea8a4b",
            "link": "https://learn.microsoft.com/purview/concept-best-practices-asset-lifecycle",
            "service": "Purview",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Follow Assest lifecycle best practices",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Purview/accounts",
            "checklist": "WAF checklist",
            "guid": "7cdeb3c6-1fc2-4fc1-9eea-6e69d8d9a3ed",
            "link": "https://learn.microsoft.com/purview/concept-best-practices-automation",
            "service": "Purview",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Follow automation best practices",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Purview/accounts",
            "checklist": "WAF checklist",
            "guid": "c218e687-ab06-47ac-a49e-5b9603324ecf",
            "link": "https://learn.microsoft.com/purview/disaster-recovery",
            "service": "Purview",
            "services": [
                "WAF",
                "Backup"
            ],
            "severity": "Medium",
            "text": "Follow Backup and Migration Best practices",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Purview/accounts",
            "checklist": "WAF checklist",
            "guid": "8cc13318-da61-4170-869f-4fb4aa3d3ef7",
            "link": "https://learn.microsoft.com/purview/concept-best-practices-glossary",
            "service": "Purview",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Follow Purview Glossary Best Practices",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Purview/accounts",
            "checklist": "WAF checklist",
            "guid": "f3176c4b-97b1-45b8-a219-a4abeb578790",
            "link": "https://learn.microsoft.com/purview/concept-workflow",
            "service": "Purview",
            "services": [
                "WAF"
            ],
            "severity": "Low",
            "text": "Leverage Workflows ",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Purview/accounts",
            "checklist": "WAF checklist",
            "guid": "24d22678-6d20-4b56-a56a-958119bf8d8e",
            "link": "https://learn.microsoft.com/purview/concept-best-practices-security",
            "service": "Purview",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Follow Purview Security Best Practices",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Purview/accounts",
            "checklist": "WAF checklist",
            "guid": "5c586b7d-8cdc-415a-ac07-5ee9b130a888",
            "link": "https://learn.microsoft.com/purview/concept-best-practices-lineage-azure-data-factory",
            "service": "Purview",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Follow Purview Data Lineage Best Practices",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Purview/accounts",
            "checklist": "WAF checklist",
            "guid": "9579e76b-896e-4710-a7da-7be9956d14d3",
            "link": "https://learn.microsoft.com/purview/concept-best-practices-scanning",
            "service": "Purview",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Follow Best Practices for Scanning Registered Sources",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Purview/accounts",
            "checklist": "WAF checklist",
            "guid": "c49d997c-b3d1-4325-aa22-5c6f4e0685ed",
            "link": "https://learn.microsoft.com/purview/concept-best-practices-classification",
            "service": "Purview",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Follow Classification Best Practices in Governance Portal",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Purview/accounts",
            "checklist": "WAF checklist",
            "guid": "ddea8a4b-7cde-4b3c-91fc-2fc14eea6e69",
            "link": "https://learn.microsoft.com/purview/sensitivity-labels-frequently-asked-questions",
            "service": "Purview",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Perform Sensitivity Labelling in the Purview Data Map",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Purview/accounts",
            "checklist": "WAF checklist",
            "guid": "d8d9a3ed-c218-4e68-9ab0-67acb49e5b96",
            "link": "https://learn.microsoft.com/purview/concept-data-share",
            "service": "Purview",
            "services": [
                "WAF",
                "Storage"
            ],
            "severity": "Low",
            "text": "Leverage Azure Storage in-place data sharing with Microsoft Purview",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Purview/accounts",
            "checklist": "WAF checklist",
            "guid": "03324ecf-8cc1-4331-ada6-1170269f4fb4",
            "link": "https://learn.microsoft.com/purview/concept-insights",
            "service": "Purview",
            "services": [
                "WAF"
            ],
            "severity": "Low",
            "text": "Leverage Data Estate Insights",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Purview/accounts",
            "checklist": "WAF checklist",
            "guid": "aa3d3ef7-f317-46c4-a97b-15b8a219a4ab",
            "link": "https://learn.microsoft.com/purview/catalog-adoption-insights",
            "service": "Purview",
            "services": [
                "WAF"
            ],
            "severity": "Low",
            "text": "Use Data stewardship and Catalog adoption",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Purview/accounts",
            "checklist": "WAF checklist",
            "guid": "eb578790-24d2-4267-a6d2-0b56c56a9581",
            "link": "https://learn.microsoft.com/purview/concept-insights",
            "service": "Purview",
            "services": [
                "WAF"
            ],
            "severity": "Low",
            "text": "Use Inventory and Ownership",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Purview/accounts",
            "checklist": "WAF checklist",
            "guid": "19bf8d8e-5c58-46b7-b8cd-c15acc075ee9",
            "link": "https://learn.microsoft.com/purview/glossary-insights",
            "service": "Purview",
            "services": [
                "WAF"
            ],
            "severity": "Low",
            "text": "Leverage Insights for Glossary, Classifications, Sensitivity Labels",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Purview/accounts",
            "checklist": "WAF checklist",
            "guid": "b130a888-9579-4e76-a896-e710a7da7be9",
            "link": "https://learn.microsoft.com/purview/compliance-manager",
            "service": "Purview",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Generate assessment scores",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Purview/accounts",
            "checklist": "WAF checklist",
            "guid": "956d14d3-c49d-4997-ab3d-1325aa225c6f",
            "link": "https://learn.microsoft.com/purview/compliance-manager-scoring",
            "service": "Purview",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Profiling- get summaries of data content",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Purview/accounts",
            "checklist": "WAF checklist",
            "guid": "4e0685ed-ddea-48a4-a7cd-eb3c61fc2fc1",
            "link": "https://learn.microsoft.com/purview/concept-policies-data-owner#microsoft-purview-policy-concepts",
            "service": "Purview",
            "services": [
                "WAF",
                "AzurePolicy"
            ],
            "severity": "Low",
            "text": "Follow Microsoft Purview Data Owner access policies",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Purview/accounts",
            "checklist": "WAF checklist",
            "guid": "4eea6e69-d8d9-4a3e-bc21-8e687ab067ac",
            "link": "https://learn.microsoft.com/purview/concept-self-service-data-access-policy",
            "service": "Purview",
            "services": [
                "WAF",
                "AzurePolicy"
            ],
            "severity": "Low",
            "text": "Follow Self-service access policies",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Purview/accounts",
            "checklist": "WAF checklist",
            "guid": "b49e5b96-0332-44ec-b8cc-13318da61170",
            "link": "https://learn.microsoft.com/purview/concept-policies-devops",
            "service": "Purview",
            "services": [
                "WAF",
                "AzurePolicy"
            ],
            "severity": "Low",
            "text": "Follow DevOps policies",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.App/containerApps",
            "checklist": "WAF checklist",
            "guid": "af416482-663c-4ed6-b195-b44c7068e09c",
            "link": "https://learn.microsoft.com/azure/reliability/reliability-azure-container-apps?tabs=azure-cli#availability-zone-support",
            "query": "resources | where type =~ 'Microsoft.App/managedEnvironments' | project name, resourceGroup, location, zoneRedundancy = tolower(tostring(properties.zoneRedundant)) | extend Compliance = iff(zoneRedundancy == 'true', true, false)",
            "service": "Container Apps",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Leverage Availability Zones if regionally applicable",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.App/containerApps",
            "checklist": "WAF checklist",
            "guid": "95bc80ec-6499-4d14-a7d2-7d296b1d8abc",
            "link": "https://learn.microsoft.com/azure/reliability/reliability-azure-container-apps?tabs=azure-cli#set-up-zone-redundancy-in-your-container-apps-environment",
            "query": "resources | where type =~ 'Microsoft.App/containerApps' | project name, resourceGroup, location, minReplicas = toint(properties.template.scale.minReplicas), maxReplicas = toint(properties.template.scale.maxReplicas) | extend Compliance = iff(minReplicas >= 1, true, false)",
            "service": "Container Apps",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Use more than one replica and enable Zone Redundancy.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.App/containerApps",
            "checklist": "WAF checklist",
            "guid": "ccaa4fc2-fdbc-4432-8bb7-f7e6469e4dc3",
            "link": "https://learn.microsoft.com/azure/reliability/reliability-azure-container-apps?tabs=azure-cli#cross-region-disaster-recovery-and-business-continuity",
            "service": "Container Apps",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "For cross-region DR, deploy container apps in multiple regions and follow active/active or active/passive application guidance.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.App/containerApps",
            "checklist": "WAF checklist",
            "guid": "2ffada86-c031-4933-bf7d-0c45bc4e5919",
            "link": "https://learn.microsoft.com/azure/reliability/reliability-azure-container-apps?tabs=azure-cli#cross-region-disaster-recovery-and-business-continuity",
            "service": "Container Apps",
            "services": [
                "WAF",
                "FrontDoor",
                "TrafficManager"
            ],
            "severity": "High",
            "text": "Use Front Door or Traffic Manager to route traffic to the closest region",
            "waf": "Reliability"
        },
        {
            "checklist": "WAF checklist",
            "guid": "bb235c70-5e17-496f-bedf-a8a4c8cdec4c",
            "link": "https://learn.microsoft.com/entra/identity-platform/msal-acquire-cache-tokens",
            "service": "Entra",
            "services": [
                "WAF",
                "Entra"
            ],
            "severity": "Medium",
            "text": "Use long-live revocable token, cache your token and acquire your silently using Microsoft Identity Library",
            "waf": "Reliability"
        },
        {
            "checklist": "WAF checklist",
            "guid": "503547c1-447e-4c66-828a-71f0f1ce16dd",
            "link": "https://learn.microsoft.com/azure/active-directory-b2c/deploy-custom-policies-devops",
            "service": "AAD B2C",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Make sure that your sign-in user flows are backed up and resilient. Make sure that the code that you use to sign-in your users are backed up and recoverable. Resilient interfaces with external processes",
            "waf": "Reliability"
        },
        {
            "checklist": "WAF checklist",
            "guid": "3e3553a4-c873-4964-ab66-2d6c15f51296",
            "link": "https://learn.microsoft.com/entra/architecture/resilient-end-user-experience#use-a-content-delivery-network",
            "service": "AAD B2C",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Custom brand assets should be hosted on a CDN",
            "waf": "Performance"
        },
        {
            "checklist": "WAF checklist",
            "guid": "5398e6df-d237-4de1-93b1-6c21d79a9b64",
            "link": "https://learn.microsoft.com/entra/identity/monitoring-health/reference-sla-performance",
            "service": "AAD B2C",
            "services": [
                "WAF"
            ],
            "severity": "Low",
            "text": "Have multiple identiy providers (i.e., login with your microsoft, google, facebook accounts)",
            "waf": "Reliability"
        },
        {
            "checklist": "WAF checklist",
            "guid": "604489a8-f42d-478e-98c0-7a73b22a4a57",
            "link": "https://azure.microsoft.com/blog/setting-up-active-directory-for-a-disaster-recovery-environment-2/",
            "service": "Windows AD",
            "services": [
                "WAF",
                "VM"
            ],
            "severity": "Medium",
            "text": "Follow VM rules for high availability on the VM level (premium disks, two or more in a region, in different availability zones)",
            "waf": "Reliability"
        },
        {
            "checklist": "WAF checklist",
            "guid": "e7a8dd4a-30e3-47c3-b297-11b2362ceee0",
            "link": "https://azure.microsoft.com/blog/setting-up-active-directory-for-a-disaster-recovery-environment-2/",
            "service": "Windows AD",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Don't replicate! Replication can create issues with directory synchronization",
            "waf": "Reliability"
        },
        {
            "checklist": "WAF checklist",
            "guid": "79b598de-fc59-472c-b4cd-21b078036f5e",
            "link": "https://azure.microsoft.com/blog/setting-up-active-directory-for-a-disaster-recovery-environment-2/",
            "service": "Windows AD",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Have active-active for multi-regions",
            "waf": "Reliability"
        },
        {
            "checklist": "WAF checklist",
            "guid": "6b4bfd3d-5035-447c-8447-ec66128a71f0",
            "link": "https://learn.microsoft.com/entra/identity/domain-services/tutorial-perform-disaster-recovery-drill",
            "service": "Entra",
            "services": [
                "WAF",
                "Entra"
            ],
            "severity": "Medium",
            "text": "Add Azure AD Domain service stamps to additional regions and locations",
            "waf": "Reliability"
        },
        {
            "checklist": "WAF checklist",
            "guid": "f1ce16dd-3f1d-45e8-92e4-2e3611cc58b4",
            "link": "https://learn.microsoft.com/entra/identity/domain-services/tutorial-perform-disaster-recovery-drill",
            "service": "Entra",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Use Replica Sets for DR",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "32e42e36-11c8-418b-8a0b-c510e43a18a9",
            "service": "AVS",
            "services": [
                "WAF",
                "Entra",
                "Subscriptions"
            ],
            "severity": "High",
            "text": "Ensure ADDS domain controller(s) are deployed in the identity subscription in native Azure",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "75089c20-990d-4927-b105-885576f76fc2",
            "service": "AVS",
            "services": [
                "WAF",
                "AVS"
            ],
            "severity": "Medium",
            "text": "Ensure ADDS sites and services is configured to keep authentication requests from Azure-based resources (including Azure VMware Solution) local to Azure",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "de3aad1e-7c28-4ec9-9666-b7570449aa80",
            "service": "AVS",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Ensure that vCenter is connected to ADDS to enable authentication based on 'named user accounts'",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "cd289ced-6b17-4db8-8554-61e2aee3553a",
            "service": "AVS",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Ensure that the connection from vCenter to ADDS is using a secure protocol (LDAPS)",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "b9d37dac-43bc-46cd-8d79-a9b24604489a",
            "service": "AVS",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "CloudAdmin account in vCenter IdP is used only as an emergency account (break-glass)",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "53d88e89-d17b-473b-82a5-a67e7a9ed5b3",
            "service": "AVS",
            "services": [
                "WAF",
                "Entra"
            ],
            "severity": "High",
            "text": "Ensure that NSX-Manager is integrated with an external Identity provider (LDAPS)",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "ae0e37ce-e297-411b-b352-caaab79b198d",
            "service": "AVS",
            "services": [
                "WAF",
                "RBAC",
                "AVS"
            ],
            "severity": "Medium",
            "text": "Has an RBAC model been created for use within VMware vSphere",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "ab81932c-9fc9-4d1b-a780-36f5e6bfbb9e",
            "service": "AVS",
            "services": [
                "WAF",
                "RBAC"
            ],
            "severity": "Medium",
            "text": "RBAC permissions should be granted on ADDS groups and not on specific users",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "d503547c-c447-4e82-9128-a71f0f1cac6d",
            "service": "AVS",
            "services": [
                "WAF",
                "RBAC",
                "AVS"
            ],
            "severity": "High",
            "text": "RBAC permissions on the Azure VMware Solution resource in Azure are 'locked down' to a limited set of owners only",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "fd9f0df4-68dc-4976-b9a9-e6a79f7682c5",
            "service": "AVS",
            "services": [
                "WAF",
                "RBAC"
            ],
            "severity": "High",
            "text": "Ensure all custom roles are scoped with CloudAdmin permitted authorizations",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "9ef1d5e8-32e4-42e3-911c-818b0a0bc510",
            "link": "https://github.com/Azure/AzureCAT-AVS/tree/main/networking",
            "service": "AVS",
            "services": [
                "WAF",
                "AVS"
            ],
            "severity": "High",
            "text": "Is the correct Azure VMware Solution connectivity model selected for the customer use case at hand",
            "waf": "Performance"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "eb710a37-cbc1-4055-8dd5-a936a8bb7cf5",
            "service": "AVS",
            "services": [
                "WAF",
                "ExpressRoute",
                "VPN",
                "NetworkWatcher",
                "Monitor"
            ],
            "severity": "High",
            "text": "Ensure ExpressRoute or VPN connections from on-premises to Azure are monitored using 'connection monitor'",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "976e24f2-a7f8-426c-9253-2a92a2a7ed99",
            "service": "AVS",
            "services": [
                "WAF",
                "ExpressRoute",
                "NetworkWatcher",
                "AVS",
                "Monitor",
                "VM"
            ],
            "severity": "Medium",
            "text": "Ensure a connection monitor is created from an Azure native resource to an Azure VMware Solution virtual machine to monitor the Azure VMware Solution back-end ExpressRoute connection",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "f41ce6a0-64f3-4805-bc65-3ab50df01265",
            "service": "AVS",
            "services": [
                "WAF",
                "NetworkWatcher",
                "AVS",
                "Monitor",
                "VM"
            ],
            "severity": "Medium",
            "text": "Ensure a connection monitor is created from an on-premises resource to an Azure VMware Solution virtual machine to monitor end-2-end connectivity",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "563b4dc7-4a74-48b6-933a-d1a0916a6649",
            "service": "AVS",
            "services": [
                "WAF",
                "ARS"
            ],
            "severity": "High",
            "text": "When route server is used, ensure no more then 1000 routes are propagated from route server to ExR gateway to on-premises (ARS limit).",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "6128a71f-0f1c-4ac6-b9ef-1d5e832e42e3",
            "service": "AVS",
            "services": [
                "WAF",
                "Entra",
                "AVS",
                "RBAC"
            ],
            "severity": "High",
            "text": "Is Privileged Identity Management implemented for roles managing the Azure VMware Solution resource in the Azure Portal (no standing permissions allowed)",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "c4e2436b-b336-4d71-9f17-960eee0b9b5c",
            "service": "AVS",
            "services": [
                "WAF",
                "Entra",
                "AVS",
                "RBAC"
            ],
            "severity": "High",
            "text": "Privileged Identity Management audit reporting should be implemented for the Azure VMware Solution PIM roles",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "78c447a8-26b2-4863-af0f-1cac599ef1d5",
            "service": "AVS",
            "services": [
                "WAF",
                "Entra",
                "AVS"
            ],
            "severity": "Medium",
            "text": "If using Privileged Identity Management is being used, ensure that a valid Entra ID enabled account is created with a valid SMTP record for Azure VMware Solution Automatic Host replacement notifications. (standing permissions required)",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "8defc4d7-21d3-41d2-90fb-707ae9eab40e",
            "service": "AVS",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Limit use of CloudAdmin account to emergency access only",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "d329f798-bc17-48bd-a5a0-6ca7144351d1",
            "service": "AVS",
            "services": [
                "WAF",
                "RBAC"
            ],
            "severity": "Medium",
            "text": "Create custom RBAC roles in vCenter to implement a least-privilege model inside vCenter",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "9dd24429-eb72-4281-97a1-51c5bb4e4f18",
            "service": "AVS",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Is a process defined to regularly rotate cloudadmin (vCenter) and admin (NSX) credentials",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "586cb291-ec16-4a1d-876e-f9f141acdce5",
            "service": "AVS",
            "services": [
                "WAF",
                "Entra",
                "AVS",
                "VM"
            ],
            "severity": "High",
            "text": "Use a centralized identity provider to be used for workloads (VM's) running on Azure VMware Solution",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "79377bcd-b375-41ab-8ab0-ead66e15d3d4",
            "service": "AVS",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Is East-West traffic filtering implemented within NSX-T",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "a2adb1c3-d232-46af-825c-a44e1695fddd",
            "service": "AVS",
            "services": [
                "WAF",
                "AppGW",
                "AVS",
                "Firewall"
            ],
            "severity": "High",
            "text": "Workloads on Azure VMware Solution are not directly exposed to the internet. Traffic is filtered and inspected by Azure Application Gateway, Azure Firewall or 3rd party solutions",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "eace4cb1-deb4-4c65-8c3f-c14eeab36938",
            "service": "AVS",
            "services": [
                "WAF",
                "AVS"
            ],
            "severity": "High",
            "text": "Auditing and logging is implemented for inbound internet requests to Azure VMware Solution and Azure VMware Solution based workloads",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "29e3eec2-1836-487a-8077-a2b5945bda43",
            "service": "AVS",
            "services": [
                "WAF",
                "AVS",
                "Monitor"
            ],
            "severity": "Medium",
            "text": "Session monitoring is implemented for outbound internet connections from Azure VMware Solution or Azure VMware Solution based workloads to identify suspicious/malicious activity",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "graph": "resources| where type =~ 'Microsoft.Network/virtualNetworkGateways'| mv-expand ipConfigurations=properties.ipConfigurations| project subnetId=tostring(ipConfigurations.properties.subnet.id)| where isnotempty(subnetId)| join (resources | where type=='microsoft.network/virtualnetworks' | project id,resourceGroup,name,enableDdosProtection=tostring(properties.enableDdosProtection),subnets=properties.subnets | mv-expand subnets | project id,resourceGroup,name,enableDdosProtection,subnetId=tostring(subnets.id)) on subnetId | distinct id,resourceGroup,name,enableDdosProtection | project id, compliant = (enableDdosProtection == 'true')",
            "guid": "334fdf91-c234-4182-a652-75269440b4be",
            "service": "AVS",
            "services": [
                "WAF",
                "ExpressRoute",
                "VNet",
                "VPN",
                "DDoS"
            ],
            "severity": "Medium",
            "text": "Is DDoS standard protection enabled on ExR/VPN Gateway subnet in Azure",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "3d3e0843-276d-44bd-a015-bcf219e4a1eb",
            "service": "AVS",
            "services": [
                "WAF",
                "AVS"
            ],
            "severity": "Medium",
            "text": "Use a dedicated privileged access workstation (PAW) to manage Azure VMware Solution, vCenter, NSX manager and HCX manager",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "9ccbd869-266a-4cca-874f-aa19bf39d95d",
            "service": "AVS",
            "services": [
                "WAF",
                "AVS",
                "Defender"
            ],
            "severity": "Medium",
            "text": "Enable Advanced Threat Detection (Microsoft Defender for Cloud aka ASC) for workloads running on Azure VMware Solution",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "44c7c891-9ca1-4f6d-9315-ae524ba34d45",
            "service": "AVS",
            "services": [
                "WAF",
                "AVS",
                "Arc"
            ],
            "severity": "Medium",
            "text": "Use Azure ARC for Servers to properly govern workloads running on Azure VMware Solution using Azure native technologies (Azure ARC for Azure VMware Solution is not yet available)",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "85e12139-bd7b-4b01-8f7b-95ef6e043e2a",
            "service": "AVS",
            "services": [
                "WAF",
                "AVS",
                "SQL"
            ],
            "severity": "Low",
            "text": "Ensure workloads on Azure VMware Solution use sufficient data encryption during run-time (like in-guest disk encryption and SQL TDE). (vSAN encryption at rest is default)",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "a3592718-e6e2-4051-9267-6ae46691e883",
            "service": "AVS",
            "services": [
                "WAF",
                "AKV"
            ],
            "severity": "Low",
            "text": "When in-guest encryption is used, store encryption keys in Azure Key vault when possible",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "5ac94222-3e13-4810-9230-81a941741583",
            "service": "AVS",
            "services": [
                "WAF",
                "AVS"
            ],
            "severity": "Medium",
            "text": "Consider using extended security update support for workloads running on Azure VMware Solution (Azure VMware Solution is eligible for ESU)",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "3ef7ad7c-6d37-4331-95c7-acbe44bbe609",
            "service": "AVS",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Ensure that the appropriate vSAN Data redundancy method is used (RAID specification)",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "d88408f3-7273-44c8-96ba-280214590146",
            "service": "AVS",
            "services": [
                "WAF",
                "AzurePolicy",
                "Storage"
            ],
            "severity": "High",
            "text": "Ensure that the Failure-to-tolerate policy is in place to meet your vSAN storage needs",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "d89f2e87-7784-424d-9167-85c6fa95b96a",
            "service": "AVS",
            "services": [
                "WAF",
                "ASR"
            ],
            "severity": "High",
            "text": "Ensure that you have requested enough quota, ensuring you have considered growth and Disaster Recovery requirement",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "5d38e53f-9ccb-4d86-a266-acca274faa19",
            "service": "AVS",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Ensure that access constraints to ESXi are understood, there are access limits which might affect 3rd party solutions.",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "bf39d95d-44c7-4c89-89ca-1f6d5315ae52",
            "service": "AVS",
            "services": [
                "WAF",
                "AzurePolicy"
            ],
            "severity": "Medium",
            "text": "Ensure that you have a policy around ESXi host density and efficiency, keeping in mind the lead time for requesting new nodes",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "4ba34d45-85e1-4213-abd7-bb012f7b95ef",
            "service": "AVS",
            "services": [
                "WAF",
                "AVS",
                "Cost"
            ],
            "severity": "Medium",
            "text": "Ensure a good cost management process is in place for Azure VMware Solution - Azure Cost Management can be used",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "6e043e2a-a359-4271-ae6e-205172676ae4",
            "service": "AVS",
            "services": [
                "WAF",
                "AVS",
                "Cost"
            ],
            "severity": "Low",
            "text": "Are Azure reserved instances used to optimize cost for using Azure VMware Solution",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "6691e883-5ac9-4422-83e1-3810523081a9",
            "service": "AVS",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Consider the use of Azure Private-Link when using other Azure Native Services",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "db611712-6904-40b4-aa3d-3e0803276d4b",
            "service": "AVS",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Ensure all required resource reside within the same Azure availability zone(s)",
            "waf": "Performance"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "48b262d6-cc5f-4512-a253-98e6db9d37da",
            "service": "AVS",
            "services": [
                "WAF",
                "AVS",
                "VM",
                "Defender"
            ],
            "severity": "Medium",
            "text": "Enable Microsoft Defender for Cloud for Azure VMware Solution guest VM workloads",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "41741583-3ef7-4ad7-a6d3-733165c7acbe",
            "service": "AVS",
            "services": [
                "WAF",
                "AVS",
                "VM",
                "Arc"
            ],
            "severity": "Medium",
            "text": "Use Azure Arc enabled servers to manage your Azure VMware Solution guest VM workloads",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "88f03a4d-2cd4-463c-abbc-868295abc91a",
            "service": "AVS",
            "services": [
                "WAF",
                "AVS"
            ],
            "severity": "High",
            "text": "Enable Diagnostic and metric logging on Azure VMware Solution",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "4ed90dae-2cc8-44c4-9b6b-781cbafe6c46",
            "service": "AVS",
            "services": [
                "WAF",
                "AVS",
                "VM",
                "Monitor"
            ],
            "severity": "Medium",
            "text": "Deploy the Log Analytics Agents to Azure VMware Solution guest VM workloads",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "589d457a-927c-4397-9d11-02cad6aae11e",
            "service": "AVS",
            "services": [
                "WAF",
                "AzurePolicy",
                "Backup",
                "AVS",
                "VM"
            ],
            "severity": "Medium",
            "text": "Ensure you have a documented and implemented backup policy and solution for Azure VMware Solution VM workloads",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "ee29711b-d352-4caa-ab79-b198dab81932",
            "service": "AVS",
            "services": [
                "WAF",
                "AVS",
                "Monitor",
                "Defender"
            ],
            "severity": "Medium",
            "text": "Use Microsoft Defender for Cloud for compliance monitoring of workloads running on Azure VMware Solution",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "c9fc9d1b-b780-436f-9e6b-fbb9ed503547",
            "service": "AVS",
            "services": [
                "WAF",
                "Defender"
            ],
            "severity": "Medium",
            "text": "Are the applicable compliance baselines added to Microsoft Defender for Cloud",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "cc447e82-6128-4a71-b0f1-cac6d9ef1d5e",
            "service": "AVS",
            "services": [
                "WAF",
                "AVS"
            ],
            "severity": "High",
            "text": "Was data residency evaluated when selecting Azure regions to use for Azure VMware Solution deployment",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "832e42e3-611c-4818-a0a0-bc510e43a18a",
            "service": "AVS",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Are data processing implications (service provider / service consumer model) clear and documented",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "547c1747-dc56-4068-a714-435cd19dd244",
            "service": "AVS",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Consider using CMK (Customer Managed Key) for vSAN only if needed for compliance reason(s).",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "e43a18a9-cd28-49ce-b6b1-7db8255461e2",
            "service": "AVS",
            "services": [
                "WAF",
                "AVS",
                "Monitor"
            ],
            "severity": "High",
            "text": "Create dashboards to enable core Azure VMware Solution monitoring insights",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "graph": "resources| where type =~ 'Microsoft.AVS/privateClouds'| join kind=leftouter(resources| where type =~ 'Microsoft.Insights/metricalerts'| mv-expand scopes=properties.scopes| mv-expand criteria=properties.criteria.allOf| extend metricName=criteria.metricName| distinct tostring(scopes), tostring(metricName))on $left.id == $right.scopes| extend compliant=toint(metricName in ('UsageAverage', 'EffectiveCpuAverage', 'DiskUsedPercentage'))| summarize compliant=min(compliant) by id",
            "guid": "6b84ee5d-f47d-42d9-8881-b1cd5d1e54a2",
            "service": "AVS",
            "services": [
                "WAF",
                "AVS",
                "Monitor"
            ],
            "severity": "High",
            "text": "Create warning alerts for critical thresholds for automatic alerting on Azure VMware Solution performance (CPU >80%, Avg Memory >80%, vSAN >70%)",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "graph": "resources| where type =~ 'Microsoft.AVS/privateClouds'| join kind=leftouter(resources| where type =~ 'Microsoft.Insights/metricalerts'| mv-expand scopes=properties.scopes| mv-expand criteria=properties.criteria.allOf| extend metricName=criteria.metricName| distinct tostring(scopes), tostring(metricName))on $left.id == $right.scopes| extend compliant=toint(metricName in ('UsageAverage', 'EffectiveCpuAverage', 'DiskUsedPercentage'))| summarize compliant=min(compliant) by id",
            "guid": "9659e396-80e7-4828-ac93-5657d02bff45",
            "service": "AVS",
            "services": [
                "WAF",
                "AVS",
                "Monitor"
            ],
            "severity": "High",
            "text": "Ensure critical alert is created to monitor if vSAN consumption is below 75% as this is a support threshold from VMware",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "graph": "resources| distinct subscriptionId| join kind=leftouter(    resources    | where type =~ 'microsoft.insights/activitylogalerts'    | mv-expand condition1 = properties.condition.allOf    | mv-expand condition2 = condition1.anyOf    | extend alertEnabled = tostring(properties.enabled)    | summarize set_condition1=make_set(condition1.equals), set_condition2=make_set(condition2.equals) by id, name,type,tenantId,resourceGroup,subscriptionId, alertEnabled    | where set_has_element(set_condition1, 'ServiceHealth')    | extend category = 'ServiceHealth'    | extend all = iff(set_has_element(set_condition1, 'ServiceHealth') and array_length(set_condition2) == 0, true, false)    | extend incident = iff(all, true, iff(set_has_element(set_condition1, 'Incident'), true, set_has_element(set_condition2, 'Incident')))    | extend maintenance = iff(all, true, iff(set_has_element(set_condition1, 'Maintenance'), true, set_has_element(set_condition2, 'Maintenance')))    | extend informational = iff(all, true, iff(set_has_element(set_condition1, 'Informational') or set_has_element(set_condition1, 'ActionRequired'), true, set_has_element(set_condition2, 'Informational') or set_has_element(set_condition2, 'ActionRequired')))    | extend security = iff(all, true, iff(set_has_element(set_condition1, 'Security'), true, set_has_element(set_condition2, 'Security')))    | project id, name, subscriptionId, category, tostring(alertEnabled), tostring(incident), tostring(maintenance), tostring(informational), tostring(security)    | summarize count_alertEnabled=countif(alertEnabled == 'true'), count_incident=countif(incident == 'True'), count_maintenance=countif(maintenance == 'True'), count_informational=countif(informational == 'True'), count_security=countif(security == 'True') by subscriptionId)     on subscriptionId| project subscriptionId, alertEnabled=iff(isnotnull(count_alertEnabled), count_alertEnabled, 0), incident=iff(isnotnull(count_incident), count_incident, 0), security=iff(isnotnull(count_security), count_security, 0), maintenance=iff(isnotnull(count_maintenance), count_maintenance, 0), informational=iff(isnotnull(count_informational), count_informational, 0)| order by incident, maintenance, informational, security desc| project id=subscriptionId, compliant=(alertEnabled > 0 and incident > 0 and security > 0 and maintenance > 0 and informational > 0)",
            "guid": "64b0d934-a348-4726-be79-d6b5c3a36495",
            "service": "AVS",
            "services": [
                "WAF",
                "Monitor"
            ],
            "severity": "High",
            "text": "Ensure alerts are configured for Azure Service Health alerts and notifications",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "b6abad38-aad5-43cc-99e1-d86667357c54",
            "service": "AVS",
            "services": [
                "WAF",
                "AVS",
                "Storage"
            ],
            "severity": "Medium",
            "text": "Configure Azure VMware Solution logging to be send to an Azure Storage account or Azure EventHub for processing",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "9674c5ed-85b8-459c-9733-be2b1a27b775",
            "service": "AVS",
            "services": [
                "WAF",
                "AVS"
            ],
            "severity": "Low",
            "text": "If deep insight in VMware vSphere is required: Is vRealize Operations and/or vRealize Network Insights used in the solution?",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "a91be1f3-88f0-43a4-b2cd-463cbbbc8682",
            "service": "AVS",
            "services": [
                "WAF",
                "AzurePolicy",
                "VM",
                "Storage"
            ],
            "severity": "High",
            "text": "Ensure the vSAN storage policy for VM's is NOT the default storage policy as this policy applies thick provisioning",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "d9ef1d5e-832d-442e-9611-c818b0afbc51",
            "service": "AVS",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Ensure vSphere content libraries are not placed on vSAN as vSAN is a finite resource",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "0e43a18a-9cd2-489b-bd6b-17db8255461e",
            "service": "AVS",
            "services": [
                "WAF",
                "Storage",
                "Backup"
            ],
            "severity": "Medium",
            "text": "Ensure data repositories for the backup solution are stored outside of vSAN storage. Either in Azure native or on a disk pool-backed datastore",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "2aee3453-aec8-4339-848b-262d6cc5f512",
            "service": "AVS",
            "services": [
                "WAF",
                "AVS",
                "Arc"
            ],
            "severity": "Medium",
            "text": "Ensure workloads running on Azure VMware Solution are hybrid managed using Azure Arc for Servers (Arc for Azure VMware Solution is in preview)",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "925398e6-da9d-437d-ac43-bc6cd1d79a9b",
            "service": "AVS",
            "services": [
                "WAF",
                "AVS",
                "Monitor"
            ],
            "severity": "Medium",
            "text": "Ensure workloads running on Azure VMware Solution are monitored using Azure Log Analytics and Azure Monitor",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "24604489-a8f4-42d7-ae78-cb6a33bd2a09",
            "service": "AVS",
            "services": [
                "WAF",
                "AVS"
            ],
            "severity": "Medium",
            "text": "Include workloads running on Azure VMware Solution in existing update management tooling or in Azure Update Management",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "17e7a8d9-0ae0-4e27-aee2-9711bd352caa",
            "service": "AVS",
            "services": [
                "WAF",
                "AzurePolicy",
                "AVS",
                "Monitor"
            ],
            "severity": "Medium",
            "text": "Use Azure Policy to onboard Azure VMware Solution workloads in the Azure Management, Monitoring and Security solutions",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "aee3553a-fc83-4392-98b2-62d6cc5f5129",
            "service": "AVS",
            "services": [
                "WAF",
                "AVS",
                "Defender"
            ],
            "severity": "Medium",
            "text": "Ensure workloads running on Azure VMware Solution are onboarded to Microsoft Defender for Cloud",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "25398e6d-b9d3-47da-a43b-c6cd1d79a9b2",
            "service": "AVS",
            "services": [
                "WAF",
                "Backup"
            ],
            "severity": "Medium",
            "text": "Ensure backups are not stored on vSAN as vSAN is a finite resource",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "5e6bfbb9-ed50-4354-9cc4-47e826028a71",
            "service": "AVS",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Have all DR solutions been considered and a solution that is best for your business been decided upon? [SRM/JetStream/Zerto/Veeam/...]",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "f0f1cac6-d9ef-41d5-b832-d42e3611c818",
            "service": "AVS",
            "services": [
                "WAF",
                "ASR"
            ],
            "severity": "Medium",
            "text": "Use Azure Site Recovery when the Disaster Recovery technology is native Azure IaaS",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "b0afbc51-0e43-4a18-a9cd-289bed6b17db",
            "service": "AVS",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Use Automated recovery plans with either of the Disaster solutions, avoid manual tasks as much as possible",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "8255461e-2aee-4345-9aec-8339248b262d",
            "service": "AVS",
            "services": [
                "WAF",
                "ASR"
            ],
            "severity": "Medium",
            "text": "Use the geopolitical region pair as the secondary disaster recovery environment",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "6cc5f512-9253-498e-9da9-d37dac43bc6c",
            "service": "AVS",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Use 2 different address spaces between the regions, for example: 10.0.0.0/16 and 192.168.0.0/16 for the different regions",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "d1d79a9b-2460-4448-aa8f-42d78e78cb6a",
            "service": "AVS",
            "services": [
                "WAF",
                "NVA",
                "AVS",
                "ExpressRoute"
            ],
            "severity": "Medium",
            "text": "Will ExpressRoute Global Reach be used for connectivity between the primary and secondary Azure VMware Solution Private Clouds or is routing done through network virtual appliances?",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "33bd2a09-17e7-4a8d-a0ae-0e27cee29711",
            "service": "AVS",
            "services": [
                "WAF",
                "Backup"
            ],
            "severity": "Medium",
            "text": "Have all Backup solutions been considered and a solution that is best for your business been decided upon? [ MABS/CommVault/Metallic.io/Veeam/�. ]",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "bd352caa-ab79-4b18-adab-81932c9fc9d1",
            "service": "AVS",
            "services": [
                "WAF",
                "AVS",
                "Backup"
            ],
            "severity": "Medium",
            "text": "Deploy your backup solution in the same region as your Azure VMware Solution private cloud",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "bb77036f-5e6b-4fbb-aed5-03547cc447e8",
            "service": "AVS",
            "services": [
                "WAF",
                "Backup"
            ],
            "severity": "Medium",
            "text": "Deploy your backup solution outside of vSan, on Azure native components",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "26028a71-f0f1-4cac-9d9e-f1d5e832d42e",
            "service": "AVS",
            "services": [
                "WAF",
                "AVS"
            ],
            "severity": "Low",
            "text": "Is a process in place to request a restore of the VMware components managed by the Azure Platform?",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "4604489a-8f42-4d78-b78c-b7a33bd2a0a1",
            "service": "AVS",
            "services": [
                "WAF"
            ],
            "severity": "Low",
            "text": "For manual deployments, all configuration and deployments must be documented",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "7e7a8d90-ae0e-437c-be29-711bd352caaa",
            "service": "AVS",
            "services": [
                "WAF",
                "AVS"
            ],
            "severity": "Low",
            "text": "For manual deployments, consider implementing resource locks to prevent accidental actions on your Azure VMware Solution Private Cloud",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "b79b198d-ab81-4932-a9fc-9d1bb78036f5",
            "service": "AVS",
            "services": [
                "WAF"
            ],
            "severity": "Low",
            "text": "For automated deployments, deploy a minimal private cloud and scale as needed",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "e6bfbb9e-d503-4547-ac44-7e826128a71f",
            "service": "AVS",
            "services": [
                "WAF"
            ],
            "severity": "Low",
            "text": "For automated deployments,  request or reserve quota prior to starting the deployment",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "0f1cac6d-9ef1-4d5e-a32e-42e3611c818b",
            "service": "AVS",
            "services": [
                "WAF",
                "AzurePolicy"
            ],
            "severity": "Low",
            "text": "For automated deployment, ensure that relevant resource locks are created through the automation or through Azure Policy for proper governance",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "e2cc95d4-8c6b-4791-bca0-f6c56589e558",
            "service": "AVS",
            "services": [
                "WAF",
                "AKV"
            ],
            "severity": "Low",
            "text": "Implement human understandable names for ExR authorization keys to allow for easy identification of the keys purpose/use",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "255461e2-aee3-4553-afc8-339248b262d6",
            "service": "AVS",
            "services": [
                "WAF",
                "AKV",
                "AVS",
                "ExpressRoute"
            ],
            "severity": "Low",
            "text": "Use Key vault to store secrets and authorization keys when separate Service Principles are used for deploying Azure VMware Solution and ExpressRoute",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "cc5f5129-2539-48e6-bb9d-37dac43bc6cd",
            "service": "AVS",
            "services": [
                "WAF",
                "AVS"
            ],
            "severity": "Low",
            "text": "Define resource dependencies for serializing actions in IaC when many resources need to be deployed in/on Azure VMware Solution as Azure VMware Solution only supports a limited number of parallel operations.",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "1d79a9b2-4604-4489-a8f4-2d78e78cb7a3",
            "service": "AVS",
            "services": [
                "WAF"
            ],
            "severity": "Low",
            "text": "When performing automated configuration of NSX-T segments with a single Tier-1 gateway, use Azure Portal APIs instead of NSX-Manager APIs",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "3bd2a0a1-7e7a-48d9-8ae0-e37cee29711b",
            "service": "AVS",
            "services": [
                "WAF",
                "Subscriptions",
                "AVS"
            ],
            "severity": "Medium",
            "text": "When intending to use automated scale-out, be sure to apply for sufficient Azure VMware Solution quota for the subscriptions running Azure VMware Solution",
            "waf": "Performance"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "d352caaa-b79b-4198-bab8-1932c9fc9d1b",
            "service": "AVS",
            "services": [
                "WAF",
                "AzurePolicy",
                "Storage"
            ],
            "severity": "Medium",
            "text": "When intending to use automated scale-in, be sure to take storage policy requirements into account before performing such action",
            "waf": "Performance"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "b78036f5-e6bf-4bb9-bd50-3547cc447e82",
            "service": "AVS",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Scaling operations always need to be serialized within a single SDDC as only one scale operation can be performed at a time (even when multiple clusters are used)",
            "waf": "Performance"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "bf15bce2-19e4-4a0e-a588-79424d226786",
            "service": "AVS",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Consider and validate scaling operations on 3rd party solutions used in the architecture (supported or not)",
            "waf": "Performance"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "d20b56c5-7be5-4851-a0f8-3835c586cb29",
            "service": "AVS",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Define and enforce scale in/out maximum limits for your environment in the automations",
            "waf": "Performance"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "1dc15a1c-075e-4e9f-841a-cccd579376bc",
            "service": "AVS",
            "services": [
                "WAF",
                "Monitor"
            ],
            "severity": "Medium",
            "text": "Implement monitoring rules to monitor automated scaling operations and monitor success and failure to enable appropriate (automated) responses",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "c5972cd4-cd21-4b07-9036-f5e6b4bfd3d5",
            "link": "https://learn.microsoft.com/azure/active-directory/app-proxy/application-proxy#how-application-proxy-works",
            "service": "AVS",
            "services": [
                "WAF",
                "VM"
            ],
            "severity": "High",
            "text": "When using MON, be aware of the limits of simulataneously configured VMs (MON Limit for HCX [400 - standard, 1000 - Larger appliance])",
            "training": "https://learn.microsoft.com/learn/modules/configure-azure-ad-application-proxy/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "be1f38cf-03a8-422b-b463-cbbbc8ac299e",
            "link": "https://learn.microsoft.com/azure/active-directory/app-proxy/application-proxy#how-application-proxy-works",
            "service": "AVS",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "When using MON, you cannot enable MON on more than 100 Network extensions",
            "training": "https://learn.microsoft.com/learn/paths/implement-applications-external-access-azure-ad/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "bc91a43d-90da-4e2c-a881-4706f7c1cbaf",
            "service": "AVS",
            "services": [
                "WAF",
                "VPN"
            ],
            "severity": "Medium",
            "text": "If using a VPN connection for migrations, adjust your MTU size accordingly.",
            "waf": "Performance"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "e614658d-d457-4e92-9139-b821102cad6e",
            "service": "AVS",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "For low connectivity regions connecting into Azure (500Mbps or less), considering deploying the HCX WAN optimization appliance",
            "waf": "Performance"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "ae01e6e8-43e5-42f4-922d-928c1b1cd521",
            "service": "AVS",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Ensure that migrations are started from the on-premises appliance and NOT from the Cloud appliance (do NOT perform a reverse migration)",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "e54a29a9-de39-4ac0-b7c2-8dc935657202",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-policy-settings",
            "service": "AVS",
            "services": [
                "WAF",
                "AVS",
                "VM",
                "Storage"
            ],
            "severity": "Medium",
            "text": "When Azure Netapp Files is used to extend storage for Azure VMware Solution,consider using this as a VMware datastore instead of attaching directly to a VM.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "bff4564b-0d93-44a3-98b2-63e7dd60513a",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#avoid-combining-traffic-manager-and-front-door",
            "service": "AVS",
            "services": [
                "WAF",
                "ExpressRoute",
                "Storage"
            ],
            "severity": "Medium",
            "text": "Ensure that a dedicated ExpressRoute Gateway is being used for external data storage solutions",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "3649906e-bad3-48ea-b53c-c7de1d8aaab3",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-the-same-domain-name-on-front-door-and-your-origin",
            "service": "AVS",
            "services": [
                "WAF",
                "ExpressRoute",
                "Storage"
            ],
            "severity": "Medium",
            "text": "Ensure that FastPath is enabled on the ExpressRoute Gateway that is being used for external data storage solutions",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "571549ab-8153-4d89-b89d-c7b33be2b1a2",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#disable-health-probes-when-theres-only-one-origin-in-an-origin-group",
            "service": "AVS",
            "services": [
                "WAF",
                "ASR"
            ],
            "severity": "High",
            "text": "If using stretched cluster, ensure that your selected Disaster Recovery solution is supported by the vendor",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "4c486b6d-8bdc-4059-acf7-5ee8a1309888",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#select-good-health-probe-endpoints",
            "service": "AVS",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "If using stretched cluster, ensure that the SLA provided will meet your requirements",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "9579d66b-896d-471f-a6ca-7be9955d04c3",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-head-health-probes",
            "service": "AVS",
            "services": [
                "WAF",
                "ExpressRoute"
            ],
            "severity": "High",
            "text": "If using stretched cluster, ensure that both ExpressRoute circuits are connected to your connectivity hub.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "c49d987c-b3d1-4325-aa12-4b6e4d0685ed",
            "link": "https://learn.microsoft.com/azure/nat-gateway/nat-overview#outbound-connectivity",
            "service": "AVS",
            "services": [
                "WAF",
                "ExpressRoute"
            ],
            "severity": "High",
            "text": "If using stretched cluster, ensure that both ExpressRoute circuits have GlobalReach enabled.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AVS/privateClouds",
            "checklist": "WAF checklist",
            "guid": "dce9793b-7bcd-4b3b-91eb-2ec14eea6e59",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-managed-tls-certificates",
            "service": "AVS",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Have site disaster tolerance settings been properly considered and changed for your business if needed.",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.cache/redis",
            "checklist": "WAF checklist",
            "guid": "65285269-440b-44be-9d3e-0844276d4bdc",
            "link": "https://learn.microsoft.com/azure/azure-cache-for-redis/cache-how-to-zone-redundancy",
            "service": "Redis",
            "services": [
                "WAF",
                "ACR"
            ],
            "severity": "High",
            "text": "Enable zone redundancy for Azure Cache for Redis. Azure Cache for Redis supports zone redundant configurations in the Premium and Enterprise tiers. A zone redundant cache can place its nodes across different Azure Availability Zones in the same region. It eliminates data center or AZ outage as a single point of failure and increases the overall availability of your cache.",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.cache/redis",
            "checklist": "WAF checklist",
            "guid": "bc178bdc-5a06-4ca7-8443-51e19dd34429",
            "link": "https://learn.microsoft.com/en-us/azure/azure-cache-for-redis/cache-high-availability#persistence",
            "service": "Redis",
            "services": [
                "WAF",
                "Storage"
            ],
            "severity": "Medium",
            "text": "Configure data persistence for an Azure Cache for Redis instance. Because your cache data is stored in memory, a rare and unplanned failure of multiple nodes can cause all the data to be dropped. To avoid losing data completely, Redis persistence allows you to take periodic snapshots of in-memory data, and store it to your storage account.",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.cache/redis",
            "checklist": "WAF checklist",
            "guid": "eb722823-7a15-41c5-ab4e-4f1814387e5c",
            "link": "https://learn.microsoft.com/en-us/azure/azure-cache-for-redis/cache-high-availability#storage-account-for-persistence",
            "service": "Redis",
            "services": [
                "WAF",
                "Storage"
            ],
            "severity": "Medium",
            "text": "Use Geo-redundant storage account to persist Azure Cache for Redis data, or zonally redundant where geo-redundancy is not available",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.cache/redis",
            "checklist": "WAF checklist",
            "guid": "a8c26c9b-32ab-45bd-bc69-98a135e33789",
            "link": "https://learn.microsoft.com/azure/azure-cache-for-redis/cache-how-to-geo-replication",
            "service": "Redis",
            "services": [
                "WAF",
                "ASR"
            ],
            "severity": "Medium",
            "text": "Configure passive geo-replication for Premium Azure Cache for Redis instances. Geo-replication is a mechanism for linking two or more Azure Cache for Redis instances, typically spanning two Azure regions. Geo-replication is designed mainly for cross-region disaster recovery. Two Premium tier cache instances are connected through geo-replication in a way that provides reads and writes to your primary cache, and that data is replicated to the secondary cache.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.DataFactory/datafactories",
            "checklist": "WAF checklist",
            "guid": "ab91932c-9fc9-4d1b-a881-37f5e6c0cb9e",
            "link": "https://github.com/Azure/fta-resiliencyplaybooks/blob/main/paas-foundations-playbooks-ADF_v1.docx",
            "service": "Azure Data Factory",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Leverage FTA Resiliency Playbook for Azure Data Factory",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.DataFactory/datafactories",
            "checklist": "WAF checklist",
            "guid": "e503547c-d447-4e82-9138-a7200f1cac6d",
            "link": "https://learn.microsoft.com/azure/architecture/example-scenario/analytics/pipelines-disaster-recovery",
            "service": "Azure Data Factory",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Use zone redundant pipelines in regions that support Availability Zones",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.DataFactory/datafactories",
            "checklist": "WAF checklist",
            "guid": "9ef1d6e8-32e5-42e3-911c-818b1a0bc511",
            "link": "https://learn.microsoft.com/azure/data-factory/source-control",
            "service": "Azure Data Factory",
            "services": [
                "WAF",
                "Backup"
            ],
            "severity": "Medium",
            "text": "Use DevOps to Backup the ARM templates with Github/Azure DevOps integration ",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.DataFactory/datafactories",
            "checklist": "WAF checklist",
            "guid": "e43a18a9-cd29-49cf-b7b1-7db8255562f2",
            "link": "https://learn.microsoft.com/azure/architecture/example-scenario/analytics/pipelines-disaster-recovery",
            "service": "Azure Data Factory",
            "services": [
                "WAF",
                "VM"
            ],
            "severity": "Medium",
            "text": "Make sure you replicate the Self-Hosted Integration Runtime VMs in another region ",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.DataFactory/datafactories",
            "checklist": "WAF checklist",
            "guid": "aee4563a-fd83-4393-98b2-62d6dc5f512a",
            "link": "https://learn.microsoft.com/azure/architecture/example-scenario/analytics/pipelines-disaster-recovery",
            "service": "Azure Data Factory",
            "services": [
                "WAF",
                "VNet"
            ],
            "severity": "Medium",
            "text": "Make sure you replicate or duplicate your network in the sister region. You have to make a copy of your Vnet in another region",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.DataFactory/datafactories",
            "checklist": "WAF checklist",
            "description": "If your ADF Pipelines use Key Vault you don't have to do anything to replicate Key Vault. Key Vault is a managed service and Microsoft takes care of it for you",
            "guid": "25498f6d-bad3-47da-a43b-c6ce1d7aa9b2",
            "link": "https://learn.microsoft.com/azure/key-vault/general/disaster-recovery-guidance",
            "service": "Azure Data Factory",
            "services": [
                "WAF",
                "AKV"
            ],
            "severity": "Low",
            "text": "If using Keyvault integration, use SLA of Keyvault to understand your availablity",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.ServiceBus/namespaces",
            "checklist": "WAF checklist",
            "description": "Azure Service Bus Premium provides encryption of data at rest. If you use your own key, the data is still encrypted using the Microsoft-managed key, but in addition the Microsoft-managed key will be encrypted using the customer-managed key. ",
            "guid": "87af4a79-1f89-439b-ba47-768e14c11567",
            "link": "https://learn.microsoft.com/azure/service-bus-messaging/configure-customer-managed-key",
            "service": "Service Bus",
            "services": [
                "WAF",
                "ServiceBus"
            ],
            "severity": "Low",
            "text": "Use customer-managed key option in data at rest encryption when required",
            "training": "https://learn.microsoft.com/learn/modules/plan-implement-administer-conditional-access/",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.ServiceBus/namespaces",
            "checklist": "WAF checklist",
            "description": "Communication between a client application and an Azure Service Bus namespace is encrypted using Transport Layer Security (TLS). Azure Service Bus namespaces permit clients to send and receive data with TLS 1.0 and above. To enforce stricter security measures, you can configure your Service Bus namespace to require that clients send and receive data with a newer version of TLS.",
            "guid": "5c1ea55b-46a9-448f-b8ae-7d7e4b475b6c",
            "link": "https://learn.microsoft.com/azure/service-bus-messaging/transport-layer-security-enforce-minimum-version",
            "service": "Service Bus",
            "services": [
                "WAF",
                "ServiceBus"
            ],
            "severity": "Medium",
            "text": "Enforce a minimum required version of Transport Layer Security (TLS) for requests ",
            "training": "https://learn.microsoft.com/learn/modules/secure-aad-users-with-mfa/",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.ServiceBus/namespaces",
            "checklist": "WAF checklist",
            "description": "When you create a Service Bus namespace, a SAS rule named RootManageSharedAccessKey is automatically created for the namespace. This policy has Manage permissions for the entire namespace. It's recommended that you treat this rule like an administrative root account and don't use it in your application.  Using AAD as an authentication provider with RBAC is recommended. ",
            "guid": "8bcbf59b-ce65-4de8-a03f-97879468d66a",
            "link": "https://learn.microsoft.com/azure/service-bus-messaging/service-bus-sas#shared-access-authorization-policies",
            "service": "Service Bus",
            "services": [
                "WAF",
                "ServiceBus",
                "AzurePolicy",
                "RBAC",
                "Entra",
                "TrafficManager"
            ],
            "severity": "Medium",
            "text": "Avoid using root account when it is not necessary",
            "training": "https://learn.microsoft.com/learn/paths/azure-administrator-manage-identities-governance/",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.ServiceBus/namespaces",
            "checklist": "WAF checklist",
            "description": "Microsoft Entra ID provides superior security and ease of use over shared access signatures (SAS). With Microsoft Entra ID, there’s no need to store the tokens in your code and risk potential security vulnerabilities. We recommend that you use Microsoft Entra ID with your Azure Service Bus applications when possible.",
            "graph": "Resources | where type =~ 'microsoft.servicebus/namespaces' | extend compliant = iif(properties.disableLocalAuth == 'false', 'No', 'Yes') | project id, compliant",
            "guid": "786d60f9-6c96-4ad8-a55d-04c2b39c986b",
            "link": "https://learn.microsoft.com/en-us/azure/service-bus-messaging/disable-local-authentication",
            "service": "Service Bus",
            "services": [
                "WAF",
                "Entra",
                "ServiceBus"
            ],
            "severity": "Medium",
            "text": "When possible, disable SAS key authentication (or local authentication) and use only Microsoft Entra ID for authentication",
            "training": "https://learn.microsoft.com/learn/modules/azure-ad-privileged-identity-management/",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.ServiceBus/namespaces",
            "checklist": "WAF checklist",
            "description": "When creating permissions, provide fine-grained control over a client's access to Azure Service Bus. Permissions in Azure Service Bus can and should be scoped to the individual resource level e.g. queue, topic or subscription. ",
            "guid": "f615658d-e558-4f93-9249-b831112dbd7e",
            "link": "https://learn.microsoft.com/azure/service-bus-messaging/authenticate-application#azure-built-in-roles-for-azure-service-bus",
            "service": "Service Bus",
            "services": [
                "WAF",
                "ServiceBus",
                "RBAC",
                "Subscriptions",
                "Storage"
            ],
            "severity": "High",
            "text": "Use least privilege data plane RBAC",
            "training": "https://learn.microsoft.com/learn/modules/explore-basic-services-identity-types/",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.ServiceBus/namespaces",
            "checklist": "WAF checklist",
            "description": "Azure Service Bus resource logs include operational logs,  virtual network and IP filtering logs. Runtime audit logs capture aggregated diagnostic information for various data plane access operations (such as send or receive messages) in Service Bus.",
            "guid": "af12e7f9-43f6-4304-922d-929c2b1cd622",
            "link": "https://learn.microsoft.com/azure/service-bus-messaging/monitor-service-bus-reference",
            "service": "Service Bus",
            "services": [
                "WAF",
                "VNet",
                "Monitor",
                "ServiceBus"
            ],
            "severity": "Medium",
            "text": "Enable logging for security investigation. Use Azure Monitor to trace resource logs and runtime audit logs (currently available only in the premium tier)",
            "training": "https://learn.microsoft.com/learn/paths/manage-identity-and-access/",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.ServiceBus/namespaces",
            "checklist": "WAF checklist",
            "description": "Azure Service Bus by default has a public IP address and is Internet-reachable. Private endpoints allow traffic between your virtual network and Azure Service Bus traverses over the Microsoft backbone network. In addition to that, you should disable public endpoints if those are not used. ",
            "guid": "9ae669ca-48e4-4a85-b222-3ece8bb12307",
            "link": "https://learn.microsoft.com/azure/service-bus-messaging/private-link-service",
            "service": "Service Bus",
            "services": [
                "WAF",
                "ServiceBus",
                "PrivateLink",
                "VNet"
            ],
            "severity": "Medium",
            "text": "Consider using private endpoints to access Azure Service Bus and disable public network access when applicable.",
            "training": "https://learn.microsoft.com/learn/modules/azure-ad-privileged-identity-management/",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.ServiceBus/namespaces",
            "checklist": "WAF checklist",
            "description": "With IP firewall, you can restrict the public endpoint further to only a set of IPv4 addresses or IPv4 address ranges in CIDR (Classless Inter-Domain Routing) notation. ",
            "guid": "ca5f06f1-58e3-4ea3-a92c-2de7e2165c3a",
            "link": "https://learn.microsoft.com/azure/service-bus-messaging/service-bus-ip-filtering",
            "service": "Service Bus",
            "services": [
                "WAF",
                "ServiceBus"
            ],
            "severity": "Medium",
            "text": "Consider only allowing access to Azure Service Bus namespace from specific IP addresses or ranges",
            "training": "https://learn.microsoft.com/learn/paths/implement-resource-mgmt-security/",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Devices/provisioningServices",
            "checklist": "WAF checklist",
            "guid": "cb26b2ba-a9db-45d1-8260-d9c6ec1447d9",
            "link": "https://learn.microsoft.com/en-us/azure/logic-apps/single-tenant-overview-compare",
            "service": "IoT Hub DPS",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Select the right Logic App hosting plan based on your business & SLO requirements",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Devices/provisioningServices",
            "checklist": "WAF checklist",
            "guid": "f6dd7977-1123-4f39-b488-f91415a8430a",
            "link": "https://learn.microsoft.com/en-us/azure/logic-apps/set-up-zone-redundancy-availability-zones?tabs=standard#next-steps",
            "service": "IoT Hub DPS",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Protect logic apps from region failures with zone redundancy and availability zones",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Devices/provisioningServices",
            "checklist": "WAF checklist",
            "guid": "8aed4fbf-0830-4883-899d-222a154af478",
            "link": "https://learn.microsoft.com/en-us/azure/logic-apps/business-continuity-disaster-recovery-guidance?toc=%2Fazure%2Freliability%2Ftoc.json&bc=%2Fazure%2Freliability%2Fbreadcrumb%2Ftoc.json",
            "service": "IoT Hub DPS",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Consider a Cross-Region DR strategy for critical workloads",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Devices/provisioningServices",
            "checklist": "WAF checklist",
            "guid": "da0f033e-d180-4f36-9aa4-c468dba14203",
            "link": "https://learn.microsoft.com/en-us/azure/app-service/environment/intro",
            "service": "IoT Hub DPS",
            "services": [
                "WAF",
                "AppSvc"
            ],
            "severity": "High",
            "text": "If deploying to an Isolated environment, use or migrate to App Service Environment (ASE) v3",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Devices/provisioningServices",
            "checklist": "WAF checklist",
            "guid": "62711604-c9d1-4b0a-bdb7-5fda54a4f6c1",
            "link": "https://learn.microsoft.com/en-us/training/modules/deploy-azure-functions/",
            "service": "IoT Hub DPS",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Leverage Azure DevOps or GitHub to streamline CI/CD and safeguard your Logic App code",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "WAF checklist",
            "description": "Apply guidance from the Microsoft cloud security benchmark related to Storage",
            "guid": "d237de14-3b16-4c21-b7aa-9b64604489a8",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/storage-security-baseline",
            "service": "Azure Storage",
            "services": [
                "WAF",
                "Storage"
            ],
            "severity": "Medium",
            "text": "Consider the 'Azure security baseline for storage'",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "WAF checklist",
            "description": "Azure Storage by default has a public IP address and is Internet-reachable. Private endpoints allow to securely expose Azure Storage only to those Azure Compute resources that need access, thus eliminating exposure to the public Internet",
            "graph": "resources | where type =~ 'Microsoft.Storage/StorageAccounts' | where isnull(properties.privateEndpointConnections) or properties.privateEndpointConnections[0].properties.provisioningState != ('Succeeded') or (isnull(properties.networkAcls) and properties.publicNetworkAccess == 'Enabled') | extend compliant = (isnotnull(properties.privateEndpointConnections) and properties.privateEndpointConnections[0].properties.provisioningState == 'Succeeded' and properties.publicNetworkAccess == 'Disabled') | distinct id, compliant",
            "guid": "f42d78e7-9d17-4a73-a22a-5a67e7a8ed4b",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-private-endpoints",
            "service": "Azure Storage",
            "services": [
                "WAF",
                "PrivateLink",
                "Storage"
            ],
            "severity": "High",
            "text": "Consider using private endpoints for Azure Storage",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "WAF checklist",
            "description": "Newly created storage accounts are created using the ARM deployment model, so that RBAC, auditing etc. are all enabled. Ensure that there are no old storage accounts with classic deployment model in a subscription",
            "guid": "30e37c3e-2971-41b2-963c-eee079b598de",
            "link": "https://learn.microsoft.com/azure/virtual-machines/migration-classic-resource-manager-overview#migration-of-storage-accounts",
            "service": "Azure Storage",
            "services": [
                "WAF",
                "Subscriptions",
                "RBAC",
                "Storage"
            ],
            "severity": "Medium",
            "text": "Ensure older storage accounts are not using 'classic deployment model'",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "WAF checklist",
            "description": "Leverage Microsoft Defender to learn about suspicious activity and misconfigurations.",
            "graph": "resources | where type =~ 'Microsoft.Storage/StorageAccounts' | project storageAccountId = id | join kind=leftouter (resourceContainers | where type == 'microsoft.security/pricings' | where name == 'StorageAccounts' | project resourceId = id, pricingTier = properties.pricingTier) on $left.storageAccountId == $right.resourceId | where isnull(pricingTier) or pricingTier != 'Standard' | extend compliant = false | distinct storageAccountId, compliant",
            "guid": "fc5972cd-4cd2-41b0-a803-7f5e6b4bfd3d",
            "link": "https://learn.microsoft.com/azure/storage/common/azure-defender-storage-configure",
            "service": "Azure Storage",
            "services": [
                "WAF",
                "Storage",
                "Defender"
            ],
            "severity": "High",
            "text": "Enable Microsoft Defender for all of your storage accounts",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "WAF checklist",
            "description": "The soft-delete mechanism allows to recover accidentally deleted blobs.",
            "guid": "503547c1-447e-4c66-828a-7100f1ce16dd",
            "link": "https://learn.microsoft.com/azure/storage/blobs/soft-delete-blob-overview",
            "service": "Azure Storage",
            "services": [
                "WAF",
                "Storage"
            ],
            "severity": "Medium",
            "text": "Enable 'soft delete' for blobs",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "WAF checklist",
            "description": "Consider selectively disabling 'soft delete' for certain blob containers, for example if the application must ensure that deleted information is immediately deleted, e.g. for confidentiality, privacy or compliance reasons. ",
            "guid": "3f1d5e87-2e52-4e36-81cc-58b4a4b1510e",
            "link": "https://learn.microsoft.com/azure/storage/blobs/soft-delete-blob-enable",
            "service": "Azure Storage",
            "services": [
                "WAF",
                "Storage"
            ],
            "severity": "Medium",
            "text": "Disable 'soft delete' for blobs",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "WAF checklist",
            "description": "Soft delete for containers enables you to recover a container after it has been deleted, for example recover from an accidental delete operation.",
            "guid": "43a58a9c-2289-4c3d-9b57-d0c655462f2a",
            "link": "https://learn.microsoft.com/azure/storage/blobs/soft-delete-container-overview",
            "service": "Azure Storage",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Enable 'soft delete' for containers",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "WAF checklist",
            "description": "Consider selectively disabling 'soft delete' for certain blob containers, for example if the application must ensure that deleted information is immediately deleted, e.g. for confidentiality, privacy or compliance reasons. ",
            "guid": "3e3453a3-c863-4964-ab65-2d6c15f51296",
            "link": "https://learn.microsoft.com/azure/storage/blobs/soft-delete-container-enable",
            "service": "Azure Storage",
            "services": [
                "WAF",
                "Storage"
            ],
            "severity": "Medium",
            "text": "Disable 'soft delete' for containers",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "WAF checklist",
            "description": "Prevents accidental deletion of a storage account, by forcing the user to first remove the deletion lock, prior to deletion",
            "guid": "5398e6de-d227-4dd1-92b0-6c21d7999a64",
            "link": "https://learn.microsoft.com/azure/storage/common/lock-account-resource",
            "service": "Azure Storage",
            "services": [
                "WAF",
                "Storage"
            ],
            "severity": "High",
            "text": "Enable resource locks on storage accounts",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "WAF checklist",
            "description": "Consider 'legal hold' or 'time-based retention' policies for blobs, so that is is impossible to delete the blob, the container, or the storage account. Please note that 'impossible' actually means 'impossible'; once a storage account contains an immutable blob, the only way to 'get rid' of that storage account is by cancelling the Azure subscription.",
            "guid": "6f4389a8-f42c-478e-98c0-6a73a22a4956",
            "link": "https://learn.microsoft.com/azure/storage/blobs/immutable-storage-overview",
            "service": "Azure Storage",
            "services": [
                "WAF",
                "Subscriptions",
                "AzurePolicy",
                "Storage"
            ],
            "severity": "High",
            "text": "Consider immutable blobs",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "WAF checklist",
            "description": "Consider disabling unprotected HTTP/80 access to the storage account, so that all data transfers are encrypted, integrity protected, and the server is authenticated. ",
            "graph": "resources | where type =~ 'Microsoft.Storage/StorageAccounts' | extend compliant = (properties.supportsHttpsTrafficOnly == false) | distinct id, compliant",
            "guid": "e7a8dc4a-20e2-47c3-b297-11b1352beee0",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-require-secure-transfer",
            "service": "Azure Storage",
            "services": [
                "WAF",
                "Storage"
            ],
            "severity": "High",
            "text": "Require HTTPS, i.e. disable port 80 on the storage account",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "WAF checklist",
            "description": "When configuring a custom domain (hostname) on a storage account, check whether you need TLS/HTTPS; if so, you might have to put Azure CDN in front of your storage account.",
            "guid": "79b588de-fc49-472c-b3cd-21bf77036e5e",
            "link": "https://learn.microsoft.com/azure/storage/blobs/storage-custom-domain-name",
            "service": "Azure Storage",
            "services": [
                "WAF",
                "Storage"
            ],
            "severity": "High",
            "text": "When enforcing HTTPS (disabling HTTP), check that you do not use custom domains (CNAME) for the storage account.",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "WAF checklist",
            "description": "Requiring HTTPS when a client uses a SAS token to access blob data helps to minimize the risk of credential loss.",
            "guid": "6b4bed3d-5035-447c-8347-dc56028a71ff",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-sas-overview",
            "service": "Azure Storage",
            "services": [
                "WAF",
                "Storage"
            ],
            "severity": "Medium",
            "text": "Limit shared access signature (SAS) tokens to HTTPS connections only",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "WAF checklist",
            "description": ". Enforcing the latest TLS version will reject request from clients using the older version. ",
            "graph": "resources | where type == 'microsoft.storage/storageaccounts' | extend compliant = (isnull(properties.minimumTlsVersion) == false and properties.minimumTlsVersion in ('TLS1_2', 'TLS1_3')) | distinct id, compliant",
            "guid": "e12be569-a18f-4562-8d5d-ce151b9e7d55",
            "link": "https://learn.microsoft.com/azure/storage/common/transport-layer-security-configure-minimum-version",
            "service": "Azure Storage",
            "services": [
                "WAF",
                "Storage"
            ],
            "severity": "High",
            "text": "Enforce the latest TLS version for a storage account",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "WAF checklist",
            "description": "Microsoft Entra ID tokens should be favored over shared access signatures, wherever possible",
            "guid": "e1ce15dd-3f0d-45e7-92d4-1e3611cc57b4",
            "link": "https://learn.microsoft.com/azure/storage/common/authorize-data-access",
            "service": "Azure Storage",
            "services": [
                "WAF",
                "Entra",
                "Storage"
            ],
            "severity": "High",
            "text": "Use Microsoft Entra ID tokens for blob access",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "WAF checklist",
            "description": "When assigning a role to a user, group, or application, grant that security principal only those permissions that are necessary for them to perform their tasks. Limiting access to resources helps prevent both unintentional and malicious misuse of your data.",
            "guid": "a4b1410d-4395-48a8-a228-9b3d6b57cfc6",
            "service": "Azure Storage",
            "services": [
                "WAF",
                "RBAC"
            ],
            "severity": "Medium",
            "text": "Least privilege in IaM permissions",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "WAF checklist",
            "description": "A user delegation SAS is secured with Azure Active Directory (Azure AD) credentials and also by the permissions specified for the SAS. A user delegation SAS is analogous to a service SAS in terms of its scope and function, but offers security benefits over the service SAS. ",
            "guid": "55461e1a-3e34-453a-9c86-39648b652d6c",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-sas-overview?toc=%2Fazure%2Fstorage%2Fblobs%2Ftoc.json#best-practices-when-using-sas",
            "service": "Azure Storage",
            "services": [
                "WAF",
                "Entra",
                "Storage"
            ],
            "severity": "High",
            "text": "When using SAS, prefer 'user delegation SAS' over storage-account-key based SAS.",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "WAF checklist",
            "description": "Storage account keys ('shared keys') have very little audit capabilities. While it can be monitored on who/when fetched a copy of the keys, once the keys are in the hands of multiple people, it is impossible to attribute usage to a specific user. Solely relying on Entra ID authentication makes it easier to tie storage access to a user. ",
            "graph": "resources | where type == 'microsoft.storage/storageaccounts' | extend allowSharedKeyAccess = tostring(properties.allowSharedKeyAccess) | extend compliant = (isnotempty(allowSharedKeyAccess) and allowSharedKeyAccess == 'false') | distinct id, compliant",
            "guid": "15f51296-5398-4e6d-bd22-7dd142b06c21",
            "link": "https://learn.microsoft.com/rest/api/storageservices/authorize-with-shared-key",
            "service": "Azure Storage",
            "services": [
                "WAF",
                "AKV",
                "Entra",
                "Monitor",
                "Storage"
            ],
            "severity": "High",
            "text": "Consider disabling storage account keys, so that only Microsoft Entra ID access (and user delegation SAS) is supported.",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "WAF checklist",
            "description": "Use Activity Log data to identify 'when', 'who', 'what' and 'how' the security of your storage account is being viewed or changed (i.e. storage account keys, access policies, etc.).",
            "guid": "d7999a64-6f43-489a-af42-c78e78c06a73",
            "link": "https://learn.microsoft.com/azure/storage/blobs/blob-storage-monitoring-scenarios#audit-account-activity",
            "service": "Azure Storage",
            "services": [
                "WAF",
                "AKV",
                "AzurePolicy",
                "Monitor",
                "Storage"
            ],
            "severity": "High",
            "text": "Consider using Azure Monitor to audit control plane operations on the storage account",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "WAF checklist",
            "description": "A key expiration policy enables you to set a reminder for the rotation of the account access keys. The reminder is displayed if the specified interval has elapsed and the keys have not yet been rotated.",
            "guid": "a22a4956-e7a8-4dc4-a20e-27c3e29711b1",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-account-keys-manage?tabs=azure-portal#create-a-key-expiration-policy",
            "service": "Azure Storage",
            "services": [
                "WAF",
                "AKV",
                "AzurePolicy",
                "Storage"
            ],
            "severity": "Medium",
            "text": "When using storage account keys, consider enabling a 'key expiration policy'",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "WAF checklist",
            "description": "A SAS expiration policy specifies a recommended interval over which the SAS is valid. SAS expiration policies apply to a service SAS or an account SAS. When a user generates service SAS or an account SAS with a validity interval that is larger than the recommended interval, they'll see a warning.",
            "guid": "352beee0-79b5-488d-bfc4-972cd3cd21bf",
            "link": "https://learn.microsoft.com/azure/storage/common/sas-expiration-policy",
            "service": "Azure Storage",
            "services": [
                "WAF",
                "AzurePolicy"
            ],
            "severity": "Medium",
            "text": "Consider configuring an SAS expiration policy",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "WAF checklist",
            "description": "Stored access policies give you the option to revoke permissions for a service SAS without having to regenerate the storage account keys. ",
            "guid": "77036e5e-6b4b-4ed3-b503-547c1347dc56",
            "link": "https://learn.microsoft.com/rest/api/storageservices/define-stored-access-policy",
            "service": "Azure Storage",
            "services": [
                "WAF",
                "AKV",
                "AzurePolicy",
                "Storage"
            ],
            "severity": "Medium",
            "text": "Consider linking SAS to a stored access policy",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "WAF checklist",
            "guid": "028a71ff-e1ce-415d-b3f0-d5e772d41e36",
            "link": "https://microsoft.github.io/code-with-engineering-playbook/continuous-integration/dev-sec-ops/secret-management/recipes/detect-secrets-ado/",
            "service": "Azure Storage",
            "services": [
                "WAF",
                "AKV",
                "Storage"
            ],
            "severity": "Medium",
            "text": "Consider configuring your application's source code repository to detect checked-in connection strings and storage account keys.",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "WAF checklist",
            "description": "Ideally, your application should be using a managed identity to authenticate to Azure Storage. If that is not possible, consider having the storage credential (connection string, storage account key, SAS, service principal credential) in Azure KeyVault or an equivalent service.",
            "guid": "11cc57b4-a4b1-4410-b439-58a8c2289b3d",
            "link": "https://learn.microsoft.com/azure/architecture/framework/security/design-storage-keys",
            "service": "Azure Storage",
            "services": [
                "WAF",
                "Entra",
                "Storage"
            ],
            "severity": "High",
            "text": "Consider storing connection strings in Azure KeyVault (in scenarios where managed identities are not possible)",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "WAF checklist",
            "description": "Use near-term expiration times on an ad hoc SAS service SAS or account SAS. In this way, even if a SAS is compromised, it's valid only for a short time. This practice is especially important if you cannot reference a stored access policy. Near-term expiration times also limit the amount of data that can be written to a blob by limiting the time available to upload to it.",
            "guid": "27138b82-1102-4cac-9eae-01e6e842e52f",
            "link": "https://learn.microsoft.com/rest/api/storageservices/delegate-access-with-shared-access-signature",
            "service": "Azure Storage",
            "services": [
                "WAF",
                "AzurePolicy",
                "Storage"
            ],
            "severity": "High",
            "text": "Strive for short validity periods for ad-hoc SAS",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "WAF checklist",
            "description": "When creating a SAS, be as specific and restrictive as possible. Prefer a SAS for a single resource and operation over a SAS which gives much broader access.",
            "guid": "4721d928-c1b1-4cd5-81e5-4a29a9de399c",
            "link": "https://learn.microsoft.com/rest/api/storageservices/delegate-access-with-shared-access-signature",
            "service": "Azure Storage",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Apply a narrow scope to a SAS",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "WAF checklist",
            "description": "A SAS can include parameters on which client IP addresses or address ranges are authorized to request a resource using the SAS. ",
            "guid": "fd7b28dc-9355-4562-82bf-e4564b0d834a",
            "link": "https://learn.microsoft.com/rest/api/storageservices/create-account-sas",
            "service": "Azure Storage",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Consider scoping SAS to a specific client IP address, wherever possible",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "WAF checklist",
            "description": "A SAS cannot constrain how much data a client uploads; given the pricing model of amount of storage over time, it might make sense to validate whether clients uploaded maliciously large contents.",
            "guid": "348b263e-6dd6-4051-8a36-498f6dbad38e",
            "service": "Azure Storage",
            "services": [
                "WAF",
                "Storage"
            ],
            "severity": "Low",
            "text": "Consider checking uploaded data, after clients used a SAS to upload a file. ",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "WAF checklist",
            "description": "When accessing blob storage via SFTP using a 'local user account', the 'usual' RBAC controls do not apply. Blob access via NFS or REST might be more restrictive than SFTP access. Unfortunately, as of early 2023, local users are the only form of identity management that is currently supported for the SFTP endpoint",
            "guid": "ad53cc7c-e1d7-4aaa-a357-1449ab8053d8",
            "link": "https://learn.microsoft.com/azure/storage/blobs/secure-file-transfer-protocol-support#sftp-permission-model",
            "service": "Azure Storage",
            "services": [
                "WAF",
                "Entra",
                "RBAC",
                "Storage"
            ],
            "severity": "High",
            "text": "SFTP: Limit the amount of 'local users' for SFTP access, and audit whether access is needed over time.",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "WAF checklist",
            "guid": "9f89dc7b-33be-42a1-a27f-7b9e91be1f38",
            "link": "https://learn.microsoft.com/azure/storage/blobs/secure-file-transfer-protocol-known-issues#authentication-and-authorization",
            "service": "Azure Storage",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "SFTP: The SFTP endpoint does not support POSIX-like ACLs.",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "WAF checklist",
            "description": "Storage supports CORS (Cross-Origin Resource Sharing), i.e. an HTTP feature that enables web apps from a different domain to loosen the same-origin policy. When enabling CORS, keep the CorsRules to the least privilege.",
            "guid": "cef39812-bd46-43cb-aac8-ac199ebb91a3",
            "link": "https://learn.microsoft.com/rest/api/storageservices/cross-origin-resource-sharing--cors--support-for-the-azure-storage-services",
            "service": "Azure Storage",
            "services": [
                "WAF",
                "AzurePolicy",
                "Storage"
            ],
            "severity": "High",
            "text": "Avoid overly broad CORS policies",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "WAF checklist",
            "description": "Data at rest is always encrypted server-side, and in addition might be encrypted client-side as well. Server-side encryption might happen using a platform-managed key (default) or customer-managed key. Client-side encryption might happen by either having the client supply an encryption/decryption key on a per-blob basis to Azure storage, or by completely handling encryption on the client-side. thus not relying on Azure Storage at all for confidentiality guarantees.",
            "guid": "3d90cae2-cc88-4137-86f7-c0cbafe61464",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-service-encryption",
            "service": "Azure Storage",
            "services": [
                "WAF",
                "Storage"
            ],
            "severity": "High",
            "text": "Determine how data at rest should be encrypted. Understand the thread model for data.",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "WAF checklist",
            "guid": "8dd457e9-2713-48b8-8110-2cac6eae01e6",
            "link": "https://learn.microsoft.com/azure/storage/common/customer-managed-keys-overview?toc=%2Fazure%2Fstorage%2Fblobs%2Ftoc.json&bc=%2Fazure%2Fstorage%2Fblobs%2Fbreadcrumb%2Ftoc.json",
            "service": "Azure Storage",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Determine which/if platform encryption should be used.",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "WAF checklist",
            "guid": "e842e52f-4721-4d92-ac1b-1cd521e54a29",
            "link": "https://learn.microsoft.com/azure/storage/blobs/encryption-customer-provided-keys",
            "service": "Azure Storage",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Determine which/if client-side encryption should be used.",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "WAF checklist",
            "description": "Anonymous access may present a security risk. We recommend that you disable anonymous access for optimal security. Disallowing anonymous access helps to prevent data breaches caused by undesired anonymous access.",
            "graph": "resources | where type == 'microsoft.storage/storageaccounts' | extend compliant = (properties.allowBlobPublicAccess == 'false') | distinct id, compliant",
            "guid": "659ae558-b937-4d49-a5e1-112dbd7ba012",
            "link": "https://learn.microsoft.com/azure/storage/blobs/anonymous-read-access-configure?tabs=portal#allow-or-disallow-public-read-access-for-a-storage-account",
            "service": "Azure Storage",
            "services": [
                "WAF",
                "Storage"
            ],
            "severity": "High",
            "text": "Consider whether public blob anonymous access is needed, or whether it can be disabled for certain storage accounts. ",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "WAF checklist",
            "guid": "cb8eb8c0-aa62-4a25-a495-6eaa8dc4a243",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-account-upgrade?tabs=azure-portal",
            "service": "Azure Storage",
            "services": [
                "WAF",
                "Storage"
            ],
            "severity": "High",
            "text": "Leverage a storagev2 account type for better performance and reliability",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "WAF checklist",
            "graph": "resources | where type =~ 'Microsoft.Storage/StorageAccounts' | extend compliant = (sku.name != 'Standard_LRS' and sku.name != 'Premium_LRS') | distinct id, compliant",
            "guid": "e05bbe20-9d49-4fda-9777-8424d116785c",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-redundancy",
            "service": "Azure Storage",
            "services": [
                "WAF",
                "Storage"
            ],
            "severity": "High",
            "text": "Leverage GRS, ZRS or GZRS storage for the highest availability",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "WAF checklist",
            "guid": "2fa56c56-ad48-4408-be72-734c486ba280",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-disaster-recovery-guidance",
            "service": "Azure Storage",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "For write operation after failover, use customer-Managed Failover ",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "WAF checklist",
            "guid": "dc0590cf-65de-48e1-909c-cbd579266bcc",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-disaster-recovery-guidance#microsoft-managed-failover",
            "service": "Azure Storage",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Understand Microsoft-Managed Failover details",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "WAF checklist",
            "guid": "a274faa1-abfe-49d5-9d04-c3c4919cb1b3",
            "link": "https://learn.microsoft.com/azure/storage/blobs/soft-delete-blob-enable?tabs=azure-portal",
            "service": "Azure Storage",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Enable Soft Delete",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.BotService/botServices",
            "checklist": "WAF checklist",
            "guid": "6ad48408-ee72-4734-a476-ba28fdcf590c",
            "link": "https://learn.microsoft.com/en-us/azure/reliability/reliability-bot",
            "service": "Bot service",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Follow reliability support recommendations in Azure Bot Service",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.BotService/botServices",
            "checklist": "WAF checklist",
            "guid": "e65de8e1-3f9c-4cbd-9682-66abca264f9a",
            "link": "https://learn.microsoft.com/en-us/azure/bot-service/bot-builder-concept-regionalization",
            "service": "Bot service",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Deploying bots with local data residency and regional compliance",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.BotService/botServices",
            "checklist": "WAF checklist",
            "guid": "19bfe9d5-5d04-4c3c-9919-ca1b2d1215ae",
            "link": "https://learn.microsoft.com/en-us/azure/reliability/reliability-bot#cross-region-disaster-recovery-in-multi-region-geography",
            "service": "Bot service",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Azure Bot Service runs in active-active mode for both global and regional services. When an outage occurs, you don't need to detect errors or manage the service. Azure Bot Service automatically performs auto failover and auto recovery in a multi-region geographical architecture. For the EU bot regional service, Azure Bot Service provides two full regions inside Europe with active/active replication to ensure redundancy. For the global bot service, all available regions/geographies can be served as the global footprint.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AppPlatform/Spring",
            "checklist": "WAF checklist",
            "guid": "6d8e32a8-3892-479d-a40b-10f6b4f6f298",
            "link": "https://learn.microsoft.com/azure/spring-apps/concepts-blue-green-deployment-strategies",
            "service": "Spring Apps",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Azure Spring Apps permits two deployments for every app, only one of which receives production traffic. You can achieve zero downtime with blue green deployment strategies. Blue green deployment is only available in Standard and Enterprise tiers. You could automate deployment using CI/CD with ADO/GitHub actions",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AppPlatform/Spring",
            "checklist": "WAF checklist",
            "guid": "fbcb40ac-9480-4a6d-bcf4-8081252a6716",
            "link": "https://learn.microsoft.com/azure/architecture/web-apps/spring-apps/architectures/spring-apps-multi-region",
            "service": "Spring Apps",
            "services": [
                "WAF",
                "FrontDoor",
                "TrafficManager"
            ],
            "severity": "Medium",
            "text": "Azure Spring Apps instances could be created in multiple regions for your applications and traffic could be routed by Traffic Manager/Front Door.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AppPlatform/Spring",
            "checklist": "WAF checklist",
            "guid": "ff1ae6a7-9301-4feb-9d11-56cd72f1d4ef",
            "link": "https://learn.microsoft.com/azure/reliability/reliability-spring-apps",
            "service": "Spring Apps",
            "services": [
                "WAF",
                "ACR"
            ],
            "severity": "Medium",
            "text": "In supported region, Azure Spring Apps can be deployed as zone redundant, which means that instances are automatically distributed across availability zones. This feature is only available in Standard and Enterprise tiers.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AppPlatform/Spring",
            "checklist": "WAF checklist",
            "guid": "ffc735ad-fbb1-4802-b43f-ad6387c4c066",
            "link": "https://learn.microsoft.com/azure/spring-apps/concept-understand-app-and-deployment",
            "service": "Spring Apps",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Use more than 1 app instance for your apps",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AppPlatform/Spring",
            "checklist": "WAF checklist",
            "guid": "7504c230-6035-4183-95a5-85762acc6075",
            "link": "https://learn.microsoft.com/azure/spring-apps/diagnostic-services",
            "service": "Spring Apps",
            "services": [
                "WAF",
                "Monitor"
            ],
            "severity": "Medium",
            "text": "Monitor Azure Spring Apps with logs, metrics and tracing. Integrate ASA with application insights and track failures and create workbooks.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AppPlatform/Spring",
            "checklist": "WAF checklist",
            "guid": "1eb48d58-3eec-4ef5-80b0-d2b0dde3f0c6",
            "link": "https://learn.microsoft.com/azure/spring-apps/how-to-configure-enterprise-spring-cloud-gateway",
            "service": "Spring Apps",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Set up autoscaling in Spring Cloud Gateway",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AppPlatform/Spring",
            "checklist": "WAF checklist",
            "guid": "97411607-b6fd-4335-99d1-9885faf4e392",
            "link": "https://learn.microsoft.com/azure/spring-apps/how-to-setup-autoscale",
            "service": "Spring Apps",
            "services": [
                "WAF"
            ],
            "severity": "Low",
            "text": "Enable autoscale for the apps with Standard consumption & dedicated plan.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.AppPlatform/Spring",
            "checklist": "WAF checklist",
            "guid": "dfcaffd1-d27c-4ef2-998d-64c1df3a7ac3",
            "link": "https://learn.microsoft.com/azure/spring-apps/overview",
            "service": "Spring Apps",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Use Enterprise plan for commercial support of spring boot for mission critical apps. With other tiers you get OSS support.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Devices/deviceUpdateServices",
            "checklist": "WAF checklist",
            "guid": "0e03f5ee-4648-423c-bb86-7239480f9171",
            "link": "https://learn.microsoft.com/en-us/azure/iot-dps/iot-dps-ha-dr#high-availability",
            "service": "Device Update for IoT Hub",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Leverage Availability Zones if regionally applicable (this is automatically enabled).",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Devices/deviceUpdateServices",
            "checklist": "WAF checklist",
            "guid": "c0c273bd-00ad-419a-9f2f-fc72fb181e55",
            "link": "https://learn.microsoft.com/en-us/azure/iot-dps/iot-dps-ha-dr#high-availability",
            "service": "Device Update for IoT Hub",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Be aware of Microsoft-initiated failovers. These are exercised by Microsoft in rare situations to fail over all the DPS instances from an affected region to the corresponding geo-paired region.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Devices/deviceUpdateServices",
            "checklist": "WAF checklist",
            "guid": "3af8abe6-07eb-4287-b393-6c4abe3702eb",
            "link": "https://learn.microsoft.com/en-us/azure/logic-apps/business-continuity-disaster-recovery-guidance?toc=%2Fazure%2Freliability%2Ftoc.json&bc=%2Fazure%2Freliability%2Fbreadcrumb%2Ftoc.json",
            "service": "Device Update for IoT Hub",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Consider a Cross-Region DR strategy for critical workloads",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Devices/deviceUpdateServices",
            "checklist": "WAF checklist",
            "guid": "bd91245c-fe32-4e98-a085-794a40f4bfe1",
            "link": "https://learn.microsoft.com/en-us/azure/app-service/environment/intro",
            "service": "Device Update for IoT Hub",
            "services": [
                "WAF",
                "AppSvc"
            ],
            "severity": "High",
            "text": "If deploying to an Isolated environment, use or migrate to App Service Environment (ASE) v3",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Network/virtualNetworks",
            "checklist": "WAF checklist",
            "guid": "7bc1c396-2461-4698-b57f-30ca69525252",
            "link": "https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/ready/considerations/regions",
            "service": "VNet",
            "services": [
                "WAF",
                "ASR"
            ],
            "severity": "Medium",
            "text": "Deploy your Azure landing zone connectivity resources in multiple regions, so that you can quickly support multi-region application landing zones and disaster recovery scenarios.",
            "training": "https://learn.microsoft.com/training/modules/hub-and-spoke-network-architecture/",
            "waf": "Reliability"
        },
        {
            "checklist": "WAF checklist",
            "guid": "70c15989-c726-42c7-b0d3-24b7375b9201",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/multi-tenant/considerations-recommendations",
            "service": "Entra",
            "services": [
                "WAF",
                "Entra"
            ],
            "severity": "Medium",
            "text": "Use one Entra tenant for managing your Azure resources, unless you have a clear regulatory or business requirement for multi-tenants.",
            "training": "https://learn.microsoft.com/training/modules/deploy-resources-scopes-bicep/2-understand-deployment-scopes",
            "waf": "Operations"
        },
        {
            "checklist": "WAF checklist",
            "guid": "6309957b-821a-43d1-b9d9-7fcf1802b747",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/multi-tenant/automation",
            "service": "Entra",
            "services": [
                "WAF",
                "Entra"
            ],
            "severity": "Low",
            "text": "Use Multi-Tenant Automation approach to managing your Microsoft Entra ID Tenants.",
            "training": "https://learn.microsoft.com/entra/architecture/multi-tenant-user-management-introduction/",
            "waf": "Operations"
        },
        {
            "checklist": "WAF checklist",
            "guid": "78e11934-499a-45ed-8ef7-aae5578f0ecf",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/multi-tenant/lighthouse",
            "service": "Entra",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Use Azure Lighthouse for Multi-Tenant Management with the same IDs.",
            "training": "https://learn.microsoft.com/azure/lighthouse/concepts/cross-tenant-management-experience",
            "waf": "Operations"
        },
        {
            "checklist": "WAF checklist",
            "guid": "5d82e6df-6f61-42f2-82e2-3132d293be3d",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-microsoft-customer-agreement#design-recommendations",
            "service": "Entra",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "If you give a partner access to administer your tenant, use Azure Lighthouse.",
            "training": "https://learn.microsoft.com/azure/lighthouse/how-to/onboard-customer",
            "waf": "Cost"
        },
        {
            "checklist": "WAF checklist",
            "guid": "348ef254-c27d-442e-abba-c7571559ab91",
            "link": "https://learn.microsoft.com/azure/role-based-access-control/overview",
            "service": "Entra",
            "services": [
                "WAF",
                "Subscriptions",
                "ACR",
                "RBAC"
            ],
            "severity": "High",
            "text": "Enforce a RBAC model that aligns to your cloud operating model. Scope and Assign across Management Groups and Subscriptions.",
            "training": "https://learn.microsoft.com/learn/paths/implement-resource-mgmt-security/",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "12e7f983-f630-4472-8dd6-9c5b5c2622f5",
            "link": "https://learn.microsoft.com/azure/active-directory/roles/security-planning#identify-microsoft-accounts-in-administrative-roles-that-need-to-be-switched-to-work-or-school-accounts",
            "service": "Entra",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Only use the authentication type Work or school account for all account types. Avoid using the Microsoft account",
            "training": "https://learn.microsoft.com/learn/modules/explore-basic-services-identity-types/",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "4b69bad3-3aad-45e8-a68e-1d76667313b4",
            "link": "https://learn.microsoft.com/azure/active-directory/fundamentals/active-directory-groups-create-azure-portal",
            "service": "Entra",
            "services": [
                "WAF",
                "Entra"
            ],
            "severity": "Medium",
            "text": "Only use groups to assign permissions. Add on-premises groups to the Entra ID only group if a group management system is already in place.",
            "training": "https://learn.microsoft.com/learn/paths/manage-identity-and-access/",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "53e8908a-e28c-484c-93b6-b7808b9fe5c4",
            "link": "https://learn.microsoft.com/azure/active-directory/conditional-access/overview",
            "service": "Entra",
            "services": [
                "WAF",
                "Entra",
                "AzurePolicy"
            ],
            "severity": "High",
            "text": "Enforce Microsoft Entra ID Conditional Access policies for any user with rights to Azure environments.",
            "training": "https://learn.microsoft.com/learn/modules/plan-implement-administer-conditional-access/",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "1049d403-a923-4c34-94d0-0018ac6a9e01",
            "link": "https://learn.microsoft.com/azure/active-directory/authentication/concept-mfa-howitworks",
            "service": "Entra",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Enforce multi-factor authentication for any user with rights to the Azure environments.",
            "training": "https://learn.microsoft.com/entra/identity/authentication/concept-mandatory-multifactor-authentication",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "14658d35-58fd-4772-99b8-21112df27ee4",
            "link": "https://learn.microsoft.com/azure/active-directory/privileged-identity-management/pim-configure",
            "service": "Entra",
            "services": [
                "WAF",
                "Entra"
            ],
            "severity": "Medium",
            "text": "Enforce Microsoft Entra ID Privileged Identity Management (PIM) to establish zero standing access and least privilege.",
            "training": "https://learn.microsoft.com/learn/modules/azure-ad-privileged-identity-management/",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "8b9fe5c4-1049-4d40-9a92-3c3474d00018",
            "link": "https://learn.microsoft.com/entra/identity/domain-services/overview",
            "service": "Entra",
            "services": [
                "WAF",
                "Entra"
            ],
            "severity": "Medium",
            "text": "If planning to switch from Active Directory Domain Services to Entra domain services, evaluate the compatibility of all workloads.",
            "training": "https://learn.microsoft.com/learn/modules/implement-hybrid-identity-windows-server/",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "graph": "resources | where type == 'microsoft.aad/domainservices' | extend replicaSets = properties.replicaSets | where array_length(replicaSets) < 2 | project name=name, id=id, tags=tags, param1=strcat('replicaSetLocation:', replicaSets[0].location)",
            "guid": "0dd4e625-9c4b-4a56-b54a-4357bac12761",
            "link": "https://learn.microsoft.com/entra/identity/domain-services/overview",
            "service": "Entra",
            "services": [
                "WAF",
                "Entra"
            ],
            "severity": "Medium",
            "text": "When using Microsoft Entra Domain Services use replica sets. Replica sets will improve the resiliency of your managed domain and allow you to deploy to additional regions. ",
            "training": "https://learn.microsoft.com/training/modules/understand-azure-active-directory/6-examine-azure-domain-services",
            "waf": "Reliability"
        },
        {
            "checklist": "WAF checklist",
            "guid": "1cf0b8da-70bd-44d0-94af-8d99cfc89ae1",
            "link": "https://learn.microsoft.com/azure/active-directory/reports-monitoring/concept-activity-logs-azure-monitor",
            "service": "Entra",
            "services": [
                "WAF",
                "Entra",
                "Monitor"
            ],
            "severity": "Medium",
            "text": "Integrate Microsoft Entra ID logs with the platform-central Azure Monitor. Azure Monitor allows for a single source of truth around log and monitoring data in Azure, giving organizations a cloud native options to meet requirements around log collection and retention.",
            "training": "https://learn.microsoft.com/entra/identity/monitoring-health/howto-integrate-activity-logs-with-azure-monitor-logs",
            "waf": "Security"
        },
        {
            "ammp": true,
            "checklist": "WAF checklist",
            "guid": "984a859c-773e-47d2-9162-3a765a917e1f",
            "link": "https://learn.microsoft.com/azure/active-directory/roles/security-emergency-access",
            "service": "Entra",
            "services": [
                "WAF",
                "Entra"
            ],
            "severity": "High",
            "text": "Implement an emergency access or break-glass accounts to prevent tenant-wide account lockout. MFA will be turned on by default for all users in Oct 2024. We recommend updating these accounts to use passkey (FIDO2) or configure certificate-based authentication for MFA. ",
            "training": "https://learn.microsoft.com/entra/identity/role-based-access-control/security-emergency-access#exclude-at-least-one-account-from-conditional-access-policies",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "35037e68-9349-4c15-b371-228514f4cdff",
            "link": "https://learn.microsoft.com/azure/active-directory/roles/best-practices",
            "service": "Entra",
            "services": [
                "WAF",
                "Entra",
                "RBAC"
            ],
            "severity": "Medium",
            "text": "Do not use on-premises synced accounts for Microsoft Entra ID role assignments, unless you have a scenario that specifically requires it.",
            "training": "https://learn.microsoft.com/learn/modules/design-identity-security-strategy/",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "d5d1e4e6-1465-48d3-958f-d77249b82111",
            "link": "https://learn.microsoft.com/azure/active-directory/app-proxy/application-proxy",
            "service": "Entra",
            "services": [
                "WAF",
                "Entra"
            ],
            "severity": "Medium",
            "text": "When using Microsoft Entra ID Application Proxy to give remote users access to applications, manage it as a Platform resource as you can only have one instance per tenant.",
            "training": "https://learn.microsoft.com/learn/paths/implement-applications-external-access-azure-ad/",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Network/virtualNetworks",
            "checklist": "WAF checklist",
            "guid": "e8bbac75-7155-49ab-a153-e8908ae28c84",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/enterprise-scale/network-topology-and-connectivity",
            "service": "VNet",
            "services": [
                "WAF",
                "VNet"
            ],
            "severity": "Medium",
            "text": "Use a hub-and-spoke network topology for network scenarios that require maximum flexibility.",
            "training": "https://learn.microsoft.com/learn/paths/architect-network-infrastructure/",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Network/virtualNetworks",
            "checklist": "WAF checklist",
            "guid": "7dd61623-a364-4a90-9eca-e48ebd54cd7d",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/traditional-azure-networking-topology",
            "service": "VNet",
            "services": [
                "WAF",
                "ExpressRoute",
                "Firewall",
                "DNS",
                "Entra",
                "VNet",
                "VPN",
                "NVA"
            ],
            "severity": "High",
            "text": "Deploy shared networking services, including ExpressRoute gateways, VPN gateways, and Azure Firewall or partner NVAs in the central-hub virtual network. If necessary, also deploy DNS services.",
            "training": "https://learn.microsoft.com/training/modules/hub-and-spoke-network-architecture/",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Network/virtualNetworks",
            "checklist": "WAF checklist",
            "guid": "143b16c3-1d7a-4a9b-9470-4489a8042d88",
            "link": "https://learn.microsoft.com/azure/ddos-protection/ddos-protection-overview",
            "service": "VNet",
            "services": [
                "WAF",
                "DDoS"
            ],
            "severity": "High",
            "text": "Use a DDoS Network or IP protection plan for all public IP addresses in application landing zones.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "WAF checklist",
            "guid": "e2e8abac-3571-4559-ab91-53e89f89dc7b",
            "link": "https://learn.microsoft.com/azure/architecture/reference-architectures/dmz/nva-ha",
            "service": "NVA",
            "services": [
                "WAF",
                "NVA"
            ],
            "severity": "Medium",
            "text": "When deploying partner networking technologies or NVAs, follow the partner vendor's guidance.",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "WAF checklist",
            "guid": "ce463dbb-bc8a-4c2a-aebc-92a43da1dae2",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-howto-coexist-resource-manager#to-enable-transit-routing-between-expressroute-and-azure-vpn",
            "service": "ExpressRoute",
            "services": [
                "WAF",
                "ExpressRoute",
                "VPN",
                "ARS"
            ],
            "severity": "Low",
            "text": "If you need transit between ExpressRoute and VPN gateways in hub and spoke scenarios, use Azure Route Server.",
            "training": "https://learn.microsoft.com/training/modules/intro-to-azure-route-server/",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Network/virtualHubs",
            "checklist": "WAF checklist",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,subnets=properties.subnets | mv-expand subnets | project id, subnetName = subnets.name, subnetPrefix = subnets.properties.addressPrefix | extend subnetPrefixLength = split(subnetPrefix, '/')[1] | where subnetName == 'RouteServerSubnet' | extend compliant = (subnetPrefixLength <= 27) | distinct id, compliant",
            "guid": "91b9d7d5-91e1-4dcb-8f1f-fa7e465646cc",
            "link": "https://learn.microsoft.com/azure/route-server/quickstart-configure-route-server-portal#create-a-route-server-1",
            "service": "ARS",
            "services": [
                "WAF",
                "VNet",
                "ARS"
            ],
            "severity": "Low",
            "text": "If using Route Server, use a /27 prefix for the Route Server subnet.",
            "training": "https://learn.microsoft.com/training/modules/intro-to-azure-route-server/",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Network/virtualNetworks",
            "checklist": "WAF checklist",
            "guid": "cc881471-607c-41cc-a0e6-14658dd558f9",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-networks-faq#can-i-create-a-peering-connection-to-a-vnet-in-a-different-region",
            "service": "VNet",
            "services": [
                "WAF",
                "VNet",
                "ACR"
            ],
            "severity": "Medium",
            "text": "For network architectures with multiple hub-and-spoke topologies across Azure regions, use global virtual network peerings between the hub VNets to connect the regions to each other.",
            "training": "https://learn.microsoft.com/learn/paths/azure-administrator-manage-virtual-networks/",
            "waf": "Performance"
        },
        {
            "arm-service": "Microsoft.Network/virtualNetworks",
            "checklist": "WAF checklist",
            "guid": "4722d929-c1b1-4cd6-81f5-4b29bade39ad",
            "link": "https://learn.microsoft.com/azure/azure-monitor/insights/network-insights-overview",
            "service": "VNet",
            "services": [
                "WAF",
                "Monitor"
            ],
            "severity": "Medium",
            "text": "Use Azure Monitor for Networks to monitor the end-to-end state of the networks on Azure.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-network-monitoring/",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.Network/virtualNetworks",
            "checklist": "WAF checklist",
            "graph": "resources | where type == 'microsoft.network/virtualnetworks' | mvexpand properties.virtualNetworkPeerings | summarize peeringcount = count() by id | extend compliant = (peeringcount < 450) | distinct id,compliant",
            "guid": "0e7c28ec-9366-4572-83b0-f4664b1d944a",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits?toc=/azure/virtual-network/toc.json#azure-resource-manager-virtual-networking-limits",
            "service": "VNet",
            "services": [
                "WAF",
                "VNet",
                "ExpressRoute"
            ],
            "severity": "Medium",
            "text": "If you have more than 400 spoke networks in a region, deploy an additional hub to bypass VNet peering limits (500) and the maximum number of prefixes that can be advertised via ExpressRoute (1000).",
            "training": "https://learn.microsoft.com/training/modules/hub-and-spoke-network-architecture/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Network/virtualNetworks",
            "checklist": "WAF checklist",
            "graph": "resources | where type=='microsoft.network/routetables' | mvexpand properties.routes | summarize routeCount = count() by id | extend compliant = (routeCount < 360) | distinct id,compliant",
            "guid": "3d457936-e9b7-41eb-bdff-314b26450b12",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits?toc=/azure/virtual-network/toc.json#azure-resource-manager-virtual-networking-limits",
            "service": "VNet",
            "services": [
                "WAF",
                "Storage"
            ],
            "severity": "Medium",
            "text": "Limit the number of routes per route table to 400.",
            "training": "https://learn.microsoft.com/training/modules/hub-and-spoke-network-architecture/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Network/virtualNetworks",
            "checklist": "WAF checklist",
            "graph": "resources | where type == 'microsoft.network/virtualnetworks' | mvexpand properties.virtualNetworkPeerings | project id, peeringName=properties_virtualNetworkPeerings.name, compliant = (properties_virtualNetworkPeerings.properties.allowVirtualNetworkAccess == True)",
            "guid": "c76cb5a2-abe2-11ed-afa1-0242ac120002",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-network-manage-peering",
            "service": "VNet",
            "services": [
                "WAF",
                "VNet"
            ],
            "severity": "High",
            "text": "Use the setting 'Allow traffic to remote virtual network' when configuring VNet peerings.",
            "training": "https://learn.microsoft.com/training/modules/hub-and-spoke-network-architecture/",
            "waf": "Reliability"
        },
        {
            "checklist": "WAF checklist",
            "graph": "resources | where type == 'microsoft.network/loadbalancers' | where tolower(sku.name) != 'basic' | mv-expand feIPconfigs = properties.frontendIPConfigurations | extend feConfigName = (feIPconfigs.name), PrivateSubnetId = toupper(feIPconfigs.properties.subnet.id), PrivateIPZones = feIPconfigs.zones, PIPid = toupper(feIPconfigs.properties.publicIPAddress.id), JoinID = toupper(id) | where isnotempty(PrivateSubnetId) | where isnull(PrivateIPZones) or array_length(PrivateIPZones) < 2 | project name, feConfigName, id | union (resources | where type == 'microsoft.network/loadbalancers' | where tolower(sku.name) != 'basic' | mv-expand feIPconfigs = properties.frontendIPConfigurations | extend feConfigName = (feIPconfigs.name), PIPid = toupper(feIPconfigs.properties.publicIPAddress.id), JoinID = toupper(id) | where isnotempty(PIPid) | join kind=innerunique ( resources | where type == 'microsoft.network/publicipaddresses' | where isnull(zones) or array_length(zones) < 2 | extend LBid = toupper(substring(properties.ipConfiguration.id, 0, indexof(properties.ipConfiguration.id, '/frontendIPConfigurations'))), InnerID = toupper(id) ) on $left.PIPid == $right.InnerID) | project name, id, tags, param1='Zones: No Zone or Zonal', param2=strcat('Frontend IP Configuration:', ' ', feConfigName)",
            "guid": "9dcd6250-9c4a-4382-aa9b-5b84c64fc1fe",
            "link": "https://learn.microsoft.com/en-us/azure/reliability/reliability-load-balancer?tabs=graph#zone-redundant",
            "service": "Load Balancers",
            "services": [
                "WAF",
                "LoadBalancer"
            ],
            "severity": "High",
            "text": "Use Standard Load Balancer SKU with a zone-redundant deployment, Selecting Standard SKU Load Balancer enhances reliability through availability zones and zone resiliency, ensuring deployments withstand zone and region failures. Unlike Basic, it supports global load balancing and offers an SLA.",
            "waf": "Reliability"
        },
        {
            "checklist": "WAF checklist",
            "graph": "resources | where type =~ 'Microsoft.Network/loadBalancers' | extend bep = properties.backendAddressPools | extend BackEndPools = array_length(bep) | where BackEndPools == 0 | project name, id, Param1='backendPools', Param2=toint(0), tags | union (resources | where type =~ 'Microsoft.Network/loadBalancers' | where sku.name == 'Standard' | extend bep = properties.backendAddressPools | extend BackEndPools = toint(array_length(bep)) | mv-expand bip = properties.backendAddressPools | extend BackendAddresses = array_length(bip.properties.loadBalancerBackendAddresses) | where toint(BackendAddresses) <= 1 | project name, id, tags, Param1='backendAddresses', Param2=toint(BackendAddresses)) | union ( resources | where type =~ 'Microsoft.Network/loadBalancers' | where sku.name == 'Basic' | mv-expand properties.backendAddressPools | extend backendPoolId = properties_backendAddressPools.id | project id, name, tags, tostring(backendPoolId), Param1='BackEndPools' | join kind = leftouter ( resources | where type =~ 'Microsoft.Network/networkInterfaces' | mv-expand properties.ipConfigurations | mv-expand properties_ipConfigurations.properties.loadBalancerBackendAddressPools | extend backendPoolId = tostring(properties_ipConfigurations_properties_loadBalancerBackendAddressPools.id) | summarize poolMembers = count() by backendPoolId | project tostring(backendPoolId), poolMembers ) on backendPoolId | where toint(poolMembers) <= 1 | extend BackendAddresses = poolMembers | project id, name, tags, Param1='backendAddresses', Param2=toint(BackendAddresses))",
            "guid": "48682fb1-1e86-4458-a686-518ebd47393d",
            "link": "https://learn.microsoft.com/en-us/azure/reliability/reliability-load-balancer?tabs=graph#zone-redundant",
            "service": "Load Balancers",
            "services": [
                "WAF",
                "LoadBalancer"
            ],
            "severity": "High",
            "text": "Ensure load balancer backend pool(s) contains at least two instances, Deploying Azure Load Balancers with at least two instances in the backend prevents a single point of failure and supports scalability.",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "WAF checklist",
            "guid": "de0d5973-cd4c-4d21-a088-137f5e6c4cfd",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-howto-macsec",
            "service": "ExpressRoute",
            "services": [
                "WAF",
                "ExpressRoute"
            ],
            "severity": "Medium",
            "text": "When you're using ExpressRoute Direct, configure MACsec in order to encrypt traffic at the layer-two level between the organization's routers and MSEE. The diagram shows this encryption in flow.",
            "training": "https://learn.microsoft.com/training/modules/design-implement-azure-expressroute/",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "WAF checklist",
            "guid": "ed301d6e-872e-452e-9611-cc58b5a4b151",
            "link": "https://learn.microsoft.com/azure/vpn-gateway/site-to-site-vpn-private-peering",
            "service": "ExpressRoute",
            "services": [
                "WAF",
                "ExpressRoute",
                "VPN"
            ],
            "severity": "Medium",
            "text": "For scenarios where MACsec isn't an option (for example, not using ExpressRoute Direct), use a VPN gateway to establish IPsec tunnels over ExpressRoute private peering.",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "WAF checklist",
            "guid": "558fd772-49b8-4211-82df-27ee412e7f98",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-ip-addressing",
            "service": "ExpressRoute",
            "services": [
                "WAF",
                "ACR"
            ],
            "severity": "High",
            "text": "Ensure no overlapping IP address spaces across Azure regions and on-premises locations are used.",
            "training": "https://learn.microsoft.com/learn/paths/architect-network-infrastructure/",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Network/virtualNetworks",
            "checklist": "WAF checklist",
            "graph": "resources | where type == 'microsoft.network/virtualnetworks' | extend addressSpace = todynamic(properties.addressSpace) | extend addressPrefix = todynamic(properties.addressSpace.addressPrefixes) | mvexpand addressSpace | mvexpand addressPrefix | project name, id, location, resourceGroup, subscriptionId, cidr = addressPrefix | extend compliant = (cidr matches regex @'^(10\\\\.|172\\\\.(1[6-9]|2[0-9]|3[01])\\\\.|192\\\\.168\\\\.)')  | project id, compliant, cidr",
            "guid": "3f630472-2dd6-49c5-a5c2-622f54b69bad",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-ip-addressing",
            "service": "VNet",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Use IP addresses from the address allocation ranges for private internets (RFC 1918).",
            "training": "https://learn.microsoft.com/learn/paths/architect-network-infrastructure/",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Network/virtualNetworks",
            "checklist": "WAF checklist",
            "graph": "resources | where type == 'microsoft.network/virtualnetworks' | extend addressSpace = todynamic(properties.addressSpace) | extend addressPrefix = todynamic(properties.addressSpace.addressPrefixes) | mvexpand addressSpace | mvexpand addressPrefix | extend addressMask = split(addressPrefix,'/')[1] | extend compliant = addressMask > 16 | project name, id, subscriptionId, resourceGroup, addressPrefix, compliant",
            "guid": "33aad5e8-c68e-41d7-9667-313b4f5664b5",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-ip-addressing",
            "service": "VNet",
            "services": [
                "WAF",
                "VNet"
            ],
            "severity": "High",
            "text": "Ensure that IP address space isn't wasted, don't create unnecessarily large virtual networks (for example /16).",
            "training": "https://learn.microsoft.com/learn/paths/architect-network-infrastructure/",
            "waf": "Performance"
        },
        {
            "arm-service": "Microsoft.Network/virtualNetworks",
            "checklist": "WAF checklist",
            "guid": "f348ef25-4c27-4d42-b8bb-ac7571559ab9",
            "link": "https://learn.microsoft.com/azure/site-recovery/concepts-on-premises-to-azure-networking#retain-ip-addresses",
            "service": "VNet",
            "services": [
                "WAF",
                "ASR"
            ],
            "severity": "High",
            "text": "Do not use overlapping IP address ranges for production and disaster recovery sites.",
            "training": "https://learn.microsoft.com/learn/paths/az-104-manage-virtual-networks/",
            "waf": "Reliability"
        },
        {
            "checklist": "WAF checklist",
            "graph": "Resources | where type =~ 'Microsoft.Network/publicIPAddresses' and sku.tier =~ 'Regional' | where isempty(zones) or array_length(zones) <= 1 | extend az = case(isempty(zones), 'Non-zonal', array_length(zones) <= 1, strcat('Zonal (', strcat_array(zones, ','), ')'), zones) | project name, id, tags, param1 = strcat('sku: ', sku.name), param2 = strcat('availabilityZone: ', az)",
            "guid": "0c47f486-656d-4699-8c30-edef5b8a93c4",
            "link": "https://learn.microsoft.com/azure/virtual-network/ip-services/public-ip-addresses#availability-zone",
            "service": "Public IP Addresses",
            "services": [
                "WAF",
                "ACR"
            ],
            "severity": "High",
            "text": "Use Standard SKU and Zone-Redundant IPs when applicable, Public IP addresses in Azure can be of standard SKU, available as non-zonal, zonal, or zone-redundant. Zone-redundant IPs are accessible across all zones, resisting any single zone failure, thereby providing higher resilience. ",
            "training": "https://learn.microsoft.com/en-gb/training/modules/configure-virtual-networks/6-create-public-ip-addressing",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Network/dnsZones",
            "checklist": "WAF checklist",
            "guid": "153e8908-ae28-4c84-a33b-6b7808b9fe5c",
            "link": "https://learn.microsoft.com/azure/dns/private-dns-getstarted-portal",
            "service": "DNS",
            "services": [
                "WAF",
                "DNS"
            ],
            "severity": "Medium",
            "text": "For environments where name resolution in Azure is all that's required, use Azure Private DNS for resolution with a delegated zone for name resolution (such as 'azure.contoso.com').",
            "training": "https://learn.microsoft.com/learn/paths/az-104-manage-virtual-networks/",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.Network/dnsZones",
            "checklist": "WAF checklist",
            "guid": "41049d40-3a92-43c3-974d-00018ac6a9e0",
            "link": "https://learn.microsoft.com/azure/dns/dns-private-resolver-overview",
            "service": "DNS",
            "services": [
                "WAF",
                "DNS",
                "ACR"
            ],
            "severity": "Medium",
            "text": "For environments where name resolution across Azure and on-premises is required and there is no existing enterprise DNS service like Active Directory, use Azure DNS Private Resolver to route DNS requests to Azure or to on-premises DNS servers.",
            "training": "https://learn.microsoft.com/training/modules/intro-to-azure-dns-private-resolver/",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Network/dnsZones",
            "checklist": "WAF checklist",
            "guid": "1e6a83de-5de3-42c1-a924-81607d5d1e4e",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-networks-name-resolution-for-vms-and-role-instances",
            "service": "DNS",
            "services": [
                "WAF",
                "DNS"
            ],
            "severity": "Low",
            "text": "Special workloads that require and deploy their own DNS (such as Red Hat OpenShift) should use their preferred DNS solution.",
            "training": "https://learn.microsoft.com/training/courses/az-700t00",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.Network/dnsZones",
            "checklist": "WAF checklist",
            "guid": "614658d3-558f-4d77-849b-821112df27ee",
            "link": "https://learn.microsoft.com/azure/dns/private-dns-autoregistration",
            "service": "DNS",
            "services": [
                "WAF",
                "VNet",
                "DNS",
                "VM"
            ],
            "severity": "High",
            "text": "Enable auto-registration for Azure DNS to automatically manage the lifecycle of the DNS records for the virtual machines deployed within a virtual network.",
            "training": "https://learn.microsoft.com/learn/paths/az-104-manage-virtual-networks/",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.Network/dnsZones",
            "checklist": "WAF checklist",
            "guid": "18c80eb0-582a-4198-bf5c-d8800b2d263b",
            "link": "https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/ready/azure-best-practices/private-link-and-dns-integration-at-scale#private-link-and-dns-integration-in-hub-and-spoke-network-architectures",
            "service": "DNS",
            "services": [
                "WAF",
                "DNS"
            ],
            "severity": "Medium",
            "text": "Implement a plan for managing DNS resolution between multiple Azure regions and when services fail over to another region",
            "training": "https://learn.microsoft.com/learn/paths/az-104-manage-virtual-networks/",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/bastionHosts",
            "checklist": "WAF checklist",
            "guid": "ee1ac551-c4d5-46cf-b035-d0a3c50d87ad",
            "link": "https://learn.microsoft.com/azure/bastion/bastion-overview",
            "service": "Bastion",
            "services": [
                "WAF",
                "Bastion"
            ],
            "severity": "Medium",
            "text": "Use Azure Bastion to securely connect to your network.",
            "training": "https://learn.microsoft.com/training/modules/intro-to-azure-bastion/",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.network/bastionHosts",
            "checklist": "WAF checklist",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,subnets=properties.subnets | mv-expand subnets | project id, subnetName = subnets.name, subnetPrefix = subnets.properties.addressPrefix | extend subnetPrefixLength = split(subnetPrefix, '/')[1] | where subnetName == 'AzureBastionSubnet' | extend compliant = (subnetPrefixLength <= 26) | distinct id, compliant",
            "guid": "6eab9eb6-762b-485e-8ea8-15aa5dba0bd0",
            "link": "https://learn.microsoft.com/azure/bastion/bastion-faq#subnet",
            "service": "Bastion",
            "services": [
                "WAF",
                "VNet",
                "Bastion"
            ],
            "severity": "Medium",
            "text": "Use Azure Bastion in a subnet /26 or larger.",
            "training": "https://learn.microsoft.com/training/modules/intro-to-azure-bastion/",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.network/frontdoorwebApplicationFirewalls",
            "checklist": "WAF checklist",
            "guid": "1d7aa9b6-4704-4489-a804-2d88e79d17b7",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/afds-overview",
            "service": "WAF",
            "services": [
                "WAF",
                "ACR",
                "AzurePolicy",
                "FrontDoor"
            ],
            "severity": "Medium",
            "text": "Use Azure Front Door and WAF policies to provide global protection across Azure regions for inbound HTTP/S connections to a landing zone.",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.network/frontdoorwebApplicationFirewalls",
            "checklist": "WAF checklist",
            "guid": "3b22a5a6-7e7a-48ed-9b30-e38c3f29812b",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "service": "WAF",
            "services": [
                "WAF",
                "AzurePolicy",
                "FrontDoor",
                "AppGW"
            ],
            "severity": "Low",
            "text": "When using Azure Front Door and Azure Application Gateway to help protect HTTP/S apps, use WAF policies in Azure Front Door. Lock down Azure Application Gateway to receive traffic only from Azure Front Door.",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.network/frontdoorwebApplicationFirewalls",
            "checklist": "WAF checklist",
            "guid": "2363cefe-179b-4599-be0d-5973cd4cd21b",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "service": "WAF",
            "services": [
                "WAF",
                "VNet"
            ],
            "severity": "High",
            "text": "When WAFs and other reverse proxies are required for inbound HTTP/S connections, deploy them within a landing-zone virtual network and together with the apps that they're protecting and exposing to the internet.",
            "training": "https://learn.microsoft.com/learn/paths/architect-network-infrastructure/",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Network/virtualNetworks",
            "checklist": "WAF checklist",
            "guid": "088137f5-e6c4-4cfd-9e50-4547c2447ec6",
            "link": "https://learn.microsoft.com/azure/ddos-protection/ddos-protection-reference-architectures",
            "service": "VNet",
            "services": [
                "WAF",
                "VNet",
                "DDoS"
            ],
            "severity": "High",
            "text": "Use Azure DDoS Network or IP Protection plans to help protect Public IP Addresses endpoints within the virtual networks.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Network/virtualNetworks",
            "checklist": "WAF checklist",
            "guid": "b034c01e-110b-463a-b36e-e3346e57f225",
            "link": "https://learn.microsoft.com/azure/virtual-network/ip-services/default-outbound-access",
            "service": "VNet",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Plan for how to manage your network outbound traffic configuration and strategy before the upcoming breaking change. On September 30, 2025, default outbound access for new deployments will be retired and only explicit access configurations will be allowed.",
            "training": "https://learn.microsoft.com/training/modules/configure-virtual-networks/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Network/virtualNetworks",
            "checklist": "WAF checklist",
            "guid": "b1c82a3f-2320-4dfa-8972-7ae4823c8930",
            "link": "https://learn.microsoft.com/azure/ddos-protection/ddos-protection-reference-architectures",
            "service": "VNet",
            "services": [
                "WAF",
                "DDoS"
            ],
            "severity": "High",
            "text": "Add diagnostic settings to save DDoS related logs for all the protected public IP addresses (DDoS IP or Network Protection).",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Authorization/policyDefinitions",
            "checklist": "WAF checklist",
            "guid": "3c5a808d-c695-4c14-a63c-c7ab7a510e41",
            "link": "https://github.com/Azure/Enterprise-Scale/wiki/ALZ-Policies#corp",
            "service": "Policy",
            "services": [
                "WAF",
                "AzurePolicy",
                "VM"
            ],
            "severity": "High",
            "text": "Ensure there is a policy assignment to deny Public IP addresses directly tied to Virtual Machines.  Use exclusions if public IPs are needed on specific VMs.",
            "training": "https://learn.microsoft.com/training/modules/configure-azure-policy/",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "WAF checklist",
            "guid": "359c373e-7dd6-4162-9a36-4a907ecae48e",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/connectivity-to-azure",
            "service": "ExpressRoute",
            "services": [
                "WAF",
                "ExpressRoute",
                "VPN",
                "Backup"
            ],
            "severity": "Medium",
            "text": "Use ExpressRoute as the primary connection to Azure.  Use VPNs as a source of backup connectivity.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Performance"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "WAF checklist",
            "description": "You can use AS-path prepending and connection weights to influence traffic from Azure to on-premises, and the full range of BGP attributes in your own routers to influence traffic from on-premises to Azure.",
            "guid": "f29812b2-363c-4efe-879b-599de0d5973c",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-routing",
            "service": "ExpressRoute",
            "services": [
                "WAF",
                "ExpressRoute"
            ],
            "severity": "Medium",
            "text": "When you use multiple ExpressRoute circuits or multiple on-prem locations, use BGP attributes to optimize routing.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "WAF checklist",
            "graph": "resources| where type == 'microsoft.network/virtualnetworkgateways'| where properties.gatewayType =~ 'vpn' or properties.gatewayType == 'ExpressRoute'| extend SKUName = properties.sku.name, SKUTier = properties.sku.tier, Type = properties.gatewayType| extend compliant = SKUTier !in ('Basic', 'Standard')| project name, id, subscriptionId, resourceGroup, compliant",
            "guid": "d4cd21b0-8813-47f5-b6c4-cfd3e504547c",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-about-virtual-network-gateways?source=recommendations#gwsku",
            "service": "ExpressRoute",
            "services": [
                "WAF",
                "ExpressRoute",
                "VPN"
            ],
            "severity": "Medium",
            "text": "Select the right SKU for the ExpressRoute/VPN gateways based on bandwidth and performance requirements.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Performance"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "WAF checklist",
            "graph": "resources | where type=='microsoft.network/expressroutecircuits' | extend compliant = (tolower(sku.family) == 'metereddata' or tolower(sku.tier) == 'local') | distinct id,compliant",
            "guid": "7025b442-f6e9-4af6-b11f-c9574916016f",
            "link": "https://learn.microsoft.com/azure/expressroute/plan-manage-cost",
            "service": "ExpressRoute",
            "services": [
                "WAF",
                "ExpressRoute",
                "Cost"
            ],
            "severity": "High",
            "text": "Ensure that you're using unlimited-data ExpressRoute circuits only if you reach the bandwidth that justifies their cost.",
            "training": "https://learn.microsoft.com/training/modules/design-implement-azure-expressroute/",
            "waf": "Cost"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "WAF checklist",
            "graph": "resources | where type=='microsoft.network/connections' | where properties.connectionType == 'ExpressRoute' | project id, gwid=tostring(properties.virtualNetworkGateway1.id), circuitid=tostring(properties.peer.id) | join (resources | where type=='microsoft.network/expressroutecircuits' | project circuitid=tostring(id), circuitsku=sku.tier) on circuitid | project id=gwid, compliant = (circuitsku == 'Local') | summarize compliant=max(compliant) by id",
            "guid": "f4e7926a-ec35-476e-a412-5dd17136bd62",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-faqs#expressroute-local",
            "service": "ExpressRoute",
            "services": [
                "WAF",
                "ExpressRoute",
                "Cost"
            ],
            "severity": "High",
            "text": "Leverage the Local SKU of ExpressRoute to reduce the cost of your circuits, if your circuit peering location supports your Azure regions for the Local SKU.",
            "training": "https://learn.microsoft.com/training/modules/design-implement-azure-expressroute/",
            "waf": "Cost"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "WAF checklist",
            "graph": "resources| where type == 'microsoft.network/virtualnetworkgateways'| where properties.gatewayType =~ 'vpn' or properties.gatewayType == 'ExpressRoute'| extend SKUName = properties.sku.name, SKUTier = properties.sku.tier, Type = properties.gatewayType| extend compliant = SKUTier contains 'AZ'| project name, id, subscriptionId, resourceGroup, Type, compliant",
            "guid": "2447ec66-138a-4720-8f1c-e16ed301d6e8",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-about-virtual-network-gateways",
            "service": "ExpressRoute",
            "services": [
                "WAF",
                "ExpressRoute"
            ],
            "severity": "Medium",
            "text": "Deploy a zone-redundant ExpressRoute gateway in the supported Azure regions.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "WAF checklist",
            "guid": "72e52e36-11cc-458b-9a4b-1511e43a58a9",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/connectivity-to-azure",
            "service": "ExpressRoute",
            "services": [
                "WAF",
                "ExpressRoute"
            ],
            "severity": "Medium",
            "text": "For scenarios that require bandwidth higher than 10 Gbps or dedicated 10/100-Gbps ports, use ExpressRoute Direct.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Performance"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "WAF checklist",
            "guid": "c2299c4d-7b57-4d0c-9555-62f2b3e4563a",
            "link": "https://learn.microsoft.com/azure/expressroute/about-fastpath",
            "service": "ExpressRoute",
            "services": [
                "WAF",
                "ExpressRoute"
            ],
            "severity": "Medium",
            "text": "When low latency is required, or throughput from on-premises to Azure must be greater than 10 Gbps, enable FastPath to bypass the ExpressRoute gateway from the data path.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Performance"
        },
        {
            "arm-service": "microsoft.network/virtualNetworkGateways",
            "checklist": "WAF checklist",
            "graph": "resources | where type=='microsoft.network/virtualnetworkgateways' | where properties.gatewayType == 'Vpn' | extend compliant = (tolower(properties.sku.name) contains 'az') | distinct id, compliant",
            "guid": "4d873974-8b66-42d6-b15f-512a65498f6d",
            "link": "https://learn.microsoft.com/azure/vpn-gateway/create-zone-redundant-vnet-gateway",
            "service": "VPN",
            "services": [
                "WAF",
                "VPN"
            ],
            "severity": "Medium",
            "text": "Use zone-redundant VPN gateways to connect branches or remote locations to Azure (where available).",
            "training": "https://learn.microsoft.com/training/modules/intro-to-azure-vpn-gateway/",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/virtualNetworkGateways",
            "checklist": "WAF checklist",
            "guid": "45866df8-cf85-4ca9-bbe2-65ec1478919e",
            "link": "https://learn.microsoft.com/azure/vpn-gateway/vpn-gateway-highlyavailable",
            "service": "VPN",
            "services": [
                "WAF",
                "VPN"
            ],
            "severity": "Medium",
            "text": "Use redundant VPN appliances on-premises (active/active or active/passive).",
            "training": "https://learn.microsoft.com/training/modules/intro-to-azure-vpn-gateway/",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "WAF checklist",
            "guid": "718cb437-b060-2589-8856-2e93a5c6633b",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-erdirect-about",
            "service": "ExpressRoute",
            "services": [
                "WAF",
                "ExpressRoute",
                "Cost"
            ],
            "severity": "High",
            "text": "If using ExpressRoute Direct, consider using ExpressRoute Local circuits to the local Azure regions to save costs.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Cost"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "WAF checklist",
            "guid": "8042d88e-79d1-47b7-9b22-a5a67e7a8ed4",
            "link": "https://learn.microsoft.com/azure/architecture/framework/services/networking/expressroute/reliability",
            "service": "ExpressRoute",
            "services": [
                "WAF",
                "ExpressRoute"
            ],
            "severity": "Medium",
            "text": "When traffic isolation or dedicated bandwidth is required, such as for separating production and nonproduction environments, use different ExpressRoute circuits. It will help you ensure isolated routing domains and alleviate noisy-neighbor risks.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "WAF checklist",
            "guid": "b30e38c3-f298-412b-8363-cefe179b599d",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-monitoring-metrics-alerts",
            "service": "ExpressRoute",
            "services": [
                "WAF",
                "ExpressRoute",
                "Monitor"
            ],
            "severity": "Medium",
            "text": "Monitor ExpressRoute availability and utilization using built-in Express Route Insights.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "WAF checklist",
            "guid": "5bf68dc9-325e-4873-bf88-f8214ef2e5d2",
            "link": "https://learn.microsoft.com/azure/expressroute/how-to-configure-connection-monitor",
            "service": "ExpressRoute",
            "services": [
                "WAF",
                "ACR",
                "NetworkWatcher",
                "Monitor"
            ],
            "severity": "Medium",
            "text": "Use Connection Monitor for connectivity monitoring across the network, especially between on-premises and Azure.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "WAF checklist",
            "graph": "resources | where type=='microsoft.network/connections' | where properties.connectionType == 'ExpressRoute' | project cxId=id, gwId=tostring(properties.virtualNetworkGateway1.id), circuitId=tostring(properties.peer.id) | join (resources | where type=='microsoft.network/expressroutecircuits' | project circuitId=tostring(id), circuitLocation=tostring(properties.serviceProviderProperties.peeringLocation)) on circuitId | distinct gwId, circuitLocation | summarize countErLocations=count() by id=gwId | extend compliant = (countErLocations >= 2)",
            "guid": "e0d5973c-d4cd-421b-8881-37f5e6c4cfd3",
            "link": "https://learn.microsoft.com/azure/expressroute/designing-for-disaster-recovery-with-expressroute-privatepeering#need-for-redundant-connectivity-solution",
            "service": "ExpressRoute",
            "services": [
                "WAF",
                "ExpressRoute"
            ],
            "severity": "Medium",
            "text": "Use ExpressRoute circuits from different peering locations for redundancy.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "WAF checklist",
            "guid": "cf3fe65c-fec0-495a-8edc-9675200f2add",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-howto-coexist-resource-manager",
            "service": "ExpressRoute",
            "services": [
                "WAF",
                "ExpressRoute",
                "VPN"
            ],
            "severity": "Medium",
            "text": "Use site-to-site VPN as failover of ExpressRoute, if only using a single ExpressRoute circuit.",
            "training": "https://learn.microsoft.com/training/modules/design-implement-azure-expressroute/",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "WAF checklist",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,resourceGroup,name,subnets=properties.subnets | mv-expand subnets | project id,resourceGroup,name,subnetName=tostring(subnets.name),routeTableId=tostring(subnets.properties.routeTable.id) | where subnetName == 'GatewaySubnet' | join kind=leftouter (Resources | where type == 'microsoft.network/routetables' | project routeTableName=name,routeTableId=id, disableBgpRoutePropagation=properties.disableBgpRoutePropagation) on routeTableId | project id,compliant = (disableBgpRoutePropagation == False or isnull(disableBgpRoutePropagation))",
            "guid": "72105cc8-aaea-4ee1-8c7a-ad25977afcaf",
            "link": "https://learn.microsoft.com/azure/vpn-gateway/vpn-gateway-about-vpn-gateway-settings#gwsub",
            "service": "ExpressRoute",
            "services": [
                "WAF",
                "VNet",
                "Storage"
            ],
            "severity": "High",
            "text": "If you are using a route table in the GatewaySubnet, make sure that gateway routes are propagated.",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "WAF checklist",
            "guid": "d581a947-69a2-4783-942e-9df3664324c8",
            "link": "https://learn.microsoft.com/azure/expressroute/designing-for-high-availability-with-expressroute#active-active-connections",
            "service": "ExpressRoute",
            "services": [
                "WAF",
                "ACR",
                "ExpressRoute"
            ],
            "severity": "High",
            "text": "If using ExpressRoute, your on-premises routing should be dynamic: in the event of a connection failure it should converge to the remaining connection of the circuit. Load should be shared across both connections ideally as active/active, although active/passive is supported too.",
            "training": "https://learn.microsoft.com/training/modules/design-implement-azure-expressroute/",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "WAF checklist",
            "guid": "b258f058-b9f6-46cd-b28d-990106f0c3f8",
            "link": "https://learn.microsoft.com/azure/expressroute/designing-for-high-availability-with-expressroute",
            "service": "ExpressRoute",
            "services": [
                "WAF",
                "ExpressRoute"
            ],
            "severity": "Medium",
            "text": "Ensure the two physical links of your ExpressRoute circuit are connected to two distinct edge devices in your network.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "WAF checklist",
            "guid": "fe2a1b53-6fbd-4c67-b58a-85d7c7a0afcb",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-bfd",
            "service": "ExpressRoute",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Ensure Bidirectional Forwarding Detection (BFD) is enabled and configured on customer or provider edge routing devices.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "WAF checklist",
            "guid": "669b215a-ce43-4371-8f6f-11047f6490f1",
            "link": "https://learn.microsoft.com/azure/expressroute/designing-for-disaster-recovery-with-expressroute-privatepeering",
            "service": "ExpressRoute",
            "services": [
                "WAF",
                "ExpressRoute"
            ],
            "severity": "High",
            "text": "Connect the ExpressRoute Gateway to two or more circuits from different peering locations for higher resiliency.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "WAF checklist",
            "guid": "3f79ed00-203b-4c95-9efd-691505f5a1f9",
            "link": "https://learn.microsoft.com/azure/vpn-gateway/vpn-gateway-howto-setup-alerts-virtual-network-gateway-log",
            "service": "ExpressRoute",
            "services": [
                "WAF",
                "VNet",
                "ExpressRoute",
                "Monitor"
            ],
            "severity": "Medium",
            "text": "Configure diagnostic logs and alerts for ExpressRoute virtual network gateway.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "WAF checklist",
            "guid": "5234c93f-b651-41dd-80c1-234177b91ced",
            "link": "https://learn.microsoft.com/azure/expressroute/virtual-network-connectivity-guidance",
            "service": "ExpressRoute",
            "services": [
                "WAF",
                "VNet",
                "ExpressRoute"
            ],
            "severity": "Medium",
            "text": "Do not use ExpressRoute circuits for VNet-to-VNet communication.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Performance"
        },
        {
            "checklist": "WAF checklist",
            "guid": "8ac6a9e0-1e6a-483d-b5de-32c199248160",
            "link": "https://learn.microsoft.com/azure/virtual-wan/virtual-wan-about",
            "service": "N/A",
            "services": [
                "WAF",
                "ACR"
            ],
            "severity": "Low",
            "text": "Do not send Azure traffic to hybrid locations for inspection.  Instead, follow the principle 'traffic in Azure stays in Azure' so that communication across resources in Azure occurs via the Microsoft backbone network.",
            "waf": "Performance"
        },
        {
            "arm-service": "Microsoft.Network/azureFirewalls",
            "checklist": "WAF checklist",
            "guid": "e6c4cfd3-e504-4547-a244-7ec66138a720",
            "link": "https://learn.microsoft.com/azure/firewall/overview",
            "service": "Firewall",
            "services": [
                "WAF",
                "Firewall"
            ],
            "severity": "High",
            "text": "Use Azure Firewall to govern Azure outbound traffic to the internet, non-HTTP/S inbound connections, and East/West traffic filtering (if the organization requires it).",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Network/azureFirewalls",
            "checklist": "WAF checklist",
            "guid": "5a4b1511-e43a-458a-ac22-99c4d7b57d0c",
            "link": "https://learn.microsoft.com/azure/firewall-manager/policy-overview",
            "service": "Firewall",
            "services": [
                "WAF",
                "Firewall",
                "AzurePolicy",
                "RBAC",
                "ACR"
            ],
            "severity": "Medium",
            "text": "Create a global Azure Firewall policy to govern security posture across the global network environment and assign it to all Azure Firewall instances. Allow for granular policies to meet requirements of specific regions by delegating incremental firewall policies to local security teams via Azure role-based access control.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Network/azureFirewalls",
            "checklist": "WAF checklist",
            "guid": "655562f2-b3e4-4563-a4d8-739748b662d6",
            "link": "https://learn.microsoft.com/azure/firewall-manager/deploy-trusted-security-partner",
            "service": "Firewall",
            "services": [
                "WAF",
                "Firewall"
            ],
            "severity": "Low",
            "text": "Configure supported partner SaaS security providers within Firewall Manager if the organization wants to use such solutions to help protect outbound connections.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Network/azureFirewalls",
            "checklist": "WAF checklist",
            "graph": "resources | where type=='microsoft.network/firewallpolicies' | extend compliant = (properties.dnsSettings.enableProxy == true) | distinct id,compliant",
            "guid": "14d99880-2f88-47e8-a134-62a7d85c94af",
            "link": "https://learn.microsoft.com/azure/firewall/fqdn-filtering-network-rules",
            "service": "Firewall",
            "services": [
                "WAF",
                "DNS",
                "Firewall"
            ],
            "severity": "High",
            "text": "Use application rules to filter outbound traffic on destination host name for supported protocols.  Use FQDN-based network rules and Azure Firewall with DNS proxy to filter egress traffic to the Internet over other protocols.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Network/azureFirewalls",
            "checklist": "WAF checklist",
            "graph": "resources | where type=='microsoft.network/firewallpolicies' | extend compliant = (properties.sku.tier == 'Premium') | distinct id,compliant",
            "guid": "c10d51ef-f999-455d-bba0-5c90ece07447",
            "link": "https://learn.microsoft.com/azure/firewall/premium-features",
            "service": "Firewall",
            "services": [
                "WAF",
                "Firewall"
            ],
            "severity": "High",
            "text": "Use Azure Firewall Premium to enable additional security features.",
            "training": "https://learn.microsoft.com/training/modules/introduction-azure-firewall/",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Network/azureFirewalls",
            "checklist": "WAF checklist",
            "graph": "resources | where type=='microsoft.network/firewallpolicies' | extend compliant = (properties.threatIntelMode == 'Deny') | distinct id,compliant",
            "guid": "e9c8f584-6d5e-473b-8dc5-acc9fbaab4e3",
            "link": "https://learn.microsoft.com/azure/firewall/premium-features#idps-signature-rules",
            "service": "Firewall",
            "services": [
                "WAF",
                "Firewall"
            ],
            "severity": "High",
            "text": "Configure Azure Firewall Threat Intelligence mode to Alert and Deny for additional protection.",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Network/azureFirewalls",
            "checklist": "WAF checklist",
            "graph": "resources | where type=='microsoft.network/firewallpolicies' | extend compliant = (properties.intrusionDetection.mode == 'Deny') | project id, compliant",
            "guid": "b9d0dff5-bdd4-4cd8-88ed-5811610b2b2c",
            "link": "https://learn.microsoft.com/azure/firewall/premium-features#idps",
            "service": "Firewall",
            "services": [
                "WAF",
                "Firewall"
            ],
            "severity": "High",
            "text": "Configure Azure Firewall IDPS mode to Deny for additional protection.",
            "training": "https://learn.microsoft.com/training/modules/introduction-azure-firewall/",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Network/azureFirewalls",
            "checklist": "WAF checklist",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,resourceGroup,name,subnets=properties.subnets | mv-expand subnets | project id,name,subnetId=tostring(subnets.id), subnetName=tostring(subnets.name),subnetRT=subnets.properties.routeTable.id | where not (subnetName in ('GatewaySubnet', 'AzureFirewallSubnet', 'RouteServerSubnet', 'AzureBastionSubnet')) | extend hasRT = isnotnull(subnetRT) | distinct id, hasRT, subnetId | join kind=fullouter (resources | where type == 'microsoft.network/virtualnetworks' | mvexpand properties.virtualNetworkPeerings | extend isVWAN=(tolower(split(properties_virtualNetworkPeerings.name, '_')[0]) == 'remotevnettohubpeering') | mv-expand properties.subnets | project id, isVWAN, name, subnetId=tostring(properties_subnets.id), subnetName=tostring(properties_subnets.name) | summarize PeeredToVWAN=max(isVWAN) by id, subnetId | project id, subnetId, isVWANpeer = (PeeredToVWAN == true)) on subnetId | project id=iff(isnotempty(id), id, id1), subnetId=iff(isnotempty(subnetId), subnetId, subnetId1), hasRT, isVWANpeer | extend compliant = (hasRT==true or isVWANpeer==true) | distinct id, subnetId, compliant",
            "guid": "a3784907-9836-4271-aafc-93535f8ec08b",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-networks-udr-overview",
            "service": "Firewall",
            "services": [
                "WAF",
                "Firewall",
                "VNet",
                "VWAN",
                "NVA",
                "Storage"
            ],
            "severity": "High",
            "text": "For subnets in VNets not connected to Virtual WAN, attach a route table so that Internet traffic is redirected to Azure Firewall or a Network Virtual Appliance.",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Network/azureFirewalls",
            "checklist": "WAF checklist",
            "guid": "715d833d-4708-4527-90ac-1b142c7045ba",
            "link": "https://learn.microsoft.com/azure/firewall/firewall-structured-logs",
            "service": "Firewall",
            "services": [
                "WAF",
                "Firewall",
                "Storage"
            ],
            "severity": "Medium",
            "text": "Add diagnostic settings to save logs, using the Resource Specific destination table, for all Azure Firewall deployments.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.Network/azureFirewalls",
            "checklist": "WAF checklist",
            "guid": "e960fc6b-4ab2-4db6-9609-3745135f9ffa",
            "link": "https://learn.microsoft.com/azure/firewall-manager/migrate-to-policy",
            "service": "Firewall",
            "services": [
                "WAF",
                "AzurePolicy",
                "Firewall"
            ],
            "severity": "Important",
            "text": "Migrate from Azure Firewall Classic rules (if exist) to Firewall Policy.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.Network/azureFirewalls",
            "checklist": "WAF checklist",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,subnets=properties.subnets | mv-expand subnets | project id, subnetName = subnets.name, subnetPrefix = subnets.properties.addressPrefix | extend subnetPrefixLength = split(subnetPrefix, '/')[1] | where subnetName == 'AzureFirewallSubnet' | extend compliant = (subnetPrefixLength == 26) | distinct id, compliant",
            "guid": "22d6419e-b627-4d95-9e7d-019fa759387f",
            "link": "https://learn.microsoft.com/azure/firewall/firewall-faq#why-does-azure-firewall-need-a--26-subnet-size",
            "service": "Firewall",
            "services": [
                "WAF",
                "VNet",
                "Firewall"
            ],
            "severity": "High",
            "text": "Use a /26 prefix for your Azure Firewall subnets.",
            "training": "https://learn.microsoft.com/training/modules/introduction-azure-firewall/",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Network/azureFirewalls",
            "checklist": "WAF checklist",
            "guid": "828cec2e-af6c-40c2-8fa2-1b681ee63eb7",
            "link": "https://learn.microsoft.com/azure/firewall-manager/rule-hierarchy",
            "service": "Firewall",
            "services": [
                "WAF",
                "AzurePolicy"
            ],
            "severity": "Medium",
            "text": "Arrange rules within the firewall policy into Rule Collection Groups and Rule Collections and based on their frequency of use.",
            "training": "https://learn.microsoft.com/training/modules/intro-to-azure-firewall-manager/",
            "waf": "Performance"
        },
        {
            "arm-service": "Microsoft.Network/azureFirewalls",
            "checklist": "WAF checklist",
            "guid": "0da83bb1-2f39-49af-b5c9-835fc455e3d1",
            "link": "https://learn.microsoft.com/azure/firewall/ip-groups",
            "service": "Firewall",
            "services": [
                "WAF",
                "Storage"
            ],
            "severity": "Medium",
            "text": "Use IP Groups or IP prefixes to reduce number of IP table rules.",
            "waf": "Performance"
        },
        {
            "arm-service": "Microsoft.Network/azureFirewalls",
            "checklist": "WAF checklist",
            "guid": "c44c6f0e-1642-4a61-a17b-0922f835c93a",
            "link": "https://learn.microsoft.com/azure/firewall/tutorial-firewall-dnat",
            "service": "Firewall",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Do not use wildcards as a source IP for DNATS, such as * or any, you should specify source IPs for incoming DNATs.",
            "training": "https://learn.microsoft.com/training/modules/introduction-to-azure-virtual-networks/",
            "waf": "Performance"
        },
        {
            "arm-service": "Microsoft.Network/azureFirewalls",
            "checklist": "WAF checklist",
            "guid": "7371dc21-251a-47a3-af14-6e01b9da4757",
            "link": "https://learn.microsoft.com/azure/firewall/integrate-with-nat-gateway",
            "service": "Firewall",
            "services": [
                "WAF",
                "Monitor"
            ],
            "severity": "Medium",
            "text": "Prevent SNAT Port exhaustion by monitoring SNAT port usage, evaluating NAT Gateway settings, and ensuring seamless failover. If the port count approaches the limit, it’s a sign that SNAT exhaustion might be imminent.",
            "training": "https://learn.microsoft.com/training/modules/introduction-to-azure-virtual-networks/",
            "waf": "Performance"
        },
        {
            "arm-service": "Microsoft.Network/azureFirewalls",
            "checklist": "WAF checklist",
            "guid": "346840b8-1064-496e-8396-4b1340172d52",
            "link": "https://learn.microsoft.com/azure/firewall/premium-features#tls-inspection",
            "service": "Firewall",
            "services": [
                "WAF",
                "Firewall"
            ],
            "severity": "High",
            "text": "If you are using Azure Firewall Premium, enable TLS Inspection.",
            "waf": "Performance"
        },
        {
            "arm-service": "Microsoft.Network/azureFirewalls",
            "checklist": "WAF checklist",
            "guid": "39990a13-915c-45f9-a2d3-562d7d6c4b7c",
            "link": "https://learn.microsoft.com/azure/firewall/premium-features#web-categories",
            "service": "Firewall",
            "services": [
                "WAF",
                "ServiceBus"
            ],
            "severity": "Low",
            "text": "Use web categories to allow or deny outbound access to specific topics.",
            "waf": "Performance"
        },
        {
            "arm-service": "Microsoft.Network/azureFirewalls",
            "checklist": "WAF checklist",
            "guid": "6eff7e6c-6c4a-43d7-be3f-6641c2cb3d4a",
            "link": "https://learn.microsoft.com/azure/architecture/example-scenario/gateway/application-gateway-before-azure-firewall",
            "service": "Firewall",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "As part of your TLS inspection, plan for receiving traffic from Azure App Gateways for inspection.",
            "training": "https://learn.microsoft.com/training/modules/configure-azure-application-gateway/",
            "waf": "Performance"
        },
        {
            "arm-service": "Microsoft.Network/azureFirewalls",
            "checklist": "WAF checklist",
            "graph": "resources | where type =~ 'Microsoft.Network/firewallPolicies' | where array_length(properties.firewalls) > 0 | extend compliant = (properties.dnsSettings.enableProxy =~ 'true') | distinct id, compliant",
            "guid": "94f3eede-9aa3-4088-92a3-bb9a56509fad",
            "link": "https://learn.microsoft.com/azure/firewall/dns-details",
            "service": "Firewall",
            "services": [
                "WAF",
                "DNS",
                "Firewall"
            ],
            "severity": "Medium",
            "text": "Enable Azure Firewall DNS proxy configuration.",
            "training": "https://learn.microsoft.com/training/courses/az-700t00/",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Network/azureFirewalls",
            "checklist": "WAF checklist",
            "guid": "1dc04554-dece-4ffb-a49e-5c683e09f8da",
            "link": "https://learn.microsoft.com/azure/firewall/firewall-diagnostics",
            "service": "Firewall",
            "services": [
                "WAF",
                "Monitor",
                "Firewall"
            ],
            "severity": "High",
            "text": "Integrate Azure Firewall with Azure Monitor and enable diagnostic logging to store and analyze firewall logs and metrics.",
            "training": "https://learn.microsoft.com/training/courses/az-700t00/",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.Network/azureFirewalls",
            "checklist": "WAF checklist",
            "guid": "64e7000e-3c06-485e-b455-ced7f454cba3",
            "link": "https://learn.microsoft.com/azure/well-architected/service-guides/azure-firewall",
            "service": "Firewall",
            "services": [
                "WAF",
                "Backup"
            ],
            "severity": "Low",
            "text": "Implement backups for your firewall rules",
            "training": "https://learn.microsoft.com/training/courses/az-104t00/",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.Network/azureFirewalls",
            "checklist": "WAF checklist",
            "graph": "resources | where type == 'microsoft.network/azurefirewalls' | where array_length(zones) <= 1 or isnull(zones) | where isempty(properties.virtualHub.id) or isnull(properties.virtualHub.id) | project name, id, tags, param1='multipleZones:false'",
            "guid": "d38ad60c-bc9e-4d49-b699-97e5d4dcf707",
            "link": "https://learn.microsoft.com/azure/firewall/deploy-availability-zone-powershell",
            "service": "Firewall",
            "services": [
                "WAF",
                "ACR",
                "Firewall"
            ],
            "severity": "High",
            "text": "Deploy Azure Firewall across multiple availability zones. Azure Firewall offers different SLAs depending on its deployment; in a single availability zone or across multiple, potentially improving reliability and performance.",
            "training": "https://learn.microsoft.com/training/courses/az-104t00/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Network/azureFirewalls",
            "checklist": "WAF checklist",
            "graph": "resources | where type =~ 'Microsoft.Network/azureFirewalls' | where isempty(properties.virtualHub.id) or isnull(properties.virtualHub.id) | mv-expand ipConfig = properties.ipConfigurations | project name, firewallId = id, tags, vNetName = split(ipConfig.properties.subnet.id, '/', 8)[0], vNetId = tolower(substring(ipConfig.properties.subnet.id, 0, indexof(ipConfig.properties.subnet.id, /subnet'))) | join kind=fullouter ( resources | where type =~ 'Microsoft.Network/ddosProtectionPlans' | mv-expand vNet = properties.virtualNetworks | project ddosProtectionPlanId = id, vNetId = tolower(vNet.id) ) on vNetId | where isempty(ddosProtectionPlanId) | , name, id = firewallId, tags, param1 = strcat('vNet: ', vNetName), param2 = 'ddosProtection: Disabled'",
            "guid": "e8143efa-0301-4d62-be54-ca7b5ce566dc",
            "link": "https://learn.microsoft.com/en-gb/azure/ddos-protection/ddos-protection-overview",
            "service": "Firewall",
            "services": [
                "WAF",
                "VNet",
                "Firewall",
                "DDoS"
            ],
            "severity": "High",
            "text": "Configure DDoS Protection on the Azure Firewall VNet, Associate a DDoS protection plan with the virtual network hosting Azure Firewall to provide enhanced mitigation against DDoS attacks. Azure Firewall Manager integrates the creation of firewall infrastructure and DDoS protection plans. ",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/applicationGateways",
            "checklist": "WAF checklist",
            "guid": "d301d6e8-72e5-42e3-911c-c58b5a4b1511",
            "link": "https://learn.microsoft.com/azure/virtual-network/vnet-integration-for-azure-services",
            "service": "App Gateway",
            "services": [
                "WAF",
                "VNet"
            ],
            "severity": "High",
            "text": "Do not disrupt control-plane communication for Azure PaaS services injected into a virtual networks, such as with a 0.0.0.0/0 route or an NSG rule that blocks control plane traffic.",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/?source=learn",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "WAF checklist",
            "guid": "b3e4563a-4d87-4397-98b6-62d6d15f512a",
            "link": "https://learn.microsoft.com/azure/private-link/private-endpoint-overview",
            "service": "ExpressRoute",
            "services": [
                "WAF",
                "ExpressRoute",
                "PrivateLink"
            ],
            "severity": "Medium",
            "text": "Access Azure PaaS services from on-premises via private endpoints and ExpressRoute private peering. This method avoids transiting over the public internet.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Network/virtualNetworks",
            "checklist": "WAF checklist",
            "graph": "resources | where type =~ 'microsoft.network/virtualnetworks' | project id,resourceGroup,name,subnets = properties.subnets | mv-expand subnets | project id = subnets.id, resourceGroup, VNet = name, serviceEndpoints = subnets.properties.serviceEndpoints, compliant = (isnull(subnets.properties.serviceEndpoints) or array_length(subnets.properties.serviceEndpoints) == 0) | order by compliant asc",
            "guid": "4704489a-8042-4d88-b79d-17b73b22a5a6",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-network-service-endpoints-overview",
            "service": "VNet",
            "services": [
                "WAF",
                "VNet"
            ],
            "severity": "High",
            "text": "Don't enable virtual network service endpoints by default on all subnets.",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/?source=learn",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Network/azureFirewalls",
            "checklist": "WAF checklist",
            "guid": "7e7a8ed4-b30e-438c-9f29-812b2363cefe",
            "link": "azure/private-link/inspect-traffic-with-azure-firewall",
            "service": "Firewall",
            "services": [
                "WAF",
                "Firewall",
                "DNS",
                "PrivateLink",
                "NVA"
            ],
            "severity": "Medium",
            "text": "Filter egress traffic to Azure PaaS services using FQDNs instead of IP addresses in Azure Firewall or an NVA to prevent data exfiltration. If using Private Link you can block all FQDNs, otherwise allow only the required PaaS services.",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/?source=learn",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "WAF checklist",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,subnets=properties.subnets | mv-expand subnets | project id, subnetName = subnets.name, subnetPrefix = subnets.properties.addressPrefix | extend subnetPrefixLength = split(subnetPrefix, '/')[1] | where subnetName == 'GatewaySubnet' | extend compliant = (subnetPrefixLength <= 27) | distinct id, compliant",
            "guid": "f2aad7e3-bb03-4adc-8606-4123d342a917",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-howto-add-gateway-resource-manager#add-a-gateway",
            "service": "ExpressRoute",
            "services": [
                "WAF",
                "VNet",
                "ExpressRoute",
                "VPN"
            ],
            "severity": "High",
            "text": "Use at least a /27 prefix for your Gateway subnets.",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Network/networkSecurityGroups",
            "checklist": "WAF checklist",
            "graph": "resources | where type=='microsoft.network/networksecuritygroups' | mvexpand properties.securityRules | project id,name,ruleAction=properties_securityRules.properties.access,rulePriority=properties_securityRules.properties.priority,ruleDst=properties_securityRules.properties.destinationAddressPrefix,ruleSrc=properties_securityRules.properties.sourceAddressPrefix,ruleProt=properties_securityRules.properties.protocol,ruleDirection=properties_securityRules.properties.direction,rulePort=properties_securityRules.properties.destinationPortRange | summarize StarDenies=countif(ruleAction=='Deny' and ruleDst=='*' and ruleSrc=='*' and ruleProt=='*' and rulePort=='*') by id,tostring(ruleDirection) | where ruleDirection == 'Inbound' | project id,compliant=(StarDenies>0) | union (resources | where type=='microsoft.network/networksecuritygroups' | where array_length(properties.securityRules)==0 | extend compliant=false | project id,compliant)",
            "guid": "11deb39d-8299-4e47-bbe0-0fb5a36318a8",
            "link": "https://learn.microsoft.com/azure/virtual-network/service-tags-overview#available-service-tags",
            "service": "NSG",
            "services": [
                "WAF",
                "VNet"
            ],
            "severity": "High",
            "text": "Don't rely on the NSG inbound default rules using the VirtualNetwork service tag to limit connectivity.",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Network/networkSecurityGroups",
            "checklist": "WAF checklist",
            "graph": "resources | where type == 'microsoft.network/virtualnetworks' | mv-expand subnet = properties.subnets | where subnet.name !in~ ('GatewaySubnet', 'AzureFirewallSubnet', 'AzureFirewallManagementSubnet', 'RouteServerSubnet') | extend compliant = iff(isnotnull(subnet.properties.networkSecurityGroup.id), true, false) | project id, subnetName = subnet.name, vnetName = name, NSG = subnet.properties.networkSecurityGroup.id, compliant",
            "guid": "872e52e3-611c-4c58-a5a4-b1511e43a58a",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-landing-zone-network-segmentation",
            "service": "NSG",
            "services": [
                "WAF",
                "VNet",
                "ACR"
            ],
            "severity": "Medium",
            "text": "Use NSGs to help protect traffic across subnets, as well as east/west traffic across the platform (traffic between landing zones).",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Network/networkSecurityGroups",
            "checklist": "WAF checklist",
            "guid": "a4d87397-48b6-462d-9d15-f512a65498f6",
            "link": "https://learn.microsoft.com/azure/virtual-network/network-security-group-how-it-works",
            "service": "NSG",
            "services": [
                "WAF",
                "VNet",
                "NVA",
                "Entra"
            ],
            "severity": "Medium",
            "text": "Use NSGs and application security groups to micro-segment traffic within the landing zone and avoid using a central NVA to filter traffic flows.",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Network/networkSecurityGroups",
            "checklist": "WAF checklist",
            "graph": "resources | where type =~ 'Microsoft.Network/virtualnetworks' | project subscriptionId, lowerCaseVNetId = tolower(id) | join kind = leftouter (    resources    | where type =~ 'microsoft.network/networkwatchers/flowlogs' and properties.enabled == true and properties.provisioningState =~ 'succeeded'    | where properties.targetResourceId contains '/Microsoft.Network/virtualNetworks/'    | project flowlogId = id, trafficAnalyticsEnabled = properties.flowAnalyticsConfiguration.networkWatcherFlowAnalyticsConfiguration.enabled, lowerCaseTargetVNetId = tolower(properties.targetResourceId)    )    on $left.lowerCaseVNetId == $right.lowerCaseTargetVNetId | extend compliant = iff(isnotempty(lowerCaseTargetVNetId), true, false) | project id = lowerCaseVNetId, flowlogId, trafficAnalyticsEnabled, compliant",
            "guid": "dfe237de-143b-416c-91d7-aa9b64704489",
            "link": "https://learn.microsoft.com/azure/network-watcher/vnet-flow-logs-overview",
            "service": "NSG",
            "services": [
                "WAF",
                "VNet",
                "NetworkWatcher"
            ],
            "severity": "Medium",
            "text": "Enable VNet Flow Logs and feed them into Traffic Analytics to gain insights into internal and external traffic flows.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-network-monitoring/",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Network/networkSecurityGroups",
            "checklist": "WAF checklist",
            "graph": "resources | where type == 'microsoft.network/networksecuritygroups' | project id, rules = array_length(properties.securityRules) | project id, compliant = (rules < 900)",
            "guid": "0390417d-53dc-44d9-b3f4-c8832f359b41",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits",
            "service": "NSG",
            "services": [
                "WAF",
                "VNet"
            ],
            "severity": "Medium",
            "text": "Do not implement more than 900 NSG rules per NSG, due to the limit of 1000 rules.",
            "training": "https://learn.microsoft.com/azure/virtual-network/network-security-group-how-it-works",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/virtualWans",
            "checklist": "WAF checklist",
            "guid": "412e7f98-3f63-4047-82dd-69c5b5c2622f",
            "link": "https://learn.microsoft.com/azure/virtual-wan/scenario-any-to-any",
            "service": "VWAN",
            "services": [
                "WAF",
                "VWAN"
            ],
            "severity": "Medium",
            "text": "Use Virtual WAN if your scenario is explicitly described in the list of Virtual WAN routing designs.",
            "training": "https://learn.microsoft.com/learn/modules/introduction-azure-virtual-wan/",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.network/virtualWans",
            "checklist": "WAF checklist",
            "guid": "54b69bad-33aa-4d5e-ac68-e1d76667313b",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/virtual-wan-network-topology#virtual-wan-network-design-recommendationst",
            "service": "VWAN",
            "services": [
                "WAF",
                "ACR",
                "VWAN"
            ],
            "severity": "Medium",
            "text": "Use a Virtual WAN hub per Azure region to connect multiple landing zones together across Azure regions via a common global Azure Virtual WAN.",
            "training": "https://learn.microsoft.com/training/modules/introduction-azure-virtual-wan/",
            "waf": "Performance"
        },
        {
            "arm-service": "microsoft.network/virtualWans",
            "checklist": "WAF checklist",
            "graph": "resources | where type=='microsoft.network/virtualhubs' | extend compliant = isnotnull(properties.azureFirewall.id) | project id, compliant",
            "guid": "7d5d1e4e-6146-458d-9558-fd77249b8211",
            "link": "https://learn.microsoft.com/azure/virtual-wan/howto-firewall",
            "service": "VWAN",
            "services": [
                "WAF",
                "Firewall"
            ],
            "severity": "Medium",
            "text": "For outbound Internet traffic protection and filtering, deploy Azure Firewall in secured hubs.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.network/virtualWans",
            "checklist": "WAF checklist",
            "guid": "6667313b-4f56-464b-9e98-4a859c773e7d",
            "link": "https://learn.microsoft.com/azure/virtual-wan/migrate-from-hub-spoke-topology",
            "service": "VWAN",
            "services": [
                "WAF",
                "VWAN"
            ],
            "severity": "Medium",
            "text": "Ensure that your virtual WAN network architecture aligns to an identified architecture scenario.",
            "training": "https://learn.microsoft.com/training/modules/introduction-azure-virtual-wan/",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/virtualWans",
            "checklist": "WAF checklist",
            "guid": "261623a7-65a9-417e-8f34-8ef254c27d42",
            "link": "https://learn.microsoft.com/azure/virtual-wan/azure-monitor-insights",
            "service": "VWAN",
            "services": [
                "WAF",
                "Monitor",
                "VWAN"
            ],
            "severity": "Medium",
            "text": "Use Azure Monitor Insights for Virtual WAN to monitor the end-to-end topology of the Virtual WAN, status, and key metrics.",
            "training": "https://learn.microsoft.com/training/modules/introduction-azure-virtual-wan/",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.network/virtualWans",
            "checklist": "WAF checklist",
            "graph": "resources| where type =~ 'microsoft.network/virtualwans' | extend compliant= (properties.allowBranchToBranchTraffic == 'true') | distinct id,compliant",
            "guid": "727c77e1-b9aa-4a37-a024-129d042422c1",
            "link": "https://learn.microsoft.com/azure/virtual-wan/virtual-wan-faq#is-branch-to-branch-connectivity-allowed-in-virtual-wan",
            "service": "VWAN",
            "services": [
                "WAF",
                "VWAN"
            ],
            "severity": "Medium",
            "text": "Do not disable branch-to-branch traffic in Virtual WAN, unless these flows should be explicitly blocked.",
            "training": "https://learn.microsoft.com/training/modules/introduction-azure-virtual-wan/",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/virtualWans",
            "checklist": "WAF checklist",
            "graph": "resources | where type =~ 'microsoft.network/virtualhubs'| extend compliant= (properties.hubRoutingPreference =~ 'ASPath') | distinct id,compliant",
            "guid": "d49ac006-6670-4bc9-9948-d3e0a3a94f4d",
            "link": "https://learn.microsoft.com/azure/virtual-wan/about-virtual-hub-routing-preference",
            "service": "VWAN",
            "services": [
                "WAF",
                "ExpressRoute",
                "VPN"
            ],
            "severity": "Medium",
            "text": "Use AS-Path as hub routing preference, since it is more flexible than ExpressRoute or VPN.",
            "training": "https://learn.microsoft.com/training/modules/introduction-azure-virtual-wan/",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/virtualWans",
            "checklist": "WAF checklist",
            "guid": "2586b854-237e-47f1-84a1-d45d4cd2310d",
            "link": "https://learn.microsoft.com/azure/virtual-wan/about-virtual-hub-routing#labels",
            "service": "VWAN",
            "services": [
                "WAF",
                "VWAN"
            ],
            "severity": "Medium",
            "text": "Configure label-based propagation in Virtual WAN, otherwise connectivity between virtual hubs will be impaired.",
            "training": "https://learn.microsoft.com/training/modules/introduction-azure-virtual-wan/",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/virtualWans",
            "checklist": "WAF checklist",
            "graph": "resources | where type =~ 'microsoft.network/virtualhubs' | extend addressSpace = properties.addressPrefix | extend compliant= (toint(substring(addressSpace, indexof(addressSpace, '/') + 1)) < 23) | distinct name, id, compliant",
            "guid": "9c75dfef-573c-461c-a698-68598595581a",
            "link": "https://learn.microsoft.com/azure/virtual-wan/virtual-wan-faq#what-is-the-recommended-hub-address-space-during-hub-creation",
            "service": "VWAN",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Assign at least a /23 prefix to virtual hubs to ensure enough IP space is available.",
            "training": "https://learn.microsoft.com/training/modules/introduction-azure-virtual-wan/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Authorization/policyDefinitions",
            "checklist": "WAF checklist",
            "guid": "5c986cb2-9131-456a-8247-6e49f541acdc",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "service": "Policy",
            "services": [
                "WAF",
                "AzurePolicy"
            ],
            "severity": "High",
            "text": "Leverage Azure Policy strategically, define controls for your environment, using Policy Initiatives to group related policies.",
            "training": "https://learn.microsoft.com/training/modules/configure-azure-policy/",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Authorization/policyDefinitions",
            "checklist": "WAF checklist",
            "guid": "d8a2adb1-17d6-4326-af62-5ca44e5695f2",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "service": "Policy",
            "services": [
                "WAF",
                "RBAC",
                "AzurePolicy"
            ],
            "severity": "Medium",
            "text": "Map regulatory and compliance requirements to Azure Policy definitions and Azure role assignments.",
            "training": "https://learn.microsoft.com/training/modules/governance-security/",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Authorization/policyDefinitions",
            "checklist": "WAF checklist",
            "guid": "223ace8c-b123-408c-a501-7f154e3ab369",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "service": "Policy",
            "services": [
                "WAF",
                "Subscriptions",
                "AzurePolicy"
            ],
            "severity": "Medium",
            "text": "Establish Azure Policy definitions at the intermediate root management group so that they can be assigned at inherited scopes.",
            "training": "https://learn.microsoft.com/training/modules/configure-azure-policy/",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Authorization/policyDefinitions",
            "checklist": "WAF checklist",
            "guid": "3829e7e3-1618-4368-9a04-77a209945bda",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "service": "Policy",
            "services": [
                "WAF",
                "AzurePolicy"
            ],
            "severity": "High",
            "text": "Manage policy assignments at the highest appropriate level with exclusions at bottom levels, if required.",
            "training": "https://learn.microsoft.com/training/modules/configure-azure-policy/",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Authorization/policyDefinitions",
            "checklist": "WAF checklist",
            "guid": "43334f24-9116-4341-a2ba-527526944008",
            "link": "https://learn.microsoft.com/security/benchmark/azure/mcsb-asset-management#am-2-use-only-approved-services",
            "service": "Policy",
            "services": [
                "WAF",
                "Subscriptions",
                "AzurePolicy"
            ],
            "severity": "Low",
            "text": "Use Azure Policy to control which services users can provision at the subscription/management group level.",
            "training": "https://learn.microsoft.com/training/modules/configure-azure-policy/",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Authorization/policyDefinitions",
            "checklist": "WAF checklist",
            "guid": "be7d7e48-4327-46d8-adc0-55bcf619e8a1",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "service": "Policy",
            "services": [
                "WAF",
                "AzurePolicy"
            ],
            "severity": "High",
            "text": "Use built-in policies where possible to minimize operational overhead.",
            "training": "https://learn.microsoft.com/training/modules/configure-azure-policy/",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Authorization/policyDefinitions",
            "checklist": "WAF checklist",
            "description": "Assigning the Resource Policy Contributor role to specific scopes allows you to delegate policy management to relevant teams. For instance, a central IT team may oversee management group-level policies, while application teams handle policies for their subscriptions, enabling distributed governance with adherence to organizational standards.",
            "guid": "3f988795-25d6-4268-a6d7-0ba6c97be995",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview#azure-rbac-permissions-in-azure-policy",
            "service": "Policy",
            "services": [
                "WAF",
                "AzurePolicy",
                "RBAC",
                "Entra",
                "Subscriptions"
            ],
            "severity": "Medium",
            "text": "Assign the built-in Resource Policy Contributor role at a particular scope to enable application-level governance.",
            "training": "https://learn.microsoft.com/training/modules/configure-azure-policy/",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Authorization/policyDefinitions",
            "checklist": "WAF checklist",
            "guid": "19048384-5c98-46cb-8913-156a12476e49",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "service": "Policy",
            "services": [
                "WAF",
                "Subscriptions",
                "AzurePolicy"
            ],
            "severity": "Medium",
            "text": "Limit the number of Azure Policy assignments made at the root management group scope to avoid managing through exclusions at inherited scopes.",
            "training": "https://learn.microsoft.com/training/modules/configure-azure-policy/",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Authorization/policyDefinitions",
            "checklist": "WAF checklist",
            "guid": "5a917e1f-348e-4f25-9c27-d42e8bbac757",
            "link": "https://learn.microsoft.com/industry/release-plan/2023wave2/cloud-sovereignty/enable-data-sovereignty-policy-baseline",
            "service": "Policy",
            "services": [
                "WAF",
                "AzurePolicy"
            ],
            "severity": "Medium",
            "text": "If any data sovereignty requirements exist, Azure Policies should be deployed to enforce them.",
            "training": "https://learn.microsoft.com/learn/paths/secure-your-cloud-data/",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Authorization/policyDefinitions",
            "checklist": "WAF checklist",
            "guid": "78b22132-b41c-460b-a4d3-df8f73a67dc2",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/sovereign-landing-zone",
            "service": "Policy",
            "services": [
                "WAF",
                "Subscriptions",
                "AzurePolicy"
            ],
            "severity": "Medium",
            "text": "For Sovereign Landing Zone, deploy sovereignty policy baseline and assign at correct management group level.",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Authorization/policyDefinitions",
            "checklist": "WAF checklist",
            "guid": "caeea0e9-1024-41df-a52e-d99c3f22a6f4",
            "link": "https://learn.microsoft.com/industry/sovereignty/policy-portfolio-baseline",
            "service": "Policy",
            "services": [
                "WAF",
                "AzurePolicy"
            ],
            "severity": "Medium",
            "text": "For Sovereign Landing Zone, document Sovereign Control objectives to policy mapping.",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Authorization/policyDefinitions",
            "checklist": "WAF checklist",
            "guid": "9b461617-db7b-4399-8ac6-d4eb7153893a",
            "link": "https://learn.microsoft.com/industry/sovereignty/policy-portfolio-baseline#sovereignty-baseline-policy-initiatives",
            "service": "Policy",
            "services": [
                "WAF",
                "AzurePolicy"
            ],
            "severity": "Medium",
            "text": "For Sovereign Landing Zone, ensure process is in place for management of 'Sovereign Control objectives to policy mapping'.",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Insights/components",
            "checklist": "WAF checklist",
            "guid": "67e7a8ed-4b30-4e38-a3f2-9812b2363cef",
            "link": "https://learn.microsoft.com/en-us/azure/azure-monitor/logs/workspace-design#azure-regions",
            "service": "Monitor",
            "services": [
                "WAF",
                "AzurePolicy",
                "Entra",
                "RBAC",
                "Monitor"
            ],
            "severity": "Medium",
            "text": "Use a single monitor logs workspace to manage platforms centrally except where Azure role-based access control (Azure RBAC), data sovereignty requirements, or data retention policies mandate separate workspaces.",
            "training": "https://learn.microsoft.com/azure/azure-monitor/logs/design-logs-deployment",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.Insights/components",
            "checklist": "WAF checklist",
            "guid": "7418ada9-4199-4c28-8286-d15e9433e8f3",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/design-logs-deployment",
            "service": "Monitor",
            "services": [
                "WAF",
                "Monitor"
            ],
            "severity": "Medium",
            "text": "Decide whether to use a single Azure Monitor Logs workspace for all regions or to create multiple workspaces to cover various geographical regions. Each approach has advantages and disadvantages, including potential cross-region networking charges",
            "training": "https://learn.microsoft.com/azure/azure-monitor/logs/design-logs-deployment",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Insights/components",
            "checklist": "WAF checklist",
            "guid": "5e6c4cfd-3e50-4454-9c24-47ec66138a72",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/data-retention-archive?tabs=portal-1%2Cportal-2#how-retention-and-archiving-work",
            "service": "Monitor",
            "services": [
                "WAF",
                "AzurePolicy",
                "ARS",
                "Storage"
            ],
            "severity": "High",
            "text": "Export logs to Azure Storage if your log retention requirements exceed twelve years. Use immutable storage with a write-once, read-many policy to make data non-erasable and non-modifiable for a user-specified interval.",
            "training": "https://learn.microsoft.com/learn/paths/architect-infrastructure-operations/",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "WAF checklist",
            "guid": "e7d7e484-3276-4d8b-bc05-5bcf619e8a13",
            "link": "https://learn.microsoft.com/azure/governance/machine-configuration/overview",
            "service": "VM",
            "services": [
                "WAF",
                "AzurePolicy",
                "Monitor",
                "VM"
            ],
            "severity": "Medium",
            "text": "Monitor OS level virtual machine (VM) configuration drift using Azure Policy. Enabling Azure Automanage Machine Configuration audit capabilities through policy helps application team workloads to immediately consume feature capabilities with little effort.",
            "training": "https://learn.microsoft.com/learn/paths/implement-resource-mgmt-security/",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "WAF checklist",
            "guid": "f9887952-5d62-4688-9d70-ba6c97be9951",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/management-operational-compliance#update-management-considerations",
            "service": "VM",
            "services": [
                "WAF",
                "VM"
            ],
            "severity": "Medium",
            "text": "Use Azure Update Manager as a patching mechanism for Windows and Linux VMs in Azure.",
            "training": "https://learn.microsoft.com/azure/update-manager/overview?tabs=azure-vms",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "WAF checklist",
            "guid": "c806c048-26b7-4ddf-b4c2-b4f0c476925d",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/management-operational-compliance#update-management-considerations ",
            "service": "VM",
            "services": [
                "WAF",
                "VM"
            ],
            "severity": "Medium",
            "text": "Use Azure Update Manager as a patching mechanism for Windows and Linux VMs outside of Azure using Azure Arc.",
            "training": "https://learn.microsoft.com/azure/update-manager/overview?tabs=azure-vms",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.network/networkWatchers",
            "checklist": "WAF checklist",
            "guid": "90483845-c986-4cb2-a131-56a12476e49f",
            "link": "https://learn.microsoft.com/azure/network-watcher/network-watcher-monitoring-overview",
            "service": "Network Watcher",
            "services": [
                "WAF",
                "NetworkWatcher",
                "Monitor"
            ],
            "severity": "Medium",
            "text": "Use Network Watcher to proactively monitor traffic flows.",
            "training": "https://learn.microsoft.com/learn/modules/configure-network-watcher/",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.Insights/components",
            "checklist": "WAF checklist",
            "guid": "6944008b-e7d7-4e48-9327-6d8bdc055bcf",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-setup-guide/monitoring-reporting?tabs=AzureMonitor",
            "service": "Monitor",
            "services": [
                "WAF",
                "Monitor"
            ],
            "severity": "Medium",
            "text": "Use Azure Monitor Logs for insights and reporting.",
            "training": "https://learn.microsoft.com/training/modules/configure-azure-monitor/",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.Insights/components",
            "checklist": "WAF checklist",
            "guid": "97be9951-9048-4384-9c98-6cb2913156a1",
            "link": "https://learn.microsoft.com/azure/azure-monitor/alerts/alerts-overview",
            "service": "Monitor",
            "services": [
                "WAF",
                "Monitor"
            ],
            "severity": "Medium",
            "text": "Use Azure Monitor alerts for the generation of operational alerts.",
            "training": "https://learn.microsoft.com/training/modules/incident-response-with-alerting-on-azure/",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.Insights/components",
            "checklist": "WAF checklist",
            "guid": "fed3c55f-a67e-4875-aadd-3aba3f9fde31",
            "link": "https://learn.microsoft.com/azure/automation/how-to/region-mappings",
            "service": "Monitor",
            "services": [
                "WAF",
                "Monitor"
            ],
            "severity": "Medium",
            "text": "When using Change and Inventory Tracking via Azure Automation Accounts, ensure that you have selected supported regions for linking your Log Analytics workspace and automation accounts together.",
            "training": "https://learn.microsoft.com/training/modules/explore-azure-automation-devops/",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.RecoveryServices/vaults",
            "checklist": "WAF checklist",
            "guid": "eba8cf22-45c6-4dc1-9b57-2cceb3b97ce5",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-redundancy",
            "service": "Backup",
            "services": [
                "WAF",
                "Backup"
            ],
            "severity": "Low",
            "text": "When using Azure Backup, use the correct backup types (GRS, ZRS & LRS) for your backup, as the default setting is GRS.",
            "training": "https://learn.microsoft.com/training/modules/design-solution-for-backup-disaster-recovery/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "WAF checklist",
            "guid": "f541acdc-e979-4377-acdb-3751ab2ab13a",
            "link": "https://learn.microsoft.com/azure/governance/policy/concepts/guest-configuration",
            "service": "VM",
            "services": [
                "WAF",
                "AzurePolicy",
                "VM"
            ],
            "severity": "Medium",
            "text": "Use Azure guest policies to automatically deploy software configurations through VM extensions and enforce a compliant baseline VM configuration.",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "WAF checklist",
            "description": "Use Azure Policy's guest configuration features  to audit and remediate machine settings (e.g., OS, application, environment) to ensure resources align with expected configurations, and Update Management can enforce patch management for VMs.",
            "guid": "da6e55d7-d8a2-4adb-817d-6326af625ca4",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/management-operational-compliance#monitoring-for-configuration-drift",
            "service": "VM",
            "services": [
                "WAF",
                "AzurePolicy",
                "Monitor",
                "VM"
            ],
            "severity": "Medium",
            "text": "Monitor VM security configuration drift via Azure Policy.",
            "training": "https://learn.microsoft.com/training/paths/implement-resource-mgmt-security/",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "WAF checklist",
            "guid": "2476e49f-541a-4cdc-b979-377bcdb3751a",
            "link": "https://learn.microsoft.com/azure/site-recovery/site-recovery-overview",
            "service": "VM",
            "services": [
                "WAF",
                "ACR",
                "VM",
                "ASR"
            ],
            "severity": "Medium",
            "text": "Use Azure Site Recovery for Azure-to-Azure Virtual Machines disaster recovery scenarios. This enables you to replicate workloads across regions.",
            "training": "https://learn.microsoft.com/training/modules/protect-infrastructure-with-site-recovery/",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.RecoveryServices/vaults",
            "checklist": "WAF checklist",
            "guid": "f625ca44-e569-45f2-823a-ce8cb12308ca",
            "link": "https://learn.microsoft.com/azure/backup/backup-center-overview",
            "service": "Backup",
            "services": [
                "WAF",
                "Backup"
            ],
            "severity": "Medium",
            "text": "Use Azure-native backup capabilities, or an Azure-compatible, 3rd-party backup solution.",
            "training": "https://learn.microsoft.com/training/modules/design-solution-for-backup-disaster-recovery/",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.network/frontdoorwebApplicationFirewalls",
            "checklist": "WAF checklist",
            "guid": "89cc5e11-aa4d-4c3b-893d-feb99215266a",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#add-diagnostic-settings-to-save-your-wafs-logs",
            "service": "WAF",
            "services": [
                "WAF",
                "FrontDoor",
                "AppGW"
            ],
            "severity": "High",
            "text": "Add diagnostic settings to save WAF logs from application delivery services like Azure Front Door and Azure Application Gateway. Regularly review the logs to check for attacks and for false positive detections.",
            "training": "https://learn.microsoft.com/training/modules/capture-application-logs-app-service/",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.network/frontdoorwebApplicationFirewalls",
            "checklist": "WAF checklist",
            "guid": "7f408960-c626-44cb-a018-347c8d790cdf",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#send-logs-to-microsoft-sentinel",
            "service": "WAF",
            "services": [
                "WAF",
                "FrontDoor",
                "Sentinel",
                "AppGW"
            ],
            "severity": "Medium",
            "text": "Send WAF logs from your application delivery services like Azure Front Door and Azure Application Gateway to Microsoft Sentinel. Detect attacks and integrate WAF telemetry into your overall Azure environment.",
            "training": "https://learn.microsoft.com/training/paths/sc-200-connect-logs-to-azure-sentinel/",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.KeyVault/vaults",
            "checklist": "WAF checklist",
            "guid": "5017f154-e3ab-4369-9829-e7e316183687",
            "link": "https://learn.microsoft.com/azure/key-vault/general/overview",
            "service": "Key Vault",
            "services": [
                "WAF",
                "AKV"
            ],
            "severity": "High",
            "text": "Use Azure Key Vault to store your secrets and credentials.",
            "training": "https://learn.microsoft.com/training/modules/implement-azure-key-vault/",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.KeyVault/vaults",
            "checklist": "WAF checklist",
            "graph": "ResourceContainers | where type=='microsoft.resources/subscriptions'| parse id with '/subscriptions/' SubscriptionID| project subscriptionId, SubscriptionName = name| join kind=leftouter (Resources| where type == 'microsoft.keyvault/vaults'| project id, name, subscriptionId) on subscriptionId| join kind= leftouter (Resources| where type == 'microsoft.keyvault/vaults'| summarize ResourceCount = count() by subscriptionId) on subscriptionId| extend RCount = iff(isnull(ResourceCount), 0, ResourceCount)| project-away ResourceCount| extend compliant = (RCount <> 1)",
            "guid": "a0477a20-9945-4bda-9333-4f2491163418",
            "link": "https://learn.microsoft.com/azure/key-vault/general/overview-throttling",
            "service": "Key Vault",
            "services": [
                "WAF",
                "AKV"
            ],
            "severity": "Medium",
            "text": "Use different Azure Key Vaults for different applications and regions to avoid transaction scale limits and restrict access to secrets.",
            "training": "https://learn.microsoft.com/training/modules/configure-and-manage-azure-key-vault/",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.KeyVault/vaults",
            "checklist": "WAF checklist",
            "guid": "2ba52752-6944-4008-ae7d-7e4843276d8b",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "services": [
                "WAF",
                "AKV",
                "AzurePolicy"
            ],
            "severity": "Medium",
            "text": "Provision Azure Key Vault with the soft delete and purge policies enabled to allow retention protection for deleted objects.",
            "training": "https://learn.microsoft.com/training/modules/implement-azure-key-vault/",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.KeyVault/vaults",
            "checklist": "WAF checklist",
            "guid": "dc055bcf-619e-48a1-9f98-879525d62688",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "services": [
                "WAF",
                "AKV",
                "RBAC",
                "Entra"
            ],
            "severity": "Medium",
            "text": "Follow a least privilege model by limiting authorization to permanently delete keys, secrets, and certificates to specialized custom Microsoft Entra ID roles.",
            "training": "https://learn.microsoft.com/training/modules/implement-azure-key-vault/",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.KeyVault/vaults",
            "checklist": "WAF checklist",
            "guid": "6d70ba6c-97be-4995-8904-83845c986cb2",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Automate the certificate management and renewal process with public certificate authorities to ease administration.",
            "training": "https://learn.microsoft.com/en-us/training/modules/configure-and-manage-azure-key-vault/",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.KeyVault/vaults",
            "checklist": "WAF checklist",
            "guid": "913156a1-2476-4e49-b541-acdce979377b",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Establish an automated process for key and certificate rotation.",
            "training": "https://learn.microsoft.com/training/modules/configure-and-manage-azure-key-vault/",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.KeyVault/vaults",
            "checklist": "WAF checklist",
            "guid": "cdb3751a-b2ab-413a-ba6e-55d7d8a2adb1",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "services": [
                "WAF",
                "VNet",
                "AKV",
                "PrivateLink"
            ],
            "severity": "Medium",
            "text": "Enable firewall and virtual network service endpoint or private endpoint on the vault to control access to the key vault.",
            "training": "https://learn.microsoft.com/training/modules/design-implement-private-access-to-azure-services/",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.KeyVault/vaults",
            "checklist": "WAF checklist",
            "guid": "17d6326a-f625-4ca4-9e56-95f2223ace8c",
            "link": "https://learn.microsoft.com/azure/key-vault/general/monitor-key-vault",
            "service": "Key Vault",
            "services": [
                "WAF",
                "AKV",
                "Monitor",
                "Entra"
            ],
            "severity": "Medium",
            "text": "Use the platform-central Azure Monitor Log Analytics workspace to audit key, certificate, and secret usage within each instance of Key Vault.",
            "training": "https://learn.microsoft.com/training/modules/analyze-infrastructure-with-azure-monitor-logs/",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.KeyVault/vaults",
            "checklist": "WAF checklist",
            "guid": "b12308ca-5017-4f15-9e3a-b3693829e7e3",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "services": [
                "WAF",
                "AKV",
                "AzurePolicy"
            ],
            "severity": "Medium",
            "text": "Delegate Key Vault instantiation and privileged access and use Azure Policy to enforce a consistent compliant configuration.",
            "training": "https://learn.microsoft.com/training/modules/configure-azure-key-vault-networking-settings/",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.KeyVault/vaults",
            "checklist": "WAF checklist",
            "guid": "91163418-2ba5-4275-8694-4008be7d7e48",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "services": [
                "WAF",
                "AKV"
            ],
            "severity": "Medium",
            "text": "Use an Azure Key Vault per application per environment per region.",
            "training": "https://learn.microsoft.com/training/modules/implement-azure-key-vault/",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.KeyVault/vaults",
            "checklist": "WAF checklist",
            "guid": "25d62688-6d70-4ba6-a97b-e99519048384",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "services": [
                "WAF",
                "AKV",
                "ACR",
                "ASR"
            ],
            "severity": "Medium",
            "text": "If you want to bring your own keys, this might not be supported across all considered services. Implement relevant mitigation so that inconsistencies don't hinder desired outcomes. Choose appropriate region pairs and disaster recovery regions that minimize latency.",
            "training": "https://learn.microsoft.com/training/modules/configure-and-manage-azure-key-vault/",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.KeyVault/vaults",
            "checklist": "WAF checklist",
            "guid": "4ac6b67c-b3a4-4ff9-8e87-b07a7ce7bbdb",
            "link": "https://learn.microsoft.com/industry/sovereignty/key-management",
            "service": "Key Vault",
            "services": [
                "WAF",
                "AKV"
            ],
            "severity": "Medium",
            "text": "For Sovereign Landing Zone, use Azure Key Vault managed HSM to store your secrets and credentials.",
            "training": "https://learn.microsoft.com/training/modules/configure-and-manage-azure-key-vault/",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "4e5695f2-223a-4ce8-ab12-308ca5017f15",
            "link": "https://learn.microsoft.com/azure/active-directory/reports-monitoring/overview-reports",
            "service": "Entra",
            "services": [
                "WAF",
                "Entra"
            ],
            "severity": "Medium",
            "text": "Use Microsoft Entra ID reporting capabilities to generate access control audit reports.",
            "training": "https://learn.microsoft.com/training/modules/monitor-report-aad-security-events/",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "09945bda-4333-44f2-9911-634182ba5275",
            "link": "https://learn.microsoft.com/azure/defender-for-cloud/concept-cloud-security-posture-management",
            "service": "Defender",
            "services": [
                "WAF",
                "Subscriptions",
                "Defender"
            ],
            "severity": "High",
            "text": "Enable Defender Cloud Security Posture Management for all subscriptions.",
            "training": "https://learn.microsoft.com/training/modules/microsoft-defender-cloud-security-posture/",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "36a72a48-fffe-4c40-9747-0ab5064355ba",
            "link": "https://learn.microsoft.com/azure/defender-for-cloud/plan-defender-for-servers-select-plan",
            "service": "Defender",
            "services": [
                "WAF",
                "Subscriptions",
                "Defender"
            ],
            "severity": "High",
            "text": "Enable a Defender Cloud Workload Protection Plan for Servers on all subscriptions.",
            "training": "https://learn.microsoft.com/training/modules/understand-azure-defender-cloud-workload-protection/",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "77425f48-ecba-43a0-aeac-a3ac733ccc6a",
            "link": "https://learn.microsoft.com/azure/defender-for-cloud/connect-azure-subscription",
            "service": "Defender",
            "services": [
                "WAF",
                "Subscriptions",
                "Defender"
            ],
            "severity": "High",
            "text": "Enable Defender Cloud Workload Protection Plans for Azure Resources on all subscriptions.",
            "training": "https://learn.microsoft.com/training/modules/understand-azure-defender-cloud-workload-protection/",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "WAF checklist",
            "guid": "24d96b30-61ee-4436-a1cc-d6ef08bc574b",
            "link": "https://learn.microsoft.com/mem/configmgr/protect/deploy-use/endpoint-protection",
            "service": "VM",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Enable Endpoint Protection on IaaS Servers.",
            "training": "https://learn.microsoft.com/training/modules/design-solutions-securing-server-client-endpoints/",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "WAF checklist",
            "guid": "15833ee7-ad6c-46d3-9331-65c7acbe44ab",
            "link": "https://learn.microsoft.com/azure/security-center/",
            "service": "VM",
            "services": [
                "WAF",
                "Monitor",
                "Defender"
            ],
            "severity": "Medium",
            "text": "Monitor base operating system patching drift via Azure Monitor Logs and Defender for Cloud.",
            "training": "https://learn.microsoft.com/training/modules/create-log-analytics-workspace-microsoft-defender-cloud/",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Insights/components",
            "checklist": "WAF checklist",
            "guid": "e5f8d79f-2e87-4768-924c-516775c6ea95",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/design-logs-deployment",
            "service": "Monitor",
            "services": [
                "WAF",
                "Entra",
                "Monitor"
            ],
            "severity": "Medium",
            "text": "Connect default resource configurations to a centralized Azure Monitor Log Analytics workspace.",
            "training": "https://learn.microsoft.com/training/modules/analyze-infrastructure-with-azure-monitor-logs/",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "graph": "resources| where type == 'microsoft.operationalinsights/workspaces'| extend wsid = properties.customerId| project workspaceResourceId = tolower(id), name, wsid| join (resources| where type == 'microsoft.operationsmanagement/solutions'| where name has 'SecurityInsights'| extend workspaceResourceId = tostring(tolower(properties.workspaceResourceId))| project workspaceResourceId | summarize ResourceCount = count() by workspaceResourceId) on workspaceResourceId| extend RCount = iff(isnull(ResourceCount), 0, ResourceCount)| project-away ResourceCount| extend compliant = (RCount <> 0)",
            "guid": "a56888b2-7e83-4404-bd31-b886528502d1",
            "link": "https://learn.microsoft.com/en-us/azure/well-architected/security/monitor-threats#centralized-threat-detection-with-correlated-logs",
            "service": "Entra",
            "services": [
                "WAF",
                "Entra",
                "ACR"
            ],
            "severity": "High",
            "text": "Centralized threat detection with correlated logs -  consolidate security data in a central location where it can be correlated across various services via SIEM (security information and event management)",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "1761e147-f65e-4d09-bbc2-f464f23e2eba",
            "link": "https://learn.microsoft.com/industry/sovereignty/transparency-logs",
            "service": "Entra",
            "services": [
                "WAF",
                "Entra"
            ],
            "severity": "Medium",
            "text": "For Sovereign Landing Zone, enable transparancy logs on the Entra ID tenant.",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "d21a922d-5ca7-427a-82a6-35f7b21f1bfc",
            "link": "https://learn.microsoft.com/azure/security/fundamentals/customer-lockbox-overview",
            "service": "Entra",
            "services": [
                "WAF",
                "Entra"
            ],
            "severity": "Medium",
            "text": "For Sovereign Landing Zone, enable customer Lockbox on the Entra ID tenant.",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "WAF checklist",
            "guid": "b03ed428-4617-4067-a787-85468b9ccf3f",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-require-secure-transfer",
            "service": "Storage",
            "services": [
                "WAF",
                "Storage"
            ],
            "severity": "High",
            "text": "Enable secure transfer to storage accounts.",
            "training": "https://learn.microsoft.com/training/modules/secure-azure-storage-account/",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "WAF checklist",
            "guid": "159aac9f-863f-4f48-82cf-00c28fa97a0e",
            "link": "https://learn.microsoft.com/azure/storage/blobs/data-protection-overview#recommendations-for-basic-data-protection",
            "service": "Storage",
            "services": [
                "WAF",
                "Storage"
            ],
            "severity": "High",
            "text": "Enable container soft delete for the storage account to recover a deleted container and its contents.",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.KeyVault/vaults",
            "checklist": "WAF checklist",
            "guid": "108d5099-a11d-4445-bd8b-e12a5e95412e",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/development-strategy-development-lifecycle#automated-builds",
            "service": "Key Vault",
            "services": [
                "WAF",
                "AKV",
                "VM"
            ],
            "severity": "High",
            "text": "Use Key Vault secrets to avoid hard-coding sensitive information such as credentials (virtual machines user passwords), certificates or keys.",
            "training": "https://learn.microsoft.com/en-us/training/modules/implement-azure-key-vault/",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "WAF checklist",
            "guid": "b32e1aa1-4813-4602-88fe-27ca2891f421",
            "link": "https://learn.microsoft.com/en-us/azure/architecture/reference-architectures/app-service-web-app/zone-redundant?source=recommendations",
            "service": "App Services",
            "services": [
                "WAF"
            ],
            "severity": "Low",
            "text": "Refer to baseline highly available zone-redundant web application architecture for best practices",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "WAF checklist",
            "graph": "resources | where type =~ 'microsoft.web/serverfarms' | extend compliant = (sku.tier == 'Premium' or sku.tier == 'Standard') | distinct id,compliant",
            "guid": "e4b31c6a-2e3f-4df1-8e8b-9c3aa5a27820",
            "link": "https://learn.microsoft.com/en-us/azure/app-service/overview-hosting-plans",
            "service": "App Services",
            "services": [
                "WAF",
                "Backup"
            ],
            "severity": "Medium",
            "text": "Use Premium and Standard tiers. These tiers support staging slots and automated backups.",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "WAF checklist",
            "guid": "a7e2e6c2-491f-4fa4-a82b-521d0bc3b202",
            "link": "https://learn.microsoft.com/en-us/azure/reliability/migrate-app-service",
            "service": "App Services",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Leverage Availability Zones where regionally applicable (requires Premium v2 or v3 tier)",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "WAF checklist",
            "graph": "appserviceresources  | where type =~ 'microsoft.web/sites/config' | extend compliant = (properties.HealthCheckPath != '') | distinct id,compliant",
            "guid": "1275e4a9-7b6a-43c3-a9cd-5ee18d8995ad",
            "link": "https://learn.microsoft.com/en-us/azure/app-service/monitor-instances-health-check",
            "service": "App Services",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Implement health checks",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "WAF checklist",
            "guid": "35a91c5d-4ad6-4d9b-8e0f-c47db9e6d1e7",
            "link": "https://learn.microsoft.com/en-us/azure/app-service/manage-backup",
            "service": "App Services",
            "services": [
                "WAF",
                "AppSvc",
                "Backup"
            ],
            "severity": "High",
            "text": "Refer to backup and restore best practices for Azure App Service",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "WAF checklist",
            "guid": "e68cd0ec-afc6-4bd8-a27f-7860ad9a0db2",
            "link": "https://learn.microsoft.com/en-us/azure/architecture/framework/services/compute/azure-app-service/reliability",
            "service": "App Services",
            "services": [
                "WAF",
                "AppSvc"
            ],
            "severity": "High",
            "text": "Implement Azure App Service reliability best practices",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "WAF checklist",
            "guid": "bd2a865c-0835-4418-bb58-4df91a5a9b3f",
            "link": "https://learn.microsoft.com/en-us/azure/app-service/manage-disaster-recovery#recover-app-content-only",
            "service": "App Services",
            "services": [
                "WAF",
                "AppSvc"
            ],
            "severity": "Low",
            "text": "Familiarize with how to move an App Service app to another region During a disaster",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "WAF checklist",
            "guid": "f3d2f1e4-e6d4-4b7a-a5a5-e2a9b2c6f293",
            "link": "https://learn.microsoft.com/en-us/azure/reliability/reliability-app-service",
            "service": "App Services",
            "services": [
                "WAF",
                "AppSvc"
            ],
            "severity": "High",
            "text": "Familiarize with reliability support in Azure App Service",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "WAF checklist",
            "guid": "c7b5f3d1-0569-4fd2-9f32-c0b64e9c0c5e",
            "link": "https://learn.microsoft.com/en-us/azure/azure-functions/dedicated-plan#always-on",
            "service": "App Services",
            "services": [
                "WAF",
                "AppSvc"
            ],
            "severity": "Medium",
            "text": "Ensure \"Always On\" is enabled for Function Apps running on a app service plan",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "WAF checklist",
            "guid": "a3b4d5f6-758c-4f9d-9e1a-d7c6b7e8f9ab",
            "link": "https://learn.microsoft.com/en-us/azure/app-service/monitor-instances-health-check",
            "service": "App Services",
            "services": [
                "WAF",
                "AppSvc",
                "Monitor"
            ],
            "severity": "Medium",
            "text": "Monitor App Service instances using Health checks",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "WAF checklist",
            "guid": "c7d3e5f9-a19c-4833-8ca6-1dcb0128e129",
            "link": "https://learn.microsoft.com/en-us/azure/azure-monitor/app/availability-overview",
            "service": "App Services",
            "services": [
                "WAF",
                "Monitor"
            ],
            "severity": "Medium",
            "text": "Monitor availability and responsiveness of web app or website using Application Insights availability tests",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "WAF checklist",
            "guid": "b4e3f2d5-a5c6-4d7e-8b2f-c5d9e7a8f0ea",
            "link": "https://learn.microsoft.com/en-us/azure/azure-monitor/app/availability-standard-tests",
            "service": "App Services",
            "services": [
                "WAF",
                "Monitor"
            ],
            "severity": "Low",
            "text": "Use Application Insights Standard test to monitor availability and responsiveness of web app or website",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "WAF checklist",
            "description": "Use Azure Key Vault to store any secrets the application needs.  Key Vault provides a safe and audited environment for storing secrets and is well-integrated with App Service through the Key Vault SDK or App Service Key Vault References.",
            "guid": "834ac932-223e-4ce8-8b12-3071a5416415",
            "link": "https://learn.microsoft.com/azure/app-service/app-service-key-vault-references",
            "service": "App Services",
            "services": [
                "WAF",
                "AKV",
                "AppSvc"
            ],
            "severity": "High",
            "text": "Use Key Vault to store secrets",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "WAF checklist",
            "description": "Use a Managed Identity to connect to Key Vault either using the Key Vault SDK or through App Service Key Vault References.",
            "guid": "833ea3ad-2c2d-4e73-8165-c3acbef4abe1",
            "link": "https://learn.microsoft.com/azure/app-service/app-service-key-vault-references",
            "service": "App Services",
            "services": [
                "WAF",
                "AKV",
                "AppSvc",
                "Entra"
            ],
            "severity": "High",
            "text": "Use Managed Identity to connect to Key Vault",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "WAF checklist",
            "description": "Store the App Service TLS certificate in Key Vault.",
            "guid": "f8d39fda-4776-4831-9c11-5775c2ea55b4",
            "link": "https://learn.microsoft.com/azure/app-service/configure-ssl-certificate",
            "service": "App Services",
            "services": [
                "WAF",
                "AKV",
                "AppSvc"
            ],
            "severity": "High",
            "text": "Use Key Vault to store TLS certificate.",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "WAF checklist",
            "description": "Systems that process sensitive information should be isolated.  To do so, use separate App Service Plans or App Service Environments and consider the use of different subscriptions or management groups.",
            "guid": "6ad48408-ee72-4734-a475-ba18fdbf590c",
            "link": "https://learn.microsoft.com/azure/app-service/overview-hosting-plans",
            "service": "App Services",
            "services": [
                "WAF",
                "Subscriptions",
                "AppSvc"
            ],
            "severity": "Medium",
            "text": "Isolate systems that process sensitive information",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "WAF checklist",
            "description": "Local disks on App Service are not encrypted and sensitive data should not be stored on those.  (For example: D:\\\\Local and %TMP%).",
            "guid": "e65de8e0-3f9b-4cbd-9682-66abca264f9a",
            "link": "https://learn.microsoft.com/azure/app-service/operating-system-functionality#file-access",
            "service": "App Services",
            "services": [
                "WAF",
                "AppSvc",
                "TrafficManager"
            ],
            "severity": "Medium",
            "text": "Do not store sensitive data on local disk",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "WAF checklist",
            "description": "For authenticated web application, use a well established Identity Provider like Azure AD or Azure AD B2C.  Leverage the application framework of your choice to integrate with this provider or use the App Service Authentication / Authorization feature.",
            "guid": "919ca0b2-c121-459e-814b-933df574eccc",
            "link": "https://learn.microsoft.com/azure/app-service/overview-authentication-authorization",
            "service": "App Services",
            "services": [
                "WAF",
                "Entra",
                "AppSvc"
            ],
            "severity": "Medium",
            "text": "Use an established Identity Provider for authentication",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "WAF checklist",
            "description": "Deploy code to App Service from a controlled and trusted environment, like a well-managed and secured DevOps deployment pipeline. This avoids code that was not version controlled and verified to be deployed from a malicious host.",
            "guid": "3f9bcbd4-6826-46ab-aa26-4f9a19aed9c5",
            "link": "https://learn.microsoft.com/azure/app-service/deploy-best-practices",
            "service": "App Services",
            "services": [
                "WAF",
                "AppSvc"
            ],
            "severity": "High",
            "text": "Deploy from a trusted environment",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "WAF checklist",
            "description": "Disable basic authentication for both FTP/FTPS and for WebDeploy/SCM.  This disables access to these services and enforces the use of Azure AD secured endpoints for deployment.  Note that the SCM site can also be opened using Azure AD credentials.",
            "guid": "5d04c2c3-919c-4a0b-8c12-159e114b933d",
            "link": "https://learn.microsoft.com/azure/app-service/deploy-configure-credentials#disable-basic-authentication",
            "service": "App Services",
            "services": [
                "WAF",
                "Entra"
            ],
            "severity": "High",
            "text": "Disable basic authentication",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "WAF checklist",
            "description": "Where possible use Managed Identity to connect to Azure AD secured resources.  If this is not possible, store secrets in Key Vault and connect to Key Vault using a Managed Identity instead.",
            "guid": "f574eccc-d9bd-43ba-bcda-3b54eb2eb03d",
            "link": "https://learn.microsoft.com/azure/app-service/overview-managed-identity?tabs=portal%2Chttp",
            "service": "App Services",
            "services": [
                "WAF",
                "Entra",
                "AKV"
            ],
            "severity": "High",
            "text": "Use Managed Identity to connect to resources",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "WAF checklist",
            "description": "Where using images stored in Azure Container Registry, pull these using a Managed Identity.",
            "guid": "d9a25827-18d2-4ddb-8072-5769ee6691a4",
            "link": "https://learn.microsoft.com/azure/app-service/configure-custom-container#use-managed-identity-to-pull-image-from-azure-container-registry",
            "service": "App Services",
            "services": [
                "WAF",
                "Entra",
                "ACR"
            ],
            "severity": "High",
            "text": "Pull containers using a Managed Identity",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "WAF checklist",
            "description": "By configuring the diagnostic settings of App Service, you can send all telemetry to Log Analytics as the central destination for logging and monitoring. This allows you to monitor runtime activity of App Service such as HTTP logs, application logs, platform logs, ...",
            "guid": "47768314-c115-4775-a2ea-55b46ad48408",
            "link": "https://learn.microsoft.com/azure/app-service/troubleshoot-diagnostic-logs",
            "service": "App Services",
            "services": [
                "WAF",
                "Entra",
                "AppSvc",
                "Monitor"
            ],
            "severity": "Medium",
            "text": "Send App Service runtime logs to Log Analytics",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "WAF checklist",
            "description": "Set up a diagnostic setting to send the activity log to Log Analytics as the central destination for logging and monitoring. This allows you to monitor control plane activity on the App Service resource itself.",
            "guid": "ee72734b-475b-4a18-bdbf-590ce65de8e0",
            "link": "https://learn.microsoft.com/azure/azure-monitor/essentials/activity-log",
            "service": "App Services",
            "services": [
                "WAF",
                "Entra",
                "AppSvc",
                "Monitor"
            ],
            "severity": "Medium",
            "text": "Send App Service activity logs to Log Analytics",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "WAF checklist",
            "description": "Control outbound network access using a combination of regional VNet integration, network security groups and UDR's.  Traffic should be routed to an NVA such as Azure Firewall.  Ensure to monitor the Firewall's logs.",
            "guid": "c12159e1-14b9-433d-b574-ecccd9bd3baf",
            "link": "https://learn.microsoft.com/azure/app-service/overview-vnet-integration",
            "service": "App Services",
            "services": [
                "WAF",
                "Firewall",
                "VNet",
                "NVA",
                "Monitor"
            ],
            "severity": "Medium",
            "text": "Outbound network access should be controlled",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "WAF checklist",
            "description": "You can provide a stable outbound IP by using VNet integration and using a VNet NAT Gateway or an NVA like Azure Firewall.  This allows the receiving party to allow-list based on IP, should that be needed.  Note that for communications towards Azure Services often there's no need to depend on the IP address and mechanics like Service Endpoints should be used instead.  (Also the use of private endpoints on the receiving end avoids for SNAT to happen and provides a stable outbound IP range.)",
            "guid": "cda3b54e-b2eb-403d-b9a2-582718d2ddb1",
            "link": "https://learn.microsoft.com/azure/app-service/networking/nat-gateway-integration",
            "service": "App Services",
            "services": [
                "WAF",
                "Firewall",
                "PrivateLink",
                "VNet",
                "NVA",
                "Storage"
            ],
            "severity": "Low",
            "text": "Ensure a stable IP for outbound communications towards internet addresses",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "WAF checklist",
            "description": "Control inbound network access using a combination of App Service Access Restrictions, Service Endpoints or Private Endpoints. Different access restrictions can be required and configured for the web app itself and the SCM site.",
            "guid": "0725769e-e669-41a4-a34a-c932223ece80",
            "link": "https://learn.microsoft.com/azure/app-service/networking-features#access-restrictions",
            "service": "App Services",
            "services": [
                "WAF",
                "AppSvc",
                "PrivateLink"
            ],
            "severity": "High",
            "text": "Inbound network access should be controlled",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "WAF checklist",
            "description": "Protect against malicious inbound traffic using a Web Application Firewall like Application Gateway or Azure Front Door.  Make sure to monitor the WAF's logs.",
            "guid": "b123071a-5416-4415-a33e-a3ad2c2de732",
            "link": "https://learn.microsoft.com/azure/app-service/networking/app-gateway-with-service-endpoints",
            "service": "App Services",
            "services": [
                "WAF",
                "FrontDoor",
                "AppSvc",
                "AppGW",
                "Monitor"
            ],
            "severity": "High",
            "text": "Use a WAF in front of App Service",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "WAF checklist",
            "description": "Make sure the WAF cannot be bypassed by locking down access to only the WAF.  Use a combination of Access Restrictions, Service Endpoints and Private Endpoints.",
            "guid": "165c3acb-ef4a-4be1-b8d3-9fda47768314",
            "link": "https://learn.microsoft.com/azure/app-service/networking-features#access-restrictions",
            "service": "App Services",
            "services": [
                "WAF",
                "PrivateLink"
            ],
            "severity": "High",
            "text": "Avoid for WAF to be bypassed",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "WAF checklist",
            "description": "Set minimum TLS policy to 1.2 in App Service configuration.",
            "graph": "appserviceresources | where type =~ 'microsoft.web/sites/config' | extend compliant = (properties.MinTlsVersion>=1.2) | distinct id,compliant",
            "guid": "c115775c-2ea5-45b4-9ad4-8408ee72734b",
            "link": "https://learn.microsoft.com/azure/app-service/configure-ssl-bindings#enforce-tls-versions",
            "service": "App Services",
            "services": [
                "WAF",
                "AzurePolicy",
                "AppSvc"
            ],
            "severity": "Medium",
            "text": "Set minimum TLS policy to 1.2",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "WAF checklist",
            "description": "Configure App Service to use HTTPS only.  This causes App Service to redirect from HTTP to HTTPS.  Strongly consider the use of HTTP Strict Transport Security (HSTS) in your code or from your WAF, which informs browsers that the site should only be accessed using HTTPS.",
            "graph": "where (type=='microsoft.web/sites' and (kind == 'app' or kind == 'app,linux' )) | extend compliant = (properties.httpsOnly==true) | distinct id,compliant",
            "guid": "475ba18f-dbf5-490c-b65d-e8e03f9bcbd4",
            "link": "https://learn.microsoft.com/azure/app-service/configure-ssl-bindings#enforce-https",
            "service": "App Services",
            "services": [
                "WAF",
                "AppSvc"
            ],
            "severity": "High",
            "text": "Use HTTPS only",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "WAF checklist",
            "description": "Do not use wildcards in your CORS configuration, as this allows all origins to access the service (thereby defeating the purpose of CORS). Specifically only allow the origins that you expect to be able to access the service.",
            "guid": "68266abc-a264-4f9a-89ae-d9c55d04c2c3",
            "link": "https://learn.microsoft.com/azure/app-service/app-service-web-tutorial-rest-api",
            "service": "App Services",
            "services": [
                "WAF",
                "Storage"
            ],
            "severity": "High",
            "text": "Wildcards must not be used for CORS",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "WAF checklist",
            "description": "Remote debugging must not be turned on in production as this opens additional ports on the service which increases the attack surface. Note that the service does turn of remote debugging automatically after 48 hours.",
            "graph": "appserviceresources | where type =~ 'microsoft.web/sites/config' | extend compliant = (properties.RemoteDebuggingEnabled == false) | distinct id,compliant",
            "guid": "d9bd3baf-cda3-4b54-bb2e-b03dd9a25827",
            "link": "https://learn.microsoft.com/azure/app-service/configure-common#configure-general-settings",
            "service": "App Services",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Turn off remote debugging",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "WAF checklist",
            "description": "Enable Defender for App Service.  This (amongst other threats) detects communications to known malicious IP addresses.  Review the recommendations from Defender for App Service as part of your operations.",
            "guid": "18d2ddb1-0725-4769-be66-91a4834ac932",
            "link": "https://learn.microsoft.com/azure/defender-for-cloud/defender-for-app-service-introduction",
            "service": "App Services",
            "services": [
                "WAF",
                "AppSvc",
                "Defender"
            ],
            "severity": "Medium",
            "text": "Enable Defender for Cloud - Defender for App Service",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "WAF checklist",
            "description": "Azure provides DDoS Basic protection on its network, which can be improved with intelligent DDoS Standard capabilities which learns about normal traffic patterns and can detect unusual behavior. DDoS Standard applies to a Virtual Network so it must be configured for the network resource in front of the app, such as Application Gateway or an NVA.",
            "guid": "223ece80-b123-4071-a541-6415833ea3ad",
            "link": "https://learn.microsoft.com/azure/ddos-protection/ddos-protection-overview",
            "service": "App Services",
            "services": [
                "WAF",
                "VNet",
                "EventHubs",
                "DDoS",
                "NVA",
                "AppGW"
            ],
            "severity": "Medium",
            "text": "Enable DDOS Protection Standard on the WAF VNet",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "WAF checklist",
            "description": "Where using images stored in Azure Container Registry, pull these over a virtual network from Azure Container Registry using its private endpoint and the app setting 'WEBSITE_PULL_IMAGE_OVER_VNET'.",
            "guid": "2c2de732-165c-43ac-aef4-abe1f8d39fda",
            "link": "https://learn.microsoft.com/azure/app-service/configure-custom-container#use-an-image-from-a-network-protected-registry",
            "service": "App Services",
            "services": [
                "WAF",
                "VNet",
                "ACR",
                "PrivateLink"
            ],
            "severity": "Medium",
            "text": "Pull containers over a Virtual Network",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "WAF checklist",
            "description": "Conduct a penetration test on the web application following the penetration testing rules of engagement.",
            "guid": "eb2eb03d-d9a2-4582-918d-2ddb10725769",
            "link": "https://learn.microsoft.com/azure/security/fundamentals/pen-testing",
            "service": "App Services",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Conduct a penetration test",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "WAF checklist",
            "description": "Deploy trusted code that was validated and scanned for vulnerabilities according to DevSecOps practices.",
            "guid": "19aed9c5-5d04-4c2c-9919-ca0b2c12159e",
            "link": "https://learn.microsoft.com/azure/architecture/solution-ideas/articles/devsecops-in-azure",
            "service": "App Services",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Deploy validated code",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.web/sites",
            "checklist": "WAF checklist",
            "description": "Use the latest versions of supported platforms, programming languages, protocols, and frameworks.",
            "guid": "114b933d-f574-4ecc-ad9b-d3bafcda3b54",
            "link": "https://learn.microsoft.com/azure/app-service/overview-patch-os-runtime",
            "service": "App Services",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Use up-to-date platforms, languages, protocols and frameworks",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Devices/IotHubs",
            "checklist": "WAF checklist",
            "guid": "ac1d6380-f866-4bbd-a9b4-b1ee5d7908b8",
            "link": "https://learn.microsoft.com/azure/iot-hub/iot-hub-ha-dr#availability-zones",
            "service": "IoT",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Leverage  Availability Zones if regionally applicable (this is automatically enabled)",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Devices/IotHubs",
            "checklist": "WAF checklist",
            "guid": "35f651e8-0124-4ef7-8c57-658e38609e6e",
            "link": "https://learn.microsoft.com/azure/iot-hub/iot-hub-ha-dr#microsoft-initiated-failover",
            "service": "IoT",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Be aware of Microsoft-initiated failovers. These are exercised by Microsoft in rare situations to fail over all the IoT hubs from an affected region to the corresponding geo-paired region.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Devices/IotHubs",
            "checklist": "WAF checklist",
            "guid": "4ed3e490-dc06-4a1e-b467-5d0239d85540",
            "link": "https://learn.microsoft.com/azure/iot-hub/iot-hub-ha-dr#cross-region-dr",
            "service": "IoT",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Consider a Cross-Region DR strategy for critical workloads",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Devices/IotHubs",
            "checklist": "WAF checklist",
            "guid": "a11ecab0-db47-46f7-9aa7-17764e7e45a1",
            "link": "https://learn.microsoft.com/azure/iot-hub/iot-hub-ha-dr#microsoft-initiated-failover",
            "service": "IoT",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Learn how to trigger a manual failover.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Devices/IotHubs",
            "checklist": "WAF checklist",
            "guid": "f9db8dfb-1194-460b-aedd-34dd6a69db22",
            "link": "https://learn.microsoft.com/azure/iot-hub/iot-hub-ha-dr#failback",
            "service": "IoT",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Learn how to fail back after a failover.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachineScaleSets",
            "checklist": "WAF checklist",
            "description": "Automatic instance repairs ensure that unhealthy instances are promptly identified and replaced, maintaining a set of healthy instances within your scale set.",
            "guid": "7e13c105-675c-41e9-95b4-59837ff7ae7c",
            "link": "https://learn.microsoft.com/azure/virtual-machine-scale-sets/virtual-machine-scale-sets-automatic-instance-repairs",
            "service": "VMSS",
            "services": [
                "WAF",
                "VM"
            ],
            "severity": "Low",
            "text": "Enable automatic instance repairs for enhanced VM Scale Sets resiliency",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "WAF checklist",
            "description": "Ensure that Azure Backup is utilized appropriately to meet your organization's resiliency requirements for Azure virtual machines (VMs).",
            "guid": "4d874a74-8b66-42d6-b150-512a66498f6d",
            "link": "https://learn.microsoft.com/azure/backup/backup-azure-vms-introduction",
            "service": "VM",
            "services": [
                "WAF",
                "VM",
                "Backup"
            ],
            "severity": "High",
            "text": "Consider Azure Backup to meet your resiliency requirements for Azure VMs",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "WAF checklist",
            "description": "Single Instance VMs using Premium SSD or Ultra Disk for all Operating System Disks and Data Disks are guaranteed to have Virtual Machine Connectivity of at least 99.9%",
            "guid": "8052d88e-79d1-47b7-9b22-a5a67e7a8ed4",
            "link": "https://learn.microsoft.com/azure/virtual-machines/disks-types",
            "service": "VM",
            "services": [
                "WAF",
                "VM"
            ],
            "severity": "High",
            "text": "Use Premium or Ultra disks for production VMs",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "WAF checklist",
            "description": "Azure automatically replicates managed disks within a region to ensure data durability and protect against single-point failures.",
            "guid": "b31e38c3-f298-412b-8363-cffe179b599d",
            "link": "https://learn.microsoft.com/azure/virtual-machines/managed-disks-overview",
            "service": "VM",
            "services": [
                "WAF",
                "VM"
            ],
            "severity": "High",
            "text": "Ensure Managed Disks are used for all VMs",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "WAF checklist",
            "description": "Temporary disks are intended for short-term storage of non-persistent data such as page files, swap files, or SQL Server tempdb. Storing persistent data on temporary disks can lead to data loss during maintenance events or VM redeployment.",
            "guid": "e0d5973c-d4ce-432c-8881-37f6f7c4c0d4",
            "link": "https://learn.microsoft.com/azure/virtual-machines/managed-disks-overview#temporary-disk",
            "service": "VM",
            "services": [
                "WAF",
                "VM",
                "Storage",
                "SQL"
            ],
            "severity": "Medium",
            "text": "Do not use the Temp disk for anything that is not acceptable to be lost",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "WAF checklist",
            "description": "Co-locate your compute, storage, networking, and data resources across an availability zone, and replicate this arrangement in other availability zones.",
            "guid": "e514548d-2447-4ec6-9138-b8200f1ce16e",
            "link": "https://learn.microsoft.com/azure/reliability/availability-zones-overview",
            "service": "VM",
            "services": [
                "WAF",
                "ACR",
                "VM",
                "Storage"
            ],
            "severity": "Medium",
            "text": "Leverage Availability Zones for your VMs in regions where they are supported",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "WAF checklist",
            "description": "Use at least two VMs in Availability Sets to isolate VMs on different fault and update domains.",
            "guid": "5a785d6f-e96c-496a-b884-4cf3b2b38c88",
            "link": "https://learn.microsoft.com/azure/virtual-machines/availability-set-overview",
            "service": "VM",
            "services": [
                "WAF",
                "VM"
            ],
            "severity": "Medium",
            "text": "For regions that do not support Availability Zones deploy VMs into Availability Sets",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "WAF checklist",
            "description": "Azure provides multiple options for VM redundancy to meet different requirements (Availability Zones, Virtual Machine Scale Sets, Availability Sets, Azure Site Recovery)",
            "guid": "6ba2c021-4991-414a-9d3c-e574dccbd979",
            "link": "https://learn.microsoft.com/azure/virtual-machines/availability",
            "service": "VM",
            "services": [
                "WAF",
                "VM",
                "ASR"
            ],
            "severity": "High",
            "text": "Avoid running a production workload on a single VM",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "WAF checklist",
            "description": "Azure Site Recovery enables you to achieve low RTO (Recovery Time Objective) for your Azure and hybrid VMs by providing continuous replication and failover capabilities.",
            "guid": "2a6bcca2-b5fe-4a1e-af3d-d95d48c7c891",
            "link": "https://learn.microsoft.com/azure/site-recovery/site-recovery-overview",
            "service": "VM",
            "services": [
                "WAF",
                "AVS",
                "VM",
                "ASR"
            ],
            "severity": "High",
            "text": "For Azure and on-premises VMs (Hyper-V/Phyiscal/VMware) with low RTO requirements use Azure Site Recovery",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "WAF checklist",
            "description": "By using Capacity Reservations, you can effectively manage capacity for critical workloads, ensuring resource availability in specified regions.",
            "guid": "bd7bb012-f7b9-45e0-9e15-8e3ea3992c2d",
            "link": "https://learn.microsoft.com/azure/virtual-machines/capacity-reservation-overview",
            "service": "VM",
            "services": [
                "WAF"
            ],
            "severity": "Low",
            "text": "Use Capacity Reservations for critical workloads that require guaranteed capacity",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "WAF checklist",
            "description": "By ensuring that the necessary quotas are increased in your DR region before testing failover with ASR, you can avoid any potential resource constraints during the recovery process for failed over VMs.",
            "guid": "e6e2065b-3a76-4af4-a691-e8939ada4666",
            "link": "https://learn.microsoft.com/azure/quotas/per-vm-quota-requests",
            "service": "VM",
            "services": [
                "WAF",
                "VM",
                "ASR"
            ],
            "severity": "Medium",
            "text": "Increase quotas in DR region before testing failover with ASR",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "WAF checklist",
            "description": "Scheduled Events is an Azure Metadata Service that provides information about upcoming maintenance events for virtual machines (VMs). By leveraging Scheduled Events, you can proactively prepare your applications for VM maintenance, minimizing disruption and improving the availability of your VMs.",
            "guid": "6d3b475a-5c7a-4cbe-99bb-e64dd8902e87",
            "link": "https://learn.microsoft.com/azure/virtual-machines/windows/scheduled-events",
            "service": "VM",
            "services": [
                "WAF",
                "VM"
            ],
            "severity": "Low",
            "text": "Utilize Scheduled Events to prepare for VM maintenance",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "WAF checklist",
            "description": "Use Zone-redundant Storage (ZRS) in the primary region for scenarios that require high availability and for restricting replication to a particular country or region. For protection against regional disasters, use Geo-zone-redundant Storage (GZRS), which combines ZRS in the primary region with geo-replication to a secondary region?.",
            "guid": "48c7c891-dcb1-4f7d-9769-ae568ba38d4a",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-redundancy",
            "service": "Azure Storage",
            "services": [
                "WAF",
                "Storage"
            ],
            "severity": "Medium",
            "text": "Choose the most appropriate data redundancy option for Azure Storage based on your requirements",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "WAF checklist",
            "description": "Assigning a Delete lock to your storage account helps protect the availability of your data, minimizing the risk of disruptions to your business operations.",
            "guid": "85e2213d-bd7b-4b01-8f7b-95e06e158e3e",
            "link": "https://learn.microsoft.com/azure/storage/common/lock-account-resource",
            "service": "Azure Storage",
            "services": [
                "WAF",
                "Storage"
            ],
            "severity": "Low",
            "text": "Apply a Delete lock to prevent accidental or malicious deletion of storage accounts",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "WAF checklist",
            "description": "Container soft delete protects your data from being accidentally deleted by maintaining the deleted data in the system for a specified period of time.",
            "guid": "a3992c2d-e6e2-4065-a3a7-6af4a691e893",
            "link": "https://learn.microsoft.com/azure/storage/blobs/soft-delete-container-enable",
            "service": "Azure Storage",
            "services": [
                "WAF",
                "Storage"
            ],
            "severity": "Low",
            "text": "Enable soft delete for Storage Account Containers",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "WAF checklist",
            "description": "Blob soft delete protects an individual blob and its versions, snapshots, and metadata from accidental deletes or overwrites by maintaining the deleted data in the system for a specified period of time.",
            "guid": "9ada4666-7e13-4c10-96b9-153d89f89dc7",
            "link": "https://learn.microsoft.com/azure/storage/blobs/soft-delete-blob-enable",
            "service": "Azure Storage",
            "services": [
                "WAF",
                "Storage"
            ],
            "severity": "Low",
            "text": "Enable soft delete for blobs",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.RecoveryServices/vaults",
            "checklist": "WAF checklist",
            "description": "Azure Backup enhanced soft delete provides critical protection against ransomware attacks by retaining deleted backups, enabling recovery from potential ransomware encryption or deletion.",
            "guid": "b44be3b1-a27f-48b9-b91b-e1038df03a82",
            "link": "https://learn.microsoft.com/azure/backup/backup-azure-enhanced-soft-delete-about",
            "service": "Azure Backup",
            "services": [
                "WAF",
                "Backup"
            ],
            "severity": "Medium",
            "text": "Enable Azure Backup enhanced soft delete for improved data protection and recovery",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.RecoveryServices/vaults",
            "checklist": "WAF checklist",
            "description": "Azure Backup's multi-user authorization enables fine-grained control over user access to backup resources, allowing you to restrict privileges and ensure proper authentication and authorization for backup operations.",
            "guid": "2cd463cb-bbc8-4ac2-a9eb-c92a43da1dae",
            "link": "https://learn.microsoft.com/azure/backup/multi-user-authorization-concept",
            "service": "Azure Backup",
            "services": [
                "WAF",
                "Backup"
            ],
            "severity": "Low",
            "text": "Implement multi-user authorization for Azure Backup to ensure secure and controlled access to backup resources",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.RecoveryServices/vaults",
            "checklist": "WAF checklist",
            "description": "Azure Immutable Storage provides an additional layer of security by ensuring that backup data stored in the vault cannot be modified or deleted for a specified retention period. This helps safeguard your backups from ransomware attacks that may attempt to compromise or manipulate your backup data.",
            "guid": "2cc88147-0607-4c1c-aa0e-614658dd458e",
            "link": "https://learn.microsoft.com/azure/backup/backup-azure-immutable-vault-concept?source=recommendations&tabs=recovery-services-vault",
            "service": "Azure Backup",
            "services": [
                "WAF",
                "Storage",
                "Backup"
            ],
            "severity": "Low",
            "text": "Implement Immutable Storage for your vaults to protect against ransomware and prevent unauthorized modifications to backups",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Network/dnsZones",
            "checklist": "WAF checklist",
            "description": "To eliminate a single point of failure in your on-premises DNS services and ensure reliable DNS resolution during business continuity and disaster recovery scenarios, it is recommended to utilize Azure DNS Private Resolvers in multiple regions. By deploying two or more Azure DNS private resolvers across different regions, you can enable DNS failover and achieve resiliency in your DNS infrastructure.",
            "guid": "43da1dae-2cc8-4814-9060-7c1cca0e6146",
            "link": "https://learn.microsoft.com/azure/dns/tutorial-dns-private-resolver-failover",
            "service": "DNS",
            "services": [
                "WAF",
                "DNS",
                "ACR",
                "ASR"
            ],
            "severity": "Low",
            "text": "Implement DNS Failover using Azure DNS Private Resolvers",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.PowerBI/gateways",
            "checklist": "WAF checklist",
            "description": "Use an on-premises data gateway cluster to avoid single points of failure and to load balance traffic across gateways.",
            "guid": "89f89dc7-b44b-4e3b-8a27-f8b9e91be103",
            "link": "https://learn.microsoft.com/data-integration/gateway/service-gateway-high-availability-clusters",
            "service": "Data Gateways",
            "services": [
                "WAF",
                "ACR"
            ],
            "severity": "Medium",
            "text": "Use on-premises data gateway clusters to ensure high availability for business-critical data",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "WAF checklist",
            "description": "When choosing the best option for deploying NVAs in Azure, it is crucial to consider the vendor's recommendations and validate that the specific design has been vetted and validated by the NVA vendor. The vendor should also provide the necessary NVA configuration for seamless integration in Azure.",
            "guid": "8b1188b3-c6a4-46ce-a544-451e192d3442",
            "link": "https://learn.microsoft.com/azure/architecture/reference-architectures/dmz/nva-ha",
            "service": "NVA",
            "services": [
                "WAF",
                "NVA"
            ],
            "severity": "High",
            "text": "Deploy Network Virtual Appliances (NVAs) in a vendor supported configuration for High Availability",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.KeyVault/vaults",
            "checklist": "WAF checklist",
            "guid": "6d37a33b-531c-4a91-871a-b69d8044f04e",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "services": [
                "WAF",
                "AKV",
                "Backup"
            ],
            "severity": "High",
            "text": "Familiarize yourself with the Key Vault's best practices such as isolation recommendations, access control, data protection, backup, and logging.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.KeyVault/vaults",
            "checklist": "WAF checklist",
            "guid": "7ba4d380-7b9e-4a8b-a0c3-2d8e49c11872",
            "link": "https://learn.microsoft.com/azure/key-vault/general/disaster-recovery-guidance",
            "service": "Key Vault",
            "services": [
                "WAF",
                "AKV",
                "ACR"
            ],
            "severity": "Medium",
            "text": "Key Vault is a managed service and Microsoft will handle the failover within and across region. Familiarize yourself with the Key Vault's availability and redundancy.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.KeyVault/vaults",
            "checklist": "WAF checklist",
            "guid": "17fb86a2-eb45-42a4-9c34-52b92a2a1842",
            "link": "https://learn.microsoft.com/azure/key-vault/general/disaster-recovery-guidance#data-replication",
            "service": "Key Vault",
            "services": [
                "WAF",
                "AKV"
            ],
            "severity": "Medium",
            "text": "The contents of your key vault are replicated within the region and to a secondary region at least 150 miles away, but within the same geography to maintain high durability of your keys and secrets. Familiarize yourself with the Key Vault's data replication.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.KeyVault/vaults",
            "checklist": "WAF checklist",
            "guid": "614682ca-6e0c-4f34-9f03-c6d3f2b99a32",
            "link": "https://learn.microsoft.com/azure/key-vault/general/disaster-recovery-guidance#failover-across-regions",
            "service": "Key Vault",
            "services": [
                "WAF",
                "AKV",
                "AzurePolicy"
            ],
            "severity": "Medium",
            "text": "During failover, access policy or firewall configurations and settings can't be changed. The key vault will be in read-only mode during failover. Familiarize yourself with the Key Vault's failover guidance.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.KeyVault/vaults",
            "checklist": "WAF checklist",
            "guid": "9ef2b0d2-3206-4c94-b47a-4f07e6a1c509",
            "link": "https://learn.microsoft.com/azure/key-vault/general/backup?tabs=azure-cli#design-considerations",
            "service": "Key Vault",
            "services": [
                "WAF",
                "AKV",
                "Backup",
                "Subscriptions",
                "Storage"
            ],
            "severity": "Medium",
            "text": "When you back up a key vault object, such as a secret, key, or certificate, the backup operation will download the object as an encrypted blob. This blob can't be decrypted outside of Azure. To get usable data from this blob, you must restore the blob into a key vault within the same Azure subscription and Azure geography. Familiarize yourself with the Key Vault's backup and restore guidance.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.KeyVault/vaults",
            "checklist": "WAF checklist",
            "guid": "2df045b1-c0f6-47d3-9a9b-99cf6999684e",
            "link": "https://learn.microsoft.com/azure/key-vault/general/soft-delete-overview",
            "service": "Key Vault",
            "services": [
                "WAF",
                "AKV"
            ],
            "severity": "High",
            "text": "If you want protection against accidental or malicious deletion of your secrets, configure soft-delete and purge protection features on your key vault.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.KeyVault/vaults",
            "checklist": "WAF checklist",
            "guid": "cbfa96b0-5249-4e6f-947c-d0e79509708c",
            "link": "https://learn.microsoft.com/azure/key-vault/general/soft-delete-overview",
            "service": "Key Vault",
            "services": [
                "WAF",
                "AKV"
            ],
            "severity": "Low",
            "text": "Key Vault's soft-deleted resources are retained for a set period of 90 calendar days. Familiarize yourself with the Key Vault's soft-delete guidance.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.KeyVault/vaults",
            "checklist": "WAF checklist",
            "guid": "e8659d11-7e02-4db0-848c-c6541dbab68c",
            "link": "https://learn.microsoft.com/azure/key-vault/general/backup?tabs=azure-cli#limitations",
            "service": "Key Vault",
            "services": [
                "WAF",
                "AKV",
                "Backup"
            ],
            "severity": "Low",
            "text": "Understand Key Vault's backup limitations. Key Vault does not support the ability to backup more than 500 past versions of a key, secret, or certificate object. Attempting to backup a key, secret, or certificate object may result in an error. It is not possible to delete previous versions of a key, secret, or certificate.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.KeyVault/vaults",
            "checklist": "WAF checklist",
            "guid": "45c25e29-d0ef-4f07-aa04-0f8c64cbcc04",
            "link": "https://learn.microsoft.com/azure/key-vault/general/backup?tabs=azure-cli#limitations",
            "service": "Key Vault",
            "services": [
                "WAF",
                "AKV",
                "Backup"
            ],
            "severity": "Low",
            "text": "Key Vault doesn't currently provide a way to back up an entire key vault in a single operation and keys, secrets and certitificates must be backup indvidually. Familiarize yourself with the Key Vault's backup and restore guidance.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.KeyVault/vaults",
            "checklist": "WAF checklist",
            "guid": "0f15640b-31e5-4de6-85a7-d2c652fa09d3",
            "link": "https://learn.microsoft.com/azure/key-vault/general/soft-delete-overview#purge-protection",
            "service": "Key Vault",
            "services": [
                "WAF",
                "AKV",
                "EventHubs"
            ],
            "severity": "Medium",
            "text": "Purge protection is recommended when using keys for encryption to prevent data loss. Purge protection is an optional Key Vault behavior and is not enabled by default. Purge protection can only be enabled once soft-delete is enabled. It can be turned on via CLI, PowerShell or Portal.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.KeyVault/vaults",
            "checklist": "WAF checklist",
            "graph": "resources| where type =~ 'microsoft.keyvault/vaults' | extend compliant = (properties.enableRbacAuthorization == true) | distinct id, compliant",
            "guid": "d0642c1c-312b-4116-94ab-439e1c836819",
            "link": "https://learn.microsoft.com/azure/key-vault/general/rbac-guide?tabs=azure-cli",
            "service": "Key Vault",
            "services": [
                "WAF",
                "AKV",
                "RBAC"
            ],
            "severity": "Medium",
            "text": "RBAC is recommended to control access to your key vault. Familiarize yourself with the Key Vault's access control guidance.",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Kusto/clusters",
            "checklist": "WAF checklist",
            "description": "Using the correct approach to feed a datalake with cold data and having the Kusto query engine at your disposal at the same time, as in the short-term storage",
            "guid": "ba7da7be-9951-4914-a384-5d997cb39132",
            "link": "https://learn.microsoft.com/azure/data-explorer/kusto/management/data-export/continuous-data-export",
            "service": "Azure Data Explorer",
            "services": [
                "WAF",
                "Cost",
                "Storage"
            ],
            "text": "Leverage External Tables and Continuous data export overview to reduce costs",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Kusto/clusters",
            "checklist": "WAF checklist",
            "description": "Azure Data Explorer provides an optional follower capability for a leader cluster to be followed by other follower clusters for read-only access to the leader's data and metadata. Changes in the leader, such as create, append, and drop are automatically synchronized to the follower. While the leaders could span Azure regions, the follower clusters should be hosted in the same region(s) as the leader. If the leader cluster is down or databases or tables are accidentally dropped, the follower clusters will lose access until access is recovered in the leader.",
            "guid": "56a22586-f490-4641-addd-ea8a377cdeb3",
            "link": "https://learn.microsoft.com/azure/data-explorer/follower?tabs=csharp",
            "service": "Azure Data Explorer",
            "services": [
                "WAF",
                "Storage"
            ],
            "text": "To share data, explore Leader-follower cluster configuration",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Kusto/clusters",
            "checklist": "WAF checklist",
            "description": "Azure Data Explorer doesn't support automatic protection against the outage of an entire Azure region. This disruption can happen during a natural disaster, like an earthquake. If you require a solution for a disaster recovery situation, do the following steps to ensure business continuity. In these steps, you'll replicate your clusters, management, and data ingestion in two Azure paired regions.",
            "guid": "861bb2bc-14ae-4a6e-95d8-d9a3adc218e6",
            "link": "https://learn.microsoft.com/azure/data-explorer/business-continuity-create-solution#create-multiple-independent-clusters",
            "service": "Azure Data Explorer",
            "services": [
                "WAF",
                "ASR"
            ],
            "text": "To protect against regional failure, create Multiple independent clusters, preferably in two Azure Paired regions",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Kusto/clusters",
            "checklist": "WAF checklist",
            "guid": "436b0635-cb45-4e57-a603-324ace8cc123",
            "link": "https://learn.microsoft.com/azure/data-explorer/business-continuity-create-solution#replicate-management-activities",
            "service": "Azure Data Explorer",
            "services": [
                "WAF",
                "RBAC",
                "Storage"
            ],
            "text": "Replicate all management activities such as creating new tables or managing user roles on each cluster.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Kusto/clusters",
            "checklist": "WAF checklist",
            "guid": "18ca6017-0265-4f4b-a46a-393af7f31728",
            "link": "https://learn.microsoft.com/azure/data-explorer/business-continuity-create-solution",
            "service": "Azure Data Explorer",
            "services": [
                "WAF"
            ],
            "text": "Ingest data into each cluster in parallel",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Kusto/clusters",
            "checklist": "WAF checklist",
            "description": "This configuration is also called 'always-on'. For critical application deployments with no tolerance for outages, you should use multiple Azure Data Explorer clusters across Azure paired regions.",
            "guid": "58a9c279-9c42-4bb6-9d0c-65556246b338",
            "link": "https://learn.microsoft.com/azure/data-explorer/business-continuity-overview#active-active-active-configuration",
            "service": "Azure Data Explorer",
            "services": [
                "WAF",
                "ACR"
            ],
            "text": "For critical application with no tolerance for outages, create Active-Active-Active (always-on) configuration",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Kusto/clusters",
            "checklist": "WAF checklist",
            "description": "This configuration is identical to the active-active-active configuration, but only involves two Azure paired regions. Configure dual ingestion, processing, and curation. Users are routed to the nearest region. The cluster SKU must be the same across regions.",
            "guid": "563a4dc7-4a74-48b6-922a-d190916a6649",
            "link": "https://learn.microsoft.com/azure/data-explorer/business-continuity-overview#active-active-configuration",
            "service": "Azure Data Explorer",
            "services": [
                "WAF",
                "ACR"
            ],
            "text": "For critical applications, create Active-Active configuration in two paired regions",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Kusto/clusters",
            "checklist": "WAF checklist",
            "description": "The Active-Hot configuration is similar to the Active-Active configuration in dual ingest, processing, and curation. While the standby cluster is online for ingestion, process, and curation, it isn't available to query. The standby cluster doesn't need to be in the same SKU as the primary cluster. It can be of a smaller SKU and scale, which may result in it being less performant. In a disaster scenario, users are redirected to the standby cluster, which can optionally be scaled up to increase performance.",
            "guid": "8fadfe27-7de2-483b-8ac3-52baa9b75708",
            "link": "https://learn.microsoft.com/azure/data-explorer/business-continuity-overview#active-hot-standby-configuration",
            "service": "Azure Data Explorer",
            "services": [
                "WAF"
            ],
            "text": "For applications, which required only read during failure, create Active-Hot standby configuration",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Kusto/clusters",
            "checklist": "WAF checklist",
            "description": "This solution offers the least resiliency (highest RPO and RTO), is the lowest in cost and highest in effort. In this configuration, there's no data recovery cluster. Configure continuous export of curated data (unless raw and intermediate data is also required) to a storage account that is configured GRS (Geo Redundant Storage). A data recovery cluster is spun up if there is a disaster recovery scenario. At that time, DDLs, configuration, policies, and processes are applied. Data is ingested from storage with the ingestion property kustoCreationTime to over-ride the ingestion time that defaults to system time.",
            "guid": "49aa8092-dc8e-4b9d-8bb7-3b26a5a67eba",
            "link": "https://learn.microsoft.com/azure/data-explorer/business-continuity-overview#on-demand-data-recovery-configuration",
            "service": "Azure Data Explorer",
            "services": [
                "WAF",
                "Cost",
                "ASR",
                "AzurePolicy",
                "Storage"
            ],
            "text": "For applications, where cost is a concern and can withstand some downtime during failure, create on-demand data recovery cluster configuration",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Kusto/clusters",
            "checklist": "WAF checklist",
            "description": "All database objects, policies, and configurations should be persisted in source control so they can be released to the cluster from your release automation tool.",
            "guid": "5a907e1e-348e-4f25-9c27-d32e8bbac757",
            "link": "https://learn.microsoft.com/azure/data-explorer/devops",
            "service": "Azure Data Explorer",
            "services": [
                "WAF",
                "AzurePolicy"
            ],
            "text": "Wrap DevOps and source control around all your code",
            "training": "https://learn.microsoft.com/learn/paths/secure-your-cloud-data/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Kusto/clusters",
            "checklist": "WAF checklist",
            "guid": "1559ab91-53e8-4908-ae28-b84c33b6b780",
            "link": "https://learn.microsoft.com/azure/data-explorer/devops",
            "service": "Azure Data Explorer",
            "services": [
                "WAF"
            ],
            "text": "Design, develop, and implement validation routines to ensure all clusters are in-sync from a data perspective.",
            "training": "https://learn.microsoft.com/learn/modules/azure-active-directory/",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Kusto/clusters",
            "checklist": "WAF checklist",
            "guid": "8b9fe5c4-1049-4d40-9a82-2c3474d00f18",
            "link": "https://learn.microsoft.com/azure/data-explorer/devops",
            "service": "Azure Data Explorer",
            "services": [
                "WAF"
            ],
            "text": "Be fully cognizant of what it takes to build a cluster from scratch. Leverage Infrastructure as a Code for your deployments",
            "training": "https://learn.microsoft.com/learn/modules/implement-hybrid-identity-windows-server/",
            "waf": "Reliability"
        },
        {
            "checklist": "WAF checklist",
            "guid": "4620dc87-e948-4ce8-8426-f3e6e5d7bd85",
            "link": "https://learn.microsoft.com/azure/sap/center-sap-solutions/overview",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP"
            ],
            "severity": "Medium",
            "text": "Azure Center for SAP solutions (ACSS) is an Azure offering that makes SAP a top-level workload on Azure. ACSS is an end-to-end solution that enables you to create and run SAP systems as a unified workload on Azure and provides a more seamless foundation for innovation. You can take advantage of the management capabilities for both new and existing Azure-based SAP systems.",
            "training": "https://learn.microsoft.com/training/modules/explore-azure-center-sap-solutions/?source=recommendations",
            "waf": "Operations"
        },
        {
            "checklist": "WAF checklist",
            "guid": "5d75e99d-624d-4afe-91d9-e17adc580790",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/sap/eslz-platform-automation-and-devops",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP"
            ],
            "severity": "Medium",
            "text": "Azure supports automating SAP deployments in Linux and Windows. SAP Deployment Automation Framework is an open-source orchestration tool that can deploy, install, and maintain SAP environments.",
            "training": "https://github.com/Azure/sap-automation",
            "waf": "Operations"
        },
        {
            "checklist": "WAF checklist",
            "guid": "d17f6f39-a377-48a2-931f-5ead3ebe33a8",
            "link": "https://learn.microsoft.com/azure/well-architected/sap/design-areas/data-platform",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP"
            ],
            "severity": "Medium",
            "text": "Perform a point-in-time recovery for your production databases at any point and in a time frame that meets your RTO; point-in-time recovery typically includes operator errors deleting data either on the DBMS layer or through SAP, incidentally",
            "waf": "Reliability"
        },
        {
            "checklist": "WAF checklist",
            "guid": "c4b8e117-930b-4dbd-ae50-7bc5faf6f91a",
            "service": "SAP",
            "services": [
                "WAF",
                "Backup"
            ],
            "severity": "Medium",
            "text": "Test the backup and recovery times to verify that they meet your RTO requirements for restoring all systems simultaneously after a disaster.",
            "waf": "Reliability"
        },
        {
            "checklist": "WAF checklist",
            "guid": "b651423c-8552-42db-a545-5cb50c05527a",
            "link": "https://learn.microsoft.com/azure/reliability/cross-region-replication-azure",
            "service": "SAP",
            "services": [
                "WAF",
                "SQL",
                "SAP",
                "ASR",
                "Backup",
                "Storage"
            ],
            "severity": "High",
            "text": "You can replicate standard storage between paired regions, but you can't use standard storage to store your databases or virtual hard disks. You can replicate backups only between paired regions that you use. For all your other data, run your replication by using native DBMS features like SQL Server Always On or SAP HANA System Replication. Use a combination of Site Recovery, rsync or robocopy, and other third-party software for the SAP application layer.",
            "training": "https://learn.microsoft.com/training/paths/ensure-business-continuity-implement-disaster-recovery/",
            "waf": "Reliability"
        },
        {
            "checklist": "WAF checklist",
            "guid": "aa208dca-784f-46c6-9014-cc919c542dc9",
            "link": "https://learn.microsoft.com/azure/sap/workloads/high-availability-zones",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP"
            ],
            "severity": "Medium",
            "text": "When using Azure Availability Zones to achieve high availability, you must consider latency between SAP application servers and database servers. For zones with high latencies, operational procedures need to be in place to ensure that SAP application servers and database servers are running in the same zone at all times.",
            "training": "https://learn.microsoft.com/training/modules/implement-high-availability-for-sap-workloads-azure/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "checklist": "WAF checklist",
            "guid": "ba07c007-1f90-43e9-aa4f-601346b80352",
            "link": "https://learn.microsoft.com/azure/expressroute/designing-for-disaster-recovery-with-expressroute-privatepeering",
            "service": "SAP",
            "services": [
                "WAF",
                "ExpressRoute",
                "VPN",
                "ASR"
            ],
            "severity": "High",
            "text": "Set up ExpressRoute connections from on-premises to the primary and secondary Azure disaster recovery regions. Also, as an alternative to using ExpressRoute, consider setting up VPN connections from on-premises to the primary and secondary Azure disaster recovery regions.",
            "training": "https://learn.microsoft.com/azure/expressroute/use-s2s-vpn-as-backup-for-expressroute-privatepeering",
            "waf": "Reliability"
        },
        {
            "checklist": "WAF checklist",
            "guid": "d2b30195-b11d-4a8f-a672-28b2b4169a7c",
            "link": "https://learn.microsoft.com/azure/key-vault/general/disaster-recovery-guidance",
            "service": "SAP",
            "services": [
                "WAF",
                "AKV",
                "ACR"
            ],
            "severity": "Low",
            "text": "Replicate key vault contents like certificates, secrets, or keys across regions so you can decrypt data in the DR region.",
            "waf": "Reliability"
        },
        {
            "checklist": "WAF checklist",
            "guid": "05f1101d-250f-40e7-b2a1-b674ab50edbd",
            "link": "https://learn.microsoft.com/azure/architecture/guide/sap/sap-s4hana",
            "service": "SAP",
            "services": [
                "WAF",
                "VNet",
                "SAP",
                "ASR"
            ],
            "severity": "Medium",
            "text": "Peer the primary and disaster recovery virtual networks. For example, for HANA System Replication, an SAP HANA DB virtual network needs to be peered to the disaster recovery site's SAP HANA DB virtual network.",
            "waf": "Reliability"
        },
        {
            "checklist": "WAF checklist",
            "guid": "d3351bf7-628a-46de-917d-dfc11d3b6b40",
            "link": "https://learn.microsoft.com/azure/azure-netapp-files/azure-netapp-files-service-levels",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP",
                "Storage"
            ],
            "severity": "Low",
            "text": "If you use Azure NetApp Files storage for your SAP deployments, at a minimum, create two Azure NetApp Files accounts in the Premium tier, in two regions.",
            "training": "https://learn.microsoft.com/training/modules/choose-service-level-azure-netapp-files-hpc-applications/2-identify-decision-criteria",
            "waf": "Reliability"
        },
        {
            "checklist": "WAF checklist",
            "guid": "726a1d3e-5508-4a06-9d54-93f4b50040c1",
            "link": "https://learn.microsoft.com/azure/sap/workloads/disaster-recovery-sap-guide?tabs=windows",
            "service": "SAP",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Native database replication technology should be used to synchronize the database in a HA pair.",
            "training": "https://learn.microsoft.com/training/modules/implement-disaster-recovery-for-sap-workloads-azure/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "checklist": "WAF checklist",
            "guid": "6561f847-3db5-4ff8-9200-5ad3c3b436ad",
            "link": "https://learn.microsoft.com/ja-jp/azure/virtual-network/virtual-networks-faq",
            "service": "SAP",
            "services": [
                "WAF",
                "VNet"
            ],
            "severity": "High",
            "text": "The CIDR for the primary virtual network (VNet) shouldn't conflict or overlap with the CIDR of the DR site's VNet",
            "training": "https://learn.microsoft.com/training/paths/azure-fundamentals-describe-azure-architecture-services/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "checklist": "WAF checklist",
            "guid": "0258ed30-fe42-434f-87b9-58f91f908e0a",
            "service": "SAP",
            "services": [
                "WAF",
                "Entra",
                "VM",
                "ASR"
            ],
            "severity": "High",
            "text": "Use Site Recovery to replicate an application server to a DR site. Site Recovery can also help with replicating central-services cluster VMs to the DR site. When you invoke DR, you'll need to reconfigure the Linux Pacemaker cluster on the DR site (for example, replace the VIP or SBD, run corosync.conf, and more).",
            "training": "https://learn.microsoft.com/training/paths/ensure-business-continuity-implement-disaster-recovery/",
            "waf": "Reliability"
        },
        {
            "checklist": "WAF checklist",
            "guid": "8300cb30-766b-4084-b126-0dd8fb1269a1",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/sap/eslz-business-continuity-and-disaster-recovery",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP"
            ],
            "severity": "High",
            "text": "Consider the availability of SAP software against single points of failure. This includes single points of failure within applications such as DBMSs utilized in SAP NetWeaver and SAP S/4HANA architectures, SAP ABAP and ASCS + SCS. Also, other tools such as SAP Web Dispatcher.",
            "training": "https://learn.microsoft.com/training/modules/implement-high-availability-for-sap-workloads-azure/2-explore-high-availability-disaster-recovery-support-azure-for-sap-workloads?source=recommendations",
            "waf": "Reliability"
        },
        {
            "checklist": "WAF checklist",
            "guid": "56402f11-ccbe-42c3-a2f6-c6f6f38ab579",
            "link": "https://learn.microsoft.com/azure/sap/workloads/planning-supported-configurations",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP"
            ],
            "severity": "High",
            "text": "For SAP and SAP databases, consider implementing automatic failover clusters. In Windows, Windows Server Failover Clustering supports failover. In Linux, Linux Pacemaker or third-party tools like SIOS Protection Suite and Veritas InfoScale support failover.",
            "training": "https://learn.microsoft.com/training/modules/implement-ha-sap-netweaver-anydb/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "checklist": "WAF checklist",
            "guid": "afae6bec-2671-49ae-bc69-140b8ec8d320",
            "link": "https://learn.microsoft.com/azure/sap/workloads/disaster-recovery-sap-guide?tabs=windows",
            "service": "SAP",
            "services": [
                "WAF",
                "VM",
                "Storage"
            ],
            "severity": "High",
            "text": "Azure doesn't support architectures in which the primary and secondary VMs share storage for DBMS data. For the DBMS layer, the common architecture pattern is to replicate databases at the same time and with different storage stacks than the ones that the primary and secondary VMs use.",
            "training": "https://learn.microsoft.com/training/paths/ensure-business-continuity-implement-disaster-recovery/?source=recommendationshttps%3A%2F%2Flearn.microsoft.com%2Fja-jp%2Ftraining%2Fpaths%2Fensure-business-continuity-implement-disaster-recovery%2F%3Fsource%3Drecommendations",
            "waf": "Reliability"
        },
        {
            "checklist": "WAF checklist",
            "guid": "ac614e95-6767-4bc3-b8a4-9953533da6ba",
            "link": "https://learn.microsoft.com/azure/sap/workloads/dbms-guide-general",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP",
                "Storage"
            ],
            "severity": "High",
            "text": "The DBMS data and transaction/redo log files are stored in Azure supported block storage or Azure NetApp Files. Azure Files or Azure Premium Files isn't supported as storage for DBMS data and/or redo log files with SAP workload.",
            "training": "https://learn.microsoft.com/training/modules/explore-azure-databases/2-explore-database-support-azure-for-sap-workloads",
            "waf": "Reliability"
        },
        {
            "checklist": "WAF checklist",
            "guid": "1f737179-8e7f-4e1a-a30c-e5a649a3092b",
            "link": "https://learn.microsoft.com/azure/sap/workloads/sap-high-availability-guide-wsfc-shared-disk",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP"
            ],
            "severity": "High",
            "text": "You can use Azure shared disks in Windows for ASCS + SCS components and specific high-availability scenarios. Set up your failover clusters separately for SAP application layer components and the DBMS layer. Azure doesn't currently support high-availability architectures that combine SAP application layer components and the DBMS layer into one failover cluster.",
            "training": "https://learn.microsoft.com/training/modules/implement-ha-sap-netweaver-anydb/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "checklist": "WAF checklist",
            "guid": "a78b3d31-3170-44f2-b5d7-651a29f4ccf5",
            "link": "https://learn.microsoft.com/azure/sap/workloads/high-availability-guide-standard-load-balancer-outbound-connections",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP",
                "LoadBalancer"
            ],
            "severity": "High",
            "text": "Most failover clusters for SAP application layer components (ASCS) and the DBMS layer require a virtual IP address for a failover cluster.  Azure Load Balancer should handle the virtual IP address for all other cases. One design principle is to use one load balancer per cluster configuration. We recommend that you use the standard version of the load balancer (Standard Load Balancer SKU).",
            "training": "https://learn.microsoft.com/training/modules/implement-high-availability-for-sap-workloads-azure/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "checklist": "WAF checklist",
            "guid": "1a541741-5833-4fb4-ae3c-2df743165c3a",
            "link": "https://learn.microsoft.com/azure/load-balancer/load-balancer-ha-ports-overview?source=recommendations",
            "service": "SAP",
            "services": [
                "WAF",
                "LoadBalancer"
            ],
            "severity": "High",
            "text": "Make sure the Floating IP is enabled on the Load balancer",
            "training": "https://learn.microsoft.com/training/modules/load-balancing-non-https-traffic-azure/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "checklist": "WAF checklist",
            "guid": "c47cc4f3-f105-452c-845e-9b307b3856c1",
            "link": "https://learn.microsoft.com/azure/virtual-machines/availability",
            "service": "SAP",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Before you deploy your high-availability infrastructure, and depending on the region you choose, determine whether to deploy with an Azure availability set or an availability zone.",
            "training": "https://learn.microsoft.com/training/modules/configure-virtual-machine-availability/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "checklist": "WAF checklist",
            "guid": "844f69c3-07e5-4ec1-bff7-4be27bcf5fea",
            "link": "https://www.microsoft.com/licensing/docs/view/Service-Level-Agreements-SLA-for-Online-Services?lang=1",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP",
                "VM",
                "Entra"
            ],
            "severity": "High",
            "text": "If you want to meet the infrastructure SLAs for your applications for SAP components (central services, application servers, and databases), you must choose the same high availability options (VMs, availability sets, availability zones) for all components.",
            "waf": "Reliability"
        },
        {
            "checklist": "WAF checklist",
            "guid": "cbe05bbe-209d-4490-ba47-778424d11678",
            "link": "https://learn.microsoft.com/azure/virtual-machines/availability-set-overview",
            "service": "SAP",
            "services": [
                "WAF",
                "Entra",
                "RBAC",
                "VM"
            ],
            "severity": "High",
            "text": "Do not mix servers of different roles in the same availability set. Keep central services VMs, database VMs, application VMs in their own availability sets",
            "training": "https://learn.microsoft.com/training/modules/configure-virtual-machine-availability/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "checklist": "WAF checklist",
            "guid": "f2201000-d045-40a6-a79a-d7cdc01b4d86",
            "link": "https://learn.microsoft.com/azure/virtual-machines/co-location",
            "service": "SAP",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "You can't deploy Azure availability sets within an Azure availability zone unless you use proximity placement groups.",
            "training": "https://learn.microsoft.com/azure/sap/workloads/proximity-placement-scenarios",
            "waf": "Reliability"
        },
        {
            "checklist": "WAF checklist",
            "guid": "9674e7c7-7796-4181-8920-09f4429543ba",
            "link": "https://learn.microsoft.com/azure/virtual-machines/availability-set-overview",
            "service": "SAP",
            "services": [
                "WAF",
                "VM"
            ],
            "severity": "High",
            "text": "When you create availability sets, use the maximum number of fault domains and update domains available. For example, if you deploy more than two VMs in one availability set, use the maximum number of fault domains (three) and enough update domains to limit the effect of potential physical hardware failures, network outages, or power interruptions, in addition to Azure planned maintenance. The default number of fault domains is two, and you can't change it online later.",
            "training": "https://learn.microsoft.com/training/modules/configure-virtual-machine-availability/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "checklist": "WAF checklist",
            "guid": "ae4ecb95-b70f-428f-8b9a-4c5b7e3478a2",
            "link": "https://learn.microsoft.com/azure/sap/workloads/proximity-placement-scenarios",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP",
                "Entra"
            ],
            "severity": "High",
            "text": "When you use Azure proximity placement groups in an availability set deployment, all three SAP components (central services, application server, and database) should be in the same proximity placement group.",
            "waf": "Reliability"
        },
        {
            "checklist": "WAF checklist",
            "guid": "5d2fa56c-56ad-4484-88fe-72734c486ba2",
            "link": "https://learn.microsoft.com/azure/sap/workloads/proximity-placement-scenarios",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP",
                "ACR"
            ],
            "severity": "High",
            "text": "Use one proximity placement group per SAP SID. Groups don't span across Availability Zones or Azure regions",
            "waf": "Reliability"
        },
        {
            "checklist": "WAF checklist",
            "guid": "bca3b10e-0ff5-4aec-ac16-4c4bd1a1c13f",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/sap/eslz-business-continuity-and-disaster-recovery",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP",
                "Entra"
            ],
            "severity": "High",
            "text": "Use one of the following services to run SAP central services clusters, depending on the operating system.",
            "training": "https://learn.microsoft.com/training/modules/implement-ha-sap-netweaver-anydb/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "checklist": "WAF checklist",
            "guid": "ed46b937-913e-4018-9c62-8393ab037e53",
            "link": "https://learn.microsoft.com/azure/sap/workloads/high-availability-guide-suse-multi-sid",
            "service": "SAP",
            "services": [
                "WAF",
                "Entra",
                "VM"
            ],
            "severity": "Medium",
            "text": "Azure doesn't currently support combining ASCS and DB HA in the same Linux Pacemaker cluster; separate them into individual clusters. However, you can combine up to five multiple central-services clusters into a pair of VMs.",
            "training": "https://learn.microsoft.com/training/modules/implement-ha-sap-netweaver-anydb/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "checklist": "WAF checklist",
            "guid": "f656e745-0cfb-453e-8008-0528fa21c933",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/sap/eslz-business-continuity-and-disaster-recovery",
            "service": "SAP",
            "services": [
                "WAF",
                "VM",
                "Storage"
            ],
            "severity": "Medium",
            "text": "Deploy both VMs in the high-availability pair in an availability set or in availability zones. These VMs should be the same size and have the same storage configuration.",
            "waf": "Reliability"
        },
        {
            "checklist": "WAF checklist",
            "guid": "7f684ebc-95da-425e-b329-e782dbed050f",
            "link": "https://learn.microsoft.com/azure/sap/workloads/high-availability-guide-rhel-with-hana-ascs-ers-dialog-instance",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP"
            ],
            "severity": "Medium",
            "text": "Azure supports installing and configuring SAP HANA and ASCS/SCS and ERS instances on the same high availability cluster running on Red Hat Enterprise Linux (RHEL).",
            "training": "https://learn.microsoft.com/training/modules/implement-ha-sap-netweaver-anydb/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "checklist": "WAF checklist",
            "guid": "07991f7d-6598-4d90-9431-45c62605d3a5",
            "link": "https://learn.microsoft.com/azure/sap/workloads/planning-guide-storage",
            "service": "SAP",
            "services": [
                "WAF",
                "Storage"
            ],
            "severity": "High",
            "text": "Run all production systems on Premium managed SSDs and use Azure NetApp Files or Ultra Disk Storage. At least the OS disk should be on the Premium tier so you can achieve better performance and the best SLA.",
            "training": "https://learn.microsoft.com/training/modules/explore-azure-storage/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "checklist": "WAF checklist",
            "guid": "73cdaecc-7d74-48d8-a040-88416eebc98c",
            "link": "https://learn.microsoft.com/azure/sap/workloads/hana-vm-operations-storage",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP",
                "Storage"
            ],
            "severity": "High",
            "text": "You should run SAP HANA on Azure only on the types of storage that are certified by SAP. Note that certain volumes must be run on certain disk configurations, where applicable. These configurations include enabling Write Accelerator and using Premium storage. You also need to ensure that the file system that runs on storage is compatible with the DBMS that runs on the machine.",
            "training": "https://learn.microsoft.com/azure/sap/workloads/hana-vm-premium-ssd-v1?source=recommendations",
            "waf": "Reliability"
        },
        {
            "checklist": "WAF checklist",
            "guid": "51904867-a70e-4fa0-b4ff-3e6292846d7c",
            "link": "https://learn.microsoft.com/azure/sap/workloads/disaster-recovery-overview-guide#storage",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP",
                "Storage",
                "ASR"
            ],
            "severity": "High",
            "text": "Consider configuring high availability depending on the type of storage you use for your SAP workloads. Some storage services available in Azure are not supported by Azure Site Recovery, so your high availability configuration may differ.",
            "training": "https://learn.microsoft.com/training/modules/implement-disaster-recovery-for-sap-workloads-azure/2-explore-disaster-recovery-sap-workloads",
            "waf": "Reliability"
        },
        {
            "checklist": "WAF checklist",
            "guid": "1ac2d928-c9b7-42c6-ba18-23b1aea78693",
            "link": "https://azure.microsoft.com/ja-jp/explore/global-infrastructure/products-by-region/",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP",
                "Storage"
            ],
            "severity": "High",
            "text": "Different native Azure storage services (like Azure Files, Azure NetApp Files, Azure Shared Disk) may not be available in all regions. So to have similar SAP setup on the DR region after failover, ensure the respective storage service is offered in DR site.",
            "waf": "Reliability"
        },
        {
            "checklist": "WAF checklist",
            "guid": "925d1f8c-01f3-4a67-948e-aabf0a1fad60",
            "link": "https://techcommunity.microsoft.com/t5/running-sap-applications-on-the/optimize-your-azure-costs-by-automating-sap-system-start-stop/ba-p/2120675",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP",
                "Cost"
            ],
            "severity": "Medium",
            "text": "Automate SAP System Start-Stop to manage costs.",
            "waf": "Cost"
        },
        {
            "checklist": "WAF checklist",
            "guid": "71dc00cd-4392-4262-8949-20c05e6c0333",
            "link": "https://learn.microsoft.com/azure/sap/workloads/hana-vm-premium-ssd-v1",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP",
                "Cost",
                "VM",
                "Storage"
            ],
            "severity": "Low",
            "text": "In the case of using Azure Premium Storage with SAP HANA, Azure Standard SSD storage can be used to select a cost-conscious storage solution. However, please note that choosing Standard SSD or Standard HDD Azure storage will affect the SLA of the individual VMs. Also, for systems with lower I/O throughput and low latency, such as non-production environments, lower series VMs can be used.",
            "waf": "Cost"
        },
        {
            "checklist": "WAF checklist",
            "guid": "9877f353-2591-4e8b-8381-e9043fed1010",
            "link": "https://learn.microsoft.com/azure/sap/workloads/hana-vm-premium-ssd-v1",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP",
                "Cost",
                "VM",
                "Storage"
            ],
            "severity": "Low",
            "text": "As a lower-cost alternative configuration (multipurpose), you can choose a low-performance SKU for your non-production HANA database server VMs. However, it is important to note that some VM types, such as E-series, are not HANA certified (SAP HANA Hardware Directory) or cannot achieve storage latency of less than 1ms.",
            "waf": "Cost"
        },
        {
            "checklist": "WAF checklist",
            "guid": "fda1dbf3-dc95-4d48-a7c7-91dca0f6c565",
            "link": "https://learn.microsoft.com/azure/well-architected/sap/design-areas/security",
            "service": "SAP",
            "services": [
                "WAF",
                "Subscriptions",
                "RBAC"
            ],
            "severity": "High",
            "text": "Enforce a RBAC model for management groups, subscriptions, resource groups and resources",
            "training": "https://learn.microsoft.com/training/paths/implement-resource-mgmt-security/",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "45911475-e39e-4530-accc-d979366bcda2",
            "link": "https://learn.microsoft.com/azure/active-directory/fundamentals/scenario-azure-first-sap-identity-integration",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP",
                "Entra"
            ],
            "severity": "Medium",
            "text": "Enforce Principal propagation for forwarding the identity from SAP cloud application to SAP on-premises (Including IaaS) through cloud connector",
            "training": "https://learn.microsoft.com/training/modules/explore-identity-services/2-explore-azure-virtual-machine-auth-access-control",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "750ab1ab-039d-495d-94c7-c8929cb107d5",
            "link": "https://learn.microsoft.com/azure/active-directory/fundamentals/scenario-azure-first-sap-identity-integration",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP",
                "Entra"
            ],
            "severity": "Medium",
            "text": "Implement SSO to SAP SaaS applications like SAP Analytics Cloud, SAP Cloud Platform, Business by design, SAP Qualtrics and SAP C4C with Azure AD using SAML.",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "325ae525-ba34-4d46-a5e2-213ace7bb122",
            "link": "https://learn.microsoft.com/azure/active-directory/saas-apps/sap-netweaver-tutorial",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP"
            ],
            "severity": "Medium",
            "text": "Implement SSO to SAP NetWeaver-based web applications like SAP Fiori and SAP Web GUI by using SAML.",
            "training": "https://learn.microsoft.com/training/modules/explore-identity-services/8-exercise-integrate-azure-active-directory-sap-netweaver",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "9eb54dad-7861-4e1c-973a-f3bb003fc9c1",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP"
            ],
            "severity": "Medium",
            "text": "Implement SSO to SAP NetWeaver-based web applications like SAP Fiori and SAP Web GUI by using SAML.",
            "training": "https://learn.microsoft.com/training/modules/explore-identity-services/6-exercise-integrate-azure-active-directory-sap-fiori",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "f29676ef-0c9c-4c4d-ab21-a55504c0c829",
            "link": "https://learn.microsoft.com/azure/active-directory/saas-apps/sap-netweaver-tutorial",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP"
            ],
            "severity": "Medium",
            "text": "You can implement SSO to SAP GUI by using SAP NetWeaver SSO or a partner solution.",
            "training": "https://learn.microsoft.com/training/modules/explore-identity-services/8-exercise-integrate-azure-active-directory-sap-netweaver",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "23181aa4-1742-4694-9ff8-ae7d7d474317",
            "service": "SAP",
            "services": [
                "WAF",
                "AKV",
                "SAP"
            ],
            "severity": "Medium",
            "text": "For SSO for SAP GUI and web browser access, implement SNC / Kerberos/SPNEGO (simple and protected GSSAPI negotiation mechanism) due to its ease of configuration and maintenance. For SSO with X.509 client certificates, consider the SAP Secure Login Server, which is a component of the SAP SSO solution.",
            "training": "https://learn.microsoft.com/training/modules/explore-identity-services/9-exercise-integrate-active-directory-sap-single-sign-on",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "6c8bcbf4-5bbe-4609-b8a0-3e97778424d6",
            "link": "https://blogs.sap.com/2017/07/12/sap-single-sign-on-protect-your-sap-landscape-with-x.509-certificates/",
            "service": "SAP",
            "services": [
                "WAF",
                "AKV",
                "SAP"
            ],
            "severity": "Medium",
            "text": "For SSO for SAP GUI and web browser access, implement SNC / Kerberos/SPNEGO (simple and protected GSSAPI negotiation mechanism) due to its ease of configuration and maintenance. For SSO with X.509 client certificates, consider the SAP Secure Login Server, which is a component of the SAP SSO solution.",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "16785d6f-a96c-496a-b885-18f482734c88",
            "link": "https://learn.microsoft.com/azure/active-directory/saas-apps/sap-netweaver-tutorial#configure-sap-netweaver-for-oauth",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP"
            ],
            "severity": "Medium",
            "text": "Implement SSO by using OAuth for SAP NetWeaver to allow third-party or custom applications to access SAP NetWeaver OData services.",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "a747c350-8d4c-449c-93af-393dbca77c48",
            "link": "https://learn.microsoft.com/azure/active-directory/saas-apps/saphana-tutorial",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP"
            ],
            "severity": "Medium",
            "text": "Implement SSO to SAP HANA",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "c7bae5bf-daf9-4761-9c56-f92891890aa4",
            "link": "https://learn.microsoft.com/azure/sap/workloads/rise-integration#connectivity-with-sap-rise",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP",
                "Entra"
            ],
            "severity": "Medium",
            "text": "Consider Azure AD an identity provider for SAP systems hosted on RISE. For more information, see Integrating the Service with Azure AD.",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "e4e48226-ce54-44b6-bb6b-bfa15bd8f753",
            "link": "https://github.com/azuredevcollege/SAP/blob/master/sap-oauth-saml-flow/README.md",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP"
            ],
            "severity": "Medium",
            "text": "For applications that access SAP, you might want to use principal propagation to establish SSO.",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "59921095-4980-4fc1-a5b6-524a5a560c79",
            "link": "https://learn.microsoft.com/azure/active-directory/saas-apps/sap-hana-cloud-platform-identity-authentication-tutorial",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP",
                "Entra"
            ],
            "severity": "Medium",
            "text": "If you're using SAP BTP services or SaaS solutions that require SAP Identity Authentication Service (IAS), consider implementing SSO between SAP Cloud Identity Authentication Services and Azure AD to access those SAP services. This integration lets SAP IAS act as a proxy identity provider and forwards authentication requests to Azure AD as the central user store and identity provider.",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "a709c664-317e-41e4-9e34-67d9016a86f4",
            "link": "https://learn.microsoft.com/azure/active-directory/saas-apps/sap-hana-cloud-platform-tutorial",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP"
            ],
            "severity": "Medium",
            "text": "Implement SSO to SAP BTP",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "01f11b7f-38df-4251-9c76-4dec19abd3e8",
            "link": "https://learn.microsoft.com/azure/active-directory/saas-apps/sap-successfactors-inbound-provisioning-cloud-only-tutorial",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP",
                "Entra"
            ],
            "severity": "Medium",
            "text": "If you're using SAP SuccessFactors, consider using the Azure AD automated user provisioning. With this integration, as you add new employees to SAP SuccessFactors, you can automatically create their user accounts in Azure AD. Optionally, you can create user accounts in Microsoft 365 or other SaaS applications that are supported by Azure AD. Use write-back of the email address to SAP SuccessFactors.",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "6ba28021-4591-4147-9e39-e5309cccd979",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/resource-org-management-groups",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP",
                "AzurePolicy",
                "Subscriptions"
            ],
            "severity": "Medium",
            "text": "enforce existing Management Group policies to SAP Subscriptions",
            "training": "https://learn.microsoft.com/training/modules/enterprise-scale-organization/4-management-group-subscription-organization",
            "waf": "Operations"
        },
        {
            "checklist": "WAF checklist",
            "guid": "366bcda2-750a-4b1a-a039-d95d54c7c892",
            "link": "https://learn.microsoft.com/azure/architecture/guide/sap/sap-whole-landscape",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP",
                "Subscriptions"
            ],
            "severity": "High",
            "text": "Integrate tightly coupled applications into the same SAP subscription to avoid additional routing and management complexity",
            "training": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/resource-org-subscriptions",
            "waf": "Operations"
        },
        {
            "checklist": "WAF checklist",
            "guid": "9cb107d5-325a-4e52-9ba3-4d4685e2213a",
            "link": "https://learn.microsoft.com/azure/architecture/guide/sap/sap-whole-landscape",
            "service": "SAP",
            "services": [
                "WAF",
                "Subscriptions"
            ],
            "severity": "High",
            "text": "Leverage Subscription as scale unit and scaling our resources, consider deploying subscription per environment eg. Sandbox, non-prod, prod ",
            "training": "https://learn.microsoft.com/training/modules/configure-subscriptions/?source=recommendations",
            "waf": "Operations"
        },
        {
            "checklist": "WAF checklist",
            "guid": "ce7bb122-f7c9-45f0-9e15-4e3aa3592829",
            "link": "https://learn.microsoft.com/azure/quotas/quotas-overview",
            "service": "SAP",
            "services": [
                "WAF",
                "Subscriptions",
                "VM"
            ],
            "severity": "High",
            "text": "Ensure quota increase as a part of subscription provisioning (e.g. total available VM cores within a subscription)",
            "training": "https://learn.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits",
            "waf": "Operations"
        },
        {
            "checklist": "WAF checklist",
            "guid": "ce4fab2f-433a-4d59-a5a9-3d1032e03ebc",
            "link": "https://learn.microsoft.com/rest/api/reserved-vm-instances/quotaapi?branch=capacity",
            "service": "SAP",
            "services": [
                "WAF"
            ],
            "severity": "Low",
            "text": "The Quota API is a REST API that you can use to view and manage quotas for Azure services. Consider using it if necessary.",
            "waf": "Operations"
        },
        {
            "checklist": "WAF checklist",
            "guid": "cbfad17b-f240-42bf-a1d8-f4f4cee661c8",
            "link": "https://learn.microsoft.com/azure/quotas/quickstart-increase-quota-portal",
            "service": "SAP",
            "services": [
                "WAF",
                "Subscriptions",
                "VM"
            ],
            "severity": "High",
            "text": "If deploying to an availability zone, ensure that the VM's zone deployment is available once the quota has been approved. Submit a support request with the subscription, VM series, number of CPUs and availability zone required.",
            "waf": "Operations"
        },
        {
            "checklist": "WAF checklist",
            "guid": "e6e20617-3686-4af4-9791-f8935ada4332",
            "link": "https://azure.microsoft.com/explore/global-infrastructure/products-by-region/",
            "service": "SAP",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Ensure required services and features are available within the chosen deployment regions eg. ANF , Zone etc.",
            "training": "https://learn.microsoft.com/azure/cloud-adoption-framework/migrate/azure-best-practices/multiple-regions?source=recommendations",
            "waf": "Operations"
        },
        {
            "checklist": "WAF checklist",
            "guid": "4e138115-2318-41aa-9174-26943ff8ae7d",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/sap/eslz-resource-organization",
            "service": "SAP",
            "services": [
                "WAF",
                "TrafficManager",
                "Cost"
            ],
            "severity": "Medium",
            "text": "Leverage Azure resource tag for cost categorization and resource grouping (: BillTo, Department (or Business Unit), Environment (Production, Stage, Development), Tier (Web Tier, Application Tier), Application Owner, ProjectName)",
            "training": "https://learn.microsoft.com/training/paths/implement-resource-mgmt-security/",
            "waf": "Operations"
        },
        {
            "checklist": "WAF checklist",
            "guid": "2f7c95f0-6e15-44e3-aa35-92829e6e2061",
            "link": "https://learn.microsoft.com/azure/backup/sap-hana-database-about",
            "service": "SAP",
            "services": [
                "WAF",
                "Backup"
            ],
            "severity": "High",
            "text": "Help protect your HANA database by using the Azure Backup service.",
            "training": "https://learn.microsoft.com/training/modules/implement-azure-backup-sap-workloads-azure-virtual-machines/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "checklist": "WAF checklist",
            "guid": "302a2fbf-3745-4a5f-a365-c9d1a16ca22c",
            "link": "https://learn.microsoft.com/azure/azure-netapp-files/azacsnap-introduction",
            "service": "SAP",
            "services": [
                "WAF",
                "Entra",
                "VM",
                "Storage"
            ],
            "severity": "Medium",
            "text": "If you deploy Azure NetApp Files for your HANA, Oracle, or DB2 database, use the Azure Application Consistent Snapshot tool (AzAcSnap) to take application-consistent snapshots. AzAcSnap also supports Oracle databases. Consider using AzAcSnap on a central VM rather than on individual VMs.",
            "waf": "Reliability"
        },
        {
            "checklist": "WAF checklist",
            "guid": "42d37218-a3a7-45df-bff6-1173e7f249ea",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/sap/eslz-management-and-monitoring",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP"
            ],
            "severity": "High",
            "text": "Ensure time-zone matches between the operating system and the SAP system.",
            "waf": "Operations"
        },
        {
            "checklist": "WAF checklist",
            "guid": "c3c7abc0-716c-4486-893c-40e181d65539",
            "link": "https://learn.microsoft.com/azure/sap/workloads/high-availability-guide-rhel-multi-sid",
            "service": "SAP",
            "services": [
                "WAF",
                "Entra"
            ],
            "severity": "Medium",
            "text": "Don't group different application services in the same cluster. For example, don't combine DRBD and central services clusters on the same cluster. However, you can use the same Pacemaker cluster to manage approximately five different central services (multi-SID cluster).",
            "training": "https://learn.microsoft.com/training/modules/implement-ha-sap-netweaver-anydb/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "checklist": "WAF checklist",
            "guid": "a491dfc4-9353-4213-9217-eef0949f9467",
            "link": "https://azure.microsoft.com/pricing/offers/dev-test/",
            "service": "SAP",
            "services": [
                "WAF",
                "Cost"
            ],
            "severity": "Low",
            "text": "Consider running dev/test systems in a snooze model to save and optimize Azure run costs.",
            "waf": "Cost"
        },
        {
            "checklist": "WAF checklist",
            "guid": "b7056168-6199-4732-a514-cdbb2d5c9c54",
            "link": "https://learn.microsoft.com/azure/lighthouse/overview",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP",
                "Entra"
            ],
            "severity": "Medium",
            "text": "If you partner with customers by managing their SAP estates, consider Azure Lighthouse. Azure Lighthouse allows managed service providers to use Azure native identity services to authenticate to the customers' environment. It puts the control in the hands of customers, because they can revoke access at any time and audit service providers' actions.",
            "waf": "Operations"
        },
        {
            "checklist": "WAF checklist",
            "guid": "4d116785-d2fa-456c-96ad-48408fe72734",
            "link": "https://learn.microsoft.com/azure/update-manager/scheduled-patching?tabs=schedule-updates-single-machine%2Cschedule-updates-scale-overview",
            "service": "SAP",
            "services": [
                "WAF",
                "VM"
            ],
            "severity": "Medium",
            "text": "Use Azure Update Manager to check the status of available updates for a single VM or multiple VMs and consider scheduling regular patching.",
            "training": "https://learn.microsoft.com/training/modules/keep-your-virtual-machines-updated/?source=recommendations",
            "waf": "Operations"
        },
        {
            "checklist": "WAF checklist",
            "guid": "76c8bcbf-45bb-4e60-ad8a-03e97778424d",
            "link": "https://learn.microsoft.com/azure/sap/workloads/lama-installation",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP"
            ],
            "severity": "Low",
            "text": "Optimize and manage SAP Basis operations by using SAP Landscape Management (LaMa). Use the SAP LaMa connector for Azure to relocate, copy, clone, and refresh SAP systems.",
            "training": "https://learn.microsoft.com/training/modules/explore-azure-remote-management/?source=recommendations",
            "waf": "Operations"
        },
        {
            "checklist": "WAF checklist",
            "guid": "14591147-5e39-4e53-89cc-cd979366bcda",
            "link": "https://learn.microsoft.com/azure/sap/monitor/about-azure-monitor-sap-solutions",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP",
                "Monitor",
                "SQL"
            ],
            "severity": "Medium",
            "text": "Use Azure Monitor for SAP solutions to monitor your SAP workloads(SAP HANA, high-availability SUSE clusters, and SQL systems) on Azure. Consider supplementing Azure Monitor for SAP solutions with SAP Solution Manager.",
            "training": "https://learn.microsoft.com/training/modules/implement-azure-monitoring-sap-workloads-azure-virtual-machines/?source=recommendations",
            "waf": "Operations"
        },
        {
            "checklist": "WAF checklist",
            "guid": "2750ab1a-b039-4d95-b54c-7c8929cb107d",
            "link": "https://learn.microsoft.com/azure/sap/workloads/vm-extension-for-sap",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP",
                "Entra",
                "Monitor",
                "VM"
            ],
            "severity": "High",
            "text": "Run a VM Extension for SAP check. VM Extension for SAP uses the assigned managed identity of a virtual machine (VM) to access VM monitoring and configuration data. The check ensures that all performance metrics in your SAP application come from the underlying Azure Extension for SAP.",
            "training": "https://learn.microsoft.com/training/modules/configure-azure-enhanced-monitoring-extension-for-sap/?source=recommendations",
            "waf": "Operations"
        },
        {
            "checklist": "WAF checklist",
            "guid": "5325ae52-5ba3-44d4-985e-2213ace7bb12",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/design-logs-deployment",
            "service": "SAP",
            "services": [
                "WAF",
                "AzurePolicy"
            ],
            "severity": "Medium",
            "text": "Use Azure Policy for access control and compliance reporting. Azure Policy provides the ability to enforce organization-wide settings to ensure consistent policy adherence and fast violation detection. ",
            "training": "https://learn.microsoft.com/learn/paths/architect-infrastructure-operations/",
            "waf": "Operations"
        },
        {
            "checklist": "WAF checklist",
            "guid": "523181aa-4174-4269-93ff-8ae7d7d47431",
            "link": "https://learn.microsoft.com/azure/network-watcher/connection-monitor-overview",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP",
                "NetworkWatcher",
                "Monitor"
            ],
            "severity": "Medium",
            "text": "Use Connection Monitor in Azure Network Watcher to monitor latency metrics for SAP databases and application servers. Or collect and display network latency measurements by using Azure Monitor.",
            "training": "https://techcommunity.microsoft.com/t5/running-sap-applications-on-the/collecting-and-displaying-niping-network-latency-measurements/ba-p/1833979",
            "waf": "Operations"
        },
        {
            "checklist": "WAF checklist",
            "guid": "73686af4-6791-4f89-95ad-a43324e13811",
            "link": "https://github.com/Azure/SAP-on-Azure-Scripts-and-Utilities/tree/main/QualityCheck",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP",
                "VM"
            ],
            "severity": "Medium",
            "text": "Perform a quality check for SAP HANA on the provisioned Azure infrastructure to verify that provisioned VMs comply with SAP HANA on Azure best practices.",
            "waf": "Operations"
        },
        {
            "checklist": "WAF checklist",
            "guid": "616785d6-fa96-4c96-ad88-518f482734c8",
            "link": "https://learn.microsoft.com/azure/sap/workloads/high-availability-zones",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP",
                "Subscriptions"
            ],
            "severity": "High",
            "text": "For each Azure subscription, run a latency test on Azure availability zones before zonal deployment to choose low-latency zones for deployment of SAP on Azure.",
            "training": "https://github.com/Azure/SAP-on-Azure-Scripts-and-Utilities/tree/main/AvZone-Latency-Test",
            "waf": "Performance"
        },
        {
            "checklist": "WAF checklist",
            "guid": "410adcba-db46-424f-a6c4-05ecde75c52e",
            "link": "https://learn.microsoft.com/azure/advisor/advisor-how-to-improve-reliability",
            "service": "SAP",
            "services": [
                "WAF",
                "Storage",
                "ASR"
            ],
            "severity": "Medium",
            "text": "Run the Resiliency Report to ensure that the configuration of the entire provisioned Azure infrastructure (Compute, Database, Networking, Storage, Site Recovery) complies with the configuration defined by Cloud Adaption Framework for Azure.",
            "training": "https://learn.microsoft.com/training/paths/azure-well-architected-framework/",
            "waf": "Reliability"
        },
        {
            "checklist": "WAF checklist",
            "guid": "86ba2802-1459-4114-95e3-9e5309cccd97",
            "link": "https://learn.microsoft.com/azure/sentinel/sap/deployment-overview",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP",
                "Sentinel",
                "Monitor"
            ],
            "severity": "Medium",
            "text": "Implement threat protection by using the Microsoft Sentinel solution for SAP. Use this solution to monitor your SAP systems and detect sophisticated threats throughout the business logic and application layers.",
            "training": "https://learn.microsoft.com/training/modules/plan-microsoft-sentinel-deployment-sap/?source=recommendations",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "579266bc-ca27-45fa-a1ab-fe9d55d04c3c",
            "link": "https://learn.microsoft.com/azure/cost-management-billing/costs/enable-tag-inheritance",
            "service": "SAP",
            "services": [
                "WAF",
                "Cost"
            ],
            "severity": "Medium",
            "text": "Azure tagging can be leveraged to logically group and track resources, automate their deployments, and most importantly, provide visibility on the incurred costs.",
            "training": "https://learn.microsoft.com/training/modules/analyze-costs-create-budgets-azure-cost-management/?source=recommendations",
            "waf": "Operations"
        },
        {
            "checklist": "WAF checklist",
            "guid": "04b8e5e5-13cb-4b22-af62-5a8ecfcf0337",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-network-test-latency?tabs=windows",
            "service": "SAP",
            "services": [
                "WAF",
                "Monitor",
                "VM"
            ],
            "severity": "Low",
            "text": "Use inter-VM latency monitoring for latency-sensitive applications.",
            "waf": "Performance"
        },
        {
            "checklist": "WAF checklist",
            "guid": "07e5ed53-3d96-43d8-87ea-631b77da5aba",
            "link": "https://learn.microsoft.com/azure/sap/workloads/planning-guide-storage",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP",
                "Monitor",
                "ASR"
            ],
            "severity": "Medium",
            "text": "Use Azure Site Recovery monitoring to maintain the health of the disaster recovery service for SAP application servers.",
            "training": "https://learn.microsoft.com/training/modules/explore-azure-storage/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "checklist": "WAF checklist",
            "guid": "abb6af9c-982c-4cf1-83fb-329fafd1ee56",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/sap/eslz-management-and-monitoring",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP",
                "Storage"
            ],
            "severity": "Medium",
            "text": "Exclude all the database file systems and executable programs from antivirus scans. Including them could lead to performance problems. Check with the database vendors for prescriptive details on the exclusion list. For example, Oracle recommends excluding /oracle/<sid>/sapdata from antivirus scans.",
            "waf": "Performance"
        },
        {
            "checklist": "WAF checklist",
            "guid": "c027f893-f404-41a9-b33d-39d625a14964",
            "link": "https://sapit-forme-prod.authentication.eu11.hana.ondemand.com/login",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP"
            ],
            "severity": "Low",
            "text": "Consider collecting full database statistics for non-HANA databases after migration. For example, implement SAP note 1020260 - Delivery of Oracle statistics.",
            "waf": "Performance"
        },
        {
            "checklist": "WAF checklist",
            "guid": "fdafb1f5-3eee-4354-a8c9-deb8127ebc2e",
            "link": "https://learn.microsoft.com/azure/virtual-machines/workloads/oracle/configure-oracle-asm",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP",
                "Storage"
            ],
            "severity": "Medium",
            "text": "Consider using Oracle Automatic Storage Management (ASM) for all Oracle deployments that use SAP on Azure.",
            "training": "https://learn.microsoft.com/training/paths/administer-infrastructure-resources-in-azure/?source=recommendations",
            "waf": "Performance"
        },
        {
            "checklist": "WAF checklist",
            "guid": "33c5d5bf-daf3-4f0d-bd50-6010fdcec22e",
            "link": "https://techcommunity.microsoft.com/t5/running-sap-applications-on-the/announcement-sap-on-azure-oracle-performance-efficiency-scripts/ba-p/3725178",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP",
                "SQL"
            ],
            "severity": "Medium",
            "text": "For SAP on Azure running Oracle, a collection of SQL scripts can help you diagnose performance problems.  Automatic Workload Repository (AWR) reports contain valuable information for diagnosing problems in the Oracle system. We recommend that you run an AWR report during several sessions and choose peak times for it, to ensure broad coverage for the analysis.",
            "training": "https://learn.microsoft.com/ja-jp/azure/well-architected/oracle-iaas/performance-efficiency",
            "waf": "Performance"
        },
        {
            "checklist": "WAF checklist",
            "guid": "d89fd98d-23e4-4b40-a92e-32db9365522c",
            "link": "https://learn.microsoft.com/azure/site-recovery/site-recovery-monitor-and-troubleshoot",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP",
                "Monitor",
                "ASR"
            ],
            "severity": "High",
            "text": "Use Azure Site Recovery monitoring to maintain the health of the disaster recovery service for SAP application servers.",
            "training": "https://learn.microsoft.com/training/modules/protect-on-premises-infrastructure-with-azure-site-recovery/?source=recommendations",
            "waf": "Operations"
        },
        {
            "checklist": "WAF checklist",
            "guid": "5ba34d46-85e2-4213-ace7-bb122f7c95f0",
            "link": "https://learn.microsoft.com/azure/ddos-protection/ddos-protection-overview",
            "service": "SAP",
            "services": [
                "WAF",
                "AzurePolicy",
                "AppGW"
            ],
            "severity": "Medium",
            "text": "For secure delivery of HTTP/S apps, use Application Gateway v2 and ensure that WAF protection and policies are enabled.",
            "training": "https://learn.microsoft.com/training/modules/introduction-azure-web-application-firewall/",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "fa9d30bc-1b82-4e4b-bfdf-6b017938b9e6",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/sap/eslz-network-topology-and-connectivity",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP",
                "DNS",
                "VM"
            ],
            "severity": "Medium",
            "text": "If the virtual machine's DNS or virtual name is not changed during migration to Azure, Background DNS and virtual names connect many system interfaces in the SAP landscape, and customers are only sometimes aware of the interfaces that developers define over time. Connection challenges arise between various systems when virtual or DNS names change after migrations, and it's recommended to retain DNS aliases to prevent these types of difficulties.",
            "training": "https://learn.microsoft.com/training/modules/explore-azure-networking/4-explore-name-resolution",
            "waf": "Operations"
        },
        {
            "checklist": "WAF checklist",
            "guid": "a2858f78-105b-4f52-b7a9-5b0f4439743b",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/sap/eslz-network-topology-and-connectivity",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP",
                "DNS",
                "VNet"
            ],
            "severity": "Medium",
            "text": "Use different DNS zones to distinguish each environment (sandbox, development, preproduction, and production) from each other. The exception is for SAP deployments with their own VNet; here, private DNS zones might not be necessary.",
            "training": "https://learn.microsoft.com/training/modules/explore-azure-networking/4-explore-name-resolution",
            "waf": "Operations"
        },
        {
            "checklist": "WAF checklist",
            "guid": "a3592829-e6e2-4061-9368-6af46791f893",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-network-peering-overview",
            "service": "SAP",
            "services": [
                "WAF",
                "VNet",
                "ACR",
                "SAP"
            ],
            "severity": "Medium",
            "text": "Local and global VNet peering provide connectivity and are the preferred approaches to ensure connectivity between landing zones for SAP deployments across multiple Azure regions",
            "training": "https://learn.microsoft.com/training/modules/configure-vnet-peering/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "checklist": "WAF checklist",
            "guid": "41742694-3ff8-4ae7-b7d4-743176c8bcbf",
            "link": "https://learn.microsoft.com/azure/sap/workloads/planning-guide",
            "service": "SAP",
            "services": [
                "WAF",
                "NVA",
                "SAP"
            ],
            "severity": "High",
            "text": "It is not supported to deploy any NVA between SAP application and SAP Database server",
            "training": "https://me.sap.com/notes/2731110",
            "waf": "Performance"
        },
        {
            "checklist": "WAF checklist",
            "guid": "7d4bc7d2-c34a-452e-8f1d-6ae3c8eafcc3",
            "link": "https://learn.microsoft.com/training/modules/introduction-azure-virtual-wan/?source=recommendations",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP",
                "ACR",
                "VWAN"
            ],
            "severity": "Medium",
            "text": "Use Virtual WAN for Azure deployments in new, large, or global networks where you need global transit connectivity across Azure regions and on-premises locations. With this approach, you won't need to manually set up transitive routing for Azure networking, and you can follow a standard for SAP on Azure deployments.",
            "training": "https://learn.microsoft.com/azure/virtual-wan/virtual-wan-about",
            "waf": "Operations"
        },
        {
            "checklist": "WAF checklist",
            "guid": "0cedb1f6-ae6c-492b-8b17-8061f50b16d3",
            "link": "https://learn.microsoft.com/azure/well-architected/services/networking/network-virtual-appliances/reliability",
            "service": "SAP",
            "services": [
                "WAF",
                "VNet",
                "NVA"
            ],
            "severity": "Medium",
            "text": "Consider deploying network virtual appliances (NVAs) between regions only if partner NVAs are used. NVAs between regions or VNets aren't required if native NVAs are present. When you're deploying partner networking technologies and NVAs, follow the vendor's guidance to verify conflicting configurations with Azure networking.",
            "training": "https://learn.microsoft.com/training/modules/control-network-traffic-flow-with-routes/?source=recommendations",
            "waf": "Operations"
        },
        {
            "checklist": "WAF checklist",
            "guid": "facc08c6-ea95-4641-91cd-fa09e573adbd",
            "link": "https://learn.microsoft.com/azure/architecture/networking/hub-spoke-vwan-architecture",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP",
                "VNet",
                "VWAN",
                "NVA"
            ],
            "severity": "Medium",
            "text": "Virtual WAN manages connectivity between spoke VNets for virtual-WAN-based topologies (no need to set up user-defined routing [UDR] or NVAs), and maximum network throughput for VNet-to-VNet traffic in the same virtual hub is 50 gigabits per second. If necessary, SAP landing zones can use VNet peering to connect to other landing zones and overcome this bandwidth limitation.",
            "training": "https://learn.microsoft.com/training/modules/hub-and-spoke-network-architecture/?source=recommendations",
            "waf": "Operations"
        },
        {
            "checklist": "WAF checklist",
            "guid": "82734c88-6ba2-4802-8459-11475e39e530",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-ip-addressing",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP",
                "VM"
            ],
            "severity": "High",
            "text": "Public IP assignment to VM running SAP Workload is not recommended.",
            "training": "https://learn.microsoft.com/training/modules/design-ip-addressing-for-azure/?source=recommendations",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "9cccd979-366b-4cda-8750-ab1ab039d95d",
            "link": "https://learn.microsoft.com/training/modules/protect-on-premises-infrastructure-with-azure-site-recovery/?source=recommendations",
            "service": "SAP",
            "services": [
                "WAF",
                "ASR"
            ],
            "severity": "High",
            "text": "Consider reserving IP address on DR side when configuring ASR",
            "training": "https://learn.microsoft.com/learn/paths/architect-network-infrastructure/",
            "waf": "Operations"
        },
        {
            "checklist": "WAF checklist",
            "guid": "54c7c892-9cb1-407d-9325-ae525ba34d46",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-ip-addressing",
            "service": "SAP",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Avoid using overlapping IP address ranges for production and DR sites.",
            "training": "https://learn.microsoft.com/training/modules/design-ip-addressing-for-azure/?source=recommendations",
            "waf": "Operations"
        },
        {
            "checklist": "WAF checklist",
            "guid": "6e154e3a-a359-4282-ae6e-206173686af4",
            "link": "https://learn.microsoft.com/azure/azure-netapp-files/azure-netapp-files-delegate-subnet",
            "service": "SAP",
            "services": [
                "WAF",
                "VNet",
                "Storage"
            ],
            "severity": "Medium",
            "text": "While Azure does help you to create multiple delegated subnets in a VNet, only one delegated subnet can exist in a VNet for Azure NetApp Files. Attempts to create a new volume will fail if you use more than one delegated subnet for Azure NetApp Files.",
            "training": "https://learn.microsoft.com/azure/azure-netapp-files/azure-netapp-files-network-topologies?source=recommendations",
            "waf": "Operations"
        },
        {
            "checklist": "WAF checklist",
            "guid": "d8a03e97-7784-424d-9167-85d6fa96c96a",
            "link": "https://learn.microsoft.com/azure/well-architected/services/networking/azure-firewall?toc=%2Fazure%2Ffirewall%2Ftoc.json&bc=%2Fazure%2Ffirewall%2Fbreadcrumb%2Ftoc.json",
            "service": "SAP",
            "services": [
                "WAF",
                "Firewall"
            ],
            "severity": "Medium",
            "text": "Use Azure Firewall to govern Azure outbound traffic to the internet, non-HTTP/S inbound connections, and East/West traffic filtering (if the organization requires it)",
            "training": "https://learn.microsoft.com/training/paths/secure-networking-infrastructure/",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "91a65e40-be90-45b3-9f73-f3edbf8dc324",
            "link": "https://learn.microsoft.com/azure/sap/workloads/expose-sap-process-orchestration-on-azure",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP",
                "AppGW"
            ],
            "severity": "Medium",
            "text": "Application Gateway and Web Application Firewall have limitations when Application Gateway serves as a reverse proxy for SAP web apps, as shown in the comparison between Application Gateway, SAP Web Dispatcher, and other third-party services.",
            "training": "https://help.sap.com/docs/SUPPORT_CONTENT/si/3362959506.html",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "5e39e530-9ccc-4d97-a366-bcda2750ab1a",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "service": "SAP",
            "services": [
                "WAF",
                "ACR",
                "AzurePolicy",
                "FrontDoor"
            ],
            "severity": "Medium",
            "text": "Use Azure Front Door and WAF policies to provide global protection across Azure regions for inbound HTTP/S connections to a landing zone.",
            "training": "https://learn.microsoft.com/training/paths/secure-application-delivery/",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "b039d95d-54c7-4c89-89cb-107d5325ae52",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/afds-overview",
            "service": "SAP",
            "services": [
                "WAF",
                "AzurePolicy",
                "FrontDoor",
                "AppGW"
            ],
            "severity": "Medium",
            "text": "Take advantage of Web Application Firewall policies in Azure Front Door when you're using Azure Front Door and Application Gateway to protect HTTP/S applications. Lock down Application Gateway to receive traffic only from Azure Front Door.",
            "training": "https://learn.microsoft.com/training/modules/introduction-azure-web-application-firewall/?source=recommendations",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "5ada4332-4e13-4811-9231-81aa41742694",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "service": "SAP",
            "services": [
                "WAF",
                "AppGW",
                "LoadBalancer"
            ],
            "severity": "Medium",
            "text": "Use a web application firewall to scan your traffic when it's exposed to the internet. Another option is to use it with your load balancer or with resources that have built-in firewall capabilities like Application Gateway or third-party solutions.",
            "training": "https://learn.microsoft.com/training/modules/introduction-azure-web-application-firewall/?source=recommendations",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "e73de7d5-6f36-4217-a526-e1a621ecddde",
            "link": "https://learn.microsoft.com/azure/frontdoor/front-door-overview",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP",
                "ACR",
                "VWAN"
            ],
            "severity": "Medium",
            "text": "Use Virtual WAN for Azure deployments in new, large, or global networks where you need global transit connectivity across Azure regions and on-premises locations. With this approach, you won't need to manually set up transitive routing for Azure networking, and you can follow a standard for SAP on Azure deployments.",
            "training": "https://learn.microsoft.com/training/modules/explore-azure-networking/10-explore-azure-front-door",
            "waf": "Performance"
        },
        {
            "checklist": "WAF checklist",
            "guid": "3c536a3e-1b6b-4e87-95ca-15edb47251c0",
            "link": "https://learn.microsoft.com/azure/virtual-network/vnet-integration-for-azure-services",
            "service": "SAP",
            "services": [
                "WAF",
                "PrivateLink",
                "VNet",
                "ACR",
                "Backup",
                "Storage"
            ],
            "severity": "Medium",
            "text": "To prevent data leakage, use Azure Private Link to securely access platform as a service resources like Azure Blob Storage, Azure Files, Azure Data Lake Storage Gen2, Azure Data Factory, and more. Azure Private Endpoint can also help to secure traffic between VNets and services like Azure Storage, Azure Backup, and more. Traffic between your VNet and the Private Endpoint enabled service travels across the Microsoft global network, which prevents its exposure to the public internet.",
            "training": "https://learn.microsoft.com/training/modules/design-implement-private-access-to-azure-services/?source=recommendations",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "85e2213a-ce7b-4b12-8f7c-95f06e154e3a",
            "link": "https://learn.microsoft.com/azure/virtual-network/accelerated-networking-overview?tabs=redhat",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP",
                "VM"
            ],
            "severity": "High",
            "text": "Make sure that Azure accelerated networking is enabled on the VMs used in the SAP application and DBMS layers.",
            "training": "https://learn.microsoft.com/training/paths/azure-fundamentals-describe-azure-architecture-services/?source=recommendations",
            "waf": "Performance"
        },
        {
            "checklist": "WAF checklist",
            "guid": "3ff8ae7d-7d47-4431-96c8-bcbf45bbe609",
            "link": "https://learn.microsoft.com/azure/load-balancer/load-balancer-multivip-overview",
            "service": "SAP",
            "services": [
                "WAF",
                "LoadBalancer"
            ],
            "severity": "Medium",
            "text": "Make sure that internal deployments for Azure Load Balancer are set up to use Direct Server Return (DSR). This setting (Enabling Floating IP) will reduce latency when internal load balancer configurations are used for high-availability configurations on the DBMS layer.",
            "training": "https://learn.microsoft.com/ja-jp/training/modules/load-balancing-non-https-traffic-azure/?source=recommendations",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "6791f893-5ada-4433-84e1-3811523181aa",
            "link": "https://learn.microsoft.com/azure/virtual-network/network-security-group-how-it-works",
            "service": "SAP",
            "services": [
                "WAF",
                "VNet",
                "VM",
                "SAP"
            ],
            "severity": "Medium",
            "text": "You can use application security group (ASG) and NSG rules to define network security access-control lists between the SAP application and DBMS layers. ASGs group virtual machines to help manage their security.",
            "training": "https://learn.microsoft.com/training/modules/configure-network-security-groups/?source=recommendations",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "45bbe609-d8a0-43e9-9778-424d616785d6",
            "link": "https://me.sap.com/notes/2015553",
            "service": "SAP",
            "services": [
                "WAF",
                "VNet",
                "SAP"
            ],
            "severity": "High",
            "text": "Placing of the SAP application layer and SAP DBMS in different Azure VNets that aren't peered isn't supported.",
            "training": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/sap/eslz-network-topology-and-connectivity",
            "waf": "Performance"
        },
        {
            "checklist": "WAF checklist",
            "guid": "fa96c96a-d885-418f-9827-34c886ba2802",
            "link": "https://learn.microsoft.com/azure/sap/workloads/proximity-placement-scenarios",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP"
            ],
            "severity": "Medium",
            "text": "For optimal network latency with SAP applications, consider using Azure proximity placement groups.",
            "training": "https://learn.microsoft.com/azure/virtual-machines/co-location#planned-maintenance-and-proximity-placement-groups",
            "waf": "Performance"
        },
        {
            "checklist": "WAF checklist",
            "guid": "18c8b61c-855a-4405-b6ed-266455e4f4ce",
            "link": "https://me.sap.com/notes/2015553",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP"
            ],
            "severity": "High",
            "text": "It is NOT supported at all to run an SAP Application Server layer and DBMS layer split between on-premise and Azure. Both layers need to completely reside either on-premise or in Azure.",
            "training": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/sap/eslz-network-topology-and-connectivity",
            "waf": "Performance"
        },
        {
            "checklist": "WAF checklist",
            "guid": "b65c878b-4b14-4f4e-92d8-d873936493f2",
            "link": "https://me.sap.com/notes/2015553",
            "service": "SAP",
            "services": [
                "WAF",
                "VNet",
                "Cost",
                "SAP"
            ],
            "severity": "High",
            "text": "It isn't recommended to host the database management system (DBMS) and application layers of SAP systems in different VNets and connect them with VNet peering because of the substantial costs that excessive network traffic between the layers can produce. Recommend using subnets within the Azure virtual network to separate the SAP application layer and DBMS layer.",
            "training": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/sap/eslz-network-topology-and-connectivity",
            "waf": "Cost"
        },
        {
            "checklist": "WAF checklist",
            "guid": "402a9846-d515-4061-aff8-cd30088693fa",
            "link": "https://learn.microsoft.com/azure/sap/workloads/high-availability-guide-rhel",
            "service": "SAP",
            "services": [
                "WAF",
                "LoadBalancer"
            ],
            "severity": "High",
            "text": "If using Load Balancer with Linux guest operating systems, check that the Linux network parameter net.ipv4.tcp_timestamps is set to 0.",
            "training": "https://learn.microsoft.com/training/modules/implement-ha-sap-netweaver-anydb/?source=recommendations",
            "waf": "Performance"
        },
        {
            "checklist": "WAF checklist",
            "guid": "87585797-5551-4d53-bb7d-a94ee415734d",
            "link": "https://learn.microsoft.com/azure/sap/workloads/rise-integration",
            "service": "SAP",
            "services": [
                "WAF",
                "VNet",
                "SAP"
            ],
            "severity": "Medium",
            "text": "For SAP RISE/ECS deployments, virtual peering is the preferred way to establish connectivity with customer's existing Azure environment. Both the SAP vnet and customer vnet(s) are protected with network security groups (NSG), enabling communication on SAP and database ports through the vnet peering",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "ff5136bd-dcf1-4d2b-ae52-39333efdf45a",
            "link": "https://learn.microsoft.com/azure/backup/sap-hana-database-about",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP",
                "VM",
                "Backup"
            ],
            "severity": "High",
            "text": "Review SAP HANA database backups for Azure VMs.",
            "waf": "Cost"
        },
        {
            "checklist": "WAF checklist",
            "guid": "cafde29d-a0af-4bcd-87c0-0f299d63f0e8",
            "link": "https://learn.microsoft.com/azure/site-recovery/site-recovery-monitor-and-troubleshoot",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP",
                "Monitor",
                "ASR"
            ],
            "severity": "Medium",
            "text": "Review Site Recovery built-in monitoring, where used for SAP.",
            "waf": "Cost"
        },
        {
            "checklist": "WAF checklist",
            "guid": "82d7b8de-d3f1-44a0-830b-38e200e82acf",
            "link": "https://help.sap.com/docs/SAP_HANA_PLATFORM/c4d7c773af4a4e5dbebb6548d6e2d4f4/e3111d2ebb5710149510cc120646bf3f.html?locale=en-US",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP",
                "Monitor"
            ],
            "severity": "High",
            "text": "Review the Monitoring the SAP HANA System Landscape guidance.",
            "waf": "Operations"
        },
        {
            "checklist": "WAF checklist",
            "guid": "c823873a-2bec-4c2a-b684-a1ce8ae80efd",
            "link": "https://learn.microsoft.com/azure/virtual-machines/workloads/oracle/oracle-database-backup-strategies",
            "service": "SAP",
            "services": [
                "WAF",
                "VM",
                "Backup"
            ],
            "severity": "Medium",
            "text": "Review Oracle Database in Azure Linux VM backup strategies.",
            "waf": "Operations"
        },
        {
            "checklist": "WAF checklist",
            "guid": "2943b6d8-1d31-4e19-ade7-78e6b26d1962",
            "link": "https://learn.microsoft.com/sql/relational-databases/tutorial-use-azure-blob-storage-service-with-sql-server-2016?view=sql-server-ver16",
            "service": "SAP",
            "services": [
                "WAF",
                "Storage",
                "SQL"
            ],
            "severity": "Medium",
            "text": "Review the use of Azure Blob Storage with SQL Server 2016.",
            "waf": "Operations"
        },
        {
            "checklist": "WAF checklist",
            "guid": "b82e650f-676d-417d-994d-fc33ca54ec14",
            "link": "https://learn.microsoft.com/azure/azure-sql/virtual-machines/windows/automated-backup?view=azuresql",
            "service": "SAP",
            "services": [
                "WAF",
                "VM",
                "Backup"
            ],
            "severity": "Medium",
            "text": "Review the use of Automated Backup v2 for Azure VMs.",
            "waf": "Operations"
        },
        {
            "checklist": "WAF checklist",
            "guid": "347c2dcc-e6eb-4b04-80c5-628b171aa62d",
            "service": "SAP",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Enabling Write accelerator for M series when using premium disks(V1)",
            "waf": "Operations"
        },
        {
            "checklist": "WAF checklist",
            "guid": "b96512cf-996f-4b17-b9b8-6b16db1a2a94",
            "link": "https://github.com/Azure/SAP-on-Azure-Scripts-and-Utilities/tree/main/AvZone-Latency-Test",
            "service": "SAP",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Test availability zone latency.",
            "waf": "Performance"
        },
        {
            "checklist": "WAF checklist",
            "guid": "9fd7ffd4-da11-49f6-a374-8d03e94c511d",
            "link": "https://support.sap.com/en/offerings-programs/support-services/earlywatch-alert.html",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP"
            ],
            "severity": "Medium",
            "text": "Activate SAP EarlyWatch Alert for all SAP components.",
            "training": "https://help.sap.com/docs/SUPPORT_CONTENT/techops/3362700736.html",
            "waf": "Performance"
        },
        {
            "checklist": "WAF checklist",
            "guid": "b9b140cf-413a-483d-aad2-8802c4e3c017",
            "link": "https://techcommunity.microsoft.com/t5/running-sap-applications-on-the/sap-on-azure-general-update-march-2019/ba-p/377456",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP"
            ],
            "severity": "Medium",
            "text": "Review SAP application server to database server latency using SAP ABAPMeter report /SSA/CAT.",
            "training": "https://me.sap.com/notes/0002879613",
            "waf": "Performance"
        },
        {
            "checklist": "WAF checklist",
            "guid": "62fbf0f8-51db-49e1-a961-bb5df7a35f80",
            "service": "SAP",
            "services": [
                "WAF",
                "Monitor",
                "SQL"
            ],
            "severity": "Medium",
            "text": "Review SQL Server performance monitoring using CCMS.",
            "waf": "Performance"
        },
        {
            "checklist": "WAF checklist",
            "guid": "35709da7-fc7d-4efe-bb20-2e91547b7390",
            "link": "https://me.sap.com/notes/500235",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP",
                "VM"
            ],
            "severity": "Medium",
            "text": "Test network latency between SAP application layer VMs and DBMS VMs (NIPING).",
            "training": "https://me.sap.com/notes/1100926/E",
            "waf": "Performance"
        },
        {
            "checklist": "WAF checklist",
            "guid": "9e9bb4c8-e934-4e4b-a13c-6f7c7c38eb43",
            "link": "https://learn.microsoft.com/en-us/azure/sap/large-instances/hana-monitor-troubleshoot",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP",
                "Monitor"
            ],
            "severity": "Medium",
            "text": "Review SAP HANA studio alerts.",
            "waf": "Performance"
        },
        {
            "checklist": "WAF checklist",
            "guid": "f1a92ab5-9509-4b57-86ff-b0ade361b694",
            "link": "https://me.sap.com/notes/1969700",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP"
            ],
            "severity": "Medium",
            "text": "Perform SAP HANA health checks using HANA_Configuration_Minichecks.",
            "waf": "Performance"
        },
        {
            "checklist": "WAF checklist",
            "guid": "18dffcf3-248c-4039-a67c-dec8e3a5f804",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/sap/sap-lza-security-operations",
            "service": "SAP",
            "services": [
                "WAF",
                "VM"
            ],
            "severity": "Medium",
            "text": "If you run Windows and Linux VMs in Azure, on-premises, or in other cloud environments, you can use the Update management center in Azure Automation to manage operating system updates, including security patches.",
            "training": "https://learn.microsoft.com/azure/automation/update-management/overview",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "08951710-79a2-492a-adbc-06d7a401545b",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/sap/sap-lza-security-operations",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP"
            ],
            "severity": "Medium",
            "text": "Routinely review the SAP security OSS notes because SAP releases highly critical security patches, or hot fixes, that require immediate action to protect your SAP systems.",
            "training": "https://support.sap.com/en/my-support/knowledge-base/security-notes-news.html",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "1b8b394e-ae64-4a74-8933-357b523ea0a0",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/sap/sap-lza-database-security",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP",
                "SQL"
            ],
            "severity": "Low",
            "text": "For SAP on SQL Server, you can disable the SQL Server system administrator account because the SAP systems on SQL Server don't use the account. Ensure that another user with system administrator rights can access the server before disabling the original system administrator account.",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "5a76a033-ced9-4eef-9a43-5e4f96634c8e",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/sap/sap-lza-database-security",
            "service": "SAP",
            "services": [
                "WAF",
                "SQL"
            ],
            "severity": "High",
            "text": "Disable xp_cmdshell. The SQL Server feature xp_cmdshell enables a SQL Server internal operating system command shell. It's a potential risk in security audits.",
            "training": "https://me.sap.com/notes/3019299/E",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "cf65de8e-1309-4ccc-b579-266bcca275fa",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/sap/eslz-security-governance-and-compliance",
            "service": "SAP",
            "services": [
                "WAF",
                "SQL",
                "SAP",
                "Backup",
                "Storage"
            ],
            "severity": "High",
            "text": "Encrypting SAP HANA database servers on Azure uses SAP HANA native encryption technology. Additionally, if you are using SQL Server on Azure, use Transparent Data Encryption (TDE) to protect your data and log files and ensure that your backups are also encrypted.",
            "training": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/sap/sap-lza-database-security",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "a1abfe9d-55d0-44c3-a491-9cb1b3d1325a",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-service-encryption",
            "service": "SAP",
            "services": [
                "WAF",
                "Storage"
            ],
            "severity": "Medium",
            "text": "Azure Storage encryption is enabled for all Azure Resource Manager and classic storage accounts, and can't be disabled. Because your data is encrypted by default, you don't need to modify your code or applications to use Azure Storage encryption.",
            "training": "https://learn.microsoft.com/training/modules/encrypt-sector-data/?source=recommendations",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "ce9bd3bb-0cdb-43b5-9eb2-ec14eeaa3592",
            "link": "https://learn.microsoft.com/azure/key-vault/general/overview",
            "service": "SAP",
            "services": [
                "WAF",
                "AKV"
            ],
            "severity": "High",
            "text": "Use Azure Key Vault to store your secrets and credentials",
            "training": "https://learn.microsoft.com/training/modules/manage-secrets-with-azure-key-vault/?source=recommendations",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "829e2edb-2173-4676-aff6-691b4935ada4",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/lock-resources?tabs=json",
            "service": "SAP",
            "services": [
                "WAF",
                "Subscriptions",
                "AzurePolicy",
                "RBAC"
            ],
            "severity": "Medium",
            "text": "It is recommended to LOCK the Azure Resources post successful deployment to safeguard against unauthorized changes. You can also enforce LOCK constraints and rules on your per-subscription basis using customized Azure policies(Custome role).",
            "training": "https://learn.microsoft.com/training/modules/use-azure-resource-manager/?source=recommendations",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "2223ece8-1b12-4318-8a54-17415833fb4a",
            "link": "https://learn.microsoft.com/azure/key-vault/general/soft-delete-overview",
            "service": "SAP",
            "services": [
                "WAF",
                "AKV",
                "AzurePolicy"
            ],
            "severity": "Medium",
            "text": "Provision Azure Key Vault with the soft delete and purge policies enabled to allow retention protection for deleted objects.",
            "training": "https://learn.microsoft.com/training/modules/manage-secrets-with-azure-key-vault/?source=recommendations",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "e3c2df74-3165-4c3a-abe0-5bbe209d490d",
            "link": "https://learn.microsoft.com/azure/role-based-access-control/security-controls-policy",
            "service": "SAP",
            "services": [
                "WAF",
                "RBAC",
                "AzurePolicy"
            ],
            "severity": "High",
            "text": "Based on existing requirements, regulatory and compliance controls (internal/external) - Determine what Azure Policies and Azure RBAC role are needed",
            "training": "https://learn.microsoft.com/training/paths/describe-azure-management-governance/?source=recommendations",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "a4777842-4d11-4678-9d2f-a56c56ad4840",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/sap/eslz-security-governance-and-compliance",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP",
                "Storage",
                "Defender"
            ],
            "severity": "High",
            "text": "When enabling Microsoft Defender for Endpoint on SAP environment, recommend excluding data and log files on DBMS servers instead of targeting all servers. Follow your DBMS vendor's recommendations when excluding target files.",
            "training": "https://techcommunity.microsoft.com/t5/running-sap-applications-on-the/microsoft-defender-endpoint-mde-for-sap-applications-on-windows/ba-p/3912268",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "8fe72734-c486-4ba2-a0dc-0591cf65de8e",
            "link": "https://learn.microsoft.com/azure/defender-for-cloud/just-in-time-access-overview?tabs=defender-for-container-arch-aks",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP",
                "RBAC",
                "Defender"
            ],
            "severity": "High",
            "text": "Delegate an SAP admin custom role with just-in-time access of Microsoft Defender for Cloud.",
            "training": "https://learn.microsoft.com/training/modules/secure-vms-with-azure-security-center/?source=recommendations",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "1309cccd-5792-466b-aca2-75faa1abfe9d",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/sap/eslz-security-governance-and-compliance",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP"
            ],
            "severity": "Low",
            "text": "encrypt data in transit by integrating the third-party security product with secure network communications (SNC) for DIAG (SAP GUI), RFC, and SPNEGO for HTTPS",
            "training": "https://learn.microsoft.com/azure/security/fundamentals/encryption-overview#encryption-of-data-in-transit",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "eeaa3592-829e-42ed-a217-3676aff6691b",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-encryption-key-model-get?tabs=portal",
            "service": "SAP",
            "services": [
                "WAF",
                "AKV"
            ],
            "severity": "Medium",
            "text": "Default to Microsoft-managed keys for principal encryption functionality and use customer-managed keys when required.",
            "training": "https://learn.microsoft.com/training/modules/manage-secrets-with-azure-key-vault/?source=recommendations",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "4935ada4-2223-4ece-a1b1-23181a541741",
            "link": "https://learn.microsoft.com/ja-jp/azure/key-vault/general/best-practices",
            "service": "SAP",
            "services": [
                "WAF",
                "AKV"
            ],
            "severity": "High",
            "text": "Use an Azure Key Vault per application per environment per region.",
            "training": "https://learn.microsoft.com/training/modules/manage-secrets-with-azure-key-vault/?source=recommendations",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "abc9634d-c44d-41e9-a530-e8444e16aa3c",
            "link": "https://learn.microsoft.com/azure/key-vault/certificates/certificate-scenarios",
            "service": "SAP",
            "services": [
                "WAF",
                "AKV",
                "SAP"
            ],
            "severity": "High",
            "text": "To control and manage disk encryption keys and secrets for non-HANA Windows and non-Windows operating systems, use Azure Key Vault. SAP HANA isn't supported with Azure Key Vault, so you must use alternate methods like SAP ABAP or SSH keys.",
            "training": "https://learn.microsoft.com/training/modules/configure-and-manage-azure-key-vault/?source=recommendations",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "209d490d-a477-4784-84d1-16785d2fa56c",
            "link": "https://learn.microsoft.com/azure/role-based-access-control/built-in-roles",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP",
                "Subscriptions",
                "RBAC"
            ],
            "severity": "High",
            "text": "Customize role-based access control (RBAC) roles for SAP on Azure spoke subscriptions to avoid accidental network-related changes",
            "training": "https://learn.microsoft.com/training/modules/secure-azure-resources-with-rbac/?source=recommendations",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "56ad4840-8fe7-4273-9c48-6ba280dc0591",
            "link": "https://blogs.sap.com/2019/07/21/sap-security-operations-on-azure/",
            "service": "SAP",
            "services": [
                "WAF",
                "NVA",
                "PrivateLink",
                "SAP"
            ],
            "severity": "High",
            "text": "Isolate DMZs and NVAs from the rest of the SAP estate, configure Azure Private Link, and securely manage and control the SAP on Azure resources",
            "training": "https://learn.microsoft.com/azure/architecture/reference-architectures/dmz/secure-vnet-dmz?tabs=portal",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "e124ba34-df68-45ed-bce9-bd3bb0cdb3b5",
            "link": "https://learn.microsoft.com/en-us/training/modules/secure-vms-with-azure-security-center/?source=recommendations",
            "service": "SAP",
            "services": [
                "WAF",
                "VM",
                "Storage"
            ],
            "severity": "Low",
            "text": "Consider using Microsoft anti-malware software on Azure to protect your virtual machines from malicious files, adware, and other threats.",
            "training": "https://azure.microsoft.com/blog/deploying-antimalware-solutions-on-azure-virtual-machines/",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "5eb2ec14-eeaa-4359-8829-e2edb2173676",
            "link": "https://learn.microsoft.com/microsoft-365/security/defender-endpoint/microsoft-defender-endpoint?view=o365-worldwide",
            "service": "SAP",
            "services": [
                "WAF",
                "Defender"
            ],
            "severity": "Low",
            "text": "For even more powerful protection, consider using Microsoft Defender for Endpoint.",
            "training": "https://learn.microsoft.com/training/modules/implement-endpoint-protection-use-microsoft-defender/?source=recommendations",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "87a924c4-25c2-419f-a2f0-96c7c4fe4525",
            "link": "https://learn.microsoft.com/azure/architecture/guide/sap/sap-whole-landscape",
            "service": "SAP",
            "services": [
                "WAF",
                "VNet",
                "SAP"
            ],
            "severity": "High",
            "text": "Isolate the SAP application and database servers from the internet or from the on-premises network by passing all traffic through the hub virtual network, which is connected to the spoke network by virtual network peering. The peered virtual networks guarantee that the SAP on Azure solution is isolated from the public internet.",
            "training": "https://learn.microsoft.com/training/modules/explore-azure-networking/?source=recommendations",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "491ca1c4-3d40-42c0-9d85-b8933999590b",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/sap/eslz-security-governance-and-compliance",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP"
            ],
            "severity": "Low",
            "text": "For internet-facing applications like SAP Fiori, make sure to distribute load per application requirements while maintaining security levels. For Layer 7 security, you can use a third-party Web Application Firewall (WAF) available in the Azure Marketplace.",
            "training": "https://learn.microsoft.com/training/modules/simplify-cloud-procurement-governance-azure-marketplace/?source=recommendations",
            "waf": "Security"
        },
        {
            "checklist": "WAF checklist",
            "guid": "9fc945b9-0527-47af-8200-9d652fe02fcc",
            "link": "https://learn.microsoft.com/azure/sap/monitor/enable-tls-azure-monitor-sap-solutions",
            "service": "SAP",
            "services": [
                "WAF",
                "AKV",
                "Monitor",
                "SAP"
            ],
            "severity": "Medium",
            "text": "To enable secure communication in Azure Monitor for SAP solutions, you can choose to use either a root certificate or a server certificate. We highly recommend that you use root certificates.",
            "training": "https://learn.microsoft.com/training/modules/implement-azure-monitoring-sap-workloads-azure-virtual-machines/?source=recommendations",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.Search/searchServices",
            "checklist": "WAF checklist",
            "guid": "41faa1ed-b7f0-447d-8cba-4a4905e5bb83",
            "link": "https://learn.microsoft.com/azure/search/search-reliability#high-availability",
            "service": "Cognitive Search",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Enable 2 replicas to have 99.9% availability for read operations",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Search/searchServices",
            "checklist": "WAF checklist",
            "guid": "7d956fd9-788a-4845-9b9f-c0340972d810",
            "link": "https://learn.microsoft.com/azure/search/search-reliability#high-availability",
            "service": "Cognitive Search",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Enable 3 replicas to have 99.9% availability for read/write operations",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Search/searchServices",
            "checklist": "WAF checklist",
            "guid": "44dc5f2b-a032-4d03-aae8-90c3f2c0a4c3",
            "link": "https://learn.microsoft.com/azure/search/search-reliability#availability-zone-support",
            "service": "Cognitive Search",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Leverage Availability Zones by enabling read and/or write replicas",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Search/searchServices",
            "checklist": "WAF checklist",
            "guid": "cd0730f0-0ff1-4b77-9a2b-2a1f7dd5e291",
            "link": "https://learn.microsoft.com/azure/search/search-reliability#multiple-services-in-separate-geographic-regions",
            "service": "Cognitive Search",
            "services": [
                "WAF",
                "ACR"
            ],
            "severity": "Medium",
            "text": "For regional redudancy, Manually create services in 2 or more regions for Search as it doesn't provide an automated method of replicating search indexes across geographic regions",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Search/searchServices",
            "checklist": "WAF checklist",
            "guid": "3c964882-aec9-4d44-9f68-4b5f2efbbdb6",
            "link": "https://learn.microsoft.com/azure/search/search-reliability#synchronize-data-across-multiple-services",
            "service": "Cognitive Search",
            "services": [
                "WAF",
                "ACR"
            ],
            "severity": "Medium",
            "text": "To synchronize data across multiple services either Use indexers for updating content on multiple services or Use REST APIs for pushing content updates on multiple services",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Search/searchServices",
            "checklist": "WAF checklist",
            "guid": "85ee93c9-f53c-4803-be51-e6e4aa37ff4e",
            "link": "https://learn.microsoft.com/azure/search/search-reliability#use-azure-traffic-manager-to-coordinate-requests",
            "service": "Cognitive Search",
            "services": [
                "WAF",
                "TrafficManager"
            ],
            "severity": "Medium",
            "text": "Use Azure Traffic Manager to coordinate requests",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Search/searchServices",
            "checklist": "WAF checklist",
            "guid": "7be10278-57c1-4a61-8ee3-895aebfec5aa",
            "link": "https://learn.microsoft.com/azure/search/search-reliability#back-up-and-restore-alternatives",
            "service": "Cognitive Search",
            "services": [
                "WAF",
                "Storage",
                "Backup"
            ],
            "severity": "High",
            "text": "Backup and Restore an Azure Cognitive Search Index. Use this sample code to back up index definition and snapshot to a series of Json files",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.Insights/components",
            "checklist": "WAF checklist",
            "guid": "a95b86ad-8840-48e3-9273-4b875ba18f20",
            "link": "https://learn.microsoft.com/azure/architecture/guide/multitenant/considerations/tenancy-models",
            "service": "Azure Monitor",
            "services": [
                "WAF",
                "Monitor"
            ],
            "severity": "Medium",
            "text": "Data collection rules in Azure Monitor -https://learn.microsoft.com/azure/azure-monitor/essentials/data-collection-rule-overview",
            "training": "https://azure.microsoft.com/pricing/reservations/",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.RecoveryServices/vaults",
            "checklist": "WAF checklist",
            "guid": "45901365-d38e-443f-abcb-d868266abca2",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/multi-tenant/automation",
            "service": "Azure Backup",
            "services": [
                "WAF",
                "Backup"
            ],
            "severity": "Medium",
            "text": "check backup instances with the underlying datasource not found",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "WAF checklist",
            "guid": "64f9a19a-f29c-495d-94c6-c7919ca0f6c5",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/multi-tenant/lighthouse",
            "service": "VM",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Delete or archive unassociated services (disks, nics, ip addresses etc)",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.RecoveryServices/vaults",
            "checklist": "WAF checklist",
            "guid": "69bad37a-ad53-4cc7-ae1d-76667357c449",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-microsoft-customer-agreement#design-recommendations",
            "service": "Azure Backup",
            "services": [
                "WAF",
                "Storage",
                "ASR",
                "Backup"
            ],
            "severity": "Medium",
            "text": "Consider a good balance between site recovery storage and backup for non mission critical applications",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Insights/components",
            "checklist": "WAF checklist",
            "guid": "674b5ed8-5a85-49c7-933b-e2a1a27b765a",
            "link": "https://learn.microsoft.com/azure/cost-management-billing/manage/direct-ea-administration#manage-notification-contacts",
            "service": "Azure Monitor",
            "services": [
                "WAF",
                "Monitor"
            ],
            "severity": "Medium",
            "text": "Check spending and savings opportunities among the 40 different log analytics workspaces- use different retention and data collection for nonprod workspaces-create daily cap for awareness and tier sizing -  If you do set a daily cap, in addition to creating an alert when the cap is reached,ensure that you also create an alert rule to be notified when some percentage has been reached (90% for example). - consider workspace transformation if possible - https://learn.microsoft.com/azure/azure-monitor/essentials/data-collection-transformations#workspace-transformation-dcr ",
            "training": "https://learn.microsoft.com/azure/cost-management-billing/costs/understand-work-scopes",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Insights/components",
            "checklist": "WAF checklist",
            "guid": "91be1f38-8ef3-494c-8bd4-63cbbac75819",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-enterprise-agreement#design-considerations",
            "service": "Azure Monitor",
            "services": [
                "WAF",
                "AzurePolicy",
                "Storage"
            ],
            "severity": "Medium",
            "text": "Enforce a purging log policy and automation (if needed, logs can be moved to cold storage)",
            "training": "https://www.youtube.com/watch?v=nHQYcYGKuyw",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "WAF checklist",
            "guid": "6aae01e6-a84d-4e5d-b36d-1d92881a1bd5",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-enterprise-agreement#design-considerations",
            "service": "VM",
            "services": [
                "WAF",
                "Storage",
                "Backup"
            ],
            "severity": "Medium",
            "text": "Check that the disks are really needed, if not: delete. If they are needed, find lower storage tiers or use backup -",
            "training": "https://learn.microsoft.com/azure/cost-management-billing/costs/manage-automation",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "WAF checklist",
            "guid": "d1e44a19-659d-4395-afd7-7289b835556d",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-enterprise-agreement#design-considerations",
            "service": "Storage",
            "services": [
                "WAF",
                "AzurePolicy",
                "Storage"
            ],
            "severity": "Medium",
            "text": "Consider moving unused storage to lower tier, with customized rule - https://learn.microsoft.com/azure/storage/blobs/lifecycle-management-policy-configure  ",
            "training": "https://learn.microsoft.com/azure/cost-management-billing/costs/enable-tag-inheritance",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "WAF checklist",
            "guid": "d0102cac-6aae-401e-9a84-de5de36d1d92",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "service": "VM",
            "services": [
                "WAF",
                "VM"
            ],
            "severity": "Medium",
            "text": "Make sure advisor is configured for VM right sizing ",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "WAF checklist",
            "description": "check by searching the Meter Category Licenses in the Cost analysys",
            "guid": "59ae568b-a38d-4498-9e22-13dbd7bb012f",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/manage/centralize-operations",
            "service": "VM",
            "services": [
                "WAF",
                "AzurePolicy",
                "VM",
                "Cost"
            ],
            "severity": "Medium",
            "text": "run the script on all windows VMs https://learn.microsoft.com/azure/virtual-machines/windows/hybrid-use-benefit-licensing?ref=andrewmatveychuk.com#convert-an-existing-vm-using-azure-hybrid-benefit-for-windows-server- consider implementing a policy if windows VMs are created frequently",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "WAF checklist",
            "guid": "7b95e06e-158e-42ea-9992-c2de6e2065b3",
            "link": "https://learn.microsoft.com/azure/active-directory/privileged-identity-management/pim-configure",
            "service": "VM",
            "services": [
                "WAF",
                "LoadBalancer"
            ],
            "severity": "Medium",
            "text": " this can be also put under AHUB if you already have licenses https://learn.microsoft.com/azure/virtual-machines/linux/azure-hybrid-benefit-linux?tabs=rhelpayg%2Crhelbyos%2CrhelEnablebyos%2Crhelcompliance",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "WAF checklist",
            "guid": "75c1e945-b459-4837-bf7a-e7c6d3b475a5",
            "link": "https://learn.microsoft.com/azure/active-directory/fundamentals/active-directory-groups-create-azure-portal",
            "service": "VM",
            "services": [
                "WAF",
                "VM"
            ],
            "severity": "Medium",
            "text": "Consolidate reserved VM families with flexibility option (no more than 4-5 families)",
            "training": "https://learn.microsoft.com/azure/automation/automation-solution-vm-management",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "WAF checklist",
            "guid": "c7acbe49-bbe6-44dd-a9f2-e87778468d55",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/identity-access#prerequisites-for-a-landing-zone---design-recommendations",
            "service": "VM",
            "services": [
                "WAF",
                "VM",
                "ARS",
                "Cost"
            ],
            "severity": "Medium",
            "text": "Utilize Azure Reserved Instances: This feature allows you to reserve VMs for a period of 1 or 3 years, providing significant cost savings compared to PAYG prices.",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "WAF checklist",
            "guid": "a6bcca2b-4fea-41db-b3dd-95d48c7c891d",
            "link": "https://learn.microsoft.com/azure/active-directory-domain-services/overview",
            "service": "VM",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Only larger disks can be reserved => 1 TiB -",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "WAF checklist",
            "guid": "cb1f7d57-59ae-4568-aa38-d4985e2213db",
            "link": "https://learn.microsoft.com/azure/architecture/reference-architectures/identity/adds-extend-domain",
            "service": "VM",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "After the right-sizing optimization",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Sql/servers",
            "checklist": "WAF checklist",
            "guid": "d7bb012f-7b95-4e06-b158-e2ea3992c2de",
            "link": "https://learn.microsoft.com/azure/active-directory/app-proxy/application-proxy",
            "service": "Azure SQL",
            "services": [
                "WAF",
                "AzurePolicy",
                "Cost",
                "SQL"
            ],
            "severity": "Medium",
            "text": "Check if applicable and enforce policy/change https://learn.microsoft.com/azure/azure-sql/azure-hybrid-benefit?view=azuresql&tabs=azure-portalhttps://learn.microsoft.com/azure/cost-management-billing/scope-level/create-sql-license-assignments?source=recommendations",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "WAF checklist",
            "guid": "6e2065b3-a76a-4f4a-991e-8839ada46667",
            "link": "https://learn.microsoft.com/azure/active-directory/roles/best-practices",
            "service": "VM",
            "services": [
                "WAF",
                "VM"
            ],
            "severity": "Medium",
            "text": "The VM + license part discount (ahub + 3YRI) is around 70% discount",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "WAF checklist",
            "guid": "ccbd9792-a6bc-4ca2-a4fe-a1dbf3dd95d4",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#send-logs-to-microsoft-sentinel",
            "service": "VM",
            "services": [
                "WAF",
                "VM"
            ],
            "severity": "Medium",
            "text": "Consider using a VMSS to match demand rather than flat sizing",
            "waf": "Cost"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "WAF checklist",
            "guid": "c1b1cd52-1e54-4a29-a9de-39ac0e7c28dc",
            "link": "https://learn.microsoft.com/azure/reliability/cross-region-replication-azure",
            "service": "AKS",
            "services": [
                "WAF",
                "AKS"
            ],
            "severity": "Medium",
            "text": "Use AKS autoscaler to match your clusters usage (make sure the pods requirements match the scaler)",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.RecoveryServices/vaults",
            "checklist": "WAF checklist",
            "guid": "44be3b1a-27f8-4b9e-a1be-1f38df03a822",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/data-retention-archive?tabs=portal-1%2Cportal-2#how-retention-and-archiving-work",
            "service": "Azure Backup",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Move recovery points to vault-archive where applicable (Validate)",
            "training": "https://azure.microsoft.com/pricing/reservations/",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Databricks/workspaces",
            "checklist": "WAF checklist",
            "guid": "cd463cbb-bc8a-4c29-aebc-91a43da1dae2",
            "link": "https://learn.microsoft.com/azure/databricks/clusters/cluster-config-best-practices#automatic-termination",
            "service": "Databricks",
            "services": [
                "WAF",
                "VM",
                "LoadBalancer"
            ],
            "severity": "Medium",
            "text": "Consider using Spot VMs with fallback where possible. Consider autotermination of clusters.",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Web/sites",
            "checklist": "WAF checklist",
            "guid": "cc881470-607c-41cc-a0e6-14658dd458e9",
            "link": "https://learn.microsoft.com/azure/governance/policy/how-to/guest-configuration-create",
            "service": "Azure Functions",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Functions - Reuse connections",
            "training": "https://learn.microsoft.com/azure/cost-management-billing/reservations/reservation-apis?toc=%2Fazure%2Fcost-management-billing%2Ftoc.json",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Web/sites",
            "checklist": "WAF checklist",
            "guid": "27139b82-1102-4dbd-9eaf-11e6f843e52f",
            "link": "https://learn.microsoft.com/azure/automation/update-management/overview",
            "service": "Azure Functions",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Functions - Cache data locally",
            "training": "https://learn.microsoft.com/learn/paths/azure-administrator-manage-compute-resources/",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Web/sites",
            "checklist": "WAF checklist",
            "guid": "4722d928-c1b1-4cd5-81e5-4a29b9de39ac",
            "link": "https://learn.microsoft.com/azure/network-watcher/network-watcher-monitoring-overview",
            "service": "Azure Functions",
            "services": [
                "WAF",
                "Storage"
            ],
            "severity": "Medium",
            "text": "Functions - Cold starts-Use the 'Run from package' functionality. This way, the code is downloaded as a single zip file. This can, for example, result in significant improvements with Javascript functions, which have a lot of node modules.Use language specific tools to reduce the package size, for example, tree shaking Javascript applications.",
            "training": "https://learn.microsoft.com/learn/modules/configure-network-watcher/",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Web/sites",
            "checklist": "WAF checklist",
            "guid": "0e7c28dc-9366-4572-82bf-f4564b0d934a",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/lock-resources?tabs=json",
            "service": "Azure Functions",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Functions - Keep your functions warm",
            "training": "https://learn.microsoft.com/learn/paths/implement-resource-mgmt-security/",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Web/sites",
            "checklist": "WAF checklist",
            "guid": "359c363e-7dd6-4162-9a36-4a907ebae38e",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "service": "Azure Functions",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "When using autoscale with different functions, there might be one driving all the autoscale for all the resources - consider moving it to a separate consumption plan (and consider higher plan for CPU)",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Web/sites",
            "checklist": "WAF checklist",
            "guid": "ad53cc7d-e2e8-4aaa-a357-1549ab9153d8",
            "link": "https://learn.microsoft.com/azure/service-health/alerts-activity-log-service-notifications-portal",
            "service": "Azure Functions",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Function apps in a given plan are all scaled together, so any issues with scaling can affect all apps in the plan.",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Web/sites",
            "checklist": "WAF checklist",
            "guid": "9f89dc7b-44be-43b1-a27f-8b9e91be1f38",
            "link": "https://learn.microsoft.com/azure/azure-monitor/alerts/action-groups",
            "service": "Azure Functions",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Am I billed for 'await time'? This question is typically asked in the context of a C# function that does an async operation and waits for the result, e.g. await Task.Delay(1000) or await client.GetAsync('http://google.com'). The answer is yes - the GB second calculation is based on the start and end time of the function and the memory usage over that period. What actually happens over that time in terms of CPU activity is not factored into the calculation.One exception to this rule is if you are using durable functions. You are not billed for time spent at awaits in orchestrator functions.apply demand shaping techinques where possible (dev environments?) https://github.com/Azure-Samples/functions-csharp-premium-scaler",
            "waf": "Cost"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "WAF checklist",
            "guid": "3da1dae2-cc88-4147-8607-c1cca0e61465",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/design-logs-deployment",
            "service": "Front Door",
            "services": [
                "WAF",
                "FrontDoor",
                "EventHubs"
            ],
            "severity": "Medium",
            "text": "Frontdoor - Turn off the default homepageIn the application settings of your App, set AzureWebJobsDisableHomepage to true. This will return a 204 (No Content) to the PoP so only header data is returned.",
            "waf": "Cost"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "WAF checklist",
            "guid": "8dd458e9-2713-49b8-8110-2dbd6eaf11e6",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-setup-guide/monitoring-reporting?tabs=AzureMonitor",
            "service": "Front Door",
            "services": [
                "WAF",
                "FrontDoor",
                "AppSvc"
            ],
            "severity": "Medium",
            "text": "Frontdoor - Route to something that returns nothing. Either set up a Function, Function Proxy, or add a route in your WebApp that returns 200 (OK) and sends no or minimal content. The advantage of this is you will be able to log out when it is called.",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "WAF checklist",
            "guid": "7e31c67d-68cf-46a6-8a11-94956d697dc3",
            "link": "https://learn.microsoft.com/azure/architecture/best-practices/monitoring",
            "service": "Storage",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Consider archiving tiers for less used data",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "WAF checklist",
            "guid": "a2ed27b2-d186-4f1a-8252-bddde68a487c",
            "link": "https://learn.microsoft.com/azure/automation/how-to/region-mappings",
            "service": "VM",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Check disk sizes where the size does not match the tier (i.e. A 513 GiB disk will pay a P30 (1TiB) and consider resizing",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "WAF checklist",
            "guid": "dec4861b-c3bc-410a-b77e-26e4d5a3bec2",
            "link": "https://learn.microsoft.com/azure/governance/policy/concepts/guest-configuration",
            "service": "Storage",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Consider using standard SSD rather than Premium or Ultra where possible",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "WAF checklist",
            "guid": "c4e2436b-1336-4db5-9f17-960eee0bdf5c",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/management-operational-compliance#monitoring-for-configuration-drift",
            "service": "Storage",
            "services": [
                "WAF",
                "Storage"
            ],
            "severity": "Medium",
            "text": "For storage accounts, make sure that the chosen tier is not adding up transaction charges (it might be cheaper to move to the next tier)",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.RecoveryServices/vaults",
            "checklist": "WAF checklist",
            "guid": "c2efc5d7-61d4-41d2-900b-b47a393a040f",
            "link": "https://learn.microsoft.com/azure/site-recovery/site-recovery-overview",
            "service": "Site Recovery",
            "services": [
                "WAF",
                "ASR"
            ],
            "severity": "Medium",
            "text": "For ASR, consider using Standard SSD disks if the RPO/RTO and replication throughput allow it",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Storage/storageAccounts",
            "checklist": "WAF checklist",
            "guid": "d3294798-b118-48b2-a5a4-6ceb544451e1",
            "link": "https://learn.microsoft.com/azure/architecture/framework/resiliency/backup-and-recovery",
            "service": "Storage",
            "services": [
                "WAF",
                "Storage"
            ],
            "severity": "Medium",
            "text": "Storage accounts: check hot tier and/or GRS necessary",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "WAF checklist",
            "guid": "92d34429-3c76-4286-97a5-51c5b04e4f18",
            "link": "https://learn.microsoft.com/azure/backup/backup-center-overview",
            "service": "VM",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Disks - validate use of Premium SSD disks everywhere: for example, non-prod could swap to Standard SSD or on-demand Premium SSD  ",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Synapse/workspaces",
            "checklist": "WAF checklist",
            "guid": "54387e5c-ed12-46cd-832a-f5b2fc6998a5",
            "link": "https://learn.microsoft.com/azure/reliability/availability-zones-overview",
            "service": "Synapse",
            "services": [
                "WAF",
                "EventHubs",
                "Cost",
                "Monitor"
            ],
            "severity": "Medium",
            "text": "Create budgets to manage costs and create alerts that automatically notify stakeholders of spending anomalies and overspending risks.",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Synapse/workspaces",
            "checklist": "WAF checklist",
            "guid": "35e33789-7e31-4c67-b68c-f6a62a119495",
            "link": "https://learn.microsoft.com/azure/virtual-machines/availability",
            "service": "Synapse",
            "services": [
                "WAF",
                "Cost",
                "Storage"
            ],
            "severity": "Medium",
            "text": "Export cost data to a storage account for additional data analysis.",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Synapse/workspaces",
            "checklist": "WAF checklist",
            "guid": "6d697dc3-a2ed-427b-8d18-6f1a1252bddd",
            "link": "https://learn.microsoft.com/azure/load-balancer/load-balancer-overview",
            "service": "Synapse",
            "services": [
                "WAF",
                "Cost",
                "SQL"
            ],
            "severity": "Medium",
            "text": "Control costs for a dedicated SQL pool by pausing the resource when it is not in use.",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Synapse/workspaces",
            "checklist": "WAF checklist",
            "guid": "e68a487c-dec4-4861-ac3b-c10ae77e26e4",
            "link": "https://learn.microsoft.com/azure/virtual-machine-scale-sets/overview",
            "service": "Synapse",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Enable the serverless Apache Spark automatic pause feature and set your timeout value accordingly.",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Synapse/workspaces",
            "checklist": "WAF checklist",
            "guid": "d5a3bec2-c4e2-4436-a133-6db55f17960e",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-latest-version-for-customer-managed-certificates",
            "service": "Synapse",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Create multiple Apache Spark pool definitions of various sizes.",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Synapse/workspaces",
            "checklist": "WAF checklist",
            "guid": "ee0bdf5c-c2ef-4c5d-961d-41d2500bb47a",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/resource-org-management-groups#management-groups-in-the-azure-landing-zone-accelerator",
            "service": "Synapse",
            "services": [
                "WAF",
                "Cost"
            ],
            "severity": "Medium",
            "text": "Purchase Azure Synapse commit units (SCU) for one year with a pre-purchase plan to save on your Azure Synapse Analytics costs.",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "WAF checklist",
            "guid": "393a040f-d329-4479-ab11-88b2c5a46ceb",
            "link": "https://learn.microsoft.com/azure/application-gateway/overview-v2",
            "service": "VM",
            "services": [
                "WAF",
                "VM",
                "Cost"
            ],
            "severity": "Medium",
            "text": "Use Spot VMs for interruptible jobs: These are VMs that can be bid on and purchased at a discounted price, providing a cost-effective solution for non-critical workloads.",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "WAF checklist",
            "guid": "544451e1-92d3-4442-a3c7-628637a551c5",
            "link": "https://learn.microsoft.com/azure/load-balancer/load-balancer-overview",
            "service": "VM",
            "services": [
                "WAF",
                "VM"
            ],
            "severity": "Medium",
            "text": "Right-sizing all VMs",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "WAF checklist",
            "guid": "b04e4f18-5438-47e5-aed1-26cd032af5b2",
            "link": "https://learn.microsoft.com/azure/application-gateway/configuration-infrastructure#size-of-the-subnet",
            "service": "VM",
            "services": [
                "WAF",
                "VM"
            ],
            "severity": "Medium",
            "text": "Swap VM sized with normalized and most recent sizes",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "WAF checklist",
            "guid": "fc6998a5-35e3-4378-a7e3-1c67d68cf6a6",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "service": "VM",
            "services": [
                "WAF",
                "Monitor",
                "VM"
            ],
            "severity": "Medium",
            "text": "right-sizing VMs - start with monitoring usage below 5% and then work up to 40%",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.Compute/virtualMachines",
            "checklist": "WAF checklist",
            "guid": "2a119495-6d69-47dc-9a2e-d27b2d186f1a",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "service": "VM",
            "services": [
                "WAF",
                "VM"
            ],
            "severity": "Medium",
            "text": "Containerizing an application can improve VM density and save money on scaling it",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Cost"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "a85b86ad-884f-48e3-9273-4b875ba18f10",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/concepts/system-message#define-additional-safety-and-behavioral-guardrails",
            "service": "Azure OpenAI",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Follow Metaprompting guardrails for resonsible AI",
            "waf": "Operational Excellence"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "d4391898-cd28-48be-b6b1-7cb8245451e1",
            "link": "https://github.com/Azure-Samples/AI-Gateway",
            "service": "Azure OpenAI",
            "services": [
                "WAF",
                "Entra",
                "APIM"
            ],
            "severity": "High",
            "text": "Consider Gateway patterns with APIM  or solutions like AI central for better rate limiting, load balancing, authentication and logging",
            "waf": "Operational Excellence"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "aed3453a-ec72-4392-97a1-52d6cc5e4029",
            "link": "https://techcommunity.microsoft.com/t5/fasttrack-for-azure/azure-openai-insights-monitoring-ai-with-confidence/ba-p/4026850",
            "service": "Azure OpenAI",
            "services": [
                "WAF",
                "Monitor"
            ],
            "severity": "High",
            "text": "Enable monitoring for your AOAI instances",
            "waf": "Operational Excellence"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "697cb391-ed16-4b2d-886f-0a0241addde6",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/monitoring#set-up-alerts",
            "service": "Azure OpenAI",
            "services": [
                "WAF",
                "AKV",
                "Subscriptions",
                "Monitor"
            ],
            "severity": "High",
            "text": "Create alerts to notify teams of events such as an entry in the activity log created by an action performed on the resource, such as regenerating its subscription keys or a metric threshold such as the number of errors exceeding 10 in an hour",
            "waf": "Operational Excellence"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "8a477cde-b486-41bc-9bc1-0ae66e25d4d5",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/monitoring",
            "service": "Azure OpenAI",
            "services": [
                "WAF",
                "Monitor"
            ],
            "severity": "High",
            "text": "Monitor token usage to prevent service disruptions due to capacity",
            "waf": "Operational Excellence"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "a3aec2c4-e243-46b0-936c-b45e17960eee",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/monitoring",
            "service": "Azure OpenAI",
            "services": [
                "WAF",
                "Monitor"
            ],
            "severity": "Medium",
            "text": "observe metrics like processed inference tokens, generated completion tokens monitor for rate limit",
            "waf": "Operational Excellence"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "fbdf4cc2-eec4-4d76-8c31-d25ffbb46a39",
            "link": "https://techcommunity.microsoft.com/t5/apps-on-azure-blog/build-an-enterprise-ready-azure-openai-solution-with-azure-api/ba-p/3907562",
            "service": "Azure OpenAI",
            "services": [
                "WAF",
                "APIM"
            ],
            "severity": "Low",
            "text": "Enable and configure Diagnostics for the Azure OpenAI Service. If not sufficient, consider using a gateway such as Azure API Managements in front of Azure OpenAI to log both incoming prompts and outgoing responses, where permitted",
            "waf": "Operational Excellence"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "3af30ed3-2947-498b-8178-a2c5a46ceb54",
            "link": "https://github.com/Azure-Samples/openai-enterprise-iac",
            "service": "Azure OpenAI",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Use Infrastructure as code to deploy the Azure OpenAI Service, model deployments, and all related resources",
            "waf": "Operational Excellence"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "4350d092-d234-4292-a752-8537a551c5bf",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/managed-identity",
            "service": "Azure OpenAI",
            "services": [
                "WAF",
                "Entra"
            ],
            "severity": "High",
            "text": "Use Microsoft Entra Authentication with Managed Identity instead of API Key",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "4e4f1854-287d-45cd-a126-cc031af5b1fc",
            "link": "https://learn.microsoft.com/azure/machine-learning/prompt-flow/how-to-bulk-test-evaluate-flow?view=azureml-api-2",
            "service": "Azure OpenAI",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Evaluate the performance/accuracy of the system with a known golden dataset which has the inputs and the correct answers. Leverage capabilities in PromptFlow for Evaluation.",
            "waf": "Operational Excellence"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "68889535-e327-4897-b31b-67d67be5962a",
            "link": "https://learn.microsoft.com/azure/architecture/ai-ml/architecture/baseline-openai-e2e-chat#azure-openai---performance-efficiency",
            "service": "Azure OpenAI",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Evaluate usage of Provisioned throughput model ",
            "waf": "Performance"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "cd288bed-6b17-4cb8-8454-51e1aed3453a",
            "link": "https://learn.microsoft.com/azure/ai-services/content-safety/overview",
            "service": "Azure OpenAI",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Review and implement Azure AI content safety",
            "waf": "Operational Excellence"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "1193846d-697c-4b39-8ed1-6b2d186f0a02",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/latency#system-level-throughput",
            "service": "Azure OpenAI",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Define and evaluate the throughput of the system based on tokens & response per minute and align with requirements",
            "waf": "Performance"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "41addde6-8a47-47cd-bb48-61bc3bc10ae6",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/latency#improve-performance",
            "service": "Azure OpenAI",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Improve latency of the system by limiting token sizes, streaming options for applications like chatbots or conversational interfaces. Streaming can enhance the perceived performance of Azure OpenAI applications by delivering responses to users in an incremental manner",
            "waf": "Performance"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "6e25d4d5-a3ae-4c2c-9e24-36b0336cb45e",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/latency#batching",
            "service": "Azure OpenAI",
            "services": [
                "WAF",
                "ServiceBus",
                "Storage"
            ],
            "severity": "Medium",
            "text": "Estimate elasticity demands to determine synchronous and batch request segregation based on priority. For high priority, use synchronous approach and for low priority, asynchronous batch processing with queue is preferred",
            "waf": "Performance"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "5bda4332-4f24-4811-9331-82ba51752694",
            "link": "https://github.com/Azure/azure-openai-benchmark/",
            "service": "Azure OpenAI",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Benchmark token consumption requirements based on estimated demands from consumers. Consider using the Azure OpenAI benchmarking tool to help you validate the throughput if you are using Provisioned Throughput Unit deployments",
            "waf": "Performance"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "4008ae7d-7e47-4432-96d8-bdcf55bce619",
            "link": "https://techcommunity.microsoft.com/t5/fasttrack-for-azure/optimizing-azure-openai-a-guide-to-limits-quotas-and-best/ba-p/4076268",
            "service": "Azure OpenAI",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "If you are using Provisioned Throughput Units (PTUs), consider deploying a token-per-minute (TPM) deployment for overflow requests. Use a gateway to route requests to the TPM deployment when the PTU limits are reached.",
            "waf": "Performance"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "e8a13f98-8794-424d-9267-86d60b96c97b",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/concepts/models",
            "service": "Azure OpenAI",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Choose the right model for the right task. Pick models with right tradeoff between speed, quality of response and output complexity",
            "waf": "Performance"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "e9951904-8384-45c9-a6cb-2912156a1147",
            "link": "https://github.com/Azure/azure-openai-benchmark/",
            "service": "Azure OpenAI",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Have a baseline for performance without fine-tuning for knowing whether or not fine-tuning has improved model performance",
            "waf": "Performance"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "5e39f541-accc-4d97-a376-bcdb3750ab2a",
            "link": "https://learn.microsoft.com/azure/architecture/ai-ml/architecture/baseline-openai-e2e-chat#azure-openai---reliability",
            "service": "Azure OpenAI",
            "services": [
                "WAF",
                "ACR"
            ],
            "severity": "Low",
            "text": "Deploy multiple OAI instances across regions",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "b039da6d-55d7-4c89-8adb-107d5325af62",
            "link": "https://learn.microsoft.com/azure/architecture/ai-ml/architecture/baseline-openai-e2e-chat#azure-openai---reliability",
            "service": "Azure OpenAI",
            "services": [
                "WAF",
                "Entra",
                "APIM"
            ],
            "severity": "High",
            "text": "Implement retry & healthchecks with Gateway pattern like APIM",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "5ca44e46-85e2-4223-ace8-bb12308ca5f1",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/quota?tabs=rest#introduction-to-quota",
            "service": "Azure OpenAI",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Ensure having adequate quotas of TPM & RPM for the workload",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "ec723923-7a15-42d6-ac5e-402925387e5c",
            "link": "https://www.microsoft.com/research/project/guidelines-for-human-ai-interaction/",
            "service": "Azure OpenAI",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Review the considerations in HAI toolkit guidance and apply those interaction practices for the slution",
            "waf": "Operational Excellence"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "7f154e3a-a369-4282-ae7e-316183687a04",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/business-continuity-disaster-recovery",
            "service": "Azure OpenAI",
            "services": [
                "WAF",
                "ACR"
            ],
            "severity": "Medium",
            "text": "Deploy separate fine tuned models across regions if finetuning is employed",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "77a1f893-5bda-4433-84f2-4811633182ba",
            "link": "https://learn.microsoft.com/azure/backup/backup-overview",
            "service": "Azure OpenAI",
            "services": [
                "WAF",
                "ASR",
                "Backup"
            ],
            "severity": "Medium",
            "text": "Regularly backup and replicate critical data to ensure data availability and recoverability in case of data loss or system failures. Leverage Azure's backup and disaster recovery services to protect your data.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "95b96ad8-844c-4e3b-8b38-b876ba2cf204",
            "link": "https://www.microsoft.com/licensing/docs/view/Service-Level-Agreements-SLA-for-Online-Services?lang=1",
            "service": "Azure OpenAI",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Azure AI search service tiers should be choosen to have a SLA ",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "99013a5d-3ce4-474d-acbd-8682a6abca2a",
            "link": "https://learn.microsoft.com/purview/purview",
            "service": "Azure OpenAI",
            "services": [
                "WAF"
            ],
            "severity": "Low",
            "text": "Classify data and sensitivity, labeling with Microsoft Purview before generating the embeddings and make sure to treat the embeddings generated with same sensitivity and classification",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "4fda1dbf-3dd9-45d4-ac7c-891dca1f6d56",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/use-your-data-securely",
            "service": "Azure OpenAI",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Encrypt data used for RAG with SSE/Disk encryption with optional BYOK",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "59ae558b-937d-4498-9e11-12dbd7ba012f",
            "link": "https://learn.microsoft.com/azure/search/search-security-overview",
            "service": "Azure OpenAI",
            "services": [
                "WAF",
                "ACR"
            ],
            "severity": "High",
            "text": "Ensure TLS is enforced for data in transit across data sources, AI search used for Retrieval-Augmented Generation (RAG) and LLM communication",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "7b94ef6e-047d-42ea-8992-b1cd6e2054b2",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/role-based-access-control",
            "service": "Azure OpenAI",
            "services": [
                "WAF",
                "RBAC"
            ],
            "severity": "High",
            "text": "Use RBAC to manage access to Azure OpenAI services. Assign appropriate permissions to users and restrict access based on their roles and responsibilities",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "9769e4a6-91e8-4838-ac93-6667e13c0056",
            "link": "https://learn.microsoft.com/azure/security/fundamentals/data-encryption-best-practices",
            "service": "Azure OpenAI",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Implement data encryption,  masking or redaction techniques to hide sensitive data or replace it with obfuscated values in non-production environments or when sharing data for testing or troubleshooting purposes",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "74b1e945-b459-4837-be7a-d6c6d3b375a5",
            "link": "https://learn.microsoft.com/azure/defender-for-cloud/defender-for-cloud-introduction",
            "service": "Azure OpenAI",
            "services": [
                "WAF",
                "Sentinel",
                "Monitor",
                "Defender"
            ],
            "severity": "High",
            "text": "Utilize Azure Defender to detect and respond to security threats and set up monitoring and alerting mechanisms to identify suspicious activities or breaches. Leverage Azure Sentinel for advanced threat detection and response",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "c7acbe48-abe5-44cd-99f2-e87768468c55",
            "link": "https://techcommunity.microsoft.com/t5/azure-storage-blog/managing-long-term-log-retention-or-any-business-data/ba-p/2494791",
            "service": "Azure OpenAI",
            "services": [
                "WAF",
                "AzurePolicy"
            ],
            "severity": "Medium",
            "text": "Establish data retention and disposal policies to adhere to compliance regulations. Implement secure deletion methods for data that is no longer required and maintain an audit trail of data retention and disposal activities",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "a9c27d9c-42bb-46bd-8c69-99a246f3389a",
            "link": "https://learn.microsoft.com/azure/ai-services/content-safety/concepts/jailbreak-detection",
            "service": "Azure OpenAI",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Implement Prompt shields and groundedness detection using Content Safety ",
            "waf": "Operational Excellence"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "a775c6ee-95b9-46ad-a844-ce3b2b38b876",
            "link": "https://learn.microsoft.com/azure/compliance/",
            "service": "Azure OpenAI",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Ensure compliance with relevant data protection regulations, such as GDPR or HIPAA, by implementing privacy controls and obtaining necessary consents or permissions for data processing activities.",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "ba2cf204-9901-43a5-b3ce-474dccbd8682",
            "service": "Azure OpenAI",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Educate your employees about data security best practices, the importance of handling data securely, and potential risks associated with data breaches. Encourage them to follow data security protocols diligently.",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "eae01e6e-842e-452f-9721-d928c1b1cd52",
            "service": "Azure OpenAI",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Keep production data separate from development and testing data. Only use real sensitive data in production and utilize anonymized or synthetic data in development and test environments.",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "1e54a29a-9de3-499c-bd7b-28dc93555620",
            "service": "Azure OpenAI",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "If you have varying levels of data sensitivity, consider creating separate indexes for each level. For instance, you could have one index for general data and another for sensitive data, each governed by different access protocols",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "2bfe4564-b0d8-434a-948b-263e6dd60512",
            "service": "Azure OpenAI",
            "services": [
                "WAF",
                "RBAC",
                "AzurePolicy"
            ],
            "severity": "Medium",
            "text": "Take segregation a step further by placing sensitive datasets in different instances of the service. Each instance can be controlled with its own specific set of RBAC policies",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "a36498f6-dbad-438e-ad53-cc7ce1d7aaab",
            "service": "Azure OpenAI",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Recognize that embeddings and vectors generated from sensitive information are themselves sensitive. This data should be afforded the same protective measures as the source material",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "3571449a-b805-43d8-af89-dc7b33be2a1a",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/role-based-access-control",
            "service": "Azure OpenAI",
            "services": [
                "WAF",
                "RBAC"
            ],
            "severity": "High",
            "text": "Apply RBAC to th data stores having embeddings and vectors and scope access based on role's access requirements",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "27f7b9e9-1be1-4f38-aef3-9812bd463cbb",
            "link": "https://techcommunity.microsoft.com/t5/azure-architecture-blog/azure-openai-private-endpoints-connecting-across-vnet-s/ba-p/3913325",
            "service": "Azure OpenAI",
            "services": [
                "WAF",
                "PrivateLink"
            ],
            "severity": "High",
            "text": "Configure private endpoint for AI services to restrict service access within your network",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "ac8ac199-ebb9-41a3-9d90-cae2cc881370",
            "service": "Azure OpenAI",
            "services": [
                "WAF",
                "VNet",
                "Firewall"
            ],
            "severity": "High",
            "text": "Enforce strict inbound and outbound traffic control with Azure Firewall and UDRs and limit the external integration points",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "6f7c0cba-fe51-4464-add4-57e927138b82",
            "service": "Azure OpenAI",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Implement network segmentation and access controls to restrict access to the LLM application only to authorized users and systems and prevent lateral movement",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "7f42c78e-78cb-46a2-8ad1-90916e6a8d8f",
            "link": "https://www.microsoft.com/research/blog/llmlingua-innovating-llm-efficiency-with-prompt-compression/",
            "service": "Azure OpenAI",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Use prompt compression tools like LLMLingua or gprtrim",
            "waf": "Cost Optimization"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "1102cac6-eae0-41e6-b842-e52f4721d928",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/managed-identity",
            "service": "Azure OpenAI",
            "services": [
                "WAF",
                "AKV",
                "Entra"
            ],
            "severity": "High",
            "text": "Ensure that APIs and endpoints used by the LLM application are properly secured with authentication and authorization mechanisms, such as Managed identities,  API keys or OAuth, to prevent unauthorized access.",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "c1b1cd52-1e54-4a29-a9de-399cfd7b28dc",
            "link": "https://techcommunity.microsoft.com/t5/azure-architecture-blog/security-best-practices-for-genai-applications-openai-in-azure/ba-p/4027885",
            "service": "Azure OpenAI",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Enforce strong end user authentication mechanisms, such as multi-factor authentication, to prevent unauthorized access to the LLM application and associated network resources",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "93555620-2bfe-4456-9b0d-834a348b263e",
            "service": "Azure OpenAI",
            "services": [
                "WAF",
                "Monitor"
            ],
            "severity": "Medium",
            "text": "Implement network monitoring tools to detect and analyze network traffic for any suspicious or malicious activities. Enable logging to capture network events and facilitate forensic analysis in case of security incidents",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "6dd60512-a364-498f-9dba-d38ead53cc7c",
            "service": "Azure OpenAI",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Conduct security audits and penetration testing to identify and address any network security weaknesses or vulnerabilities in the LLM application's network infrastructure",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "e1d7aaab-3571-4449-ab80-53d89f89dc7b",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/tag-resources?tabs=json",
            "service": "Azure OpenAI",
            "services": [
                "WAF"
            ],
            "severity": "Low",
            "text": "Azure AI Services are properly tagged for better management",
            "waf": "Operational Excellence"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "77036e5e-6b4b-4ed3-b503-547c1347dc56",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/resource-abbreviations",
            "service": "Azure OpenAI",
            "services": [
                "WAF"
            ],
            "severity": "Low",
            "text": "Azure AI Service accounts follows organizational naming conventions",
            "waf": "Operational Excellence"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "028a71ff-e1ce-415d-b3f0-d5e772d41e36",
            "link": "https://learn.microsoft.com/azure/ai-services/diagnostic-logging",
            "service": "Azure OpenAI",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Diagnostic logs in Azure AI services resources should be enabled",
            "waf": "Operational Excellence"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "11cc57b4-a4b1-4410-b439-58a8c2289b3d",
            "link": "https://learn.microsoft.com/azure/ai-services/authentication",
            "service": "Azure OpenAI",
            "services": [
                "WAF",
                "Entra"
            ],
            "severity": "High",
            "text": "Key access (local authentication) is recommended to be disabled for security.  After disabling key based access, Microsoft Entra ID becomes the only access method, which allows maintaining minimum privilege principle and granular control. ",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "6b57cfc6-5546-41e1-a3e3-453a3c863964",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Azure OpenAI",
            "services": [
                "WAF",
                "AKV",
                "Entra"
            ],
            "severity": "High",
            "text": "Store and manage keys securely using Azure Key Vault. Avoid hard-coding or embedding sensitive keys within your LLM application's code and retrieve them securely from Azure Key Vault using managed identities",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "8b652d6c-15f5-4129-9539-8e6ded227dd1",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Azure OpenAI",
            "services": [
                "WAF",
                "AKV"
            ],
            "severity": "High",
            "text": "Regularly rotate and expire keys stored in Azure Key Vault to minimize the risk of unauthorized access.",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "adfe27be-e297-401a-a352-baaab79b088d",
            "link": "https://github.com/openai/tiktoken",
            "service": "Azure OpenAI",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Use tiktoken to understand token sizes for token optimizations in conversational mode",
            "waf": "Cost Optimization"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "42b06c21-d799-49a6-96f4-389a7f42c78e",
            "link": "https://learn.microsoft.com/azure/security/develop/secure-dev-overview",
            "service": "Azure OpenAI",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Follow secure coding practices to prevent common vulnerabilities such as injection attacks, cross-site scripting (XSS), or security misconfigurations",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "78c06a73-a22a-4495-9e6a-8dc4a20e27c3",
            "link": "https://learn.microsoft.com/azure/devops/repos/security/github-advanced-security-dependency-scanning?view=azure-devops",
            "service": "Azure OpenAI",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Setup a process to regularly update and patch the LLM libraries and other system components",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "e29711b1-352b-4eee-879b-588defc4972c",
            "link": "https://learn.microsoft.com/legal/cognitive-services/openai/code-of-conduct",
            "service": "Azure OpenAI",
            "services": [
                "WAF",
                "AzurePolicy"
            ],
            "severity": "High",
            "text": "Adhere to Azure OpenAI or other LLMs terms of use, policies and guidance and allowed use cases",
            "waf": "Operational Excellence"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "d3cd21bf-7703-46e5-b6b4-bed3d503547c",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/manage-costs#base-series-and-codex-series-fine-tuned-models",
            "service": "Azure OpenAI",
            "services": [
                "WAF",
                "Cost"
            ],
            "severity": "Medium",
            "text": "Understand difference in cost of base models and fine tuned models and token step sizes",
            "waf": "Cost Optimization"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "1347dc56-028a-471f-be1c-e15dd3f0d5e7",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/latency#batching",
            "service": "Azure OpenAI",
            "services": [
                "WAF",
                "Cost"
            ],
            "severity": "High",
            "text": "Batch requests, where possible, to minimize the per-call overhead which can reduce overall costs. Ensure you optimize batch size",
            "waf": "Cost Optimization"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "72d41e36-11cc-457b-9a4b-1410d43958a8",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/manage-costs",
            "service": "Azure OpenAI",
            "services": [
                "WAF",
                "Monitor",
                "Cost"
            ],
            "severity": "Medium",
            "text": "Set up a cost tracking system that monitors model usage and use that information to help inform model choices and prompt sizes",
            "waf": "Cost Optimization"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "166cd072-af9b-4141-a898-a535e737897e",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/quota?tabs=rest#understanding-rate-limits",
            "service": "Azure OpenAI",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Set a maximum limit on the number of tokens per model response (max_tokens and the number of completions to generate). Optimize the size to ensure it is large enough for a valid response",
            "waf": "Cost Optimization"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "71ca7da8-cfa9-462a-8594-946da97dc3a2",
            "link": "https://learn.microsoft.com/azure/search/search-reliability",
            "service": "Azure OpenAI",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Review the guidance provided on setting up AI search for Reliability",
            "waf": "Operational Excellence"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "3266b225-86f4-4a16-92bd-ddea8a487cde",
            "link": "https://learn.microsoft.com/azure/search/vector-search-index-size?tabs=portal-vector-quota",
            "service": "Azure OpenAI",
            "services": [
                "WAF",
                "Storage"
            ],
            "severity": "Medium",
            "text": "Plan and manage AI Search Vector storage",
            "waf": "Operational Excellence"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "b4861bc3-bc14-4aeb-9e66-e8d9a3aec218",
            "link": "https://learn.microsoft.com/azure/machine-learning/prompt-flow/how-to-end-to-end-llmops-with-prompt-flow?view=azureml-api-2",
            "service": "Azure OpenAI",
            "services": [
                "WAF",
                "ACR"
            ],
            "severity": "Medium",
            "text": "Ensure deployment of Azure OpenAI instances across your various environments, such as development, test, and production supporting lrarning & experimentation. Apply LLMOps practices to automate the lifecycle management of your GenAI applications",
            "waf": "Operational Excellence"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "aa80932c-8ec9-4d1b-a770-26e5e6beba9e",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/provisioned-throughput-onboarding#understanding-the-provisioned-throughput-purchase-model",
            "service": "Azure OpenAI",
            "services": [
                "WAF",
                "Storage"
            ],
            "severity": "High",
            "text": "Evaluate usage of billing models - PAYG vs PTU. Start with PAYG and consider PTU when the usage is predictable in production since it offers dedicated memory and compute, reserved capacity, and consistent maximum latency for the specified model version",
            "waf": "Cost Optimization"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "e6436b07-36db-455f-9796-03334bdf9cc2",
            "link": "https://techcommunity.microsoft.com/t5/ai-azure-ai-services-blog/how-to-control-azure-openai-models/ba-p/4146793",
            "service": "Azure OpenAI",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Evaluate the quality of  prompts and applications when switching between model versions",
            "waf": "Operational Excellence"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "3418db61-2712-4650-9bb4-7a393a080327",
            "link": "https://learn.microsoft.com/azure/machine-learning/prompt-flow/concept-model-monitoring-generative-ai-evaluation-metrics?view=azureml-api-2",
            "service": "Azure OpenAI",
            "services": [
                "WAF",
                "Monitor"
            ],
            "severity": "Medium",
            "text": "Evaluate, monitor and refine your GenAI apps for features like groundedness, relevance, accuracy, coherence and fluency",
            "waf": "Operational Excellence"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "294798b1-578b-4219-a46c-eb5443513592",
            "service": "Azure OpenAI",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Evaluate your Azure AI Search results based on different search parameters",
            "waf": "Operational Excellence"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "2744293b-b628-4537-a551-19b08e8f5854",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/concepts/fine-tuning-considerations",
            "service": "Azure OpenAI",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Look at fine tuning models as way of increasing accuracy only when you have tried other basic approaches like prompt engineering and RAG with your data",
            "waf": "Operational Excellence"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "287d9cec-166c-4d07-8af9-b141a898a535",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/concepts/advanced-prompt-engineering?pivots=programming-language-chat-completions",
            "service": "Azure OpenAI",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Use prompt engineering techniques to improve the accuracy of LLM responses",
            "waf": "Operational Excellence"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "e737897e-71ca-47da-acfa-962a1594946d",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/concepts/red-teaming",
            "service": "Azure OpenAI",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Red team your GenAI applications",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "edb117e6-76aa-4f66-aca4-8e5a95f2223e",
            "link": "https://www.microsoft.com/haxtoolkit/guideline/encourage-granular-feedback/",
            "service": "Azure OpenAI",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Provide end users with scoring options for LLM responses and track these scores. ",
            "waf": "Operational Excellence"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "d5f3547c-c346-4d81-9028-a71ffe1b9b5d",
            "link": "https://techcommunity.microsoft.com/t5/fasttrack-for-azure/optimizing-azure-openai-a-guide-to-limits-quotas-and-best/ba-p/4076268",
            "service": "Azure OpenAI",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Consider Quota management practices. Use dynamic quota for certain use cases when your application can use extra capacity opportunistically or the application itself is driving the rate at which the Azure OpenAI API is called",
            "waf": "Cost Optimization"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "9de0d5d7-31d4-41e3-911c-817bfafbc410",
            "link": "https://github.com/Azure/aoai-apim/blob/main/README.md",
            "service": "Azure OpenAI",
            "services": [
                "WAF",
                "Entra",
                "ACR",
                "LoadBalancer",
                "APIM"
            ],
            "severity": "Medium",
            "text": "Use Load balancer solutions like APIM based gateway for balancing load and capacity across services and regions",
            "waf": "Operational Excellence"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "9de0d5d7-31d4-41e3-911c-817bfafbc411",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/fine-tuning?tabs=turbo%2Cpython-new&pivots=programming-language-studio#import-training-data-from-azure-blob-store",
            "service": "Azure OpenAI",
            "services": [
                "WAF",
                "Storage"
            ],
            "severity": "Medium",
            "text": "Follow the guidance for fine-tuning with large data files and import the data from an Azure blob store. Large files, 100 MB or larger, can become unstable when uploaded through multipart forms because the requests are atomic and can't be retried or resumed",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "9de0d5d7-31d4-41e3-911c-817bfafbc412",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/quota?tabs=rest",
            "service": "Azure OpenAI",
            "services": [
                "WAF",
                "Monitor"
            ],
            "severity": "Medium",
            "text": "Manage rate limits for your model deployments and monitor usage of tokens per minute (TPM) and requests per minute (RPM) for pay-as-you-go deployments",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "9de0d5d7-31d4-41e3-911c-817bfafbc413",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/monitor-openai",
            "service": "Azure OpenAI",
            "services": [
                "WAF",
                "Monitor"
            ],
            "severity": "Medium",
            "text": "Monitor provision-managed utilization if you're using the provisioned throughput payment model",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "9de0d5d7-31d4-41e3-911c-817bfafbc414",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/content-filters",
            "service": "Azure OpenAI",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Tune content filters to minimize false positives from overly aggressive filters",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "9de0d5d7-31d4-41e3-911c-817bfafbc415",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/encrypt-data-at-rest",
            "service": "Azure OpenAI",
            "services": [
                "WAF",
                "AKV"
            ],
            "severity": "Medium",
            "text": "Use customer-managed keys for fine-tuned models and training data that's uploaded to Azure OpenAI",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "9de0d5d7-31d4-41e3-911c-817bfafbc416",
            "link": "https://learn.microsoft.com/azure/ai-services/content-safety/concepts/jailbreak-detection",
            "service": "Azure OpenAI",
            "services": [
                "WAF",
                "LoadBalancer"
            ],
            "severity": "Medium",
            "text": "Implement jailbreak risk detection to safeguard your language model deployments against prompt injection attacks",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "9de0d5d7-31d4-41e3-911c-817bfafbc417",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/monitor-openai",
            "service": "Azure OpenAI",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Use security controls like throttling, service isolation and gateway pattern to prevent attacks that might exhaust model usage quotas",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "72d41e36-11cc-457b-9a4b-1410d43958a9",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/manage-costs",
            "service": "Azure OpenAI",
            "services": [
                "WAF",
                "Cost"
            ],
            "severity": "Medium",
            "text": "Develop your cost model, considering prompt sizes. Understanding prompt input and response sizes and how text translates into tokens helps you create a viable cost model",
            "waf": "Cost Optimization"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "72d41e36-11cc-457b-9a4b-1410d43958a1",
            "link": "https://azure.microsoft.com/pricing/details/cognitive-services/openai-service/",
            "service": "Azure OpenAI",
            "services": [
                "WAF",
                "Cost"
            ],
            "severity": "Medium",
            "text": "Consider model pricing and capabilities when you choose models. Start with less-costly models for less-complex tasks like text generation or completion tasks and for complex tasks like language translation or content understanding, consider using more advanced models. Optimize costs while still achieving the desired application performance",
            "waf": "Cost Optimization"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "72d41e36-11cc-457b-9a4b-1410d43958a2",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/manage-costs",
            "service": "Azure OpenAI",
            "services": [
                "WAF",
                "Cost"
            ],
            "severity": "Medium",
            "text": "Maximize Azure OpenAI price breakpoints like fine-tuning and model breakpoints like image generation to your advantage. Fine-tuning is charged per hour, use as much time as you have available per hour to improve results without slipping into the next billing period. The cost for generating 100 images is the same as the cost for 1 image",
            "waf": "Cost Optimization"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "72d41e36-11cc-457b-9a4b-1410d43958a3",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/manage-costs",
            "service": "Azure OpenAI",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Remove unused fine-tuned models when they're no longer being consumed to avoid incurring an ongoing hosting fee",
            "waf": "Cost Optimization"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "7f42c78e-78cb-46a2-8ad1-90916e6a8d8g",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/manage-costs",
            "service": "Azure OpenAI",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Create concise prompts that provide enough context for the model to generate a useful response. Also ensure that you optimize the limit of the response length.",
            "waf": "Cost Optimization"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "b4861bc3-bc14-4aeb-9e66-e8d9a3aec219",
            "link": "https://learn.microsoft.com/azure/ai-services/create-account-bicep",
            "service": "Azure OpenAI",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Use infrastructure as code (IaC) to deploy Azure OpenAI, model deployments, and other infrastructure required for fine-tuning models",
            "waf": "Operational Excellence"
        },
        {
            "arm-service": "Microsoft.CognitiveServices/accounts",
            "checklist": "WAF checklist",
            "guid": "2744293b-b628-4537-a551-19b08e8f5855",
            "link": "https://learn.microsoft.com/azure/architecture/guide/multitenant/service/openai",
            "service": "Azure OpenAI",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Consider using dedicated model deployments per consumer group to provide per-model usage isolation that can help prevent noisy neighbors between your consumer groups",
            "waf": "Operational Excellence"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "WAF checklist",
            "guid": "d7941d4a-7b6f-458f-8714-2f8f8c059ad4",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-error-handling-policies",
            "service": "APIM",
            "services": [
                "WAF",
                "AzurePolicy"
            ],
            "severity": "Medium",
            "text": "Implement an error handling policy at the global level",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "WAF checklist",
            "guid": "0b0c0765-ff37-4369-90bd-3eb23ce71b08",
            "link": "https://learn.microsoft.com/azure/api-management/set-edit-policies?tabs=form#use-base-element-to-set-policy-evaluation-order",
            "service": "APIM",
            "services": [
                "WAF",
                "AzurePolicy"
            ],
            "severity": "Medium",
            "text": "Ensure all APIs policies include a <base/> element.",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "WAF checklist",
            "guid": "a5c45b03-93b6-42fe-b16b-8fccb6a79902",
            "link": "https://learn.microsoft.com/azure/api-management/policy-fragments",
            "service": "APIM",
            "services": [
                "WAF",
                "AzurePolicy",
                "ACR"
            ],
            "severity": "Medium",
            "text": "Use Policy Fragments to avoid repeating same policies definitions across multiple APIs",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "WAF checklist",
            "guid": "c3818a95-6ff3-4474-88dc-e809b46dad6a",
            "link": "https://learn.microsoft.com/azure/api-management/monetization-support",
            "service": "APIM",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "If you are planning to monetize your APIs, review the 'monetization support' article for best practices",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "WAF checklist",
            "guid": "a7d0840a-c8c4-4e83-adec-5ca578eb4049",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-use-azure-monitor#resource-logs",
            "service": "APIM",
            "services": [
                "WAF",
                "Monitor"
            ],
            "severity": "High",
            "text": "Enable Diagnostics Settings to export logs to Azure Monitor",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "WAF checklist",
            "guid": "8691fa38-45ed-4299-a247-fecd98d35deb",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-app-insights",
            "service": "APIM",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Enable Application Insights for more detailed telemetry",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "WAF checklist",
            "guid": "55fd27bb-76ac-4a91-bc37-049e885be6b7",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-use-azure-monitor",
            "service": "APIM",
            "services": [
                "WAF",
                "Monitor"
            ],
            "severity": "High",
            "text": "Configure alerts on the most critical metrics",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "WAF checklist",
            "guid": "39460bdb-156f-4dc2-a87f-1e8c11ab0998",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/api-management-security-baseline?toc=%2Fazure%2Fapi-management%2F&bc=%2Fazure%2Fapi-management%2Fbreadcrumb%2Ftoc.json#certificate-management-in-azure-key-vault",
            "service": "APIM",
            "services": [
                "WAF",
                "AKV"
            ],
            "severity": "High",
            "text": "Ensure that custom SSL certificates are stored an Azure Key Vault so they can be securely accessed and updated",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "WAF checklist",
            "guid": "e9217997-5f6c-479d-8576-8f2adf706ec8",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/api-management-security-baseline?toc=%2Fazure%2Fapi-management%2F&bc=%2Fazure%2Fapi-management%2Fbreadcrumb%2Ftoc.json#azure-ad-authentication-required-for-data-plane-access",
            "service": "APIM",
            "services": [
                "WAF",
                "Entra"
            ],
            "severity": "High",
            "text": "Protect incoming requests to APIs (data plane) with Azure AD",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "WAF checklist",
            "guid": "5e5f64ba-c90e-480e-8888-398d96cf0bfb",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-aad",
            "service": "APIM",
            "services": [
                "WAF",
                "Entra"
            ],
            "severity": "Medium",
            "text": "Use Microsoft Entra ID to authenticate users in the Developer Portal",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "WAF checklist",
            "guid": "f8e574ce-280f-49c8-b2ef-68279b081cf3",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-create-groups",
            "service": "APIM",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Create appropriate groups to control the visibility of the products",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "WAF checklist",
            "guid": "06862505-2d9a-4874-9491-2837b00a3475",
            "link": "https://learn.microsoft.com/azure/api-management/backends",
            "service": "APIM",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Use Backends feature to eliminate redundant API backend configurations",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "WAF checklist",
            "guid": "03b125d5-b69b-4739-b7fd-84b86da4933e",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-properties?tabs=azure-portal",
            "service": "APIM",
            "services": [
                "WAF",
                "AzurePolicy"
            ],
            "severity": "Medium",
            "text": "Use Named Values to store common values that can be used in policies",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "WAF checklist",
            "guid": "beae759e-4ddb-4326-bf26-47f87d3454b6",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-deploy-multi-region",
            "service": "APIM",
            "services": [
                "WAF",
                "ACR"
            ],
            "severity": "Medium",
            "text": "For DR, leverage the premium tier with deployments scaled across two or more regions for 99.99% SLA",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "WAF checklist",
            "guid": "9c8d1664-dd9a-49d4-bd83-950af0af4044",
            "link": "https://learn.microsoft.com/azure/api-management/high-availability",
            "service": "APIM",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Deploy at least one unit in two or more availability zones for an increased SLA of 99.99%",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "WAF checklist",
            "guid": "8d2db6e8-85c6-4118-a52c-ae76a4f27934",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/api-management-security-baseline?toc=%2Fazure%2Fapi-management%2F&bc=%2Fazure%2Fapi-management%2Fbreadcrumb%2Ftoc.json#service-native-backup-capability",
            "service": "APIM",
            "services": [
                "WAF",
                "Backup"
            ],
            "severity": "High",
            "text": "Ensure there is an automated backup routine",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "WAF checklist",
            "guid": "43e60b94-7bca-43a2-aadf-efb04d63a485",
            "link": "https://learn.microsoft.com/azure/api-management/retry-policy",
            "service": "APIM",
            "services": [
                "WAF",
                "AzurePolicy"
            ],
            "severity": "Medium",
            "text": "Use Policies to add a fail-over backend URL and caching to reduce failing calls.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "WAF checklist",
            "guid": "8210699f-8d43-45c2-8f19-57e54134bd8f",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-log-event-hubs",
            "service": "APIM",
            "services": [
                "WAF",
                "AzurePolicy",
                "EventHubs"
            ],
            "severity": "Low",
            "text": "If you need to log at high performance levels, consider Event Hubs policy",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "WAF checklist",
            "guid": "121bfc39-fa7b-4096-b93b-ab56c1bc0bed",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-sample-flexible-throttling",
            "service": "APIM",
            "services": [
                "WAF",
                "AzurePolicy"
            ],
            "severity": "Medium",
            "text": "Apply throttling policies to control the number of requests per second",
            "training": "https://learn.microsoft.com/training/modules/protect-apis-on-api-management/",
            "waf": "Performance"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "WAF checklist",
            "guid": "bb5f356b-3daf-47a2-a9ee-867a8100bbd5",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-autoscale",
            "service": "APIM",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Configure autoscaling to scale out the number of instances when the load increases",
            "waf": "Performance"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "WAF checklist",
            "guid": "84b94abb-59b6-4b9d-8587-3413669468e8",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-provision-self-hosted-gateway",
            "service": "APIM",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Deploy self-hosted gateways where Azure doesn't have a region close to the backend APIs.",
            "waf": "Performance"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "WAF checklist",
            "guid": "1fe8db45-a017-4888-8c4d-4422583cfae0",
            "link": "https://learn.microsoft.com/azure/api-management/upgrade-and-scale#upgrade-and-scale",
            "service": "APIM",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Use the premium tier for production workloads.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "WAF checklist",
            "guid": "1b8d68a4-66cd-44d5-ba94-3ee94440e8d6",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-deploy-multi-region#-route-api-calls-to-regional-backend-services",
            "service": "APIM",
            "services": [
                "WAF",
                "AzurePolicy"
            ],
            "severity": "Medium",
            "text": "In multi-region model, use Policies to route the requests to regional backends based on availability or latency.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "WAF checklist",
            "guid": "46f07d33-ef9a-44e8-8f98-67c097c5d8cd",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits#api-management-limits",
            "service": "APIM",
            "services": [
                "WAF",
                "Entra",
                "APIM"
            ],
            "severity": "High",
            "text": "Be aware of APIM's limits",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "WAF checklist",
            "guid": "10f58602-f0f9-4d77-972a-956f6e0f2600",
            "link": "https://learn.microsoft.com/en-us/azure/api-management/self-hosted-gateway-overview",
            "service": "APIM",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Ensure that the self-hosted gateway deployments are resilient.",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "WAF checklist",
            "guid": "7519e385-a88b-4d34-966b-6269d686e890",
            "link": "https://learn.microsoft.com/azure/api-management/front-door-api-management",
            "service": "APIM",
            "services": [
                "WAF",
                "Entra",
                "FrontDoor",
                "APIM"
            ],
            "severity": "Medium",
            "text": "Use Azure Front Door in front of APIM for multi-region deployment",
            "waf": "Performance"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "WAF checklist",
            "guid": "cd45c90e-7690-4753-930b-bf290c69c074",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/api-management-security-baseline?toc=%2Fazure%2Fapi-management%2F&bc=%2Fazure%2Fapi-management%2Fbreadcrumb%2Ftoc.json#virtual-network-integration",
            "service": "APIM",
            "services": [
                "WAF",
                "VNet"
            ],
            "severity": "Medium",
            "text": "Deploy the service within a Virtual Network (VNet)",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "WAF checklist",
            "guid": "02661582-b3d1-48d1-9d7b-c6a918a0ca33",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/api-management-security-baseline?toc=%2Fazure%2Fapi-management%2F&bc=%2Fazure%2Fapi-management%2Fbreadcrumb%2Ftoc.json#network-security-group-support",
            "service": "APIM",
            "services": [
                "WAF",
                "VNet",
                "Entra",
                "Monitor",
                "APIM"
            ],
            "severity": "Medium",
            "text": "Deploy network security groups (NSG) to your subnets to restrict or monitor traffic to/from APIM.",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "WAF checklist",
            "guid": "67437a28-2721-4a2c-becd-caa54c8237a5",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/api-management-security-baseline?toc=%2Fazure%2Fapi-management%2F&bc=%2Fazure%2Fapi-management%2Fbreadcrumb%2Ftoc.json#azure-private-link",
            "service": "APIM",
            "services": [
                "WAF",
                "PrivateLink",
                "VNet",
                "Entra",
                "APIM"
            ],
            "severity": "Medium",
            "text": "Deploy Private Endpoints to filter incoming traffic when APIM is not deployed to a VNet.",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "WAF checklist",
            "guid": "d698adbd-3288-44cb-b10a-9b572da395ae",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/api-management-security-baseline?toc=%2Fazure%2Fapi-management%2F&bc=%2Fazure%2Fapi-management%2Fbreadcrumb%2Ftoc.json#disable-public-network-access",
            "service": "APIM",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Disable Public Network Access",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "WAF checklist",
            "guid": "0674d750-0c6f-4ac0-8717-ceec04d0bdbd",
            "link": "https://learn.microsoft.com/azure/api-management/automation-manage-api-management",
            "service": "APIM",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Simplify management with PowerShell automation scripts",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "WAF checklist",
            "guid": "c385bfcd-49fd-4786-81ba-cedbb4c57345",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/app-platform/api-management/platform-automation-and-devops#design-recommendations",
            "service": "APIM",
            "services": [
                "WAF",
                "Entra",
                "APIM"
            ],
            "severity": "Medium",
            "text": "Configure APIM via Infrastructure-as-code. Review DevOps best practices from the Cloud Adaption Framework APIM Landing Zone Accelerator",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "WAF checklist",
            "guid": "6c3a27c0-197f-426c-9ffa-86fed51d9ab6",
            "link": "https://learn.microsoft.com/azure/api-management/visual-studio-code-tutorial",
            "service": "APIM",
            "services": [
                "WAF",
                "Entra",
                "APIM"
            ],
            "severity": "Medium",
            "text": "Promote usage of Visual Studio Code APIM extension for faster API development",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "WAF checklist",
            "guid": "354f1c03-8112-4965-85ad-c0074bddf231",
            "link": "https://learn.microsoft.com/azure/api-management/devops-api-development-templates",
            "service": "APIM",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Implement DevOps and CI/CD in your workflow",
            "waf": "Operations"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "WAF checklist",
            "guid": "b6439493-426a-45f3-9697-cf65baee208d",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-mutual-certificates-for-clients",
            "service": "APIM",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Secure APIs using client certificate authentication",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "WAF checklist",
            "guid": "2a67d143-1033-4c0a-8732-680896478f08",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-mutual-certificates",
            "service": "APIM",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Secure backend services using client certificate authentication",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "WAF checklist",
            "guid": "074435f5-4a46-41ac-b521-d6114cb5d845",
            "link": "https://learn.microsoft.com/azure/api-management/mitigate-owasp-api-threats",
            "service": "APIM",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Review 'Recommendations to mitigate OWASP API Security Top 10 threats' article and check what is applicable to your APIs",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "WAF checklist",
            "guid": "5507c4b8-a7f8-41d6-9661-418c987100c9",
            "link": "https://learn.microsoft.com/azure/api-management/authorizations-overview",
            "service": "APIM",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Use Authorizations feature to simplify management of OAuth 2.0 token for your backend APIs",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "WAF checklist",
            "guid": "2deee033-b906-4bc2-9f26-c8d3699fe091",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-manage-protocols-ciphers",
            "service": "APIM",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Use the latest TLS version when encrypting information in transit. Disable outdated and unnecessary protocols and ciphers when possible.",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "WAF checklist",
            "guid": "f8af3d94-1d2b-4070-846f-849197524258",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/api-management-security-baseline?toc=%2Fazure%2Fapi-management%2F&bc=%2Fazure%2Fapi-management%2Fbreadcrumb%2Ftoc.json#im-8-restrict-the-exposure-of-credential-and-secrets",
            "service": "APIM",
            "services": [
                "WAF",
                "AKV"
            ],
            "severity": "High",
            "text": "Ensure that secrets (Named values) are stored an Azure Key Vault so they can be securely accessed and updated",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "WAF checklist",
            "guid": "791abd8b-7706-4e31-9569-afefde724be3",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/api-management-security-baseline?toc=%2Fazure%2Fapi-management%2F&bc=%2Fazure%2Fapi-management%2Fbreadcrumb%2Ftoc.json#managed-identities",
            "service": "APIM",
            "services": [
                "WAF",
                "Entra"
            ],
            "severity": "Medium",
            "text": "Use managed identities to authenticate to other Azure resources whenever possible",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.ApiManagement/service",
            "checklist": "WAF checklist",
            "guid": "220c4ca6-6688-476b-b2b5-425a78e6fb87",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/api-management-security-baseline?toc=%2Fazure%2Fapi-management%2F&bc=%2Fazure%2Fapi-management%2Fbreadcrumb%2Ftoc.json#ns-6-deploy-web-application-firewall",
            "service": "APIM",
            "services": [
                "WAF",
                "Entra",
                "AppGW",
                "APIM"
            ],
            "severity": "High",
            "text": "Use web application firewall (WAF) by deploying Application Gateway in front of APIM",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "WAF checklist",
            "graph": "cdnresources | where type =~ 'microsoft.Cdn/profiles/secrets' | extend frontDoorId = substring(id, 0, indexof(id, '/secrets')) | where properties.parameters.type =~ 'CustomerCertificate' | extend compliant = properties.parameters.useLatestVersion == true | project compliant, id=frontDoorId, certificateName = name | distinct id, certificateName, compliant",
            "guid": "f00a69de-7076-4734-a734-6e4552cad9e1",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-latest-version-for-customer-managed-certificates",
            "service": "Front Door",
            "services": [
                "WAF",
                "AKV",
                "FrontDoor"
            ],
            "severity": "Medium",
            "text": "If you use customer-managed TLS certificates with Azure Front Door, use the 'Latest' certificate version. Reduce the risk of outages caused by manual certificate renewal.",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "WAF checklist",
            "graph": "resources | where type =~ 'microsoft.cdn/profiles' and sku has 'AzureFrontDoor' | project name, cdnprofileid=tolower(id), tostring(tags), resourceGroup, subscriptionId,skuname=tostring(sku.name) | join kind= fullouter ( cdnresources | where type == 'microsoft.cdn/profiles/securitypolicies' | extend wafpolicyid=tostring(properties['parameters']['wafPolicy']['id']) | extend splitid=split(id, '/') | extend cdnprofileid=tolower(strcat_array(array_slice(splitid, 0, 8), '/')) | project secpolname=name, cdnprofileid, wafpolicyid ) on cdnprofileid | project name, cdnprofileid, secpolname, wafpolicyid,skuname | join kind = fullouter ( resources | where type == 'microsoft.network/frontdoorwebapplicationfirewallpolicies' | extend managedrulesenabled=iff(tostring(properties.managedRules.managedRuleSets) != '[]', true, false), enabledState = tostring(properties.policySettings.enabledState) | project afdwafname=name, managedrulesenabled, wafpolicyid=id, enabledState, tostring(tags) ) on wafpolicyid | where name != '' | summarize associatedsecuritypolicies=countif(secpolname != ''), wafswithmanagedrules=countif(managedrulesenabled == 1) by name, id=cdnprofileid, tags,skuname | extend compliant = (associatedsecuritypolicies > 0 and wafswithmanagedrules > 0) | project id, compliant",
            "guid": "e79d17b7-3b22-4a5a-97e7-a8ed4b30e38c",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "service": "Front Door",
            "services": [
                "WAF",
                "AzurePolicy",
                "FrontDoor"
            ],
            "severity": "Medium",
            "text": "Use Azure Front Door with WAF policies to deliver and help protect global HTTP/S apps that span multiple Azure regions.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "WAF checklist",
            "guid": "3f29812b-2363-4cef-b179-b599de0d5973",
            "link": "https://learn.microsoft.com/azure/frontdoor/origin-security?tabs=application-gateway&pivots=front-door-standard-premium#example-configuration",
            "service": "Front Door",
            "services": [
                "WAF",
                "AzurePolicy",
                "FrontDoor",
                "AppGW"
            ],
            "severity": "Medium",
            "text": "When using Front Door and Application Gateway to help protect HTTP/S apps, use WAF policies in Front Door. Lock down Application Gateway to receive traffic only from Front Door.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "WAF checklist",
            "graph": "resources | where type == 'microsoft.network/frontdoorwebapplicationfirewallpolicies' | project policyName=name, policyId=id,policySku=sku.name, links=properties.securityPolicyLinks, enabledState=properties.policySettings.enabledState, mode=properties.policySettings.mode | mvexpand links | extend securityPolicy=links.id | extend securityPolicyParts=split(securityPolicy, '/') | extend profileId=strcat_array(array_slice(securityPolicyParts, 0, -3), '/') | project id=profileId, compliant=((enabledState=='Enabled') and (mode=='Prevention')), enabledState, mode",
            "guid": "ae248989-b306-4591-9186-de482e3f0f0e",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-policy-settings",
            "service": "Front Door",
            "services": [
                "WAF",
                "AzurePolicy",
                "FrontDoor"
            ],
            "severity": "High",
            "text": "Deploy your WAF policy for Front Door in 'Prevention' mode' so that Web Application Firewall takes appropriate action to allow or deny traffic.",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "WAF checklist",
            "graph": "cdnresources | where type =~ 'microsoft.cdn/profiles/origingroups/origins' | extend frontDoorId = substring(id, 0, indexof(id, '/origingroups')) | extend compliant = properties['hostName'] !endswith '.trafficmanager.net' | project compliant, id=frontDoorId",
            "guid": "062d5839-4d36-402f-bfa4-02811eb936e9",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#avoid-combining-traffic-manager-and-front-door",
            "service": "Front Door",
            "services": [
                "WAF",
                "FrontDoor",
                "EventHubs",
                "TrafficManager"
            ],
            "severity": "High",
            "text": "Avoid placing Traffic Manager behind Front Door.",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "WAF checklist",
            "graph": "cdnresources | where type =~ 'microsoft.cdn/profiles/origingroups/origins' | extend frontDoorId = substring(id, 0, indexof(id, '/origins')) | extend compliant = isempty(properties.originHostHeader) or (tostring(properties.hostName) =~ tostring(properties.originHostHeader)) | project id=frontDoorId, originName = name, compliant",
            "guid": "5efeb96a-003f-4b18-8fcd-b4d84459c2b2",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-the-same-domain-name-on-front-door-and-your-origin",
            "service": "Front Door",
            "services": [
                "WAF",
                "FrontDoor"
            ],
            "severity": "High",
            "text": "Use the same domain name on Azure Front Door and your origin. Mismatched host names can cause subtle bugs.",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "WAF checklist",
            "graph": "cdnresources | where type =~ 'microsoft.cdn/profiles/origingroups/origins' | extend frontDoorId = substring(id, 0, indexof(id, '/origingroups')) | extend originGroupId = substring(id, 0, indexof(id, '/origins')) | join kind=inner (cdnresources | where type =~ 'microsoft.cdn/profiles/origingroups' | extend originGroupName = name | extend hasHealthProbe = isnotnull(properties.healthProbeSettings)) on $left.originGroupId == $right.id | summarize numberOrigins = count() by originGroupId, subscriptionId, frontDoorId, hasHealthProbe, originGroupName | extend compliant = not(numberOrigins == 1 and hasHealthProbe) | project id = frontDoorId, compliant",
            "guid": "0b5a380c-4bfb-47bc-b1d7-dcfef363a61b",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#disable-health-probes-when-theres-only-one-origin-in-an-origin-group",
            "service": "Front Door",
            "services": [
                "WAF",
                "FrontDoor"
            ],
            "severity": "Low",
            "text": "Disable health probes when there is only one origin in an Azure Front Door origin group.",
            "waf": "Performance"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "WAF checklist",
            "guid": "5567048e-e5d7-4206-9c55-b5ed45d2cc0c",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#select-good-health-probe-endpoints",
            "service": "Front Door",
            "services": [
                "WAF",
                "FrontDoor"
            ],
            "severity": "Medium",
            "text": "Select good health probe endpoints for Azure Front Door. Consider building health endpoints that check all of your application's dependencies.",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "WAF checklist",
            "graph": "cdnresources | where type =~ 'microsoft.cdn/profiles/origingroups' | extend frontDoorId = substring(id, 0, indexof(id, '/origingroups/')) | extend compliant = (isnull(properties['healthProbeSettings']['probeRequestType']) or toupper(properties['healthProbeSettings']['probeRequestType']) == 'HEAD') | project compliant, id=frontDoorId",
            "guid": "a13f72f3-8f5c-4864-95e5-75bf37fbbeb1",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-head-health-probes",
            "service": "Front Door",
            "services": [
                "WAF",
                "FrontDoor"
            ],
            "severity": "Low",
            "text": "Use HEAD health probes with Azure Front Door, to reduce the traffic that Front Door sends to your application.",
            "waf": "Performance"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "WAF checklist",
            "graph": "cdnresources | where type =~ 'microsoft.cdn/profiles/customdomains' | extend frontDoorId = substring(id, 0, indexof(id, '/customdomains')) | extend compliant = (isnull(properties['tlsSettings']['certificateType']) or tolower(properties['tlsSettings']['certificateType']) =~ 'customercertificate') | project compliant, id = frontDoorId",
            "guid": "af95c92d-d723-4f4a-98d7-8722324efd4d",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-managed-tls-certificates",
            "service": "Front Door",
            "services": [
                "WAF",
                "AKV",
                "FrontDoor",
                "Cost"
            ],
            "severity": "High",
            "text": "Use managed TLS certificates with Azure Front Door. Reduce operational cost and risk of outages due to certificate renewals.",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "WAF checklist",
            "guid": "189ea962-3969-4863-8f5a-5ad808c2cf4b",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#define-your-waf-configuration-as-code",
            "service": "Front Door",
            "services": [
                "WAF",
                "FrontDoor"
            ],
            "severity": "Medium",
            "text": "Define your Azure Front Door WAF configuration as code. By using code, you can more easily adopt new rule set version and gain additional protection.",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "WAF checklist",
            "graph": "cdnresources | where type == 'microsoft.cdn/profiles/afdendpoints/routes' | extend frontDoorId = substring(id, 0, indexof(id, '/afdendpoints')) | extend forwardingProtocol=tostring(properties.forwardingProtocol),supportedProtocols=properties.supportedProtocols,httpsRedirect=properties.httpsRedirect | extend compliant = forwardingProtocol =~ 'httpsonly' and (supportedProtocols has 'https' or httpsRedirect =~ 'enabled') | project id = frontDoorId, compliant",
            "guid": "2e30abab-5478-417c-81bf-bf1ad4ed1ed4",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-end-to-end-tls",
            "service": "Front Door",
            "services": [
                "WAF",
                "FrontDoor"
            ],
            "severity": "High",
            "text": "Use end-to-end TLS with Azure Front Door. Use TLS for connections from your clients to Front Door, and from Front Door to your origin.",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "WAF checklist",
            "graph": "cdnresources | where type == 'microsoft.cdn/profiles/afdendpoints/routes' | extend frontDoorId = substring(id, 0, indexof(id, '/afdendpoints')) | extend forwardingProtocol=tostring(properties.forwardingProtocol),supportedProtocols=properties.supportedProtocols,httpsRedirect=properties.httpsRedirect | extend compliant = httpsRedirect =~ 'enabled' | project id = frontDoorId, compliant",
            "guid": "10aa45af-166f-44c4-9f36-b6d592dac2ca",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-http-to-https-redirection",
            "service": "Front Door",
            "services": [
                "WAF",
                "FrontDoor"
            ],
            "severity": "Medium",
            "text": "Use HTTP to HTTPS redirection with Azure Front Door. Support older clients by redirecting them to an HTTPS request automatically.",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "WAF checklist",
            "guid": "28b9ee82-b2c7-45aa-bc98-6de6f59a095d",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#enable-the-waf",
            "service": "Front Door",
            "services": [
                "WAF",
                "FrontDoor"
            ],
            "severity": "High",
            "text": "Enable the Azure Front Door WAF. Protect your application from a range of attacks.",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "WAF checklist",
            "guid": "2902d8cc-1b0c-4495-afad-624ab70f7bd6",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#tune-your-waf",
            "service": "Front Door",
            "services": [
                "WAF",
                "FrontDoor"
            ],
            "severity": "High",
            "text": "Tune the Azure Front Door WAF for your workload by configuring the WAF in Detection mode to reduce and fix false positive detections.",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "WAF checklist",
            "guid": "17ba124b-127d-42b6-9322-388d5b2bbcfc",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/application-gateway-waf-request-size-limits#request-body-inspection",
            "service": "Front Door",
            "services": [
                "WAF",
                "AzurePolicy",
                "FrontDoor"
            ],
            "severity": "High",
            "text": "Enable request body inspection feature enabled in Azure Front Door WAF policy.",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "WAF checklist",
            "guid": "49a98f2b-ec22-4a87-9415-6a10b00d6555",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#enable-default-rule-sets",
            "service": "Front Door",
            "services": [
                "WAF",
                "FrontDoor"
            ],
            "severity": "High",
            "text": "Enable the Azure Front Door WAF default rule sets. The default rule sets detect and block common attacks.",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "WAF checklist",
            "guid": "147a13d4-2a2f-4824-a524-f5855b52b946",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#enable-bot-management-rules",
            "service": "Front Door",
            "services": [
                "WAF",
                "FrontDoor"
            ],
            "severity": "High",
            "text": "Enable the Azure Front Door WAF bot protection rule set. The bot rules detect good and bad bots.",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "WAF checklist",
            "guid": "d7dcdcb9-0d99-44b9-baab-ac7570ede79a",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#use-the-latest-ruleset-versions",
            "service": "Front Door",
            "services": [
                "WAF",
                "FrontDoor"
            ],
            "severity": "Medium",
            "text": "Use the latest Azure Front Door WAF rule set version. Rule set updates are regularly updated to take account of the current threat landscape.",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "WAF checklist",
            "guid": "b9620385-1cde-418f-914b-a84a06982ffc",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#add-rate-limiting",
            "service": "Front Door",
            "services": [
                "WAF",
                "FrontDoor"
            ],
            "severity": "Medium",
            "text": "Add rate limiting to the Azure Front Door WAF. Rate limiting blocks clients accidentally or intentionally sending large amounts of traffic in a short period of time.",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "WAF checklist",
            "guid": "6dc36c52-0124-4ffe-9eaf-23ec1282dedb",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#use-a-high-threshold-for-rate-limits",
            "service": "Front Door",
            "services": [
                "WAF",
                "FrontDoor"
            ],
            "severity": "Medium",
            "text": "Use a high threshold for Azure Front Door WAF rate limits. High rate limit thresholds avoid blocking legitimate traffic, while still providing protection against extremely high numbers of requests that might overwhelm your infrastructure.",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "WAF checklist",
            "guid": "388a3d0e-0a43-4367-90b2-3dd2aeece5ee",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#geo-filter-traffic",
            "service": "Front Door",
            "services": [
                "WAF"
            ],
            "severity": "Low",
            "text": "If you are not expecting traffic from all geographical regions, use geo-filters to block traffic from non-expected countries.",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "WAF checklist",
            "guid": "00acd8a9-6975-414f-8491-2be6309893b8",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#specify-the-unknown-zz-location",
            "service": "Front Door",
            "services": [
                "WAF",
                "FrontDoor"
            ],
            "severity": "Medium",
            "text": "Specify the unknown (ZZ) location when geo-filtering traffic with the Azure Front Door WAF. Avoid accidentally blocking legitimate requests when IP addresses can't be geo-matched.",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "WAF checklist",
            "guid": "4cea4050-7946-4a7c-89e6-b021b73c352d",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#add-diagnostic-settings-to-save-your-wafs-logs",
            "service": "Front Door",
            "services": [
                "WAF",
                "Monitor"
            ],
            "severity": "Medium",
            "text": "Capture logs and metrics by turning on Diagnostic Settings. Include resource activity logs, access logs, health probe logs, and WAF logs. Set up alerts.",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "WAF checklist",
            "guid": "845f5f91-9c21-4674-a725-5ce890850e20",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#send-logs-to-microsoft-sentinel",
            "service": "Front Door",
            "services": [
                "WAF",
                "FrontDoor",
                "Sentinel"
            ],
            "severity": "Medium",
            "text": "Send Azure Front Door WAF logs to Microsoft Sentinel.",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "WAF checklist",
            "guid": "3bb0a854-ea3d-4212-bd8e-3f0cb7792b02",
            "link": "https://learn.microsoft.com/azure/frontdoor/routing-methods",
            "service": "Front Door",
            "services": [
                "WAF",
                "Backup"
            ],
            "severity": "Medium",
            "text": "Choose a routing method that supports your deployment strategy. The weighted method, which distributes traffic based on the configured weight coefficient, supports active-active models. A priority-based value that configures the primary region to receive all traffic and send traffic to the secondary region as a backup supports active-passive models. Combine the preceding methods with latency so that the origin with the lowest latency receives traffic.",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "WAF checklist",
            "graph": "cdnresources | where type =~ 'microsoft.cdn/profiles/origingroups' | extend frontDoorId = substring(id, 0, indexof(id, '/origingroups')) | extend healthprobe=tostring(properties.healthProbeSettings) | project origingroupname=name, id, tags, resourceGroup, subscriptionId, healthprobe, frontDoorId | join ( cdnresources | where type =~ 'microsoft.cdn/profiles/origingroups/Origins' | extend origingroupname = tostring(properties.originGroupName) ) on origingroupname | summarize origincount=count(), enabledhealthprobecount=countif(healthprobe != '') by origingroupname, id, tostring(tags), resourceGroup, subscriptionId, frontDoorId | extend compliant = origincount > 1 | project id = frontDoorId, compliant",
            "guid": "c3a769e4-cc78-40a9-b36a-f9bcab19ec2d",
            "link": "https://learn.microsoft.com/azure/frontdoor/quickstart-create-front-door",
            "service": "Front Door",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Support redundancy by having multiple origins in one or more back-end pools. Always have redundant instances of your application and make sure each instance exposes an endpoint or origin. You can place those origins in one or more back-end pools.",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "WAF checklist",
            "guid": "999852be-2137-4179-8fc3-30d1df6fed1d",
            "link": "https://learn.microsoft.com/azure/frontdoor/troubleshoot-issues#troubleshooting-steps",
            "service": "Front Door",
            "services": [
                "WAF",
                "FrontDoor"
            ],
            "severity": "Medium",
            "text": "Set a timeout on forwarding requests to the back end. Adjust the timeout setting according to your endpoints' needs. If you don't, Azure Front Door might close the connection before the origin sends the response. You can also lower the default timeout for Azure Front Door if all of your origins have a shorter timeout.",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "WAF checklist",
            "guid": "17bf6351-3e5e-41f1-87bb-d5ad0b4e3de6",
            "link": "https://learn.microsoft.com/azure/frontdoor/routing-methods#23session-affinity",
            "service": "Front Door",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Decide if your application requires session affinity. If you have high reliability requirements, we recommend that you disable session affinity.",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "WAF checklist",
            "guid": "425bfb31-94c4-4007-b9ae-46da9fe57cc7",
            "link": "https://learn.microsoft.com/azure/frontdoor/origin?pivots=front-door-standard-premium#origin-host-header",
            "service": "Front Door",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Send the host header to the back end. The back-end services should be aware of the host name so that they can create rules to accept traffic only from that host.",
            "waf": "Security"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "WAF checklist",
            "guid": "81a5398a-2414-450f-9fc3-e048bc65784c",
            "link": "https://learn.microsoft.com/azure/frontdoor/front-door-caching",
            "service": "Front Door",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Use caching for endpoints that support it.",
            "waf": "Cost"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "WAF checklist",
            "graph": "cdnresources | where type =~ 'microsoft.cdn/profiles/origingroups' | extend frontDoorId = substring(id, 0, indexof(id, '/origingroups')) | extend healthprobe=tostring(properties.healthProbeSettings) | project origingroupname=name, id, tags, resourceGroup, subscriptionId, healthprobe, frontDoorId | join ( cdnresources | where type =~ 'microsoft.cdn/profiles/origingroups/Origins' | extend origingroupname = tostring(properties.originGroupName) ) on origingroupname | summarize origincount=count(), enabledhealthprobecount=countif(healthprobe != '') by origingroupname, id, tostring(tags), resourceGroup, subscriptionId, frontDoorId | extend compliant = origincount > 1 or (origincount == 1 and enabledhealthprobecount == 0) | project id = frontDoorId, compliant",
            "guid": "34069d73-e4de-46c5-a36f-625f87575a56",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#disable-health-probes-when-theres-only-one-origin-in-an-origin-group",
            "service": "Front Door",
            "services": [
                "WAF",
                "FrontDoor"
            ],
            "severity": "Low",
            "text": "Disable health checks in single back-end pools. If you have only one origin configured in your Azure Front Door origin group, these calls are unnecessary. This is only recommended if you can't have multiple origins in your endpoint.",
            "waf": "Cost"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "WAF checklist",
            "guid": "c92d6786-cdd1-444d-9cad-934a192a276a",
            "link": "https://learn.microsoft.com/azure/frontdoor/standard-premium/how-to-reports",
            "service": "Front Door",
            "services": [
                "WAF",
                "FrontDoor",
                "Storage"
            ],
            "severity": "Medium",
            "text": "We recommend using the Premium Tier for leveraging the Security reports while the Standard Azure Front Door Profile provides only traffic reports under built-in analytics/reports.",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "WAF checklist",
            "guid": "440cf7de-30a1-4550-ab50-c9f6eac140cd",
            "link": "https://learn.microsoft.com/azure/frontdoor/front-door-wildcard-domain",
            "service": "Front Door",
            "services": [
                "WAF",
                "AKV"
            ],
            "severity": "Medium",
            "text": "Use wildcard TLS certificates when possible.",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "WAF checklist",
            "guid": "556e2733-6ca9-4edd-9cc7-26de66d46c2e",
            "link": "https://learn.microsoft.com/azure/frontdoor/front-door-caching",
            "service": "Front Door",
            "services": [
                "WAF",
                "FrontDoor"
            ],
            "severity": "Medium",
            "text": "Optimize your application query string for caching. For purely static content, ignore query strings to maximize your use of the cache. If your application uses query strings, consider including them in the cache key. Including the query strings in the cache key allows Azure Front Door to serve cached responses or other responses, based on your configuration.",
            "waf": "Performance"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "WAF checklist",
            "guid": "c0b7e55e-fcab-4e66-bdae-bd0290f6aece",
            "link": "https://learn.microsoft.com/azure/frontdoor/standard-premium/how-to-compression",
            "service": "Front Door",
            "services": [
                "WAF",
                "Storage"
            ],
            "severity": "Medium",
            "text": "Use file compression when you're accessing downloadable content.",
            "waf": "Performance"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "WAF checklist",
            "graph": "resources | where type =~ 'microsoft.network/frontdoors' and properties['resourceState'] !~ 'migrated' | extend compliant = false | project id, compliant",
            "guid": "cb8eb8c0-aa73-4a26-a495-6eba8dc4a243",
            "link": "https://learn.microsoft.com/azure/cdn/tier-migration",
            "service": "Front Door",
            "services": [
                "WAF",
                "FrontDoor"
            ],
            "severity": "High",
            "text": "Consider migrating to Standard or Premium SKU if you are using Classic Azure Front Door currently as Classic Azure Front Door will be deprecated by March 2027.",
            "waf": "Operations"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "WAF checklist",
            "guid": "67c33697-15b1-4752-aeee-0b9b588defc4",
            "link": "https://learn.microsoft.com/azure/architecture/guide/networking/global-web-applications/mission-critical-content-delivery",
            "service": "Front Door",
            "services": [
                "WAF",
                "FrontDoor",
                "TrafficManager",
                "Storage"
            ],
            "severity": "Medium",
            "text": "Consider using Traffic Manager load balancing Azure Front Door and a third party CDN provider CDN profile for mission critical high availability scenario. ",
            "waf": "Reliability"
        },
        {
            "arm-service": "microsoft.network/frontdoors",
            "checklist": "WAF checklist",
            "guid": "972cd4cd-25b0-4b70-96e9-eab4bfd32907",
            "link": "https://learn.microsoft.com/azure/app-service/app-service-ip-restrictions?tabs=azurecli#restrict-access-to-a-specific-azure-front-door-instance",
            "service": "Front Door",
            "services": [
                "WAF",
                "FrontDoor",
                "AppSvc"
            ],
            "severity": "High",
            "text": "When using Front Door with origin as App services, consider locking down the traffic to app services only through Azure Front Door using access restrictions. ",
            "waf": "Security"
        },
        {
            "arm-service": "Microsoft.DBforMySQL/servers",
            "checklist": "WAF checklist",
            "guid": "388c3e25-e800-4ad2-9df3-f3d6ae1050b7",
            "link": "https://learn.microsoft.com/azure/mysql/flexible-server/overview",
            "service": "Azure MySQL",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Leverage Flexible Server",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.DBforMySQL/servers",
            "checklist": "WAF checklist",
            "guid": "de3aad1e-8c38-4ec9-9666-7313c005674b",
            "link": "https://learn.microsoft.com/azure/mysql/flexible-server/overview#high-availability-within-and-across-availability-zones",
            "service": "Azure MySQL",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "text": "Leverage Availability Zones where regionally applicable",
            "waf": "Reliability"
        },
        {
            "arm-service": "Microsoft.DBforMySQL/servers",
            "checklist": "WAF checklist",
            "guid": "1e944a45-9c37-43e7-bd61-623b365a917e",
            "link": "https://learn.microsoft.com/azure/mysql/flexible-server/overview#setup-hybrid-or-multi-cloud-data-synchronization-with-data-in-replication",
            "service": "Azure MySQL",
            "services": [
                "WAF"
            ],
            "severity": "Medium",
            "text": "Leverage Data-in replication for cross-region DR scenarios",
            "waf": "Reliability"
        },
        {
            "category": "Managed clusters",
            "checklist": "Azure Service Fabric Review Checklist",
            "graph": "resources | where type=~'Microsoft.ServiceFabric/managedClusters' | extend compliant = (sku=~'{\"name\":\"Standard\"}') | distinct id,compliant",
            "guid": "182840d2-9ef8-4238-8fd6-0d76186830ac",
            "link": "https://learn.microsoft.com/azure/service-fabric/overview-managed-cluster#service-fabric-managed-cluster-skus",
            "service": "Azure Service Fabric",
            "services": [],
            "severity": "Medium",
            "subcategory": "Cluster architecture",
            "text": "Use Standard SKU for production scenarios.",
            "waf": "Reliability"
        },
        {
            "category": "Standard clusters",
            "checklist": "Azure Service Fabric Review Checklist",
            "graph": "resources | where type=~'Microsoft.ServiceFabric/clusters' | extend nodeTypes= array_concat(properties.nodeTypes) | mv-expand nodeTypes | summarize BronzeDurabilityCount = countif(nodeTypes.durabilityLevel == 'Bronze') by id | extend compliant = (BronzeDurabilityCount == 0) | distinct id,compliant",
            "guid": "182840d2-9ef8-4238-8fd6-0d76186830ac",
            "link": "https://learn.microsoft.com/azure/service-fabric/service-fabric-cluster-capacity#durability-characteristics-of-the-cluster",
            "service": "Azure Service Fabric",
            "services": [
                "VM"
            ],
            "severity": "Medium",
            "subcategory": "Cluster architecture",
            "text": "Use durability level Silver (5 VMs) or greater for production scenarios",
            "waf": "Reliability"
        },
        {
            "category": "Managed clusters",
            "checklist": "Azure Service Fabric Review Checklist",
            "graph": "resources | where type=~'Microsoft.ServiceFabric/managedClusters' | extend compliant= ( properties.zonalResiliency =~ 'true') | distinct id,compliant",
            "guid": "2363878d-55c4-4cbd-9bc2-94523c85f12e",
            "link": "https://learn.microsoft.com/azure/service-fabric/how-to-managed-cluster-availability-zones",
            "service": "Azure Service Fabric",
            "services": [
                "ACR"
            ],
            "severity": "Medium",
            "subcategory": "Cluster architecture",
            "text": "Consider using Availability Zones for your Service Fabric clusters. Service Fabric managed cluster supports deployments that span across multiple Availability Zones to provide zone resiliency. This configuration will ensure high-availability of the critical system services and your applications to protect from single-points-of-failure.",
            "waf": "Reliability"
        },
        {
            "category": "Managed clusters",
            "checklist": "Azure Service Fabric Review Checklist",
            "guid": "5ba74cc8-3ca2-44d5-9a67-bdc8e102e7b4",
            "link": "https://learn.microsoft.com/azure/service-fabric/service-fabric-api-management-overview",
            "service": "Azure Service Fabric",
            "services": [
                "APIM"
            ],
            "severity": "Medium",
            "subcategory": "Cluster architecture",
            "text": "Consider using Azure API Management to expose and offload cross-cutting functionality for APIs hosted on the cluster. API Management can integrate with Service Fabric directly.",
            "waf": "Reliability"
        },
        {
            "category": "Managed clusters",
            "checklist": "Azure Service Fabric Review Checklist",
            "guid": "ef17bb8f-4e2c-488b-8ceb-a07c3d750dd3",
            "link": "https://learn.microsoft.com/azure/service-fabric/service-fabric-reliable-services-introduction",
            "service": "Azure Service Fabric",
            "services": [],
            "severity": "Medium",
            "subcategory": "Workload architecture",
            "text": "For stateful workload scenarios, consider using Reliable Services. The Reliable Services model allows your services to stay up even in unreliable environments where your machines fail or hit network issues, or in cases where the services themselves encounter errors and crash or fail. For stateful services, your state is preserved even in the presence of network or other failures.",
            "waf": "Reliability"
        },
        {
            "category": "Managed clusters",
            "checklist": "Azure Service Fabric Review Checklist",
            "graph": "resources | where type=~'Microsoft.Compute/virtualMachineScaleSets' | extend vmssExtension= array_concat(properties.virtualMachineProfile.extensionProfile.extensions) | mv-expand vmssExtension | where vmssExtension.properties.publisher matches regex '^Microsoft.Azure.ServiceFabric.*' | summarize arg_max(id, *) | summarize compliant = countif(sku.name matches regex '^Standard_[^d]*$' ) by id",
            "guid": "4da21268-f775-4c89-a271-eb80543c8df7",
            "service": "Azure Service Fabric",
            "services": [
                "VM"
            ],
            "severity": "Medium",
            "subcategory": "Cluster architecture",
            "text": "Avoid VM SKUs with temp disk offerings. Service Fabric uses managed disks by default, so avoiding temp disk offerings ensures you don't pay for unneeded resources.",
            "waf": "Cost"
        },
        {
            "category": "Managed clusters",
            "checklist": "Azure Service Fabric Review Checklist",
            "guid": "1890b796-f300-41a3-a8d4-29738c1f4ad0",
            "link": "https://learn.microsoft.com/azure/service-fabric/how-to-managed-cluster-stateless-node-type#temporary-disk-support",
            "service": "Azure Service Fabric",
            "services": [
                "VM"
            ],
            "severity": "Medium",
            "subcategory": "Cluster architecture",
            "text": "If you need to select a certain VM SKU for capacity reasons and it happens to offer temp disk, consider using temporary disk support for your stateless workloads.",
            "waf": "Cost"
        },
        {
            "category": "Managed clusters",
            "checklist": "Azure Service Fabric Review Checklist",
            "guid": "5247bb32-6778-49c7-8b40-e171c9a3ce1e",
            "service": "Azure Service Fabric",
            "services": [],
            "severity": "Medium",
            "subcategory": "Cluster and workload architectures",
            "text": "Align SKU selection and managed disk size with workload requirements. Matching your selection to your workload demands ensures you don't pay for unneeded resources.",
            "waf": "Cost"
        },
        {
            "category": "Managed clusters",
            "checklist": "Azure Service Fabric Review Checklist",
            "guid": "6028759b-446a-41bc-8b0e-7728e61ca704",
            "link": "https://learn.microsoft.com/azure/service-fabric/how-to-managed-cluster-networking#manage-nsg-rules",
            "service": "Azure Service Fabric",
            "services": [
                "VNet",
                "APIM"
            ],
            "severity": "Medium",
            "subcategory": "Cluster architecture",
            "text": "Ensure Network Security Groups (NSG) are configured to restrict traffic flow between subnets and node types. For example, you may have an API Management instance (one subnet), a frontend subnet (exposing a website directly), and a backend subnet (accessible only to frontend).",
            "waf": "Security"
        },
        {
            "category": "Managed clusters",
            "checklist": "Azure Service Fabric Review Checklist",
            "graph": "resources | where type=~'Microsoft.Compute/virtualMachineScaleSets' | extend vmssExtension= array_concat(properties.virtualMachineProfile.extensionProfile.extensions) | mv-expand vmssExtension | where vmssExtension.properties.publisher matches regex '^Microsoft.Azure.ServiceFabric.*' | summarize arg_max(id, *) | extend compliant = (isnotnull(properties.virtualMachineProfile.osProfile.secrets))",
            "guid": "4e98c903-14cf-4c72-9c45-b8b23bc4cbd8",
            "link": "https://learn.microsoft.com/azure/service-fabric/service-fabric-best-practices-security#deploy-key-vault-certificates-to-service-fabric-cluster-virtual-machine-scale-sets",
            "service": "Azure Service Fabric",
            "services": [
                "AKV",
                "VM",
                "Storage",
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Cluster architecture",
            "text": "Deploy Key Vault certificates to Service Fabric cluster virtual machine scale sets. Centralizing storage of application secrets in Azure Key Vault allows you to control their distribution. Key Vault greatly reduces the chances that secrets may be accidentally leaked.",
            "waf": "Security"
        },
        {
            "category": "Managed clusters",
            "checklist": "Azure Service Fabric Review Checklist",
            "guid": "001cbb6f-d88d-4431-8434-d01333397776",
            "link": "https://learn.microsoft.com/azure/service-fabric/service-fabric-best-practices-security#apply-an-access-control-list-acl-to-your-certificate-for-your-service-fabric-cluster",
            "service": "Azure Service Fabric",
            "services": [],
            "severity": "Medium",
            "subcategory": "Cluster architecture",
            "text": "Apply an Access Control List (ACL) to your client certificate for your Service Fabric cluster. Using an ACL provides an additional level of authentication.",
            "waf": "Security"
        },
        {
            "category": "Managed clusters",
            "checklist": "Azure Service Fabric Review Checklist",
            "guid": "4b74b7a5-bb1e-4fca-948c-037ba95fb73b",
            "link": "https://learn.microsoft.com/azure/service-fabric/service-fabric-resource-governance#resource-governance-mechanism",
            "service": "Azure Service Fabric",
            "services": [
                "ACR"
            ],
            "severity": "Medium",
            "subcategory": "Cluster architecture",
            "text": "Use resource requests and limits to govern resource usage across the nodes in your cluster. Enforcing resource limits helps ensure that one service doesn't consume too many resources and starve other services.",
            "waf": "Security"
        },
        {
            "category": "Managed clusters",
            "checklist": "Azure Service Fabric Review Checklist",
            "guid": "cd9233ba-f3aa-4353-8d2f-7ea4a64160e6",
            "link": "",
            "service": "Azure Service Fabric",
            "services": [],
            "severity": "Medium",
            "subcategory": "Workload architecture",
            "text": "Encrypt Service Fabric package secret values. Encryption on your secret values provides an additional level of security.",
            "waf": "Security"
        },
        {
            "category": "Managed clusters",
            "checklist": "Azure Service Fabric Review Checklist",
            "guid": "44b989d4-9f72-42b6-99da-ec2a79f83299",
            "link": "",
            "service": "Azure Service Fabric",
            "services": [
                "AKV"
            ],
            "severity": "Medium",
            "subcategory": "Workload architecture",
            "text": "Include client certificates in Service Fabric applications. Having your applications use client certificates for authentication provides opportunities for security at both the cluster and workload level.",
            "waf": "Security"
        },
        {
            "category": "Managed clusters",
            "checklist": "Azure Service Fabric Review Checklist",
            "guid": "28e66ff7-4a77-4b2c-910d-0335f141208a",
            "link": "https://learn.microsoft.com/azure/service-fabric/how-to-managed-identity-managed-cluster-virtual-machine-scale-sets",
            "service": "Azure Service Fabric",
            "services": [
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Workload architecture",
            "text": "Authenticate Service Fabric applications to Azure Resources using Managed Identity. Using Managed Identity allow you to securely manage the credentials in your code for authenticating to various services without saving them locally on a developer workstation or in source control.",
            "waf": "Security"
        },
        {
            "category": "Managed clusters",
            "checklist": "Azure Service Fabric Review Checklist",
            "guid": "f16c413c-00a6-43aa-852c-b97292c33a56",
            "link": "https://learn.microsoft.com/azure/service-fabric/service-fabric-best-practices-security#hosting-untrusted-applications-in-a-service-fabric-cluster",
            "service": "Azure Service Fabric",
            "services": [],
            "severity": "Medium",
            "subcategory": "Cluster and workload architectures",
            "text": "Follow Service Fabric best practices when hosting untrusted applications. Following the best practices provides a security standard to follow.",
            "waf": "Security"
        },
        {
            "category": "Foundation",
            "checklist": "Azure Arc Review",
            "description": "Define a resource group structure for placement of Azure Arc-enabled servers resources",
            "guid": "585e1112-9bd7-4ba0-82f7-b94ef6e043d2",
            "services": [
                "Arc"
            ],
            "severity": "High",
            "subcategory": "Capacity Planning",
            "text": "One or more resource groups is required for onboarding servers into Azure",
            "waf": "Operations"
        },
        {
            "category": "Foundation",
            "checklist": "Azure Arc Review",
            "guid": "aa359271-8e6e-4205-8725-769e46691e88",
            "link": "https://learn.microsoft.com/azure/azure-arc/servers/prerequisites#azure-subscription-and-service-limits",
            "services": [
                "Entra",
                "Arc"
            ],
            "severity": "Medium",
            "subcategory": "Capacity Planning",
            "text": "Take Azure Active Directory object limitations into account",
            "waf": "Performance"
        },
        {
            "category": "Foundation",
            "checklist": "Azure Arc Review",
            "description": "The following resource providers needs to be registered: Microsoft.HybridCompute, Microsoft.GuestConfiguration, Microsoft.HybridConnectivity",
            "guid": "deace4bb-1deb-44c6-9fc3-fc14eeaa3692",
            "link": "https://learn.microsoft.com/azure/azure-arc/servers/prerequisites#azure-resource-providers",
            "services": [
                "Subscriptions",
                "Arc"
            ],
            "severity": "High",
            "subcategory": "General",
            "text": "Has the Resource providers required been registered in all subscriptions",
            "waf": "Operations"
        },
        {
            "category": "Foundation",
            "checklist": "Azure Arc Review",
            "description": "Aligning with an existing or creating an Azure tagging strategy is recommended. Resource tags allow you to quickly locate it, automate operational tasks amd more. ",
            "guid": "c6d37331-65c7-4acb-b44b-be609d79f2e8",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/decision-guides/resource-tagging/",
            "services": [
                "Arc"
            ],
            "severity": "Low",
            "subcategory": "General",
            "text": "Has a tagging strategy for Azure Arc-enabled servers been defined",
            "waf": "Cost"
        },
        {
            "category": "Foundation",
            "checklist": "Azure Arc Review",
            "description": "Installation of the connected machine agent is supported on most newer Windows and Linux operative systems, review the link to se the latest list",
            "guid": "7778424c-5167-475c-9fa9-5b96ad88408e",
            "link": "https://learn.microsoft.com/azure/azure-arc/servers/prerequisites#supported-operating-systems",
            "services": [
                "Arc"
            ],
            "severity": "High",
            "subcategory": "General",
            "text": "What operating systems need to be Azure Arc-enabled",
            "waf": "Operations"
        },
        {
            "category": "Foundation",
            "checklist": "Azure Arc Review",
            "description": "There are software requirements to the agent installation. Some might require a system reboot after installation, review to link",
            "guid": "372734b8-76ba-428f-8145-901365d38e53",
            "link": "https://learn.microsoft.com/azure/azure-arc/servers/prerequisites#software-requirements",
            "services": [
                "Arc"
            ],
            "severity": "High",
            "subcategory": "General",
            "text": "Are required software installed on Windows and Linux servers to support the installation",
            "waf": "Operations"
        },
        {
            "category": "Foundation",
            "checklist": "Azure Arc Review",
            "guid": "d44c7c89-19ca-41f6-b521-5ae514ba34d4",
            "link": "https://azure.microsoft.com/explore/global-infrastructure/products-by-region/?products=azure-arc&regions=all",
            "services": [
                "Arc"
            ],
            "severity": "High",
            "subcategory": "General",
            "text": "Make sure to use a supported Azure region",
            "waf": "Reliability"
        },
        {
            "category": "Foundation",
            "checklist": "Azure Arc Review",
            "description": "The scope include organization into management groups, subscriptions, and resource groups.",
            "guid": "f9ccbd86-8266-4abc-a264-f9a19bf39d95",
            "link": "https://learn.microsoft.com/azure/azure-arc/servers/organize-inventory-servers#organize-resources-with-built-in-azure-hierarchies",
            "services": [
                "Subscriptions",
                "Arc"
            ],
            "severity": "Low",
            "subcategory": "Organization",
            "text": "Define the structure for Azure management of resources",
            "waf": "Performance"
        },
        {
            "category": "Identity",
            "checklist": "Azure Arc Review",
            "description": "Define RBAC rules to the servers / resource groups as required for servers management, the 'Azure Connected Machine Resource Administrator' or 'Hybrid Server Resource Administrator' role would be sufficient for management of the Azure Arc-enabled servers resources in Azure",
            "guid": "9bf39d95-d44c-47c8-a19c-a1f6d5215ae5",
            "link": "https://learn.microsoft.com/azure/azure-arc/servers/security-overview#identity-and-access-control",
            "services": [
                "Entra",
                "RBAC",
                "Arc"
            ],
            "severity": "Medium",
            "subcategory": "Access",
            "text": "Assign RBAC rights to Azure AD user/group access for managing Azure Arc-enabled servers",
            "waf": "Security"
        },
        {
            "category": "Identity",
            "checklist": "Azure Arc Review",
            "guid": "14ba34d4-585e-4111-89bd-7ba012f7b94e",
            "link": "https://learn.microsoft.com/azure/active-directory/managed-identities-azure-resources/tutorial-windows-vm-access-nonaad",
            "services": [
                "AKV",
                "Arc",
                "Entra"
            ],
            "severity": "Low",
            "subcategory": "Access",
            "text": "Consider using managed identities for applications to access Azure resources like Key Vault example in link",
            "waf": "Security"
        },
        {
            "category": "Identity",
            "checklist": "Azure Arc Review",
            "description": "An Azure subscription must be parented to the same Azure AD tenant",
            "guid": "35ac9322-23e1-4380-8523-081a94174158",
            "link": "https://learn.microsoft.com/azure/azure-arc/servers/prerequisites#azure-subscription-and-service-limits",
            "services": [
                "Entra",
                "Subscriptions",
                "Arc"
            ],
            "severity": "High",
            "subcategory": "Requirements",
            "text": "An Azure Active Directory tenant must be available with at least one subscription",
            "waf": "Operations"
        },
        {
            "category": "Identity",
            "checklist": "Azure Arc Review",
            "description": "Users (or SPs) need the 'Azure Connected Machine Onboarding' or 'Contributor' role to onboarding of servers",
            "guid": "33ee7ad6-c6d3-4733-865c-7acbe44bbe60",
            "link": "https://learn.microsoft.com/azure/azure-arc/servers/prerequisites#required-permissions",
            "services": [
                "Entra",
                "RBAC",
                "Arc"
            ],
            "severity": "Medium",
            "subcategory": "Requirements",
            "text": "Define which users (AAD user/groups) has access to onboard Azure Arc-enabled servers",
            "waf": "Security"
        },
        {
            "category": "Identity",
            "checklist": "Azure Arc Review",
            "description": "Ensure to only add the rights to users or groups that is required to perform their role",
            "guid": "9d79f2e8-7778-4424-a516-775c6fa95b96",
            "link": "https://learn.microsoft.com/azure/azure-arc/servers/onboard-service-principal#create-a-service-principal-for-onboarding-at-scale",
            "services": [
                "Entra",
                "RBAC",
                "Arc"
            ],
            "severity": "Medium",
            "subcategory": "Security",
            "text": "Use the principle of least privileged",
            "waf": "Security"
        },
        {
            "category": "Identity",
            "checklist": "Azure Arc Review",
            "description": "A service principle with the 'Azure Connected Machine Onboarding' role is required for at-scale onboarding of servers, consider more SP's if onboarding is done by different teams/decentralized management",
            "guid": "ad88408e-3727-434b-a76b-a28f21459013",
            "link": "https://learn.microsoft.com/azure/azure-arc/servers/onboard-service-principal#create-a-service-principal-for-onboarding-at-scale",
            "services": [
                "Entra",
                "RBAC",
                "Arc"
            ],
            "severity": "Medium",
            "subcategory": "Security",
            "text": "How many Service Principals are needed for onboarding Arc-enabled servers into Azure",
            "waf": "Security"
        },
        {
            "category": "Identity",
            "checklist": "Azure Arc Review",
            "description": "Consider assigning the rights for the 'Azure Connected Machine Onboarding' role at the resource group level, to control the resource creation",
            "guid": "65d38e53-f9cc-4bd8-9826-6abca264f9a1",
            "link": "https://learn.microsoft.com/azure/azure-arc/servers/prerequisites#required-permissions",
            "services": [
                "Entra",
                "RBAC",
                "Arc"
            ],
            "severity": "Medium",
            "subcategory": "Security",
            "text": "Limit the rights to onboard Azure Arc-enabled servers to the desired resource groups",
            "waf": "Security"
        },
        {
            "category": "Management and Monitoring",
            "checklist": "Azure Arc Review",
            "description": "Plan for agent deployments at scale",
            "guid": "6ee79d6b-5c2a-4364-a4b6-9bad38aad53c",
            "link": "https://learn.microsoft.com/azure/azure-arc/servers/plan-at-scale-deployment",
            "services": [
                "Monitor",
                "Arc"
            ],
            "severity": "Medium",
            "subcategory": "Management",
            "text": "Define a strategy for agent provisioning",
            "waf": "Operations"
        },
        {
            "category": "Management and Monitoring",
            "checklist": "Azure Arc Review",
            "description": "Use Microsoft Update to ensure that the connected machine agent is always up-to-date",
            "guid": "c78e1d76-6673-457c-9496-74c5ed85b859",
            "link": "https://learn.microsoft.com/azure/azure-arc/servers/manage-agent#upgrade-the-agent",
            "services": [
                "Monitor",
                "Arc"
            ],
            "severity": "High",
            "subcategory": "Management",
            "text": "Define a strategy for agent updates",
            "waf": "Operations"
        },
        {
            "category": "Management and Monitoring",
            "checklist": "Azure Arc Review",
            "description": "Recommendation is to use Azure Policy, or another automation tool like Azure DevOps - important is to avoid configuration drift.",
            "guid": "c7733be2-a1a2-47b7-95a9-1be1f388ff39",
            "link": "https://learn.microsoft.com/azure/azure-arc/servers/manage-vm-extensions",
            "services": [
                "AzurePolicy",
                "Monitor",
                "Arc"
            ],
            "severity": "Medium",
            "subcategory": "Management",
            "text": "Define a strategy for extension installation",
            "waf": "Operations"
        },
        {
            "category": "Management and Monitoring",
            "checklist": "Azure Arc Review",
            "description": "Use automatic upgrades where available and define an update strategy for all extensions not supporting automatic upgrades.",
            "guid": "4c2bd463-cbbb-4c86-a195-abb91a4ed90d",
            "link": "https://learn.microsoft.com/azure/azure-arc/servers/manage-automatic-vm-extension-upgrade?tabs=azure-portal",
            "services": [
                "Monitor",
                "Arc"
            ],
            "severity": "High",
            "subcategory": "Management",
            "text": "Define a strategy for extension updates",
            "waf": "Operations"
        },
        {
            "category": "Management and Monitoring",
            "checklist": "Azure Arc Review",
            "description": "Azure Automanage help implement Microsoft best-practices for servers management in Azure",
            "guid": "7a927c39-74d1-4102-aac6-aae01e6a84de",
            "link": "https://learn.microsoft.com/azure/automanage/automanage-arc",
            "services": [
                "Monitor",
                "Arc"
            ],
            "severity": "Medium",
            "subcategory": "Management",
            "text": "Consider using Azure Automanage to control settings and avoid configuration drift on servers",
            "waf": "Operations"
        },
        {
            "category": "Management and Monitoring",
            "checklist": "Azure Arc Review",
            "guid": "37b6b780-cbaf-4e6c-9658-9d457a927c39",
            "link": "https://learn.microsoft.com/azure/azure-arc/servers/plan-at-scale-deployment#phase-3-manage-and-operate",
            "services": [
                "Monitor",
                "Arc"
            ],
            "severity": "High",
            "subcategory": "Monitoring",
            "text": "Monitor for unresponsive agents",
            "waf": "Operations"
        },
        {
            "category": "Management and Monitoring",
            "checklist": "Azure Arc Review",
            "guid": "74d1102c-ac6a-4ae0-8e6a-84de5df47d2d",
            "link": "https://learn.microsoft.com/azure/azure-monitor/agents/log-analytics-agent#data-collected",
            "services": [
                "Monitor",
                "Arc"
            ],
            "severity": "Medium",
            "subcategory": "Monitoring",
            "text": "Design a monitoring strategy to send metrics and logs to an Log Analytics workspace",
            "waf": "Operations"
        },
        {
            "category": "Management and Monitoring",
            "checklist": "Azure Arc Review",
            "guid": "92881b1c-d5d1-4e54-a296-59e3958fd782",
            "link": "https://learn.microsoft.com/azure/service-health/resource-health-alert-monitor-guide",
            "services": [
                "Monitor",
                "Arc"
            ],
            "severity": "Medium",
            "subcategory": "Monitoring",
            "text": "Use notification in Activity logs to receive notification on unexpected changes to the resources",
            "waf": "Operations"
        },
        {
            "category": "Management and Monitoring",
            "checklist": "Azure Arc Review",
            "guid": "89c93555-6d02-4bfe-9564-b0d834a34872",
            "link": "https://learn.microsoft.com/azure/azure-arc/servers/learn/tutorial-enable-vm-insights",
            "services": [
                "Monitor",
                "Arc"
            ],
            "severity": "Medium",
            "subcategory": "Monitoring",
            "text": "Use Azure Monitor for compliance and operational monitoring",
            "waf": "Operations"
        },
        {
            "category": "Management and Monitoring",
            "checklist": "Azure Arc Review",
            "guid": "5df47d2d-9288-41b1-ad5d-1e54a29659e3",
            "link": "https://learn.microsoft.com/azure/azure-arc/servers/plan-at-scale-deployment#phase-3-manage-and-operate",
            "services": [
                "Monitor",
                "Arc"
            ],
            "severity": "Medium",
            "subcategory": "Monitoring",
            "text": "Create an alert to identify Azure Arc-enabled servers that aren't using the latest version of the Azure connected machine agent",
            "waf": "Operations"
        },
        {
            "category": "Management and Monitoring",
            "checklist": "Azure Arc Review",
            "description": "Use Update Management in Azure Automation or the new Update Management Center (preview) functionality to ensure update management of servers",
            "guid": "ae2cc84c-37b6-4b78-8cba-fe6c46589d45",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/manage/hybrid/server/best-practices/arc-update-management",
            "services": [
                "Monitor",
                "Arc"
            ],
            "severity": "Low",
            "subcategory": "Security",
            "text": "Use Azure Arc-enabled servers to control software updates deployments to servers",
            "waf": "Operations"
        },
        {
            "category": "Networking",
            "checklist": "Azure Arc Review",
            "description": "The Connected Machine Agent will by default communicate with Azure services over public Internet connectivity using HTTPS (TCP port 443)",
            "guid": "f6e043d2-aa35-4927-88e6-e2050725769e",
            "link": "https://learn.microsoft.com/azure/azure-arc/servers/network-requirements?tabs=azure-cloud#details",
            "services": [
                "Arc"
            ],
            "severity": "High",
            "subcategory": "Networking",
            "text": "Define a connectivity method from the server to Azure",
            "waf": "Operations"
        },
        {
            "category": "Networking",
            "checklist": "Azure Arc Review",
            "description": "The Connected Machine Agent can be configured to use a proxy server, it is recommended to define the proxy server address using 'azcmagent config set proxy.url' command on the local system.",
            "guid": "46691e88-35ac-4932-823e-13800523081a",
            "link": "https://learn.microsoft.com/azure/azure-arc/servers/manage-agent#update-or-remove-proxy-settings",
            "services": [
                "Arc"
            ],
            "severity": "Medium",
            "subcategory": "Networking",
            "text": "Is a proxy server a required for communication over the Public Internet",
            "waf": "Operations"
        },
        {
            "category": "Networking",
            "checklist": "Azure Arc Review",
            "description": "The Connected Machine Agent can use a Private Link for communication with Azure Services over an existing ExpressRoute or VPN connection",
            "guid": "94174158-33ee-47ad-9c6d-3733165c7acb",
            "link": "https://learn.microsoft.com/azure/azure-arc/servers/private-link-security",
            "services": [
                "ExpressRoute",
                "Arc",
                "PrivateLink",
                "VPN"
            ],
            "severity": "Medium",
            "subcategory": "Networking",
            "text": "Is a private (not public Internet) connection required?",
            "waf": "Operations"
        },
        {
            "category": "Networking",
            "checklist": "Azure Arc Review",
            "description": "Firewall configuration might be required for the agent to communicate with Azure, use the link to see ServiceTags and/or URL's required",
            "guid": "e44bbe60-9d79-4f2e-a777-8424c516775c",
            "link": "https://learn.microsoft.com/azure/azure-arc/servers/network-requirements?tabs=azure-cloud#service-tags",
            "services": [
                "Arc"
            ],
            "severity": "High",
            "subcategory": "Networking",
            "text": "Will Firewall configurations be needed in order to ensure communication with Azure Services?",
            "waf": "Security"
        },
        {
            "category": "Networking",
            "checklist": "Azure Arc Review",
            "description": "Use available automation tool for the system in question to regularly update the Azure endpoints",
            "guid": "6fa95b96-ad88-4408-b372-734b876ba28f",
            "link": "https://www.microsoft.com/download/details.aspx?id=56519",
            "services": [
                "Arc"
            ],
            "severity": "Low",
            "subcategory": "Networking",
            "text": "Can the Firewall or Proxy rules be automated updated if Service Tags or IP addresses change",
            "waf": "Security"
        },
        {
            "category": "Networking",
            "checklist": "Azure Arc Review",
            "description": "Configure Servers to use Transport Layer Security (TLS) version 1.2",
            "guid": "21459013-65d3-48e5-9f9c-cbd868266abc",
            "link": "https://learn.microsoft.com/azure/azure-arc/servers/network-requirements?tabs=azure-cloud#transport-layer-security-12-protocol",
            "services": [
                "Arc"
            ],
            "severity": "High",
            "subcategory": "Networking",
            "text": "Always use secure communication for Azure where possible",
            "waf": "Security"
        },
        {
            "category": "Networking",
            "checklist": "Azure Arc Review",
            "description": "All extensions (like log analytics etc.) have separate network requirements, be sure to include all in the network design.",
            "guid": "a264f9a1-9bf3-49d9-9d44-c7c8919ca1f6",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/hybrid/arc-enabled-servers/eslz-arc-servers-connectivity#define-extensions-connectivity-method",
            "services": [
                "Monitor",
                "Arc",
                "PrivateLink"
            ],
            "severity": "Low",
            "subcategory": "Networking",
            "text": "Include communication for Azure Arc-enabled Servers extensions in the design (firewall/proxy/private link)",
            "waf": "Security"
        },
        {
            "category": "Security, Governance and Compliance",
            "checklist": "Azure Arc Review",
            "guid": "ac6aae01-e6a8-44de-9df4-7d2d92881b1c",
            "link": "https://learn.microsoft.com/azure/governance/policy/",
            "services": [
                "AzurePolicy",
                "Arc"
            ],
            "severity": "Medium",
            "subcategory": "Management",
            "text": "Use Azure Policy to implement a governance model for hybrid connected servers",
            "waf": "Security"
        },
        {
            "category": "Security, Governance and Compliance",
            "checklist": "Azure Arc Review",
            "guid": "5c2a3649-4b69-4bad-98aa-d53cc78e1d76",
            "link": "https://learn.microsoft.com/azure/governance/machine-configuration/overview",
            "services": [
                "Arc"
            ],
            "severity": "Medium",
            "subcategory": "Management",
            "text": "Consider using Machine configurations for in guest OS configurations",
            "waf": "Operations"
        },
        {
            "category": "Security, Governance and Compliance",
            "checklist": "Azure Arc Review",
            "guid": "667357c4-4967-44c5-bd85-b859c7733be2",
            "link": "https://learn.microsoft.com/azure/governance/machine-configuration/machine-configuration-create",
            "services": [
                "AzurePolicy",
                "Arc"
            ],
            "severity": "Medium",
            "subcategory": "Management",
            "text": "Evaluate the need for custom Guest Configuration policies",
            "waf": "Operations"
        },
        {
            "category": "Security, Governance and Compliance",
            "checklist": "Azure Arc Review",
            "guid": "49674c5e-d85b-4859-a773-3be2a1a27b77",
            "link": "https://learn.microsoft.com/azure/automation/change-tracking/overview",
            "services": [
                "Monitor",
                "Arc"
            ],
            "severity": "Medium",
            "subcategory": "Monitoring",
            "text": "Consider using change tracking for tracking changes made on the servers",
            "waf": "Operations"
        },
        {
            "category": "Security, Governance and Compliance",
            "checklist": "Azure Arc Review",
            "guid": "d5d1e54a-2965-49e3-a58f-d78289c93555",
            "link": "https://learn.microsoft.com/azure/azure-arc/servers/data-residency",
            "services": [
                "Arc"
            ],
            "severity": "Medium",
            "subcategory": "Requirements",
            "text": "Make sure to use an Azure region for storing the metadata approved by the organization",
            "waf": "Security"
        },
        {
            "category": "Security, Governance and Compliance",
            "checklist": "Azure Arc Review",
            "guid": "195abb91-a4ed-490d-ae2c-c84c37b6b780",
            "link": "https://learn.microsoft.com/azure/key-vault/general/basic-concepts",
            "services": [
                "AKV",
                "Arc"
            ],
            "severity": "Medium",
            "subcategory": "Secrets",
            "text": "Use Azure Key Vault for certificate management on servers",
            "waf": "Security"
        },
        {
            "category": "Security, Governance and Compliance",
            "checklist": "Azure Arc Review",
            "description": "Consider using a short-lived Azure AD service principal client secrets.",
            "guid": "6d02bfe4-564b-40d8-94a3-48726ee79d6b",
            "link": "https://learn.microsoft.com/azure/active-directory/develop/howto-create-service-principal-portal#option-2-create-a-new-application-secret",
            "services": [
                "AKV",
                "Arc",
                "Storage",
                "Entra"
            ],
            "severity": "High",
            "subcategory": "Secrets",
            "text": "What is the acceptable life time of the secret used by SP's",
            "waf": "Security"
        },
        {
            "category": "Security, Governance and Compliance",
            "checklist": "Azure Arc Review",
            "description": "A private key is saved to the disk, ensure this is protected using disk encryption",
            "guid": "a1a27b77-5a91-4be1-b388-ff394c2bd463",
            "link": "https://learn.microsoft.com/azure/azure-arc/servers/security-overview#using-disk-encryption",
            "services": [
                "AKV",
                "Arc"
            ],
            "severity": "Medium",
            "subcategory": "Secrets",
            "text": "Secure the public key for Azure Arc-enabled Servers",
            "waf": "Security"
        },
        {
            "category": "Security, Governance and Compliance",
            "checklist": "Azure Arc Review",
            "description": "Local administrator is required to install the Connected Machine Agent on Windows and Linux systems",
            "guid": "29659e39-58fd-4782-a9c9-35556d02bfe4",
            "link": "https://learn.microsoft.com/azure/azure-arc/servers/onboard-portal#install-manually",
            "services": [
                "Arc"
            ],
            "severity": "High",
            "subcategory": "Security",
            "text": "Ensure there is local administrator access for executing the agent installation",
            "waf": "Security"
        },
        {
            "category": "Security, Governance and Compliance",
            "checklist": "Azure Arc Review",
            "description": "Members of the local administrator group on Windows and users with root privileges on Linux, have permissions to manage the agent via command line.",
            "guid": "564b0d83-4a34-4872-9ee7-9d6b5c2a3649",
            "link": "https://learn.microsoft.com/azure/azure-arc/servers/security-overview#agent-security-and-permissions",
            "services": [
                "Arc"
            ],
            "severity": "Medium",
            "subcategory": "Security",
            "text": "Limit the amount of users with local administrator rights to the servers",
            "waf": "Security"
        },
        {
            "category": "Security, Governance and Compliance",
            "checklist": "Azure Arc Review",
            "guid": "4b69bad3-8aad-453c-a78e-1d76667357c4",
            "link": "https://learn.microsoft.com/azure/azure-arc/servers/managed-identity-authentication",
            "services": [
                "Entra",
                "Arc"
            ],
            "severity": "Medium",
            "subcategory": "Security",
            "text": "Consider using and restricting access to managed identities for applications.",
            "waf": "Security"
        },
        {
            "category": "Security, Governance and Compliance",
            "checklist": "Azure Arc Review",
            "description": "Use Defender for Endpoint or another AV and EDR solution to protect endpoints",
            "guid": "5a91be1f-388f-4f39-9c2b-d463cbbbc868",
            "link": "https://learn.microsoft.com/azure/security-center/security-center-get-started",
            "services": [
                "Arc",
                "Defender"
            ],
            "severity": "Medium",
            "subcategory": "Security",
            "text": "Enable Defender for Servers for all servers to secure hybrid workloads from threats",
            "waf": "Security"
        },
        {
            "category": "Security, Governance and Compliance",
            "checklist": "Azure Arc Review",
            "guid": "cbafe6c4-6589-4d45-9a92-7c3974d1102c",
            "services": [
                "Arc"
            ],
            "severity": "Medium",
            "subcategory": "Security",
            "text": "Define controls to detect security misconfigurations and track compliance",
            "waf": "Security"
        },
        {
            "category": "Security, Governance and Compliance",
            "checklist": "Azure Arc Review",
            "guid": "cbbbc868-195a-4bb9-8a4e-d90dae2cc84c",
            "link": "https://learn.microsoft.com/azure/azure-arc/servers/security-overview#extension-allowlists-and-blocklists",
            "services": [
                "Arc"
            ],
            "severity": "Medium",
            "subcategory": "Security",
            "text": "Use allow- or block-lists to control what extensions can be installed on the Azure Arc-enabled servers",
            "waf": "Security"
        },
        {
            "category": "Identity and Access Management",
            "checklist": "Azure Red Hat OpenShift",
            "guid": "d7e47431-76c8-4bdb-b55b-ce619e8a03f9",
            "link": "https://learn.microsoft.com/azure/openshift/howto-create-service-principal?pivots=aro-azurecli",
            "services": [
                "RBAC",
                "Entra"
            ],
            "severity": "High",
            "subcategory": "Identity",
            "text": "Create a service principal and its role assignments before creating the ARO clusters.",
            "waf": "Security"
        },
        {
            "category": "Identity and Access Management",
            "checklist": "Azure Red Hat OpenShift",
            "guid": "7879424d-6267-486d-90b9-6c97be985190",
            "link": "https://learn.microsoft.com/azure/openshift/configure-azure-ad-ui",
            "services": [
                "Entra"
            ],
            "severity": "High",
            "subcategory": "Identity",
            "text": "Use AAD to authenticate users in your ARO cluster.",
            "waf": "Security"
        },
        {
            "category": "Identity and Access Management",
            "checklist": "Azure Red Hat OpenShift",
            "guid": "adfec5f9-a82d-46e9-a8d1-5a0c7fed5d15",
            "link": "https://docs.openshift.com/container-platform/4.14/authentication/remove-kubeadmin.html",
            "services": [
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Identity",
            "text": "When using AAD authentication, remove kubeadmin user from the cluster.",
            "waf": "Security"
        },
        {
            "category": "Identity and Access Management",
            "checklist": "Azure Red Hat OpenShift",
            "guid": "483835c9-86bb-4291-8155-a11475e39f54",
            "link": "https://docs.openshift.com/container-platform/4.13/applications/projects/working-with-projects.html",
            "services": [
                "RBAC",
                "Entra"
            ],
            "severity": "High",
            "subcategory": "Identity",
            "text": "Define OpenShift projects to restrict RBAC privilege and isolate workloads in your cluster.",
            "waf": "Security"
        },
        {
            "category": "Identity and Access Management",
            "checklist": "Azure Red Hat OpenShift",
            "guid": "0acccd97-9376-4bcd-a375-0ab2ab039da6",
            "link": "https://docs.openshift.com/container-platform/4.13/authentication/using-rbac.html",
            "services": [
                "RBAC",
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Identity",
            "text": "Define the required RBAC roles in OpenShift are scoped to either a project or a cluster.",
            "waf": "Security"
        },
        {
            "category": "Identity and Access Management",
            "checklist": "Azure Red Hat OpenShift",
            "guid": "d54d7c89-29db-4107-b532-5ae625ca44e4",
            "link": "https://learn.microsoft.com/azure/cost-management-billing/manage/direct-ea-administration#manage-notification-contacts",
            "services": [
                "AKV",
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Identity",
            "text": "Minimize the number of users who have administrator rights and secrets access.",
            "waf": "Security"
        },
        {
            "category": "Identity and Access Management",
            "checklist": "Azure Red Hat OpenShift",
            "guid": "685e2223-ace8-4bb1-8307-ca5f16f154e3",
            "link": "https://learn.microsoft.com/azure/active-directory/privileged-identity-management/pim-configure",
            "services": [
                "Entra",
                "RBAC"
            ],
            "severity": "Medium",
            "subcategory": "Identity",
            "text": "Use Privileged Identity Management in AAD for ARO users with privileged roles.",
            "waf": "Security"
        },
        {
            "category": "Network topology and connectivity",
            "checklist": "Azure Red Hat OpenShift",
            "guid": "aa369282-9e7e-4216-8836-87af467a1f89",
            "link": "https://learn.microsoft.com/azure/ddos-protection/ddos-protection-overview",
            "services": [
                "WAF",
                "Firewall",
                "VNet",
                "Entra",
                "DDoS",
                "Subscriptions"
            ],
            "severity": "Low",
            "subcategory": "DDoS",
            "text": "Use Azure DDoS Network/IP Protection to protect the virtual network you use for the ARO cluster unless you use Azure Firewall or WAF in a centralized subscription",
            "waf": "Security"
        },
        {
            "category": "Network topology and connectivity",
            "checklist": "Azure Red Hat OpenShift",
            "guid": "35bda433-24f1-4481-8533-182aa5174269",
            "link": "https://docs.openshift.com/container-platform/4.13/networking/routes/secured-routes.html",
            "services": [],
            "severity": "High",
            "subcategory": "Encryption",
            "text": "All web applications you configure to use an ingress should use TLS encryption and shouldn't allow access over unencrypted HTTP.",
            "waf": "Security"
        },
        {
            "category": "Network topology and connectivity",
            "checklist": "Azure Red Hat OpenShift",
            "guid": "44008ae7-d7e4-4743-876c-8bdbf55bce61",
            "link": "https://learn.microsoft.com/azure/frontdoor/front-door-overview",
            "services": [
                "WAF",
                "FrontDoor"
            ],
            "severity": "Medium",
            "subcategory": "Internet",
            "text": "Use Azure Front Door with WAF to securely publish ARO applications to the internet, especially in multi-region environments.",
            "waf": "Security"
        },
        {
            "category": "Network topology and connectivity",
            "checklist": "Azure Red Hat OpenShift",
            "guid": "9e8a03f9-7879-4424-b626-786d60b96c97",
            "link": "https://learn.microsoft.com/azure/openshift/howto-secure-openshift-with-front-door",
            "services": [
                "FrontDoor",
                "PrivateLink"
            ],
            "severity": "Medium",
            "subcategory": "Internet",
            "text": "If exposing an app on ARO with Azure Front Door, use private link to connect Front Door with the ARO router.",
            "waf": "Security"
        },
        {
            "category": "Network topology and connectivity",
            "checklist": "Azure Red Hat OpenShift",
            "guid": "be985190-4838-435c-a86b-b2912155a114",
            "link": "https://learn.microsoft.com/azure/openshift/howto-restrict-egress",
            "services": [
                "AzurePolicy",
                "NVA",
                "Firewall"
            ],
            "severity": "Medium",
            "subcategory": "Internet",
            "text": "If your security policy requires you to inspect all outbound internet traffic that's generated in the ARO cluster, secure egress network traffic by using Azure Firewall or an NVA.",
            "waf": "Security"
        },
        {
            "category": "Network topology and connectivity",
            "checklist": "Azure Red Hat OpenShift",
            "guid": "75e39f54-0acc-4cd9-9937-6bcda3750ab2",
            "link": "https://learn.microsoft.com/azure/openshift/howto-create-private-cluster-4x",
            "services": [
                "AzurePolicy"
            ],
            "severity": "High",
            "subcategory": "Private access",
            "text": "If your security policy requires you to use a private IP address for the OpenShift API, deploy a private ARO cluster.",
            "waf": "Security"
        },
        {
            "category": "Network topology and connectivity",
            "checklist": "Azure Red Hat OpenShift",
            "guid": "ab039da6-d54d-47c8-a29d-b107d5325ae6",
            "link": "https://learn.microsoft.com/azure/container-registry/container-registry-private-link",
            "services": [
                "ACR",
                "PrivateLink"
            ],
            "severity": "Medium",
            "subcategory": "Private access",
            "text": "Use Azure Private Link to secure network connections to managed Azure services, including to Azure Container Registry.",
            "waf": "Security"
        },
        {
            "category": "Operations management",
            "checklist": "Azure Red Hat OpenShift",
            "guid": "25ca44e4-685e-4222-9ace-8bb12307ca5f",
            "link": "https://learn.microsoft.com/azure/azure-monitor/containers/container-insights-enable-arc-enabled-clusters",
            "services": [
                "Monitor"
            ],
            "severity": "High",
            "subcategory": "Operations",
            "text": "Establish a monitoring process using the inbuilt Prometheus, OpenShift Logging or Container Insights integration.",
            "waf": "Operations"
        },
        {
            "category": "Operations management",
            "checklist": "Azure Red Hat OpenShift",
            "guid": "16f154e3-aa36-4928-89e7-e216183687af",
            "link": "https://docs.openshift.com/container-platform/4.13/cicd/pipelines/understanding-openshift-pipelines.html",
            "services": [],
            "severity": "Medium",
            "subcategory": "Operations",
            "text": "Automate the application delivery process through DevOps practices and CI/CD solutions, such as Pipelines/GitOps provided by OpenShift.",
            "waf": "Operations"
        },
        {
            "category": "Operations management",
            "checklist": "Azure Red Hat OpenShift",
            "guid": "467a1f89-35bd-4a43-924f-14811533182a",
            "link": "https://learn.microsoft.com/azure/architecture/guide/design-principles/managed-services",
            "services": [],
            "severity": "Low",
            "subcategory": "Operations",
            "text": "Whenever possible, remove the service state from inside containers. Instead, use an Azure platform as a service (PaaS) that supports multiregion replication.",
            "waf": "Operations"
        },
        {
            "category": "Operations management",
            "checklist": "Azure Red Hat OpenShift",
            "guid": "1b7da8cf-aa66-4e15-b4d5-ada97dc3e232",
            "link": "https://learn.microsoft.com/azure/openshift/howto-create-a-storageclass",
            "services": [
                "Storage"
            ],
            "severity": "Low",
            "subcategory": "Operations",
            "text": "Use RWX storage with inbuilt Azure Files storage class.",
            "waf": "Operations"
        },
        {
            "category": "Operations management",
            "checklist": "Azure Red Hat OpenShift",
            "guid": "6bb235c7-05e1-4696-bded-fa8a4c8cdec4",
            "link": "https://docs.openshift.com/container-platform/4.13/nodes/clusters/nodes-cluster-limit-ranges.html",
            "services": [],
            "severity": "Medium",
            "subcategory": "Performance",
            "text": "Use pod requests and limits to manage the compute resources within a cluster.",
            "waf": "Performance"
        },
        {
            "category": "Operations management",
            "checklist": "Azure Red Hat OpenShift",
            "guid": "c620c30c-14ee-4b7f-9ae8-d9b3fec228e7",
            "link": "https://docs.openshift.com/container-platform/4.13/applications/quotas/quotas-setting-per-project.html",
            "services": [],
            "severity": "Medium",
            "subcategory": "Performance",
            "text": "Enforce resource quotas on projects.",
            "waf": "Performance"
        },
        {
            "category": "Operations management",
            "checklist": "Azure Red Hat OpenShift",
            "guid": "87ab177a-db59-4f6b-a613-334fd09dc234",
            "link": "https://docs.openshift.com/container-platform/4.13/machine_management/applying-autoscaling.html",
            "services": [],
            "severity": "High",
            "subcategory": "Performance",
            "text": "Define ClusterAutoScaler and MachineAutoScaler to scale machines when your cluster runs out of resources to support more deployments.",
            "waf": "Performance"
        },
        {
            "category": "Operations management",
            "checklist": "Azure Red Hat OpenShift",
            "guid": "19db6128-1269-4040-a4ba-4d3e0804276d",
            "link": "https://learn.microsoft.com/azure/openshift/support-policies-v4#supported-virtual-machine-sizes",
            "services": [
                "VM"
            ],
            "severity": "High",
            "subcategory": "Reliability",
            "text": "Use virtual machine sizes that are large enough to contain multiple container instances so you get the benefits of increased density, but not so large that your cluster can't handle the workload of a failing node.",
            "waf": "Reliability"
        },
        {
            "category": "Operations management",
            "checklist": "Azure Red Hat OpenShift",
            "guid": "4b98b15c-8b31-4aa5-aceb-58889135e227",
            "link": "https://docs.openshift.com/container-platform/4.13/machine_management/deploying-machine-health-checks.html",
            "services": [],
            "severity": "High",
            "subcategory": "Reliability",
            "text": "Deploy machine health checks to automatically repair damaged machines in a machine pool.",
            "waf": "Reliability"
        },
        {
            "category": "Operations management",
            "checklist": "Azure Red Hat OpenShift",
            "guid": "896d31b6-6c67-4ba5-a119-c08e8f5d587c",
            "link": "https://learn.microsoft.com/azure/azure-monitor/containers/container-insights-metric-alerts",
            "services": [
                "Monitor"
            ],
            "severity": "High",
            "subcategory": "Reliability",
            "text": "Use an alerting system to provide notifications when things need direct action: Container Insights metric alerts or in-built Alerting UI.",
            "waf": "Reliability"
        },
        {
            "category": "Operations management",
            "checklist": "Azure Red Hat OpenShift",
            "guid": "7e9ced16-acd1-476e-b9b2-41a998a57ae7",
            "link": "https://learn.microsoft.com/azure/reliability/availability-zones-overview#availability-zones",
            "services": [],
            "severity": "High",
            "subcategory": "Reliability",
            "text": "Ensure that the cluster is created in a region that supports AZs and create a machine set for each AZ.",
            "waf": "Reliability"
        },
        {
            "category": "Operations management",
            "checklist": "Azure Red Hat OpenShift",
            "guid": "7b997e71-1b7d-4a8c-baa6-6e15d4d5ada9",
            "link": "https://docs.openshift.com/container-platform/4.13/machine_management/creating-infrastructure-machinesets.html",
            "services": [
                "AKS"
            ],
            "severity": "Low",
            "subcategory": "Reliability",
            "text": "Create infrastructure machine sets to hold infrastructure components. Apply specific Kubernetes labels to these machines and then update the infrastructure components to run on only those machines.",
            "waf": "Reliability"
        },
        {
            "category": "Operations management",
            "checklist": "Azure Red Hat OpenShift",
            "guid": "7dc3e232-6bb2-435c-905e-1696fdedfa8a",
            "link": "https://learn.microsoft.com/azure/openshift/howto-create-a-backup#create-a-backup-with-velero-to-include-snapshots",
            "services": [
                "Backup"
            ],
            "severity": "Medium",
            "subcategory": "Reliability",
            "text": "Create application backup and plan for restore and include persistent volumes in the backup.",
            "waf": "Reliability"
        },
        {
            "category": "Operations management",
            "checklist": "Azure Red Hat OpenShift",
            "guid": "81c12318-1a64-4174-8583-3fb4ae3c2df7",
            "link": "https://docs.openshift.com/container-platform/4.13/nodes/pods/nodes-pods-priority.html",
            "services": [],
            "severity": "Low",
            "subcategory": "Reliability",
            "text": "Use pod priorities, so that in case of limited resources the most critical pods will run.",
            "waf": "Reliability"
        },
        {
            "category": "Operations management",
            "checklist": "Azure Red Hat OpenShift",
            "guid": "43166c3b-cbe0-45bb-b209-d4a0da577784",
            "link": "https://docs.openshift.com/container-platform/4.13/architecture/admission-plug-ins.html",
            "services": [
                "AzurePolicy"
            ],
            "severity": "Low",
            "subcategory": "Security",
            "text": "Regulate cluster functions using admission plug-ins, which are commonly used to enforce security policy, resource limitations, or configuration requirements.",
            "waf": "Security"
        },
        {
            "category": "Operations management",
            "checklist": "Azure Red Hat OpenShift",
            "guid": "24d21678-5d2f-4a56-a56a-d48408fe8273",
            "link": "https://learn.microsoft.com/azure/container-registry/container-registry-geo-replication",
            "services": [
                "ACR"
            ],
            "severity": "Low",
            "subcategory": "Security",
            "text": "Store your container images in Azure Container Registry and geo-replicate the registry to each region.",
            "waf": "Security"
        },
        {
            "category": "Operations management",
            "checklist": "Azure Red Hat OpenShift",
            "guid": "4c486ba2-80dc-4059-8cf7-5ee8e1309ccc",
            "link": "https://docs.openshift.com/container-platform/4.13/nodes/pods/nodes-pods-vertical-autoscaler.html",
            "services": [],
            "severity": "Medium",
            "subcategory": "Workload",
            "text": "Optimize the CPU and memory request values, and maximize the efficiency of the cluster resources using vertical pod autoscaler.",
            "waf": "Performance"
        },
        {
            "category": "Operations management",
            "checklist": "Azure Red Hat OpenShift",
            "guid": "d579366b-cda2-4750-aa1a-bfe9d55d14c3",
            "link": "https://docs.openshift.com/container-platform/4.13/applications/application-health.html",
            "services": [
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Workload",
            "text": "Add health probes to your pods to monitor application health. Make sure pods contain livenessProbe and readinessProbe. Use Startup probes to determine the point at which the application has started up.",
            "waf": "Reliability"
        },
        {
            "category": "Operations management",
            "checklist": "Azure Red Hat OpenShift",
            "guid": "c4929cb1-b3d1-4325-ae12-4ba34d0685ed",
            "link": "https://docs.openshift.com/container-platform/4.13/nodes/pods/nodes-pods-autoscaling.html",
            "services": [],
            "severity": "Medium",
            "subcategory": "Workload",
            "text": "Scale pods to meet demand using horizontal pod autoscaler.",
            "waf": "Reliability"
        },
        {
            "category": "Operations management",
            "checklist": "Azure Red Hat OpenShift",
            "guid": "dce9be3b-b0dd-4b3b-95fb-2ec14eeaa359",
            "link": "https://docs.openshift.com/container-platform/4.13/nodes/pods/nodes-pods-configuring.html#nodes-pods-pod-distruption-about_nodes-pods-configuring",
            "services": [
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Workload",
            "text": "Use disruption budgets to ensure the required number of pod replicas exist to handle expected application load.",
            "waf": "Reliability"
        },
        {
            "category": "Operations management",
            "checklist": "Azure Red Hat OpenShift",
            "guid": "2829e2ed-b217-4367-9aff-6791b4935ada",
            "link": "https://docs.openshift.com/container-platform/4.13/nodes/scheduling/nodes-scheduler-pod-topology-spread-constraints.html",
            "services": [],
            "severity": "Medium",
            "subcategory": "Workload",
            "text": "Use pod topology constraints to automatically schedule pods on nodes throughout the cluster.",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Azure Red Hat OpenShift",
            "guid": "fea1dbf3-dd95-4d48-a7c8-91dcb1f7d575",
            "link": "https://learn.microsoft.com/azure/openshift/intro-openshift#service-level-agreement",
            "services": [],
            "severity": "Medium",
            "subcategory": "Availablity",
            "text": "Leverage Current ARO SLA - 99.95 into BCDR planning",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Azure Red Hat OpenShift",
            "guid": "b95e06e1-58e2-4ea3-a92c-2de6e2065b3a",
            "link": "https://www.redhat.com/rhdc/managed-files/pa-getting-started-azure-openshift-ebook-f20686-201911-en_0.pdf",
            "services": [],
            "severity": "High",
            "subcategory": "Cluster Design",
            "text": "Run user workloads on the worker nodes, not the control plane nodes",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Azure Red Hat OpenShift",
            "description": "Create infrastructure machine sets to hold infrastructure components. Apply specific Kubernetes labels to these machines and then update the infrastructure components to run on only those machines",
            "guid": "76af4a69-1e88-439a-ba46-667e13c10567",
            "link": "https://learn.microsoft.com/azure/openshift/howto-segregate-machinesets",
            "services": [
                "VNet",
                "AKS"
            ],
            "severity": "Medium",
            "subcategory": "Cluster Design",
            "text": "Isolate workloads into worker nodes running in individual subnets as needed",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Azure Red Hat OpenShift",
            "guid": "785c6fe9-6c96-4ad8-a44c-f3b2b38c886b",
            "link": "https://learn.microsoft.com/azure/openshift/howto-create-a-backup",
            "services": [
                "Backup"
            ],
            "severity": "Medium",
            "subcategory": "Backup",
            "text": "Backup a cluster state for stateful workload scenarios to a paired region",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Azure Red Hat OpenShift",
            "guid": "a2c02149-9014-4a5d-9ce5-74dccbd9792a",
            "link": "https://access.redhat.com/documentation/red_hat_openshift_container_storage/4.4/html/deploying_and_managing_openshift_container_storage_on_microsoft_azure/deploying-openshift-container-storage-on-microsoft-azure_rhocs",
            "services": [
                "ACR",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Data Store",
            "text": "If container storage is required, ensure availability across regions if needed: Using RWX storage with inbuilt Azure Files storage class. Using CSI Drivers for storage provisioning",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Azure Red Hat OpenShift",
            "guid": "6bcca2b4-fea1-4dbf-9dd9-5d48c7c891dc",
            "link": "https://docs.openshift.com/aro/3/dev_guide/persistent_volumes.html",
            "services": [],
            "severity": "Medium",
            "subcategory": "Data Store",
            "text": "Whenever possible, move state out of containers and into external databases that support multi-region replication. Avoid Persistent Volumes",
            "waf": "Reliability"
        },
        {
            "category": "Platform Automation",
            "checklist": "Azure Red Hat OpenShift",
            "guid": "42324ece-81c1-4231-a1a6-417415833fb4",
            "link": "https://docs.openshift.com/container-platform/4.13/applications/deployments/route-based-deployment-strategies.html",
            "services": [],
            "severity": "Low",
            "subcategory": "Workload",
            "text": "Consider blue/green or canary strategies to deploy new releases of application.",
            "waf": "Operations"
        },
        {
            "category": "Platform Automation",
            "checklist": "Azure Red Hat OpenShift",
            "guid": "ae3c2df7-4316-46c3-acbe-05bbe209d4a0",
            "link": "https://docs.openshift.com/container-platform/4.13/cicd/gitops/understanding-openshift-gitops.html",
            "services": [],
            "severity": "Low",
            "subcategory": "Workload",
            "text": "Consider using Red Hat OpenShift GitOps. Red Hat OpenShift GitOps uses Argo CD to maintain cluster resources and support application CI/CD.",
            "waf": "Operations"
        },
        {
            "category": "Security",
            "checklist": "Azure Red Hat OpenShift",
            "guid": "da577784-24d2-4167-a5d2-fa56c56ad484",
            "link": "https://learn.microsoft.com/azure/openshift/support-lifecycle",
            "services": [],
            "severity": "High",
            "subcategory": "Control plane",
            "text": "Keep your clusters on the latest OpenShift version to avoid potential security or upgrade issues.",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Red Hat OpenShift",
            "guid": "08fe8273-4c48-46ba-880d-c0591cf75ee8",
            "link": "https://learn.microsoft.com/azure/azure-arc/kubernetes/quickstart-connect-cluster",
            "services": [
                "AKS",
                "Arc"
            ],
            "severity": "High",
            "subcategory": "Control plane",
            "text": "Connect Azure Red Hat OpenShift clusters to Azure Arc-enabled Kubernetes.",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Red Hat OpenShift",
            "guid": "e1309ccc-d579-4366-acda-2750aa1abfe9",
            "link": "https://docs.openshift.com/container-platform/4.10/security/encrypting-etcd.html",
            "services": [],
            "severity": "Low",
            "subcategory": "Encryption",
            "text": "For Azure Red Hat OpenShift 4 clusters, etcd data isn't encrypted by default, but it's recommended to enable etcd encryption to provide another layer of data security.",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Red Hat OpenShift",
            "guid": "d55d14c3-c492-49cb-8b3d-1325ae124ba3",
            "link": "https://learn.microsoft.com/azure/defender-for-cloud/defender-for-containers-introduction",
            "services": [
                "AKS",
                "Arc",
                "Defender"
            ],
            "severity": "Medium",
            "subcategory": "Posture",
            "text": "Use Microsoft Defender for Containers supported via Arc-enabled Kubernetes to secure clusters, containers, and applications.",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Red Hat OpenShift",
            "guid": "4d0685ed-dce9-4be3-ab0d-db3b55fb2ec1",
            "link": "https://learn.microsoft.com/azure/azure-arc/kubernetes/tutorial-akv-secrets-provider",
            "services": [
                "AKV",
                "AKS",
                "Arc"
            ],
            "severity": "Medium",
            "subcategory": "Secrets",
            "text": "For applications that require access to sensitive information, use a service principal and the AKV Secrets Provider with the extension for Arc-enabled Kubernetes clusters.",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Red Hat OpenShift",
            "guid": "4eeaa359-2829-4e2e-bb21-73676aff6791",
            "link": "https://learn.microsoft.com/azure/aks/developer-best-practices-pod-security#secure-pod-access-to-resources",
            "services": [],
            "severity": "Medium",
            "subcategory": "Workload",
            "text": "Secure pod access to resources. Provide the least number of permissions, and avoid using root or privileged escalation.",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Red Hat OpenShift",
            "guid": "b4935ada-4232-44ec-b81c-123181a64174",
            "link": "https://learn.microsoft.com/azure/governance/policy/concepts/policy-for-kubernetes#install-azure-policy-extension-for-azure-arc-enabled-kubernetes",
            "services": [
                "AzurePolicy",
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Workload",
            "text": "Monitor and enforce configuration by using the Azure Policy Extension.",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Red Hat OpenShift",
            "guid": "15833fb4-ae3c-42df-9431-66c3bcbe05bb",
            "link": "https://learn.microsoft.com/azure/defender-for-cloud/defender-for-containers-introduction",
            "services": [
                "Defender"
            ],
            "severity": "High",
            "subcategory": "Workload",
            "text": "Scan your images for vulnerabilities with Microsoft Defender or any other image scanning solution.",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Red Hat OpenShift",
            "guid": "e209d4a0-da57-4778-924d-216785d2fa56",
            "link": "https://learn.microsoft.com/azure/container-registry/container-registry-private-link",
            "services": [
                "Subscriptions",
                "ACR"
            ],
            "severity": "Low",
            "subcategory": "Workload",
            "text": "Deploy a dedicated and private instance of Azure Container Registry to each landing zone subscription.",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "guid": "b71ca41b-3a80-48f3-a6cd-22cdf197c1cf",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/resource-org-management-groups#management-groups-in-the-azure-landing-zone-accelerator",
            "services": [],
            "severity": "Medium",
            "subcategory": "App delivery",
            "text": "Perform app delivery within landing zones for both internal-facing (corp) and external-facing apps (online).",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "graph": "resources | where type == 'microsoft.network/applicationgateways' | project id, compliant = properties.sku.name in ('Standard_v2', 'WAF_v2') | project id,compliant",
            "guid": "553585a6-abe0-11ed-afa1-0242ac120002",
            "link": "https://learn.microsoft.com/azure/application-gateway/overview-v2",
            "service": "App Gateway",
            "services": [
                "AppGW"
            ],
            "severity": "Medium",
            "subcategory": "App Gateway",
            "text": "Ensure you are using Application Gateway v2 SKU",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "graph": "resources | where type == 'microsoft.network/loadbalancers' | project id, compliant=(tolower(sku.name) == 'standard')",
            "guid": "4e35fbf5-0ae2-48b2-97ce-753353edbd1a",
            "link": "https://learn.microsoft.com/azure/load-balancer/load-balancer-overview",
            "service": "Load Balancer",
            "services": [
                "LoadBalancer"
            ],
            "severity": "Medium",
            "subcategory": "Load Balancer",
            "text": "Ensure you are using the Standard SKU for your Azure Load Balancers",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "guid": "9432621a-8397-4654-a882-5bc856b7ef83",
            "link": "https://learn.microsoft.com/azure/load-balancer/load-balancer-standard-availability-zones",
            "service": "Load Balancer",
            "services": [
                "LoadBalancer"
            ],
            "severity": "Medium",
            "subcategory": "Load Balancer",
            "text": "Ensure your Load Balancers frontend IP addresses are zone-redundant (unless you require zonal frontends).",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "graph": "resources | where type=='microsoft.network/applicationgateways' | extend subnetId = tostring(properties.gatewayIPConfigurations[0].properties.subnet.id) | project id, subnetId | join (resources | where type=='microsoft.network/virtualnetworks' | project id,subnets=properties.subnets | mv-expand subnets | mv-expand subnets.properties.addressPrefixes | project id, subnetId = tostring(subnets.id), prefix1 = subnets.properties.addressPrefix, prefix2 = subnets.properties.addressPrefixes | mv-expand prefix2 | extend prefix = iff(isnotnull(prefix1), prefix1, prefix2) | extend subnetPrefixLength = split(prefix, '/')[1])on subnetId | extend compliant = (subnetPrefixLength <= 24 or subnetPrefixLength == 64) | distinct id,compliant",
            "guid": "dfc50f87-3800-424c-937b-ed5f186e7c15",
            "link": "https://learn.microsoft.com/azure/application-gateway/configuration-infrastructure#size-of-the-subnet",
            "service": "App Gateway",
            "services": [
                "VNet",
                "AppGW"
            ],
            "severity": "Medium",
            "subcategory": "App Gateway",
            "text": "Your Application Gateways v2 should be deployed in subnets with IP prefixes equal or larger than /24",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "description": "Administration of reverse proxies in general and WAF in particular is closer to the application than to networking, so they belong in the same subscription as the app. Centralizing the Application Gateway and WAF in the connectivity subscription might be OK if it is managed by one single team.",
            "guid": "48b662d6-d15f-4512-a654-98f6dfe237de",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "service": "App Gateway",
            "services": [
                "WAF",
                "VNet",
                "Entra",
                "Subscriptions",
                "NVA",
                "AppGW"
            ],
            "severity": "Medium",
            "subcategory": "App Gateway",
            "text": "Deploy Azure Application Gateway v2 or partner NVAs used for proxying inbound HTTP(S) connections within the landing-zone virtual network and with the apps that they're securing.",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "guid": "f109e1f3-c79b-4f14-82de-6b5c22314d08",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "service": "App Gateway",
            "services": [
                "DDoS"
            ],
            "severity": "Medium",
            "subcategory": "App Gateway",
            "text": "Use a DDoS Network or IP protection plans for all Public IP addresses in application landing zones.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "graph": "resources | where type =~ 'microsoft.network/applicationGateways' | extend compliant = (isnotnull(properties.autoscaleConfiguration) and properties.autoscaleConfiguration.minCapacity >= 2) | distinct id,compliant",
            "guid": "135bf4ac-f9db-461f-b76b-2ee9e30b12c0",
            "link": "https://learn.microsoft.com/azure/application-gateway/application-gateway-autoscaling-zone-redundant",
            "service": "App Gateway",
            "services": [],
            "severity": "Medium",
            "subcategory": "App Gateway",
            "text": "Configure autoscaling with a minimum amount of instances of two.",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "Reliability"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "graph": "resources | where type =~ 'microsoft.network/applicationGateways' | extend compliant = (isnotnull(zones) and array_length(zones) > 1) | distinct id,compliant",
            "guid": "060c6964-52b5-48db-af8b-83e4b2d85349",
            "link": "https://learn.microsoft.com/azure/reliability/migrate-app-gateway-v2",
            "service": "App Gateway",
            "services": [
                "ACR",
                "AppGW"
            ],
            "severity": "Medium",
            "subcategory": "App Gateway",
            "text": "Deploy Application Gateway across Availability Zones",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "Reliability"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "guid": "3f29812b-2363-4cef-b179-b599de0d5973",
            "link": "https://learn.microsoft.com/azure/ddos-protection/ddos-protection-overview",
            "service": "Front Door",
            "services": [
                "AzurePolicy",
                "WAF",
                "FrontDoor",
                "AppGW"
            ],
            "severity": "Medium",
            "subcategory": "App delivery",
            "text": "When using Front Door and Application Gateway to help protect HTTP/S apps, use WAF policies in Front Door. Lock down Application Gateway to receive traffic only from Front Door.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Security"
        },
        {
            "ammp": true,
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "guid": "cd4cd21b-0881-437f-9e6c-4cfd3e504547",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "service": "Traffic Manager",
            "services": [
                "TrafficManager"
            ],
            "severity": "High",
            "subcategory": "Traffic Manager",
            "text": "Use Traffic Manager to deliver global apps that span protocols other than HTTP/S.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Reliability"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "guid": "3b4b3e88-a459-4ed5-a22f-644dfbc58204",
            "link": "https://learn.microsoft.com/azure/active-directory/app-proxy/application-proxy#how-application-proxy-works",
            "service": "Entra",
            "services": [
                "AVD",
                "Entra"
            ],
            "severity": "Low",
            "subcategory": "App delivery",
            "text": "If users only need access to internal applications, has Microsoft Entra ID Application Proxy been considered as an alternative to Azure Virtual Desktop (AVD)?",
            "training": "https://learn.microsoft.com/learn/modules/configure-azure-ad-application-proxy/",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "guid": "01ca7cf1-5754-442d-babb-8ba6772e5c30",
            "link": "https://learn.microsoft.com/azure/active-directory/app-proxy/application-proxy#how-application-proxy-works",
            "service": "Entra",
            "services": [
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "App delivery",
            "text": "To reduce the number of firewall ports open for incoming connections in your network, consider using Microsoft Entra ID Application Proxy to give remote users secure and authenticated access to internal applications.",
            "training": "https://learn.microsoft.com/learn/paths/implement-applications-external-access-azure-ad/",
            "waf": "Security"
        },
        {
            "ammp": true,
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "graph": "resources | where type=='microsoft.network/loadbalancers' | extend countOutRules=array_length(properties.outboundRules) | extend compliant = (countOutRules == 0) | distinct id,compliant",
            "guid": "97a2fd46-64b0-1dfa-b72d-9c8869496d75",
            "link": "https://learn.microsoft.com/azure/nat-gateway/nat-overview#outbound-connectivity",
            "service": "Load Balancer",
            "services": [
                "LoadBalancer"
            ],
            "severity": "High",
            "subcategory": "Load Balancer",
            "text": "Use Azure NAT Gateway instead of Load Balancer outbound rules for better SNAT scalability",
            "waf": "Reliability"
        },
        {
            "ammp": true,
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "graph": "resources | where type == 'microsoft.network/applicationgatewaywebapplicationfirewallpolicies' | mv-expand properties.managedRules.managedRuleSets | project id, rulesettype = properties_managedRules_managedRuleSets.ruleSetType | extend compliant1 = (rulesettype == 'Microsoft_BotManagerRuleSet') | project id, compliant1 | summarize compliant = max(compliant1) by id",
            "guid": "2f8e81eb-8e68-4026-8b1f-70f9b05f7cf9",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/bot-protection",
            "service": "App Gateway",
            "services": [
                "WAF",
                "AppGW"
            ],
            "severity": "High",
            "subcategory": "App Gateway",
            "text": "Enable the Azure Application Gateway WAF bot protection rule set. The bot rules detect good and bad bots.",
            "waf": "Security"
        },
        {
            "ammp": true,
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "graph": "resources | where type =~ 'microsoft.network/applicationgatewaywebapplicationfirewallpolicies' | extend compliant = (properties['policySettings']['requestBodyCheck'] == 'true' and properties['policySettings']['state'] =~ 'Enabled') | distinct id, name, compliant",
            "guid": "8ea8e0d4-84e8-4b33-aeab-493f6391b4d6",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/application-gateway-waf-request-size-limits#request-body-inspection",
            "service": "App Gateway",
            "services": [
                "AzurePolicy",
                "WAF",
                "AppGW"
            ],
            "severity": "High",
            "subcategory": "App Gateway",
            "text": "Ensure if request body inspection feature is enabled in Azure Application Gateway WAF policy.",
            "waf": "Security"
        },
        {
            "ammp": true,
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "guid": "a4dd86d3-5ffa-408c-b660-cce073d085b8",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/best-practices#tune-your-waf",
            "service": "App Gateway",
            "services": [
                "WAF",
                "AppGW"
            ],
            "severity": "High",
            "subcategory": "App Gateway",
            "text": "Tune the Azure Application Gateway WAF in detection mode for your workload. Reduce false positive detections.",
            "waf": "Security"
        },
        {
            "ammp": true,
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "guid": "baf8e317-2397-4d49-b3d1-0dcc16d8778d",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/policy-overview?source=recommendations",
            "service": "App Gateway",
            "services": [
                "AzurePolicy",
                "WAF",
                "AppGW"
            ],
            "severity": "High",
            "subcategory": "App Gateway",
            "text": "Deploy your WAF policy for Application Gateway in 'Prevention' mode.",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "guid": "43fae595-8a32-4299-a69e-0f32c454dcc9",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/rate-limiting-overview",
            "service": "App Gateway",
            "services": [
                "WAF",
                "AppGW"
            ],
            "severity": "Medium",
            "subcategory": "App Gateway",
            "text": "Add rate limiting to the Azure Application Gateway WAF. Rate limiting blocks clients accidentally or intentionally sending large amounts of traffic in a short period of time.",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "guid": "041e0ad8-7b12-4694-a0b7-a0e25ee2470f",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/rate-limiting-overview#rate-limiting-details",
            "service": "App Gateway",
            "services": [
                "WAF",
                "AppGW"
            ],
            "severity": "Medium",
            "subcategory": "App Gateway",
            "text": "Use a high threshold for Azure Application Gateway WAF rate limits. High rate limit thresholds avoid blocking legitimate traffic, while still providing protection against extremely high numbers of requests that might overwhelm your infrastructure. ",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "guid": "99937189-ff78-492a-b9ca-18d828d82b37",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/best-practices#geo-filtering-best-practices",
            "service": "App Gateway",
            "services": [],
            "severity": "Low",
            "subcategory": "App Gateway",
            "text": "If you are not expecting traffic from all geographical regions, use geo-filters to block traffic from non-expected countries.",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "guid": "349a15c1-52f4-4319-9078-3895d95ecafd",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/geomatch-custom-rules",
            "service": "App Gateway",
            "services": [
                "WAF",
                "AppGW"
            ],
            "severity": "Medium",
            "subcategory": "App Gateway",
            "text": "Specify the unknown (ZZ) location when geo-filtering traffic with the Azure Application Gateway WAF. Avoid accidentally blocking legitimate requests when IP addresses can't be geo-matched.",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "guid": "6c19dfd5-a61c-436c-9001-491b9b3d0228",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/best-practices#use-the-latest-ruleset-versions",
            "service": "App Gateway",
            "services": [
                "WAF",
                "AppGW"
            ],
            "severity": "Medium",
            "subcategory": "App Gateway",
            "text": "Use the latest Azure Application Gateway WAF rule set version. Rule set updates are regularly updated to take account of the current threat landscape.",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "guid": "f84106a2-2e9e-42ac-add6-d3416ecfed53",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/best-practices#add-diagnostic-settings-to-save-your-wafs-logs",
            "service": "App Gateway",
            "services": [
                "WAF",
                "AppGW"
            ],
            "severity": "Medium",
            "subcategory": "App Gateway",
            "text": "Add diagnostic settings to save your Azure Application Gateway WAF logs.",
            "waf": "Operations"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "guid": "92664c60-47e3-4591-8b1b-8d557656e686",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/best-practices#send-logs-to-microsoft-sentinel",
            "service": "App Gateway",
            "services": [
                "WAF",
                "Sentinel",
                "AppGW"
            ],
            "severity": "Medium",
            "subcategory": "App Gateway",
            "text": "Send Azure Application Gateway WAF logs to Microsoft Sentinel.",
            "waf": "Operations"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "guid": "ba0e9b26-6e0d-4ec8-8541-023c00afd5b7",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/best-practices#define-your-waf-configuration-as-code",
            "service": "App Gateway",
            "services": [
                "WAF",
                "AppGW"
            ],
            "severity": "Medium",
            "subcategory": "App Gateway",
            "text": "Define your Azure Application Gateway WAF configuration as code. By using code, you can more easily adopt new rule set version and gain additional protection.",
            "waf": "Operations"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "guid": "f17ec301-8470-4afd-aabc-c1fdfe47dcc0",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/policy-overview",
            "service": "App Gateway",
            "services": [
                "AzurePolicy",
                "WAF"
            ],
            "severity": "Medium",
            "subcategory": "App Gateway",
            "text": "Use WAF Policies instead of the legacy WAF configuration.",
            "waf": "Operations"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "guid": "d4eb8667-f8cb-4cdd-94e6-2f967ba98f88",
            "link": "https://learn.microsoft.com/azure/virtual-wan/scenario-secured-hub-app-gateway",
            "service": "App Gateway",
            "services": [
                "VNet",
                "ExpressRoute",
                "AppGW",
                "VPN"
            ],
            "severity": "Medium",
            "subcategory": "App Gateway",
            "text": "Filter inbound traffic in the backends so that they only accept connections from the Application Gateway subnet, for example with NSGs.",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "guid": "a66f0fd8-2ca4-422e-8df3-235148127ca2",
            "link": "https://learn.microsoft.com/azure/application-gateway/ssl-overview",
            "service": "App Gateway",
            "services": [],
            "severity": "High",
            "subcategory": "App Gateway",
            "text": "You should encrypt traffic to the backend servers.",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "guid": "3dba65cb-834d-44d8-a3ca-a6aa2f1587be",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/overview",
            "service": "App Gateway",
            "services": [
                "WAF"
            ],
            "severity": "High",
            "subcategory": "App Gateway",
            "text": "You should use a Web Application Firewall.",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "guid": "0158fcb6-0bc1-4687-832f-cc7c359c22d2",
            "link": "https://learn.microsoft.com/azure/application-gateway/redirect-overview",
            "service": "App Gateway",
            "services": [],
            "severity": "Medium",
            "subcategory": "App Gateway",
            "text": "Redirect HTTP to HTTPS",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "guid": "bb697864-1b4c-43af-8667-90cc69aaed5f",
            "link": "https://learn.microsoft.com/azure/application-gateway/how-application-gateway-works#modifications-to-the-request",
            "service": "App Gateway",
            "services": [],
            "severity": "Medium",
            "subcategory": "App Gateway",
            "text": "Use gateway-managed cookies to direct traffic from a user session to the same server for processing",
            "waf": "Operations"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "guid": "ff353ad8-15fb-4ae8-9fc5-a85a36d36a35",
            "link": "https://learn.microsoft.com/azure/application-gateway/configuration-http-settings",
            "service": "App Gateway",
            "services": [],
            "severity": "High",
            "subcategory": "App Gateway",
            "text": "Enable connection draining during planned service updates to prevent connection loss to existing members of the backend pool",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "guid": "c8741f03-45a4-4183-a6b8-139e0773b8b5",
            "link": "https://learn.microsoft.com/azure/application-gateway/custom-error",
            "service": "App Gateway",
            "services": [],
            "severity": "Low",
            "subcategory": "App Gateway",
            "text": "Create custom error pages to display a personalized user experience",
            "waf": "Operations"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "guid": "f850d46f-f5d7-4b17-b48c-a780741402e1",
            "link": "https://learn.microsoft.com/azure/application-gateway/rewrite-http-headers-url",
            "service": "App Gateway",
            "services": [],
            "severity": "Medium",
            "subcategory": "App Gateway",
            "text": "Edit HTTP requests and response headers for easier routing and information exchange between the client and server",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "guid": "eadc3164-4a0f-461c-85f1-1a372c04dfd1",
            "link": "https://learn.microsoft.com/azure/frontdoor/front-door-overview",
            "service": "App Gateway",
            "services": [
                "FrontDoor"
            ],
            "severity": "Medium",
            "subcategory": "App Gateway",
            "text": "Configure Front Door to optimize global web traffic routing and top-tier end-user performance, and reliability through quick global failover",
            "waf": "Performance"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "guid": "29dcc19f-a8fa-4c35-8281-290577538793",
            "link": "https://learn.microsoft.com/azure/load-balancer/load-balancer-overview",
            "service": "App Gateway",
            "services": [],
            "severity": "Medium",
            "subcategory": "App Gateway",
            "text": "Use transport layer load balancing",
            "waf": "Performance"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "guid": "276898c1-af5e-4819-9e8e-049c7801ab9d",
            "link": "https://learn.microsoft.com/azure/application-gateway/multiple-site-overview",
            "service": "App Gateway",
            "services": [],
            "severity": "Medium",
            "subcategory": "App Gateway",
            "text": "Configure routing based on host or domain name for multiple web applications on a single gateway",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "guid": "5fe365b6-58e8-47ed-a8cf-5163850380a2",
            "link": "https://learn.microsoft.com/azure/application-gateway/create-ssl-portal",
            "service": "App Gateway",
            "services": [
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "App Gateway",
            "text": "Centralize SSL certificate management to reduce encryption and decryption overhead from a backend server farm",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "guid": "fa64b4dd-35c2-4047-ac5c-45dfbf8b0db9",
            "link": "https://learn.microsoft.com/azure/application-gateway/application-gateway-websocket",
            "service": "App Gateway",
            "services": [
                "AppGW"
            ],
            "severity": "Low",
            "subcategory": "App Gateway",
            "text": "Use Application Gateway for native support for WebSocket and HTTP/2 protocols",
            "waf": "Security"
        },
        {
            "category": "Operations Management",
            "checklist": "PostgreSQL Review Checklist",
            "guid": "65285269-441c-44bf-9d3e-0844276d4bdc",
            "link": "https://learn.microsoft.com/azure/postgresql/flexible-server/overview",
            "service": "PostgreSQL",
            "services": [
                "SQL"
            ],
            "severity": "Medium",
            "subcategory": "Best Practices",
            "text": "Leverage Flexible Server",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "PostgreSQL Review Checklist",
            "guid": "016ccf31-ae5a-41eb-9888-9535e227896d",
            "link": "https://learn.microsoft.com/azure/postgresql/flexible-server/overview#architecture-and-high-availability",
            "service": "PostgreSQL",
            "services": [
                "SQL"
            ],
            "severity": "High",
            "subcategory": "Best Practices",
            "text": "Leverage Availability Zones where regionally applicable",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "PostgreSQL Review Checklist",
            "guid": "31b67c67-be59-4519-8083-845d587cb391",
            "link": "https://learn.microsoft.com/azure/postgresql/single-server/concepts-business-continuity#cross-region-read-replicas",
            "service": "PostgreSQL",
            "services": [
                "SQL"
            ],
            "severity": "Medium",
            "subcategory": "Best Practices",
            "text": "Leverage cross-region read replicas for BCDR",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Cognitive Services Review Checklist",
            "guid": "21c30d25-ffb7-4f6a-b9ea-b3fec328f787",
            "link": "https://github.com/Azure/fta-resiliencyplaybooks/blob/main/paas-foundations-playbooks-cog_svcs_v1.docx",
            "service": "Cognitive Services",
            "services": [],
            "severity": "Medium",
            "subcategory": "Best Practice",
            "text": "Leverage FTA HandBook for Cognitive Services",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Cognitive Services Review Checklist",
            "guid": "78c34698-16b2-4763-aefe-1b9b599de0d5",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/concepts/advanced-prompt-engineering?pivots=programming-language-chat-completions",
            "service": "Cognitive Services",
            "services": [
                "Backup"
            ],
            "severity": "Medium",
            "subcategory": "Backup",
            "text": "Backup Your Prompts",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Cognitive Services Review Checklist",
            "guid": "750ab2ab-039d-4a6d-95d7-c892adb107d5",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/business-continuity-disaster-recovery",
            "service": "Cognitive Services",
            "services": [
                "ASR",
                "Backup"
            ],
            "severity": "High",
            "subcategory": "Backup",
            "text": "Business Continuity and Disaster Recovery (BCDR) considerations with Azure OpenAI Service",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Cognitive Services Review Checklist",
            "guid": "325af625-ca44-4e46-a5e2-223ace8bb123",
            "link": "https://github.com/abacaj/chatgpt-backup#backup-your-chatgpt-conversations",
            "service": "Cognitive Services",
            "services": [
                "Backup"
            ],
            "severity": "Medium",
            "subcategory": "Backup",
            "text": "Backup Your ChatGPT conversations",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Cognitive Services Review Checklist",
            "guid": "07ca5f17-f154-4e3a-a369-2829e7e31618",
            "link": "https://learn.microsoft.com/azure/ai-services/speech-service/how-to-custom-speech-continuous-integration-continuous-deployment",
            "service": "Cognitive Services",
            "services": [],
            "severity": "Medium",
            "subcategory": "DevOps",
            "text": "CI/CD for custom speech",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Cognitive Services Review Checklist",
            "guid": "3687a046-7a1f-4893-9bda-43324f248116",
            "link": "https://learn.microsoft.com/azure/ai-services/qnamaker/tutorials/export-knowledge-base",
            "service": "Cognitive Services",
            "services": [],
            "severity": "Low",
            "subcategory": "QnA Service",
            "text": "Move a knowledge base using export-import",
            "waf": "Reliability"
        },
        {
            "category": "BC and DR",
            "checklist": "Logic Apps checklist",
            "guid": "3b7a56de-5020-4642-b3cb-c976e80b6d6d",
            "link": "https://learn.microsoft.com/azure/logic-apps/single-tenant-overview-compare",
            "service": "Logic Apps",
            "services": [],
            "severity": "High",
            "subcategory": "High Availability",
            "text": "Select the right Logic App hosting plan based on your business & SLO requirements",
            "waf": "Reliability"
        },
        {
            "category": "BC and DR",
            "checklist": "Logic Apps checklist",
            "guid": "3d7008bd-6bc1-4b03-8aa8-ec2a3b55786a",
            "link": "https://learn.microsoft.com/azure/logic-apps/set-up-zone-redundancy-availability-zones?tabs=standard#next-steps",
            "service": "Logic Apps",
            "services": [],
            "severity": "High",
            "subcategory": "High Availability",
            "text": "Protect logic apps from region failures with zone redundancy and availability zones",
            "waf": "Reliability"
        },
        {
            "category": "BC and DR",
            "checklist": "Logic Apps checklist",
            "guid": "1cda768f-a206-445d-8234-56f6a6e7286e",
            "link": "https://learn.microsoft.com/azure/logic-apps/business-continuity-disaster-recovery-guidance?toc=%2Fazure%2Freliability%2Ftoc.json&bc=%2Fazure%2Freliability%2Fbreadcrumb%2Ftoc.json",
            "service": "Logic Apps",
            "services": [],
            "severity": "High",
            "subcategory": "High Availability",
            "text": "Consider a Cross-Region DR strategy for critical workloads",
            "waf": "Reliability"
        },
        {
            "category": "BC and DR",
            "checklist": "Logic Apps checklist",
            "guid": "82118ec5-ed6f-4c68-9471-eb0da98a1b34",
            "link": "https://learn.microsoft.com/azure/app-service/environment/intro",
            "service": "Logic Apps",
            "services": [
                "AppSvc"
            ],
            "severity": "High",
            "subcategory": "High Availability",
            "text": "If deploying to an Isolated environment, use or migrate to App Service Environment (ASE) v3",
            "waf": "Reliability"
        },
        {
            "category": "Application Deployment",
            "checklist": "Logic Apps checklist",
            "guid": "74275fa5-9e08-4c7e-b096-13b538fe1501",
            "link": "https://learn.microsoft.com/training/modules/deploy-azure-functions/",
            "service": "Logic Apps",
            "services": [],
            "severity": "Medium",
            "subcategory": "CI/CD",
            "text": "Leverage Azure DevOps or GitHub to streamline CI/CD and safeguard your Logic App code",
            "waf": "Operations"
        },
        {
            "category": "BC and DR",
            "checklist": "Azure Function Review",
            "guid": "4238f409-2ea0-43be-a06b-2a993c98aa7b",
            "link": "https://learn.microsoft.com/en-us/azure/azure-functions/functions-scale#overview-of-plans",
            "service": "Azure Functions",
            "services": [],
            "severity": "High",
            "subcategory": "High Availability",
            "text": "Select the right Function hosting plan based on your business & SLO requirements",
            "waf": "Reliability"
        },
        {
            "category": "BC and DR",
            "checklist": "Azure Function Review",
            "guid": "a9808100-d640-4f77-ac56-1ec0600f6752",
            "link": "https://learn.microsoft.com/en-us/azure/azure-functions/functions-scale#overview-of-plans",
            "query": "resources | where type =~ 'Microsoft.Web/sites' and kind has 'functionapp' and tolower(kind) !contains 'workflow' | extend aspResourceId = tostring(properties.serverFarmId), managedEnvId = tostring(properties.managedEnvironmentId), sku = tostring(properties.sku) | extend sku = iif(isnotempty(sku), sku, iif(isnotempty(managedEnvId), 'ContainerApps', '')) | where sku !in ('Dynamic', 'FlexConsumption', '') | extend aspName = tostring(split(aspResourceId, '/').[-1]), managedEnvName = tostring(split(managedEnvId, '/').[-1]) | extend HostingPlan = tostring(iif(isnotempty(aspName), aspName, managedEnvName)) | project functionAppName = name, functionAppId = id, HostingPlan, sku | join kind=inner ( resources | where type =~ 'Microsoft.Web/serverfarms' or type =~ 'Microsoft.App/managedEnvironments' | extend HostingPlan = tostring(name), zoneRedundant = tostring(properties.zoneRedundant), compliant = tobool(properties.zoneRedundant) | project HostingPlan, resourceId = id, zoneRedundant, compliant ) on HostingPlan | project functionAppName, functionAppId, sku, HostingPlan, resourceId, zoneRedundant, compliant",
            "service": "Azure Functions",
            "services": [],
            "severity": "High",
            "subcategory": "High Availability",
            "text": "Leverage Availability Zones where regionally applicable (not available for Consumption tier)",
            "waf": "Reliability"
        },
        {
            "category": "BC and DR",
            "checklist": "Azure Function Review",
            "guid": "5969d03e-eacf-4042-b127-73c55e3575fa",
            "link": "https://learn.microsoft.com/en-us/azure/reliability/reliability-functions?tabs=azure-portal#cross-region-disaster-recovery-and-business-continuity",
            "service": "Azure Functions",
            "services": [],
            "severity": "Medium",
            "subcategory": "High Availability",
            "text": "Consider a Cross-Region DR strategy for critical workloads",
            "waf": "Reliability"
        },
        {
            "category": "BC and DR",
            "checklist": "Azure Function Review",
            "guid": "47a0aae0-d8a0-43b1-9791-e934dee3754c",
            "link": "https://learn.microsoft.com/en-us/azure/app-service/environment/intro",
            "service": "Azure Functions",
            "services": [
                "AppSvc"
            ],
            "severity": "High",
            "subcategory": "High Availability",
            "text": "If deploying to an Isolated environment, use or migrate to App Service Environment (ASE) v3",
            "waf": "Reliability"
        },
        {
            "category": "BC and DR",
            "checklist": "Azure Function Review",
            "guid": "17232891-f89f-4eaa-90f1-3b34bf798ed5",
            "link": "https://learn.microsoft.com/en-us/azure/azure-functions/dedicated-plan#always-on",
            "query": "resources | where type =~ 'Microsoft.Web/sites' and kind has 'functionapp' | where tolower(kind) !contains 'workflow' | where isnotempty(properties.serverFarmId) | extend sku = tostring(properties.sku) | where isnotempty(sku) | where sku !in ('Dynamic', 'FlexConsumption', 'ElasticPremium') | extend alwaysOn = properties.siteConfig.alwaysOn | project functionAppName = name, functionAppId = id, serverFarmId = tostring(properties.serverFarmId), sku, alwaysOn, compliant = tobool(alwaysOn)",
            "service": "Azure Functions",
            "services": [
                "AppSvc"
            ],
            "severity": "High",
            "subcategory": "High Availability",
            "text": "Ensure 'Always On' is enabled for all Function Apps running on App Service Plan",
            "waf": "Reliability"
        },
        {
            "category": "BC and DR",
            "checklist": "Azure Function Review",
            "guid": "40a325c2-7c0e-49e6-86d8-c273b4dc21ba",
            "link": "https://learn.microsoft.com/en-us/azure/azure-functions/storage-considerations?tabs=azure-cli#shared-storage-accounts",
            "service": "Azure Functions",
            "services": [
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "High Availability",
            "text": "Pair a Function App to its own storage account. Try not to re-use storage accounts for Function Apps unless they are tightly coupled",
            "waf": "Reliability"
        },
        {
            "category": "Application Deployment",
            "checklist": "Azure Function Review",
            "guid": "bb42650c-257d-4cb0-822a-131138b8e6f0",
            "link": "https://learn.microsoft.com/en-us/training/modules/deploy-azure-functions/",
            "service": "Azure Functions",
            "services": [],
            "severity": "Medium",
            "subcategory": "CI/CD",
            "text": "Leverage Azure DevOps or GitHub to streamline CI/CD and safeguard your Function App code",
            "waf": "Operations"
        },
        {
            "category": "Operations Management",
            "checklist": "CosmosDB Review Checklist",
            "guid": "43e52f47-22d9-428c-8b1c-d521e54a29a9",
            "link": "https://github.com/Azure/fta-resiliencyplaybooks/blob/main/pass-foundations-playbooks-CosmosDB_v1.docx",
            "service": "CosmosDB",
            "services": [
                "CosmosDB"
            ],
            "severity": "Medium",
            "subcategory": "Best Practices",
            "text": "FTA Resiliency Playbook",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "CosmosDB Review Checklist",
            "guid": "de39ac0e-7c28-4dc9-9565-7202bff4564b",
            "link": "https://learn.microsoft.com/azure/cosmos-db/high-availability#slas",
            "service": "CosmosDB",
            "services": [
                "CosmosDB"
            ],
            "severity": "High",
            "subcategory": "High Availability",
            "text": "Leverage Availablity Zones where regionally applicable and ofcourse if the service offers it",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "CosmosDB Review Checklist",
            "guid": "0d934a34-8b26-43e7-bd60-513a3649906e",
            "link": "https://learn.microsoft.com/azure/cosmos-db/high-availability#replica-outages",
            "service": "CosmosDB",
            "services": [
                "CosmosDB"
            ],
            "severity": "Medium",
            "subcategory": "High Availability",
            "text": "Run multiple replicas of the database (>1 ) in Prod",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "CosmosDB Review Checklist",
            "description": "Multi-region writes capability allows you to take advantage of the provisioned throughput for your databases and containers across the globe",
            "guid": "bad38ead-53cc-47de-8d8a-aab3571449ab",
            "link": "https://learn.microsoft.com/azure/cosmos-db/high-availability#multiple-write-regions",
            "service": "CosmosDB",
            "services": [
                "CosmosDB",
                "ACR"
            ],
            "severity": "Medium",
            "subcategory": "High Availability",
            "text": "Leverage Multi-Region Writes",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "CosmosDB Review Checklist",
            "description": "Span Cosmos account across two or more regions with multi-region writes",
            "guid": "8153d89f-89dc-47b3-9be2-b1a27f7b9e91",
            "link": "https://learn.microsoft.com/azure/cosmos-db/high-availability#slas",
            "service": "CosmosDB",
            "services": [
                "CosmosDB",
                "ACR"
            ],
            "severity": "Medium",
            "subcategory": "High Availability",
            "text": "Distribute your data globally",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "CosmosDB Review Checklist",
            "description": "Choose from various consistency levels such as Eventual, Consistent Prefix, Session, Bounded Staleness and strong",
            "guid": "9f8ea848-25ec-4140-bc32-2758e6ee9ac0",
            "link": "https://learn.microsoft.com/azure/cosmos-db/consistency-levels",
            "service": "CosmosDB",
            "services": [
                "CosmosDB"
            ],
            "severity": "High",
            "subcategory": "High Availability",
            "text": "Choose from several well-defined consistency models",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "CosmosDB Review Checklist",
            "description": "Maintain business continuity during regional outages. Azure Cosmos DB supports service-managed failover during a regional outage. During a regional outage, Azure Cosmos DB continues to maintain its latency, availability, consistency, and throughput SLAs. To help make sure that your entire application is highly available, Azure Cosmos DB offers a manual failover API to simulate a regional outage. By using this API, you can carry out regular business continuity drills.",
            "guid": "a47e4d1e-bb79-43f9-bf87-69e1032b72fe",
            "link": "https://learn.microsoft.com/azure/cosmos-db/how-to-manage-database-account#automatic-failover",
            "service": "CosmosDB",
            "services": [
                "CosmosDB"
            ],
            "severity": "Medium",
            "subcategory": "High Availability",
            "text": "Enable Service managed failover",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "CosmosDB Review Checklist",
            "description": "Azure Cosmos DB automatically takes backups of your data at regular intervals. The automatic backups are taken without affecting the performance or availability of the database operations. All the backups are stored separately in a storage service.",
            "guid": "3499c9c1-133d-42f7-a4b1-a5bd06ff1a90",
            "link": "https://learn.microsoft.com/azure/cosmos-db/online-backup-and-restore",
            "service": "CosmosDB",
            "services": [
                "CosmosDB",
                "Storage",
                "Backup"
            ],
            "severity": "Medium",
            "subcategory": "Backup Strategy",
            "text": "Enable Automatic Backups",
            "training": "https://learn.microsoft.com/learn/modules/explore-basic-services-identity-types/",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "CosmosDB Review Checklist",
            "description": "This mode is the default backup mode for all existing accounts. In this mode, backup is taken at a periodic interval and the data is restored by creating a request with the support team. In this mode, you configure a backup interval and retention for your account. The maximum retention period extends to a month. The minimum backup interval can be one hour.",
            "guid": "a6eb33f6-005c-4d92-9286-7655672d6121",
            "link": "https://learn.microsoft.com/azure/cosmos-db/periodic-backup-restore-introduction",
            "service": "CosmosDB",
            "services": [
                "CosmosDB",
                "Backup"
            ],
            "severity": "Medium",
            "subcategory": "Backup Strategy",
            "text": "Perform Periodic Backups",
            "training": "https://learn.microsoft.com/learn/paths/manage-identity-and-access/",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "CosmosDB Review Checklist",
            "description": "Continous 7 day retention and 30 day retention backups. Azure Cosmos DB performs data backup in the background without consuming any extra provisioned throughput (RUs) or affecting the performance and availability of your database. Continuous backups are taken in every region where the account exists.",
            "guid": "d43918a8-cd28-49be-b6b1-7cb8245461e1",
            "link": "https://learn.microsoft.com/azure/cosmos-db/continuous-backup-restore-introduction",
            "service": "CosmosDB",
            "services": [
                "CosmosDB",
                "Backup"
            ],
            "severity": "Medium",
            "subcategory": "Backup Strategy",
            "text": "Continous Backup with point-in-time restore in Azure Cosmos DB",
            "training": "https://learn.microsoft.com/learn/modules/create-custom-azure-roles-with-rbac/",
            "waf": "Reliability"
        },
        {
            "category": "Version Control",
            "checklist": "Azure DevOps",
            "description": "Implement branching policy in Azure DevOps",
            "guid": "eda1dae2-cc85-4c47-a6b7-81cca0e6c465",
            "link": "https://learn.microsoft.com/azure/devops/repos/git/branch-policies-overview?view=azure-devops",
            "services": [
                "AzurePolicy"
            ],
            "severity": "High",
            "subcategory": "Branching Policy",
            "text": "Branch Policies",
            "waf": "Operations"
        },
        {
            "category": "Version Control",
            "checklist": "Azure DevOps",
            "description": "Understand branch strategy such as GitFlow or GitHub Flow",
            "guid": "bc288bec-6a16-4ca7-8444-51e1add34529",
            "link": "https://learn.microsoft.com/azure/devops/repos/git/git-branching-guidance?view=azure-devops",
            "services": [
                "AzurePolicy"
            ],
            "severity": "High",
            "subcategory": "Branching Policy",
            "text": "Branching strategy",
            "waf": "Operations"
        },
        {
            "category": "Version Control",
            "checklist": "Azure DevOps",
            "description": "Understand how teams work with git",
            "guid": "ec723823-7a15-41c5-ab4e-401914387e5c",
            "link": "https://www.atlassian.com/git/tutorials/comparing-workflows/gitflow-workflow",
            "services": [
                "AzurePolicy"
            ],
            "severity": "High",
            "subcategory": "Branching Policy",
            "text": "Understand GitFlow Branch Strategy",
            "waf": "Operations"
        },
        {
            "category": "Version Control",
            "checklist": "Azure DevOps",
            "description": "Merge into higher branches after two or more reviewers in a PR",
            "guid": "a9c26c9c-32ab-45bd-8c69-98a246e33899",
            "link": "https://learn.microsoft.com/azure/devops/repos/git/review-pull-requests?view=azure-devops&tabs=browser",
            "services": [
                "AzurePolicy"
            ],
            "severity": "High",
            "subcategory": "Branching Policy",
            "text": "Pull Request Review",
            "waf": "Operations"
        },
        {
            "category": "Version Control",
            "checklist": "Azure DevOps",
            "description": "Implement access control to the branches",
            "guid": "7e41c77d-68cb-46a2-8ac1-9f916d697d8e",
            "link": "https://learn.microsoft.com/azure/devops/repos/git/branch-permissions?view=azure-devops",
            "services": [
                "AzurePolicy"
            ],
            "severity": "Medium",
            "subcategory": "Branching Policy",
            "text": "Access Control to the Branch",
            "waf": "Operations"
        },
        {
            "category": "Version Control",
            "checklist": "Azure DevOps",
            "description": "Perform SAST code scan",
            "guid": "adfd27bd-e187-401a-a252-baa9b68a088c",
            "link": "https://devblogs.microsoft.com/devops/integrate-security-into-your-developer-workflow-with-github-advanced-security-for-azure-devops/",
            "services": [],
            "severity": "High",
            "subcategory": "Security",
            "text": "Code Scan",
            "waf": "Security"
        },
        {
            "category": "Version Control",
            "checklist": "Azure DevOps",
            "description": "Understand TFVC as Code Repo",
            "guid": "9a8f822b-8eb9-4d1b-a77f-26e5e6beba8e",
            "link": "https://learn.microsoft.com/azure/devops/repos/tfvc/what-is-tfvc?view=azure-devops",
            "services": [],
            "severity": "Low",
            "subcategory": "Practice",
            "text": "TFVC as Code Repository",
            "waf": "Operations"
        },
        {
            "category": "Version Control",
            "checklist": "Azure DevOps",
            "description": "Compare Git vs TFVC for your project",
            "guid": "d4f3437b-c336-4d71-9f27-a71eee0b9b5d",
            "link": "https://learn.microsoft.com/azure/devops/repos/tfvc/comparison-git-tfvc?view=azure-devops",
            "services": [],
            "severity": "Low",
            "subcategory": "Practice",
            "text": "Choose Right version control",
            "waf": "Operations"
        },
        {
            "category": "Azure Boards",
            "checklist": "Azure DevOps",
            "description": "Set up your team management",
            "guid": "8defd5d7-21d4-41d2-900c-807bf9eab40f",
            "link": "https://learn.microsoft.com/azure/devops/organizations/settings/manage-teams?view=azure-devops",
            "services": [],
            "severity": "High",
            "subcategory": "Team Planning",
            "text": "Configure your teams",
            "waf": "Operations"
        },
        {
            "category": "Azure Boards",
            "checklist": "Azure DevOps",
            "description": "Start scheduling sprints",
            "guid": "9ed5b354-78d4-447a-a26c-2863c00f1cac",
            "link": "https://learn.microsoft.com/azure/devops/boards/sprints/define-sprints?view=azure-devops",
            "services": [],
            "severity": "Medium",
            "subcategory": "Team Planning",
            "text": "Configure your sprints",
            "waf": "Operations"
        },
        {
            "category": "Azure Boards",
            "checklist": "Azure DevOps",
            "description": "Set up your work item heirarchy",
            "guid": "699ef1d5-a83d-4e5d-b36c-1c81870a0bc5",
            "link": "https://learn.microsoft.com/azure/devops/organizations/settings/work/customize-process-work-item-type?view=azure-devops",
            "services": [],
            "severity": "Low",
            "subcategory": "Team Planning",
            "text": "Choose Work Item types",
            "waf": "Operations"
        },
        {
            "category": "Azure Boards",
            "checklist": "Azure DevOps",
            "description": "WIT Processes available in Azure DevOps",
            "guid": "c1e43a18-658d-4285-aed6-7179b825546d",
            "link": "https://learn.microsoft.com/azure/devops/boards/work-items/guidance/choose-process?view=azure-devops&tabs=agile-process",
            "services": [],
            "severity": "High",
            "subcategory": "Team Planning",
            "text": "Select a WIT Process",
            "waf": "Operations"
        },
        {
            "category": "Azure Boards",
            "checklist": "Azure DevOps",
            "description": "Use Azure Boards with GitHub",
            "guid": "f2aee455-3afc-4833-a248-726dd68c5b5c",
            "link": "https://learn.microsoft.com/azure/devops/cross-service/github-integration?view=azure-devops",
            "services": [],
            "severity": "Low",
            "subcategory": "Tool Integration",
            "text": "GitHub Integration",
            "waf": "Operations"
        },
        {
            "category": "Azure Boards",
            "checklist": "Azure DevOps",
            "description": "Understand the methologies",
            "guid": "2925394b-69b9-4d37-aac4-3bc68d1d7665",
            "link": "https://www.atlassian.com/agile/scrum/agile-vs-scrum",
            "services": [],
            "severity": "Medium",
            "subcategory": "Process Planning",
            "text": "Understand Agile Vs Scrum",
            "waf": "Operations"
        },
        {
            "category": "Azure Boards",
            "checklist": "Azure DevOps",
            "description": "Create Dashboard and PowerBI reports",
            "guid": "7246b448-564b-44dd-94a7-59c7633bd2a1",
            "link": "https://learn.microsoft.com/azure/devops/report/dashboards/overview?view=azure-devops",
            "services": [],
            "severity": "Medium",
            "subcategory": "Reporting",
            "text": "Dashboard",
            "waf": "Operations"
        },
        {
            "category": "Azure Boards",
            "checklist": "Azure DevOps",
            "description": "Set up backlog",
            "guid": "a27a764a-90be-40e3-98ee-293c1bd363ca",
            "link": "https://learn.microsoft.com/azure/devops/boards/backlogs/set-up-your-backlog?view=azure-devops",
            "services": [],
            "severity": "Medium",
            "subcategory": "Reporting",
            "text": "Refine your backlog",
            "waf": "Operations"
        },
        {
            "category": "Azure Boards",
            "checklist": "Azure DevOps",
            "description": "Link your work items",
            "guid": "aab75719-49ab-4919-9dc9-fc9d1bb84b37",
            "link": "https://learn.microsoft.com/azure/devops/boards/queries/link-work-items-support-traceability?view=azure-devops&tabs=browser",
            "services": [],
            "severity": "Medium",
            "subcategory": "Reporting",
            "text": "Visualize Relationships",
            "waf": "Operations"
        },
        {
            "category": "Azure Pipelines",
            "checklist": "Azure DevOps",
            "description": "View the velocity report",
            "guid": "b5a67fcb-9ed5-4b35-978d-447a826c2863",
            "link": "https://learn.microsoft.com/azure/devops/report/dashboards/team-velocity?view=azure-devops&tabs=in-context",
            "services": [],
            "severity": "Low",
            "subcategory": "Reporting",
            "text": "Review Team Velocity",
            "waf": "Operations"
        },
        {
            "category": "Azure Pipelines",
            "checklist": "Azure DevOps",
            "description": "Create your first pipeline",
            "guid": "c00f1cac-699e-4f1d-9a83-de5de36c1c81",
            "link": "https://learn.microsoft.com/azure/devops/pipelines/create-first-pipeline?view=azure-devops&tabs=java%2Ctfs-2018-2%2Cbrowser",
            "services": [],
            "severity": "High",
            "subcategory": "Continuous Integration",
            "text": "Set up pipeline",
            "waf": "Operations"
        },
        {
            "category": "Azure Pipelines",
            "checklist": "Azure DevOps",
            "description": "Specify events that trigger pipelines",
            "guid": "870a0bc5-c1e4-43a1-a658-d2858ed67179",
            "link": "https://learn.microsoft.com/azure/devops/pipelines/build/triggers?view=azure-devops",
            "services": [],
            "severity": "High",
            "subcategory": "Continuous Integration",
            "text": "Set Build triggers",
            "waf": "Operations"
        },
        {
            "category": "Azure Pipelines",
            "checklist": "Azure DevOps",
            "description": "Use YAML to create build pipeline",
            "guid": "b825546d-f2ae-4e45-93af-c8339248726d",
            "link": "https://learn.microsoft.com/azure/devops/pipelines/customize-pipeline?view=azure-devops",
            "services": [],
            "severity": "Low",
            "subcategory": "Continuous Integration",
            "text": "Customize YAML Pipeline",
            "waf": "Operations"
        },
        {
            "category": "Azure Pipelines",
            "checklist": "Azure DevOps",
            "description": "Use classic GUI editor to set up pipeline",
            "guid": "d68c5b5c-2925-4394-a69b-9d379ac43bc6",
            "link": "https://learn.microsoft.com/azure/devops/pipelines/get-started/pipelines-get-started?view=azure-devops&source=recommendations#define-pipelines-using-the-classic-interface",
            "services": [],
            "severity": "Medium",
            "subcategory": "Continuous Integration",
            "text": "Use GUI for pipeline",
            "waf": "Operations"
        },
        {
            "category": "Azure Pipelines",
            "checklist": "Azure DevOps",
            "description": "Set up templates, parameters and expressions",
            "guid": "8d1d7665-7246-4b44-a564-b4dd74a759c7",
            "link": "https://learn.microsoft.com/azure/devops/pipelines/process/templates?view=azure-devops&pivots=templates-includes",
            "services": [],
            "severity": "Medium",
            "subcategory": "Continuous Integration",
            "text": "Configure Templates",
            "waf": "Operations"
        },
        {
            "category": "Azure Pipelines",
            "checklist": "Azure DevOps",
            "description": "Set up  jobs, stages and dependencies",
            "guid": "633bd2a1-a27a-4764-a90b-e0e378ee293c",
            "link": "https://learn.microsoft.com/azure/devops/pipelines/process/stages?view=azure-devops&tabs=yaml",
            "services": [],
            "severity": "High",
            "subcategory": "Continuous Integration",
            "text": "Jobs",
            "waf": "Operations"
        },
        {
            "category": "Azure Pipelines",
            "checklist": "Azure DevOps",
            "description": "Set up conditions and Demands",
            "guid": "1bd363ca-aab7-4571-a49a-b9193dc9fc9d",
            "link": "https://learn.microsoft.com/azure/devops/pipelines/process/conditions?view=azure-devops&tabs=yaml%2Cstages",
            "services": [],
            "severity": "Medium",
            "subcategory": "Continuous Integration",
            "text": "Conditions and Demands",
            "waf": "Operations"
        },
        {
            "category": "Azure Pipelines",
            "checklist": "Azure DevOps",
            "description": "Define Variables",
            "guid": "1bb84b37-b5a6-47fc-a9ed-5b35478d447a",
            "link": "https://learn.microsoft.com/azure/devops/pipelines/process/variables?view=azure-devops&tabs=yaml%2Cbatch",
            "services": [],
            "severity": "High",
            "subcategory": "Continuous Integration",
            "text": "Variables",
            "waf": "Operations"
        },
        {
            "category": "Azure Pipelines",
            "checklist": "Azure DevOps",
            "description": "Set up your deployment pipeline",
            "guid": "826c2863-c00f-41ca-a699-ef1d5a83de5d",
            "link": "https://learn.microsoft.com/azure/devops/pipelines/process/create-multistage-pipeline?view=azure-devops",
            "services": [],
            "severity": "High",
            "subcategory": "Continuous Deployment",
            "text": "Deployment Pipeline",
            "waf": "Operations"
        },
        {
            "category": "Azure Pipelines",
            "checklist": "Azure DevOps",
            "description": "Select correct branches to deploy from",
            "guid": "e36c1c81-870a-40bc-9c1e-43a18658d285",
            "link": "https://learn.microsoft.com/azure/devops/pipelines/release/deploy-multiple-branches?view=azure-devops",
            "services": [],
            "severity": "Medium",
            "subcategory": "Continuous Deployment",
            "text": "Release branch",
            "training": "https://learn.microsoft.com/azure/active-directory/managed-identities-azure-resources/overview",
            "waf": "Operations"
        },
        {
            "category": "Azure Pipelines",
            "checklist": "Azure DevOps",
            "description": "use relevant template to deploy to azure",
            "guid": "8ed67179-b825-4546-bf2a-ee4553afc833",
            "link": "https://learn.microsoft.com/azure/devops/pipelines/overview-azure?view=azure-devops",
            "services": [],
            "severity": "Medium",
            "subcategory": "Continuous Deployment",
            "text": "Deploy to Azure",
            "waf": "Operations"
        },
        {
            "category": "Azure Pipelines",
            "checklist": "Azure DevOps",
            "description": "Define Release Approvals and pre deployment checks",
            "guid": "9248726d-d68c-45b5-a292-5394b69b9d37",
            "link": "https://learn.microsoft.com/azure/devops/pipelines/process/approvals?view=azure-devops&tabs=check-pass",
            "services": [],
            "severity": "Medium",
            "subcategory": "Continuous Deployment",
            "text": "Approvals and Checks",
            "training": "https://learn.microsoft.com/learn/modules/azure-ad-privileged-identity-management/",
            "waf": "Operations"
        },
        {
            "category": "Azure Pipelines",
            "checklist": "Azure DevOps",
            "description": "Define Gates and post deployment checks",
            "guid": "9ac43bc6-8d1d-4766-9724-6b448564b4dd",
            "link": "https://learn.microsoft.com/azure/devops/pipelines/release/approvals/?view=azure-devops&tabs=yaml",
            "services": [],
            "severity": "Medium",
            "subcategory": "Continuous Deployment",
            "text": "Gates",
            "waf": "Operations"
        },
        {
            "category": "Azure Pipelines",
            "checklist": "Azure DevOps",
            "description": "Define Azure Function and REST API Checks",
            "guid": "74a759c7-633b-4d2a-8a27-a764a90be0e3",
            "link": "https://learn.microsoft.com/azure/devops/pipelines/process/invoke-checks?view=azure-devops",
            "services": [],
            "severity": "Low",
            "subcategory": "Continuous Deployment",
            "text": "Azure Function Checks",
            "training": "https://learn.microsoft.com/learn/paths/implement-resource-mgmt-security/",
            "waf": "Operations"
        },
        {
            "category": "Azure Pipelines",
            "checklist": "Azure DevOps",
            "description": "Review pipeline reports",
            "guid": "78ee293c-1bd3-463c-aaab-7571949ab919",
            "link": "https://learn.microsoft.com/azure/devops/pipelines/reports/pipelinereport?view=azure-devops",
            "services": [],
            "severity": "High",
            "subcategory": "Continuous Deployment",
            "text": "Pipline Reports",
            "training": "https://learn.microsoft.com/learn/modules/plan-implement-administer-conditional-access/",
            "waf": "Operations"
        },
        {
            "category": "Azure Pipelines",
            "checklist": "Azure DevOps",
            "description": "configure Trend Result widget",
            "guid": "3dc9fc9d-1bb8-44b3-9b5a-67fcb9ed5b35",
            "link": "https://learn.microsoft.com/azure/devops/report/dashboards/analytics-widgets?toc=%2Fazure%2Fdevops%2Fpipelines%2Ftoc.json&view=azure-devops#test-results-trend-advanced",
            "services": [],
            "severity": "Medium",
            "subcategory": "Analytics",
            "text": "Pipeline Result Trend",
            "training": "https://learn.microsoft.com/learn/modules/secure-aad-users-with-mfa/",
            "waf": "Operations"
        },
        {
            "category": "Azure Pipelines",
            "checklist": "Azure DevOps",
            "description": "Connect with WIT to visualize work",
            "guid": "478d447a-826c-4286-9c00-f1cac699ef1d",
            "link": "https://learn.microsoft.com/azure/devops/pipelines/integrations/configure-pipelines-work-tracking?view=azure-devops&tabs=yaml",
            "services": [],
            "severity": "Medium",
            "subcategory": "Analytics",
            "text": "Work Tracking with Pipeline",
            "training": "https://learn.microsoft.com/learn/paths/azure-administrator-manage-identities-governance/",
            "waf": "Operations"
        },
        {
            "category": "Azure Pipelines",
            "checklist": "Azure DevOps",
            "description": "Understand agent pools",
            "guid": "5a83de5d-e36c-41c8-8870-a0bc5c1e43a1",
            "link": "https://learn.microsoft.com/azure/devops/pipelines/agents/agents?view=azure-devops&tabs=yaml%2Cbrowser",
            "services": [],
            "severity": "Medium",
            "subcategory": "Continuous Deployment",
            "text": " Agents and agent pools",
            "training": "https://learn.microsoft.com/learn/modules/azure-ad-privileged-identity-management/",
            "waf": "Operations"
        },
        {
            "category": "Azure Pipelines",
            "checklist": "Azure DevOps",
            "description": "Understand and provision Deployment Groups when required",
            "guid": "8658d285-8ed6-4717-ab82-5546df2aee45",
            "link": "https://learn.microsoft.com/azure/devops/pipelines/release/deployment-groups/?view=azure-devops",
            "services": [],
            "severity": "Low",
            "subcategory": "Continuous Deployment",
            "text": "Deployment Groups",
            "training": "https://learn.microsoft.com/learn/modules/explore-basic-services-identity-types/",
            "waf": "Operations"
        },
        {
            "category": "Azure Pipelines",
            "checklist": "Azure DevOps",
            "description": "Understand Kubernetes Deployment",
            "guid": "53afc833-9248-4726-bd68-c5b5c2925394",
            "link": "https://learn.microsoft.com/azure/devops/pipelines/ecosystems/kubernetes/deploy?view=azure-devops",
            "services": [
                "AKS"
            ],
            "severity": "Low",
            "subcategory": "Continuous Deployment",
            "text": "Deploy to Kubernetes",
            "training": "https://learn.microsoft.com/learn/paths/manage-identity-and-access/",
            "waf": "Operations"
        },
        {
            "category": "Azure Pipelines",
            "checklist": "Azure DevOps",
            "description": "Perform Dynamic Security Testing",
            "guid": "b69b9d37-9ac4-43bc-98d1-d76657246b44",
            "link": "https://devblogs.microsoft.com/premier-developer/azure-devops-pipelines-leveraging-owasp-zap-in-the-release-pipeline/",
            "services": [],
            "severity": "Medium",
            "subcategory": "Security",
            "text": "DAST Scan",
            "training": "https://learn.microsoft.com/learn/modules/create-custom-azure-roles-with-rbac/",
            "waf": "Security"
        },
        {
            "category": "Azure Pipelines",
            "checklist": "Azure DevOps",
            "description": "Manage Service Connections",
            "guid": "8564b4dd-74a7-459c-9633-bd2a1a27a764",
            "link": "https://learn.microsoft.com/azure/devops/pipelines/library/service-endpoints?view=azure-devops&tabs=yaml",
            "services": [],
            "severity": "Medium",
            "subcategory": "Security",
            "text": "Service Connections",
            "training": "https://learn.microsoft.com/learn/paths/secure-your-cloud-data/",
            "waf": "Security"
        },
        {
            "category": "Azure Pipelines",
            "checklist": "Azure DevOps",
            "description": "Set data retention policies for CI and CD",
            "guid": "a90be0e3-78ee-4293-a1bd-363caaab7571",
            "link": "https://learn.microsoft.com/azure/devops/pipelines/policies/retention?view=azure-devops&tabs=yaml",
            "services": [
                "AzurePolicy"
            ],
            "severity": "Medium",
            "subcategory": "Security",
            "text": "Retention Policies",
            "training": "https://learn.microsoft.com/learn/modules/azure-active-directory/",
            "waf": "Security"
        },
        {
            "category": "Azure Pipelines",
            "checklist": "Azure DevOps",
            "description": "Set up and pay for concurrent pipelines",
            "guid": "949ab919-3dc9-4fc9-b1bb-84b37b5a67fc",
            "link": "https://learn.microsoft.com/azure/devops/pipelines/licensing/concurrent-jobs?view=azure-devops&tabs=ms-hosted",
            "services": [],
            "severity": "Low",
            "subcategory": "Administration",
            "text": "Parallel Pipelines",
            "training": "https://learn.microsoft.com/learn/modules/implement-hybrid-identity-windows-server/",
            "waf": "Operations"
        },
        {
            "category": "Azure Pipelines",
            "checklist": "Azure DevOps",
            "description": "Set pipeline permissions",
            "guid": "b9ed5b35-478d-4447-a826-c2863c00f1ca",
            "link": "https://learn.microsoft.com/azure/devops/pipelines/policies/permissions?view=azure-devops",
            "services": [],
            "severity": "Medium",
            "subcategory": "Security",
            "text": "Pipeline Permissions",
            "training": "https://learn.microsoft.com/learn/paths/implement-windows-server-iaas-virtual-machine-identity/",
            "waf": "Security"
        },
        {
            "category": "Azure Pipelines",
            "checklist": "Azure DevOps",
            "description": "Add users to pipeline",
            "guid": "c699ef1d-5a83-4de5-be36-c1c81870a0bc",
            "link": "https://learn.microsoft.com/azure/devops/pipelines/policies/set-permissions?view=azure-devops",
            "services": [],
            "severity": "Low",
            "subcategory": "Security",
            "text": "Pipeline Users",
            "training": "https://learn.microsoft.com/learn/paths/implement-applications-external-access-azure-ad/",
            "waf": "Security"
        },
        {
            "category": "Azure Artifact",
            "checklist": "Azure DevOps",
            "description": "Configure Artifacts",
            "guid": "5c1e43a1-8658-4d28-98ed-67179b825546",
            "link": "https://learn.microsoft.com/azure/devops/pipelines/artifacts/artifacts-overview?view=azure-devops&tabs=nuget",
            "services": [],
            "severity": "Medium",
            "subcategory": "Configuration",
            "text": "Artifact In Pipeline",
            "training": "https://learn.microsoft.com/learn/modules/design-identity-security-strategy/",
            "waf": "Operations"
        },
        {
            "category": "Azure Artifact",
            "checklist": "Azure DevOps",
            "description": "Publish and consume artifact in pipeline",
            "guid": "df2aee45-53af-4c83-9924-8726dd68c5b5",
            "link": "https://learn.microsoft.com/azure/devops/pipelines/artifacts/pipeline-artifacts?view=azure-devops&tabs=yaml",
            "services": [],
            "severity": "Medium",
            "subcategory": "Configuration",
            "text": "Publish and download Artifact",
            "training": "https://learn.microsoft.com/azure/architecture/example-scenario/identity/adds-extend-domain",
            "waf": "Operations"
        },
        {
            "category": "Azure Artifact",
            "checklist": "Azure DevOps",
            "description": "Publish NuGet packages with artifacts",
            "guid": "c2925394-b69b-49d3-99ac-43bc68d1d766",
            "link": "https://learn.microsoft.com/azure/devops/pipelines/artifacts/nuget?view=azure-devops&tabs=yaml",
            "services": [],
            "severity": "Low",
            "subcategory": "Configuration",
            "text": "NuGet",
            "training": "https://learn.microsoft.com/azure/role-based-access-control/overview",
            "waf": "Operations"
        },
        {
            "category": "Azure Artifact",
            "checklist": "Azure DevOps",
            "description": "Publish Maven packages with artifacts",
            "guid": "57246b44-8564-4b4d-b74a-759c7633bd2a",
            "link": "https://learn.microsoft.com/azure/devops/pipelines/artifacts/publish-maven-artifacts?view=azure-devops",
            "services": [],
            "severity": "Low",
            "subcategory": "Configuration",
            "text": "Maven",
            "waf": "Operations"
        },
        {
            "category": "Azure Artifact",
            "checklist": "Azure DevOps",
            "description": "Publish NPM packages with artifacts",
            "guid": "1a27a764-a90b-4e0e-978e-e293c1bd363c",
            "link": "https://learn.microsoft.com/azure/devops/pipelines/artifacts/npm?view=azure-devops&tabs=yaml",
            "services": [],
            "severity": "Low",
            "subcategory": "Configuration",
            "text": "NPM",
            "waf": "Operations"
        },
        {
            "category": "Azure Artifact",
            "checklist": "Azure DevOps",
            "description": "Best Practices to work with Azure Artifact",
            "guid": "aaab7571-949a-4b91-a3dc-9fc9d1bb84b3",
            "link": "https://learn.microsoft.com/azure/devops/artifacts/concepts/best-practices?view=azure-devops",
            "services": [],
            "severity": "Medium",
            "subcategory": "Configuration",
            "text": "Best Practices",
            "waf": "Operations"
        },
        {
            "category": "DevOps Practice",
            "checklist": "Azure DevOps",
            "description": "What is monitoring?",
            "guid": "7b5a67fc-b9ed-45b3-9478-d447a826c286",
            "link": "https://learn.microsoft.com/devops/operate/what-is-monitoring",
            "services": [
                "Monitor"
            ],
            "severity": "High",
            "subcategory": "Practice",
            "text": "What to monitor?",
            "waf": "Operations"
        },
        {
            "category": "DevOps Practice",
            "checklist": "Azure DevOps",
            "description": "Progressive Exposure Strategy",
            "guid": "3c00f1ca-c699-4ef1-b5a8-3de5de36c1c8",
            "link": "https://learn.microsoft.com/devops/operate/safe-deployment-practices",
            "services": [],
            "severity": "Medium",
            "subcategory": "Practice",
            "text": "Safe Deployment Practices",
            "waf": "Operations"
        },
        {
            "category": "DevOps Practice",
            "checklist": "Azure DevOps",
            "description": "Microsoft runs reliable systems with DevOps",
            "guid": "1870a0bc-5c1e-443a-8865-8d2858ed6717",
            "link": "https://learn.microsoft.com/devops/operate/how-microsoft-operates-devops",
            "services": [],
            "severity": "Low",
            "subcategory": "Practice",
            "text": "Case Study",
            "training": "https://learn.microsoft.com/azure/azure-monitor/logs/design-logs-deployment",
            "waf": "Operations"
        },
        {
            "category": "DevOps Practice",
            "checklist": "Azure DevOps",
            "description": "Security in DevOps",
            "guid": "9b825546-df2a-4ee4-953a-fc8339248726",
            "link": "https://learn.microsoft.com/devops/operate/security-in-devops",
            "services": [],
            "severity": "Medium",
            "subcategory": "Practice",
            "text": "DevSecOps",
            "waf": "Security"
        },
        {
            "category": "DevOps Practice",
            "checklist": "Azure DevOps",
            "description": "Enable DevSecops with Azure And GitHub",
            "guid": "dd68c5b5-c292-4539-9b69-b9d379ac43bc",
            "link": "https://learn.microsoft.com/devops/devsecops/enable-devsecops-azure-github",
            "services": [],
            "severity": "Low",
            "subcategory": "Practice",
            "text": "DevSecops",
            "training": "https://learn.microsoft.com/learn/paths/architect-infrastructure-operations/",
            "waf": "Security"
        },
        {
            "category": "DevOps Practice",
            "checklist": "Azure DevOps",
            "description": "Mirror RBAC in DevOps",
            "guid": "68d1d766-5724-46b4-9856-4b4dd74a759c",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/secure/best-practices/end-to-end-governance",
            "services": [
                "RBAC"
            ],
            "severity": "Low",
            "subcategory": "Practice",
            "text": "Secure DevOps Govenance",
            "training": "https://learn.microsoft.com/learn/paths/architect-infrastructure-operations/",
            "waf": "Security"
        },
        {
            "category": "DevOps Practice",
            "checklist": "Azure DevOps",
            "description": "Governance when using CI/CD",
            "guid": "7633bd2a-1a27-4a76-9a90-be0e378ee293",
            "link": "https://learn.microsoft.com/azure/architecture/example-scenario/governance/end-to-end-governance-in-azure",
            "services": [],
            "severity": "Medium",
            "subcategory": "Practice",
            "text": "Azure DevOps Governance",
            "training": "https://learn.microsoft.com/learn/paths/implement-resource-mgmt-security/",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Event Hub Review",
            "description": "Azure Event Hub provides encryption of data at rest. If you use your own key, the data is still encrypted using the Microsoft-managed key, but in addition the Microsoft-managed key will be encrypted using the customer-managed key. ",
            "guid": "7aaf12e7-b94e-4f6e-847d-2d92981b1cd6",
            "link": "https://learn.microsoft.com/azure/event-hubs/configure-customer-managed-key",
            "service": "Event Hubs",
            "services": [
                "EventHubs"
            ],
            "severity": "Low",
            "subcategory": "Data Protection",
            "text": "Use customer-managed key option in data at rest encryption when required",
            "training": "https://learn.microsoft.com/learn/modules/plan-implement-administer-conditional-access/",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Event Hub Review",
            "description": "Azure Event Hubs namespaces permit clients to send and receive data with TLS 1.0 and above. To enforce stricter security measures, you can configure your Event Hubs namespace to require that clients send and receive data with a newer version of TLS. If an Event Hubs namespace requires a minimum version of TLS, then any requests made with an older version will fail. ",
            "guid": "d2f54b29-769e-43a6-a0e7-828ac936657e",
            "link": "https://learn.microsoft.com/azure/event-hubs/transport-layer-security-configure-minimum-version",
            "service": "Event Hubs",
            "services": [
                "EventHubs"
            ],
            "severity": "Medium",
            "subcategory": "Data Protection",
            "text": "Enforce a minimum required version of Transport Layer Security (TLS) for requests ",
            "training": "https://learn.microsoft.com/learn/modules/secure-aad-users-with-mfa/",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Event Hub Review",
            "description": "When you create an Event Hubs namespace, a policy rule named RootManageSharedAccessKey is automatically created for the namespace. This policy has manage permissions for the entire namespace. It�s recommended that you treat this rule like an administrative root account and don�t use it in your application. Using AAD as an authentication provider with RBAC is recommended. ",
            "guid": "13b0f566-4b1e-4944-a459-837ee79d6c6d",
            "link": "https://learn.microsoft.com/azure/event-hubs/authorize-access-shared-access-signature#shared-access-authorization-policies",
            "service": "Event Hubs",
            "services": [
                "AzurePolicy",
                "Entra",
                "RBAC",
                "EventHubs",
                "TrafficManager"
            ],
            "severity": "Medium",
            "subcategory": "Identity and Access Management",
            "text": "Avoid using root account when it is not necessary",
            "training": "https://learn.microsoft.com/learn/paths/azure-administrator-manage-identities-governance/",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Event Hub Review",
            "description": "Managed identities for Azure resources can authorize access to Event Hubs resources using Azure AD credentials from applications running in Azure Virtual Machines (VMs), Function apps, Virtual Machine Scale Sets, and other services. By using managed identities for Azure resources together with Azure AD authentication, you can avoid storing credentials with your applications that run in the cloud. ",
            "guid": "3a365a5c-7acb-4e48-abd5-4cd79f2e8776",
            "link": "https://learn.microsoft.com/azure/event-hubs/authenticate-managed-identity?tabs=latest",
            "service": "Event Hubs",
            "services": [
                "AKV",
                "Entra",
                "EventHubs",
                "VM",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Identity and Access Management",
            "text": "When possible, your application should be using a managed identity to authenticate to Azure Event Hub. If not, consider having the storage credential (SAS, service principal credential) in Azure Key Vault or an equivalent service",
            "training": "https://learn.microsoft.com/learn/modules/azure-ad-privileged-identity-management/",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Event Hub Review",
            "description": "When creating permissions, provide fine-grained control over a client's access to Azure Event Hub. Permissions in Azure Event Hub can and should be scoped to the individual resource level e.g. consumer group, event hub entity, event hub namespaces, etc.",
            "guid": "8357c559-675c-45ee-a5b8-6ad8844ce3b2",
            "link": "https://learn.microsoft.com/azure/event-hubs/authorize-access-azure-active-directory#azure-built-in-roles-for-azure-event-hubs",
            "service": "Event Hubs",
            "services": [
                "RBAC",
                "EventHubs",
                "Entra"
            ],
            "severity": "High",
            "subcategory": "Identity and Access Management",
            "text": "Use least privilege data plane RBAC",
            "training": "https://learn.microsoft.com/learn/modules/explore-basic-services-identity-types/",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Event Hub Review",
            "description": "Azure Event Hub resource logs include operational logs, virtual network and Kafka logs. Runtime audit logs capture aggregated diagnostic information for all data plane access operations (such as send or receive events) in Event Hubs.",
            "guid": "b38b875b-a1cf-4104-a900-3a4d3ce474db",
            "link": "https://learn.microsoft.com/azure/event-hubs/monitor-event-hubs-reference",
            "service": "Event Hubs",
            "services": [
                "VNet",
                "EventHubs",
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Monitoring",
            "text": "Enable logging for security investigation. Use Azure Monitor to captured metrics and logs such as resource logs, runtime audit logs and Kafka logs",
            "training": "https://learn.microsoft.com/learn/paths/manage-identity-and-access/",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Event Hub Review",
            "description": "Azure Event Hub by default has a public IP address and is Internet-reachable. Private endpoints allow traffic between your virtual network and Azure Event Hub traverses over the Microsoft backbone network. In addition to that, you should disable public endpoints if those are not used. ",
            "guid": "5abca2a4-eda1-4dae-8cc9-5d48c6b791dc",
            "link": "https://learn.microsoft.com/azure/event-hubs/private-link-service",
            "service": "Event Hubs",
            "services": [
                "VNet",
                "EventHubs",
                "PrivateLink"
            ],
            "severity": "Medium",
            "subcategory": "Networking",
            "text": "Consider using private endpoints to access Azure Event Hub and disable public network access when applicable.",
            "training": "https://learn.microsoft.com/learn/modules/azure-ad-privileged-identity-management/",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Event Hub Review",
            "description": "With IP firewall, you can restrict public endpoint further to only a set of IPv4 addresses or IPv4 address ranges in CIDR (Classless Inter-Domain Routing) notation. ",
            "guid": "a0e6c465-89e5-458b-a37d-3974d1112dbd",
            "link": "https://learn.microsoft.com/azure/event-hubs/event-hubs-ip-filtering",
            "service": "Event Hubs",
            "services": [
                "EventHubs"
            ],
            "severity": "Medium",
            "subcategory": "Networking",
            "text": "Consider only allowing access to Azure Event Hub namespace from specific IP addresses or ranges",
            "training": "https://learn.microsoft.com/learn/paths/implement-resource-mgmt-security/",
            "waf": "Security"
        },
        {
            "category": "Operations Management",
            "checklist": "Azure Event Hub Review",
            "guid": "31d41e36-11c8-417b-8afb-c410d4391898",
            "link": "https://github.com/Azure/fta-resiliencyplaybooks/blob/main/paas-foundations-playbooks-AEH_v1.docx",
            "service": "Event Hubs",
            "services": [
                "EventHubs"
            ],
            "severity": "Medium",
            "subcategory": "Best Practices",
            "text": "Leverage FTA Resillency HandBook",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Azure Event Hub Review",
            "description": " This will be turned on automatically for a new EH namespace created from the portal with Premium, Dedicated, or Standard SKUs in a zone-enabled region. Both the EH metadata and the event data itself are replicated across zones",
            "guid": "f15bce21-9e4a-40eb-9787-9424d226786d",
            "link": "https://learn.microsoft.com/azure/event-hubs/event-hubs-premium-overview#high-availability-with-availability-zones",
            "service": "Event Hubs",
            "services": [
                "ACR",
                "EventHubs"
            ],
            "severity": "High",
            "subcategory": "Zone Redudancy",
            "text": "Leverage Availability Zones if regionally applicable",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Azure Event Hub Review",
            "guid": "20b56c56-ad58-4519-8f82-735c586bb281",
            "link": "https://learn.microsoft.com/azure/event-hubs/compare-tiers",
            "service": "Event Hubs",
            "services": [
                "EventHubs"
            ],
            "severity": "Medium",
            "subcategory": "Best Practices",
            "text": "Use the Premium or Dedicated SKUs   for predicable performance",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Azure Event Hub Review",
            "description": "The built-in geo-disaster recovery feature, when enabled, ensures that the entire configuration of anamespace (Event Hubs, Consumer Groups and settings) is continuously replicated from a primary namespace to a secondary namespace, and it allows a once-only failover move from the primary to the secondary at any time. Active/Passive feature is designed to make it easier to recover from and abandon a failed Azure region without having to change application configurations",
            "guid": "dc15a1c0-75ee-49f1-90ac-ccd579376bcd",
            "link": "https://learn.microsoft.com/azure/event-hubs/event-hubs-geo-dr?tabs=portal",
            "service": "Event Hubs",
            "services": [
                "EventHubs",
                "ASR"
            ],
            "severity": "High",
            "subcategory": "Geo Redudancy",
            "text": "Plan for Geo Disaster Recovery using Active Passive configuration",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Azure Event Hub Review",
            "description": "Should be used for DR configurations where an outage or loss of event data in the downed region cannot be tolerated. For these cases, follow the replication guidance and do not use the built-in geo-disaster recovery capability (active/passive). With Active/Active, Maintain multiple Event Hubs in different regions and namespaces, and events will be replicated between the hubs",
            "guid": "6e31b67d-67ba-4591-89c0-9e805d597c7e",
            "link": "https://learn.microsoft.com/azure/event-hubs/event-hubs-federation-overview",
            "service": "Event Hubs",
            "services": [
                "EventHubs",
                "ASR"
            ],
            "severity": "Medium",
            "subcategory": "Geo Redudancy",
            "text": "For Business Critical Applications, use Active Active configuration",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Azure Event Hub Review",
            "guid": "9ced16ad-d186-4f0a-a241-a999a68af77c",
            "link": "https://learn.microsoft.com/azure/architecture/serverless/event-hubs-functions/resilient-design",
            "service": "Event Hubs",
            "services": [
                "EventHubs"
            ],
            "severity": "Medium",
            "subcategory": "Reliability",
            "text": "Design Resilient Event Hubs",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Recovery Services Vault Checklist",
            "guid": "cb7da8cf-aa62-4a15-a495-6da97dc3a242",
            "link": "https://learn.microsoft.com/azure/site-recovery/site-recovery-plan-capacity-vmware",
            "services": [],
            "severity": "High",
            "subcategory": "Replication",
            "text": "Capacity planning is required to make sure you have sufficient bandwidth for replication and an estimated number of CPU cores & disk types that will be needed in Azure for failover",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Recovery Services Vault Checklist",
            "guid": "67b23587-05a1-4652-aded-fa8a488cdec4",
            "link": "https://learn.microsoft.com/azure/site-recovery/azure-to-azure-how-to-enable-policy",
            "services": [
                "AzurePolicy",
                "VM",
                "ASR"
            ],
            "severity": "High",
            "subcategory": "Replication",
            "text": "Use Azure Policy to ensure that all critical Azure VMs are protected with ASR",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Recovery Services Vault Checklist",
            "guid": "862bc3bc-14be-4b7f-96e8-d9b3bec228e7",
            "link": "https://learn.microsoft.com/azure/site-recovery/recovery-plan-overview",
            "services": [
                "VM"
            ],
            "severity": "Medium",
            "subcategory": "Replication",
            "text": "Define recovery plans to automate the failover sequence for VMs. You can also include automation scripts to reduce manual steps and improve recovery time",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Recovery Services Vault Checklist",
            "guid": "437b1736-db55-4f67-a613-334bd09dc234",
            "link": "https://learn.microsoft.com/azure/backup/backup-azure-immutable-vault-how-to-manage?tabs=recovery-services-vault",
            "services": [],
            "severity": "Medium",
            "subcategory": "Data Protection",
            "text": "Enable and LOCK immutability for vaults. This ensures recovery points cannot be deleted before their intended expiry",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Recovery Services Vault Checklist",
            "guid": "19db6128-1265-404b-a47a-493a08042729",
            "link": "https://learn.microsoft.com/azure/backup/backup-azure-enhanced-soft-delete-about",
            "services": [],
            "severity": "Medium",
            "subcategory": "Data Protection",
            "text": "Enable 'Always-on soft delete' for vaults protecting critical workloads",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Recovery Services Vault Checklist",
            "guid": "4798b158-8b31-4aa5-9ceb-54445135a227",
            "link": "https://learn.microsoft.com/azure/backup/backup-create-recovery-services-vault#set-storage-redundancy",
            "services": [
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Redudancy",
            "text": "When creating Recovery Service Vaults choose the best storage redundancy option for your requirements. Vaults support local, geo and zone redundancy but this setting cannot be changed once the vault is protecting one or more resources",
            "waf": "Reliability"
        },
        {
            "category": "Business Continuity and Disaster Recovery",
            "checklist": "Azure Virtual Desktop Review",
            "description": "AVD control plane does not offer a financially backed service level agreement. We strive to attain at least 99.9% availability for the Azure Virtual Desktop service URLs. The availability of the session host virtual machines in your subscription is covered by the Virtual Machines SLA. Dependent resources/services and infrastructure availability must be also considered to properly satisfy global high-availability requirements.",
            "guid": "56c57ba5-9119-4bf8-b8f5-c586c7d9cdc1",
            "link": "https://azure.microsoft.com/support/legal/sla/virtual-desktop/v1_0/",
            "services": [
                "AVD",
                "Subscriptions",
                "VM",
                "ASR"
            ],
            "severity": "High",
            "subcategory": "Compute",
            "text": "Determine the expected High Availability SLA for applications/desktops published through AVD",
            "waf": "Reliability"
        },
        {
            "category": "Business Continuity and Disaster Recovery",
            "checklist": "Azure Virtual Desktop Review",
            "description": "'Active-Active' model can be achieved with multiple host pools in different regions. A single Host Pool with VMs from different regions is not recommended. If multiple pools for same users will be used, the problem of how to synchronize/replicate user profiles must be solved. FSLogix Cloud Cache could be used, but need to be carefully reviewed and planned, or customers can decide to do not synchronize/replicate at all. 'Active-Passive' can be achieved using Azure Site Recovery (ASR) or on-demand Pool deployment with automated mechanism. For a detailed discussion on multi-region BCDR, please read the companion article in the 'More Info' column and this FSLogix related page: https://learn.microsoft.com/fslogix/concepts-container-recovery-business-continuity.",
            "guid": "6acc076e-f9b1-441a-a989-579e76b897e7",
            "link": "https://learn.microsoft.com/azure/architecture/example-scenario/wvd/azure-virtual-desktop-multi-region-bcdr",
            "services": [
                "AVD",
                "VM",
                "Storage",
                "ASR"
            ],
            "severity": "Medium",
            "subcategory": "Compute",
            "text": "Assess Geo Disaster Recovery requirements for AVD Host Pools",
            "waf": "Reliability"
        },
        {
            "category": "Business Continuity and Disaster Recovery",
            "checklist": "Azure Virtual Desktop Review",
            "description": "Before approaching Azure Virtual Desktop BCDR planning and design, it is important to initially consider which applications consumed through AVD are critical. You may want to separate them from non-critical apps and use a separate Host Pool with a different disaster recovery approach and capabilities.",
            "guid": "10a7da7b-e996-46e1-9d3c-4ada97cc3d13",
            "link": "https://docs.microsoft.com/azure/virtual-desktop/disaster-recovery",
            "services": [
                "AVD",
                "ASR"
            ],
            "severity": "Low",
            "subcategory": "Compute",
            "text": "Separate critical applications in different AVD Host Pools",
            "waf": "Reliability"
        },
        {
            "category": "Business Continuity and Disaster Recovery",
            "checklist": "Azure Virtual Desktop Review",
            "description": "Each Host Pool can be deployed using Availability Zones (AZ) or Availability Set (AS). To maximize resiliency, usage of AZ is recommended: at Host Pool creation time you can decide to spread Host Pool Session Hosts across all available AZ. Usage of AS will not protect from single datacenter failure, then should be used only in regions where AZ are not available. More details on AZ and AVD in the companion article. For a comparison between AZ and AS you can read here: https://learn.microsoft.com/azure/virtual-machines/availability.",
            "guid": "25ab225c-6f4e-4168-9fdd-dea8a4b7cdeb",
            "link": "https://techcommunity.microsoft.com/t5/azure-virtual-desktop-blog/announcing-general-availability-of-support-for-azure/ba-p/3636262",
            "services": [
                "AVD",
                "ACR",
                "ASR"
            ],
            "severity": "High",
            "subcategory": "Compute",
            "text": "Plan the best resiliency option for AVD Host Pool deployment",
            "waf": "Reliability"
        },
        {
            "category": "Business Continuity and Disaster Recovery",
            "checklist": "Azure Virtual Desktop Review",
            "description": "Azure Backup can be used to protect Host Pool VMs. For Pooled Pools, this is not necessary since should be stateless. Instead, this option can be considered for Personal Host Pools.",
            "guid": "4c61fc3f-c14e-4ea6-b69e-8d9a3eec218e",
            "link": "https://docs.microsoft.com/azure/virtual-desktop/disaster-recovery",
            "services": [
                "AVD",
                "VM",
                "ASR",
                "Backup"
            ],
            "severity": "Medium",
            "subcategory": "Compute",
            "text": "Assess the requirement to backup AVD Session Host VMs",
            "waf": "Reliability"
        },
        {
            "category": "Business Continuity and Disaster Recovery",
            "checklist": "Azure Virtual Desktop Review",
            "description": "Even for Personal Pools, usage of Availability Zones, when available, is recommended. Three possible in-region DR strategies are possible, it is recommended to select the best one based on cost, RTO/RPO, and if it is really necessary to save the entire VM OS disk: (1) create each session host in a specific zone (AZ) and then use Azure Site Recovery (ASR) to replicate to a different zone. (2) Use Azure Backup to backup and restore the specific session host in a different AZ. (3) Create a new session host in a different AZ and rely on FSLogix and/or OneDrive to make data and settings available on the new machine. All options require administrator intervention for DR and direct user assignment at Host Pool level, then must be planned and configured in advance.",
            "guid": "5da58639-ca3a-4961-890b-29663c5e10d",
            "link": "https://learn.microsoft.com/azure/site-recovery/azure-to-azure-how-to-enable-zone-to-zone-disaster-recovery",
            "services": [
                "Cost",
                "ASR",
                "AVD",
                "Backup",
                "VM"
            ],
            "severity": "Medium",
            "subcategory": "Compute",
            "text": "Prepare a local DR strategy for Personal Host Pool Session Hosts",
            "waf": "Reliability"
        },
        {
            "category": "Business Continuity and Disaster Recovery",
            "checklist": "Azure Virtual Desktop Review",
            "description": "If custom images are used to deploy AVD Host Pool VMs, it is important to ensure those artifacts are available in all regions where AVD is deployed. Azure Compute Gallery service can be used to replicate images across all regions where a Host Pool is deployed, with redundant storage and in multiple copies. Please be aware that the Azure Compute Gallery service isn't a global resource. For disaster recovery scenarios, the best practice is to have at least two galleries, in different regions.",
            "guid": "dd2e0d5d-771d-441e-9610-cc57b4a4a141",
            "link": "https://learn.microsoft.com/azure/virtual-machines/azure-compute-gallery",
            "services": [
                "ASR",
                "AVD",
                "ACR",
                "VM",
                "Storage"
            ],
            "severity": "Low",
            "subcategory": "Dependencies",
            "text": "Plan for Golden Image cross-region availability",
            "waf": "Reliability"
        },
        {
            "category": "Business Continuity and Disaster Recovery",
            "checklist": "Azure Virtual Desktop Review",
            "description": "If users of the AVD infrastructure need on-premises resource access, high availability of network infrastructure required to connect is also critical and should be considered. Resiliency of authentication infrastructure needs to be assessed and evaluated. BCDR aspects for dependent applications and other resources need to be considered to ensure availability in the secondary DR location.",
            "guid": "fd339489-8c12-488b-9c6a-57cfb644451e",
            "link": "https://docs.microsoft.com/azure/virtual-desktop/disaster-recovery",
            "services": [
                "AVD",
                "ASR"
            ],
            "severity": "Medium",
            "subcategory": "Dependencies",
            "text": "Assess Infrastructure & Application dependencies ",
            "waf": "Reliability"
        },
        {
            "category": "Business Continuity and Disaster Recovery",
            "checklist": "Azure Virtual Desktop Review",
            "description": "Not all data inside FSLogix user profiles may deserve protection from disaster. Additionally, if external storage is used, for example OneDrive or File Servers/Shares, what is remaining in the FSLogix profile is minimal and could be lost in some extreme circumstances. In other cases, data inside the profile can be rebuilt from other storages (for example Outlook Inbox in cached mode).",
            "guid": "687ab077-adb5-49e5-a960-3334fdf8cc23",
            "link": "https://docs.microsoft.com/fslogix/manage-profile-content-cncpt",
            "services": [
                "AVD",
                "Storage",
                "ASR"
            ],
            "severity": "Medium",
            "subcategory": "Storage",
            "text": "Assess which data need to be protected in the Profile and Office Containers",
            "waf": "Reliability"
        },
        {
            "category": "Business Continuity and Disaster Recovery",
            "checklist": "Azure Virtual Desktop Review",
            "description": "Preventing data loss for critical user data is important, first step is to assess which data need to be saved and protected. If using OneDrive or other external storage, saving user Profile and/or Office Containers data maybe not necessary. Appropriate mechanism must be considered to provide protection for critical user data. Azure Backup service can be used to protect Profile and Office Containers data when stored on Azure Files Standard and Premium tiers. Azure NetApp Files Snapshots and Policies can be used for Azure NetApp Files (all tiers).",
            "guid": "fc4972cc-3cd2-45bf-a707-6e9eab4bed32",
            "link": "https://docs.microsoft.com/azure/virtual-desktop/disaster-recovery",
            "services": [
                "ASR",
                "AVD",
                "AzurePolicy",
                "Backup",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Storage",
            "text": "Build a backup protection strategy for Profile and Office Containers",
            "waf": "Reliability"
        },
        {
            "category": "Business Continuity and Disaster Recovery",
            "checklist": "Azure Virtual Desktop Review",
            "description": "In AVD, multiple replication mechanisms and strategies can be used for user data residing in FSLogix containers: [Profile Pattern #1]: Native Azure storage replication mechanisms, for example Azure Files Standard GRS replication, Azure NetApp Files Cross Region Replication. Use Zone Replicated Storage (ZRS) or Geo replicated storage (GRS) for Azure Files is recommended. LRS with local-only resiliency can be used if no zone/region protection is required. NOTE: Azure Files Share Standard is LRS/ZRS/GRS, but with 100TB large support enabled only LRS/ZRS are supported. [Profile Pattern #2]: FSLogix Cloud Cache is built in automatic mechanism to replicate containers between different (up to 4) storage accounts. Cloud Cache should be used only when:(1) User Profile or Office containers data availability required high-availability SLA is critical and need to be resilient to region failure. (2) Selected storage option is not able to satisfy BCDR requirements. For example, with Azure File Share Premium tier, or Azure File Share Standard with Large File Support enabled, GRS is not available. (3) When replication between disparate storage is required. [Profile Pattern #3]: Only set up geo disaster recovery for application data and not for user data/profile containers: store important application data in separate storages, like OneDrive or other external storage with its own built-in DR mechanism.",
            "guid": "9f7547c1-746d-4c56-868a-714435bd09dd",
            "link": "https://docs.microsoft.com/azure/virtual-desktop/disaster-recovery",
            "services": [
                "AVD",
                "Storage",
                "ASR"
            ],
            "severity": "Medium",
            "subcategory": "Storage",
            "text": "Assess Profile Container storage replication requirements and resiliency for BCDR purpose",
            "waf": "Reliability"
        },
        {
            "category": "Business Continuity and Disaster Recovery",
            "checklist": "Azure Virtual Desktop Review",
            "description": "For local disaster recovery, Azure Backup for Azure Files can be used. For cross-region geo disaster recovery: GRS for Azure Files is only available with standard SKU and no large share support, then not suitable in most customer scenarios. If geo-replication is required with Azure File Share Premium, replication with FSLogix Cloud Cache can be evaluated, or 'in-region' Availability Zone (AZ) only resiliency should be considered.",
            "guid": "3d4f3537-c134-46dc-9602-7a71efe1bd05",
            "link": "https://docs.microsoft.com/azure/backup/backup-afs",
            "services": [
                "AVD",
                "Storage",
                "ASR",
                "Backup"
            ],
            "severity": "Medium",
            "subcategory": "Storage",
            "text": "Review Azure Files disaster recovery strategy",
            "waf": "Reliability"
        },
        {
            "category": "Business Continuity and Disaster Recovery",
            "checklist": "Azure Virtual Desktop Review",
            "description": "Zone Redundant Storage will maximize in-region resiliency for the user profile data. ZRS is supported for premium file shares through the 'FileStorage' storage account kind. ZRS is supported in standard general-purpose v2 storage accounts. Usage of zone redundant storage must be paired with zone redundant deployment of Session Hosts in each Host Pool. ",
            "guid": "10d4e875-d502-4142-a795-f2b6eff34f88",
            "link": "https://learn.microsoft.com/azure/storage/files/files-redundancy#zone-redundant-storage",
            "services": [
                "AVD",
                "Storage",
                "ASR"
            ],
            "severity": "High",
            "subcategory": "Storage",
            "text": "Use Zone Redundant Storage (ZRS) for Azure Files to maximize resiliency",
            "waf": "Reliability"
        },
        {
            "category": "Business Continuity and Disaster Recovery",
            "checklist": "Azure Virtual Desktop Review",
            "description": "For local disaster recovery, Azure NetApp Files (ANF) native backup is available. ANF is essentially locally redundant, then for cross-region geo disaster recovery it is necessary to use an additional mechanism that is Cross-Region Replication (CRR) https://learn.microsoft.com/azure/azure-netapp-files/cross-region-replication-create-peering. Currently, ANF does not provide replication nor redundancy across different Availability Zones (AZ), only the possibility to select in which single AZ to place the ANF volume: https://learn.microsoft.com/azure/azure-netapp-files/manage-availability-zone-volume-placement.",
            "guid": "23429db7-2281-4376-85cc-57b4a4b18142",
            "link": "https://learn.microsoft.com/azure/azure-netapp-files/cross-region-replication-create-peering",
            "services": [
                "ASR",
                "AVD",
                "ACR",
                "Backup",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Storage",
            "text": "Review Azure NetApp Files disaster recovery strategy",
            "waf": "Reliability"
        },
        {
            "category": "Compute",
            "checklist": "Azure Virtual Desktop Review",
            "description": "Applications can be preinstalled in the golden image/s, can be attached using MSIX & AppAttach feature or distributed to the session hosts after host pool deployment using traditional software distribution methods.",
            "guid": "86ba2802-1459-4014-95d3-8e5309ccbd97",
            "link": "https://learn.microsoft.com/azure/virtual-desktop/set-up-golden-image",
            "services": [
                "AVD"
            ],
            "severity": "High",
            "subcategory": "Golden Images",
            "text": "Determine how applications will be deployed in AVD Host Pools",
            "waf": "Operations"
        },
        {
            "category": "Compute",
            "checklist": "Azure Virtual Desktop Review",
            "description": "Multiple golden images can be required to support different OS versions and/or settings, different groups of applications that must be separated and cannot be included in a single image.",
            "guid": "9266bcca-274f-4aa1-abf3-9d95d44c7c89",
            "link": "https://learn.microsoft.com/azure/virtual-desktop/set-up-golden-image",
            "services": [
                "AVD"
            ],
            "severity": "Medium",
            "subcategory": "Golden Images",
            "text": "Estimate the number of golden images that will be required",
            "waf": "Operations"
        },
        {
            "category": "Compute",
            "checklist": "Azure Virtual Desktop Review",
            "description": "Determine which Guest OS will be used to deploy each Host Pool: Windows 10 vs. Windows Server, Marketplace vs. Custom images",
            "guid": "19ca1f6d-5315-4ae5-84ba-34d4585e2213",
            "link": "https://learn.microsoft.com/azure/virtual-desktop/prerequisites?tabs=portal#operating-systems-and-licenses",
            "services": [
                "AVD"
            ],
            "severity": "Medium",
            "subcategory": "Golden Images",
            "text": "Determine which OS image/s you will use for Host Pool deployment",
            "waf": "Reliability"
        },
        {
            "category": "Compute",
            "checklist": "Azure Virtual Desktop Review",
            "description": "Azure VM custom images can be created and stored in different ways: in an Azure Compute Gallery, as a managed image object or as a managed disk in the storage. The recommended way is to use Azure Compute Gallery.",
            "guid": "5a2adb2c-3e23-426b-b225-ca44e1696fdd",
            "link": "https://learn.microsoft.com/azure/virtual-machines/shared-image-galleries",
            "services": [
                "AVD",
                "VM",
                "Storage"
            ],
            "severity": "Low",
            "subcategory": "Golden Images",
            "text": "Select the proper store for custom images",
            "waf": "Reliability"
        },
        {
            "category": "Compute",
            "checklist": "Azure Virtual Desktop Review",
            "description": "If custom images will be used, plan for an automated build process. If no pre-existing software factory exists, consider using Custom Image Templates and/or Azure Image Builder to automate the build process.",
            "guid": "9bd7bb01-2f7b-495e-86e1-54e2aa359282",
            "link": "https://learn.microsoft.com/azure/virtual-desktop/create-custom-image-templates",
            "services": [
                "AVD"
            ],
            "severity": "Low",
            "subcategory": "Golden Images",
            "text": "Design your build process for custom images",
            "waf": "Operations"
        },
        {
            "category": "Compute",
            "checklist": "Azure Virtual Desktop Review",
            "description": "There are some known best practices and recommendations for the golden image customization, be sure to check the referenced article.",
            "guid": "deace4cb-1dec-44c6-90c3-fc14eebb36a3",
            "link": "https://learn.microsoft.com/azure/virtual-desktop/set-up-golden-image",
            "services": [
                "AVD"
            ],
            "severity": "Medium",
            "subcategory": "Golden Images",
            "text": "If custom image will be used, check recommended best practices for AVD on how to build custom image",
            "waf": "Operations"
        },
        {
            "category": "Compute",
            "checklist": "Azure Virtual Desktop Review",
            "description": "FSLogix stack installed in AVD session hosts does not provide auto-update capability. For this reason, it is recommended to download the latest version of FSLogix and include in the golden image update process.",
            "guid": "ed5c9027-dd1a-4343-86ca-52b199223186",
            "link": "https://learn.microsoft.com/fslogix/how-to-install-fslogix",
            "services": [
                "AVD"
            ],
            "severity": "High",
            "subcategory": "Golden Images",
            "text": "Include the latest version of FSLogix in the golden image update process",
            "waf": "Reliability"
        },
        {
            "category": "Compute",
            "checklist": "Azure Virtual Desktop Review",
            "description": "This tool-set has been created to automatically apply setting referenced in white paper 'Optimizing Windows 10, version 2004 for a Virtual Desktop Infrastructure (VDI) role': https://docs.microsoft.com/windows-server/remote/remote-desktop-services/rds-vdi-recommendations-2004. Usage of the tool and/or optimizations mentioned in the white-paper should be considered. ",
            "guid": "829e3fec-2183-4687-a017-7a2b5945bda4",
            "link": "https://github.com/The-Virtual-Desktop-Team/Virtual-Desktop-Optimization-Tool",
            "services": [
                "AVD",
                "RBAC"
            ],
            "severity": "Low",
            "subcategory": "Golden Images",
            "text": "Evaluate the usage of Virtual-Desktop-Optimization-Tool",
            "waf": "Performance"
        },
        {
            "category": "Compute",
            "checklist": "Azure Virtual Desktop Review",
            "description": "If OneDrive is used and included in a golden image, be sure to follow the configuration procedure reported in the companion article in the 'More Info' section. Not in scope in this AVD checklist, but OneDrive optimizations like 'Known Folder Redirection' and 'Files On-Demand' should be evaluated used to reduce the space used in FSLogix profiles and provide a better user experience. OneDrive today is not supported for Remote Apps.",
            "guid": "e3d3e084-4276-4d4b-bc01-5bcf219e4a1e",
            "link": "https://learn.microsoft.com/azure/virtual-desktop/install-office-on-wvd-master-image#install-onedrive-in-per-machine-mode",
            "services": [
                "AVD",
                "Storage"
            ],
            "severity": "Low",
            "subcategory": "Golden Images",
            "text": "Determine if Microsoft OneDrive will be part of AVD deployment",
            "waf": "Operations"
        },
        {
            "category": "Compute",
            "checklist": "Azure Virtual Desktop Review",
            "description": "Be sure to review the requirements and configuration procedure contained in the companion article in the 'More Info' column. Since Teams automatic updates will be disabled, it is recommended to check and include Teams latest version in the golden image update process.",
            "guid": "b5887953-5d22-4788-9d30-b66c67be5951",
            "link": "https://learn.microsoft.com/azure/virtual-desktop/teams-on-AVD",
            "services": [
                "AVD"
            ],
            "severity": "Low",
            "subcategory": "Golden Images",
            "text": "Determine if Microsoft Teams will be part of AVD deployment",
            "waf": "Performance"
        },
        {
            "category": "Compute",
            "checklist": "Azure Virtual Desktop Review",
            "description": "AVD can support users with different language and localization requirements in the same host pool. This can be done customizing golden images to ensure users can select whichever language they need. The procedure to configure additional language packs in Windows 11 is documented in the reference article.",
            "guid": "7c336f3b-822a-498e-8cd1-667d1150df4a",
            "link": "https://learn.microsoft.com/azure/virtual-desktop/windows-11-language-packs",
            "services": [
                "AVD"
            ],
            "severity": "Low",
            "subcategory": "Golden Images",
            "text": "Assess the requirement to support multiple languages",
            "waf": "Reliability"
        },
        {
            "category": "Compute",
            "checklist": "Azure Virtual Desktop Review",
            "description": "It is highly recommended to use separate storage accounts/shares to store MSIX packages. If necessary, storage can scale out independently and not being impacted by profile I/O activities. Azure offers multiple storage options that can be used for MISX app attach. We recommend using Azure Files or Azure NetApp Files as those options offer the best value between cost and management overhead. ",
            "guid": "90083845-c587-4cb3-a1ec-16a1d076ef9f",
            "link": "https://docs.microsoft.com/azure/virtual-desktop/app-attach-file-share",
            "services": [
                "AVD",
                "Cost",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "MSIX & AppAttach",
            "text": "Do not use the same storage account/share as FSLogix profiles",
            "waf": "Performance"
        },
        {
            "category": "Compute",
            "checklist": "Azure Virtual Desktop Review",
            "description": "In the referenced article, we reported few but important performance considerations for MSIX usage in AVD context, be sure to carefully review.",
            "guid": "241addce-5793-477b-adb3-751ab2ac1fad",
            "link": "https://docs.microsoft.com/azure/virtual-desktop/app-attach-file-share",
            "services": [
                "AVD"
            ],
            "severity": "Medium",
            "subcategory": "MSIX & AppAttach",
            "text": "Review performance considerations for MSIX",
            "waf": "Performance"
        },
        {
            "category": "Compute",
            "checklist": "Azure Virtual Desktop Review",
            "description": "MSIX app attach requires read-only permissions to access the file share. If you're storing your MSIX applications in Azure Files, then for your session hosts, you'll need to assign all session host VMs both storage account role-based access control (RBAC) and file share New Technology File System (NTFS) permissions on the share.",
            "guid": "66e15d4d-5a2a-4db2-a3e2-326bf225ca41",
            "link": "https://docs.microsoft.com/azure/virtual-desktop/app-attach-file-share",
            "services": [
                "AVD",
                "RBAC",
                "VM",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "MSIX & AppAttach",
            "text": "Check proper session host permissions for MSIX share",
            "waf": "Security"
        },
        {
            "category": "Compute",
            "checklist": "Azure Virtual Desktop Review",
            "description": "3rd-party software vendor must provide a MSIX package, it is not recommended for customer to attempt the conversion procedure without proper support from the application owner.",
            "guid": "bd362caa-ab79-4b19-adab-81932c9fc9d1",
            "link": "https://docs.microsoft.com/azure/virtual-desktop/app-attach-faq",
            "services": [
                "AVD"
            ],
            "severity": "Low",
            "subcategory": "MSIX & AppAttach",
            "text": "MSIX packages for 3rd-party applications",
            "waf": "Cost"
        },
        {
            "category": "Compute",
            "checklist": "Azure Virtual Desktop Review",
            "description": "MSIX app attach doesn't support auto-update for MSIX applications, so they should be disabled.",
            "guid": "bb88037f-5e6b-4fbb-aed5-03547cc447e8",
            "link": "https://docs.microsoft.com/azure/virtual-desktop/app-attach-faq",
            "services": [
                "AVD"
            ],
            "severity": "Low",
            "subcategory": "MSIX & AppAttach",
            "text": "Disable auto-update for MSIX packages",
            "waf": "Operations"
        },
        {
            "category": "Compute",
            "checklist": "Azure Virtual Desktop Review",
            "description": "In order to leverage MSIX & App Attach, guest OS image for AVD Host pool must be Windows 10/11 Enterprise or Windows 10/11 Enterprise Multi-session, version 2004 or later.",
            "guid": "26128a71-f0f1-4cac-9d9e-f1d5e832e42e",
            "link": "https://docs.microsoft.com/azure/virtual-desktop/app-attach-faq",
            "services": [
                "AVD"
            ],
            "severity": "Medium",
            "subcategory": "MSIX & AppAttach",
            "text": "Review operating systems support",
            "waf": "Reliability"
        },
        {
            "category": "Compute",
            "checklist": "Azure Virtual Desktop Review",
            "description": "Once selected the VM SKU that will be used for Host Pool deployment, it is recommended to use Gen2 type of the SKU for higher security and improved capabilities.",
            "guid": "e4633254-3185-40a1-b120-bd563a1c8e9d",
            "link": "https://docs.microsoft.com/azure/virtual-machines/generation-2",
            "services": [
                "AVD",
                "VM"
            ],
            "severity": "Medium",
            "subcategory": "Session Host",
            "text": "Evaluate the usage of Gen2 VM for Host Pool deployment",
            "waf": "Performance"
        },
        {
            "category": "Compute",
            "checklist": "Azure Virtual Desktop Review",
            "description": "MMR redirects the media content from Session Host to your local machine for faster processing and rendering. It only works when you play media content on Microsoft Edge or Google Chrome. See linked URL for more details.",
            "guid": "adecb27f-dc40-40f5-aca2-0090f633b1c9",
            "link": "https://learn.microsoft.com/azure/virtual-desktop/multimedia-redirection",
            "services": [
                "AVD"
            ],
            "severity": "Low",
            "subcategory": "Session Host",
            "text": "Consider using MMR (MultiMedia Redirection) to get better video performance on browser",
            "waf": "Performance"
        },
        {
            "category": "Foundation",
            "checklist": "Azure Virtual Desktop Review",
            "description": "A host pool is a collection of Azure virtual machines that register to Azure Virtual Desktop as session hosts. A host pool can be one of two types: Personal and Pooled. Which type to use, and how many, is a key design decision that must be documented and validated. See companion article in 'More Info' column for more details.",
            "guid": "8468c55a-775c-46ee-a5b8-6ad8844ce3b2",
            "link": "https://learn.microsoft.com/azure/virtual-desktop/terminology#host-pools",
            "services": [
                "AVD",
                "VM"
            ],
            "severity": "High",
            "subcategory": "Capacity Planning",
            "text": "Determine the Host Pool type to use",
            "waf": "Cost"
        },
        {
            "category": "Foundation",
            "checklist": "Azure Virtual Desktop Review",
            "description": "Use your design criteria to determine the number of Host Pools to deploy. This will be based on factors such as different OS images, multi-region support, guest VM hardware differences (such as GPU support or no), different user expectations and uptime requirements (examples might be 'Executives', 'Office Workers', 'Developers', etc.), and Host Pool RDP settings (such as drive redirection support). These will determine the number of host pools as well as how many hosts will be in each pool.",
            "guid": "4e98495f-d3c0-4af2-aa59-a793395a32a7",
            "link": "https://learn.microsoft.com/azure/virtual-desktop/terminology?WT.mc_id=Portal-fx#host-pools",
            "services": [
                "AVD",
                "VM"
            ],
            "severity": "High",
            "subcategory": "Capacity Planning",
            "text": "Estimate the number of different Host Pools to deploy ",
            "waf": "Performance"
        },
        {
            "category": "Foundation",
            "checklist": "Azure Virtual Desktop Review",
            "description": "Confirm that the difference between automatic and direct assignment is well understood and the selected option is appropriate for the scenario in question. Automatic is the default setting.",
            "guid": "b38b875b-a1cf-4204-a901-3a5d3ce474db",
            "link": "https://docs.microsoft.com/azure/virtual-desktop/configure-host-pool-personal-desktop-assignment-type",
            "services": [
                "AVD"
            ],
            "severity": "Low",
            "subcategory": "Capacity Planning",
            "text": "For Personal Host Pool type, select the proper assignment type",
            "waf": "Operations"
        },
        {
            "category": "Foundation",
            "checklist": "Azure Virtual Desktop Review",
            "description": "Check which one to use and available options, autoscale ignores existing load-balancing algorithms.",
            "guid": "cbd8682a-6abc-4a2a-9fda-1dbf3dc95d48",
            "link": "https://docs.microsoft.com/azure/virtual-desktop/host-pool-load-balancing",
            "services": [
                "AVD"
            ],
            "severity": "Low",
            "subcategory": "Capacity Planning",
            "text": "For Pooled Host Pool type, select the best load balancing method",
            "waf": "Performance"
        },
        {
            "category": "Foundation",
            "checklist": "Azure Virtual Desktop Review",
            "description": "The number of cores increase, the system's synchronization overhead also increases. Especially for multiple user's sign-in simultaneously. Make sure not to use a VM that is too large for the session host",
            "guid": "b3724959-4943-4577-a3a9-e10ff6345f24",
            "link": "https://learn.microsoft.com/windows-server/remote/remote-desktop-services/virtual-machine-recs",
            "services": [
                "AVD",
                "VM"
            ],
            "severity": "Medium",
            "subcategory": "Capacity Planning",
            "text": "For Pooled Host Pool type, VMs shouldn't have more than 32 cores",
            "waf": "Performance"
        },
        {
            "category": "Foundation",
            "checklist": "Azure Virtual Desktop Review",
            "description": "AVD does not support assigning both the RemoteApp and Desktop Application Group (DAG) in a single host pool to the same set of users. Doing so will cause a single user to have two user sessions in a single host pool. Users aren't supposed to have two active sessions at the same time in the same host pool using the same profile.",
            "guid": "b384b7ed-1cdd-457e-a2cd-c8d4d55bc144",
            "link": "https://learn.microsoft.com/azure/virtual-desktop/terminology?WT.mc_id=Portal-fx#application-groups",
            "services": [
                "AVD",
                "Storage"
            ],
            "severity": "High",
            "subcategory": "Capacity Planning",
            "text": "Do not use the same Host Pool to offer both full desktops (DAG) and Remote Apps to the same set of users",
            "waf": "Security"
        },
        {
            "category": "Foundation",
            "checklist": "Azure Virtual Desktop Review",
            "description": "There is a limit of 500 Application Groups that can be created in AVD for each Microsoft Entra ID (former Azure AD) tenant. The limit can be increased (see the companion link for details) but it is not recommended.",
            "guid": "971cc4a4-b1f7-4c12-90e0-1ad96808f00c",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits#azure-virtual-desktop-service-limits",
            "services": [
                "AVD",
                "Entra",
                "ACR"
            ],
            "severity": "Medium",
            "subcategory": "Capacity Planning",
            "text": "Estimate the number of Application Groups required across all Host Pools in the Microsoft Entra ID tenant",
            "waf": "Reliability"
        },
        {
            "category": "Foundation",
            "checklist": "Azure Virtual Desktop Review",
            "description": "Applications are grouped under Application Groups as containers for publishing and assigning permissions: we recommend that you do not publish more than 50 applications per application group.",
            "guid": "fa9f2895-473d-439b-ab8e-5a5cf92c7f32",
            "link": "https://learn.microsoft.com/azure/architecture/example-scenario/wvd/windows-virtual-desktop#considerations",
            "services": [
                "AVD"
            ],
            "severity": "Low",
            "subcategory": "Capacity Planning",
            "text": "Estimate the number of Applications for each Application Group",
            "waf": "Reliability"
        },
        {
            "category": "Foundation",
            "checklist": "Azure Virtual Desktop Review",
            "description": "FSLogix is not required for Personal Host Pools since each VM is statically assigned to a single user, then no immediate needs for a roaming profile solution. In some usage scenarios FSLogix can help. For example, a VM can be re-assigned, or user moved to another desktop, or roaming profile can be used to save user profile in a different location for DR purposes.",
            "guid": "38b19ab6-0693-4992-9394-5590883916ec",
            "link": "https://learn.microsoft.com/azure/virtual-desktop/configure-host-pool-personal-desktop-assignment-type?tabs=azure#reassign-a-personal-desktop",
            "services": [
                "AVD",
                "VM",
                "Storage"
            ],
            "severity": "Low",
            "subcategory": "Capacity Planning",
            "text": "Evaluate the usage of FSLogix for Personal Host Pools",
            "waf": "Reliability"
        },
        {
            "category": "Foundation",
            "checklist": "Azure Virtual Desktop Review",
            "description": "Use the link provided to set a starting point for SKU decision, then validate using a performance test. Ensure a minimum of four cores for Production is selected per Session Host (multi-session)",
            "guid": "e1112dbd-7ba0-412e-9b94-ef6e047d2ea2",
            "link": "https://docs.microsoft.com/windows-server/remote/remote-desktop-services/virtual-machine-recs",
            "services": [
                "AVD",
                "VM"
            ],
            "severity": "High",
            "subcategory": "Capacity Planning",
            "text": "Run workload performance test to determine the best Azure VM SKU and size to use",
            "waf": "Performance"
        },
        {
            "category": "Foundation",
            "checklist": "Azure Virtual Desktop Review",
            "description": "It is critical to check AVD capacity and limits reported in the referenced article. Additional limits and thresholds apply for network, compute, storage and service management. ",
            "guid": "992b1cd6-d2f5-44b2-a769-e3a691e8838a",
            "link": "https://learn.microsoft.com/azure/architecture/example-scenario/wvd/windows-virtual-desktop#considerations",
            "services": [
                "AVD",
                "Storage"
            ],
            "severity": "High",
            "subcategory": "Capacity Planning",
            "text": "Verify AVD scalability limits for the environment",
            "waf": "Reliability"
        },
        {
            "category": "Foundation",
            "checklist": "Azure Virtual Desktop Review",
            "description": "Host Pools with GPU require special configuration, please be sure to review the referenced article.",
            "guid": "c936667e-13c0-4056-94b1-e945a459837e",
            "link": "https://docs.microsoft.com/azure/virtual-desktop/configure-vm-gpu",
            "services": [
                "AVD"
            ],
            "severity": "Low",
            "subcategory": "Capacity Planning",
            "text": "Determine if  Session Hosts will require GPU",
            "waf": "Performance"
        },
        {
            "category": "Foundation",
            "checklist": "Azure Virtual Desktop Review",
            "description": "Whenever is possible, it is recommended to leverage VM SKUs with Accelerated Networking feature. This feature does require specific VM SKU/size and OS versions, please see the list and requirement in the companion article.",
            "guid": "b47a393a-0803-4272-a479-8b1578b219a4",
            "link": "https://learn.microsoft.com/azure/virtual-network/accelerated-networking-overview",
            "services": [
                "AVD",
                "VM"
            ],
            "severity": "Low",
            "subcategory": "Capacity Planning",
            "text": "Use Azure VM SKUs able to leverage Accelerated Networking",
            "waf": "Performance"
        },
        {
            "category": "Foundation",
            "checklist": "Azure Virtual Desktop Review",
            "description": "For proper planning and deployment, it is important to assess the maximum number of concurrent and total users for each Host Pool. Additionally, users from different regions may require different Host Pools to ensure the best user experience.",
            "guid": "bb91a33d-90ca-4e2c-a881-3706f7c0cb9f",
            "link": "https://learn.microsoft.com/azure/virtual-desktop/overview",
            "services": [
                "AVD"
            ],
            "severity": "Medium",
            "subcategory": "Clients & Users",
            "text": "Assess how many users will connect to AVD and from which regions",
            "waf": "Performance"
        },
        {
            "category": "Foundation",
            "checklist": "Azure Virtual Desktop Review",
            "description": "The dependencies on resources external to the AVD pool should be assessed and reviewed, for example Active Directory, external file shares or other storage, on-premises services and resources, network infrastructure components like VPN and or ExpressRoute, external services and 3rd-party components. For all these resources, latency from the AVD Host Pool needs to be evaluated and connectivity considered. Additionally, BCDR considerations need to be applied to these dependencies as well.",
            "guid": "6abca2a4-fda1-4dbf-9dc9-5d48c7c791dc",
            "link": "https://learn.microsoft.com/azure/architecture/example-scenario/wvd/windows-virtual-desktop?toc=%2Fazure%2Fvirtual-desktop%2Ftoc.json&bc=%2Fazure%2Fvirtual-desktop%2Fbreadcrumb%2Ftoc.json",
            "services": [
                "AVD",
                "ExpressRoute",
                "VPN",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Clients & Users",
            "text": "Assess external dependencies for each Host Pool",
            "waf": "Performance"
        },
        {
            "category": "Foundation",
            "checklist": "Azure Virtual Desktop Review",
            "description": "AVD offers a variety of client types (fat, thin, web) to connect over different platforms (Windows, MacOS, iOS, Android). Review limitations of each client and compare multiple options when possible.",
            "guid": "a1f6d565-99e5-458b-a37d-4985e1112dbd",
            "link": "https://learn.microsoft.com/azure/virtual-desktop/users/connect-windows",
            "services": [
                "AVD"
            ],
            "severity": "Low",
            "subcategory": "Clients & Users",
            "text": "Review user client OS used and AVD client type",
            "waf": "Performance"
        },
        {
            "category": "Foundation",
            "checklist": "Azure Virtual Desktop Review",
            "description": "Depending on the user locations, and AVD region deployment, users may have a non-optimal experience, hence is important to test as soon as possible in a small PoC environment. Run the 'Azure Virtual Desktop Experience Estimator' tool to select the best Azure region to deploy Host Pools. Beyond 150ms latency, user experience may be not optimal.",
            "guid": "d2f54b29-769e-43a6-a1e8-838ac936667e",
            "link": "https://azure.microsoft.com/services/virtual-desktop/assessment/",
            "services": [
                "AVD"
            ],
            "severity": "High",
            "subcategory": "Clients & Users",
            "text": "Run a PoC to validate end-to-end user experience and impact of network latency",
            "waf": "Performance"
        },
        {
            "category": "Foundation",
            "checklist": "Azure Virtual Desktop Review",
            "description": "RDP settings can currently only be configured at the host pool level, not per user/group. If different settings are required for different set of users, it is recommended to create multiple Host Pools.",
            "guid": "3b365a5c-7acb-4e48-abe5-4cd79f2e8776",
            "link": "https://docs.microsoft.com/azure/virtual-desktop/customize-rdp-properties",
            "services": [
                "AVD"
            ],
            "severity": "Low",
            "subcategory": "Clients & Users",
            "text": "Assess and document RDP settings for all user groups",
            "waf": "Security"
        },
        {
            "category": "Foundation",
            "checklist": "Azure Virtual Desktop Review",
            "description": "AVD is a non-regional service, Host Pools can be created in any region, automatic redirection from closest front-end will happen automatically.",
            "guid": "42e52f47-21d9-428c-8b1b-d521e44a29a9",
            "link": "https://azure.microsoft.com/global-infrastructure/services/?products=virtual-desktop",
            "services": [
                "AVD"
            ],
            "severity": "High",
            "subcategory": "General",
            "text": "Determine in which Azure regions AVD Host Pools will be deployed.",
            "waf": "Performance"
        },
        {
            "category": "Foundation",
            "checklist": "Azure Virtual Desktop Review",
            "description": "AVD must store metadata to support the service; this is stored in the specified geography. However, this is independent of the regions where Host Pools are located.",
            "guid": "bad37ead-53cc-47ce-8d7a-aab3571449ab",
            "link": "https://docs.microsoft.com/azure/virtual-desktop/data-locations",
            "services": [
                "AVD"
            ],
            "severity": "Medium",
            "subcategory": "General",
            "text": "Determine metadata location for AVD service",
            "waf": "Reliability"
        },
        {
            "category": "Foundation",
            "checklist": "Azure Virtual Desktop Review",
            "description": "Check for specific VM SKUs, especially if you need GPU or high-specs SKUs, and eventually Azure NetApp Files if used.",
            "guid": "8053d89e-89dc-47b3-9be2-a1a27f7a9e91",
            "link": "https://docs.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits",
            "services": [
                "AVD",
                "VM",
                "Storage"
            ],
            "severity": "Low",
            "subcategory": "General",
            "text": "Check Azure quotas and availability for specific VM sizes and types in the selected regions",
            "waf": "Reliability"
        },
        {
            "category": "Identity",
            "checklist": "Azure Virtual Desktop Review",
            "description": "AD DCs in Azure are recommended (at least two in different AZ) to reduce latency for users logging into AVD session hosts, and eventually for Azure NetApp Files and AD integration. A DC need to be able to talk to DCs for ALL child domains. As alternative, on-premise connectivity must be used to reach AD DCs.",
            "guid": "c14aea7e-65e8-4d9a-9aec-218e6436b073",
            "link": "https://docs.microsoft.com/azure/architecture/reference-architectures/identity/adds-extend-domain",
            "services": [
                "AVD",
                "VNet",
                "Entra",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Active Directory",
            "text": "Create at least two Active Directory Domain Controllers (DCs) in Azure VNet environment close to AVD Host Pool",
            "waf": "Reliability"
        },
        {
            "category": "Identity",
            "checklist": "Azure Virtual Desktop Review",
            "description": "Recommended to create a separate OU per Host Pool under a separate OU hierarchy. These OUs will contain machine accounts of AVD Session Hosts. ",
            "guid": "6db55f57-9603-4334-adf9-cc23418db612",
            "link": "https://docs.microsoft.com/azure/virtual-desktop/create-host-pools-azure-marketplace",
            "services": [
                "AVD",
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Active Directory",
            "text": "Create a specific OU in Active Directory for each Host Pool",
            "waf": "Operations"
        },
        {
            "category": "Identity",
            "checklist": "Azure Virtual Desktop Review",
            "description": "Carefully review, and potentially block/filter inheritance of GPOs to the OUs containing AVD Host Pools. ",
            "guid": "7126504b-b47a-4393-a080-327294798b15",
            "link": "https://docs.microsoft.com/previous-versions/windows/desktop/Policy/group-policy-hierarchy",
            "services": [
                "AVD",
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Active Directory",
            "text": "Review Domain GPOs that will be applied to OU and impacting Host Pool Session Hosts functionalities",
            "waf": "Operations"
        },
        {
            "category": "Identity",
            "checklist": "Azure Virtual Desktop Review",
            "description": "If Active Directory Domain GPOs are used, it is recommended to configure FSLogix using the built-in provided GPO ADMX template referenced in the companion article in the 'More Info' column",
            "guid": "2226a8e3-50a4-4ac3-8bd6-ee150553051f",
            "link": "https://learn.microsoft.com/fslogix/how-to-use-group-policy-templates",
            "services": [
                "AVD",
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Active Directory",
            "text": "Configure FSLogix settings using the built-in provided GPO ADMX template",
            "waf": "Operations"
        },
        {
            "category": "Identity",
            "checklist": "Azure Virtual Desktop Review",
            "description": "It is recommended to have a specific dedicated account with minimal permissions, and without the default 10 joins limitation. Review the companion article for more details.",
            "guid": "347dc560-28a7-41ff-b1cd-15dd2f0d5e77",
            "link": "https://learn.microsoft.com/azure/virtual-desktop/prerequisites?tabs=portal#session-hosts",
            "services": [
                "AVD",
                "Entra",
                "VM"
            ],
            "severity": "Medium",
            "subcategory": "Active Directory",
            "text": "Create a dedicated user account with only permissions to join VM to the domain",
            "waf": "Security"
        },
        {
            "category": "Identity",
            "checklist": "Azure Virtual Desktop Review",
            "description": "Avoid granting access per user, instead use AD groups and replicate them using Active Directory Connector (ADC) in Microsoft Entra ID (former Azure AD). ",
            "guid": "2d41e361-1cc5-47b4-a4b1-410d43958a8c",
            "link": "https://docs.microsoft.com/azure/virtual-desktop/manage-app-groups",
            "services": [
                "AVD",
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Active Directory",
            "text": "Create a domain user group for each set of users that will be granted access to each Host Pool Application Group (DAG or RAG)",
            "waf": "Security"
        },
        {
            "category": "Identity",
            "checklist": "Azure Virtual Desktop Review",
            "description": "If Azure Files Active Directory (AD) integration is used, as part of the configuration procedure, an AD account to represent the storage account (file share) will be created. You can choose to register as a computer account or service logon account, see FAQ for details. For computer accounts, there is a default password expiration age set in AD at 30 days. Similarly, the service logon account may have a default password expiration age set on the AD domain or Organizational Unit (OU). For both account types, we recommend you check the password expiration age configured in your AD environment and plan to update the password of your storage account identity of the AD account before the maximum password age. You can consider creating a new AD Organizational Unit (OU) in AD and disabling password expiration policy on computer accounts or service logon accounts accordingly.",
            "guid": "2289b3d6-b57c-4fc6-9546-1e1a3e3453a3",
            "link": "https://docs.microsoft.com/azure/storage/files/storage-files-identity-ad-ds-enable",
            "services": [
                "AVD",
                "Entra",
                "AzurePolicy",
                "Storage"
            ],
            "severity": "High",
            "subcategory": "Active Directory",
            "text": "Review your organization password expiration policy for accounts used by Azure Files AD integration",
            "waf": "Security"
        },
        {
            "category": "Identity",
            "checklist": "Azure Virtual Desktop Review",
            "description": "You can configure this using Active Directory Connect (ADC) or Azure AD Domain Services (for hybrid or cloud organizations). Microsoft Entra ID is the new name for Azure Active Directory (Azure AD).",
            "guid": "5119bf8e-8f58-4542-a7d9-cec166cd072a",
            "link": "https://learn.microsoft.com/azure/virtual-desktop/prerequisites?tabs=portal#identity",
            "services": [
                "AVD",
                "Entra"
            ],
            "severity": "High",
            "subcategory": "Active Directory",
            "text": "A Windows Server Active Directory forest/domain must be in sync with Microsoft Entra ID",
            "waf": "Reliability"
        },
        {
            "category": "Identity",
            "checklist": "Azure Virtual Desktop Review",
            "description": "If Azure Files is used and pre-requisites can be satisfied, it is recommended to configure (Microsoft Entra ID) Kerberos authentication. This configuration will allow to store FSLogix profiles that can be accessed by hybrid user identities from Azure AD-joined session hosts without requiring network line-of-sight to domain controllers.",
            "guid": "e777fd5e-c5f1-4d6e-8fa9-fc210b88e338",
            "link": "https://learn.microsoft.com/azure/storage/files/storage-files-identity-auth-hybrid-identities-enable",
            "services": [
                "AVD",
                "Entra",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Microsoft Entra ID",
            "text": "Configure Azure Files share for Microsoft Entra ID (former Azure AD) Kerberos authentication on Microsoft Entra ID Joined scenario",
            "waf": "Security"
        },
        {
            "category": "Identity",
            "checklist": "Azure Virtual Desktop Review",
            "description": "An Azure subscription must be parented to the same Microsoft Entra ID (former Azure AD) tenant, that contains a virtual network that either contains or is connected to the Windows Server Active Directory Domain Services or Microsoft Entra ID Domain Services instance.",
            "guid": "6ceb5443-5125-4922-9442-93bb628537a5",
            "link": "https://learn.microsoft.com/azure/virtual-desktop/prerequisites?tabs=portal#identity",
            "services": [
                "AVD",
                "Entra",
                "Subscriptions",
                "VNet"
            ],
            "severity": "High",
            "subcategory": "Requirements",
            "text": "A Microsoft Entra ID tenant must be available with at least one subscription linked",
            "waf": "Reliability"
        },
        {
            "category": "Identity",
            "checklist": "Azure Virtual Desktop Review",
            "description": "Azure Virtual Desktop supports different types of identities depending on which configuration you choose. Please review the supported scenarios mentioned in the 'More Info' article and document the design decision accordingly in the 'Comment' column. Critically, external identities (B2B or B2C) are not supported. Be sure to review also the list of supported scenarios in https://learn.microsoft.com/azure/virtual-desktop/prerequisites?tabs=portal#supported-identity-scenarios.",
            "guid": "b4ce4781-7557-4a1f-8043-332ae199d44c",
            "link": "https://learn.microsoft.com/azure/virtual-desktop/authentication",
            "services": [
                "AVD",
                "Entra"
            ],
            "severity": "High",
            "subcategory": "Requirements",
            "text": "Review and document your identity scenario",
            "waf": "Security"
        },
        {
            "category": "Identity",
            "checklist": "Azure Virtual Desktop Review",
            "description": "Users need accounts that are in Microsoft Entra ID (former Azure AD). If you're also using AD DS or Azure AD Domain Services in your deployment of Azure Virtual Desktop, these accounts will need to be hybrid identities, which means the user accounts are synchronized. If you're using Microsoft Entra ID with AD DS, you'll need to configure Azure AD Connect to synchronize user identity data between AD DS and Microsoft Entra ID. If you're using Microsoft Entra ID with Azure AD Domain Services, user accounts are synchronized one way from Microsoft Entra ID to Azure AD Domain Services. This synchronization process is automatic. AVD also supports Microsoft Entra ID native accounts with some restrictions. External identities (B2B or B2C) are not supported.",
            "guid": "f9b141a8-98a5-435e-9378-97e71ca7da7b",
            "link": "https://learn.microsoft.com/azure/virtual-desktop/prerequisites?tabs=portal#supported-identity-scenarios",
            "services": [
                "AVD",
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Requirements",
            "text": "Assess User Account types and requirements",
            "waf": "Security"
        },
        {
            "category": "Identity",
            "checklist": "Azure Virtual Desktop Review",
            "description": "AVD supports SSO using either Active Directory Federation Services (AD FS) or Microsoft Entra ID (former Azure AD) authentication. The latter is recommended, please check the requirements and limitation in the 'More Info' article. Using AD FS could be a viable choice if already present in the customer environment, it is not recommended to deploy a brand new ADFS infrastructure just for AVD SSO implementation.",
            "guid": "5f9f680a-ba07-4429-bbf7-93d7071561f4",
            "link": "https://learn.microsoft.com/azure/virtual-desktop/authentication#single-sign-on-sso",
            "services": [
                "AVD",
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Requirements",
            "text": "If Single-Sign On (SSO) is a requirement, review the supported scenarios and prerequisites",
            "waf": "Reliability"
        },
        {
            "category": "Identity",
            "checklist": "Azure Virtual Desktop Review",
            "description": "VMs can be Windows Active Directory (AD) domain-joined, Hybrid AD-joined, Microsoft Entra ID (former Azure AD) Joined or Azure AD Domain Services joined. Be sure to review supported scenarios, limitations and requirements from the referenced article.",
            "guid": "ea962a15-9394-46da-a7cc-3923266b2258",
            "link": "https://learn.microsoft.com/azure/virtual-desktop/prerequisites?tabs=portal#supported-identity-scenarios",
            "services": [
                "AVD",
                "Entra",
                "VM"
            ],
            "severity": "High",
            "subcategory": "Requirements",
            "text": "Select the proper AVD Session Host domain join type",
            "waf": "Security"
        },
        {
            "category": "Identity",
            "checklist": "Azure Virtual Desktop Review",
            "description": "Compare self-managed Windows Active Directory Domain Services, Microsoft Entra ID (former Azure AD), and managed Azure AD Domain Services (AAD-DS)",
            "guid": "6f4a1651-bddd-4ea8-a487-cdeb4861bc3b",
            "link": "https://docs.microsoft.com/azure/active-directory-domain-services/compare-identity-solutions",
            "services": [
                "AVD",
                "Entra"
            ],
            "severity": "Low",
            "subcategory": "Requirements",
            "text": "Before using Azure AD Domain Services (AAD-DS) for AVD, be sure to review the limitations.",
            "waf": "Reliability"
        },
        {
            "category": "Monitoring and Management",
            "checklist": "Azure Virtual Desktop Review",
            "description": "AVD provides administrative templates for Intune and Active Directory GPO. Using these templates it is possible to centrally control several AVD configuration settings: Graphics related data logging, Screen capture protection, RDP Shortpath for managed networks, Watermarking. See companion article in 'More Info' colum for details. NOTE: FSLogix has its own separate template.",
            "guid": "5549524b-36c0-4f1a-892b-ab3ca78f5db2",
            "link": "https://learn.microsoft.com/azure/virtual-desktop/administrative-template",
            "services": [
                "AVD",
                "Entra",
                "Monitor"
            ],
            "severity": "Low",
            "subcategory": "Management",
            "text": "Use built-in provided administrative templates for AVD settings configuration",
            "waf": "Operations"
        },
        {
            "category": "Monitoring and Management",
            "checklist": "Azure Virtual Desktop Review",
            "description": "Determine if a configuration management tool is already in place to manage Host Pool VM configuration after initial deployment, For example SCCM/SCOM, Intune/ConfigurationManager, 3rd-party solutions.",
            "guid": "3334fdf9-1c23-4418-8b65-285269440b4b",
            "link": "https://learn.microsoft.com/azure/virtual-desktop/management",
            "services": [
                "AVD",
                "Monitor",
                "VM"
            ],
            "severity": "Low",
            "subcategory": "Management",
            "text": "Plan AVD Session Hosts configuration management strategy",
            "waf": "Operations"
        },
        {
            "category": "Monitoring and Management",
            "checklist": "Azure Virtual Desktop Review",
            "description": "We recommend using Microsoft Intune, if requirements can be satisfied, to manage your Azure Virtual Desktop environment. Review supported scenarios and requirements to enable Intune for AVD Session Host management in the referenced article in the More Info column. Document your choice in the 'Comment' column. In that article, review the different requirements and capabilities for single-session https://learn.microsoft.com/mem/intune/fundamentals/windows-virtual-desktop and multi-session https://learn.microsoft.com/mem/intune/fundamentals/windows-virtual-desktop-multi-session AVD.",
            "guid": "63a08be1-6004-4b4a-a79b-f3239faae113",
            "link": "https://learn.microsoft.com/mem/intune/fundamentals/azure-virtual-desktop",
            "services": [
                "AVD",
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Management",
            "text": "Evaluate Intune for AVD Session Hosts management",
            "waf": "Operations"
        },
        {
            "category": "Monitoring and Management",
            "checklist": "Azure Virtual Desktop Review",
            "description": "The scaling tool provides a low-cost automation option for customers who want to optimize their session host VM costs. You can use the scaling tool to schedule VMs to start and stop based on Peak and Off-Peak business hours, scale out VMs based on number of sessions per CPU core, scale in VMs during Off-Peak hours, leaving the minimum number of session host VMs running. Not available yet for Personal Host Pool type.",
            "guid": "7138b820-102c-4e16-be30-1e6e872e52e3",
            "link": "https://learn.microsoft.com/azure/virtual-desktop/autoscale-scenarios",
            "services": [
                "AVD",
                "Monitor",
                "VM",
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Management",
            "text": "Assess the requirements for host pool auto-scaling capability",
            "waf": "Reliability"
        },
        {
            "category": "Monitoring and Management",
            "checklist": "Azure Virtual Desktop Review",
            "description": "Start VM On Connect lets you reduce costs by enabling end users to turn on their session host virtual machines (VMs) only when they need them. You can then turn off VMs when they're not needed. You can configure Start VM on Connect for personal or pooled host pools using the Azure portal or PowerShell. Start VM on Connect is a host pool wide setting.",
            "guid": "55f612fe-f215-4f0d-a956-10e7dd96bcbc",
            "link": "https://learn.microsoft.com/azure/virtual-desktop/start-virtual-machine-connect",
            "services": [
                "AVD",
                "Monitor",
                "VM",
                "Cost"
            ],
            "severity": "Low",
            "subcategory": "Management",
            "text": "Consider the usage of Start VM on Connect for Personal Host Pools",
            "waf": "Cost"
        },
        {
            "category": "Monitoring and Management",
            "checklist": "Azure Virtual Desktop Review",
            "description": "'Start VM On Connect' provides a smart way to automatically start previously stopped Session Hosts but does not provide a mechanism to shut down when not in used. Administrators are encouraged to configure additional policies to sign users out of their sessions and run Azure automation scripts to de-allocate VMs. Users should be not allowed to shut down their Personal Hosts since will not be able to de-allocate Azure VMs, then billing will still be active with no cost reduction.",
            "guid": "79a686ea-d971-4ea0-a9a8-1aea074c94cb",
            "link": "https://learn.microsoft.com/azure/virtual-desktop/start-virtual-machine-connect-faq#are-vms-automatically-deallocated-when-a-user-stops-using-them",
            "services": [
                "Cost",
                "AVD",
                "AzurePolicy",
                "Monitor",
                "VM"
            ],
            "severity": "Low",
            "subcategory": "Management",
            "text": "Evaluate the implementation of an ad-hoc mechanism to shut down Personal AVD Session Hosts",
            "waf": "Cost"
        },
        {
            "category": "Monitoring and Management",
            "checklist": "Azure Virtual Desktop Review",
            "description": "Azure Virtual Desktop billing is mainly based on cost associated to compute, networking and storage resources consumed by Host Pools. In addition to this, costs can be generated by dependent resources, for example VPN or ExpressRoute or vWAN, Active Directory Domain Controllers, DNS, etc. There is no direct cost associated to AVD objects like workspaces, host pools or application groups. To make AVD associated costs more evident and grouped by Host Pool, it is recommended to use 'cm-resource-parent' tag. ",
            "guid": "51bcafca-476a-48fa-9b91-9645a7679f20",
            "link": "https://learn.microsoft.com/azure/virtual-desktop/tag-virtual-desktop-resources",
            "services": [
                "ExpressRoute",
                "DNS",
                "Cost",
                "AVD",
                "VPN",
                "VWAN",
                "Monitor",
                "Storage"
            ],
            "severity": "Low",
            "subcategory": "Management",
            "text": "Review and adopt suggested Azure Tags for Azure Virtual Desktop",
            "waf": "Cost"
        },
        {
            "category": "Monitoring and Management",
            "checklist": "Azure Virtual Desktop Review",
            "description": "Azure Advisor analyzes your configurations and telemetry to offer personalized recommendations to solve common problems. With these recommendations, you can optimize your Azure resources for reliability, security, operational excellence, performance, and cost.",
            "guid": "611dd68c-5a4b-4252-8e44-a59a9c2399c4",
            "link": "https://learn.microsoft.com/azure/virtual-desktop/azure-advisor-recommendations",
            "services": [
                "AVD",
                "Entra",
                "Monitor",
                "Cost"
            ],
            "severity": "Low",
            "subcategory": "Management",
            "text": "Periodically check Azure Advisor recommendations for AVD",
            "waf": "Operations"
        },
        {
            "category": "Monitoring and Management",
            "checklist": "Azure Virtual Desktop Review",
            "description": "Customers have several options: Microsoft Configuration Manager, this article explains how to automatically apply updates to a Azure Virtual Desktop session hosts running Windows 10/11: https://learn.microsoft.com/azure/virtual-desktop/configure-automatic-updates, Microsoft Intune: https://docs.microsoft.com/mem/intune/fundamentals/windows-virtual-desktop-multi-session, Azure Update Management and WSUS for Windows Server OS only (client OS not supported: https://learn.microsoft.com/azure/automation/update-management/operating-system-requirements), 3rd Party tools. Outside an emergency security patching situation, it is recommended to move away from an 'in-place' update strategy patching strategy and adopt a re-imaging approach.",
            "guid": "04722da2-9c2b-41cd-922f-54b29bade3aa",
            "link": "https://learn.microsoft.com/mem/intune/fundamentals/azure-virtual-desktop-multi-session",
            "services": [
                "AVD",
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Management",
            "text": "Plan for a Session Host emergency patching and update strategy",
            "waf": "Operations"
        },
        {
            "category": "Monitoring and Management",
            "checklist": "Azure Virtual Desktop Review",
            "description": "The Scheduled Agent Updates feature lets you create up to two maintenance windows per Host Pool to update AVD components at a convenient time. It is recommended to specify maintenance windows then upgrading Session Hosts will not happen during peak business hours. Scheduled Agent Updates is disabled by default. This means that, unless you enable this setting, the agent can get updated at any time by the agent update flighting service.",
            "guid": "c067939b-e5ca-4698-b9ce-3bd91843e73f",
            "link": "https://learn.microsoft.com/azure/virtual-desktop/scheduled-agent-updates",
            "services": [
                "AVD",
                "Monitor"
            ],
            "severity": "Low",
            "subcategory": "Management",
            "text": "Configure the Scheduled Agent Updates feature",
            "waf": "Reliability"
        },
        {
            "category": "Monitoring and Management",
            "checklist": "Azure Virtual Desktop Review",
            "description": "Host pools are a collection of one or more identical virtual machines within Azure Virtual Desktop environment. We highly recommend you create a validation host pool where service updates are applied first. This allows you to monitor service updates before the service applies them to your standard or non-validation environment.",
            "guid": "d1e8c38e-c936-4667-913c-005674b1e944",
            "link": "https://docs.microsoft.com/azure/virtual-desktop/create-validation-host-pool",
            "services": [
                "AVD",
                "Monitor",
                "VM"
            ],
            "severity": "Medium",
            "subcategory": "Management",
            "text": "Create a validation (canary) Host Pool",
            "waf": "Operations"
        },
        {
            "category": "Monitoring and Management",
            "checklist": "Azure Virtual Desktop Review",
            "description": "An AVD Host Pool can be deployed in several ways: Azure Portal, ARM templates, Azure CLI tool, Powershell, manual VM creation with registration token, Terraform, 3rd-party tools. It is important to adopt proper method/s to support automatic deployment through automation and CI/CD tools.",
            "guid": "a459c373-e7ed-4616-83b3-65a917ecbe48",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/wvd/eslz-platform-automation-and-devops",
            "services": [
                "AVD",
                "Monitor",
                "VM"
            ],
            "severity": "Medium",
            "subcategory": "Management",
            "text": "Determine Host Pool deployment strategy",
            "waf": "Operations"
        },
        {
            "category": "Monitoring and Management",
            "checklist": "Azure Virtual Desktop Review",
            "description": "After you register a VM to a host pool within the Azure Virtual Desktop service, the agent regularly refreshes the VM's token whenever the VM is active. The certificate for the registration token is valid for 90 days. Because of this 90-day limit, we recommend VMs to be online for 20 minutes every 90 days so that the machine can refresh its tokens and update the agent and side-by-side stack components.",
            "guid": "ebe54cd7-df2e-48bb-ac35-81559bb9153e",
            "link": "https://docs.microsoft.com/azure/virtual-desktop/faq",
            "services": [
                "AVD",
                "Monitor",
                "VM"
            ],
            "severity": "Medium",
            "subcategory": "Management",
            "text": "Turn on Session Host VMs at least every 90 days for token refresh",
            "waf": "Operations"
        },
        {
            "category": "Monitoring and Management",
            "checklist": "Azure Virtual Desktop Review",
            "description": "Azure Virtual Desktop Insights is a dashboard built on Azure Monitor Workbooks that helps IT professionals understand their Azure Virtual Desktop environments. Read the referenced article to learn how to set up Azure Monitor for Azure Virtual Desktop to monitor your AVD environments.",
            "guid": "63cfff1c-ac59-49ef-8d5a-83dd4de36c1c",
            "link": "https://learn.microsoft.com/azure/virtual-desktop/insights",
            "services": [
                "AVD",
                "Monitor"
            ],
            "severity": "High",
            "subcategory": "Monitoring",
            "text": "Enable monitoring for AVD",
            "waf": "Reliability"
        },
        {
            "category": "Monitoring and Management",
            "checklist": "Azure Virtual Desktop Review",
            "description": "Azure Virtual Desktop uses Azure Monitor and Log Analytics for monitoring and alerts like many other Azure services. This lets admins identify issues through a single interface. The service creates activity logs for both user and administrative actions.  Each activity log falls under the following categories: Management, Feed, Connections, Host Registration, Errors, Checkpoints. ",
            "guid": "81770afb-c4c0-4e43-a186-58d2857ed671",
            "link": "https://docs.microsoft.com/azure/virtual-desktop/diagnostics-log-analytics",
            "services": [
                "AVD",
                "Monitor",
                "VM"
            ],
            "severity": "Medium",
            "subcategory": "Monitoring",
            "text": "Enable diagnostic settings for Workspaces, Host Pools, Application Groups and Host VMs to Log Analytics workspace",
            "waf": "Reliability"
        },
        {
            "category": "Monitoring and Management",
            "checklist": "Azure Virtual Desktop Review",
            "description": "See the referenced article and this additional one to setup proper monitoring and alerting for storage: https://docs.microsoft.com/azure/storage/files/storage-troubleshooting-files-performance. ",
            "guid": "2463cffe-179c-4599-be0d-5973dd4ce32c",
            "link": "https://docs.microsoft.com/azure/storage/files/storage-files-monitoring?tabs=azure-portal",
            "services": [
                "AVD",
                "Monitor",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Monitoring",
            "text": "Create alerts on the profile storage to be alerted in case of high usage and throttling",
            "waf": "Reliability"
        },
        {
            "category": "Monitoring and Management",
            "checklist": "Azure Virtual Desktop Review",
            "description": "You can use Azure Service Health to monitor service issues and health advisories for Azure Virtual Desktop. Azure Service Health can notify you with different types of alerts (for example, email or SMS), help you understand the effect of an issue, and keep you updated as the issue resolves.",
            "guid": "18813706-f7c4-4c0d-9e51-4548d2457ed6",
            "link": "https://docs.microsoft.com/azure/virtual-desktop/set-up-service-alerts",
            "services": [
                "AVD",
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Monitoring",
            "text": "Configure Azure Service Health for AVD alerts ",
            "waf": "Reliability"
        },
        {
            "category": "Networking",
            "checklist": "Azure Virtual Desktop Review",
            "description": "If required to connect to on-premises environment, assess the current connectivity option or plan for the required connectivity (ExpressRoute, Azure S2S or 3rd-party NVA VPN). ",
            "guid": "dd399cfd-7b28-4dc8-9555-6202bfe4563b",
            "link": "https://docs.microsoft.com/azure/architecture/reference-architectures/hybrid-networking/",
            "services": [
                "AVD",
                "NVA",
                "ExpressRoute",
                "VPN"
            ],
            "severity": "Medium",
            "subcategory": "Networking",
            "text": "Determine if hybrid connectivity is required to connect to on-premises environment",
            "waf": "Reliability"
        },
        {
            "category": "Networking",
            "checklist": "Azure Virtual Desktop Review",
            "description": "AVD Host Pools can be deployed in either Azure Virtual WAN or traditional 'Hub & Spoke' network topologies. It is recommended to deploy each Host Pool in a separate 'spoke' VNet, using 'hub' is not recommended.",
            "guid": "c8639648-a652-4d6c-85e5-02965388e5de",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/wvd/eslz-network-topology-and-connectivity",
            "services": [
                "AVD",
                "VNet",
                "VWAN"
            ],
            "severity": "Medium",
            "subcategory": "Networking",
            "text": "Determine Azure Virtual Network (VNet) placement for each AVD Host Pool",
            "waf": "Performance"
        },
        {
            "category": "Networking",
            "checklist": "Azure Virtual Desktop Review",
            "description": "Evaluate the bandwidth requirements, ensure VPN/ER bandwidth will be enough, ensure proper routing and firewall rules are in place, test end-to-end latency. ",
            "guid": "d227dd14-2b06-4c21-a799-9a646f4389a7",
            "link": "https://docs.microsoft.com/azure/architecture/reference-architectures/hybrid-networking/",
            "services": [
                "AVD",
                "VPN"
            ],
            "severity": "Medium",
            "subcategory": "Networking",
            "text": "Assess which on-premises resources are required from AVD Host Pools",
            "waf": "Reliability"
        },
        {
            "category": "Networking",
            "checklist": "Azure Virtual Desktop Review",
            "description": "Several options are available. You can use Azure Firewall or equivalent 3rd-party NVA, Network Security Group (NSG) and/or Proxy servers. NSG is not able to enable/disable by URL, only ports and protocols. Proxy should be used only as explicit setting in user browser. Details on using Azure Firewall Premium with AVD are reported in the companion article in the 'More Info' column. Be sure to allow proper access to required AVD URLs. Forced Tunneling to on-premises is not recommended.",
            "guid": "fc4972cd-3cd2-41bf-9703-6e5e6b4bed3d",
            "link": "https://docs.microsoft.com/azure/firewall/protect-windows-virtual-desktop",
            "services": [
                "AVD",
                "NVA",
                "Firewall",
                "VNet"
            ],
            "severity": "Medium",
            "subcategory": "Networking",
            "text": "Need to control/restrict Internet outbound traffic for AVD hosts?",
            "waf": "Security"
        },
        {
            "category": "Networking",
            "checklist": "Azure Virtual Desktop Review",
            "description": "Required URLs for AVD control plane access by session hosts are documented here: https://docs.microsoft.com/azure/virtual-desktop/safe-url-list. A check tool is available to verify connectivity from the session hosts: https://docs.microsoft.com/azure/virtual-desktop/safe-url-list#required-url-check-tool. Forced Tunneling to on-premises is not recommended.",
            "guid": "65c7acbe-45bb-4e60-ad89-f2e87778424d",
            "link": "https://docs.microsoft.com/azure/virtual-desktop/safe-url-list",
            "services": [
                "AVD"
            ],
            "severity": "High",
            "subcategory": "Networking",
            "text": "Ensure AVD control plane endpoints are accessible",
            "waf": "Reliability"
        },
        {
            "category": "Networking",
            "checklist": "Azure Virtual Desktop Review",
            "description": "Consider the usage of Azure Defender Endpoint or similar 3rd-party agents to control user web navigation, see the Security section for more details.",
            "guid": "73676ae4-6691-4e88-95ad-a42223e13810",
            "link": "https://learn.microsoft.com/microsoft-365/security/defender-endpoint/onboard-windows-multi-session-device?view=o365-worldwide",
            "services": [
                "AVD",
                "Defender"
            ],
            "severity": "Medium",
            "subcategory": "Networking",
            "text": "Need to control/restrict Internet outbound traffic only for users on AVD hosts? ",
            "waf": "Security"
        },
        {
            "category": "Networking",
            "checklist": "Azure Virtual Desktop Review",
            "description": "Custom UDR and NSG can be applied to AVD Host Pool subnets, for example to redirect to Azure Firewall or NVA, or to filter/block network traffic. In this case is recommended to carefully review to ensure optimal path for outbound traffic to AVD control plane is used. Service Tags can now be used with UDR and NSG, then AVD management plane traffic can be easily allowed: https://learn.microsoft.com/azure/virtual-desktop/safe-url-list.",
            "guid": "523181a9-4174-4158-93ff-7ae7c6d37431",
            "link": "https://docs.microsoft.com/azure/firewall/protect-windows-virtual-desktop",
            "services": [
                "AVD",
                "VNet",
                "NVA",
                "Firewall"
            ],
            "severity": "Low",
            "subcategory": "Networking",
            "text": "Review custom UDR and NSG for AVD Host Pool subnets",
            "waf": "Security"
        },
        {
            "category": "Networking",
            "checklist": "Azure Virtual Desktop Review",
            "description": "Network traffic from AVD Session Host VMs to AVD control plane should be as direct as possible. Redirecting this traffic through a Proxy or Firewall with deep packet inspection and/or SSL termination could cause serious issues and bad customer experience. It is recommended to bypass Proxy and Firewall just for the AVD control plane. User generated traffic surfing the web instead, should be filtered by Firewall and/or redirected to a Proxy. For details and guidelines, please see the companion article in the 'More Info' column.",
            "guid": "cc6edca0-aeca-4566-9e92-cf246f1465af",
            "link": "https://learn.microsoft.com/azure/virtual-desktop/proxy-server-support",
            "services": [
                "AVD",
                "VM"
            ],
            "severity": "High",
            "subcategory": "Networking",
            "text": "Do not use Proxy servers, SSL termination and Deep Packet Inspection for AVD control plane traffic",
            "waf": "Reliability"
        },
        {
            "category": "Networking",
            "checklist": "Azure Virtual Desktop Review",
            "description": "It is recommended to assess and review networking bandwidth requirements for users, based on the specific workload type. The referenced article provide general estimations and recommendations, but specific measure are required for proper sizing. ",
            "guid": "516785c6-fa96-4c96-ad88-408f372734c8",
            "link": "https://learn.microsoft.com/azure/virtual-desktop/rdp-bandwidth",
            "services": [
                "AVD",
                "VM"
            ],
            "severity": "Low",
            "subcategory": "Networking",
            "text": "Check the network bandwidth required for each user and in total for the VM SKU",
            "waf": "Performance"
        },
        {
            "category": "Networking",
            "checklist": "Azure Virtual Desktop Review",
            "description": "If Azure Files SMB share will be used to store user profiles via FSLogix, the usage of Private Endpoint (PE) for private access to the storage is recommended. AVD Session Hosts will access the storage using a private IP in the same VNet, a separate subnet is recommended. This feature has an additional cost that must be evaluated. If PE will not be used, at least Service Endpoint is recommended (no cost associated).",
            "guid": "ec27d589-9178-426d-8df2-ff60020f30a6",
            "link": "https://learn.microsoft.com/azure/storage/files/storage-files-networking-endpoints",
            "services": [
                "Cost",
                "PrivateLink",
                "AVD",
                "VNet",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Networking",
            "text": "Evaluate usage Private Endpoint for Azure Files share",
            "waf": "Security"
        },
        {
            "category": "Networking",
            "checklist": "Azure Virtual Desktop Review",
            "description": "Connections to Azure Virtual Desktop can use TCP or UDP. RDP Shortpath is a feature of AVD that establishes a direct UDP-based transport between a supported Windows Remote Desktop client and session host. if clients have line of sight to AVD session hosts from internal network (VPN usage is not recommended), this feature can provide lower latency and best performances as explained in https://learn.microsoft.com/azure/virtual-desktop/rdp-shortpath?tabs=managed-networks#key-benefits.",
            "guid": "b2074747-d01a-4f61-b1aa-92ad793d9ff4",
            "link": "https://docs.microsoft.com/azure/virtual-desktop/shortpath",
            "services": [
                "AVD",
                "VPN"
            ],
            "severity": "Medium",
            "subcategory": "Networking",
            "text": "Evaluate usage of RDP ShortPath for clients connecting from managed internal networks",
            "waf": "Performance"
        },
        {
            "category": "Security",
            "checklist": "Azure Virtual Desktop Review",
            "description": "Security mechanisms provided by GPO should be used, if available. For example, it is possible to impose desktop screen lock and idle session disconnection time. Existing GPOs applied to on-premises environment should be reviewed and eventually applied also to secure also AVD Hosts when joined to the domain.",
            "guid": "a135e337-897e-431c-97d6-8cb6a22ac19f",
            "link": "https://learn.microsoft.com/azure/virtual-desktop/security-guide#establish-maximum-inactive-time-and-disconnection-policies",
            "services": [
                "AVD"
            ],
            "severity": "Medium",
            "subcategory": "Active Directory",
            "text": "Review Active Directory GPO to secure RDP sessions",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Virtual Desktop Review",
            "description": "Microsoft Defender for Endpoint supports Azure Virtual Desktop for Windows 10/11 Enterprise multi-session. Check article for onboarding non-persistent virtual desktop infrastructure (VDI) devices: https://docs.microsoft.com/windows/security/threat-protection/microsoft-defender-atp/configure-endpoints-vdi",
            "guid": "b1172576-9ef6-4691-a483-5ac932223ece",
            "link": "https://learn.microsoft.com/microsoft-365/security/defender-endpoint/deployment-vdi-microsoft-defender-antivirus",
            "services": [
                "AVD",
                "Defender"
            ],
            "severity": "High",
            "subcategory": "Host Configuration",
            "text": "Ensure anti-virus and anti-malware solutions are used",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Virtual Desktop Review",
            "description": "Disks in Azure are already encrypted at rest by default with Microsoft managed keys. Host VM OS disk encryption is possible and supported using Azure Disk Encryption (ADE - BitLocker) and Disk Encryption Set (DES - Server Side Encryption), the latter is recommended. Encryption of FSLogix storage using Azure Files can be done using SSE on Azure Storage. For OneDrive encryption, see this article: https://docs.microsoft.com/compliance/assurance/assurance-encryption-for-microsoft-365-services.",
            "guid": "0fd32907-98bc-4178-adc5-a06ca7144351",
            "link": "https://learn.microsoft.com/azure/virtual-machines/disk-encryption-overview",
            "services": [
                "AVD",
                "AKV",
                "VM",
                "Storage"
            ],
            "severity": "Low",
            "subcategory": "Host Configuration",
            "text": "Assess disk encryption requirements for AVD Session Hosts",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Virtual Desktop Review",
            "description": "Trusted launch are Gen2 Azure VMs with enhanced security features aimed to protect against bottom of the stack threats through attack vectors such as rootkits, boot kits, and kernel-level malware. Recommended to enable and leverage Secure Boot, Virtual TPM (vTPM) and Integrity Monitoring.",
            "guid": "36a5a67f-bb9e-4d5b-9547-8c4479816b28",
            "link": "https://learn.microsoft.com/azure/virtual-desktop/security-guide#azure-virtual-desktop-support-for-trusted-launch",
            "services": [
                "AVD",
                "Monitor",
                "VM"
            ],
            "severity": "Medium",
            "subcategory": "Host Configuration",
            "text": "Enable Trusted launch in Azure Gen2 VM Session Hosts",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Virtual Desktop Review",
            "description": "Trusted Launch and Gen2 VM are not only security and performance enhancing features but also system requirements for Windows 11. When building an AVD environment based on Windows 11, it is essential to enable these features.",
            "guid": "135d3899-4b31-44d3-bc8f-028871a359d8",
            "link": "https://learn.microsoft.com/windows/whats-new/windows-11-requirements",
            "services": [
                "AVD",
                "VM"
            ],
            "severity": "High",
            "subcategory": "Host Configuration",
            "text": "Enable Trusted Launch and use Gen2 image are system requirements for Windows 11",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Virtual Desktop Review",
            "description": "Displayed content will be automatically blocked or hidden in screenshots. Keep in mind screen sharing will also be blocked when using Teams or other collaboration software which use screen sharing.",
            "guid": "a49dc137-7896-4343-b2bc-1a31bf1d30b6",
            "link": "https://learn.microsoft.com/azure/virtual-desktop/screen-capture-protection",
            "services": [
                "AVD"
            ],
            "severity": "Low",
            "subcategory": "Host Configuration",
            "text": "Consider enabling screen capture protection to prevent sensitive information from being captured",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Virtual Desktop Review",
            "description": "If not absolutely required, redirecting drives, printers, and USB devices to a user's local device in a remote desktop session should be disabled or highly restricted. Restrict Windows Explorer access by hiding local and remote drive mappings is also a secure measure to adopt preventing users from discovering unwanted information about system configuration and users.",
            "guid": "7ce2cd20-85b4-4f82-828e-6558736ede6a",
            "link": "https://learn.microsoft.com/azure/virtual-desktop/security-guide#other-security-tips-for-session-hosts",
            "services": [
                "AVD"
            ],
            "severity": "Medium",
            "subcategory": "Host Configuration",
            "text": "Restrict device redirection and drive mapping",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Virtual Desktop Review",
            "description": "When choosing a deployment model, you can either provide remote users access to entire virtual desktops or only select applications. Remote applications, or RemoteApps, provide a seamless experience as the user works with apps on their virtual desktop. RemoteApps reduce risk by only letting the user work with a subset of the remote machine exposed by the application.",
            "guid": "4e25d70e-3924-44f4-b66f-d6cdd4f4a973",
            "link": "https://learn.microsoft.com/microsoft-365/security/defender-endpoint/web-protection-overview",
            "services": [
                "AVD"
            ],
            "severity": "Medium",
            "subcategory": "Management",
            "text": "When possible, prefer Remote Apps over Full Desktops (DAG)",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Virtual Desktop Review",
            "description": "Web content filtering feature provided by Web Protection capability in Microsoft Defender for Endpoint, can be used to to control user web navigation. If this tool is used, configuration of web filtering for user Internet browsing is recommended. Access by the Guest OS system to required AVD control plane URLs must be guaranteed.",
            "guid": "e19dd344-29eb-4722-a237-a151c5bb4e4f",
            "link": "https://learn.microsoft.com/microsoft-365/security/defender-endpoint/web-protection-overview",
            "services": [
                "AVD",
                "Defender"
            ],
            "severity": "Medium",
            "subcategory": "Management",
            "text": "Need to control/restrict user Internet navigation from AVD session hosts?",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Virtual Desktop Review",
            "description": "We recommend you don't grant your users admin access to virtual desktops. If you need software packages, we recommend you make them available through configuration management utilities.",
            "guid": "a0cdb3b5-4eb2-4eb0-9dda-a3592718e2ed",
            "link": "https://docs.microsoft.com/azure/virtual-desktop/security-guide",
            "services": [
                "AVD"
            ],
            "severity": "High",
            "subcategory": "Management",
            "text": "Ensure AVD users will not have local administrator privileges on AVD Hosts",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Virtual Desktop Review",
            "description": "We recommend you enable Defender for Cloud for the subscriptions, virtual machines, key vaults, and storage accounts used by AVD. With this tool is possible to assess and manage vulnerabilities, assess compliance with common frameworks like PCI, strengthen the overall security of your AVD environment and measure it over time using 'Secure Score': https://learn.microsoft.com/azure/virtual-desktop/security-guide#improve-your-secure-score.",
            "guid": "1814387e-5ca9-4c26-a9b3-2ab5bdfc6998",
            "link": "https://learn.microsoft.com/azure/virtual-desktop/security-guide#enable-microsoft-defender-for-cloud",
            "services": [
                "AKV",
                "AVD",
                "Defender",
                "Subscriptions",
                "VM",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Management",
            "text": "Enable Microsoft Defender for Cloud to manage AVD Session Hosts security posture",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Virtual Desktop Review",
            "description": "Enabling audit log collection lets you view user and admin activity related to Azure Virtual Desktop and store in a central repository like Log Analytics workspace. ",
            "guid": "a0916a76-4980-4ad0-b278-ee293c1bc352",
            "link": "https://learn.microsoft.com/azure/virtual-desktop/security-guide#collect-audit-logs",
            "services": [
                "AVD",
                "Entra",
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Management",
            "text": "Enable diagnostic and audit logging",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Virtual Desktop Review",
            "description": "Assign the least privilege required by defining administrative, operations, and engineering roles to Azure RBAC roles. To limit access to high privilege roles within your Azure Virtual Desktop landing zone, consider integration with Azure Privileged Identity Management (PIM). Maintaining knowledge of which team is responsible for each particular administrative area helps you determine Azure role-based access control (RBAC) roles and configuration.",
            "guid": "baaab757-1849-4ab8-893d-c9fc9d1bb73b",
            "link": "https://docs.microsoft.com/azure/virtual-desktop/rbac",
            "services": [
                "AVD",
                "RBAC",
                "Entra"
            ],
            "severity": "Low",
            "subcategory": "Management",
            "text": "Assess the requirement to use custom RBAC roles for AVD management",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Virtual Desktop Review",
            "description": "AVD users should not have permission to install application. If required, Windows Defender Application Control (WDAC) can be used to control which drivers and applications are allowed to run on their Windows clients. ",
            "guid": "b9ea80c8-0628-49fc-ae63-125aa4c0a284",
            "link": "https://learn.microsoft.com/azure/virtual-desktop/security-guide#windows-defender-application-control",
            "services": [
                "AVD",
                "Defender"
            ],
            "severity": "Medium",
            "subcategory": "Management",
            "text": "Restrict users from installing un-authorized applications",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Virtual Desktop Review",
            "description": "Enabling MFA and CA lets you manage risks before you grant users access to your AVD environment. When deciding which users to grant access to, we recommend you also consider who the user is, how they sign in, and which device they're using. Additional details and configuration procedures are provided in the companion article. Microsoft Entra ID is the new name for Azure Active Directory (Azure AD).",
            "guid": "916d697d-8ead-4ed2-9bdd-186f1ac252b9",
            "link": "https://learn.microsoft.com/azure/virtual-desktop/set-up-mfa",
            "services": [
                "AVD",
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Microsoft Entra ID",
            "text": "Evaluate the usage of Multi-Factor Authentication (MFA) and Conditional Access (CA) for AVD users",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Virtual Desktop Review",
            "description": "If Zero Trust is a requirement, review the companion article in the 'More Info' column. It provides steps to apply the principles of Zero Trust to an Azure Virtual Desktop deployment.",
            "guid": "221102d0-90af-49fc-b2b7-8d3fe397e43",
            "link": "https://learn.microsoft.com/security/zero-trust/azure-infrastructure-avd",
            "services": [
                "AVD"
            ],
            "severity": "Medium",
            "subcategory": "Zero Trust",
            "text": "Review and Apply Zero Trust principles and guidance",
            "waf": "Security"
        },
        {
            "category": "Storage",
            "checklist": "Azure Virtual Desktop Review",
            "description": "If used, make sure to check the list of best practices and recommendations described in the referenced article.",
            "guid": "9164e990-9ae2-48c8-9c33-b6b7808bafe6",
            "link": "https://learn.microsoft.com/azure/virtual-desktop/fslogix-containers-azure-files#best-practices-for-azure-virtual-desktop",
            "services": [
                "AVD",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Azure Files",
            "text": "Check best-practices for Azure Files",
            "waf": "Performance"
        },
        {
            "category": "Storage",
            "checklist": "Azure Virtual Desktop Review",
            "description": "SMB Multichannel enables clients to use multiple network connections that provide increased performance while lowering the cost of ownership. Increased performance is achieved through bandwidth aggregation over multiple NICs and utilizing Receive Side Scaling (RSS) support for NICs to distribute the IO load across multiple CPUs.",
            "guid": "5784b6ca-5e9e-4bcf-8b54-c95459ea7369",
            "link": "https://learn.microsoft.com/azure/storage/files/storage-files-smb-multichannel-performance",
            "services": [
                "AVD",
                "ACR",
                "Cost",
                "Storage"
            ],
            "severity": "Low",
            "subcategory": "Azure Files",
            "text": "Enable SMB multichannel when using a premium file share to host FSLogix profile containers.",
            "waf": "Performance"
        },
        {
            "category": "Storage",
            "checklist": "Azure Virtual Desktop Review",
            "description": "If a second region is required for DR purposes verify NetApp availability in there as well.",
            "guid": "4a359836-ee79-4d6c-9d3a-364a5b7abae3",
            "link": "https://azure.microsoft.com/global-infrastructure/services/",
            "services": [
                "AVD",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Azure NetApp Files",
            "text": "If NetApp Files storage is required, check storage service availability in your specific region.",
            "waf": "Reliability"
        },
        {
            "category": "Storage",
            "checklist": "Azure Virtual Desktop Review",
            "description": "CA option is a recommended setting in the FSLogix scenario, as it enables a more resilient SMB session between the Session Host and NetApp Files.",
            "guid": "a2661898-866a-4c8d-9d1f-8cfc86e88024",
            "link": "https://learn.microsoft.com/azure/virtual-desktop/create-fslogix-profile-container",
            "services": [
                "AVD",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Azure NetApp Files",
            "text": "If NetApp Files storage is used enable CA (Continuous Availability) option to increase resiliency",
            "waf": "Reliability"
        },
        {
            "category": "Storage",
            "checklist": "Azure Virtual Desktop Review",
            "description": "An Active Directory Site should be created for the Azure virtual network environment where Azure NetApp Files (ANF) subnet will be created, and that site name should be specified in the ANF connection property when executing the join procedure as explained in the reference article.",
            "guid": "6647e977-db49-48a8-bc35-743f17499d42",
            "link": "https://docs.microsoft.com/azure/azure-netapp-files/create-active-directory-connections",
            "services": [
                "AVD",
                "VNet",
                "Storage"
            ],
            "severity": "High",
            "subcategory": "Azure NetApp Files",
            "text": "If Azure NetApp Files storage is used, check Active Directory Site name setting in the Active Directory Connection configuration",
            "waf": "Reliability"
        },
        {
            "category": "Storage",
            "checklist": "Azure Virtual Desktop Review",
            "description": "Possible options: Standard HDD, Standard SSD, or Premium SSD. Ephemeral disks are not supported, Ultra-Disks not recommended. Recommended to evaluate Premium for OS disk if user density is not low, and if Cloud Cache will be used. ",
            "guid": "3611c818-b0a0-4bc5-80e4-3a18a9cd289c",
            "link": "https://docs.microsoft.com/azure/virtual-machines/disks-types",
            "services": [
                "AVD",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Capacity Planning",
            "text": "Determine which type of managed disk will be used for the Session Hosts",
            "waf": "Performance"
        },
        {
            "category": "Storage",
            "checklist": "Azure Virtual Desktop Review",
            "description": "Possible options are: Azure NetApp Files, Azure Files, VM based File Server. File-server it is not recommended. Azure Files Premium typically a good starting point. NetApp usually required for large scale / high-performant environment. For a detailed comparison see the article in the 'More Info' column.",
            "guid": "ed6b17db-8255-4462-b2ae-e4553afc8339",
            "link": "https://docs.microsoft.com/azure/virtual-desktop/store-fslogix-profile",
            "services": [
                "AVD",
                "VM",
                "Storage"
            ],
            "severity": "High",
            "subcategory": "Capacity Planning",
            "text": "Determine which storage backend solution will be used for FSLogix Profiles",
            "waf": "Performance"
        },
        {
            "category": "Storage",
            "checklist": "Azure Virtual Desktop Review",
            "description": "Every Host Pool should use a separate set of storage accounts/volumes (at least one) and shares. Users should have a different profile for each Host Pool since settings and configurations are specific to each Host Pool. Additionally, accessing different Host Pools at the same time can cause errors on the shared user profile VHD/X. Usage of different storage accounts/volumes for multiple shares is also recommended to scale independently.",
            "guid": "2fad62bd-5004-453c-ace4-64d862e7f5a4",
            "link": "https://learn.microsoft.com/azure/virtual-desktop/store-fslogix-profile",
            "services": [
                "AVD",
                "Storage"
            ],
            "severity": "High",
            "subcategory": "Capacity Planning",
            "text": "Do not share storage and profiles between different Host Pools",
            "waf": "Performance"
        },
        {
            "category": "Storage",
            "checklist": "Azure Virtual Desktop Review",
            "description": "As a starting point for estimating profile container storage performance requirements we recommend to assume 10 IOPS per user in the steady state and 50 IOPS per user during sign-in/sign-out. Space requirements is simply obtained based on the maximum profiles size in FSLogix per the total number of users for each Host Pool. Multiple storage accounts can be used for the same Host Pool if required.",
            "guid": "680e7828-9c93-4665-9d02-bff4564b0d93",
            "link": "https://learn.microsoft.com/azure/virtual-desktop/faq#what-s-the-largest-profile-size-fslogix-can-handle-",
            "services": [
                "AVD",
                "Storage"
            ],
            "severity": "High",
            "subcategory": "Capacity Planning",
            "text": "Verify storage scalability limits and Host Pool requirements",
            "waf": "Reliability"
        },
        {
            "category": "Storage",
            "checklist": "Azure Virtual Desktop Review",
            "description": "Avoid introducing additional latency and costs associated with cross-region network traffic where possible.",
            "guid": "8aad53cc-79e2-4e86-9673-57c549675c5e",
            "link": "https://docs.microsoft.com/azure/virtual-desktop/fslogix-containers-azure-files",
            "services": [
                "AVD",
                "Cost",
                "Storage"
            ],
            "severity": "High",
            "subcategory": "Capacity Planning",
            "text": "For optimal performance, the storage solution and the FSLogix profile container should be in the same Azure region.",
            "waf": "Performance"
        },
        {
            "category": "Storage",
            "checklist": "Azure Virtual Desktop Review",
            "description": "The recommendation in Azure Virtual Desktop is to use Profile Container without Office Container (ODFC) split unless you are planning for specific Business Continuity and Disaster Recovery (BCDR) scenarios as described in the Disaster Recovery section below. https://docs.microsoft.com/fslogix/profile-container-office-container-cncpt ",
            "guid": "df47d2d9-2881-4b1c-b5d1-e54a29759e39",
            "link": "https://learn.microsoft.com/fslogix/concepts-container-types#when-to-use-profile-and-odfc-containers",
            "services": [
                "AVD",
                "Storage",
                "ASR"
            ],
            "severity": "High",
            "subcategory": "FSLogix",
            "text": "Do not use Office Containers (ODFC) if not strictly required and justified",
            "waf": "Reliability"
        },
        {
            "category": "Storage",
            "checklist": "Azure Virtual Desktop Review",
            "description": "Make sure to configure the following antivirus exclusions for FSLogix Profile Container virtual hard drives, as documented in the referenced article in the 'More Info' column.",
            "guid": "83f63047-22ee-479d-9b5c-3632054b69ba",
            "link": "https://learn.microsoft.com/fslogix/overview-prerequisites#configure-antivirus-file-and-folder-exclusions",
            "services": [
                "AVD",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "FSLogix",
            "text": "Configure the recommended antivirus exclusions for FSLogix (includes not scanning VHD(x) files on connect).",
            "waf": "Security"
        },
        {
            "category": "Storage",
            "checklist": "Azure Virtual Desktop Review",
            "description": "Profile containers have a default max size of 30GB. If large Profile Containers are anticipated, and customers wants to try to keep them small, consider using OneDrive to host Office 365 files outside the FSLogix profile.",
            "guid": "01e6a84d-e5df-443d-8992-481718d5d1e5",
            "link": "https://docs.microsoft.com/fslogix/profile-container-configuration-reference",
            "services": [
                "AVD",
                "Storage"
            ],
            "severity": "High",
            "subcategory": "FSLogix",
            "text": "Review and confirm configured maximum profile size in FSLogix",
            "waf": "Cost"
        },
        {
            "category": "Storage",
            "checklist": "Azure Virtual Desktop Review",
            "description": "Defaults and recommended settings are reported in the companion article in the 'More Info' column. If not recommended keys and/or values must be used, be sure to review with a Microsoft AVD expert and clearly document your choices.",
            "guid": "d34aad5e-8c78-4e1d-9666-7313c405674c",
            "link": "https://learn.microsoft.com/fslogix/concepts-configuration-examples",
            "services": [
                "AVD",
                "AKV",
                "ACR",
                "Storage"
            ],
            "severity": "High",
            "subcategory": "FSLogix",
            "text": "Review FSLogix registry keys and determine which ones to apply",
            "waf": "Reliability"
        },
        {
            "category": "Storage",
            "checklist": "Azure Virtual Desktop Review",
            "description": "Concurrent or multiple connections are not recommended in Azure Virtual Desktop. Concurrent connections are also not supported by Session Hosts running in an Azure Virtual Desktop Host Pool. OneDrive, if used, doesn't support concurrent or multiple connections using the same container, under any circumstance. For multiple connections, usage of the same profile disk is not recommended.",
            "guid": "5e985b85-9c77-43e7-b261-623b775a917e",
            "link": "https://learn.microsoft.com/fslogix/concepts-multi-concurrent-connections",
            "services": [
                "AVD",
                "Storage"
            ],
            "severity": "High",
            "subcategory": "FSLogix",
            "text": "Avoid usage of concurrent or multiple connections",
            "waf": "Reliability"
        },
        {
            "category": "Storage",
            "checklist": "Azure Virtual Desktop Review",
            "description": "Cloud Cache uses OS drive as local cache storage and may generate lot of pressure on the VM disk. Depending on the VM SKU and size used, the VM temporary drive can be a viable and performant solution where to relocate Cloud Cache cached content. Before adopting this solution, tests should be executed to confirm performance and stability. More details on Cloud Cache can be found here: https://learn.microsoft.com/fslogix/concepts-fslogix-cloud-cache. ",
            "guid": "b2d1215a-e114-4ba3-9df5-85ecdcd9bd3b",
            "link": "https://docs.microsoft.com/fslogix/cloud-cache-configuration-reference",
            "services": [
                "AVD",
                "VM",
                "Storage"
            ],
            "severity": "Low",
            "subcategory": "FSLogix",
            "text": "If FSLogix Cloud Cache is used, consider moving the cache directory to the VM temporary drive.",
            "waf": "Performance"
        },
        {
            "category": "Storage",
            "checklist": "Azure Virtual Desktop Review",
            "description": "REDIRECTION.XML file is used to control what folders are redirected out of the profile container to the 'C:' drive. Exclusions should be the exception and should never be used unless the specific exclusion is completely understood by the person configuring the exclusion. Exclusions should always be fully tested in the environment where they are intended to be implemented. Configuring exclusions may impact functionality, stability and performance.",
            "guid": "0b50ca97-b1d2-473c-b4d9-6e98b0f912de",
            "link": "https://docs.microsoft.com/fslogix/manage-profile-content-cncpt#redirectionsxml",
            "services": [
                "AVD",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "FSLogix",
            "text": "Review the usage of FSLogix redirection.",
            "waf": "Cost"
        },
        {
            "category": "Application Deployment",
            "checklist": "Azure AKS Review",
            "guid": "785c2fa5-5b56-4ad4-a408-fe72734c476b",
            "link": "https://learn.microsoft.com/azure/architecture/reference-architectures/containers/aks/secure-baseline-aks",
            "services": [
                "AKS"
            ],
            "severity": "Medium",
            "subcategory": "Development",
            "text": "Use canary or blue/green deployments",
            "waf": "Operations"
        },
        {
            "category": "Application Deployment",
            "checklist": "Azure AKS Review",
            "guid": "ab5351f6-383a-45ed-9c5e-b143b16db40a",
            "link": "https://learn.microsoft.com/azure/aks/use-windows-hpc",
            "service": "AKS",
            "services": [
                "AKS"
            ],
            "severity": "Low",
            "subcategory": "Development",
            "text": "If required for AKS Windows workloads HostProcess containers can be used",
            "waf": "Reliability"
        },
        {
            "category": "Application Deployment",
            "checklist": "Azure AKS Review",
            "guid": "a280dcf5-90ce-465d-b8e1-3f9ccbd46926",
            "link": "https://learn.microsoft.com/azure/azure-functions/functions-kubernetes-keda",
            "service": "AKS",
            "services": [
                "AKS"
            ],
            "severity": "Low",
            "subcategory": "Development",
            "text": "Use KEDA if running event-driven workloads",
            "waf": "Performance"
        },
        {
            "category": "Application Deployment",
            "checklist": "Azure AKS Review",
            "guid": "26886d20-b66c-457b-a591-19bf8e8f5c58",
            "link": "https://dapr.io/",
            "service": "AKS",
            "services": [
                "AKS"
            ],
            "severity": "Low",
            "subcategory": "Development",
            "text": "Use Dapr to ease microservice development",
            "waf": "Operations"
        },
        {
            "category": "Application Deployment",
            "checklist": "Azure AKS Review",
            "guid": "3acbe04b-be20-49d3-afda-47778424d116",
            "link": "https://learn.microsoft.com/azure/developer/terraform/create-k8s-cluster-with-tf-and-aks",
            "services": [
                "AKS"
            ],
            "severity": "Medium",
            "subcategory": "Infrastructure as Code",
            "text": "Use automation through ARM/TF to create your Azure resources",
            "waf": "Operations"
        },
        {
            "category": "BC and DR",
            "checklist": "Azure AKS Review",
            "guid": "36cb45e5-7960-4332-9bdf-8cc23318da61",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/enterprise-scale/business-continuity-and-disaster-recovery",
            "services": [
                "AKS",
                "ASR"
            ],
            "severity": "High",
            "subcategory": "Disaster Recovery",
            "text": "Schedule and perform DR tests regularly",
            "waf": "Reliability"
        },
        {
            "category": "BC and DR",
            "checklist": "Azure AKS Review",
            "guid": "170265f4-bb46-4a39-9af7-f317284797b1",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-multi-region",
            "services": [
                "LoadBalancer",
                "TrafficManager",
                "FrontDoor",
                "AKS"
            ],
            "severity": "Medium",
            "subcategory": "High Availability",
            "text": "Use Azure Traffic Manager or Azure Front Door as a global load balancer for region failover",
            "waf": "Reliability"
        },
        {
            "category": "BC and DR",
            "checklist": "Azure AKS Review",
            "graph": "resources | where type=='microsoft.containerservice/managedclusters' | extend compliant= isnotnull(properties.agentPoolProfiles[0].availabilityZones) | distinct id,compliant",
            "guid": "578a219a-46be-4b54-9350-24922634292b",
            "link": "https://learn.microsoft.com/azure/aks/availability-zones",
            "services": [
                "AKS"
            ],
            "severity": "Medium",
            "subcategory": "High Availability",
            "text": "Use Availability Zones if they are supported in your Azure region",
            "waf": "Reliability"
        },
        {
            "category": "BC and DR",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (sku.tier=='Paid') | distinct id,compliant",
            "guid": "71d41e36-10cc-457b-9a4b-1410d4395898",
            "link": "https://learn.microsoft.com/azure/aks/uptime-sla",
            "service": "AKS",
            "services": [
                "AKS"
            ],
            "severity": "High",
            "subcategory": "High Availability",
            "text": "Use the SLA-backed AKS offering",
            "waf": "Reliability"
        },
        {
            "category": "BC and DR",
            "checklist": "Azure AKS Review",
            "guid": "c1288b3c-6a57-4cfc-9444-51e1a3d3453a",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-scheduler",
            "service": "AKS",
            "services": [
                "AKS",
                "Cost"
            ],
            "severity": "Low",
            "subcategory": "High Availability",
            "text": "Use Disruption Budgets in your pod and deployment definitions",
            "waf": "Reliability"
        },
        {
            "category": "BC and DR",
            "checklist": "Azure AKS Review",
            "guid": "3c763963-7a55-42d5-a15e-401955387e5c",
            "link": "https://learn.microsoft.com/azure/container-registry/container-registry-geo-replication",
            "service": "ACR",
            "services": [
                "ACR",
                "AKS"
            ],
            "severity": "High",
            "subcategory": "High Availability",
            "text": "If using a private registry, configure region replication to store images in multiple regions",
            "waf": "Reliability"
        },
        {
            "category": "BC and DR",
            "checklist": "Azure AKS Review",
            "guid": "daa9a260-c3ea-4490-b077-5fc1f2a80cb0",
            "link": "https://learn.microsoft.com/azure/aks/availability-zones#azure-disk-availability-zone-support",
            "services": [
                "ASR",
                "AKS",
                "Storage"
            ],
            "severity": "High",
            "subcategory": "Disaster Recovery",
            "text": "Use Zone-Redundant Storage (ZRS) with stateful workloads",
            "waf": "Reliability"
        },
        {
            "category": "BC and DR",
            "checklist": "Azure AKS Review",
            "guid": "bc14aea6-e65d-48d9-a3ad-c218e6436b06",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/enterprise-scale/business-continuity-and-disaster-recovery",
            "services": [
                "AKS"
            ],
            "severity": "High",
            "subcategory": "Requirements",
            "text": "Define non-functional requirements such as SLAs, RTO (Recovery Time Objective) and RPO (Recovery Point Objective).",
            "waf": "Reliability"
        },
        {
            "category": "Cost Governance",
            "checklist": "Azure AKS Review",
            "guid": "f82cb8eb-8c0a-4a63-a25a-4956eaa8dc4a",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/aks/eslz-cost-governance-with-kubecost",
            "service": "AKS",
            "services": [
                "AKS",
                "Cost"
            ],
            "severity": "Low",
            "subcategory": "Cost",
            "text": "Use an external application such as kubecost to allocate costs to different users",
            "waf": "Cost"
        },
        {
            "category": "Cost Governance",
            "checklist": "Azure AKS Review",
            "guid": "4d3dfbab-9924-4831-a68d-fdf0d72f462c",
            "link": "https://learn.microsoft.com/azure/aks/scale-down-mode",
            "service": "AKS",
            "services": [
                "AKS",
                "Cost"
            ],
            "severity": "Low",
            "subcategory": "Cost",
            "text": "Use scale down mode to delete/deallocate nodes",
            "waf": "Cost"
        },
        {
            "category": "Cost Governance",
            "checklist": "Azure AKS Review",
            "guid": "87e651ea-bc4a-4a87-a6df-c06a4b570ebc",
            "link": "https://learn.microsoft.com/azure/aks/gpu-multi-instance",
            "service": "AKS",
            "services": [
                "AKS",
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Cost",
            "text": "When required use multi-instance partitioning GPU on AKS Clusters",
            "waf": "Cost"
        },
        {
            "category": "Cost Governance",
            "checklist": "Azure AKS Review",
            "guid": "2b72a08b-0410-4cd6-9093-e068a5cf27e8",
            "link": "https://learn.microsoft.com/azure/aks/start-stop-nodepools",
            "service": "AKS",
            "services": [
                "AKS",
                "Cost"
            ],
            "severity": "Low",
            "subcategory": "Cost",
            "text": "If running a Dev/Test cluster use NodePool Start/Stop",
            "waf": "Cost"
        },
        {
            "category": "Governance and Security",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (isnotnull(properties.addonProfiles.azurepolicy) and properties.addonProfiles.azurepolicy.enabled==true) | distinct id,compliant",
            "guid": "9ca48e4a-85e2-4223-bce8-bb12307ca5f1",
            "link": "https://learn.microsoft.com/azure/governance/policy/concepts/policy-for-kubernetes",
            "service": "AKS",
            "services": [
                "AzurePolicy",
                "AKS"
            ],
            "severity": "Medium",
            "subcategory": "Compliance",
            "text": "Use Azure Policy for Kubernetes to ensure cluster compliance",
            "waf": "Security"
        },
        {
            "category": "Governance and Security",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | project id,resourceGroup,name,pools=properties.agentPoolProfiles | project id,name,resourceGroup,poolcount=array_length(pools) | extend compliant = (poolcount > 1)",
            "guid": "6f158e3e-a3a9-42c2-be7e-2165c3a87af4",
            "link": "https://learn.microsoft.com/azure/aks/use-system-pools",
            "service": "AKS",
            "services": [
                "AKS"
            ],
            "severity": "Medium",
            "subcategory": "Compliance",
            "text": "Separate applications from the control plane with user/system node pools",
            "waf": "Security"
        },
        {
            "category": "Governance and Security",
            "checklist": "Azure AKS Review",
            "guid": "a7a1f893-9bda-4477-98f2-4c116775c2ea",
            "link": "https://learn.microsoft.com/azure/aks/use-system-pools",
            "service": "AKS",
            "services": [
                "AKS"
            ],
            "severity": "Low",
            "subcategory": "Compliance",
            "text": "Add taint to your system nodepool to make it dedicated",
            "waf": "Security"
        },
        {
            "category": "Governance and Security",
            "checklist": "Azure AKS Review",
            "guid": "55b46a94-8008-4ae7-b7e4-b475b6c8bdbf",
            "link": "https://learn.microsoft.com/azure/container-registry/",
            "service": "AKS",
            "services": [
                "ACR",
                "AKS"
            ],
            "severity": "Medium",
            "subcategory": "Compliance",
            "text": "Use a private registry for your images, such as ACR",
            "waf": "Security"
        },
        {
            "category": "Governance and Security",
            "checklist": "Azure AKS Review",
            "guid": "59bce65d-e8a0-43f9-9879-468d66a786d6",
            "link": "https://learn.microsoft.com/azure/security-center/container-security",
            "service": "ACR",
            "services": [
                "AKS"
            ],
            "severity": "Medium",
            "subcategory": "Compliance",
            "text": "Scan your images for vulnerabilities",
            "waf": "Security"
        },
        {
            "category": "Governance and Security",
            "checklist": "Azure AKS Review",
            "guid": "cc639637-a652-42ac-89e8-06965388e9de",
            "link": "https://learn.microsoft.com/azure/security-center/container-security",
            "services": [
                "AKS",
                "Defender"
            ],
            "severity": "Medium",
            "subcategory": "Compliance",
            "text": "Use Azure Security Center to detect security posture vulnerabilities",
            "waf": "Security"
        },
        {
            "category": "Governance and Security",
            "checklist": "Azure AKS Review",
            "guid": "42d4aefe-2383-470e-b019-c30df24996b2",
            "link": "https://learn.microsoft.com/azure/aks/use-multiple-node-pools#add-a-fips-enabled-node-pool",
            "services": [
                "AKS"
            ],
            "severity": "Low",
            "subcategory": "Compliance",
            "text": "If required configure FIPS",
            "waf": "Security"
        },
        {
            "category": "Governance and Security",
            "checklist": "Azure AKS Review",
            "guid": "d167dd18-2b0a-4c24-8b99-9a646f8389a7",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-cluster-isolation",
            "service": "AKS",
            "services": [
                "AKS"
            ],
            "severity": "High",
            "subcategory": "Compliance",
            "text": "Define app separation requirements (namespace/nodepool/cluster)",
            "waf": "Security"
        },
        {
            "category": "Governance and Security",
            "checklist": "Azure AKS Review",
            "guid": "5e3df584-eccc-4d97-a3b6-bcda3b50eb2e",
            "link": "https://github.com/Azure/secrets-store-csi-driver-provider-azure",
            "service": "AKS",
            "services": [
                "AKV",
                "AKS"
            ],
            "severity": "Medium",
            "subcategory": "Secrets",
            "text": "Store your secrets in Azure Key Vault with the CSI Secrets Store driver",
            "waf": "Security"
        },
        {
            "category": "Governance and Security",
            "checklist": "Azure AKS Review",
            "guid": "b03dda6d-58d7-4c89-8ddb-107d5769ae66",
            "link": "https://learn.microsoft.com/azure/aks/update-credentials",
            "service": "AKS",
            "services": [
                "AKV",
                "AKS"
            ],
            "severity": "High",
            "subcategory": "Secrets",
            "text": "If using Service Principals for the cluster, refresh credentials periodically (like quarterly)",
            "waf": "Security"
        },
        {
            "category": "Governance and Security",
            "checklist": "Azure AKS Review",
            "guid": "e7ba73a3-0508-4f80-806f-527db30cee96",
            "link": "https://learn.microsoft.com/azure/aks/use-kms-etcd-encryption",
            "service": "AKS",
            "services": [
                "AKV",
                "AKS"
            ],
            "severity": "Medium",
            "subcategory": "Secrets",
            "text": "If required add Key Management Service etcd encryption",
            "waf": "Security"
        },
        {
            "category": "Governance and Security",
            "checklist": "Azure AKS Review",
            "guid": "ec8e4e42-0344-41b0-b865-9123e8956d31",
            "link": "https://learn.microsoft.com/azure/confidential-computing/confidential-nodes-aks-overview",
            "service": "AKS",
            "services": [
                "AKV",
                "AKS"
            ],
            "severity": "Low",
            "subcategory": "Secrets",
            "text": "If required consider using Confidential Compute for AKS",
            "waf": "Security"
        },
        {
            "category": "Governance and Security",
            "checklist": "Azure AKS Review",
            "guid": "c9e95ffe-6dd1-4a17-8c5f-110389ca9b21",
            "link": "https://learn.microsoft.com/azure/defender-for-cloud/defender-for-containers-enable",
            "service": "AKS",
            "services": [
                "AKV",
                "AKS",
                "Defender"
            ],
            "severity": "Medium",
            "subcategory": "Secrets",
            "text": "Consider using Defender for Containers",
            "waf": "Security"
        },
        {
            "category": "Identity and Access Management",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (properties.servicePrincipalProfile.clientId=='msi') | distinct id,compliant",
            "guid": "ed127dd1-42b0-46b2-8c69-99a646f3389a",
            "link": "https://learn.microsoft.com/azure/aks/use-managed-identity",
            "service": "AKS",
            "services": [
                "Entra",
                "AKS"
            ],
            "severity": "High",
            "subcategory": "Identity",
            "text": "Use managed identities instead of Service Principals",
            "waf": "Security"
        },
        {
            "category": "Identity and Access Management",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = isnotnull(properties.aadProfile) | distinct id,compliant",
            "guid": "7e42c78e-78c0-46a6-8a21-94956e698dc4",
            "link": "https://learn.microsoft.com/azure/aks/managed-aad",
            "service": "AKS",
            "services": [
                "Entra",
                "AKS"
            ],
            "severity": "Medium",
            "subcategory": "Identity",
            "text": "Integrate authentication with AAD (using the managed integration)",
            "waf": "Security"
        },
        {
            "category": "Identity and Access Management",
            "checklist": "Azure AKS Review",
            "guid": "a2fe27b2-e287-401a-8352-beedf79b488d",
            "link": "https://learn.microsoft.com/azure/aks/control-kubeconfig-access",
            "service": "AKS",
            "services": [
                "Entra",
                "AKS"
            ],
            "severity": "Medium",
            "subcategory": "Identity",
            "text": "Limit access to admin kubeconfig (get-credentials --admin)",
            "waf": "Security"
        },
        {
            "category": "Identity and Access Management",
            "checklist": "Azure AKS Review",
            "guid": "eec4962c-c3bd-421b-b77f-26e5e6b3bec3",
            "link": "https://learn.microsoft.com/azure/aks/manage-azure-rbac",
            "service": "AKS",
            "services": [
                "Entra",
                "RBAC",
                "AKS"
            ],
            "severity": "Medium",
            "subcategory": "Identity",
            "text": "Integrate authorization with AAD RBAC",
            "waf": "Security"
        },
        {
            "category": "Identity and Access Management",
            "checklist": "Azure AKS Review",
            "guid": "d4f3537c-1346-4dc5-9027-a71ffe1bd05d",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-identity",
            "service": "AKS",
            "services": [
                "RBAC",
                "AKS",
                "Entra"
            ],
            "severity": "High",
            "subcategory": "Identity",
            "text": "Use namespaces for restricting RBAC privilege in Kubernetes",
            "waf": "Security"
        },
        {
            "category": "Identity and Access Management",
            "checklist": "Azure AKS Review",
            "guid": "d2e0d5d7-71d4-41e3-910c-c57b4a4b1410",
            "link": "https://learn.microsoft.com/azure/aks/workload-identity-migration-sidecar",
            "service": "AKS",
            "services": [
                "Entra",
                "AKS"
            ],
            "severity": "Medium",
            "subcategory": "Identity",
            "text": "For Pod Identity Access Management use Azure AD Workload Identity (preview)",
            "waf": "Security"
        },
        {
            "category": "Identity and Access Management",
            "checklist": "Azure AKS Review",
            "guid": "f4dcf690-1b30-407d-abab-6f8aa780d3a3",
            "link": "https://learn.microsoft.com/azure/aks/managed-aad#non-interactive-sign-in-with-kubelogin",
            "service": "AKS",
            "services": [
                "Entra",
                "AKS"
            ],
            "severity": "Medium",
            "subcategory": "Identity",
            "text": "For AKS non-interactive logins use kubelogin (preview)",
            "waf": "Security"
        },
        {
            "category": "Identity and Access Management",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (properties.disableLocalAccounts==true) | distinct id,compliant",
            "guid": "b085b1f2-3119-4771-8c9a-bbf4411810ec",
            "link": "https://learn.microsoft.com/azure/aks/managed-aad#disable-local-accounts",
            "service": "AKS",
            "services": [
                "Entra",
                "AKS"
            ],
            "severity": "Medium",
            "subcategory": "Identity",
            "text": "Disable AKS local accounts",
            "waf": "Security"
        },
        {
            "category": "Identity and Access Management",
            "checklist": "Azure AKS Review",
            "guid": "36abb0db-c118-4f4c-9880-3f30f9a2deb6",
            "link": "https://learn.microsoft.com/azure/aks/managed-aad#configure-just-in-time-cluster-access-with-azure-ad-and-aks",
            "service": "AKS",
            "services": [
                "Entra",
                "AKS"
            ],
            "severity": "Low",
            "subcategory": "Identity",
            "text": "Configure if required Just-in-time cluster access",
            "waf": "Security"
        },
        {
            "category": "Identity and Access Management",
            "checklist": "Azure AKS Review",
            "guid": "c4d7f4c6-79bf-45d0-aa05-ce8fc717e150",
            "link": "https://learn.microsoft.com/azure/aks/managed-aad#use-conditional-access-with-azure-ad-and-aks",
            "service": "AKS",
            "services": [
                "Entra",
                "AKS"
            ],
            "severity": "Low",
            "subcategory": "Identity",
            "text": "Configure if required AAD conditional access for AKS",
            "waf": "Security"
        },
        {
            "category": "Identity and Access Management",
            "checklist": "Azure AKS Review",
            "guid": "e1123a7c-a333-4eb4-a120-4ee3f293c9f3",
            "link": "https://learn.microsoft.com/azure/aks/use-group-managed-service-accounts",
            "service": "AKS",
            "services": [
                "Entra",
                "AKS"
            ],
            "severity": "Low",
            "subcategory": "Identity",
            "text": "If required for Windows AKS workloads configure gMSA ",
            "waf": "Security"
        },
        {
            "category": "Identity and Access Management",
            "checklist": "Azure AKS Review",
            "guid": "1f711a74-3672-470b-b8b8-a2148d640d79",
            "link": "https://learn.microsoft.com/azure/aks/use-managed-identity#use-a-pre-created-kubelet-managed-identity",
            "service": "AKS",
            "services": [
                "Entra",
                "AKS"
            ],
            "severity": "Medium",
            "subcategory": "Identity",
            "text": "For finer control consider using a managed Kubelet Identity",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure AKS Review",
            "guid": "cbd8ac2a-aebc-4a2a-94da-1dbf3dc99248",
            "link": "https://azure.github.io/application-gateway-kubernetes-ingress/setup/install-existing/",
            "service": "AKS",
            "services": [
                "AppGW",
                "ACR",
                "AKS"
            ],
            "severity": "Medium",
            "subcategory": "Best practices",
            "text": "If using AGIC, do not share an AppGW across clusters",
            "waf": "Reliability"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (isnull(properties.addonProfiles.httpApplicationRouting) or properties.addonProfiles.httpApplicationRouting.enabled==false) | distinct id,compliant",
            "guid": "8008ae7d-7e4b-4475-a6c8-bdbf59bce65d",
            "link": "https://learn.microsoft.com/azure/aks/http-application-routing",
            "service": "AKS",
            "services": [
                "AKS"
            ],
            "severity": "High",
            "subcategory": "Best practices",
            "text": "Do not use AKS HTTP Routing Add-On, use instead the managed NGINX ingress with the application routing add-on.",
            "waf": "Reliability"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure AKS Review",
            "guid": "7bacd7b9-c025-4a9d-a5d2-25d6bc5439d9",
            "link": "https://learn.microsoft.com/azure/virtual-network/accelerated-networking-overview",
            "service": "AKS",
            "services": [
                "AKS"
            ],
            "severity": "Medium",
            "subcategory": "Best practices",
            "text": "For Windows workloads use Accelerated Networking",
            "waf": "Performance"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (tolower(properties.networkProfile.loadBalancerSku)=='standard') | distinct id,compliant",
            "guid": "ba7da7be-9952-4914-a384-5d997cb39132",
            "link": "https://learn.microsoft.com/azure/aks/load-balancer-standard",
            "service": "AKS",
            "services": [
                "LoadBalancer",
                "AKS"
            ],
            "severity": "High",
            "subcategory": "Best practices",
            "text": "Use the standard ALB (as opposed to the basic one)",
            "waf": "Reliability"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure AKS Review",
            "guid": "22fbe8d6-9b40-47ef-9011-25bb1a555a6b",
            "link": "https://learn.microsoft.com/azure/aks/use-multiple-node-pools#add-a-node-pool-with-a-unique-subnet",
            "service": "AKS",
            "services": [
                "VNet",
                "AKS"
            ],
            "severity": "Medium",
            "subcategory": "Best practices",
            "text": "If using Azure CNI, consider using different Subnets for NodePools",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure AKS Review",
            "guid": "c3c39c98-6bb2-4c12-859a-114b5e3df584",
            "link": "https://learn.microsoft.com/azure/private-link/private-link-overview",
            "service": "AKS",
            "services": [
                "VNet",
                "AKS",
                "PrivateLink",
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Cost",
            "text": "Use Private Endpoints (preferred) or Virtual Network Service Endpoints to access PaaS services from the cluster",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure AKS Review",
            "guid": "e8a03f97-8794-468d-96a7-86d60f96c97b",
            "link": "https://learn.microsoft.com/azure/expressroute/designing-for-disaster-recovery-with-expressroute-privatepeering",
            "services": [
                "AKS",
                "VPN"
            ],
            "severity": "Medium",
            "subcategory": "HA",
            "text": "If hybrid connectivity is required, use 2xER or ER+VPN for better availability",
            "waf": "Reliability"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (properties.networkProfile.networkPlugin=='azure') | distinct id,compliant",
            "guid": "a0f61565-9de5-458f-a372-49c831112dbd",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-network",
            "service": "AKS",
            "services": [
                "AKS"
            ],
            "severity": "High",
            "subcategory": "IPAM",
            "text": "Choose the best CNI network plugin for your requirements (Azure CNI recommended)",
            "waf": "Reliability"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure AKS Review",
            "guid": "7faf12e7-0943-4f63-8472-2da29c2b1cd6",
            "link": "https://learn.microsoft.com/azure/aks/configure-azure-cni",
            "service": "AKS",
            "services": [
                "VNet",
                "AKS"
            ],
            "severity": "High",
            "subcategory": "IPAM",
            "text": "If using Azure CNI, size your subnet accordingly considering the maximum number of pods per node",
            "waf": "Performance"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure AKS Review",
            "guid": "22f54b29-bade-43aa-b1e8-c38ec9366673",
            "link": "https://learn.microsoft.com/azure/aks/configure-azure-cni",
            "service": "AKS",
            "services": [
                "AKS"
            ],
            "severity": "High",
            "subcategory": "IPAM",
            "text": "If using Azure CNI, check the maximum pods/node (default 30)",
            "waf": "Performance"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure AKS Review",
            "description": "For internal apps organizations often open the whole AKS subnet in their firewalls. This opens network access to the nodes too, and potentially to the pods as well (if using Azure CNI). If LoadBalancer IPs are in a different subnet, only this one needs to be available to the app clients. Another reason is that if the IP addresses in the AKS subnet are a scarce resource, consuming its IP addresses for services will reduce the maximum scalability of the cluster .",
            "guid": "13c00567-4b1e-4945-a459-c373e7ed6162",
            "link": "https://learn.microsoft.com/azure/aks/internal-lb",
            "service": "AKS",
            "services": [
                "VNet",
                "AKS"
            ],
            "severity": "Low",
            "subcategory": "IPAM",
            "text": "If using private-IP LoadBalancer services, use a dedicated subnet (not the AKS subnet)",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure AKS Review",
            "guid": "43f63047-22d9-429c-8b1c-d622f54b29ba",
            "link": "https://learn.microsoft.com/azure/aks/configure-azure-cni",
            "service": "AKS",
            "services": [
                "AKS"
            ],
            "severity": "High",
            "subcategory": "IPAM",
            "text": "Size the service IP address range accordingly (it is going to limit the cluster scalability)",
            "waf": "Reliability"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure AKS Review",
            "guid": "57bf217f-6dc8-481c-81e2-785773e9c00f",
            "link": "https://learn.microsoft.com/azure/aks/use-byo-cni",
            "service": "AKS",
            "services": [
                "AKS"
            ],
            "severity": "Low",
            "subcategory": "Operations",
            "text": "If required add your own CNI plugin",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure AKS Review",
            "guid": "4b3bb365-9458-44d9-9ed1-5c8f52890364",
            "link": "https://learn.microsoft.com/azure/aks/use-multiple-node-pools#assign-a-public-ip-per-node-for-your-node-pools",
            "service": "AKS",
            "services": [
                "AKS"
            ],
            "severity": "Low",
            "subcategory": "Operations",
            "text": "If required configure Public IP per node in AKS",
            "waf": "Performance"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure AKS Review",
            "guid": "b3808b9f-a1cf-4204-ad01-3a923ce474db",
            "link": "https://learn.microsoft.com/azure/aks/concepts-network",
            "service": "AKS",
            "services": [
                "AKS"
            ],
            "severity": "Medium",
            "subcategory": "Scalability",
            "text": "Use an ingress controller to expose web-based apps instead of exposing them with LoadBalancer-type services",
            "waf": "Reliability"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure AKS Review",
            "guid": "ccb534e7-416e-4a1d-8e93-533b53199085",
            "link": "https://learn.microsoft.com/azure/aks/nat-gateway",
            "service": "AKS",
            "services": [
                "AKS"
            ],
            "severity": "Low",
            "subcategory": "Scalability",
            "text": "Use Azure NAT Gateway as outboundType for scaling egress traffic",
            "waf": "Reliability"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure AKS Review",
            "guid": "8ee9a69a-1b58-4b1e-9c61-476e110a160b",
            "link": "https://learn.microsoft.com/azure/aks/configure-azure-cni#dynamic-allocation-of-ips-and-enhanced-subnet-support",
            "service": "AKS",
            "services": [
                "AKS"
            ],
            "severity": "Medium",
            "subcategory": "Scalability",
            "text": "Use Dynamic allocations of IPs in order to avoid Azure CNI IP exhaustion",
            "waf": "Reliability"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (properties.networkProfile.outboundType=='userDefinedRouting') | distinct id,compliant",
            "guid": "3b365a91-7ecb-4e48-bbe5-4cd7df2e8bba",
            "link": "https://learn.microsoft.com/azure/aks/limit-egress-traffic",
            "service": "AKS",
            "services": [
                "NVA",
                "AKS"
            ],
            "severity": "High",
            "subcategory": "Security",
            "text": "Filter egress traffic with AzFW/NVA if your security requirements mandate it",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = ((isnull(properties.apiServerAccessProfile.enablePrivateCluster) or properties.apiServerAccessProfile.enablePrivateCluster==false) and isnotnull(properties.apiServerAccessProfile.authorizedIPRanges)) | distinct id,compliant",
            "guid": "c4581559-bb91-463e-a908-aed8c44ce3b2",
            "link": "https://learn.microsoft.com/azure/aks/api-server-authorized-ip-ranges",
            "service": "AKS",
            "services": [
                "AKS"
            ],
            "severity": "Medium",
            "subcategory": "Security",
            "text": "If using a public API endpoint, restrict the IP addresses that can access it",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | where isnotnull(properties.apiServerAccessProfile.enablePrivateCluster) | extend compliant = (properties.apiServerAccessProfile.enablePrivateCluster==true) | distinct id, compliant",
            "guid": "ecccd979-3b6b-4cda-9b50-eb2eb03dda6d",
            "link": "https://learn.microsoft.com/azure/aks/private-clusters",
            "service": "AKS",
            "services": [
                "AKS"
            ],
            "severity": "High",
            "subcategory": "Security",
            "text": "Use private clusters if your requirements mandate it",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | where isnotnull(properties.apiServerAccessProfile.enablePrivateCluster) | extend compliant = (properties.apiServerAccessProfile.enablePrivateCluster==true) | distinct id, compliant",
            "guid": "ce7f2a7c-297c-47c6-adea-a6ff838db665",
            "link": "https://learn.microsoft.com/azure/aks/use-network-policies",
            "service": "AKS",
            "services": [
                "AzurePolicy",
                "AKS"
            ],
            "severity": "Medium",
            "subcategory": "Security",
            "text": "For Windows 2019 and 2022 AKS nodes Calico Network Policies can be used ",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = isnotnull(properties.networkProfile.networkPolicy) | distinct id,compliant",
            "guid": "58d7c892-ddb1-407d-9769-ae669ca48e4a",
            "link": "https://learn.microsoft.com/azure/aks/use-network-policies",
            "service": "AKS",
            "services": [
                "AzurePolicy",
                "AKS"
            ],
            "severity": "High",
            "subcategory": "Security",
            "text": "Enable a Kubernetes Network Policy option (Calico/Azure)",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure AKS Review",
            "guid": "85e2223e-ce8b-4b12-907c-a5f16f158e3e",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-network",
            "service": "AKS",
            "services": [
                "AzurePolicy",
                "AKS"
            ],
            "severity": "High",
            "subcategory": "Security",
            "text": "Use Kubernetes network policies to increase intra-cluster security",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure AKS Review",
            "guid": "a3a92c2d-e7e2-4165-a3a8-7af4a7a1f893",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-network",
            "service": "AKS",
            "services": [
                "WAF",
                "AKS"
            ],
            "severity": "High",
            "subcategory": "Security",
            "text": "Use a WAF for web workloads (UIs or APIs)",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure AKS Review",
            "graph": "Resources | where type=~'microsoft.containerservice/managedclusters' | project resourceGroup,name,pools=properties.agentPoolProfiles | mv-expand pools | project subnetId=tostring(pools.vnetSubnetID) | where isnotempty(subnetId) | join (Resources | where type=='microsoft.network/virtualnetworks' | project id,resourceGroup,name,enableDdosProtection=tostring(properties.enableDdosProtection),subnets=properties.subnets | mv-expand subnets | project id,resourceGroup,name,enableDdosProtection,subnetId=tostring(subnets.id)) on subnetId | distinct id,resourceGroup,name,enableDdosProtection | extend compliant = (enableDdosProtection == 'true')",
            "guid": "9bda4776-8f24-4c11-9775-c2ea55b46a94",
            "link": "https://learn.microsoft.com/azure/virtual-network/ddos-protection-overview",
            "service": "AKS",
            "services": [
                "VNet",
                "AKS",
                "DDoS"
            ],
            "severity": "Medium",
            "subcategory": "Security",
            "text": "Use DDoS Standard in the AKS Virtual Network",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure AKS Review",
            "graph": "Resources | where type=~'microsoft.containerservice/managedclusters' | project resourceGroup,name,pools=properties.agentPoolProfiles | mv-expand pools | project subnetId=tostring(pools.vnetSubnetID) | where isnotempty(subnetId) | join (Resources | where type=='microsoft.network/virtualnetworks' | project id,resourceGroup,name,enableDdosProtection=tostring(properties.enableDdosProtection),subnets=properties.subnets | mv-expand subnets | project id,resourceGroup,name,enableDdosProtection,subnetId=tostring(subnets.id)) on subnetId | distinct id,resourceGroup,name,enableDdosProtection | extend compliant = (enableDdosProtection == 'true')",
            "guid": "6c46b91a-1107-4485-ad66-3183e2a8c266",
            "link": "https://learn.microsoft.com/azure/aks/http-proxy",
            "service": "AKS",
            "services": [
                "AKS"
            ],
            "severity": "Low",
            "subcategory": "Security",
            "text": "If required add company HTTP Proxy",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure AKS Review",
            "guid": "e9855d04-c3c3-49c9-a6bb-2c12159a114b",
            "link": "https://learn.microsoft.com/azure/aks/servicemesh-about",
            "service": "AKS",
            "services": [
                "AKS"
            ],
            "severity": "Medium",
            "subcategory": "Security",
            "text": "Consider using a service mesh for advanced microservice communication management",
            "waf": "Security"
        },
        {
            "category": "Operations",
            "checklist": "Azure AKS Review",
            "guid": "67f7a9ed-5b31-4f38-a3f3-9812b2463cff",
            "link": "https://learn.microsoft.com/azure/azure-monitor/insights/container-insights-metric-alerts",
            "service": "AKS",
            "services": [
                "Monitor",
                "AKS"
            ],
            "severity": "High",
            "subcategory": "Alerting",
            "text": "Configure alerts on the most critical metrics (see Container Insights for recommendations)",
            "waf": "Operations"
        },
        {
            "category": "Operations",
            "checklist": "Azure AKS Review",
            "guid": "337453a3-cc63-4963-9a65-22ac19e80696",
            "link": "https://learn.microsoft.com/azure/advisor/advisor-get-started",
            "service": "AKS",
            "services": [
                "Entra",
                "AKS"
            ],
            "severity": "Low",
            "subcategory": "Compliance",
            "text": "Check regularly Azure Advisor for recommendations on your cluster",
            "waf": "Operations"
        },
        {
            "category": "Operations",
            "checklist": "Azure AKS Review",
            "guid": "3aa70560-e7e7-4968-be3d-628af35b2ced",
            "link": "https://learn.microsoft.com/azure/aks/certificate-rotation",
            "service": "AKS",
            "services": [
                "AKS"
            ],
            "severity": "Low",
            "subcategory": "Compliance",
            "text": "Enable AKS auto-certificate rotation",
            "waf": "Operations"
        },
        {
            "category": "Operations",
            "checklist": "Azure AKS Review",
            "guid": "e189c599-df0d-45a7-9dd4-ce32c1881370",
            "link": "https://learn.microsoft.com/azure/aks/supported-kubernetes-versions",
            "service": "AKS",
            "services": [
                "AKS"
            ],
            "severity": "High",
            "subcategory": "Compliance",
            "text": "Have a regular process to upgrade your kubernetes version periodically (quarterly, for example), or use the AKS autoupgrade feature",
            "waf": "Operations"
        },
        {
            "category": "Operations",
            "checklist": "Azure AKS Review",
            "guid": "6f7c4c0d-4e51-4464-ad24-57ed67138b82",
            "link": "https://learn.microsoft.com/azure/aks/node-updates-kured",
            "service": "AKS",
            "services": [
                "AKS"
            ],
            "severity": "High",
            "subcategory": "Compliance",
            "text": "Use kured for Linux node upgrades in case you are not using node-image upgrade",
            "waf": "Operations"
        },
        {
            "category": "Operations",
            "checklist": "Azure AKS Review",
            "guid": "139c9580-ade3-426a-ba09-cf157d9f6477",
            "link": "https://learn.microsoft.com/azure/aks/node-image-upgrade",
            "service": "AKS",
            "services": [
                "AKS"
            ],
            "severity": "High",
            "subcategory": "Compliance",
            "text": "Have a regular process to upgrade the cluster node images periodically (weekly, for example)",
            "waf": "Operations"
        },
        {
            "category": "Operations",
            "checklist": "Azure AKS Review",
            "guid": "0102ce16-ee30-41e6-b882-e52e4621dd68",
            "link": "https://learn.microsoft.com/azure/architecture/example-scenario/bedrock/bedrock-automated-deployments",
            "service": "AKS",
            "services": [
                "AKS"
            ],
            "severity": "Low",
            "subcategory": "Compliance",
            "text": "Consider gitops to deploy applications or cluster configuration to multiple clusters",
            "waf": "Operations"
        },
        {
            "category": "Operations",
            "checklist": "Azure AKS Review",
            "guid": "d7672c26-7602-4482-85a4-14527fbe855c",
            "link": "https://learn.microsoft.com/azure/aks/command-invoke",
            "service": "AKS",
            "services": [
                "AKS"
            ],
            "severity": "Low",
            "subcategory": "Compliance",
            "text": "Consider using AKS command invoke on private clusters",
            "waf": "Operations"
        },
        {
            "category": "Operations",
            "checklist": "Azure AKS Review",
            "guid": "31d7aaab-7571-4449-ab80-53d89e89d17b",
            "link": "https://learn.microsoft.com/azure/aks/node-auto-repair#node-autodrain",
            "service": "AKS",
            "services": [
                "AKS"
            ],
            "severity": "Low",
            "subcategory": "Compliance",
            "text": "For planned events consider using Node Auto Drain",
            "waf": "Operations"
        },
        {
            "category": "Operations",
            "checklist": "Azure AKS Review",
            "guid": "ed0fda7f-211b-47c7-8b6e-c18873fb473c",
            "link": "https://learn.microsoft.com/azure/aks/faq",
            "service": "AKS",
            "services": [
                "AKS"
            ],
            "severity": "High",
            "subcategory": "Compliance",
            "text": "Develop own governance practices to make sure no changes are performed by operators in the node RG (aka 'infra RG')",
            "waf": "Operations"
        },
        {
            "category": "Operations",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (properties.nodeResourceGroup !startswith 'MC_') | distinct id,compliant",
            "guid": "73b32a5a-67f7-4a9e-b5b3-1f38c3f39812",
            "link": "https://learn.microsoft.com/azure/aks/cluster-configuration",
            "service": "AKS",
            "services": [
                "AKS"
            ],
            "severity": "Low",
            "subcategory": "Compliance",
            "text": "Use custom Node RG (aka 'Infra RG') name",
            "waf": "Operations"
        },
        {
            "category": "Operations",
            "checklist": "Azure AKS Review",
            "guid": "b2463cff-e189-4c59-adf0-d5a73dd4ce32",
            "link": "https://kubernetes.io/docs/setup/release/notes/",
            "service": "AKS",
            "services": [
                "AKS"
            ],
            "severity": "Medium",
            "subcategory": "Compliance",
            "text": "Do not use deprecated Kubernetes APIs in your YAML manifests",
            "waf": "Operations"
        },
        {
            "category": "Operations",
            "checklist": "Azure AKS Review",
            "guid": "c1881370-6f7c-44c0-b4e5-14648d2457ed",
            "link": "https://learn.microsoft.com/azure-stack/aks-hci/adapt-apps-mixed-os-clusters",
            "service": "AKS",
            "services": [
                "AKS"
            ],
            "severity": "Low",
            "subcategory": "Compliance",
            "text": "Taint Windows nodes",
            "waf": "Operations"
        },
        {
            "category": "Operations",
            "checklist": "Azure AKS Review",
            "guid": "67138b82-0102-4ce1-9ee3-01e6e882e52e",
            "link": "https://learn.microsoft.com/virtualization/windowscontainers/deploy-containers/version-compatibility?tabs=windows-server-20H2%2Cwindows-10-20H2",
            "service": "AKS",
            "services": [
                "AKS"
            ],
            "severity": "Low",
            "subcategory": "Compliance",
            "text": "Keep windows containers patch level in sync with host patch level",
            "waf": "Operations"
        },
        {
            "category": "Operations",
            "checklist": "Azure AKS Review",
            "description": "Via Diagnostic Settings at the cluster level",
            "guid": "5b56ad48-408f-4e72-934c-476ba280dcf5",
            "link": "https://learn.microsoft.com/azure/aks/monitor-aks",
            "service": "AKS",
            "services": [
                "Monitor",
                "AKS"
            ],
            "severity": "Low",
            "subcategory": "Compliance",
            "text": "Send master logs (aka API logs) to Azure Monitor or your preferred log management solution",
            "waf": "Operations"
        },
        {
            "category": "Operations",
            "checklist": "Azure AKS Review",
            "guid": "64d1a846-e28a-4b6b-9a33-22a635c15a21",
            "link": "https://learn.microsoft.com/azure/aks/node-pool-snapshot",
            "service": "AKS",
            "services": [
                "AKS"
            ],
            "severity": "Low",
            "subcategory": "Compliance",
            "text": "If required use nodePool snapshots",
            "waf": "Cost"
        },
        {
            "category": "Operations",
            "checklist": "Azure AKS Review",
            "guid": "c5a5b252-1e44-4a59-a9d2-399c4d7b68d0",
            "link": "https://learn.microsoft.com/azure/aks/spot-node-pool",
            "service": "AKS",
            "services": [
                "AKS",
                "Cost"
            ],
            "severity": "Low",
            "subcategory": "Cost",
            "text": "Consider spot node pools for non time-sensitive workloads",
            "waf": "Operations"
        },
        {
            "category": "Operations",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (isnotnull(properties.addonProfiles.aciConnectorLinux) and properties.addonProfiles.aciConnectorLinux.enabled==true) | distinct id,compliant",
            "guid": "c755562f-2b4e-4456-9b4d-874a748b662e",
            "link": "https://learn.microsoft.com/azure/aks/concepts-scale",
            "service": "AKS",
            "services": [
                "AKS",
                "Cost"
            ],
            "severity": "Low",
            "subcategory": "Cost",
            "text": "Consider AKS virtual node for quick bursting",
            "waf": "Operations"
        },
        {
            "category": "Operations",
            "checklist": "Azure AKS Review",
            "guid": "6f8389a7-f82c-4b8e-a8c0-aa63a25a4956",
            "link": "https://learn.microsoft.com/azure/azure-monitor/insights/container-insights-overview",
            "service": "AKS",
            "services": [
                "Monitor",
                "AKS"
            ],
            "severity": "High",
            "subcategory": "Monitoring",
            "text": "Monitor your cluster metrics with Container Insights (or other tools like Prometheus)",
            "waf": "Operations"
        },
        {
            "category": "Operations",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (isnotnull(properties.addonProfiles.omsagent) and properties.addonProfiles.omsagent.enabled==true) | distinct id,compliant",
            "guid": "eaa8dc4a-2436-47b3-9697-15b1752beee0",
            "link": "https://learn.microsoft.com/azure/azure-monitor/insights/container-insights-overview",
            "service": "AKS",
            "services": [
                "Monitor",
                "AKS"
            ],
            "severity": "High",
            "subcategory": "Monitoring",
            "text": "Store and analyze your cluster logs with Container Insights (or other tools like Telegraf/ElasticSearch)",
            "waf": "Operations"
        },
        {
            "category": "Operations",
            "checklist": "Azure AKS Review",
            "guid": "4621dd68-c5a5-4be2-bdb1-1726769ef669",
            "link": "https://learn.microsoft.com/azure/azure-monitor/containers/container-insights-analyze",
            "service": "AKS",
            "services": [
                "Monitor",
                "AKS"
            ],
            "severity": "Medium",
            "subcategory": "Monitoring",
            "text": "Monitor CPU and memory utilization of the nodes",
            "waf": "Operations"
        },
        {
            "category": "Operations",
            "checklist": "Azure AKS Review",
            "guid": "1a4835ac-9422-423e-ae80-b123081a5417",
            "link": "https://learn.microsoft.com/azure/aks/configure-azure-cni",
            "service": "AKS",
            "services": [
                "Monitor",
                "AKS"
            ],
            "severity": "Medium",
            "subcategory": "Monitoring",
            "text": "If using Azure CNI, monitor % of pod IPs consumed per node",
            "waf": "Operations"
        },
        {
            "category": "Operations",
            "checklist": "Azure AKS Review",
            "description": "I/O in the OS disk is a critical resource. If the OS in the nodes gets throttled on I/O, this could lead to unpredictable behavior, typically ending up in node being declared NotReady",
            "guid": "415833ea-3ad3-4c2d-b733-165c3acbe04b",
            "link": "https://learn.microsoft.com/azure/virtual-machines/premium-storage-performance",
            "service": "AKS",
            "services": [
                "ServiceBus",
                "EventHubs",
                "Monitor",
                "AKS",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Monitoring",
            "text": "Monitor OS disk queue depth in nodes",
            "waf": "Operations"
        },
        {
            "category": "Operations",
            "checklist": "Azure AKS Review",
            "guid": "be209d39-fda4-4777-a424-d116785c2fa5",
            "link": "https://learn.microsoft.com/azure/aks/load-balancer-standard",
            "service": "AKS",
            "services": [
                "LoadBalancer",
                "NVA",
                "Monitor",
                "AKS"
            ],
            "severity": "Medium",
            "subcategory": "Monitoring",
            "text": "If not using egress filtering with AzFW/NVA, monitor standard ALB allocated SNAT ports",
            "waf": "Operations"
        },
        {
            "category": "Operations",
            "checklist": "Azure AKS Review",
            "guid": "74c2ee76-569b-4a79-a57e-dedf91b022c9",
            "link": "https://learn.microsoft.com/azure/aks/aks-resource-health",
            "service": "AKS",
            "services": [
                "Monitor",
                "AKS"
            ],
            "severity": "Medium",
            "subcategory": "Monitoring",
            "text": "Subscribe to resource health notifications for your AKS cluster",
            "waf": "Operations"
        },
        {
            "category": "Operations",
            "checklist": "Azure AKS Review",
            "guid": "b54eb2eb-03dd-4aa3-9927-18e2edb11726",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-scheduler",
            "service": "AKS",
            "services": [
                "AKS"
            ],
            "severity": "High",
            "subcategory": "Resources",
            "text": "Configure requests and limits in your pod specs",
            "waf": "Operations"
        },
        {
            "category": "Operations",
            "checklist": "Azure AKS Review",
            "guid": "769ef669-1a48-435a-a942-223ece80b123",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-scheduler",
            "service": "AKS",
            "services": [
                "AKS"
            ],
            "severity": "Medium",
            "subcategory": "Resources",
            "text": "Enforce resource quotas for namespaces",
            "waf": "Operations"
        },
        {
            "category": "Operations",
            "checklist": "Azure AKS Review",
            "guid": "081a5417-4158-433e-a3ad-3c2de733165c",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits",
            "service": "AKS",
            "services": [
                "Subscriptions",
                "AKS"
            ],
            "severity": "High",
            "subcategory": "Resources",
            "text": "Ensure your subscription has enough quota to scale out your nodepools",
            "waf": "Operations"
        },
        {
            "category": "Operations",
            "checklist": "Azure AKS Review",
            "guid": "f4fd0602-7ab5-46f1-b66a-e9dea9654a65",
            "link": "https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/",
            "service": "AKS",
            "services": [
                "AKS"
            ],
            "severity": "High",
            "subcategory": "Resources",
            "text": "Configure Liveness and Readiness probes for all deployments",
            "waf": "Operations"
        },
        {
            "category": "Operations",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (isnotnull(properties.autoScalerProfile)) | distinct id,compliant",
            "guid": "90ce65de-8e13-4f9c-abd4-69266abca264",
            "link": "https://learn.microsoft.com/azure/aks/concepts-scale",
            "service": "AKS",
            "services": [
                "AKS"
            ],
            "severity": "Medium",
            "subcategory": "Scalability",
            "text": "Use the Cluster Autoscaler",
            "waf": "Performance"
        },
        {
            "category": "Operations",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (isnotnull(properties.austoscalerProfile)) | distinct id,compliant",
            "guid": "831c2872-c693-4b39-a887-a561bada49bc",
            "link": "https://learn.microsoft.com/azure/aks/custom-node-configuration",
            "service": "AKS",
            "services": [
                "AKS"
            ],
            "severity": "Low",
            "subcategory": "Scalability",
            "text": "Customize node configuration for AKS node pools",
            "waf": "Performance"
        },
        {
            "category": "Operations",
            "checklist": "Azure AKS Review",
            "guid": "faa19bfe-9d55-4d04-a3c4-919ca1b2d121",
            "link": "https://learn.microsoft.com/azure/aks/concepts-scale",
            "service": "AKS",
            "services": [
                "AKS"
            ],
            "severity": "Medium",
            "subcategory": "Scalability",
            "text": "Use the Horizontal Pod Autoscaler when required",
            "waf": "Performance"
        },
        {
            "category": "Operations",
            "checklist": "Azure AKS Review",
            "description": "Larger nodes will bring higher performance and features such as ephemeral disks and accelerated networking, but they will increase the blast radius and decrease the scaling granularity",
            "guid": "5ae124ba-34df-4585-bcdc-e9bd3bb0cdb3",
            "link": "https://blog.cloudtrooper.net/2020/10/23/which-vm-size-should-i-choose-as-aks-node/",
            "service": "AKS",
            "services": [
                "AKS"
            ],
            "severity": "High",
            "subcategory": "Scalability",
            "text": "Consider an appropriate node size, not too large or too small",
            "waf": "Performance"
        },
        {
            "category": "Operations",
            "checklist": "Azure AKS Review",
            "guid": "38800e6a-ae01-40a2-9fbc-ae5a06e5462d",
            "link": "https://learn.microsoft.com/azure/aks/quotas-skus-regions#service-quotas-and-limits",
            "service": "AKS",
            "services": [
                "AKS"
            ],
            "severity": "Low",
            "subcategory": "Scalability",
            "text": "If more than 5000 nodes are required for scalability then consider using an additional AKS cluster",
            "waf": "Performance"
        },
        {
            "category": "Operations",
            "checklist": "Azure AKS Review",
            "guid": "9583c0f6-6083-43f6-aa6b-df7102c901bb",
            "link": "https://learn.microsoft.com/azure/event-grid/event-schema-aks",
            "service": "AKS",
            "services": [
                "AKS"
            ],
            "severity": "Low",
            "subcategory": "Scalability",
            "text": "Consider subscribing to EventGrid Events for AKS automation",
            "waf": "Performance"
        },
        {
            "category": "Operations",
            "checklist": "Azure AKS Review",
            "guid": "c5016d8c-c6c9-4165-89ae-673ef0fff19d",
            "link": "https://learn.microsoft.com/azure/aks/manage-abort-operations",
            "service": "AKS",
            "services": [
                "AKS"
            ],
            "severity": "Low",
            "subcategory": "Scalability",
            "text": "For long running operation on an AKS cluster consider event termination",
            "waf": "Performance"
        },
        {
            "category": "Operations",
            "checklist": "Azure AKS Review",
            "guid": "c4e37133-f186-4ce1-aed9-9f1b32f6e021",
            "link": "https://learn.microsoft.com/azure/aks/use-azure-dedicated-hosts",
            "service": "AKS",
            "services": [
                "AKS"
            ],
            "severity": "Low",
            "subcategory": "Scalability",
            "text": "If required consider using Azure Dedicated Hosts for AKS nodes",
            "waf": "Performance"
        },
        {
            "category": "Operations",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | project id,resourceGroup,name,pools=properties.agentPoolProfiles | mvexpand pools | extend compliant = (pools.osDiskType=='Ephemeral') | project id,name=strcat(name,'-',pools.name), resourceGroup, compliant",
            "guid": "24367b33-6971-45b1-952b-eee0b9b588de",
            "link": "https://learn.microsoft.com/azure/aks/cluster-configuration",
            "service": "AKS",
            "services": [
                "AKS",
                "Storage"
            ],
            "severity": "High",
            "subcategory": "Storage",
            "text": "Use ephemeral OS disks",
            "waf": "Performance"
        },
        {
            "category": "Operations",
            "checklist": "Azure AKS Review",
            "guid": "f0ce315f-1120-4166-8206-94f2cf3a4d07",
            "link": "https://learn.microsoft.com/azure/virtual-machines/disks-types",
            "service": "AKS",
            "services": [
                "AKS",
                "Storage"
            ],
            "severity": "High",
            "subcategory": "Storage",
            "text": "For non-ephemeral disks, use high IOPS and larger OS disks for the nodes when running many pods/node since it requires high performance for running multiple pods and will generate huge logs with default AKS log rotation thresholds",
            "waf": "Performance"
        },
        {
            "category": "Operations",
            "checklist": "Azure AKS Review",
            "guid": "39c486ce-d5af-4062-89d5-18bb5fd795db",
            "link": "https://learn.microsoft.com/azure/aks/use-ultra-disks",
            "service": "AKS",
            "services": [
                "AKS",
                "Storage"
            ],
            "severity": "Low",
            "subcategory": "Storage",
            "text": "For hyper performance storage option use Ultra Disks on AKS",
            "waf": "Performance"
        },
        {
            "category": "Operations",
            "checklist": "Azure AKS Review",
            "guid": "9f7547c1-747d-4c56-868a-714435bd19dd",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-multi-region",
            "service": "AKS",
            "services": [
                "AKS",
                "Storage",
                "SQL"
            ],
            "severity": "Medium",
            "subcategory": "Storage",
            "text": "Avoid keeping state in the cluster, and store data outside (AzStorage, AzSQL, Cosmos, etc)",
            "waf": "Performance"
        },
        {
            "category": "Operations",
            "checklist": "Azure AKS Review",
            "guid": "24429eb7-2281-4376-85cc-57b4a4b18142",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-storage",
            "service": "AKS",
            "services": [
                "AKS",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Storage",
            "text": "If using AzFiles Standard, consider AzFiles Premium and/or ANF for performance reasons",
            "waf": "Performance"
        },
        {
            "category": "Operations",
            "checklist": "Azure AKS Review",
            "guid": "83958a8c-2689-4b32-ab57-cfc64546135a",
            "link": "https://learn.microsoft.com/azure/aks/availability-zones#azure-disk-availability-zone-support",
            "service": "AKS",
            "services": [
                "AKS",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Storage",
            "text": "If using Azure Disks and AZs, consider having nodepools within a zone for LRS disk with VolumeBindingMode:WaitForFirstConsumer for provisioning storage in right zone or use ZRS disk for nodepools spanning multiple zones",
            "waf": "Performance"
        },
        {
            "category": "Operations management",
            "checklist": "Microsoft Purview Review Checklist",
            "guid": "1fc2fc14-eea6-4e69-b8d9-a3edc218e687",
            "link": "https://polite-sea-0995b240f.2.azurestaticapps.net/technical-delivery-playbook/azure-services/analytics/purview/",
            "service": "Purview",
            "services": [],
            "severity": "Medium",
            "subcategory": "Best Practices",
            "text": "Leverage FTA Resillency Handbook",
            "waf": "Reliability"
        },
        {
            "category": "Operations management",
            "checklist": "Microsoft Purview Review Checklist",
            "guid": "ab067acb-49e5-4b96-8332-4ecf8cc13318",
            "link": "https://learn.microsoft.com/purview/disaster-recovery",
            "service": "Purview",
            "services": [
                "ASR"
            ],
            "severity": "High",
            "subcategory": "Disaster Recovery",
            "text": "Plan for Data Center level outage",
            "waf": "Reliability"
        },
        {
            "category": "Operations management",
            "checklist": "Microsoft Purview Review Checklist",
            "description": "1. Create the new account 2. Migrate configuration items 3. Run scans 4. Migrate custom typedefs and custom assets 5. Migrate relationships 6. Migrate glossary terms 7. Assign classifications to assets 8. Assign contacts to assets",
            "guid": "da611702-69f4-4fb4-aa3d-3ef7f3176c4b",
            "link": "https://learn.microsoft.com/purview/disaster-recovery",
            "service": "Purview",
            "services": [
                "ASR"
            ],
            "severity": "Medium",
            "subcategory": "Disaster Recovery",
            "text": "Practice Failover for BCDR",
            "waf": "Reliability"
        },
        {
            "category": "Operations management",
            "checklist": "Microsoft Purview Review Checklist",
            "guid": "97b15b8a-219a-44ab-bb57-879024d22678",
            "link": "https://learn.microsoft.com/purview/disaster-recovery",
            "service": "Purview",
            "services": [
                "Backup"
            ],
            "severity": "High",
            "subcategory": "Backup and Restore ",
            "text": "Plan a backup strategy and take regular backups",
            "waf": "Reliability"
        },
        {
            "category": "Operations management",
            "checklist": "Microsoft Purview Review Checklist",
            "guid": "6d20b56c-56a9-4581-89bf-8d8e5c586b7d",
            "link": "https://learn.microsoft.com/purview/manage-kafka-dotnet",
            "service": "Purview",
            "services": [
                "EventHubs"
            ],
            "severity": "Low",
            "subcategory": "Purview Accounts Replications",
            "text": "Use Microsoft Purview's Event Hubs to subscribe and create entities to another account",
            "waf": "Reliability"
        },
        {
            "category": "Operations management",
            "checklist": "Microsoft Purview Review Checklist",
            "guid": "8cdc15ac-c075-4ee9-a130-a8889579e76b",
            "link": "https://learn.microsoft.com/purview/deployment-best-practices",
            "service": "Purview",
            "services": [],
            "severity": "Medium",
            "subcategory": "Data catalog",
            "text": "Follow Purview accounts architectures and deployment best practices",
            "waf": "Reliability"
        },
        {
            "category": "Operations management",
            "checklist": "Microsoft Purview Review Checklist",
            "guid": "896e710a-7da7-4be9-a56d-14d3c49d997c",
            "link": "https://learn.microsoft.com/purview/concept-best-practices-collections",
            "service": "Purview",
            "services": [],
            "severity": "Medium",
            "subcategory": "Data catalog",
            "text": "Follow Collection Architectures and best practices",
            "waf": "Reliability"
        },
        {
            "category": "Operations management",
            "checklist": "Microsoft Purview Review Checklist",
            "guid": "b3d1325a-a225-4c6f-9e06-85edddea8a4b",
            "link": "https://learn.microsoft.com/purview/concept-best-practices-asset-lifecycle",
            "service": "Purview",
            "services": [],
            "severity": "Medium",
            "subcategory": "Data catalog",
            "text": "Follow Assest lifecycle best practices",
            "waf": "Reliability"
        },
        {
            "category": "Operations management",
            "checklist": "Microsoft Purview Review Checklist",
            "guid": "7cdeb3c6-1fc2-4fc1-9eea-6e69d8d9a3ed",
            "link": "https://learn.microsoft.com/purview/concept-best-practices-automation",
            "service": "Purview",
            "services": [],
            "severity": "Medium",
            "subcategory": "Data catalog",
            "text": "Follow automation best practices",
            "waf": "Reliability"
        },
        {
            "category": "Operations management",
            "checklist": "Microsoft Purview Review Checklist",
            "guid": "c218e687-ab06-47ac-a49e-5b9603324ecf",
            "link": "https://learn.microsoft.com/purview/disaster-recovery",
            "service": "Purview",
            "services": [
                "Backup"
            ],
            "severity": "Medium",
            "subcategory": "Data catalog",
            "text": "Follow Backup and Migration Best practices",
            "waf": "Reliability"
        },
        {
            "category": "Operations management",
            "checklist": "Microsoft Purview Review Checklist",
            "guid": "8cc13318-da61-4170-869f-4fb4aa3d3ef7",
            "link": "https://learn.microsoft.com/purview/concept-best-practices-glossary",
            "service": "Purview",
            "services": [],
            "severity": "Medium",
            "subcategory": "Data catalog",
            "text": "Follow Purview Glossary Best Practices",
            "waf": "Reliability"
        },
        {
            "category": "Operations management",
            "checklist": "Microsoft Purview Review Checklist",
            "guid": "f3176c4b-97b1-45b8-a219-a4abeb578790",
            "link": "https://learn.microsoft.com/purview/concept-workflow",
            "service": "Purview",
            "services": [],
            "severity": "Low",
            "subcategory": "Data catalog",
            "text": "Leverage Workflows ",
            "waf": "Reliability"
        },
        {
            "category": "Operations management",
            "checklist": "Microsoft Purview Review Checklist",
            "guid": "24d22678-6d20-4b56-a56a-958119bf8d8e",
            "link": "https://learn.microsoft.com/purview/concept-best-practices-security",
            "service": "Purview",
            "services": [],
            "severity": "Medium",
            "subcategory": "Data catalog",
            "text": "Follow Purview Security Best Practices",
            "waf": "Reliability"
        },
        {
            "category": "Operations management",
            "checklist": "Microsoft Purview Review Checklist",
            "guid": "5c586b7d-8cdc-415a-ac07-5ee9b130a888",
            "link": "https://learn.microsoft.com/purview/concept-best-practices-lineage-azure-data-factory",
            "service": "Purview",
            "services": [],
            "severity": "Medium",
            "subcategory": "Data Map",
            "text": "Follow Purview Data Lineage Best Practices",
            "waf": "Reliability"
        },
        {
            "category": "Operations management",
            "checklist": "Microsoft Purview Review Checklist",
            "guid": "9579e76b-896e-4710-a7da-7be9956d14d3",
            "link": "https://learn.microsoft.com/purview/concept-best-practices-scanning",
            "service": "Purview",
            "services": [],
            "severity": "Medium",
            "subcategory": "Data Map",
            "text": "Follow Best Practices for Scanning Registered Sources",
            "waf": "Reliability"
        },
        {
            "category": "Operations management",
            "checklist": "Microsoft Purview Review Checklist",
            "guid": "c49d997c-b3d1-4325-aa22-5c6f4e0685ed",
            "link": "https://learn.microsoft.com/purview/concept-best-practices-classification",
            "service": "Purview",
            "services": [],
            "severity": "Medium",
            "subcategory": "Data Map",
            "text": "Follow Classification Best Practices in Governance Portal",
            "waf": "Reliability"
        },
        {
            "category": "Operations management",
            "checklist": "Microsoft Purview Review Checklist",
            "guid": "ddea8a4b-7cde-4b3c-91fc-2fc14eea6e69",
            "link": "https://learn.microsoft.com/purview/sensitivity-labels-frequently-asked-questions",
            "service": "Purview",
            "services": [],
            "severity": "Medium",
            "subcategory": "Data Map",
            "text": "Perform Sensitivity Labelling in the Purview Data Map",
            "waf": "Reliability"
        },
        {
            "category": "Operations management",
            "checklist": "Microsoft Purview Review Checklist",
            "guid": "d8d9a3ed-c218-4e68-9ab0-67acb49e5b96",
            "link": "https://learn.microsoft.com/purview/concept-data-share",
            "service": "Purview",
            "services": [
                "Storage"
            ],
            "severity": "Low",
            "subcategory": "Data Sharing",
            "text": "Leverage Azure Storage in-place data sharing with Microsoft Purview",
            "waf": "Reliability"
        },
        {
            "category": "Operations management",
            "checklist": "Microsoft Purview Review Checklist",
            "guid": "03324ecf-8cc1-4331-ada6-1170269f4fb4",
            "link": "https://learn.microsoft.com/purview/concept-insights",
            "service": "Purview",
            "services": [],
            "severity": "Low",
            "subcategory": "Data Estate",
            "text": "Leverage Data Estate Insights",
            "waf": "Reliability"
        },
        {
            "category": "Operations management",
            "checklist": "Microsoft Purview Review Checklist",
            "guid": "aa3d3ef7-f317-46c4-a97b-15b8a219a4ab",
            "link": "https://learn.microsoft.com/purview/catalog-adoption-insights",
            "service": "Purview",
            "services": [],
            "severity": "Low",
            "subcategory": "Data Estate",
            "text": "Use Data stewardship and Catalog adoption",
            "waf": "Reliability"
        },
        {
            "category": "Operations management",
            "checklist": "Microsoft Purview Review Checklist",
            "guid": "eb578790-24d2-4267-a6d2-0b56c56a9581",
            "link": "https://learn.microsoft.com/purview/concept-insights",
            "service": "Purview",
            "services": [],
            "severity": "Low",
            "subcategory": "Data Estate",
            "text": "Use Inventory and Ownership",
            "waf": "Reliability"
        },
        {
            "category": "Operations management",
            "checklist": "Microsoft Purview Review Checklist",
            "guid": "19bf8d8e-5c58-46b7-b8cd-c15acc075ee9",
            "link": "https://learn.microsoft.com/purview/glossary-insights",
            "service": "Purview",
            "services": [],
            "severity": "Low",
            "subcategory": "Data Estate",
            "text": "Leverage Insights for Glossary, Classifications, Sensitivity Labels",
            "waf": "Reliability"
        },
        {
            "category": "Operations management",
            "checklist": "Microsoft Purview Review Checklist",
            "guid": "b130a888-9579-4e76-a896-e710a7da7be9",
            "link": "https://learn.microsoft.com/purview/compliance-manager",
            "service": "Purview",
            "services": [],
            "severity": "Medium",
            "subcategory": "Data Quality ",
            "text": "Generate assessment scores",
            "waf": "Reliability"
        },
        {
            "category": "Operations management",
            "checklist": "Microsoft Purview Review Checklist",
            "guid": "956d14d3-c49d-4997-ab3d-1325aa225c6f",
            "link": "https://learn.microsoft.com/purview/compliance-manager-scoring",
            "service": "Purview",
            "services": [],
            "severity": "Medium",
            "subcategory": "Data Quality ",
            "text": "Profiling- get summaries of data content",
            "waf": "Reliability"
        },
        {
            "category": "Operations management",
            "checklist": "Microsoft Purview Review Checklist",
            "guid": "4e0685ed-ddea-48a4-a7cd-eb3c61fc2fc1",
            "link": "https://learn.microsoft.com/purview/concept-policies-data-owner#microsoft-purview-policy-concepts",
            "service": "Purview",
            "services": [
                "AzurePolicy"
            ],
            "severity": "Low",
            "subcategory": "Data Policy",
            "text": "Follow Microsoft Purview Data Owner access policies",
            "waf": "Reliability"
        },
        {
            "category": "Operations management",
            "checklist": "Microsoft Purview Review Checklist",
            "guid": "4eea6e69-d8d9-4a3e-bc21-8e687ab067ac",
            "link": "https://learn.microsoft.com/purview/concept-self-service-data-access-policy",
            "service": "Purview",
            "services": [
                "AzurePolicy"
            ],
            "severity": "Low",
            "subcategory": "Data Policy",
            "text": "Follow Self-service access policies",
            "waf": "Reliability"
        },
        {
            "category": "Operations management",
            "checklist": "Microsoft Purview Review Checklist",
            "guid": "b49e5b96-0332-44ec-b8cc-13318da61170",
            "link": "https://learn.microsoft.com/purview/concept-policies-devops",
            "service": "Purview",
            "services": [
                "AzurePolicy"
            ],
            "severity": "Low",
            "subcategory": "Data Policy",
            "text": "Follow DevOps policies",
            "waf": "Reliability"
        },
        {
            "category": "BC and DR",
            "checklist": "Container Apps Review",
            "guid": "af416482-663c-4ed6-b195-b44c7068e09c",
            "link": "https://learn.microsoft.com/azure/reliability/reliability-azure-container-apps?tabs=azure-cli#availability-zone-support",
            "query": "resources | where type =~ 'Microsoft.App/managedEnvironments' | project name, resourceGroup, location, zoneRedundancy = tolower(tostring(properties.zoneRedundant)) | extend Compliance = iff(zoneRedundancy == 'true', true, false)",
            "service": "Container Apps",
            "services": [],
            "severity": "High",
            "subcategory": "High Availability",
            "text": "Leverage Availability Zones if regionally applicable",
            "waf": "Reliability"
        },
        {
            "category": "BC and DR",
            "checklist": "Container Apps Review",
            "guid": "95bc80ec-6499-4d14-a7d2-7d296b1d8abc",
            "link": "https://learn.microsoft.com/azure/reliability/reliability-azure-container-apps?tabs=azure-cli#set-up-zone-redundancy-in-your-container-apps-environment",
            "query": "resources | where type =~ 'Microsoft.App/containerApps' | project name, resourceGroup, location, minReplicas = toint(properties.template.scale.minReplicas), maxReplicas = toint(properties.template.scale.maxReplicas) | extend Compliance = iff(minReplicas >= 1, true, false)",
            "service": "Container Apps",
            "services": [],
            "severity": "High",
            "subcategory": "High Availability",
            "text": "Use more than one replica and enable Zone Redundancy.",
            "waf": "Reliability"
        },
        {
            "category": "BC and DR",
            "checklist": "Container Apps Review",
            "guid": "ccaa4fc2-fdbc-4432-8bb7-f7e6469e4dc3",
            "link": "https://learn.microsoft.com/azure/reliability/reliability-azure-container-apps?tabs=azure-cli#cross-region-disaster-recovery-and-business-continuity",
            "service": "Container Apps",
            "services": [],
            "severity": "High",
            "subcategory": "High Availability",
            "text": "For cross-region DR, deploy container apps in multiple regions and follow active/active or active/passive application guidance.",
            "waf": "Reliability"
        },
        {
            "category": "BC and DR",
            "checklist": "Container Apps Review",
            "guid": "2ffada86-c031-4933-bf7d-0c45bc4e5919",
            "link": "https://learn.microsoft.com/azure/reliability/reliability-azure-container-apps?tabs=azure-cli#cross-region-disaster-recovery-and-business-continuity",
            "service": "Container Apps",
            "services": [
                "FrontDoor",
                "TrafficManager"
            ],
            "severity": "High",
            "subcategory": "High Availability",
            "text": "Use Front Door or Traffic Manager to route traffic to the closest region",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Identity Review Checklist",
            "guid": "bb235c70-5e17-496f-bedf-a8a4c8cdec4c",
            "link": "https://learn.microsoft.com/entra/identity-platform/msal-acquire-cache-tokens",
            "service": "Entra",
            "services": [
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Entra ID",
            "text": "Use long-live revocable token, cache your token and acquire your silently using Microsoft Identity Library",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Identity Review Checklist",
            "guid": "503547c1-447e-4c66-828a-71f0f1ce16dd",
            "link": "https://learn.microsoft.com/azure/active-directory-b2c/deploy-custom-policies-devops",
            "service": "AAD B2C",
            "services": [
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "AAD B2C",
            "text": "Make sure that your sign-in user flows are backed up and resilient. Make sure that the code that you use to sign-in your users are backed up and recoverable. Resilient interfaces with external processes",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Identity Review Checklist",
            "guid": "3e3553a4-c873-4964-ab66-2d6c15f51296",
            "link": "https://learn.microsoft.com/entra/architecture/resilient-end-user-experience#use-a-content-delivery-network",
            "service": "AAD B2C",
            "services": [
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "AAD B2C",
            "text": "Custom brand assets should be hosted on a CDN",
            "waf": "Performance"
        },
        {
            "category": "Operations Management",
            "checklist": "Identity Review Checklist",
            "guid": "5398e6df-d237-4de1-93b1-6c21d79a9b64",
            "link": "https://learn.microsoft.com/entra/identity/monitoring-health/reference-sla-performance",
            "service": "AAD B2C",
            "services": [
                "Entra"
            ],
            "severity": "Low",
            "subcategory": "AAD B2C",
            "text": "Have multiple identiy providers (i.e., login with your microsoft, google, facebook accounts)",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Identity Review Checklist",
            "guid": "604489a8-f42d-478e-98c0-7a73b22a4a57",
            "link": "https://azure.microsoft.com/blog/setting-up-active-directory-for-a-disaster-recovery-environment-2/",
            "service": "Windows AD",
            "services": [
                "Entra",
                "VM"
            ],
            "severity": "Medium",
            "subcategory": "Windows Server AD",
            "text": "Follow VM rules for high availability on the VM level (premium disks, two or more in a region, in different availability zones)",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Identity Review Checklist",
            "guid": "e7a8dd4a-30e3-47c3-b297-11b2362ceee0",
            "link": "https://azure.microsoft.com/blog/setting-up-active-directory-for-a-disaster-recovery-environment-2/",
            "service": "Windows AD",
            "services": [
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Windows Server AD",
            "text": "Don't replicate! Replication can create issues with directory synchronization",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Identity Review Checklist",
            "guid": "79b598de-fc59-472c-b4cd-21b078036f5e",
            "link": "https://azure.microsoft.com/blog/setting-up-active-directory-for-a-disaster-recovery-environment-2/",
            "service": "Windows AD",
            "services": [
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Windows Server AD",
            "text": "Have active-active for multi-regions",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Identity Review Checklist",
            "guid": "6b4bfd3d-5035-447c-8447-ec66128a71f0",
            "link": "https://learn.microsoft.com/entra/identity/domain-services/tutorial-perform-disaster-recovery-drill",
            "service": "Entra",
            "services": [
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Entra Domain Services",
            "text": "Add Azure AD Domain service stamps to additional regions and locations",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Identity Review Checklist",
            "guid": "f1ce16dd-3f1d-45e8-92e4-2e3611cc58b4",
            "link": "https://learn.microsoft.com/entra/identity/domain-services/tutorial-perform-disaster-recovery-drill",
            "service": "Entra",
            "services": [
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Entra Domain Services",
            "text": "Use Replica Sets for DR",
            "waf": "Reliability"
        },
        {
            "category": "Identity",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "32e42e36-11c8-418b-8a0b-c510e43a18a9",
            "service": "AVS",
            "services": [
                "AVS",
                "Entra",
                "Subscriptions"
            ],
            "severity": "High",
            "subcategory": "Identity",
            "text": "Ensure ADDS domain controller(s) are deployed in the identity subscription in native Azure",
            "waf": "Security"
        },
        {
            "category": "Identity",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "75089c20-990d-4927-b105-885576f76fc2",
            "service": "AVS",
            "services": [
                "AVS",
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Identity",
            "text": "Ensure ADDS sites and services is configured to keep authentication requests from Azure-based resources (including Azure VMware Solution) local to Azure",
            "waf": "Security"
        },
        {
            "category": "Identity",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "de3aad1e-7c28-4ec9-9666-b7570449aa80",
            "service": "AVS",
            "services": [
                "AVS",
                "Entra"
            ],
            "severity": "High",
            "subcategory": "Identity",
            "text": "Ensure that vCenter is connected to ADDS to enable authentication based on 'named user accounts'",
            "waf": "Security"
        },
        {
            "category": "Identity",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "cd289ced-6b17-4db8-8554-61e2aee3553a",
            "service": "AVS",
            "services": [
                "AVS",
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Identity",
            "text": "Ensure that the connection from vCenter to ADDS is using a secure protocol (LDAPS)",
            "waf": "Security"
        },
        {
            "category": "Identity",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "b9d37dac-43bc-46cd-8d79-a9b24604489a",
            "service": "AVS",
            "services": [
                "AVS",
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Identity",
            "text": "CloudAdmin account in vCenter IdP is used only as an emergency account (break-glass)",
            "waf": "Security"
        },
        {
            "category": "Identity",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "53d88e89-d17b-473b-82a5-a67e7a9ed5b3",
            "service": "AVS",
            "services": [
                "AVS",
                "Entra"
            ],
            "severity": "High",
            "subcategory": "Identity",
            "text": "Ensure that NSX-Manager is integrated with an external Identity provider (LDAPS)",
            "waf": "Security"
        },
        {
            "category": "Identity",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "ae0e37ce-e297-411b-b352-caaab79b198d",
            "service": "AVS",
            "services": [
                "AVS",
                "RBAC",
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Identity",
            "text": "Has an RBAC model been created for use within VMware vSphere",
            "waf": "Security"
        },
        {
            "category": "Identity",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "ab81932c-9fc9-4d1b-a780-36f5e6bfbb9e",
            "service": "AVS",
            "services": [
                "AVS",
                "RBAC",
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Identity",
            "text": "RBAC permissions should be granted on ADDS groups and not on specific users",
            "waf": "Security"
        },
        {
            "category": "Identity",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "d503547c-c447-4e82-9128-a71f0f1cac6d",
            "service": "AVS",
            "services": [
                "AVS",
                "RBAC",
                "Entra"
            ],
            "severity": "High",
            "subcategory": "Identity",
            "text": "RBAC permissions on the Azure VMware Solution resource in Azure are 'locked down' to a limited set of owners only",
            "waf": "Security"
        },
        {
            "category": "Identity",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "fd9f0df4-68dc-4976-b9a9-e6a79f7682c5",
            "service": "AVS",
            "services": [
                "AVS",
                "RBAC",
                "Entra"
            ],
            "severity": "High",
            "subcategory": "Identity",
            "text": "Ensure all custom roles are scoped with CloudAdmin permitted authorizations",
            "waf": "Security"
        },
        {
            "category": "Networking",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "9ef1d5e8-32e4-42e3-911c-818b0a0bc510",
            "link": "https://github.com/Azure/AzureCAT-AVS/tree/main/networking",
            "service": "AVS",
            "services": [
                "AVS"
            ],
            "severity": "High",
            "subcategory": "Architecture",
            "text": "Is the correct Azure VMware Solution connectivity model selected for the customer use case at hand",
            "waf": "Performance"
        },
        {
            "category": "Networking",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "eb710a37-cbc1-4055-8dd5-a936a8bb7cf5",
            "service": "AVS",
            "services": [
                "ExpressRoute",
                "VPN",
                "AVS",
                "NetworkWatcher",
                "Monitor"
            ],
            "severity": "High",
            "subcategory": "Monitoring",
            "text": "Ensure ExpressRoute or VPN connections from on-premises to Azure are monitored using 'connection monitor'",
            "waf": "Operations"
        },
        {
            "category": "Networking",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "976e24f2-a7f8-426c-9253-2a92a2a7ed99",
            "service": "AVS",
            "services": [
                "ExpressRoute",
                "NetworkWatcher",
                "AVS",
                "Monitor",
                "VM"
            ],
            "severity": "Medium",
            "subcategory": "Monitoring",
            "text": "Ensure a connection monitor is created from an Azure native resource to an Azure VMware Solution virtual machine to monitor the Azure VMware Solution back-end ExpressRoute connection",
            "waf": "Operations"
        },
        {
            "category": "Networking",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "f41ce6a0-64f3-4805-bc65-3ab50df01265",
            "service": "AVS",
            "services": [
                "AVS",
                "Monitor",
                "VM",
                "NetworkWatcher"
            ],
            "severity": "Medium",
            "subcategory": "Monitoring",
            "text": "Ensure a connection monitor is created from an on-premises resource to an Azure VMware Solution virtual machine to monitor end-2-end connectivity",
            "waf": "Operations"
        },
        {
            "category": "Networking",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "563b4dc7-4a74-48b6-933a-d1a0916a6649",
            "service": "AVS",
            "services": [
                "AVS",
                "ARS"
            ],
            "severity": "High",
            "subcategory": "Routing",
            "text": "When route server is used, ensure no more then 1000 routes are propagated from route server to ExR gateway to on-premises (ARS limit).",
            "waf": "Operations"
        },
        {
            "category": "Governance",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "6128a71f-0f1c-4ac6-b9ef-1d5e832e42e3",
            "service": "AVS",
            "services": [
                "AVS",
                "Entra",
                "RBAC"
            ],
            "severity": "High",
            "subcategory": "Security (identity)",
            "text": "Is Privileged Identity Management implemented for roles managing the Azure VMware Solution resource in the Azure Portal (no standing permissions allowed)",
            "waf": "Security"
        },
        {
            "category": "Governance",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "c4e2436b-b336-4d71-9f17-960eee0b9b5c",
            "service": "AVS",
            "services": [
                "AVS",
                "Entra",
                "RBAC"
            ],
            "severity": "High",
            "subcategory": "Security (identity)",
            "text": "Privileged Identity Management audit reporting should be implemented for the Azure VMware Solution PIM roles",
            "waf": "Security"
        },
        {
            "category": "Governance",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "78c447a8-26b2-4863-af0f-1cac599ef1d5",
            "service": "AVS",
            "services": [
                "AVS",
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Security (identity)",
            "text": "If using Privileged Identity Management is being used, ensure that a valid Entra ID enabled account is created with a valid SMTP record for Azure VMware Solution Automatic Host replacement notifications. (standing permissions required)",
            "waf": "Security"
        },
        {
            "category": "Governance",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "8defc4d7-21d3-41d2-90fb-707ae9eab40e",
            "service": "AVS",
            "services": [
                "AVS",
                "Entra"
            ],
            "severity": "High",
            "subcategory": "Security (identity)",
            "text": "Limit use of CloudAdmin account to emergency access only",
            "waf": "Security"
        },
        {
            "category": "Governance",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "d329f798-bc17-48bd-a5a0-6ca7144351d1",
            "service": "AVS",
            "services": [
                "AVS",
                "RBAC",
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Security (identity)",
            "text": "Create custom RBAC roles in vCenter to implement a least-privilege model inside vCenter",
            "waf": "Security"
        },
        {
            "category": "Governance",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "9dd24429-eb72-4281-97a1-51c5bb4e4f18",
            "service": "AVS",
            "services": [
                "AVS",
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Security (identity)",
            "text": "Is a process defined to regularly rotate cloudadmin (vCenter) and admin (NSX) credentials",
            "waf": "Security"
        },
        {
            "category": "Governance",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "586cb291-ec16-4a1d-876e-f9f141acdce5",
            "service": "AVS",
            "services": [
                "AVS",
                "Entra",
                "VM"
            ],
            "severity": "High",
            "subcategory": "Security (identity)",
            "text": "Use a centralized identity provider to be used for workloads (VM's) running on Azure VMware Solution",
            "waf": "Security"
        },
        {
            "category": "Governance",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "79377bcd-b375-41ab-8ab0-ead66e15d3d4",
            "service": "AVS",
            "services": [
                "AVS"
            ],
            "severity": "Medium",
            "subcategory": "Security (network)",
            "text": "Is East-West traffic filtering implemented within NSX-T",
            "waf": "Security"
        },
        {
            "category": "Governance",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "a2adb1c3-d232-46af-825c-a44e1695fddd",
            "service": "AVS",
            "services": [
                "AVS",
                "AppGW",
                "Firewall"
            ],
            "severity": "High",
            "subcategory": "Security (network)",
            "text": "Workloads on Azure VMware Solution are not directly exposed to the internet. Traffic is filtered and inspected by Azure Application Gateway, Azure Firewall or 3rd party solutions",
            "waf": "Security"
        },
        {
            "category": "Governance",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "eace4cb1-deb4-4c65-8c3f-c14eeab36938",
            "service": "AVS",
            "services": [
                "AVS"
            ],
            "severity": "High",
            "subcategory": "Security (network)",
            "text": "Auditing and logging is implemented for inbound internet requests to Azure VMware Solution and Azure VMware Solution based workloads",
            "waf": "Security"
        },
        {
            "category": "Governance",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "29e3eec2-1836-487a-8077-a2b5945bda43",
            "service": "AVS",
            "services": [
                "AVS",
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Security (network)",
            "text": "Session monitoring is implemented for outbound internet connections from Azure VMware Solution or Azure VMware Solution based workloads to identify suspicious/malicious activity",
            "waf": "Security"
        },
        {
            "category": "Governance",
            "checklist": "Azure VMware Solution Design Review",
            "graph": "resources| where type =~ 'Microsoft.Network/virtualNetworkGateways'| mv-expand ipConfigurations=properties.ipConfigurations| project subnetId=tostring(ipConfigurations.properties.subnet.id)| where isnotempty(subnetId)| join (resources | where type=='microsoft.network/virtualnetworks' | project id,resourceGroup,name,enableDdosProtection=tostring(properties.enableDdosProtection),subnets=properties.subnets | mv-expand subnets | project id,resourceGroup,name,enableDdosProtection,subnetId=tostring(subnets.id)) on subnetId | distinct id,resourceGroup,name,enableDdosProtection | project id, compliant = (enableDdosProtection == 'true')",
            "guid": "334fdf91-c234-4182-a652-75269440b4be",
            "service": "AVS",
            "services": [
                "ExpressRoute",
                "VNet",
                "VPN",
                "DDoS",
                "AVS"
            ],
            "severity": "Medium",
            "subcategory": "Security (network)",
            "text": "Is DDoS standard protection enabled on ExR/VPN Gateway subnet in Azure",
            "waf": "Security"
        },
        {
            "category": "Governance",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "3d3e0843-276d-44bd-a015-bcf219e4a1eb",
            "service": "AVS",
            "services": [
                "AVS"
            ],
            "severity": "Medium",
            "subcategory": "Security (network)",
            "text": "Use a dedicated privileged access workstation (PAW) to manage Azure VMware Solution, vCenter, NSX manager and HCX manager",
            "waf": "Security"
        },
        {
            "category": "Governance",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "9ccbd869-266a-4cca-874f-aa19bf39d95d",
            "service": "AVS",
            "services": [
                "AVS",
                "Defender"
            ],
            "severity": "Medium",
            "subcategory": "Security (guest/VM)",
            "text": "Enable Advanced Threat Detection (Microsoft Defender for Cloud aka ASC) for workloads running on Azure VMware Solution",
            "waf": "Security"
        },
        {
            "category": "Governance",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "44c7c891-9ca1-4f6d-9315-ae524ba34d45",
            "service": "AVS",
            "services": [
                "AVS",
                "Arc"
            ],
            "severity": "Medium",
            "subcategory": "Security (guest/VM)",
            "text": "Use Azure ARC for Servers to properly govern workloads running on Azure VMware Solution using Azure native technologies (Azure ARC for Azure VMware Solution is not yet available)",
            "waf": "Security"
        },
        {
            "category": "Governance",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "85e12139-bd7b-4b01-8f7b-95ef6e043e2a",
            "service": "AVS",
            "services": [
                "AVS",
                "SQL"
            ],
            "severity": "Low",
            "subcategory": "Security (guest/VM)",
            "text": "Ensure workloads on Azure VMware Solution use sufficient data encryption during run-time (like in-guest disk encryption and SQL TDE). (vSAN encryption at rest is default)",
            "waf": "Security"
        },
        {
            "category": "Governance",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "a3592718-e6e2-4051-9267-6ae46691e883",
            "service": "AVS",
            "services": [
                "AVS",
                "AKV"
            ],
            "severity": "Low",
            "subcategory": "Security (guest/VM)",
            "text": "When in-guest encryption is used, store encryption keys in Azure Key vault when possible",
            "waf": "Security"
        },
        {
            "category": "Governance",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "5ac94222-3e13-4810-9230-81a941741583",
            "service": "AVS",
            "services": [
                "AVS"
            ],
            "severity": "Medium",
            "subcategory": "Security (guest/VM)",
            "text": "Consider using extended security update support for workloads running on Azure VMware Solution (Azure VMware Solution is eligible for ESU)",
            "waf": "Security"
        },
        {
            "category": "Governance",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "3ef7ad7c-6d37-4331-95c7-acbe44bbe609",
            "service": "AVS",
            "services": [
                "AVS"
            ],
            "severity": "High",
            "subcategory": "Governance (platform)",
            "text": "Ensure that the appropriate vSAN Data redundancy method is used (RAID specification)",
            "waf": "Reliability"
        },
        {
            "category": "Governance",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "d88408f3-7273-44c8-96ba-280214590146",
            "service": "AVS",
            "services": [
                "AVS",
                "AzurePolicy",
                "Storage"
            ],
            "severity": "High",
            "subcategory": "Governance (platform)",
            "text": "Ensure that the Failure-to-tolerate policy is in place to meet your vSAN storage needs",
            "waf": "Reliability"
        },
        {
            "category": "Governance",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "d89f2e87-7784-424d-9167-85c6fa95b96a",
            "service": "AVS",
            "services": [
                "AVS",
                "ASR"
            ],
            "severity": "High",
            "subcategory": "Governance (platform)",
            "text": "Ensure that you have requested enough quota, ensuring you have considered growth and Disaster Recovery requirement",
            "waf": "Reliability"
        },
        {
            "category": "Governance",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "5d38e53f-9ccb-4d86-a266-acca274faa19",
            "service": "AVS",
            "services": [
                "AVS"
            ],
            "severity": "Medium",
            "subcategory": "Governance (platform)",
            "text": "Ensure that access constraints to ESXi are understood, there are access limits which might affect 3rd party solutions.",
            "waf": "Operations"
        },
        {
            "category": "Governance",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "bf39d95d-44c7-4c89-89ca-1f6d5315ae52",
            "service": "AVS",
            "services": [
                "AVS",
                "AzurePolicy"
            ],
            "severity": "Medium",
            "subcategory": "Governance (platform)",
            "text": "Ensure that you have a policy around ESXi host density and efficiency, keeping in mind the lead time for requesting new nodes",
            "waf": "Operations"
        },
        {
            "category": "Governance",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "4ba34d45-85e1-4213-abd7-bb012f7b95ef",
            "service": "AVS",
            "services": [
                "AVS",
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Governance (platform)",
            "text": "Ensure a good cost management process is in place for Azure VMware Solution - Azure Cost Management can be used",
            "waf": "Cost"
        },
        {
            "category": "Governance",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "6e043e2a-a359-4271-ae6e-205172676ae4",
            "service": "AVS",
            "services": [
                "AVS",
                "Cost"
            ],
            "severity": "Low",
            "subcategory": "Governance (platform)",
            "text": "Are Azure reserved instances used to optimize cost for using Azure VMware Solution",
            "waf": "Cost"
        },
        {
            "category": "Governance",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "6691e883-5ac9-4422-83e1-3810523081a9",
            "service": "AVS",
            "services": [
                "AVS"
            ],
            "severity": "Medium",
            "subcategory": "Governance (platform)",
            "text": "Consider the use of Azure Private-Link when using other Azure Native Services",
            "waf": "Security"
        },
        {
            "category": "Governance",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "db611712-6904-40b4-aa3d-3e0803276d4b",
            "service": "AVS",
            "services": [
                "AVS"
            ],
            "severity": "High",
            "subcategory": "Governance (platform)",
            "text": "Ensure all required resource reside within the same Azure availability zone(s)",
            "waf": "Performance"
        },
        {
            "category": "Governance",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "48b262d6-cc5f-4512-a253-98e6db9d37da",
            "service": "AVS",
            "services": [
                "AVS",
                "VM",
                "Defender"
            ],
            "severity": "Medium",
            "subcategory": "Governance (guest/VM)",
            "text": "Enable Microsoft Defender for Cloud for Azure VMware Solution guest VM workloads",
            "waf": "Security"
        },
        {
            "category": "Governance",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "41741583-3ef7-4ad7-a6d3-733165c7acbe",
            "service": "AVS",
            "services": [
                "AVS",
                "VM",
                "Arc"
            ],
            "severity": "Medium",
            "subcategory": "Governance (guest/VM)",
            "text": "Use Azure Arc enabled servers to manage your Azure VMware Solution guest VM workloads",
            "waf": "Security"
        },
        {
            "category": "Governance",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "88f03a4d-2cd4-463c-abbc-868295abc91a",
            "service": "AVS",
            "services": [
                "AVS"
            ],
            "severity": "High",
            "subcategory": "Governance (guest/VM)",
            "text": "Enable Diagnostic and metric logging on Azure VMware Solution",
            "waf": "Operations"
        },
        {
            "category": "Governance",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "4ed90dae-2cc8-44c4-9b6b-781cbafe6c46",
            "service": "AVS",
            "services": [
                "AVS",
                "Monitor",
                "VM"
            ],
            "severity": "Medium",
            "subcategory": "Governance (guest/VM)",
            "text": "Deploy the Log Analytics Agents to Azure VMware Solution guest VM workloads",
            "waf": "Operations"
        },
        {
            "category": "Governance",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "589d457a-927c-4397-9d11-02cad6aae11e",
            "service": "AVS",
            "services": [
                "AVS",
                "AzurePolicy",
                "VM",
                "Backup"
            ],
            "severity": "Medium",
            "subcategory": "Governance (guest/VM)",
            "text": "Ensure you have a documented and implemented backup policy and solution for Azure VMware Solution VM workloads",
            "waf": "Operations"
        },
        {
            "category": "Governance",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "ee29711b-d352-4caa-ab79-b198dab81932",
            "service": "AVS",
            "services": [
                "AVS",
                "Monitor",
                "Defender"
            ],
            "severity": "Medium",
            "subcategory": "Compliance",
            "text": "Use Microsoft Defender for Cloud for compliance monitoring of workloads running on Azure VMware Solution",
            "waf": "Security"
        },
        {
            "category": "Governance",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "c9fc9d1b-b780-436f-9e6b-fbb9ed503547",
            "service": "AVS",
            "services": [
                "AVS",
                "Defender"
            ],
            "severity": "Medium",
            "subcategory": "Compliance",
            "text": "Are the applicable compliance baselines added to Microsoft Defender for Cloud",
            "waf": "Security"
        },
        {
            "category": "Governance",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "cc447e82-6128-4a71-b0f1-cac6d9ef1d5e",
            "service": "AVS",
            "services": [
                "AVS"
            ],
            "severity": "High",
            "subcategory": "Compliance",
            "text": "Was data residency evaluated when selecting Azure regions to use for Azure VMware Solution deployment",
            "waf": "Security"
        },
        {
            "category": "Governance",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "832e42e3-611c-4818-a0a0-bc510e43a18a",
            "service": "AVS",
            "services": [
                "AVS"
            ],
            "severity": "High",
            "subcategory": "Compliance",
            "text": "Are data processing implications (service provider / service consumer model) clear and documented",
            "waf": "Security"
        },
        {
            "category": "Governance",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "547c1747-dc56-4068-a714-435cd19dd244",
            "service": "AVS",
            "services": [
                "AVS"
            ],
            "severity": "Medium",
            "subcategory": "Compliance",
            "text": "Consider using CMK (Customer Managed Key) for vSAN only if needed for compliance reason(s).",
            "waf": "Security"
        },
        {
            "category": "Management",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "e43a18a9-cd28-49ce-b6b1-7db8255461e2",
            "service": "AVS",
            "services": [
                "AVS",
                "Monitor"
            ],
            "severity": "High",
            "subcategory": "Monitoring",
            "text": "Create dashboards to enable core Azure VMware Solution monitoring insights",
            "waf": "Operations"
        },
        {
            "category": "Management",
            "checklist": "Azure VMware Solution Design Review",
            "graph": "resources| where type =~ 'Microsoft.AVS/privateClouds'| join kind=leftouter(resources| where type =~ 'Microsoft.Insights/metricalerts'| mv-expand scopes=properties.scopes| mv-expand criteria=properties.criteria.allOf| extend metricName=criteria.metricName| distinct tostring(scopes), tostring(metricName))on $left.id == $right.scopes| extend compliant=toint(metricName in ('UsageAverage', 'EffectiveCpuAverage', 'DiskUsedPercentage'))| summarize compliant=min(compliant) by id",
            "guid": "6b84ee5d-f47d-42d9-8881-b1cd5d1e54a2",
            "service": "AVS",
            "services": [
                "AVS",
                "Monitor"
            ],
            "severity": "High",
            "subcategory": "Monitoring",
            "text": "Create warning alerts for critical thresholds for automatic alerting on Azure VMware Solution performance (CPU >80%, Avg Memory >80%, vSAN >70%)",
            "waf": "Operations"
        },
        {
            "category": "Management",
            "checklist": "Azure VMware Solution Design Review",
            "graph": "resources| where type =~ 'Microsoft.AVS/privateClouds'| join kind=leftouter(resources| where type =~ 'Microsoft.Insights/metricalerts'| mv-expand scopes=properties.scopes| mv-expand criteria=properties.criteria.allOf| extend metricName=criteria.metricName| distinct tostring(scopes), tostring(metricName))on $left.id == $right.scopes| extend compliant=toint(metricName in ('UsageAverage', 'EffectiveCpuAverage', 'DiskUsedPercentage'))| summarize compliant=min(compliant) by id",
            "guid": "9659e396-80e7-4828-ac93-5657d02bff45",
            "service": "AVS",
            "services": [
                "AVS",
                "Monitor"
            ],
            "severity": "High",
            "subcategory": "Monitoring",
            "text": "Ensure critical alert is created to monitor if vSAN consumption is below 75% as this is a support threshold from VMware",
            "waf": "Operations"
        },
        {
            "category": "Management",
            "checklist": "Azure VMware Solution Design Review",
            "graph": "resources| distinct subscriptionId| join kind=leftouter(    resources    | where type =~ 'microsoft.insights/activitylogalerts'    | mv-expand condition1 = properties.condition.allOf    | mv-expand condition2 = condition1.anyOf    | extend alertEnabled = tostring(properties.enabled)    | summarize set_condition1=make_set(condition1.equals), set_condition2=make_set(condition2.equals) by id, name,type,tenantId,resourceGroup,subscriptionId, alertEnabled    | where set_has_element(set_condition1, 'ServiceHealth')    | extend category = 'ServiceHealth'    | extend all = iff(set_has_element(set_condition1, 'ServiceHealth') and array_length(set_condition2) == 0, true, false)    | extend incident = iff(all, true, iff(set_has_element(set_condition1, 'Incident'), true, set_has_element(set_condition2, 'Incident')))    | extend maintenance = iff(all, true, iff(set_has_element(set_condition1, 'Maintenance'), true, set_has_element(set_condition2, 'Maintenance')))    | extend informational = iff(all, true, iff(set_has_element(set_condition1, 'Informational') or set_has_element(set_condition1, 'ActionRequired'), true, set_has_element(set_condition2, 'Informational') or set_has_element(set_condition2, 'ActionRequired')))    | extend security = iff(all, true, iff(set_has_element(set_condition1, 'Security'), true, set_has_element(set_condition2, 'Security')))    | project id, name, subscriptionId, category, tostring(alertEnabled), tostring(incident), tostring(maintenance), tostring(informational), tostring(security)    | summarize count_alertEnabled=countif(alertEnabled == 'true'), count_incident=countif(incident == 'True'), count_maintenance=countif(maintenance == 'True'), count_informational=countif(informational == 'True'), count_security=countif(security == 'True') by subscriptionId)     on subscriptionId| project subscriptionId, alertEnabled=iff(isnotnull(count_alertEnabled), count_alertEnabled, 0), incident=iff(isnotnull(count_incident), count_incident, 0), security=iff(isnotnull(count_security), count_security, 0), maintenance=iff(isnotnull(count_maintenance), count_maintenance, 0), informational=iff(isnotnull(count_informational), count_informational, 0)| order by incident, maintenance, informational, security desc| project id=subscriptionId, compliant=(alertEnabled > 0 and incident > 0 and security > 0 and maintenance > 0 and informational > 0)",
            "guid": "64b0d934-a348-4726-be79-d6b5c3a36495",
            "service": "AVS",
            "services": [
                "AVS",
                "Monitor"
            ],
            "severity": "High",
            "subcategory": "Monitoring",
            "text": "Ensure alerts are configured for Azure Service Health alerts and notifications",
            "waf": "Operations"
        },
        {
            "category": "Management",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "b6abad38-aad5-43cc-99e1-d86667357c54",
            "service": "AVS",
            "services": [
                "AVS",
                "Monitor",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Monitoring",
            "text": "Configure Azure VMware Solution logging to be send to an Azure Storage account or Azure EventHub for processing",
            "waf": "Operations"
        },
        {
            "category": "Management",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "9674c5ed-85b8-459c-9733-be2b1a27b775",
            "service": "AVS",
            "services": [
                "AVS",
                "Monitor"
            ],
            "severity": "Low",
            "subcategory": "Monitoring",
            "text": "If deep insight in VMware vSphere is required: Is vRealize Operations and/or vRealize Network Insights used in the solution?",
            "waf": "Operations"
        },
        {
            "category": "Management",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "a91be1f3-88f0-43a4-b2cd-463cbbbc8682",
            "service": "AVS",
            "services": [
                "AVS",
                "AzurePolicy",
                "VM",
                "Storage"
            ],
            "severity": "High",
            "subcategory": "Operations",
            "text": "Ensure the vSAN storage policy for VM's is NOT the default storage policy as this policy applies thick provisioning",
            "waf": "Operations"
        },
        {
            "category": "Management",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "d9ef1d5e-832d-442e-9611-c818b0afbc51",
            "service": "AVS",
            "services": [
                "AVS"
            ],
            "severity": "Medium",
            "subcategory": "Operations",
            "text": "Ensure vSphere content libraries are not placed on vSAN as vSAN is a finite resource",
            "waf": "Operations"
        },
        {
            "category": "Management",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "0e43a18a-9cd2-489b-bd6b-17db8255461e",
            "service": "AVS",
            "services": [
                "AVS",
                "Storage",
                "Backup"
            ],
            "severity": "Medium",
            "subcategory": "Operations",
            "text": "Ensure data repositories for the backup solution are stored outside of vSAN storage. Either in Azure native or on a disk pool-backed datastore",
            "waf": "Operations"
        },
        {
            "category": "Management",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "2aee3453-aec8-4339-848b-262d6cc5f512",
            "service": "AVS",
            "services": [
                "AVS",
                "Arc"
            ],
            "severity": "Medium",
            "subcategory": "Operations",
            "text": "Ensure workloads running on Azure VMware Solution are hybrid managed using Azure Arc for Servers (Arc for Azure VMware Solution is in preview)",
            "waf": "Operations"
        },
        {
            "category": "Management",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "925398e6-da9d-437d-ac43-bc6cd1d79a9b",
            "service": "AVS",
            "services": [
                "AVS",
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Operations",
            "text": "Ensure workloads running on Azure VMware Solution are monitored using Azure Log Analytics and Azure Monitor",
            "waf": "Operations"
        },
        {
            "category": "Management",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "24604489-a8f4-42d7-ae78-cb6a33bd2a09",
            "service": "AVS",
            "services": [
                "AVS"
            ],
            "severity": "Medium",
            "subcategory": "Operations",
            "text": "Include workloads running on Azure VMware Solution in existing update management tooling or in Azure Update Management",
            "waf": "Operations"
        },
        {
            "category": "Management",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "17e7a8d9-0ae0-4e27-aee2-9711bd352caa",
            "service": "AVS",
            "services": [
                "AVS",
                "AzurePolicy",
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Operations",
            "text": "Use Azure Policy to onboard Azure VMware Solution workloads in the Azure Management, Monitoring and Security solutions",
            "waf": "Operations"
        },
        {
            "category": "Management",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "aee3553a-fc83-4392-98b2-62d6cc5f5129",
            "service": "AVS",
            "services": [
                "AVS",
                "Defender"
            ],
            "severity": "Medium",
            "subcategory": "Security",
            "text": "Ensure workloads running on Azure VMware Solution are onboarded to Microsoft Defender for Cloud",
            "waf": "Security"
        },
        {
            "category": "BCDR",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "25398e6d-b9d3-47da-a43b-c6cd1d79a9b2",
            "service": "AVS",
            "services": [
                "AVS",
                "Backup"
            ],
            "severity": "Medium",
            "subcategory": "Backup",
            "text": "Ensure backups are not stored on vSAN as vSAN is a finite resource",
            "waf": "Reliability"
        },
        {
            "category": "BCDR",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "5e6bfbb9-ed50-4354-9cc4-47e826028a71",
            "service": "AVS",
            "services": [
                "AVS",
                "ASR"
            ],
            "severity": "Medium",
            "subcategory": "Disaster Recovery",
            "text": "Have all DR solutions been considered and a solution that is best for your business been decided upon? [SRM/JetStream/Zerto/Veeam/...]",
            "waf": "Reliability"
        },
        {
            "category": "BCDR",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "f0f1cac6-d9ef-41d5-b832-d42e3611c818",
            "service": "AVS",
            "services": [
                "AVS",
                "ASR"
            ],
            "severity": "Medium",
            "subcategory": "Disaster Recovery",
            "text": "Use Azure Site Recovery when the Disaster Recovery technology is native Azure IaaS",
            "waf": "Reliability"
        },
        {
            "category": "BCDR",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "b0afbc51-0e43-4a18-a9cd-289bed6b17db",
            "service": "AVS",
            "services": [
                "AVS",
                "ASR"
            ],
            "severity": "High",
            "subcategory": "Disaster Recovery",
            "text": "Use Automated recovery plans with either of the Disaster solutions, avoid manual tasks as much as possible",
            "waf": "Reliability"
        },
        {
            "category": "BCDR",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "8255461e-2aee-4345-9aec-8339248b262d",
            "service": "AVS",
            "services": [
                "AVS",
                "ASR"
            ],
            "severity": "Medium",
            "subcategory": "Disaster Recovery",
            "text": "Use the geopolitical region pair as the secondary disaster recovery environment",
            "waf": "Reliability"
        },
        {
            "category": "BCDR",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "6cc5f512-9253-498e-9da9-d37dac43bc6c",
            "service": "AVS",
            "services": [
                "AVS",
                "ASR"
            ],
            "severity": "High",
            "subcategory": "Disaster Recovery",
            "text": "Use 2 different address spaces between the regions, for example: 10.0.0.0/16 and 192.168.0.0/16 for the different regions",
            "waf": "Reliability"
        },
        {
            "category": "BCDR",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "d1d79a9b-2460-4448-aa8f-42d78e78cb6a",
            "service": "AVS",
            "services": [
                "AVS",
                "NVA",
                "ExpressRoute",
                "ASR"
            ],
            "severity": "Medium",
            "subcategory": "Disaster Recovery",
            "text": "Will ExpressRoute Global Reach be used for connectivity between the primary and secondary Azure VMware Solution Private Clouds or is routing done through network virtual appliances?",
            "waf": "Reliability"
        },
        {
            "category": "BCDR",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "33bd2a09-17e7-4a8d-a0ae-0e27cee29711",
            "service": "AVS",
            "services": [
                "AVS",
                "Backup"
            ],
            "severity": "Medium",
            "subcategory": "Business Continuity",
            "text": "Have all Backup solutions been considered and a solution that is best for your business been decided upon? [ MABS/CommVault/Metallic.io/Veeam/�. ]",
            "waf": "Reliability"
        },
        {
            "category": "BCDR",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "bd352caa-ab79-4b18-adab-81932c9fc9d1",
            "service": "AVS",
            "services": [
                "AVS",
                "Backup"
            ],
            "severity": "Medium",
            "subcategory": "Business Continuity",
            "text": "Deploy your backup solution in the same region as your Azure VMware Solution private cloud",
            "waf": "Reliability"
        },
        {
            "category": "BCDR",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "bb77036f-5e6b-4fbb-aed5-03547cc447e8",
            "service": "AVS",
            "services": [
                "AVS",
                "Backup"
            ],
            "severity": "Medium",
            "subcategory": "Business Continuity",
            "text": "Deploy your backup solution outside of vSan, on Azure native components",
            "waf": "Reliability"
        },
        {
            "category": "BCDR",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "26028a71-f0f1-4cac-9d9e-f1d5e832d42e",
            "service": "AVS",
            "services": [
                "AVS"
            ],
            "severity": "Low",
            "subcategory": "Business Continuity",
            "text": "Is a process in place to request a restore of the VMware components managed by the Azure Platform?",
            "waf": "Reliability"
        },
        {
            "category": "Platform Automation",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "4604489a-8f42-4d78-b78c-b7a33bd2a0a1",
            "service": "AVS",
            "services": [
                "AVS"
            ],
            "severity": "Low",
            "subcategory": "Deployment strategy",
            "text": "For manual deployments, all configuration and deployments must be documented",
            "waf": "Operations"
        },
        {
            "category": "Platform Automation",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "7e7a8d90-ae0e-437c-be29-711bd352caaa",
            "service": "AVS",
            "services": [
                "AVS"
            ],
            "severity": "Low",
            "subcategory": "Deployment strategy",
            "text": "For manual deployments, consider implementing resource locks to prevent accidental actions on your Azure VMware Solution Private Cloud",
            "waf": "Operations"
        },
        {
            "category": "Platform Automation",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "b79b198d-ab81-4932-a9fc-9d1bb78036f5",
            "service": "AVS",
            "services": [
                "AVS"
            ],
            "severity": "Low",
            "subcategory": "Automated Deployment",
            "text": "For automated deployments, deploy a minimal private cloud and scale as needed",
            "waf": "Operations"
        },
        {
            "category": "Platform Automation",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "e6bfbb9e-d503-4547-ac44-7e826128a71f",
            "service": "AVS",
            "services": [
                "AVS"
            ],
            "severity": "Low",
            "subcategory": "Automated Deployment",
            "text": "For automated deployments,  request or reserve quota prior to starting the deployment",
            "waf": "Operations"
        },
        {
            "category": "Platform Automation",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "0f1cac6d-9ef1-4d5e-a32e-42e3611c818b",
            "service": "AVS",
            "services": [
                "AVS",
                "AzurePolicy"
            ],
            "severity": "Low",
            "subcategory": "Automated Deployment",
            "text": "For automated deployment, ensure that relevant resource locks are created through the automation or through Azure Policy for proper governance",
            "waf": "Operations"
        },
        {
            "category": "Platform Automation",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "e2cc95d4-8c6b-4791-bca0-f6c56589e558",
            "service": "AVS",
            "services": [
                "AVS",
                "AKV"
            ],
            "severity": "Low",
            "subcategory": "Automated Connectivity",
            "text": "Implement human understandable names for ExR authorization keys to allow for easy identification of the keys purpose/use",
            "waf": "Operations"
        },
        {
            "category": "Platform Automation",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "255461e2-aee3-4553-afc8-339248b262d6",
            "service": "AVS",
            "services": [
                "AVS",
                "AKV",
                "ExpressRoute"
            ],
            "severity": "Low",
            "subcategory": "Automated Connectivity",
            "text": "Use Key vault to store secrets and authorization keys when separate Service Principles are used for deploying Azure VMware Solution and ExpressRoute",
            "waf": "Operations"
        },
        {
            "category": "Platform Automation",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "cc5f5129-2539-48e6-bb9d-37dac43bc6cd",
            "service": "AVS",
            "services": [
                "AVS"
            ],
            "severity": "Low",
            "subcategory": "Automated Connectivity",
            "text": "Define resource dependencies for serializing actions in IaC when many resources need to be deployed in/on Azure VMware Solution as Azure VMware Solution only supports a limited number of parallel operations.",
            "waf": "Operations"
        },
        {
            "category": "Platform Automation",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "1d79a9b2-4604-4489-a8f4-2d78e78cb7a3",
            "service": "AVS",
            "services": [
                "AVS"
            ],
            "severity": "Low",
            "subcategory": "Automated Connectivity",
            "text": "When performing automated configuration of NSX-T segments with a single Tier-1 gateway, use Azure Portal APIs instead of NSX-Manager APIs",
            "waf": "Operations"
        },
        {
            "category": "Platform Automation",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "3bd2a0a1-7e7a-48d9-8ae0-e37cee29711b",
            "service": "AVS",
            "services": [
                "AVS",
                "Subscriptions"
            ],
            "severity": "Medium",
            "subcategory": "Automated Scale",
            "text": "When intending to use automated scale-out, be sure to apply for sufficient Azure VMware Solution quota for the subscriptions running Azure VMware Solution",
            "waf": "Performance"
        },
        {
            "category": "Platform Automation",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "d352caaa-b79b-4198-bab8-1932c9fc9d1b",
            "service": "AVS",
            "services": [
                "AVS",
                "AzurePolicy",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Automated Scale",
            "text": "When intending to use automated scale-in, be sure to take storage policy requirements into account before performing such action",
            "waf": "Performance"
        },
        {
            "category": "Platform Automation",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "b78036f5-e6bf-4bb9-bd50-3547cc447e82",
            "service": "AVS",
            "services": [
                "AVS"
            ],
            "severity": "Medium",
            "subcategory": "Automated Scale",
            "text": "Scaling operations always need to be serialized within a single SDDC as only one scale operation can be performed at a time (even when multiple clusters are used)",
            "waf": "Performance"
        },
        {
            "category": "Platform Automation",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "bf15bce2-19e4-4a0e-a588-79424d226786",
            "service": "AVS",
            "services": [
                "AVS"
            ],
            "severity": "Medium",
            "subcategory": "Automated Scale",
            "text": "Consider and validate scaling operations on 3rd party solutions used in the architecture (supported or not)",
            "waf": "Performance"
        },
        {
            "category": "Platform Automation",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "d20b56c5-7be5-4851-a0f8-3835c586cb29",
            "service": "AVS",
            "services": [
                "AVS"
            ],
            "severity": "Medium",
            "subcategory": "Automated Scale",
            "text": "Define and enforce scale in/out maximum limits for your environment in the automations",
            "waf": "Performance"
        },
        {
            "category": "Platform Automation",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "1dc15a1c-075e-4e9f-841a-cccd579376bc",
            "service": "AVS",
            "services": [
                "AVS",
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Automated Scale",
            "text": "Implement monitoring rules to monitor automated scaling operations and monitor success and failure to enable appropriate (automated) responses",
            "waf": "Operations"
        },
        {
            "category": "Migration",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "c5972cd4-cd21-4b07-9036-f5e6b4bfd3d5",
            "link": "https://learn.microsoft.com/azure/active-directory/app-proxy/application-proxy#how-application-proxy-works",
            "service": "AVS",
            "services": [
                "AVS",
                "VM"
            ],
            "severity": "High",
            "subcategory": "Architecture",
            "text": "When using MON, be aware of the limits of simulataneously configured VMs (MON Limit for HCX [400 - standard, 1000 - Larger appliance])",
            "training": "https://learn.microsoft.com/learn/modules/configure-azure-ad-application-proxy/",
            "waf": "Reliability"
        },
        {
            "category": "Migration",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "be1f38cf-03a8-422b-b463-cbbbc8ac299e",
            "link": "https://learn.microsoft.com/azure/active-directory/app-proxy/application-proxy#how-application-proxy-works",
            "service": "AVS",
            "services": [
                "AVS"
            ],
            "severity": "High",
            "subcategory": "Architecture",
            "text": "When using MON, you cannot enable MON on more than 100 Network extensions",
            "training": "https://learn.microsoft.com/learn/paths/implement-applications-external-access-azure-ad/",
            "waf": "Reliability"
        },
        {
            "category": "Migration",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "bc91a43d-90da-4e2c-a881-4706f7c1cbaf",
            "service": "AVS",
            "services": [
                "AVS",
                "VPN"
            ],
            "severity": "Medium",
            "subcategory": "Networking",
            "text": "If using a VPN connection for migrations, adjust your MTU size accordingly.",
            "waf": "Performance"
        },
        {
            "category": "Migration",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "e614658d-d457-4e92-9139-b821102cad6e",
            "service": "AVS",
            "services": [
                "AVS"
            ],
            "severity": "Medium",
            "subcategory": "Networking",
            "text": "For low connectivity regions connecting into Azure (500Mbps or less), considering deploying the HCX WAN optimization appliance",
            "waf": "Performance"
        },
        {
            "category": "Migration",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "ae01e6e8-43e5-42f4-922d-928c1b1cd521",
            "service": "AVS",
            "services": [
                "AVS"
            ],
            "severity": "Medium",
            "subcategory": "Process",
            "text": "Ensure that migrations are started from the on-premises appliance and NOT from the Cloud appliance (do NOT perform a reverse migration)",
            "waf": "Reliability"
        },
        {
            "category": "Data Storage",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "e54a29a9-de39-4ac0-b7c2-8dc935657202",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-policy-settings",
            "service": "AVS",
            "services": [
                "AVS",
                "VM",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Architecture",
            "text": "When Azure Netapp Files is used to extend storage for Azure VMware Solution,consider using this as a VMware datastore instead of attaching directly to a VM.",
            "waf": "Reliability"
        },
        {
            "category": "Data Storage",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "bff4564b-0d93-44a3-98b2-63e7dd60513a",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#avoid-combining-traffic-manager-and-front-door",
            "service": "AVS",
            "services": [
                "AVS",
                "ExpressRoute",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Architecture",
            "text": "Ensure that a dedicated ExpressRoute Gateway is being used for external data storage solutions",
            "waf": "Reliability"
        },
        {
            "category": "Data Storage",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "3649906e-bad3-48ea-b53c-c7de1d8aaab3",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-the-same-domain-name-on-front-door-and-your-origin",
            "service": "AVS",
            "services": [
                "AVS",
                "ExpressRoute",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Architecture",
            "text": "Ensure that FastPath is enabled on the ExpressRoute Gateway that is being used for external data storage solutions",
            "waf": "Reliability"
        },
        {
            "category": "Stretched Cluster",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "571549ab-8153-4d89-b89d-c7b33be2b1a2",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#disable-health-probes-when-theres-only-one-origin-in-an-origin-group",
            "service": "AVS",
            "services": [
                "AVS",
                "ASR"
            ],
            "severity": "High",
            "subcategory": "Architecture",
            "text": "If using stretched cluster, ensure that your selected Disaster Recovery solution is supported by the vendor",
            "waf": "Reliability"
        },
        {
            "category": "Stretched Cluster",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "4c486b6d-8bdc-4059-acf7-5ee8a1309888",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#select-good-health-probe-endpoints",
            "service": "AVS",
            "services": [
                "AVS"
            ],
            "severity": "High",
            "subcategory": "Architecture",
            "text": "If using stretched cluster, ensure that the SLA provided will meet your requirements",
            "waf": "Reliability"
        },
        {
            "category": "Stretched Cluster",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "9579d66b-896d-471f-a6ca-7be9955d04c3",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-head-health-probes",
            "service": "AVS",
            "services": [
                "AVS",
                "ExpressRoute"
            ],
            "severity": "High",
            "subcategory": "Architecture",
            "text": "If using stretched cluster, ensure that both ExpressRoute circuits are connected to your connectivity hub.",
            "waf": "Reliability"
        },
        {
            "category": "Stretched Cluster",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "c49d987c-b3d1-4325-aa12-4b6e4d0685ed",
            "link": "https://learn.microsoft.com/azure/nat-gateway/nat-overview#outbound-connectivity",
            "service": "AVS",
            "services": [
                "AVS",
                "ExpressRoute"
            ],
            "severity": "High",
            "subcategory": "Architecture",
            "text": "If using stretched cluster, ensure that both ExpressRoute circuits have GlobalReach enabled.",
            "waf": "Reliability"
        },
        {
            "category": "Stretched Cluster",
            "checklist": "Azure VMware Solution Design Review",
            "guid": "dce9793b-7bcd-4b3b-91eb-2ec14eea6e59",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-managed-tls-certificates",
            "service": "AVS",
            "services": [
                "AVS"
            ],
            "severity": "High",
            "subcategory": "Architecture",
            "text": "Have site disaster tolerance settings been properly considered and changed for your business if needed.",
            "waf": "Reliability"
        },
        {
            "category": "BC and DR",
            "checklist": "Redis Resiliency checklist",
            "guid": "65285269-440b-44be-9d3e-0844276d4bdc",
            "link": "https://learn.microsoft.com/azure/azure-cache-for-redis/cache-how-to-zone-redundancy",
            "service": "Redis",
            "services": [
                "ACR"
            ],
            "severity": "High",
            "subcategory": "High Availability",
            "text": "Enable zone redundancy for Azure Cache for Redis. Azure Cache for Redis supports zone redundant configurations in the Premium and Enterprise tiers. A zone redundant cache can place its nodes across different Azure Availability Zones in the same region. It eliminates data center or AZ outage as a single point of failure and increases the overall availability of your cache.",
            "waf": "Reliability"
        },
        {
            "category": "BC and DR",
            "checklist": "Redis Resiliency checklist",
            "guid": "bc178bdc-5a06-4ca7-8443-51e19dd34429",
            "link": "https://learn.microsoft.com/en-us/azure/azure-cache-for-redis/cache-high-availability#persistence",
            "service": "Redis",
            "services": [
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "High Availability",
            "text": "Configure data persistence for an Azure Cache for Redis instance. Because your cache data is stored in memory, a rare and unplanned failure of multiple nodes can cause all the data to be dropped. To avoid losing data completely, Redis persistence allows you to take periodic snapshots of in-memory data, and store it to your storage account.",
            "waf": "Reliability"
        },
        {
            "category": "BC and DR",
            "checklist": "Redis Resiliency checklist",
            "guid": "eb722823-7a15-41c5-ab4e-4f1814387e5c",
            "link": "https://learn.microsoft.com/en-us/azure/azure-cache-for-redis/cache-high-availability#storage-account-for-persistence",
            "service": "Redis",
            "services": [
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "High Availability",
            "text": "Use Geo-redundant storage account to persist Azure Cache for Redis data, or zonally redundant where geo-redundancy is not available",
            "waf": "Reliability"
        },
        {
            "category": "BC and DR",
            "checklist": "Redis Resiliency checklist",
            "guid": "a8c26c9b-32ab-45bd-bc69-98a135e33789",
            "link": "https://learn.microsoft.com/azure/azure-cache-for-redis/cache-how-to-geo-replication",
            "service": "Redis",
            "services": [
                "ASR"
            ],
            "severity": "Medium",
            "subcategory": "High Availability",
            "text": "Configure passive geo-replication for Premium Azure Cache for Redis instances. Geo-replication is a mechanism for linking two or more Azure Cache for Redis instances, typically spanning two Azure regions. Geo-replication is designed mainly for cross-region disaster recovery. Two Premium tier cache instances are connected through geo-replication in a way that provides reads and writes to your primary cache, and that data is replicated to the secondary cache.",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Azure Data Factory Review Checklist",
            "guid": "ab91932c-9fc9-4d1b-a881-37f5e6c0cb9e",
            "link": "https://github.com/Azure/fta-resiliencyplaybooks/blob/main/paas-foundations-playbooks-ADF_v1.docx",
            "service": "Azure Data Factory",
            "services": [],
            "severity": "Medium",
            "subcategory": "Best Practices",
            "text": "Leverage FTA Resiliency Playbook for Azure Data Factory",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Azure Data Factory Review Checklist",
            "guid": "e503547c-d447-4e82-9138-a7200f1cac6d",
            "link": "https://learn.microsoft.com/azure/architecture/example-scenario/analytics/pipelines-disaster-recovery",
            "service": "Azure Data Factory",
            "services": [],
            "severity": "High",
            "subcategory": "Availablity Zone",
            "text": "Use zone redundant pipelines in regions that support Availability Zones",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Azure Data Factory Review Checklist",
            "guid": "9ef1d6e8-32e5-42e3-911c-818b1a0bc511",
            "link": "https://learn.microsoft.com/azure/data-factory/source-control",
            "service": "Azure Data Factory",
            "services": [
                "Backup"
            ],
            "severity": "Medium",
            "subcategory": "DevOps Integration",
            "text": "Use DevOps to Backup the ARM templates with Github/Azure DevOps integration ",
            "waf": "Reliability"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Data Factory Review Checklist",
            "guid": "e43a18a9-cd29-49cf-b7b1-7db8255562f2",
            "link": "https://learn.microsoft.com/azure/architecture/example-scenario/analytics/pipelines-disaster-recovery",
            "service": "Azure Data Factory",
            "services": [
                "VM"
            ],
            "severity": "Medium",
            "subcategory": "Network",
            "text": "Make sure you replicate the Self-Hosted Integration Runtime VMs in another region ",
            "waf": "Reliability"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Data Factory Review Checklist",
            "guid": "aee4563a-fd83-4393-98b2-62d6dc5f512a",
            "link": "https://learn.microsoft.com/azure/architecture/example-scenario/analytics/pipelines-disaster-recovery",
            "service": "Azure Data Factory",
            "services": [
                "VNet"
            ],
            "severity": "Medium",
            "subcategory": "Network",
            "text": "Make sure you replicate or duplicate your network in the sister region. You have to make a copy of your Vnet in another region",
            "waf": "Reliability"
        },
        {
            "category": "Governance and Security",
            "checklist": "Azure Data Factory Review Checklist",
            "description": "If your ADF Pipelines use Key Vault you don't have to do anything to replicate Key Vault. Key Vault is a managed service and Microsoft takes care of it for you",
            "guid": "25498f6d-bad3-47da-a43b-c6ce1d7aa9b2",
            "link": "https://learn.microsoft.com/azure/key-vault/general/disaster-recovery-guidance",
            "service": "Azure Data Factory",
            "services": [
                "AKV"
            ],
            "severity": "Low",
            "subcategory": "Integration",
            "text": "If using Keyvault integration, use SLA of Keyvault to understand your availablity",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Service Bus Review Checklist",
            "guid": "974a759c-763e-47d2-9161-3a7649907e0e",
            "link": "https://github.com/Azure/fta-resiliencyplaybooks/blob/main/paas-foundations-playbooks-ASB_v1.docx",
            "services": [
                "ServiceBus"
            ],
            "severity": "Medium",
            "subcategory": "Best Practices",
            "text": "Leverage FTA Handbook.",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Service Bus Review Checklist",
            "guid": "49907e0e-338e-4e25-9c17-d32e8aaab757",
            "link": "https://learn.microsoft.com/azure/well-architected/service-guides/service-bus/operational-excellence",
            "services": [
                "ServiceBus"
            ],
            "severity": "Medium",
            "subcategory": "Best Practices",
            "text": "Implement geo-replication on the sender and receiver side to protect against outages and disasters",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Service Bus Review Checklist",
            "guid": "1549ab81-53d8-49f8-ad17-b84b33b5a67f",
            "link": "https://learn.microsoft.com/azure/well-architected/service-guides/service-bus/reliability#checklist",
            "services": [
                "ServiceBus",
                "Storage",
                "ASR"
            ],
            "severity": "Medium",
            "subcategory": "Best Practices",
            "text": "If you need mission-critical messaging with queues and topics, Service Bus Premium is recommended with Geo-Disaster Recovery.",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Service Bus Review Checklist",
            "guid": "7b9ed5b3-1f38-4c40-9a82-2c2463cf0f18",
            "link": "https://learn.microsoft.com/azure/well-architected/service-guides/service-bus/reliability#checklist",
            "services": [
                "ServiceBus"
            ],
            "severity": "Medium",
            "subcategory": "Best Practices",
            "text": "Implement high availability for the Service Bus namespace",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Service Bus Review Checklist",
            "guid": "ac699ef1-d5a8-43de-9de3-2c1881470607",
            "link": "https://learn.microsoft.com/azure/well-architected/service-guides/service-bus/reliability#checklist",
            "services": [
                "ServiceBus"
            ],
            "severity": "High",
            "subcategory": "Best Practices",
            "text": "Ensure related messages are delivered in guaranteed order",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Service Bus Review Checklist",
            "guid": "c5c0e4e6-1465-48d2-958e-d67139b82110",
            "link": "https://learn.microsoft.com/azure/well-architected/service-guides/service-bus/reliability#checklist",
            "services": [
                "ServiceBus"
            ],
            "severity": "Low",
            "subcategory": "Best Practices",
            "text": "Evaluate different Java Messaging Service (JMS) features through the JMS API",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Service Bus Review Checklist",
            "guid": "2df26ee4-11e6-4f88-9e52-f4722dd68c5b",
            "link": "https://learn.microsoft.com/azure/well-architected/service-guides/service-bus/reliability#checklist",
            "services": [
                "ServiceBus"
            ],
            "severity": "Low",
            "subcategory": "Best Practices",
            "text": "Use .NET Nuget packages to communicate with Service Bus messaging entities",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Service Bus Review Checklist",
            "guid": "5c2521e5-4a69-4b9d-939a-c4e7c68d1d75",
            "link": "https://learn.microsoft.com/azure/well-architected/service-guides/service-bus/reliability#checklist",
            "services": [
                "ServiceBus"
            ],
            "severity": "Medium",
            "subcategory": "Best Practices",
            "text": "Implement resilience for transient fault handling when sending or receiving messages",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Service Bus Review Checklist",
            "description": "This will be turned on automatically for a new SB namespace created from the portal with the Premium SKUs in a zone-enabled region. Both the Service Bus metadata and the messages data are replicated across datacenters in the availability zones configuration",
            "guid": "338ee253-c17d-432e-aaaa-b7571549ab81",
            "link": "https://learn.microsoft.com/azure/service-bus-messaging/service-bus-outages-disasters#availability-zones",
            "services": [
                "ServiceBus",
                "ACR"
            ],
            "severity": "High",
            "subcategory": "Best Practices",
            "text": "Leverage Availability Zones if regionally applicable",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Service Bus Review Checklist",
            "description": "If enabled, Implements namespace metadata replication to a secondary region. Does not replicate queue/topic message data. Premium sku only.",
            "guid": "53d89f89-d17b-484b-93b5-a67f7b9ed5b3",
            "link": "https://learn.microsoft.com/azure/service-bus-messaging/service-bus-outages-disasters#geo-disaster-recovery",
            "services": [
                "ServiceBus",
                "Storage",
                "ASR"
            ],
            "severity": "Medium",
            "subcategory": "Geo-Disaster Recovery",
            "text": "Plan for Metadata replication during regional failure",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Service Bus Review Checklist",
            "description": "If an outage cannot be tolerated, do not use the build-in metadata replication option. Leverage a replication pattern to replicate Service Bus messages across two or more sets of cross-region namespaces",
            "guid": "1f38c403-a822-4c24-93cf-0f18ac699ef1",
            "link": "https://learn.microsoft.com/azure/service-bus-messaging/service-bus-federation-overview",
            "services": [
                "ServiceBus",
                "ACR",
                "ASR"
            ],
            "severity": "Medium",
            "subcategory": "Geo-Disaster Recovery",
            "text": "Plan for Message replication during regional failure",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Service Bus Review Checklist",
            "description": "Azure Service Bus uses a message broker to handle messages that are sent to a Service Bus queue or topic. By default, all messages that are sent to a queue or topic are handled by the same message broker process. This architecture can place a limitation on the overall throughput of the message queue. However, you can also partition a queue or topic when it is created",
            "guid": "d5a83de4-de32-4c18-a147-0607c5c0e4e6",
            "link": "https://learn.microsoft.com/azure/architecture/best-practices/data-partitioning-strategies#partitioning-azure-service-bus",
            "services": [
                "ServiceBus",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Best Practices",
            "text": "For applications which require high throughput, use Patritioning ",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Service Bus Review Checklist",
            "guid": "14658d24-58ed-4671-99b8-21102df26ee4",
            "link": "https://learn.microsoft.com/azure/service-bus-messaging/service-bus-outages-disasters",
            "services": [
                "ServiceBus"
            ],
            "severity": "Medium",
            "subcategory": "Best Practices",
            "text": "Evaluate Premier-tier benefits of Azure Service Bus",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Service Bus Review Checklist",
            "guid": "11e6f883-e52f-4472-8dd6-8c5b5c2521e5",
            "link": "https://learn.microsoft.com/azure/service-bus-messaging/service-bus-messaging-exceptions",
            "services": [
                "ServiceBus"
            ],
            "severity": "High",
            "subcategory": "Best Practices",
            "text": "Ensure that Service Bus Messaging Exceptions are handled properly",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Service Bus Review Checklist",
            "guid": "4a69b9d3-39ac-44e7-a68d-1d75657202b4",
            "link": "https://learn.microsoft.com/azure/well-architected/service-guides/service-bus/reliability#checklist",
            "services": [
                "ServiceBus",
                "PrivateLink",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Best Practices",
            "text": "Connect to Service Bus with the Advanced Messaging Queue Protocol (AMQP) and use Service Endpoints or Private Endpoints when possible.",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Service Bus Review Checklist",
            "guid": "f4564b4d-974a-4759-a763-e7d261613a76",
            "link": "https://learn.microsoft.com/azure/service-bus-messaging/service-bus-performance-improvements?tabs=net-standard-sdk-2",
            "services": [
                "ServiceBus"
            ],
            "severity": "High",
            "subcategory": "Best Practices",
            "text": "Review the Best Practices for performance improvements using Service Bus Messaging",
            "waf": "Reliability"
        },
        {
            "category": "Security",
            "checklist": "Service Bus Review Checklist",
            "description": "Azure Service Bus Premium provides encryption of data at rest. If you use your own key, the data is still encrypted using the Microsoft-managed key, but in addition the Microsoft-managed key will be encrypted using the customer-managed key. ",
            "guid": "87af4a79-1f89-439b-ba47-768e14c11567",
            "link": "https://learn.microsoft.com/azure/service-bus-messaging/configure-customer-managed-key",
            "service": "Service Bus",
            "services": [
                "ServiceBus"
            ],
            "severity": "Low",
            "subcategory": "Data Protection",
            "text": "Use customer-managed key option in data at rest encryption when required",
            "training": "https://learn.microsoft.com/learn/modules/plan-implement-administer-conditional-access/",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Service Bus Review Checklist",
            "description": "Communication between a client application and an Azure Service Bus namespace is encrypted using Transport Layer Security (TLS). Azure Service Bus namespaces permit clients to send and receive data with TLS 1.0 and above. To enforce stricter security measures, you can configure your Service Bus namespace to require that clients send and receive data with a newer version of TLS.",
            "guid": "5c1ea55b-46a9-448f-b8ae-7d7e4b475b6c",
            "link": "https://learn.microsoft.com/azure/service-bus-messaging/transport-layer-security-enforce-minimum-version",
            "service": "Service Bus",
            "services": [
                "ServiceBus"
            ],
            "severity": "Medium",
            "subcategory": "Data Protection",
            "text": "Enforce a minimum required version of Transport Layer Security (TLS) for requests ",
            "training": "https://learn.microsoft.com/learn/modules/secure-aad-users-with-mfa/",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Service Bus Review Checklist",
            "description": "When you create a Service Bus namespace, a SAS rule named RootManageSharedAccessKey is automatically created for the namespace. This policy has Manage permissions for the entire namespace. It's recommended that you treat this rule like an administrative root account and don't use it in your application.  Using AAD as an authentication provider with RBAC is recommended. ",
            "guid": "8bcbf59b-ce65-4de8-a03f-97879468d66a",
            "link": "https://learn.microsoft.com/azure/service-bus-messaging/service-bus-sas#shared-access-authorization-policies",
            "service": "Service Bus",
            "services": [
                "ServiceBus",
                "AzurePolicy",
                "RBAC",
                "Entra",
                "TrafficManager"
            ],
            "severity": "Medium",
            "subcategory": "Identity and Access Management",
            "text": "Avoid using root account when it is not necessary",
            "training": "https://learn.microsoft.com/learn/paths/azure-administrator-manage-identities-governance/",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Service Bus Review Checklist",
            "description": "Microsoft Entra ID provides superior security and ease of use over shared access signatures (SAS). With Microsoft Entra ID, there’s no need to store the tokens in your code and risk potential security vulnerabilities. We recommend that you use Microsoft Entra ID with your Azure Service Bus applications when possible.",
            "graph": "Resources | where type =~ 'microsoft.servicebus/namespaces' | extend compliant = iif(properties.disableLocalAuth == 'false', 'No', 'Yes') | project id, compliant",
            "guid": "786d60f9-6c96-4ad8-a55d-04c2b39c986b",
            "link": "https://learn.microsoft.com/en-us/azure/service-bus-messaging/disable-local-authentication",
            "service": "Service Bus",
            "services": [
                "ServiceBus",
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Identity and Access Management",
            "text": "When possible, disable SAS key authentication (or local authentication) and use only Microsoft Entra ID for authentication",
            "training": "https://learn.microsoft.com/learn/modules/azure-ad-privileged-identity-management/",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Service Bus Review Checklist",
            "description": "When creating permissions, provide fine-grained control over a client's access to Azure Service Bus. Permissions in Azure Service Bus can and should be scoped to the individual resource level e.g. queue, topic or subscription. ",
            "guid": "f615658d-e558-4f93-9249-b831112dbd7e",
            "link": "https://learn.microsoft.com/azure/service-bus-messaging/authenticate-application#azure-built-in-roles-for-azure-service-bus",
            "service": "Service Bus",
            "services": [
                "ServiceBus",
                "RBAC",
                "Entra",
                "Subscriptions",
                "Storage"
            ],
            "severity": "High",
            "subcategory": "Identity and Access Management",
            "text": "Use least privilege data plane RBAC",
            "training": "https://learn.microsoft.com/learn/modules/explore-basic-services-identity-types/",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Service Bus Review Checklist",
            "description": "Azure Service Bus resource logs include operational logs,  virtual network and IP filtering logs. Runtime audit logs capture aggregated diagnostic information for various data plane access operations (such as send or receive messages) in Service Bus.",
            "guid": "af12e7f9-43f6-4304-922d-929c2b1cd622",
            "link": "https://learn.microsoft.com/azure/service-bus-messaging/monitor-service-bus-reference",
            "service": "Service Bus",
            "services": [
                "VNet",
                "ServiceBus",
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Monitoring",
            "text": "Enable logging for security investigation. Use Azure Monitor to trace resource logs and runtime audit logs (currently available only in the premium tier)",
            "training": "https://learn.microsoft.com/learn/paths/manage-identity-and-access/",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Service Bus Review Checklist",
            "description": "Azure Service Bus by default has a public IP address and is Internet-reachable. Private endpoints allow traffic between your virtual network and Azure Service Bus traverses over the Microsoft backbone network. In addition to that, you should disable public endpoints if those are not used. ",
            "guid": "9ae669ca-48e4-4a85-b222-3ece8bb12307",
            "link": "https://learn.microsoft.com/azure/service-bus-messaging/private-link-service",
            "service": "Service Bus",
            "services": [
                "VNet",
                "ServiceBus",
                "PrivateLink"
            ],
            "severity": "Medium",
            "subcategory": "Networking",
            "text": "Consider using private endpoints to access Azure Service Bus and disable public network access when applicable.",
            "training": "https://learn.microsoft.com/learn/modules/azure-ad-privileged-identity-management/",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Service Bus Review Checklist",
            "description": "With IP firewall, you can restrict the public endpoint further to only a set of IPv4 addresses or IPv4 address ranges in CIDR (Classless Inter-Domain Routing) notation. ",
            "guid": "ca5f06f1-58e3-4ea3-a92c-2de7e2165c3a",
            "link": "https://learn.microsoft.com/azure/service-bus-messaging/service-bus-ip-filtering",
            "service": "Service Bus",
            "services": [
                "ServiceBus"
            ],
            "severity": "Medium",
            "subcategory": "Networking",
            "text": "Consider only allowing access to Azure Service Bus namespace from specific IP addresses or ranges",
            "training": "https://learn.microsoft.com/learn/paths/implement-resource-mgmt-security/",
            "waf": "Security"
        },
        {
            "category": "BC and DR",
            "checklist": "Device Provisioning Service Review",
            "guid": "cb26b2ba-a9db-45d1-8260-d9c6ec1447d9",
            "link": "https://learn.microsoft.com/en-us/azure/logic-apps/single-tenant-overview-compare",
            "service": "IoT Hub DPS",
            "services": [],
            "severity": "High",
            "subcategory": "High Availability",
            "text": "Select the right Logic App hosting plan based on your business & SLO requirements",
            "waf": "Reliability"
        },
        {
            "category": "BC and DR",
            "checklist": "Device Provisioning Service Review",
            "guid": "f6dd7977-1123-4f39-b488-f91415a8430a",
            "link": "https://learn.microsoft.com/en-us/azure/logic-apps/set-up-zone-redundancy-availability-zones?tabs=standard#next-steps",
            "service": "IoT Hub DPS",
            "services": [],
            "severity": "High",
            "subcategory": "High Availability",
            "text": "Protect logic apps from region failures with zone redundancy and availability zones",
            "waf": "Reliability"
        },
        {
            "category": "BC and DR",
            "checklist": "Device Provisioning Service Review",
            "guid": "8aed4fbf-0830-4883-899d-222a154af478",
            "link": "https://learn.microsoft.com/en-us/azure/logic-apps/business-continuity-disaster-recovery-guidance?toc=%2Fazure%2Freliability%2Ftoc.json&bc=%2Fazure%2Freliability%2Fbreadcrumb%2Ftoc.json",
            "service": "IoT Hub DPS",
            "services": [],
            "severity": "High",
            "subcategory": "High Availability",
            "text": "Consider a Cross-Region DR strategy for critical workloads",
            "waf": "Reliability"
        },
        {
            "category": "BC and DR",
            "checklist": "Device Provisioning Service Review",
            "guid": "da0f033e-d180-4f36-9aa4-c468dba14203",
            "link": "https://learn.microsoft.com/en-us/azure/app-service/environment/intro",
            "service": "IoT Hub DPS",
            "services": [
                "AppSvc"
            ],
            "severity": "High",
            "subcategory": "High Availability",
            "text": "If deploying to an Isolated environment, use or migrate to App Service Environment (ASE) v3",
            "waf": "Reliability"
        },
        {
            "category": "Application Deployment",
            "checklist": "Device Provisioning Service Review",
            "guid": "62711604-c9d1-4b0a-bdb7-5fda54a4f6c1",
            "link": "https://learn.microsoft.com/en-us/training/modules/deploy-azure-functions/",
            "service": "IoT Hub DPS",
            "services": [],
            "severity": "Medium",
            "subcategory": "CI/CD",
            "text": "Leverage Azure DevOps or GitHub to streamline CI/CD and safeguard your Logic App code",
            "waf": "Operations"
        },
        {
            "category": "BCDR",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Ensure data repositories for the backup solution are stored outside of vSAN storage. Either in Azure native or on a disk pool-backed datastore",
            "guid": "976f32a7-30d1-6caa-c2a0-207fdc26571b",
            "link": "https://learn.microsoft.com/azure/azure-vmware/set-up-backup-server-for-azure-vmware-solution",
            "services": [
                "AVS",
                "Storage",
                "Backup"
            ],
            "severity": "Medium",
            "subcategory": "Backup",
            "text": "Ensure backups are not stored on vSAN as vSAN is a finite resource",
            "waf": "Reliability"
        },
        {
            "category": "BCDR",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Microsoft backup service",
            "guid": "fc8af7a1-c724-e255-c18d-4ca22a6f27f0",
            "link": "https://docs.microsoft.com/azure/azure-vmware/set-up-backup-server-for-azure-vmware-solution",
            "services": [
                "AVS",
                "Backup"
            ],
            "severity": "Medium",
            "subcategory": "Business Continuity",
            "text": "Use MABS as your backup solution",
            "waf": "Reliability"
        },
        {
            "category": "BCDR",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Best practice - this is Backup, not disaster recovery",
            "guid": "be28860f-3d29-a79a-1a0e-36f1b23b36ae",
            "link": "Best practice to deploy backup in the same region as your AVS deployment",
            "services": [
                "AVS",
                "ASR",
                "Backup"
            ],
            "severity": "Medium",
            "subcategory": "Business Continuity",
            "text": "Deploy your backup solution in the same region as your Azure VMware Solution private cloud",
            "waf": "Reliability"
        },
        {
            "category": "BCDR",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Best practice - in case AVS is unavailable",
            "guid": "4d2f79a5-4ccf-0dfc-557c-49619b99a540",
            "link": "https://docs.microsoft.com/azure/azure-vmware/set-up-backup-server-for-azure-vmware-solution",
            "services": [
                "AVS"
            ],
            "severity": "Medium",
            "subcategory": "Business Continuity",
            "text": "Preferably deploy MABS outside of the SDDC as native Azure IaaS",
            "waf": "Reliability"
        },
        {
            "category": "BCDR",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Is a process in place to request a restore of the VMware components managed by the Azure Platform?",
            "guid": "ff431c40-962c-5182-d536-0c2f0c4ce9e0",
            "link": "Will Disaster Recovery Site Recovery, HCX Disaster Recovery, SRM or back tools be used?",
            "services": [
                "AVS"
            ],
            "severity": "Medium",
            "subcategory": "Business Continuity",
            "text": "Escalation process with Microsoft in the event of a regional DR",
            "waf": "Reliability"
        },
        {
            "category": "BCDR",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Compare SRM with HCX",
            "guid": "f379436d-3051-daa0-01fb-dc4e0e04d677",
            "link": "https://docs.microsoft.com/azure/azure-vmware/disaster-recovery-using-vmware-site-recovery-manager",
            "services": [
                "AVS",
                "ASR"
            ],
            "severity": "Medium",
            "subcategory": "Disaster Recovery",
            "text": "Use VMware Site Recovery Manager when both sites are Azure VMware Solution",
            "waf": "Reliability"
        },
        {
            "category": "BCDR",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Recovery into Azure instead of Vmware solution",
            "guid": "367f71d8-3cf6-51a0-91a5-3db3d570cc19",
            "link": "https://docs.microsoft.com/azure/site-recovery/avs-tutorial-prepare-azure",
            "services": [
                "AVS",
                "ASR"
            ],
            "severity": "Medium",
            "subcategory": "Disaster Recovery",
            "text": "Use Azure Site Recovery when the Disaster Recovery technology is native Azure IaaS",
            "waf": "Reliability"
        },
        {
            "category": "BCDR",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Avoid manual tasks as much as possible",
            "guid": "ee02ada0-1887-bb3a-b84c-423f45a09ef9",
            "link": "https://docs.microsoft.com/azure/site-recovery/avs-tutorial-prepare-azure",
            "services": [
                "AVS",
                "ASR"
            ],
            "severity": "Medium",
            "subcategory": "Disaster Recovery",
            "text": "Use Automated recovery plans with either of the Disaster solutions,",
            "waf": "Reliability"
        },
        {
            "category": "BCDR",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Any other datacenter in the same region",
            "guid": "0c2b74e5-9c28-780d-1df3-12d3de4aaa76",
            "link": "https://docs.microsoft.com/azure/azure-vmware/connect-multiple-private-clouds-same-region",
            "services": [
                "AVS",
                "ASR"
            ],
            "severity": "Medium",
            "subcategory": "Disaster Recovery",
            "text": "Configure a secondary disaster recovery environment",
            "waf": "Reliability"
        },
        {
            "category": "BCDR",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Use 2 different address spaces between the regions, for example: 10.0.0.0/16 and 192.168.0.0/16 for the different regions",
            "guid": "c2a34ec4-2933-4e6c-dc36-e20e67abbe3f",
            "link": "https://docs.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-ip-addressing",
            "services": [
                "AVS",
                "ASR"
            ],
            "severity": "Medium",
            "subcategory": "Disaster Recovery",
            "text": "Assign IP ranges unique to each region",
            "waf": "Reliability"
        },
        {
            "category": "BCDR",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "ExpressRoute Global Reach can be used for connectivity between the primary and secondary Azure VMware Solution Private Clouds or  routing must be done through network virtual appliances?",
            "guid": "b44fb6ec-bfc1-3a8e-dba2-ca97f0991d2c",
            "link": "This depends if you have multiple AVS Private Clouds. If so and they are in the same region then use AVS Interconnect. If they are in separate regions then use ExpressRoute Global Reach.",
            "services": [
                "AVS",
                "NVA",
                "ExpressRoute",
                "ASR"
            ],
            "severity": "Medium",
            "subcategory": "Disaster Recovery",
            "text": "Use Global Reach between DR regions",
            "waf": "Reliability"
        },
        {
            "category": "Connectivity",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "An ExR Global Reach connection will be established to the ExR circuit, no other connections",
            "guid": "a2c12df2-07fa-3edd-2cec-fda0b55fb952",
            "link": "https://learn.microsoft.com/azure/azure-vmware/tutorial-expressroute-global-reach-private-cloud",
            "services": [
                "AVS",
                "VWAN"
            ],
            "severity": "Medium",
            "subcategory": "Direct (no vWAN, no H&S)",
            "text": "Global Reach to ExR circuit - no Azure resources",
            "waf": "Performance"
        },
        {
            "category": "Connectivity",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Use ExR to connect on-premises (other) location to Azure",
            "guid": "f62ce162-ba5a-429d-674e-fafa1af5f706",
            "link": "https://learn.microsoft.com/azure/azure-vmware/tutorial-expressroute-global-reach-private-cloud",
            "services": [
                "AVS",
                "ExpressRoute"
            ],
            "severity": "Medium",
            "subcategory": "ExpressRoute",
            "text": "Connect to Azure using ExR",
            "waf": "Performance"
        },
        {
            "category": "Connectivity",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Use the migration assesment tool and timeline to determine bandwidth required",
            "guid": "cf01c73b-1247-0a7a-740c-e1ea29bda340",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-introduction",
            "services": [
                "AVS",
                "ExpressRoute"
            ],
            "severity": "Medium",
            "subcategory": "ExpressRoute",
            "text": "Bandwidth sizing",
            "waf": "Performance"
        },
        {
            "category": "Connectivity",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "What traffic is routed through a firewall, what goes directly into Azure",
            "guid": "aab216ee-8941-315e-eada-c7e1f2243bd1",
            "link": "https://learn.microsoft.com/azure/architecture/solution-ideas/articles/azure-vmware-solution-foundation-networking",
            "services": [
                "AVS",
                "ExpressRoute"
            ],
            "severity": "Medium",
            "subcategory": "ExpressRoute",
            "text": "Traffic routing ",
            "waf": "Performance"
        },
        {
            "category": "Connectivity",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "AVS to ExR circuit, no traffic inspection",
            "guid": "1f956e45-f62d-5c95-3a95-3bab718907f8",
            "link": "https://learn.microsoft.com/azure/architecture/solution-ideas/articles/azure-vmware-solution-foundation-networking",
            "services": [
                "AVS",
                "ExpressRoute"
            ],
            "severity": "Medium",
            "subcategory": "ExpressRoute",
            "text": "Global Reach ",
            "waf": "Performance"
        },
        {
            "category": "Connectivity",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Name of the vNet and a unique address space /24 minimum",
            "guid": "91f7a87b-21ac-d712-959c-8df2ba034253",
            "link": "https://learn.microsoft.com/azure/virtual-network/quick-create-portal",
            "services": [
                "AVS",
                "VNet"
            ],
            "severity": "Medium",
            "subcategory": "Hub & Spoke",
            "text": "VNet  name & address space",
            "waf": "Performance"
        },
        {
            "category": "Connectivity",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Subnet must be called GatewaySubnet",
            "guid": "58a027e2-f37f-b540-45d5-e44843aba26b",
            "link": "https://learn.microsoft.com/azure/vpn-gateway/vpn-gateway-about-vpn-gateway-settings",
            "services": [
                "AVS",
                "VNet",
                "ExpressRoute",
                "VPN"
            ],
            "severity": "Medium",
            "subcategory": "Hub & Spoke",
            "text": "Gateway subnet",
            "waf": "Performance"
        },
        {
            "category": "Connectivity",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Create a VPN gateway on the hub Gateway subnet",
            "guid": "d4806549-0913-3e79-b580-ac2d3706e65a",
            "link": "https://learn.microsoft.com/azure/vpn-gateway/vpn-gateway-about-vpn-gateway-settings",
            "services": [
                "AVS",
                "VNet",
                "ExpressRoute",
                "VPN"
            ],
            "severity": "Medium",
            "subcategory": "Hub & Spoke",
            "text": "VPN Gateway",
            "waf": "Performance"
        },
        {
            "category": "Connectivity",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Create an ExR Gateway in the hub Gateway subnet.",
            "guid": "864d7a8b-7016-c769-a717-61af6bfb73d2",
            "link": "https://learn.microsoft.com/azure/vpn-gateway/vpn-gateway-about-vpn-gateway-settings",
            "services": [
                "AVS",
                "VNet",
                "ExpressRoute",
                "VPN"
            ],
            "severity": "Medium",
            "subcategory": "Hub & Spoke",
            "text": "ExR Gateway",
            "waf": "Performance"
        },
        {
            "category": "Connectivity",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "How will Internet traffic be routes, Az Firewall, NVA, Secure Hub, On-Premises firewall?",
            "guid": "cc2e11b9-7911-7da1-458c-d7fcef794aad",
            "link": "https://learn.microsoft.com/azure/azure-vmware/enable-public-internet-access",
            "services": [
                "AVS",
                "NVA"
            ],
            "severity": "Medium",
            "subcategory": "Internet",
            "text": "Egress point",
            "waf": "Performance"
        },
        {
            "category": "Connectivity",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Allow remote connectivity to AVS via the portal, specifically to vCenter, NSX-T and HCX",
            "guid": "71e68ce3-982e-5e56-0191-01100ad0e66f",
            "link": "https://learn.microsoft.com/answers/questions/171195/how-to-create-jump-server-in-azure-not-bastion-paa.html",
            "services": [
                "AVS",
                "Bastion"
            ],
            "severity": "Medium",
            "subcategory": "Jumpbox & Bastion",
            "text": "Remote connectivity to AVS",
            "waf": "Performance"
        },
        {
            "category": "Connectivity",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Name the jumpbox and identify the subnet where it will be hosted",
            "guid": "6f8e93a2-44b1-bb1d-28a1-4d5b3c2ea857",
            "link": "https://learn.microsoft.com/azure/bastion/tutorial-create-host-portal",
            "services": [
                "AVS",
                "VNet",
                "Bastion"
            ],
            "severity": "Medium",
            "subcategory": "Jumpbox & Bastion",
            "text": "Configure a jumbox and Azure Bastion",
            "waf": "Performance"
        },
        {
            "category": "Connectivity",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Provides secure / seamless RDP/SSH connectivity to your vm's directly through the portal.",
            "guid": "ba430d58-4541-085c-3641-068c00be9bc5",
            "link": "https://learn.microsoft.com/azure/virtual-network/network-security-groups-overview",
            "services": [
                "AVS",
                "Bastion",
                "VM"
            ],
            "severity": "Medium",
            "subcategory": "Jumpbox & Bastion",
            "text": "Security measure allowing RDP access via the portal",
            "waf": "Performance"
        },
        {
            "category": "Connectivity",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Using a VPN to connect to Azure to enable VMware communications (HCX) (not recommended)",
            "guid": "9988598f-2a9f-6b12-9b46-488415ceb325",
            "link": "https://learn.microsoft.com/azure/azure-vmware/configure-site-to-site-vpn-gateway",
            "services": [
                "AVS",
                "VPN"
            ],
            "severity": "Medium",
            "subcategory": "VPN",
            "text": "Connect to Azure using a VPN",
            "waf": "Performance"
        },
        {
            "category": "Connectivity",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Use the migration assesment tool and timeline to determine bandwidth required (eg 3rd party tool in link)",
            "guid": "956ce5e9-a862-fe2b-a50d-a22923569357",
            "link": "https://www.omnicalculator.com/other/data-transfer#:~:text=To%20calculate%20the%20data%20transfer%20speed%3A%201%20Download,measured%20time%20to%20find%20the%20data%20transfer%20speed.",
            "services": [
                "AVS",
                "VPN"
            ],
            "severity": "Medium",
            "subcategory": "VPN",
            "text": "Bandwidth sizing",
            "waf": "Performance"
        },
        {
            "category": "Connectivity",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "What traffic is routed through a firewall, what goes directly into Azure",
            "guid": "e095116f-0bdc-4b51-4d71-b9e469d56f59",
            "link": "https://learn.microsoft.com/azure/architecture/solution-ideas/articles/azure-vmware-solution-foundation-networking",
            "services": [
                "AVS",
                "VPN"
            ],
            "severity": "Medium",
            "subcategory": "VPN",
            "text": "Traffic routing ",
            "waf": "Performance"
        },
        {
            "category": "Connectivity",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Name and unique address space for the vWAN, name for the vWAN hub",
            "guid": "4dc480ac-cecd-39c4-fdc6-680b300716ab",
            "link": "https://learn.microsoft.com/azure/virtual-wan/virtual-wan-site-to-site-portal#openvwan",
            "services": [
                "AVS",
                "VWAN"
            ],
            "severity": "Medium",
            "subcategory": "vWAN hub",
            "text": "vWAN name, hub name and address space",
            "waf": "Performance"
        },
        {
            "category": "Connectivity",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Select either boh or the appropriate connection type.",
            "guid": "51d6affd-8e02-6aea-d3d4-0baf618b3076",
            "link": "https://learn.microsoft.com/azure/virtual-wan/virtual-wan-point-to-site-portal",
            "services": [
                "AVS",
                "VWAN",
                "VPN"
            ],
            "severity": "Medium",
            "subcategory": "vWAN hub",
            "text": "ExR and/or VPN gateway provisioned",
            "waf": "Performance"
        },
        {
            "category": "Connectivity",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Add Azure firewall to vWAN (recommended)",
            "guid": "e32a4c67-3dc0-c134-1c12-52d46dcbab5b",
            "link": "https://learn.microsoft.com/azure/virtual-wan/virtual-wan-expressroute-portal",
            "services": [
                "AVS",
                "Firewall",
                "VWAN"
            ],
            "severity": "Medium",
            "subcategory": "vWAN hub",
            "text": "Secure vWAN",
            "waf": "Security"
        },
        {
            "category": "Identity",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Active directory or other identity provider servers",
            "guid": "fbc47fbf-bc96-fa93-ed5d-8c9be63cd5c3",
            "link": "https://learn.microsoft.com/azure/azure-vmware/configure-identity-source-vcenter",
            "services": [
                "AVS",
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Access",
            "text": "External Identity (user accounts)",
            "waf": "Security"
        },
        {
            "category": "Identity",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Not required for LDAPS, required for Kerberos",
            "guid": "b5db7975-f6bb-8ba3-ee5f-e3e805887997",
            "link": "https://learn.microsoft.com/windows-server/identity/ad-ds/plan/understanding-active-directory-site-topology",
            "services": [
                "AVS",
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Access",
            "text": "If using AD domain, ensure Sites & Services has been configured",
            "waf": "Security"
        },
        {
            "category": "Identity",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Authentication for users, must be secure.",
            "guid": "c30749c4-e2af-558c-2eb9-0b6ae84881d1",
            "link": "https://learn.microsoft.com/azure/azure-vmware/configure-identity-source-vcenter",
            "services": [
                "AVS",
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Access",
            "text": "Use LDAPS not ldap ( vCenter)",
            "waf": "Security"
        },
        {
            "category": "Identity",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Authentication for users, must be secure.",
            "guid": "64cb9b5c-9edd-787e-1dd8-2b2338e51635",
            "link": "https://learn.microsoft.com/azure/azure-vmware/configure-external-identity-source-nsx-t",
            "services": [
                "AVS",
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Access",
            "text": "Use LDAPS not ldap (NSX-T)",
            "waf": "Security"
        },
        {
            "category": "Identity",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "CN or SAN names, no wildcards, contains private key - CER or PFX",
            "guid": "bec285ab-037e-d629-81d1-f61dac23cd4c",
            "link": "https://youtu.be/4jvfbsrhnEs",
            "services": [
                "AVS",
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Security",
            "text": "Security certificate installed on LDAPS servers ",
            "waf": "Security"
        },
        {
            "category": "Identity",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Standard Azure Roles Based Access Controls",
            "guid": "4ba394a2-3c33-104c-8e34-2dadaba9cc73",
            "link": "https://learn.microsoft.com/azure/azure-vmware/concepts-identity",
            "services": [
                "AVS",
                "RBAC",
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Security",
            "text": "RBAC applied to Azure roles",
            "waf": "Security"
        },
        {
            "category": "Identity",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Create roles in vCenter required to meet minimum viable access guidelines",
            "guid": "b04ca129-83a9-3494-7512-347dd2d766db",
            "link": "https://learn.microsoft.com/azure/azure-vmware/concepts-identity#view-the-vcenter-server-privileges",
            "services": [
                "AVS",
                "RBAC",
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Security",
            "text": "RBAC model in vCenter",
            "waf": "Security"
        },
        {
            "category": "Identity",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "CloudAdmin account in vCenter IdP is used only as an emergency account (break-glass)",
            "guid": "8e477d2f-8004-3dd0-93d6-0aece9e1b2fb",
            "link": "Best practice",
            "services": [
                "AVS",
                "RBAC",
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Security",
            "text": "CloudAdmin role usage",
            "waf": "Security"
        },
        {
            "category": "Identity",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "For roles managing the Azure VMware Solution resource in the Azure Portal (no standing permissions allowed)",
            "guid": "00e0b729-f9be-f600-8c32-5ec0e8f2ed63",
            "link": "https://learn.microsoft.com/azure/active-directory/privileged-identity-management/pim-configure",
            "services": [
                "AVS",
                "Entra",
                "RBAC"
            ],
            "severity": "Medium",
            "subcategory": "Security ",
            "text": "Is Privileged Identity Management implemented",
            "waf": "Security"
        },
        {
            "category": "Identity",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "For the Azure VMware Solution PIM roles",
            "guid": "0842d45f-41a8-8274-1155-2f6ed554d315",
            "link": "https://learn.microsoft.com/azure/active-directory/privileged-identity-management/pim-configure",
            "services": [
                "AVS",
                "Entra",
                "RBAC"
            ],
            "severity": "Medium",
            "subcategory": "Security ",
            "text": "Is Privileged Identity Management audit reporting implemented",
            "waf": "Security"
        },
        {
            "category": "Identity",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Best practice, also see Monitoring/Alerts",
            "guid": "915cbcd7-0640-eb7c-4162-9f33775de559",
            "link": "Best practice",
            "services": [
                "AVS",
                "Entra",
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Security ",
            "text": "Limit use of CloudAdmin account to emergency access only",
            "waf": "Security"
        },
        {
            "category": "Identity",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Operational procedure",
            "guid": "7effa0c0-9172-e8e4-726a-67dbea8be40a",
            "link": "https://learn.microsoft.com/azure/azure-vmware/rotate-cloudadmin-credentials?tabs=azure-portal",
            "services": [
                "AVS",
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Security ",
            "text": "Is a process defined to regularly rotate cloudadmin (vCenter) and admin (NSX) credentials",
            "waf": "Security"
        },
        {
            "category": "Management",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Use Azure ARC for Servers to properly govern workloads running on Azure VMware Solution using Azure native technologies (Azure ARC for Azure VMware Solution is not yet available)",
            "guid": "8f426fd0-d73b-d398-1f6f-df0cbe262a82",
            "link": "https://learn.microsoft.com/azure/azure-arc/vmware-vsphere/overview",
            "services": [
                "AVS",
                "VM",
                "Arc"
            ],
            "severity": "Medium",
            "subcategory": "Operations",
            "text": "AVS VM Management (Azure Arc)",
            "waf": "Operations"
        },
        {
            "category": "Management",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Use Azure Policy to onboard Azure VMware Solution workloads in the Azure Management, Monitoring and Security solutions",
            "guid": "11dbe773-e380-9191-1418-e886fa7a6fd0",
            "link": "https://docs.microsoft.com/azure/governance/policy/overview",
            "services": [
                "AVS",
                "AzurePolicy",
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Operations",
            "text": "Azure policy",
            "waf": "Operations"
        },
        {
            "category": "Management",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "For manual deployments, consider implementing resource locks to prevent accidental actions on your Azure VMware Solution Private Cloud",
            "guid": "1e59c639-9b7e-a60b-5e93-3798c1aff5db",
            "link": "https://docs.microsoft.com/azure/azure-resource-manager/management/lock-resources?tabs=json#configure-locks",
            "services": [
                "AVS"
            ],
            "severity": "Medium",
            "subcategory": "Operations",
            "text": "Resource locks",
            "waf": "Operations"
        },
        {
            "category": "Management",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "For manual deployments, all configuration and deployments must be documented",
            "guid": "8f2c46aa-ca1b-cad3-3ac9-213dfc0a265e",
            "link": "Make sure to create your own runbook on the deployment of AVS.",
            "services": [
                "AVS"
            ],
            "severity": "Medium",
            "subcategory": "Operations",
            "text": "Run books",
            "waf": "Operations"
        },
        {
            "category": "Management",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Implement human understandable names for ExR authorization keys to allow for easy identification of the keys purpose/use",
            "guid": "86b314f9-1f1e-317a-4dfb-cf510ad4a030",
            "link": "https://docs.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/resource-abbreviations",
            "services": [
                "AVS",
                "AKV"
            ],
            "severity": "Medium",
            "subcategory": "Operations",
            "text": "Naming conventions for auth keys",
            "waf": "Operations"
        },
        {
            "category": "Monitoring",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "For automatic alerting on Azure VMware Solution performance (CPU >80%, Avg Memory >80%, vSAN >70%)",
            "guid": "e22a2d99-eb71-7d7c-07af-6d4cdb1d4443",
            "link": "https://docs.microsoft.com/azure/azure-vmware/configure-alerts-for-azure-vmware-solution",
            "services": [
                "AVS",
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Alerts",
            "text": "Create warning alerts for critical thresholds ",
            "waf": "Operations"
        },
        {
            "category": "Monitoring",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "for automatic alerting on Azure VMware Solution performance (CPU >80%, Avg Memory >80%, vSAN >70%)",
            "guid": "6d02f159-627d-79bf-a931-fab6d947eda2",
            "link": "https://docs.microsoft.com/azure/azure-vmware/configure-alerts-for-azure-vmware-solution",
            "services": [
                "AVS",
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Alerts",
            "text": "Create critical alert vSAN consumption",
            "waf": "Operations"
        },
        {
            "category": "Monitoring",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Provides platform alerts (generated by Microsoft)",
            "guid": "1cc97b39-2c7e-246f-6d73-789cfebfe951",
            "link": "https://www.virtualworkloads.com/2021/04/azure-vmware-solution-azure-service-health/",
            "services": [
                "AVS",
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Alerts",
            "text": "Configured for Azure Service Health alerts and notifications",
            "waf": "Operations"
        },
        {
            "category": "Monitoring",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Ensure you have a documented and implemented backup policy and solution for Azure VMware Solution VM workloads",
            "guid": "0962606c-e3b4-62a9-5661-e4ffd62a4509",
            "link": "https://docs.microsoft.com/azure/azure-vmware/set-up-backup-server-for-azure-vmware-solution",
            "services": [
                "AzurePolicy",
                "Backup",
                "AVS",
                "Monitor",
                "VM"
            ],
            "severity": "Medium",
            "subcategory": "Backup",
            "text": "Backup policy",
            "waf": "Operations"
        },
        {
            "category": "Monitoring",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Keep in mind the lead time for requesting new nodes",
            "guid": "4ec7ccfb-795e-897e-4a84-fd31c04eadc6",
            "link": "https://docs.microsoft.com/azure/azure-vmware/configure-alerts-for-azure-vmware-solution",
            "services": [
                "AVS",
                "AzurePolicy",
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Capacity",
            "text": "Policy around ESXi host density and efficiency",
            "waf": "Operations"
        },
        {
            "category": "Monitoring",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Azure Cost Management can be used - one option, put AVS in it's own Subscription. ",
            "guid": "7f8f175d-13f4-5298-9e61-0bc7e9fcc279",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/azure-vmware/govern",
            "services": [
                "AVS",
                "Subscriptions",
                "Monitor",
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Costs",
            "text": "Ensure a good cost management process is in place for Azure VMware Solution - ",
            "waf": "Operations"
        },
        {
            "category": "Monitoring",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Create dashboards to enable core Azure VMware Solution monitoring insights",
            "guid": "01e689e0-7c6c-b58f-37bd-4d6b9b1b9c74",
            "link": "https://docs.microsoft.com/azure/azure-portal/azure-portal-dashboards",
            "services": [
                "AVS",
                "NetworkWatcher",
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Dashboard",
            "text": "Connection monitor dashboard",
            "waf": "Operations"
        },
        {
            "category": "Monitoring",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Send to an Azure Storage account or Azure EventHub for processing (direct to Log Analytics is pending)",
            "guid": "f9afdcc9-649d-d840-9fb5-a3c0edcc697d",
            "link": "https://docs.microsoft.com/azure/azure-vmware/configure-vmware-syslogs",
            "services": [
                "AVS",
                "Monitor",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Logs & Metrics",
            "text": "Configure Azure VMware Solution logging ",
            "waf": "Operations"
        },
        {
            "category": "Monitoring",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Must be on-premises, implement if available",
            "guid": "7cbac8c3-4eda-d5d9-9bda-c6b5abba9fb6",
            "link": "Is vROPS or vRealize Network Insight going to be used? ",
            "services": [
                "AVS",
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Logs & Metrics",
            "text": "vRealize Operations",
            "waf": "Operations"
        },
        {
            "category": "Monitoring",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Ensure workloads running on Azure VMware Solution are monitored using Azure Log Analytics and Azure Monitor",
            "guid": "b243521a-644d-f865-7fb6-21f9019c0dd2",
            "link": "https://docs.microsoft.com/azure/azure-vmware/configure-vmware-syslogs",
            "services": [
                "AVS",
                "Monitor",
                "VM"
            ],
            "severity": "Medium",
            "subcategory": "Logs & Metrics",
            "text": "AVS VM logging",
            "waf": "Operations"
        },
        {
            "category": "Monitoring",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Between on-premises to Azure are monitored using 'connection monitor'",
            "guid": "2ca97d91-dd36-7229-b668-01036ccc3cd3",
            "link": "https://learn.microsoft.com/azure/network-watcher/connection-monitor-create-using-portal",
            "services": [
                "ExpressRoute",
                "NetworkWatcher",
                "VPN",
                "AVS",
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Network",
            "text": "Monitor ExpressRoute and/or VPN connections ",
            "waf": "Operations"
        },
        {
            "category": "Monitoring",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "To monitor the Azure VMware Solution back-end ExpressRoute connection (Azure native to AVS)",
            "guid": "99209143-60fe-19f0-5633-8b5671277ba5",
            "link": "https://learn.microsoft.com/azure/network-watcher/connection-monitor-create-using-portal",
            "services": [
                "AVS",
                "Monitor",
                "ExpressRoute"
            ],
            "severity": "Medium",
            "subcategory": "Network",
            "text": "Monitor from an Azure native resource to an Azure VMware Solution VM",
            "waf": "Operations"
        },
        {
            "category": "Monitoring",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "To monitor end-to-end, on-premises to AVS workloads",
            "guid": "b9e5867c-57d3-036f-fb1b-3f0a71664efe",
            "link": "https://learn.microsoft.com/azure/network-watcher/connection-monitor-create-using-portal",
            "services": [
                "AVS",
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Network",
            "text": "Monitor  from an on-premises resource to an Azure VMware Solution VM",
            "waf": "Operations"
        },
        {
            "category": "Monitoring",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Track requests to Azure VMware Solution and Azure VMware Solution based workloads",
            "guid": "4af7c5f7-e5e9-bedf-a8cf-314b81735962",
            "link": "Firewall logging and alerting rules are configured (Azure Firewall or 3rd party)",
            "services": [
                "AVS",
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Security",
            "text": "Auditing and logging is implemented for inbound internet ",
            "waf": "Operations"
        },
        {
            "category": "Monitoring",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Implemented for outbound internet connections from Azure VMware Solution or Azure VMware Solution based workloads to identify suspicious/malicious activity",
            "guid": "74be60a3-cfac-f057-eda6-3ee087e805d5",
            "link": "https://docs.microsoft.com/azure/cloud-adoption-framework/scenarios/azure-vmware/eslz-network-topology-connectivity",
            "services": [
                "AVS",
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Security",
            "text": "Session monitoring  ",
            "waf": "Operations"
        },
        {
            "category": "Monitoring",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Enable Diagnostic and metric logging on Azure VMware Solution",
            "guid": "a434b3b5-f258-0845-cd76-d7df6ef5890e",
            "link": "https://docs.microsoft.com/azure/azure-vmware/configure-vmware-syslogs",
            "services": [
                "AVS",
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "VMWare",
            "text": "Logging and diagnostics",
            "waf": "Operations"
        },
        {
            "category": "Monitoring",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Monitor AVS workloads (each VM in AVS)",
            "guid": "fb00b69a-83ec-ce72-446e-6c23a0cab09a",
            "link": "https://docs.microsoft.com/azure/azure-monitor/agents/agent-windows?tabs=setup-wizard",
            "services": [
                "AVS",
                "Monitor",
                "VM"
            ],
            "severity": "Medium",
            "subcategory": "VMware",
            "text": "Log Analytics Agents deployed on Azure VMware Solution guest VM workloads",
            "waf": "Operations"
        },
        {
            "category": "Networking",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Decision on traffic flow",
            "guid": "a1354b87-e18e-bf5c-c50b-8ddf0540e971",
            "link": "https://learn.microsoft.com/azure/azure-vmware/concepts-hub-and-spoke",
            "services": [
                "AVS"
            ],
            "severity": "Medium",
            "subcategory": "Hub & Spoke",
            "text": "North/South routing through Az Firewall or 3rd party ",
            "waf": "Security"
        },
        {
            "category": "Networking",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Decision to route Azure to Azure traffic through Firewall, not E/W between AVS workloads (internal to AVS)",
            "guid": "29a8a499-ec31-f336-3266-0895f035e379",
            "link": "https://learn.microsoft.com/azure/azure-vmware/concepts-hub-and-spoke",
            "services": [
                "AVS"
            ],
            "severity": "Medium",
            "subcategory": "Hub & Spoke",
            "text": "East West (Internal to Azure)",
            "waf": "Security"
        },
        {
            "category": "Networking",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Requires a 3rd party NVA with Azure Route server - Scenario 2 (see link)",
            "guid": "ebd3cc3c-ac3d-4293-950d-cecd8445a523",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/azure-vmware/eslz-network-topology-connectivity",
            "services": [
                "AVS",
                "NVA",
                "ARS"
            ],
            "severity": "Medium",
            "subcategory": "Hub & Spoke",
            "text": "ExR without Global Reach",
            "waf": "Operations"
        },
        {
            "category": "Networking",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "When route server is used, ensure no more then 200 routes are propagated from route server to ExR gateway to on-premises (ARS limit). Important when using MoN",
            "guid": "ffb5c5ca-bd89-ff1b-8b73-8a54d503d506",
            "link": "https://learn.microsoft.com/azure/route-server/route-server-faq",
            "services": [
                "AVS",
                "ARS"
            ],
            "severity": "Medium",
            "subcategory": "Hub & Spoke",
            "text": "Route server ",
            "waf": "Operations"
        },
        {
            "category": "Networking",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Via on-premises, Az Firewall, 3rd Party, NSX-T pubic IP",
            "guid": "a4070dad-3def-818d-e9f7-be440d10e7de",
            "link": "https://learn.microsoft.com/azure/azure-vmware/concepts-design-public-internet-access",
            "services": [
                "AVS"
            ],
            "severity": "Medium",
            "subcategory": "Internet",
            "text": "Egress point(s)",
            "waf": "Security"
        },
        {
            "category": "Networking",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Az Firewall, 3rd party NVA, Application Gateway, Azure Frontdoor ",
            "guid": "e942c03d-beaa-3d9f-0526-9b26cd5e9937",
            "link": "Research and choose optimal solution for each application",
            "services": [
                "AVS",
                "NVA",
                "FrontDoor",
                "AppGW"
            ],
            "severity": "Medium",
            "subcategory": "Internet",
            "text": "Internet facing applications",
            "waf": "Security"
        },
        {
            "category": "Networking",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Ensure no more then 200 routes are propagated from route server to ExR gateway to on-premises (ARS limit). Important when using MoN",
            "guid": "e778a2ec-b4d7-1d27-574c-14476b167d37",
            "link": "https://docs.microsoft.com/azure/route-server/route-server-faq#route-server-limits",
            "services": [
                "AVS",
                "ARS"
            ],
            "severity": "Medium",
            "subcategory": "Routing",
            "text": "When route server Route limit understood? ",
            "waf": "Security"
        },
        {
            "category": "Networking",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "(VPN Gateway, AppGW, FrontDoor, Load balancer, VMs (etc) (Remove: enabled on ExR/VPN Gateway subnet in Azure)",
            "guid": "66c97b30-81b9-139a-cc76-dd1d94aef42a",
            "link": "https://docs.microsoft.com/azure/ddos-protection/manage-ddos-protection",
            "services": [
                "FrontDoor",
                "ExpressRoute",
                "LoadBalancer",
                "VNet",
                "VM",
                "VPN",
                "DDoS",
                "AVS",
                "AppGW"
            ],
            "severity": "Medium",
            "subcategory": "Security",
            "text": "Is DDoS standard protection of public facing IP addresses?  ",
            "waf": "Security"
        },
        {
            "category": "Networking",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "To manage Azure VMware Solution, vCenter, NSX manager and HCX manager",
            "guid": "d43da920-4ecc-a4e9-dd45-a2986ce81d32",
            "link": "Best practice: Bastion or 3rd party tool",
            "services": [
                "AVS"
            ],
            "severity": "Medium",
            "subcategory": "Security",
            "text": "Use a dedicated privileged access workstation (PAW)",
            "waf": "Security"
        },
        {
            "category": "Networking",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Use NSX-T for inter-vmware-traffic inspection",
            "guid": "a2dac74f-5380-6e39-25e6-f13b99ece51f",
            "link": "https://docs.vmware.com/en/VMware-NSX-T-Data-Center/3.2/administration/GUID-F6685367-7AA1-4771-927E-ED77727CFDA3.html",
            "services": [
                "AVS"
            ],
            "severity": "Medium",
            "subcategory": "Traffic Inspection",
            "text": "East West (Internal to AVS)",
            "waf": "Security"
        },
        {
            "category": "Networking",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Decision on whether or not to use Secure hub for E/W and Internet traffic - requires Global Reach",
            "guid": "3f621543-dfac-c471-54a6-7b2849b6909a",
            "link": "https://learn.microsoft.com/azure/architecture/networking/hub-spoke-vwan-architecture",
            "services": [
                "AVS",
                "Firewall",
                "VWAN"
            ],
            "severity": "Medium",
            "subcategory": "Virtual WAN",
            "text": "Use Secure Hub (Azure Firewall or 3rd party)",
            "waf": "Security"
        },
        {
            "category": "Networking",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Decision to route Azure to Azure traffic through Firewall, not E/W between AVS workloads (internal to AVS)",
            "guid": "d7af5670-1b39-d95d-6da2-8d660dfbe16b",
            "link": "https://learn.microsoft.com/azure/firewall-manager/secure-cloud-network",
            "services": [
                "AVS",
                "VWAN"
            ],
            "severity": "Medium",
            "subcategory": "Virtual WAN",
            "text": "East West (Internal to Azure)",
            "waf": "Security"
        },
        {
            "category": "Other Services/Operations",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "When intending to use automated scale-out, be sure to apply for sufficient Azure VMware Solution quota for the subscriptions running Azure VMware Solution",
            "guid": "7d049005-eb35-4a93-50a5-3b31a9f61161",
            "link": "https://docs.microsoft.com/azure/azure-vmware/configure-nsx-network-components-azure-portal",
            "services": [
                "AVS",
                "Subscriptions"
            ],
            "severity": "Medium",
            "subcategory": "Automated Scale",
            "text": "Scale out operations planning",
            "waf": "Performance"
        },
        {
            "category": "Other Services/Operations",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "When intending to use automated scale-in, be sure to take storage policy requirements into account before performing such action",
            "guid": "7242c1de-da37-27f3-1ddd-565ccccb8ece",
            "link": "https://docs.microsoft.com/azure/cloud-adoption-framework/scenarios/azure-vmware/eslz-platform-automation-and-devops#automated-scale",
            "services": [
                "AVS",
                "AzurePolicy",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Automated Scale",
            "text": "Scale in operations planning",
            "waf": "Performance"
        },
        {
            "category": "Other Services/Operations",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Scaling operations always need to be serialized within a single SDDC as only one scale operation can be performed at a time (even when multiple clusters are used)",
            "guid": "3233e49e-62ce-97f3-8737-8230e771b694",
            "link": "https://docs.microsoft.com/azure/cloud-adoption-framework/scenarios/azure-vmware/eslz-platform-automation-and-devops#automated-scale",
            "services": [
                "AVS"
            ],
            "severity": "Medium",
            "subcategory": "Automated Scale",
            "text": "Scale serialized operations planning",
            "waf": "Performance"
        },
        {
            "category": "Other Services/Operations",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Consider and validate scaling operations on 3rd party solutions used in the architecture (supported or not)",
            "guid": "68161d66-5707-319b-e77d-9217da892593",
            "link": "Best practice (testing)",
            "services": [
                "AVS"
            ],
            "severity": "Medium",
            "subcategory": "Automated Scale",
            "text": "Scale rd operations planning",
            "waf": "Performance"
        },
        {
            "category": "Other Services/Operations",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Define and enforce scale in/out maximum limits for your environment in the automations",
            "guid": "c32cb953-e860-f204-957a-c79d61202669",
            "link": "Operational planning - understand workload requirements",
            "services": [
                "AVS"
            ],
            "severity": "Medium",
            "subcategory": "Automated Scale",
            "text": "Scale maximum operations planning",
            "waf": "Performance"
        },
        {
            "category": "Other Services/Operations",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Implement monitoring rules to monitor automated scaling operations and monitor success and failure to enable appropriate (automated) responses",
            "guid": "7bd65a5e-7b5d-652d-dbea-fc6f73a42857",
            "link": "https://docs.microsoft.com/azure/cloud-adoption-framework/scenarios/azure-vmware/eslz-management-and-monitoring",
            "services": [
                "AVS",
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Automated Scale",
            "text": "Monitor scaling operations ",
            "waf": "Performance"
        },
        {
            "category": "Other Services/Operations",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Consider the use of Azure Private-Link when using other Azure Native Services",
            "guid": "95e374af-8a2a-2672-7ab7-b4a1be43ada7",
            "link": "https://learn.microsoft.com/azure/private-link/private-link-overview",
            "services": [
                "AVS",
                "PrivateLink"
            ],
            "severity": "Medium",
            "subcategory": "Networking",
            "text": "Private link",
            "waf": "Performance"
        },
        {
            "category": "Other Services/Operations",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "When performing automated configuration of NSX-T segments with a single Tier-1 gateway, use Azure Portal APIs instead of NSX-Manager APIs",
            "guid": "71eff90d-5ad7-ac60-6244-2a6f7d3c51f2",
            "link": "Best practice",
            "services": [
                "AVS"
            ],
            "severity": "Medium",
            "subcategory": "Networking",
            "text": "Provisioning Vmware VLANs",
            "waf": "Performance"
        },
        {
            "category": "Planning",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "In which region will AVS be deployed",
            "guid": "04e3a2f9-83b7-968a-1044-2811811a924b",
            "link": "https://learn.microsoft.com/windows-server/identity/ad-ds/plan/understanding-active-directory-site-topology",
            "services": [
                "AVS"
            ],
            "severity": "Medium",
            "subcategory": "Pre-deployment",
            "text": "Region selected",
            "waf": "Reliability"
        },
        {
            "category": "Planning",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Are there regulatory or compliance policies in play",
            "guid": "e52d1615-9cc6-565c-deb6-743ed7e90f4b",
            "link": "Internal policy or regulatory compliance",
            "services": [
                "AVS",
                "AzurePolicy"
            ],
            "severity": "Medium",
            "subcategory": "Pre-deployment",
            "text": "Data residency compliant with selected regions",
            "waf": "Reliability"
        },
        {
            "category": "Planning",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Request through the support blade",
            "guid": "92bd5ad6-441f-a983-7aa9-05dd669d760b",
            "link": "https://learn.microsoft.com/azure/migrate/concepts-azure-vmware-solution-assessment-calculation",
            "services": [
                "AVS"
            ],
            "severity": "Medium",
            "subcategory": "Pre-deployment",
            "text": "Request for number of AVS hosts submitted ",
            "waf": "Reliability"
        },
        {
            "category": "Planning",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "PG approval for deployment",
            "guid": "28370f63-1cb8-2e35-907f-c5516b6954fa",
            "link": "Support request through portal or get help from Account Team",
            "services": [
                "AVS"
            ],
            "severity": "Medium",
            "subcategory": "Pre-deployment",
            "text": "Region and number of AVS nodes approved",
            "waf": "Reliability"
        },
        {
            "category": "Planning",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Portal/subscription/resource providers/ Microsoft.AVS",
            "guid": "96c76997-30a6-bb92-024d-f4f93f5f57fa",
            "link": "Done through the subscription/resource providers/ AVS  register in the portal",
            "services": [
                "AVS",
                "Subscriptions"
            ],
            "severity": "Medium",
            "subcategory": "Pre-deployment",
            "text": "Resource provider for AVS registered",
            "waf": "Reliability"
        },
        {
            "category": "Planning",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Connectivity, subscription & governanace model",
            "guid": "5898e3ff-5e6b-bee1-6f85-22fee261ce63",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/azure-vmware/enterprise-scale-landing-zone",
            "services": [
                "AVS",
                "Subscriptions"
            ],
            "severity": "Medium",
            "subcategory": "Pre-deployment",
            "text": "Landing zone architecture",
            "waf": "Reliability"
        },
        {
            "category": "Planning",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "The name of the RG where AVS will exist",
            "guid": "d0181fb8-9cb8-bf4b-f5e5-b5f9bf7ae4ea",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/manage-resource-groups-portal",
            "services": [
                "AVS"
            ],
            "severity": "Medium",
            "subcategory": "Pre-deployment",
            "text": "Resource group name selected",
            "waf": "Reliability"
        },
        {
            "category": "Planning",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Each resource created as part of the deployment will also utilize this prefix in the name",
            "guid": "0f0d20c2-5a19-726c-de20-0984e070d9d6",
            "link": "Best practice - naming standards",
            "services": [
                "AVS"
            ],
            "severity": "Medium",
            "subcategory": "Pre-deployment",
            "text": "Deployment prefix selected",
            "waf": "Reliability"
        },
        {
            "category": "Planning",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "/22 unique non-overlapping  IPv4 address space",
            "guid": "7fbf2ab7-a36c-5957-c27a-67038557af2a",
            "link": "https://learn.microsoft.com/azure/azure-vmware/tutorial-network-checklist#routing-and-subnet-considerations",
            "services": [
                "AVS"
            ],
            "severity": "Medium",
            "subcategory": "Pre-deployment",
            "text": "Network space for AVS management layer",
            "waf": "Reliability"
        },
        {
            "category": "Planning",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "vNets used by workloads running in AVS (non-stretched)",
            "guid": "0c87f999-e517-21ef-f355-f210ad4134d2",
            "link": "https://docs.vmware.com/en/VMware-NSX-T-Data-Center/3.2/installation/GUID-4B3860B8-1883-48CA-B2F3-7C2205D91D6D.html",
            "services": [
                "AVS",
                "VNet"
            ],
            "severity": "Medium",
            "subcategory": "Pre-deployment",
            "text": "Network space for AVS NSX-T segments",
            "waf": "Reliability"
        },
        {
            "category": "Planning",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Choose AV36, AV36P, AV52, AV36T  (AV36T = Trial)",
            "guid": "946c8966-f902-6f53-4f37-00847e8895c2",
            "link": "https://azure.microsoft.com/pricing/details/azure-vmware/",
            "services": [
                "AVS"
            ],
            "severity": "Medium",
            "subcategory": "Pre-deployment",
            "text": "AVS SKU (region dependent)",
            "waf": "Performance"
        },
        {
            "category": "Planning",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Use the Azure migration assessment tool to determine the minimum number of nodes required (consider BCDR as well)",
            "guid": "31833808-26ba-9c31-416f-d54a89a17f5d",
            "link": "https://learn.microsoft.com/azure/migrate/how-to-assess",
            "services": [
                "AVS"
            ],
            "severity": "Medium",
            "subcategory": "Pre-deployment",
            "text": "Number of hosts to be deployed",
            "waf": "Performance"
        },
        {
            "category": "Planning",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Understand how and if you should be using reserved instances (cost control)",
            "guid": "f2b73c4f-3d46-32c9-5df1-5b8dfcd3947f",
            "link": "https://azure.microsoft.com/en-ca/pricing/details/azure-vmware/#:~:text=Azure%20VMware%20Solution%20%20%20%20Instance%20size,TB%20%28all%20NVMe%29%20%20%20N%2FA%20%2Fhour%20",
            "services": [
                "AVS",
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Pre-deployment",
            "text": "Reserverd Instances",
            "waf": "Cost"
        },
        {
            "category": "Planning",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Ensure that you have requested enough quota, ensuring you have considered growth and Disaster Recovery requirement",
            "guid": "94ac48ab-ade5-3fa7-f800-263feeb97070",
            "link": "https://docs.microsoft.com/azure/azure-vmware/concepts-storage#storage-policies-and-fault-tolerance",
            "services": [
                "AVS",
                "ASR"
            ],
            "severity": "Medium",
            "subcategory": "Pre-deployment",
            "text": "Capacity ",
            "waf": "Performance"
        },
        {
            "category": "Planning",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Identify which of the networking scenarios make ",
            "guid": "1f9d4bd5-14b8-928c-b4cb-eb211f9b8de5",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/azure-vmware/eslz-network-topology-connectivity",
            "services": [
                "AVS"
            ],
            "severity": "Medium",
            "subcategory": "Pre-deployment",
            "text": "Networking & Connectivity See docs describing scenrario  1 through 5",
            "waf": "Reliability"
        },
        {
            "category": "Planning",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Ensure that access constraints to ESXi are understood, there are access limits which might affect 3rd party solutions.",
            "guid": "070db19b-8a2a-fd6a-c39b-4488d8780da9",
            "link": "Please Check Partner Ecosystem",
            "services": [
                "AVS"
            ],
            "severity": "Medium",
            "subcategory": "Pre-deployment",
            "text": "3rd party application compatibility ",
            "waf": "Reliability"
        },
        {
            "category": "Security",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "When in-guest encryption is used, store encryption keys in Azure Key vault when possible",
            "guid": "70cfbddc-d3d4-9188-77c8-1cabaefef646",
            "link": "General recommendation for storing encryption keys.",
            "services": [
                "AVS",
                "AKV"
            ],
            "severity": "Medium",
            "subcategory": "Encryption",
            "text": "Use Azure Key Vault with in-guest encryption ",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Ensure workloads on Azure VMware Solution use sufficient data encryption during run-time (like in-guest disk encryption and SQL TDE). (vSAN encryption at rest is default)",
            "guid": "c1a81638-18df-0ce9-a73a-4b9a8a8dd392",
            "link": "https://docs.microsoft.com/azure/azure-vmware/concepts-storage#data-at-rest-encryption",
            "services": [
                "AVS",
                "SQL"
            ],
            "severity": "Medium",
            "subcategory": "Encryption",
            "text": "Use in-guest encryption",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Use Key vault to store secrets and authorization keys when separate Service Principles are used for deploying Azure VMware Solution and ExpressRoute",
            "guid": "8d0a8f51-8d35-19cd-c2fe-4e3512fb467e",
            "link": "https://docs.microsoft.com/azure/key-vault/general/authentication",
            "services": [
                "AVS",
                "AKV",
                "ExpressRoute"
            ],
            "severity": "Medium",
            "subcategory": "Encryption",
            "text": "Keyvault use for secrets",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Older OS security patching  configured for workloads running on Azure VMware Solution are eligible for ESU",
            "guid": "4f8b20e9-a2a1-f80f-af9b-8aa3b26dca08",
            "link": "https://docs.microsoft.com/windows-server/get-started/extended-security-updates-deploy",
            "services": [
                "AVS"
            ],
            "severity": "Medium",
            "subcategory": "Extended support",
            "text": "Ensure extended security update support ",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Use a SIEM/SOAR",
            "guid": "9bb22fec-4d00-3b95-7136-e225d0f5c63a",
            "link": "https://learn.microsoft.com/azure/sentinel/overview",
            "services": [
                "AVS",
                "Sentinel"
            ],
            "severity": "Medium",
            "subcategory": "Investigation",
            "text": "Enable Azure Sentinel or 3rd party SIEM ",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "MS Defender For Cloud,  for workloads running on Azure VMware Solution",
            "guid": "f42b0b09-c591-238a-1580-2de3c485ebd2",
            "link": "https://learn.microsoft.com/azure/azure-vmware/azure-security-integration#prerequisites",
            "services": [
                "AVS",
                "Defender"
            ],
            "severity": "Medium",
            "subcategory": "Security",
            "text": "Enable Advanced Threat Detection ",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Are the applicable policies enabled (compliance baselines added to MDfC)",
            "guid": "bcdd2348-3d0e-c6bb-1092-aa4cd1a66d6b",
            "link": "https://docs.microsoft.com/azure/azure-vmware/azure-security-integration",
            "services": [
                "AVS",
                "AzurePolicy"
            ],
            "severity": "Medium",
            "subcategory": "Security",
            "text": "Policy & Regulatory Compliance",
            "waf": "Security"
        },
        {
            "category": "VMware",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Azure to Azure (E/W), Azure to On-premises), AVS to Internet, AVS to Azure",
            "guid": "607c1ca9-da92-ae19-5a4c-eb1e876acbe7",
            "link": "https://techcommunity.microsoft.com/t5/azure-migration-and/firewall-integration-in-azure-vmware-solution/ba-p/2254961#:~:text=Azure%20VMware%20Solution%20customers%20have%20multiple%20security%20options,the%20box%20to%20provide%20East-West%20and%20North-South%20firewalling.",
            "services": [
                "AVS"
            ],
            "severity": "Medium",
            "subcategory": "Firewalls",
            "text": "Azure / 3rd party firewall",
            "waf": "Security"
        },
        {
            "category": "VMware",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "To allow HCX appliance to connect/sync",
            "guid": "1d87925c-c02b-7fde-a425-7e95ad846a27",
            "link": "https://docs.vmware.com/en/VMware-Cloud-on-AWS/services/com.vmware.vmc-aws-networking-security/GUID-2CFE1654-9CC9-4EDB-A625-21317299E559.html",
            "services": [
                "AVS"
            ],
            "severity": "Medium",
            "subcategory": "Firewalls",
            "text": "Firewalls allow for East/West traffic inside AVS",
            "waf": "Security"
        },
        {
            "category": "VMware",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Decision on which tool to use (SRM requires additional license - enables automation & other features)",
            "guid": "468b3495-2f6e-b65a-38ef-3ba631bcaa46",
            "link": "https://docs.vmware.com/en/VMware-HCX/4.2/hcx-user-guide/GUID-B842696B-89EF-4183-9C73-B77157F56055.html",
            "services": [
                "AVS"
            ],
            "severity": "Medium",
            "subcategory": "Networking",
            "text": "HCX and/or SRM",
            "waf": "Reliability"
        },
        {
            "category": "VMware",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Read up on requirements for Service Mesh requirements and how HCX ",
            "guid": "be2ced52-da08-d366-cf7c-044c19e29509",
            "link": "https://docs.vmware.com/en/VMware-HCX/4.6/hcx-user-guide/GUID-76BCD059-A31A-4041-9105-ACFB56213E7C.html",
            "services": [
                "AVS"
            ],
            "severity": "Medium",
            "subcategory": "Networking",
            "text": "Configuring and Managing the HCX Interconnect",
            "waf": "Reliability"
        },
        {
            "category": "VMware",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "If you are planning on using stretch networks ensure that your on-premises environment requirements",
            "guid": "7dcac579-fc5c-5c9c-f1f7-9b1149ff2c37",
            "link": "https://docs.vmware.com/en/VMware-HCX/4.2/hcx-user-guide/GUID-DBDB4D1B-60B6-4D16-936B-4AC632606909.html",
            "services": [
                "AVS"
            ],
            "severity": "Medium",
            "subcategory": "Networking",
            "text": "Restrictions and limitations for network extensions",
            "waf": "Performance"
        },
        {
            "category": "VMware",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Do workloads require MoN?",
            "guid": "cf45c0b9-6c4b-3bfb-86c5-62fe54061c73",
            "link": "https://learn.microsoft.com/azure/azure-vmware/vmware-hcx-mon-guidance",
            "services": [
                "AVS"
            ],
            "severity": "Medium",
            "subcategory": "Networking",
            "text": "Mobility optimized networking",
            "waf": "Performance"
        },
        {
            "category": "VMware",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Operating system level of Vmware environment",
            "guid": "b7cf11f3-b12e-5189-991a-06df5250d2ca",
            "link": "https://learn.microsoft.com/azure/site-recovery/vmware-physical-azure-support-matrix",
            "services": [
                "AVS"
            ],
            "severity": "Medium",
            "subcategory": "On-premises pre-requisites",
            "text": "Support matrix (OS versions etc).",
            "waf": "Operations"
        },
        {
            "category": "VMware",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Required that all switches are dynamic",
            "guid": "45fe9252-aa1b-4e30-45c6-bc02f3b76acf",
            "link": "https://docs.vmware.com/en/VMware-vSphere/7.0/vsan-network-design-guide/GUID-91E1CD6F-33A6-4AC6-BC22-3E4807296F86.html#:~:text=Migrate%20Management%20Network%201%20Add%20hosts%20to%20the,each%20host.%20...%204%20Finish%20the%20configuration.%20",
            "services": [
                "AVS"
            ],
            "severity": "Medium",
            "subcategory": "On-premises pre-requisites",
            "text": "Standard switches converted to dynamic switches",
            "waf": "Operations"
        },
        {
            "category": "VMware",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "See sections on sizing and capacity in the link.",
            "guid": "e9f6d736-ee44-e2ac-e7f9-e361f8c857f3",
            "link": "https://learn.microsoft.com/azure/azure-vmware/plan-private-cloud-deployment",
            "services": [
                "AVS"
            ],
            "severity": "Medium",
            "subcategory": "On-premises pre-requisites",
            "text": "Capacity for HCX appliance",
            "waf": "Performance"
        },
        {
            "category": "VMware",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Check hardware restrictions to ensure compatibility with AVS/OS ",
            "guid": "1be2cdd6-15a7-9a33-aea7-113859035ce9",
            "link": "https://kb.vmware.com/s/article/2007240#:~:text=ESXi%2FESX%20hosts%20and%20compatible%20virtual%20machine%20hardware%20versions,%20Not%20Supported%20%204%20more%20rows",
            "services": [
                "AVS"
            ],
            "severity": "Medium",
            "subcategory": "On-premises pre-requisites",
            "text": "Hardware compatibility",
            "waf": "Operations"
        },
        {
            "category": "VMware",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Need to be converted",
            "guid": "16ab821a-27c6-b6d3-6042-10dc4d6dfcb7",
            "link": "https://docs.vmware.com/en/VMware-vSphere/7.0/com.vmware.vsphere.storage.doc/GUID-01D3CF47-A84A-4988-8103-A0487D6441AA.html",
            "services": [
                "AVS",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Storage",
            "text": "VSAN RDM disks are converted - not supported.",
            "waf": "Operations"
        },
        {
            "category": "VMware",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Need to be converted",
            "guid": "eb2f9313-afb2-ab35-aa24-6d97a3cb0611",
            "link": "3rd-Party tools",
            "services": [
                "AVS",
                "VM",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Storage",
            "text": "VM with SCSI shared bus are not supported",
            "waf": "Operations"
        },
        {
            "category": "VMware",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Remove Direct IO before migration",
            "guid": "3f2a5cff-c8a6-634a-1f1b-53ef9d321381",
            "link": "Contact VMware",
            "services": [
                "AVS",
                "VM",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Storage",
            "text": "VM with Direct IO require removing DirectPath device",
            "waf": "Operations"
        },
        {
            "category": "VMware",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Cannot migrate clusters ",
            "guid": "efc8a311-74f8-0252-c6a0-4bac7610e266",
            "link": "Contact VMware",
            "services": [
                "AVS",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Storage",
            "text": "Shared VMDK files are not supported",
            "waf": "Operations"
        },
        {
            "category": "VMware",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Convert to a different format",
            "guid": "ab6c89cd-a26f-b894-fe59-61863975458e",
            "link": "Contact VMware",
            "services": [
                "AVS",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Storage",
            "text": "RDM with 'physical compatibility mode' are not supported.",
            "waf": "Operations"
        },
        {
            "category": "VMware",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Ensure the vSAN storage policy for VM's is NOT the default storage policy as this policy applies thick provisioning 'RAID-1 FTT-1' is default with Thin Provisioning",
            "guid": "7628d446-6b10-9678-9cec-f407d990de43",
            "link": "https://learn.microsoft.com/azure/azure-vmware/concepts-storage#storage-policies-and-fault-tolerance",
            "services": [
                "AVS",
                "AzurePolicy",
                "VM",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Storage",
            "text": "Default storage policy",
            "waf": "Operations"
        },
        {
            "category": "VMware",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "The default storage policy is set to RAID-1 (Mirroring) FTT-1, with Object Space Reservation set to Thin provisioning.",
            "guid": "37fef358-7ab9-43a9-542c-22673955200e",
            "link": "https://learn.microsoft.com/azure/azure-vmware/configure-storage-policy",
            "services": [
                "AVS",
                "AzurePolicy",
                "VM",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Storage",
            "text": "Ensure that the appropriate VM template storage policy is used",
            "waf": "Operations"
        },
        {
            "category": "VMware",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "Ensure that the Failure-to-tolerate policy is in place to meet your vSAN storage needs",
            "guid": "ebebd109-9f9d-d85e-1b2f-d302012843b7",
            "link": "https://learn.microsoft.com/azure/azure-vmware/concepts-storage#storage-policies-and-fault-tolerance",
            "services": [
                "AVS",
                "AzurePolicy",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Storage",
            "text": "Failure to tolerate policy",
            "waf": "Operations"
        },
        {
            "category": "VMware",
            "checklist": "Azure VMware Solution Implementation Checklist",
            "description": "ANF can be used to extend storage for Azure VMware Solution,",
            "guid": "1be821bd-4f37-216a-3e3d-2a5ac6996863",
            "link": "https://learn.microsoft.com/azure/azure-vmware/netapp-files-with-azure-vmware-solution",
            "services": [
                "AVS",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Storage",
            "text": "Use ANF for external storage",
            "waf": "Operations"
        },
        {
            "category": "Security",
            "checklist": "Azure Storage Review Checklist",
            "description": "Apply guidance from the Microsoft cloud security benchmark related to Storage",
            "guid": "d237de14-3b16-4c21-b7aa-9b64604489a8",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/storage-security-baseline",
            "service": "Azure Storage",
            "services": [
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": " Overview",
            "text": "Consider the 'Azure security baseline for storage'",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Storage Review Checklist",
            "description": "Azure Storage by default has a public IP address and is Internet-reachable. Private endpoints allow to securely expose Azure Storage only to those Azure Compute resources that need access, thus eliminating exposure to the public Internet",
            "graph": "resources | where type =~ 'Microsoft.Storage/StorageAccounts' | where isnull(properties.privateEndpointConnections) or properties.privateEndpointConnections[0].properties.provisioningState != ('Succeeded') or (isnull(properties.networkAcls) and properties.publicNetworkAccess == 'Enabled') | extend compliant = (isnotnull(properties.privateEndpointConnections) and properties.privateEndpointConnections[0].properties.provisioningState == 'Succeeded' and properties.publicNetworkAccess == 'Disabled') | distinct id, compliant",
            "guid": "f42d78e7-9d17-4a73-a22a-5a67e7a8ed4b",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-private-endpoints",
            "service": "Azure Storage",
            "services": [
                "PrivateLink",
                "Storage"
            ],
            "severity": "High",
            "subcategory": "Networking",
            "text": "Consider using private endpoints for Azure Storage",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Storage Review Checklist",
            "description": "Newly created storage accounts are created using the ARM deployment model, so that RBAC, auditing etc. are all enabled. Ensure that there are no old storage accounts with classic deployment model in a subscription",
            "guid": "30e37c3e-2971-41b2-963c-eee079b598de",
            "link": "https://learn.microsoft.com/azure/virtual-machines/migration-classic-resource-manager-overview#migration-of-storage-accounts",
            "service": "Azure Storage",
            "services": [
                "Subscriptions",
                "RBAC",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Governance",
            "text": "Ensure older storage accounts are not using 'classic deployment model'",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Storage Review Checklist",
            "description": "Leverage Microsoft Defender to learn about suspicious activity and misconfigurations.",
            "graph": "resources | where type =~ 'Microsoft.Storage/StorageAccounts' | project storageAccountId = id | join kind=leftouter (resourceContainers | where type == 'microsoft.security/pricings' | where name == 'StorageAccounts' | project resourceId = id, pricingTier = properties.pricingTier) on $left.storageAccountId == $right.resourceId | where isnull(pricingTier) or pricingTier != 'Standard' | extend compliant = false | distinct storageAccountId, compliant",
            "guid": "fc5972cd-4cd2-41b0-a803-7f5e6b4bfd3d",
            "link": "https://learn.microsoft.com/azure/storage/common/azure-defender-storage-configure",
            "service": "Azure Storage",
            "services": [
                "Storage",
                "Defender"
            ],
            "severity": "High",
            "subcategory": "Governance",
            "text": "Enable Microsoft Defender for all of your storage accounts",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Storage Review Checklist",
            "description": "The soft-delete mechanism allows to recover accidentally deleted blobs.",
            "guid": "503547c1-447e-4c66-828a-7100f1ce16dd",
            "link": "https://learn.microsoft.com/azure/storage/blobs/soft-delete-blob-overview",
            "service": "Azure Storage",
            "services": [
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Data Availability",
            "text": "Enable 'soft delete' for blobs",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Storage Review Checklist",
            "description": "Consider selectively disabling 'soft delete' for certain blob containers, for example if the application must ensure that deleted information is immediately deleted, e.g. for confidentiality, privacy or compliance reasons. ",
            "guid": "3f1d5e87-2e52-4e36-81cc-58b4a4b1510e",
            "link": "https://learn.microsoft.com/azure/storage/blobs/soft-delete-blob-enable",
            "service": "Azure Storage",
            "services": [
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Confidentiality",
            "text": "Disable 'soft delete' for blobs",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Storage Review Checklist",
            "description": "Soft delete for containers enables you to recover a container after it has been deleted, for example recover from an accidental delete operation.",
            "guid": "43a58a9c-2289-4c3d-9b57-d0c655462f2a",
            "link": "https://learn.microsoft.com/azure/storage/blobs/soft-delete-container-overview",
            "service": "Azure Storage",
            "services": [
                "Storage"
            ],
            "severity": "High",
            "subcategory": "Data Availability",
            "text": "Enable 'soft delete' for containers",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Storage Review Checklist",
            "description": "Consider selectively disabling 'soft delete' for certain blob containers, for example if the application must ensure that deleted information is immediately deleted, e.g. for confidentiality, privacy or compliance reasons. ",
            "guid": "3e3453a3-c863-4964-ab65-2d6c15f51296",
            "link": "https://learn.microsoft.com/azure/storage/blobs/soft-delete-container-enable",
            "service": "Azure Storage",
            "services": [
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Confidentiality",
            "text": "Disable 'soft delete' for containers",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Storage Review Checklist",
            "description": "Prevents accidental deletion of a storage account, by forcing the user to first remove the deletion lock, prior to deletion",
            "guid": "5398e6de-d227-4dd1-92b0-6c21d7999a64",
            "link": "https://learn.microsoft.com/azure/storage/common/lock-account-resource",
            "service": "Azure Storage",
            "services": [
                "Storage"
            ],
            "severity": "High",
            "subcategory": "Data Availability",
            "text": "Enable resource locks on storage accounts",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Storage Review Checklist",
            "description": "Consider 'legal hold' or 'time-based retention' policies for blobs, so that is is impossible to delete the blob, the container, or the storage account. Please note that 'impossible' actually means 'impossible'; once a storage account contains an immutable blob, the only way to 'get rid' of that storage account is by cancelling the Azure subscription.",
            "guid": "6f4389a8-f42c-478e-98c0-6a73a22a4956",
            "link": "https://learn.microsoft.com/azure/storage/blobs/immutable-storage-overview",
            "service": "Azure Storage",
            "services": [
                "AzurePolicy",
                "Subscriptions",
                "Storage"
            ],
            "severity": "High",
            "subcategory": "Data Availability, Compliance",
            "text": "Consider immutable blobs",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Storage Review Checklist",
            "description": "Consider disabling unprotected HTTP/80 access to the storage account, so that all data transfers are encrypted, integrity protected, and the server is authenticated. ",
            "graph": "resources | where type =~ 'Microsoft.Storage/StorageAccounts' | extend compliant = (properties.supportsHttpsTrafficOnly == false) | distinct id, compliant",
            "guid": "e7a8dc4a-20e2-47c3-b297-11b1352beee0",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-require-secure-transfer",
            "service": "Azure Storage",
            "services": [
                "Storage"
            ],
            "severity": "High",
            "subcategory": "Networking",
            "text": "Require HTTPS, i.e. disable port 80 on the storage account",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Storage Review Checklist",
            "description": "When configuring a custom domain (hostname) on a storage account, check whether you need TLS/HTTPS; if so, you might have to put Azure CDN in front of your storage account.",
            "guid": "79b588de-fc49-472c-b3cd-21bf77036e5e",
            "link": "https://learn.microsoft.com/azure/storage/blobs/storage-custom-domain-name",
            "service": "Azure Storage",
            "services": [
                "Storage"
            ],
            "severity": "High",
            "subcategory": "Networking",
            "text": "When enforcing HTTPS (disabling HTTP), check that you do not use custom domains (CNAME) for the storage account.",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Storage Review Checklist",
            "description": "Requiring HTTPS when a client uses a SAS token to access blob data helps to minimize the risk of credential loss.",
            "guid": "6b4bed3d-5035-447c-8347-dc56028a71ff",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-sas-overview",
            "service": "Azure Storage",
            "services": [
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Networking",
            "text": "Limit shared access signature (SAS) tokens to HTTPS connections only",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Storage Review Checklist",
            "description": ". Enforcing the latest TLS version will reject request from clients using the older version. ",
            "graph": "resources | where type == 'microsoft.storage/storageaccounts' | extend compliant = (isnull(properties.minimumTlsVersion) == false and properties.minimumTlsVersion in ('TLS1_2', 'TLS1_3')) | distinct id, compliant",
            "guid": "e12be569-a18f-4562-8d5d-ce151b9e7d55",
            "link": "https://learn.microsoft.com/azure/storage/common/transport-layer-security-configure-minimum-version",
            "service": "Azure Storage",
            "services": [
                "Storage"
            ],
            "severity": "High",
            "subcategory": "Networking",
            "text": "Enforce the latest TLS version for a storage account",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Storage Review Checklist",
            "description": "Microsoft Entra ID tokens should be favored over shared access signatures, wherever possible",
            "guid": "e1ce15dd-3f0d-45e7-92d4-1e3611cc57b4",
            "link": "https://learn.microsoft.com/azure/storage/common/authorize-data-access",
            "service": "Azure Storage",
            "services": [
                "Entra",
                "Storage"
            ],
            "severity": "High",
            "subcategory": "Identity and Access Management",
            "text": "Use Microsoft Entra ID tokens for blob access",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Storage Review Checklist",
            "description": "When assigning a role to a user, group, or application, grant that security principal only those permissions that are necessary for them to perform their tasks. Limiting access to resources helps prevent both unintentional and malicious misuse of your data.",
            "guid": "a4b1410d-4395-48a8-a228-9b3d6b57cfc6",
            "service": "Azure Storage",
            "services": [
                "Entra",
                "RBAC",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Identity and Access Management",
            "text": "Least privilege in IaM permissions",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Storage Review Checklist",
            "description": "A user delegation SAS is secured with Azure Active Directory (Azure AD) credentials and also by the permissions specified for the SAS. A user delegation SAS is analogous to a service SAS in terms of its scope and function, but offers security benefits over the service SAS. ",
            "guid": "55461e1a-3e34-453a-9c86-39648b652d6c",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-sas-overview?toc=%2Fazure%2Fstorage%2Fblobs%2Ftoc.json#best-practices-when-using-sas",
            "service": "Azure Storage",
            "services": [
                "Entra",
                "Storage"
            ],
            "severity": "High",
            "subcategory": "Identity and Access Management",
            "text": "When using SAS, prefer 'user delegation SAS' over storage-account-key based SAS.",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Storage Review Checklist",
            "description": "Storage account keys ('shared keys') have very little audit capabilities. While it can be monitored on who/when fetched a copy of the keys, once the keys are in the hands of multiple people, it is impossible to attribute usage to a specific user. Solely relying on Entra ID authentication makes it easier to tie storage access to a user. ",
            "graph": "resources | where type == 'microsoft.storage/storageaccounts' | extend allowSharedKeyAccess = tostring(properties.allowSharedKeyAccess) | extend compliant = (isnotempty(allowSharedKeyAccess) and allowSharedKeyAccess == 'false') | distinct id, compliant",
            "guid": "15f51296-5398-4e6d-bd22-7dd142b06c21",
            "link": "https://learn.microsoft.com/rest/api/storageservices/authorize-with-shared-key",
            "service": "Azure Storage",
            "services": [
                "AKV",
                "Monitor",
                "Entra",
                "Storage"
            ],
            "severity": "High",
            "subcategory": "Identity and Access Management",
            "text": "Consider disabling storage account keys, so that only Microsoft Entra ID access (and user delegation SAS) is supported.",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Storage Review Checklist",
            "description": "Use Activity Log data to identify 'when', 'who', 'what' and 'how' the security of your storage account is being viewed or changed (i.e. storage account keys, access policies, etc.).",
            "guid": "d7999a64-6f43-489a-af42-c78e78c06a73",
            "link": "https://learn.microsoft.com/azure/storage/blobs/blob-storage-monitoring-scenarios#audit-account-activity",
            "service": "Azure Storage",
            "services": [
                "AzurePolicy",
                "AKV",
                "Monitor",
                "Storage"
            ],
            "severity": "High",
            "subcategory": "Monitoring",
            "text": "Consider using Azure Monitor to audit control plane operations on the storage account",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Storage Review Checklist",
            "description": "A key expiration policy enables you to set a reminder for the rotation of the account access keys. The reminder is displayed if the specified interval has elapsed and the keys have not yet been rotated.",
            "guid": "a22a4956-e7a8-4dc4-a20e-27c3e29711b1",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-account-keys-manage?tabs=azure-portal#create-a-key-expiration-policy",
            "service": "Azure Storage",
            "services": [
                "AzurePolicy",
                "AKV",
                "Entra",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Identity and Access Management",
            "text": "When using storage account keys, consider enabling a 'key expiration policy'",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Storage Review Checklist",
            "description": "A SAS expiration policy specifies a recommended interval over which the SAS is valid. SAS expiration policies apply to a service SAS or an account SAS. When a user generates service SAS or an account SAS with a validity interval that is larger than the recommended interval, they'll see a warning.",
            "guid": "352beee0-79b5-488d-bfc4-972cd3cd21bf",
            "link": "https://learn.microsoft.com/azure/storage/common/sas-expiration-policy",
            "service": "Azure Storage",
            "services": [
                "AzurePolicy",
                "Entra",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Identity and Access Management",
            "text": "Consider configuring an SAS expiration policy",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Storage Review Checklist",
            "description": "Stored access policies give you the option to revoke permissions for a service SAS without having to regenerate the storage account keys. ",
            "guid": "77036e5e-6b4b-4ed3-b503-547c1347dc56",
            "link": "https://learn.microsoft.com/rest/api/storageservices/define-stored-access-policy",
            "service": "Azure Storage",
            "services": [
                "AzurePolicy",
                "Entra",
                "AKV",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Identity and Access Management",
            "text": "Consider linking SAS to a stored access policy",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Storage Review Checklist",
            "guid": "028a71ff-e1ce-415d-b3f0-d5e772d41e36",
            "link": "https://microsoft.github.io/code-with-engineering-playbook/continuous-integration/dev-sec-ops/secret-management/recipes/detect-secrets-ado/",
            "service": "Azure Storage",
            "services": [
                "AKV",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "CI/CD",
            "text": "Consider configuring your application's source code repository to detect checked-in connection strings and storage account keys.",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Storage Review Checklist",
            "description": "Ideally, your application should be using a managed identity to authenticate to Azure Storage. If that is not possible, consider having the storage credential (connection string, storage account key, SAS, service principal credential) in Azure KeyVault or an equivalent service.",
            "guid": "11cc57b4-a4b1-4410-b439-58a8c2289b3d",
            "link": "https://learn.microsoft.com/azure/architecture/framework/security/design-storage-keys",
            "service": "Azure Storage",
            "services": [
                "Entra",
                "Storage"
            ],
            "severity": "High",
            "subcategory": "Identity and Access Management",
            "text": "Consider storing connection strings in Azure KeyVault (in scenarios where managed identities are not possible)",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Storage Review Checklist",
            "description": "Use near-term expiration times on an ad hoc SAS service SAS or account SAS. In this way, even if a SAS is compromised, it's valid only for a short time. This practice is especially important if you cannot reference a stored access policy. Near-term expiration times also limit the amount of data that can be written to a blob by limiting the time available to upload to it.",
            "guid": "27138b82-1102-4cac-9eae-01e6e842e52f",
            "link": "https://learn.microsoft.com/rest/api/storageservices/delegate-access-with-shared-access-signature",
            "service": "Azure Storage",
            "services": [
                "AzurePolicy",
                "Entra",
                "Storage"
            ],
            "severity": "High",
            "subcategory": "Identity and Access Management",
            "text": "Strive for short validity periods for ad-hoc SAS",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Storage Review Checklist",
            "description": "When creating a SAS, be as specific and restrictive as possible. Prefer a SAS for a single resource and operation over a SAS which gives much broader access.",
            "guid": "4721d928-c1b1-4cd5-81e5-4a29a9de399c",
            "link": "https://learn.microsoft.com/rest/api/storageservices/delegate-access-with-shared-access-signature",
            "service": "Azure Storage",
            "services": [
                "Entra",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Identity and Access Management",
            "text": "Apply a narrow scope to a SAS",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Storage Review Checklist",
            "description": "A SAS can include parameters on which client IP addresses or address ranges are authorized to request a resource using the SAS. ",
            "guid": "fd7b28dc-9355-4562-82bf-e4564b0d834a",
            "link": "https://learn.microsoft.com/rest/api/storageservices/create-account-sas",
            "service": "Azure Storage",
            "services": [
                "Entra",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Identity and Access Management",
            "text": "Consider scoping SAS to a specific client IP address, wherever possible",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Storage Review Checklist",
            "description": "A SAS cannot constrain how much data a client uploads; given the pricing model of amount of storage over time, it might make sense to validate whether clients uploaded maliciously large contents.",
            "guid": "348b263e-6dd6-4051-8a36-498f6dbad38e",
            "service": "Azure Storage",
            "services": [
                "Entra",
                "Storage"
            ],
            "severity": "Low",
            "subcategory": "Identity and Access Management",
            "text": "Consider checking uploaded data, after clients used a SAS to upload a file. ",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Storage Review Checklist",
            "description": "When accessing blob storage via SFTP using a 'local user account', the 'usual' RBAC controls do not apply. Blob access via NFS or REST might be more restrictive than SFTP access. Unfortunately, as of early 2023, local users are the only form of identity management that is currently supported for the SFTP endpoint",
            "guid": "ad53cc7c-e1d7-4aaa-a357-1449ab8053d8",
            "link": "https://learn.microsoft.com/azure/storage/blobs/secure-file-transfer-protocol-support#sftp-permission-model",
            "service": "Azure Storage",
            "services": [
                "Entra",
                "RBAC",
                "Storage"
            ],
            "severity": "High",
            "subcategory": "Identity and Access Management",
            "text": "SFTP: Limit the amount of 'local users' for SFTP access, and audit whether access is needed over time.",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Storage Review Checklist",
            "guid": "9f89dc7b-33be-42a1-a27f-7b9e91be1f38",
            "link": "https://learn.microsoft.com/azure/storage/blobs/secure-file-transfer-protocol-known-issues#authentication-and-authorization",
            "service": "Azure Storage",
            "services": [
                "Entra",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Identity and Access Management",
            "text": "SFTP: The SFTP endpoint does not support POSIX-like ACLs.",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Storage Review Checklist",
            "description": "Storage supports CORS (Cross-Origin Resource Sharing), i.e. an HTTP feature that enables web apps from a different domain to loosen the same-origin policy. When enabling CORS, keep the CorsRules to the least privilege.",
            "guid": "cef39812-bd46-43cb-aac8-ac199ebb91a3",
            "link": "https://learn.microsoft.com/rest/api/storageservices/cross-origin-resource-sharing--cors--support-for-the-azure-storage-services",
            "service": "Azure Storage",
            "services": [
                "AzurePolicy",
                "Storage"
            ],
            "severity": "High",
            "subcategory": "Networking",
            "text": "Avoid overly broad CORS policies",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Storage Review Checklist",
            "description": "Data at rest is always encrypted server-side, and in addition might be encrypted client-side as well. Server-side encryption might happen using a platform-managed key (default) or customer-managed key. Client-side encryption might happen by either having the client supply an encryption/decryption key on a per-blob basis to Azure storage, or by completely handling encryption on the client-side. thus not relying on Azure Storage at all for confidentiality guarantees.",
            "guid": "3d90cae2-cc88-4137-86f7-c0cbafe61464",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-service-encryption",
            "service": "Azure Storage",
            "services": [
                "Storage"
            ],
            "severity": "High",
            "subcategory": "Confidentiality and Encryption",
            "text": "Determine how data at rest should be encrypted. Understand the thread model for data.",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Storage Review Checklist",
            "guid": "8dd457e9-2713-48b8-8110-2cac6eae01e6",
            "link": "https://learn.microsoft.com/azure/storage/common/customer-managed-keys-overview?toc=%2Fazure%2Fstorage%2Fblobs%2Ftoc.json&bc=%2Fazure%2Fstorage%2Fblobs%2Fbreadcrumb%2Ftoc.json",
            "service": "Azure Storage",
            "services": [
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Confidentiality and Encryption",
            "text": "Determine which/if platform encryption should be used.",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Storage Review Checklist",
            "guid": "e842e52f-4721-4d92-ac1b-1cd521e54a29",
            "link": "https://learn.microsoft.com/azure/storage/blobs/encryption-customer-provided-keys",
            "service": "Azure Storage",
            "services": [
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Confidentiality and Encryption",
            "text": "Determine which/if client-side encryption should be used.",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Storage Review Checklist",
            "description": "Anonymous access may present a security risk. We recommend that you disable anonymous access for optimal security. Disallowing anonymous access helps to prevent data breaches caused by undesired anonymous access.",
            "graph": "resources | where type == 'microsoft.storage/storageaccounts' | extend compliant = (properties.allowBlobPublicAccess == 'false') | distinct id, compliant",
            "guid": "659ae558-b937-4d49-a5e1-112dbd7ba012",
            "link": "https://learn.microsoft.com/azure/storage/blobs/anonymous-read-access-configure?tabs=portal#allow-or-disallow-public-read-access-for-a-storage-account",
            "service": "Azure Storage",
            "services": [
                "Entra",
                "Storage"
            ],
            "severity": "High",
            "subcategory": "Identity and Access Management",
            "text": "Consider whether public blob anonymous access is needed, or whether it can be disabled for certain storage accounts. ",
            "waf": "Security"
        },
        {
            "category": "Operations Management",
            "checklist": "Azure Storage Review Checklist",
            "guid": "cb8eb8c0-aa62-4a25-a495-6eaa8dc4a243",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-account-upgrade?tabs=azure-portal",
            "service": "Azure Storage",
            "services": [
                "Storage"
            ],
            "severity": "High",
            "subcategory": "Platform Version",
            "text": "Leverage a storagev2 account type for better performance and reliability",
            "waf": "Reliability"
        },
        {
            "category": "BC and DR",
            "checklist": "Azure Storage Review Checklist",
            "graph": "resources | where type =~ 'Microsoft.Storage/StorageAccounts' | extend compliant = (sku.name != 'Standard_LRS' and sku.name != 'Premium_LRS') | distinct id, compliant",
            "guid": "e05bbe20-9d49-4fda-9777-8424d116785c",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-redundancy",
            "service": "Azure Storage",
            "services": [
                "Storage"
            ],
            "severity": "High",
            "subcategory": "Availablity",
            "text": "Leverage GRS, ZRS or GZRS storage for the highest availability",
            "waf": "Reliability"
        },
        {
            "category": "BC and DR",
            "checklist": "Azure Storage Review Checklist",
            "guid": "2fa56c56-ad48-4408-be72-734c486ba280",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-disaster-recovery-guidance",
            "service": "Azure Storage",
            "services": [
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Failover",
            "text": "For write operation after failover, use customer-Managed Failover ",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Azure Storage Review Checklist",
            "guid": "dc0590cf-65de-48e1-909c-cbd579266bcc",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-disaster-recovery-guidance#microsoft-managed-failover",
            "service": "Azure Storage",
            "services": [
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Failover",
            "text": "Understand Microsoft-Managed Failover details",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Azure Storage Review Checklist",
            "guid": "a274faa1-abfe-49d5-9d04-c3c4919cb1b3",
            "link": "https://learn.microsoft.com/azure/storage/blobs/soft-delete-blob-enable?tabs=azure-portal",
            "service": "Azure Storage",
            "services": [
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Data Protection",
            "text": "Enable Soft Delete",
            "waf": "Reliability"
        },
        {
            "category": "Operations management",
            "checklist": "Azure Bot Service",
            "guid": "6ad48408-ee72-4734-a476-ba28fdcf590c",
            "link": "https://learn.microsoft.com/en-us/azure/reliability/reliability-bot",
            "service": "Bot service",
            "services": [],
            "severity": "Medium",
            "subcategory": "High Availablity",
            "text": "Follow reliability support recommendations in Azure Bot Service",
            "waf": "Reliability"
        },
        {
            "category": "Operations management",
            "checklist": "Azure Bot Service",
            "guid": "e65de8e1-3f9c-4cbd-9682-66abca264f9a",
            "link": "https://learn.microsoft.com/en-us/azure/bot-service/bot-builder-concept-regionalization",
            "service": "Bot service",
            "services": [],
            "severity": "Medium",
            "subcategory": "High Availablity",
            "text": "Deploying bots with local data residency and regional compliance",
            "waf": "Reliability"
        },
        {
            "category": "Operations management",
            "checklist": "Azure Bot Service",
            "guid": "19bfe9d5-5d04-4c3c-9919-ca1b2d1215ae",
            "link": "https://learn.microsoft.com/en-us/azure/reliability/reliability-bot#cross-region-disaster-recovery-in-multi-region-geography",
            "service": "Bot service",
            "services": [],
            "severity": "Medium",
            "subcategory": "High Availablity",
            "text": "Azure Bot Service runs in active-active mode for both global and regional services. When an outage occurs, you don't need to detect errors or manage the service. Azure Bot Service automatically performs auto failover and auto recovery in a multi-region geographical architecture. For the EU bot regional service, Azure Bot Service provides two full regions inside Europe with active/active replication to ensure redundancy. For the global bot service, all available regions/geographies can be served as the global footprint.",
            "waf": "Reliability"
        },
        {
            "category": "Business",
            "checklist": "Multitenant architecture",
            "guid": "41177955-fe8f-430b-ae72-20dc5b6880da",
            "link": "https://learn.microsoft.com/azure/architecture/guide/multitenant/overview",
            "services": [
                "Entra"
            ],
            "severity": "High",
            "subcategory": "Business",
            "text": "Understand what kind of solution you're creating, such as business-to-business (B2B), business-to-consumer (B2C), or your enterprise software, and how tenants are different from users.",
            "waf": "Operations"
        },
        {
            "category": "Business",
            "checklist": "Multitenant architecture",
            "guid": "2d33d1b7-697c-49f9-b944-afbeac0b2c8f",
            "link": "https://learn.microsoft.com/azure/architecture/guide/multitenant/considerations/tenancy-models",
            "services": [],
            "severity": "High",
            "subcategory": "Business",
            "text": "Define your tenants. Understand how many tenants you will support initially, and your growth plans.",
            "waf": "Operations"
        },
        {
            "category": "Business",
            "checklist": "Multitenant architecture",
            "guid": "a2111b8b-cc66-4aa2-9da6-c09fa23851b6",
            "link": "https://learn.microsoft.com/azure/architecture/guide/multitenant/considerations/pricing-models",
            "services": [],
            "severity": "High",
            "subcategory": "Business",
            "text": "Define your pricing model and ensure it aligns with your tenants' consumption of Azure resources.",
            "waf": "Cost"
        },
        {
            "category": "Business",
            "checklist": "Multitenant architecture",
            "guid": "331e84a6-2d65-4359-92ff-a1870b062995",
            "link": "https://learn.microsoft.com/azure/architecture/guide/multitenant/considerations/pricing-models",
            "services": [],
            "severity": "Medium",
            "subcategory": "Business",
            "text": "Understand whether you need to separate your tenants into different tiers. Tiers might have different pricing, features, performance promises, geographic locations, and so forth.",
            "waf": "Operations"
        },
        {
            "category": "Business",
            "checklist": "Multitenant architecture",
            "guid": "90516b37-aab1-46ca-95bb-cc14a6a1608b",
            "link": "https://learn.microsoft.com/azure/architecture/guide/multitenant/considerations/tenancy-models",
            "services": [],
            "severity": "Medium",
            "subcategory": "Business",
            "text": "Based on your customers' requirements, decide on the tenancy models that are appropriate for various parts of your solution.",
            "waf": "Operations"
        },
        {
            "category": "Business",
            "checklist": "Multitenant architecture",
            "guid": "f5d76ae1-7048-4ff5-abba-f1ca799578b9",
            "link": "https://learn.microsoft.com/azure/marketplace/plan-saas-offer",
            "services": [
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Business",
            "text": "When you're ready, sell your B2B multitenant solution using the Microsoft Commercial Marketplace.",
            "waf": "Operations"
        },
        {
            "category": "Reliability",
            "checklist": "Multitenant architecture",
            "guid": "9e7cedd9-1e05-4aeb-a7b3-01fe695a394c",
            "link": "https://learn.microsoft.com/azure/architecture/framework/resiliency/design-checklist",
            "services": [],
            "severity": "High",
            "subcategory": "Reliability",
            "text": "Review the Azure Well-Architected Reliability checklist, which is applicable to all workloads.",
            "waf": "Reliability"
        },
        {
            "category": "Reliability",
            "checklist": "Multitenant architecture",
            "guid": "e9521a55-2a7c-425c-8f3e-c38fd0c4df75",
            "link": "https://learn.microsoft.com/azure/architecture/antipatterns/noisy-neighbor/noisy-neighbor",
            "services": [],
            "severity": "High",
            "subcategory": "Reliability",
            "text": "Understand the Noisy Neighbor antipattern. Prevent individual tenants from impacting the system's availability for other tenants.",
            "waf": "Reliability"
        },
        {
            "category": "Reliability",
            "checklist": "Multitenant architecture",
            "guid": "2b99cb00-9abb-49b6-b11c-f2af9692f09e",
            "link": "https://learn.microsoft.com/azure/architecture/guide/multitenant/approaches/overview",
            "services": [],
            "severity": "Medium",
            "subcategory": "Reliability",
            "text": "Design your multitenant solution for the level of growth that you expect. But don't overengineer for unrealistic growth.",
            "waf": "Reliability"
        },
        {
            "category": "Reliability",
            "checklist": "Multitenant architecture",
            "guid": "7a634a0e-1c9d-42b1-aac2-5a5378f103f1",
            "link": "https://learn.microsoft.com/azure/architecture/framework/resiliency/business-metrics",
            "services": [],
            "severity": "Medium",
            "subcategory": "Reliability",
            "text": "Define service-level objectives (SLOs) and optionally service-level agreements (SLAs) for your solution. SLAs and SLOs should be based on the requirements of your tenants, as well as the composite SLA of the Azure resources in your architecture.",
            "waf": "Reliability"
        },
        {
            "category": "Reliability",
            "checklist": "Multitenant architecture",
            "guid": "45beeeaf-fc59-4079-8fca-65d5724abaa7",
            "link": "https://learn.microsoft.com/azure/architecture/guide/multitenant/approaches/compute",
            "services": [],
            "severity": "High",
            "subcategory": "Reliability",
            "text": "Test the scale of your solution. Ensure that it performs well under all levels of load, and that it scales correctly as the number of tenants increases.",
            "waf": "Reliability"
        },
        {
            "category": "Reliability",
            "checklist": "Multitenant architecture",
            "guid": "2ff55551-984b-4606-95eb-bfb9c8b36761",
            "link": "https://learn.microsoft.com/azure/architecture/guide/multitenant/approaches/compute",
            "services": [],
            "severity": "Medium",
            "subcategory": "Reliability",
            "text": "Apply chaos engineering principles to test the reliability of your solution.",
            "waf": "Reliability"
        },
        {
            "category": "Security",
            "checklist": "Multitenant architecture",
            "guid": "8238c038-8eb2-4a02-8bd5-4908c9442c1c",
            "link": "https://learn.microsoft.com/security/zero-trust",
            "services": [],
            "severity": "High",
            "subcategory": "Security",
            "text": "Apply the Zero Trust and least privilege principles in all layers of your solution.",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Multitenant architecture",
            "guid": "92160e00-6894-4102-97e0-615d4ed93c01",
            "link": "https://learn.microsoft.com/azure/architecture/guide/multitenant/considerations/map-requests",
            "services": [
                "Entra"
            ],
            "severity": "High",
            "subcategory": "Security",
            "text": "Ensure that you can correctly map user requests to tenants. Consider including the tenant context as part of the identity system, or by using another means, like application-level tenant authorization.",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Multitenant architecture",
            "guid": "3c1538b4-5676-4b85-b451-432befb37b4f",
            "link": "https://learn.microsoft.com/azure/security/fundamentals/pen-testing",
            "services": [],
            "severity": "Medium",
            "subcategory": "Security",
            "text": "Perform ongoing penetration testing and security code reviews.",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Multitenant architecture",
            "guid": "5fca45ce-cf2d-42c0-a62c-aac92ba31498",
            "link": "https://learn.microsoft.com/azure/architecture/guide/multitenant/approaches/governance-compliance",
            "services": [],
            "severity": "High",
            "subcategory": "Security",
            "text": "Understand your tenants' compliance requirements, including data residency and any compliance or regulatory standards that they require you to meet.",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Multitenant architecture",
            "guid": "30adb90d-83d4-4a2e-986e-327ffe04e7a5",
            "link": "https://learn.microsoft.com/azure/architecture/guide/multitenant/considerations/domain-names",
            "services": [
                "DNS"
            ],
            "severity": "High",
            "subcategory": "Security",
            "text": "Correctly manage domain names and avoid vulnerabilities like dangling DNS and subdomain takeover attacks.",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Multitenant architecture",
            "guid": "72ded36d-c633-4e0d-bd41-799a29da3481",
            "link": "https://learn.microsoft.com/azure/architecture/guide/multitenant/service/overview",
            "services": [],
            "severity": "Medium",
            "subcategory": "Security",
            "text": "Follow service-specific guidance for multitenancy.",
            "waf": "Security"
        },
        {
            "category": "Cost Optimization",
            "checklist": "Multitenant architecture",
            "guid": "db30a9fc-9b1d-40f3-ab90-01f6a3e87fc8",
            "link": "https://learn.microsoft.com/azure/architecture/framework/cost/design-checklist",
            "services": [
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Cost Optimization",
            "text": "Review the Azure Well-Architected Operational Excellence checklist, which is applicable to all workloads.",
            "waf": "Cost"
        },
        {
            "category": "Cost Optimization",
            "checklist": "Multitenant architecture",
            "guid": "8533af39-52f6-45b6-a9c3-81b2a54a31e0",
            "link": "https://learn.microsoft.com/azure/architecture/guide/multitenant/considerations/measure-consumption",
            "services": [
                "Cost"
            ],
            "severity": "High",
            "subcategory": "Cost Optimization",
            "text": "Ensure you can adequately measure per-tenant consumption and correlate it with your infrastructure costs.",
            "waf": "Cost"
        },
        {
            "category": "Cost Optimization",
            "checklist": "Multitenant architecture",
            "guid": "c851fd44-7cf1-459c-95a4-f6455d75a981",
            "link": "https://learn.microsoft.com/azure/architecture/guide/multitenant/approaches/cost-management-allocation",
            "services": [
                "Monitor",
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Cost Optimization",
            "text": "Avoid antipatterns. Antipatterns include failing to track costs, tracking costs with unnecessary precision, real-time measurement, and using monitoring tools for billing.",
            "waf": "Cost"
        },
        {
            "category": "Operational Excellence",
            "checklist": "Multitenant architecture",
            "guid": "0d475a5a-2c0f-47ab-b1e1-701da68d3407",
            "link": "https://learn.microsoft.com/azure/architecture/checklist/data-ops",
            "services": [],
            "severity": "High",
            "subcategory": "Operational Excellence",
            "text": "Review the Azure Well-Architected Operational Excellence checklist, which is applicable to all workloads.",
            "waf": "Operations"
        },
        {
            "category": "Operational Excellence",
            "checklist": "Multitenant architecture",
            "guid": "9f7fa7a9-47fc-4f04-81f6-9f9e87571ed3",
            "link": "https://learn.microsoft.com/azure/architecture/guide/multitenant/considerations/tenant-lifecycle",
            "services": [],
            "severity": "Medium",
            "subcategory": "Operational Excellence",
            "text": "Use automation to manage the tenant lifecycle, such as onboarding, deployment, provisioning, and configuration.",
            "waf": "Operations"
        },
        {
            "category": "Operational Excellence",
            "checklist": "Multitenant architecture",
            "guid": "e0bfceed-4f4e-492d-b9f5-898815faa363",
            "link": "https://learn.microsoft.com/azure/architecture/guide/multitenant/considerations/updates",
            "services": [],
            "severity": "Medium",
            "subcategory": "Operational Excellence",
            "text": "Find the right balance for deploying service updates. Consider both your tenants' requirements and your own operational requirements.",
            "waf": "Operations"
        },
        {
            "category": "Operational Excellence",
            "checklist": "Multitenant architecture",
            "guid": "a3f80518-d428-4c02-b2cc-dfaef47db7e2",
            "services": [
                "Monitor"
            ],
            "severity": "High",
            "subcategory": "Operational Excellence",
            "text": "Monitor the health of the overall system, as well as each tenant.",
            "waf": "Operations"
        },
        {
            "category": "Operational Excellence",
            "checklist": "Multitenant architecture",
            "guid": "dfb42da5-f871-4953-9e5c-da6fda3f1411",
            "services": [
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Operational Excellence",
            "text": "Configure and test alerts to notify you when specific tenants are experiencing issues or are exceeding their consumption limits.",
            "waf": "Operations"
        },
        {
            "category": "Operational Excellence",
            "checklist": "Multitenant architecture",
            "guid": "c0c72a1b-e34d-4b3d-b808-2e49f51ce47e",
            "link": "https://learn.microsoft.com/azure/architecture/guide/multitenant/approaches/resource-organization",
            "services": [],
            "severity": "High",
            "subcategory": "Operational Excellence",
            "text": "Organize your Azure resources for isolation and scale.",
            "waf": "Operations"
        },
        {
            "category": "Operational Excellence",
            "checklist": "Multitenant architecture",
            "guid": "c5c5e22d-4b51-4cac-a980-f7aac1a4b427",
            "link": "https://learn.microsoft.com/azure/architecture/guide/multitenant/approaches/deployment-configuration",
            "services": [],
            "severity": "Medium",
            "subcategory": "Operational Excellence",
            "text": "Avoid deployment and configuration antipatterns. Antipatterns include running separate versions of the solution for each tenant, hardcoding tenant-specific configurations or logic, and manual deployments.",
            "waf": "Operations"
        },
        {
            "category": "Performance Efficiency",
            "checklist": "Multitenant architecture",
            "guid": "f0b1fbd8-689c-4ab3-be1d-ad7607d2fbfd",
            "link": "https://learn.microsoft.com/azure/architecture/framework/scalability/performance-efficiency",
            "services": [],
            "severity": "High",
            "subcategory": "Performance Efficiency",
            "text": "Review the Azure Well-Architected Performance Efficiency checklist, which is applicable to all workloads.",
            "waf": "Performance"
        },
        {
            "category": "Performance Efficiency",
            "checklist": "Multitenant architecture",
            "guid": "18911c4c-934c-49a8-839a-60c092afce30",
            "link": "https://learn.microsoft.com/azure/architecture/antipatterns/noisy-neighbor/noisy-neighbor",
            "services": [],
            "severity": "High",
            "subcategory": "Performance Efficiency",
            "text": "If you use shared infrastructure, plan for how you'll mitigate Noisy Neighbor concerns. Ensure that one tenant can't reduce the performance of the system for other tenants.",
            "waf": "Performance"
        },
        {
            "category": "Performance Efficiency",
            "checklist": "Multitenant architecture",
            "guid": "6acf7eb5-24a3-47c7-ae87-1196cd96048e",
            "link": "https://learn.microsoft.com/azure/architecture/guide/multitenant/approaches/compute",
            "services": [
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Performance Efficiency",
            "text": "Determine how you'll scale your compute, storage, networking, and other Azure resources to match the demands of your tenants.",
            "waf": "Performance"
        },
        {
            "category": "Performance Efficiency",
            "checklist": "Multitenant architecture",
            "guid": "ea55400d-f97d-45aa-b71b-34224bf91ed4",
            "link": "https://learn.microsoft.com/azure/architecture/guide/multitenant/approaches/resource-organization",
            "services": [],
            "severity": "High",
            "subcategory": "Performance Efficiency",
            "text": "Consider each Azure resource's scale limits. Organize your resources appropriately, in order to avoid resource organization antipatterns. For example, don't over-architect your solution to work within unrealistic scale requirements.",
            "waf": "Performance"
        },
        {
            "category": "Application Deployment",
            "checklist": "Azure Spring Apps Review",
            "guid": "6d8e32a8-3892-479d-a40b-10f6b4f6f298",
            "link": "https://learn.microsoft.com/azure/spring-apps/concepts-blue-green-deployment-strategies",
            "service": "Spring Apps",
            "services": [],
            "severity": "Medium",
            "subcategory": "DevOps",
            "text": "Azure Spring Apps permits two deployments for every app, only one of which receives production traffic. You can achieve zero downtime with blue green deployment strategies. Blue green deployment is only available in Standard and Enterprise tiers. You could automate deployment using CI/CD with ADO/GitHub actions",
            "waf": "Reliability"
        },
        {
            "category": "BC and DR",
            "checklist": "Azure Spring Apps Review",
            "guid": "fbcb40ac-9480-4a6d-bcf4-8081252a6716",
            "link": "https://learn.microsoft.com/azure/architecture/web-apps/spring-apps/architectures/spring-apps-multi-region",
            "service": "Spring Apps",
            "services": [
                "FrontDoor",
                "TrafficManager",
                "ASR"
            ],
            "severity": "Medium",
            "subcategory": "Disaster Recovery",
            "text": "Azure Spring Apps instances could be created in multiple regions for your applications and traffic could be routed by Traffic Manager/Front Door.",
            "waf": "Reliability"
        },
        {
            "category": "BC and DR",
            "checklist": "Azure Spring Apps Review",
            "guid": "ff1ae6a7-9301-4feb-9d11-56cd72f1d4ef",
            "link": "https://learn.microsoft.com/azure/reliability/reliability-spring-apps",
            "service": "Spring Apps",
            "services": [
                "ACR"
            ],
            "severity": "Medium",
            "subcategory": "High Availability",
            "text": "In supported region, Azure Spring Apps can be deployed as zone redundant, which means that instances are automatically distributed across availability zones. This feature is only available in Standard and Enterprise tiers.",
            "waf": "Reliability"
        },
        {
            "category": "BC and DR",
            "checklist": "Azure Spring Apps Review",
            "guid": "ffc735ad-fbb1-4802-b43f-ad6387c4c066",
            "link": "https://learn.microsoft.com/azure/spring-apps/concept-understand-app-and-deployment",
            "service": "Spring Apps",
            "services": [],
            "severity": "Medium",
            "subcategory": "High Availability",
            "text": "Use more than 1 app instance for your apps",
            "waf": "Reliability"
        },
        {
            "category": "Operations",
            "checklist": "Azure Spring Apps Review",
            "guid": "7504c230-6035-4183-95a5-85762acc6075",
            "link": "https://learn.microsoft.com/azure/spring-apps/diagnostic-services",
            "service": "Spring Apps",
            "services": [
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Monitoring",
            "text": "Monitor Azure Spring Apps with logs, metrics and tracing. Integrate ASA with application insights and track failures and create workbooks.",
            "waf": "Reliability"
        },
        {
            "category": "Operations",
            "checklist": "Azure Spring Apps Review",
            "guid": "1eb48d58-3eec-4ef5-80b0-d2b0dde3f0c6",
            "link": "https://learn.microsoft.com/azure/spring-apps/how-to-configure-enterprise-spring-cloud-gateway",
            "service": "Spring Apps",
            "services": [],
            "severity": "Medium",
            "subcategory": "Scalability",
            "text": "Set up autoscaling in Spring Cloud Gateway",
            "waf": "Reliability"
        },
        {
            "category": "Operations",
            "checklist": "Azure Spring Apps Review",
            "guid": "97411607-b6fd-4335-99d1-9885faf4e392",
            "link": "https://learn.microsoft.com/azure/spring-apps/how-to-setup-autoscale",
            "service": "Spring Apps",
            "services": [],
            "severity": "Low",
            "subcategory": "Scalability",
            "text": "Enable autoscale for the apps with Standard consumption & dedicated plan.",
            "waf": "Reliability"
        },
        {
            "category": "Operations",
            "checklist": "Azure Spring Apps Review",
            "guid": "dfcaffd1-d27c-4ef2-998d-64c1df3a7ac3",
            "link": "https://learn.microsoft.com/azure/spring-apps/overview",
            "service": "Spring Apps",
            "services": [],
            "severity": "Medium",
            "subcategory": "Support",
            "text": "Use Enterprise plan for commercial support of spring boot for mission critical apps. With other tiers you get OSS support.",
            "waf": "Reliability"
        },
        {
            "category": "BC and DR",
            "checklist": "Device Update Review",
            "guid": "0e03f5ee-4648-423c-bb86-7239480f9171",
            "link": "https://learn.microsoft.com/en-us/azure/iot-dps/iot-dps-ha-dr#high-availability",
            "service": "Device Update for IoT Hub",
            "services": [],
            "severity": "High",
            "subcategory": "High Availability",
            "text": "Leverage Availability Zones if regionally applicable (this is automatically enabled).",
            "waf": "Reliability"
        },
        {
            "category": "BC and DR",
            "checklist": "Device Update Review",
            "guid": "c0c273bd-00ad-419a-9f2f-fc72fb181e55",
            "link": "https://learn.microsoft.com/en-us/azure/iot-dps/iot-dps-ha-dr#high-availability",
            "service": "Device Update for IoT Hub",
            "services": [],
            "severity": "High",
            "subcategory": "High Availability",
            "text": "Be aware of Microsoft-initiated failovers. These are exercised by Microsoft in rare situations to fail over all the DPS instances from an affected region to the corresponding geo-paired region.",
            "waf": "Reliability"
        },
        {
            "category": "BC and DR",
            "checklist": "Device Update Review",
            "guid": "3af8abe6-07eb-4287-b393-6c4abe3702eb",
            "link": "https://learn.microsoft.com/en-us/azure/logic-apps/business-continuity-disaster-recovery-guidance?toc=%2Fazure%2Freliability%2Ftoc.json&bc=%2Fazure%2Freliability%2Fbreadcrumb%2Ftoc.json",
            "service": "Device Update for IoT Hub",
            "services": [],
            "severity": "High",
            "subcategory": "High Availability",
            "text": "Consider a Cross-Region DR strategy for critical workloads",
            "waf": "Reliability"
        },
        {
            "category": "BC and DR",
            "checklist": "Device Update Review",
            "guid": "bd91245c-fe32-4e98-a085-794a40f4bfe1",
            "link": "https://learn.microsoft.com/en-us/azure/app-service/environment/intro",
            "service": "Device Update for IoT Hub",
            "services": [
                "AppSvc"
            ],
            "severity": "High",
            "subcategory": "High Availability",
            "text": "If deploying to an Isolated environment, use or migrate to App Service Environment (ASE) v3",
            "waf": "Reliability"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "guid": "7bc1c396-2461-4698-b57f-30ca69525252",
            "link": "https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/ready/considerations/regions",
            "service": "VNet",
            "services": [
                "ASR"
            ],
            "severity": "Medium",
            "subcategory": "Hub and spoke",
            "text": "Deploy your Azure landing zone connectivity resources in multiple regions, so that you can quickly support multi-region application landing zones and disaster recovery scenarios.",
            "training": "https://learn.microsoft.com/training/modules/hub-and-spoke-network-architecture/",
            "waf": "Reliability"
        },
        {
            "category": "Azure Billing and Microsoft Entra ID Tenants",
            "checklist": "Azure Landing Zone Review",
            "guid": "70c15989-c726-42c7-b0d3-24b7375b9201",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/multi-tenant/considerations-recommendations",
            "service": "Entra",
            "services": [
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Microsoft Entra ID Tenants",
            "text": "Use one Entra tenant for managing your Azure resources, unless you have a clear regulatory or business requirement for multi-tenants.",
            "training": "https://learn.microsoft.com/training/modules/deploy-resources-scopes-bicep/2-understand-deployment-scopes",
            "waf": "Operations"
        },
        {
            "category": "Azure Billing and Microsoft Entra ID Tenants",
            "checklist": "Azure Landing Zone Review",
            "guid": "6309957b-821a-43d1-b9d9-7fcf1802b747",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/multi-tenant/automation",
            "service": "Entra",
            "services": [
                "Entra"
            ],
            "severity": "Low",
            "subcategory": "Microsoft Entra ID Tenants",
            "text": "Use Multi-Tenant Automation approach to managing your Microsoft Entra ID Tenants.",
            "training": "https://learn.microsoft.com/entra/architecture/multi-tenant-user-management-introduction/",
            "waf": "Operations"
        },
        {
            "category": "Azure Billing and Microsoft Entra ID Tenants",
            "checklist": "Azure Landing Zone Review",
            "guid": "78e11934-499a-45ed-8ef7-aae5578f0ecf",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/multi-tenant/lighthouse",
            "service": "Entra",
            "services": [
                "Entra"
            ],
            "severity": "High",
            "subcategory": "Microsoft Entra ID Tenants",
            "text": "Use Azure Lighthouse for Multi-Tenant Management with the same IDs.",
            "training": "https://learn.microsoft.com/azure/lighthouse/concepts/cross-tenant-management-experience",
            "waf": "Operations"
        },
        {
            "category": "Azure Billing and Microsoft Entra ID Tenants",
            "checklist": "Azure Landing Zone Review",
            "guid": "5d82e6df-6f61-42f2-82e2-3132d293be3d",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-microsoft-customer-agreement#design-recommendations",
            "service": "Entra",
            "services": [
                "Entra"
            ],
            "severity": "High",
            "subcategory": "Cloud Solution Provider",
            "text": "If you give a partner access to administer your tenant, use Azure Lighthouse.",
            "training": "https://learn.microsoft.com/azure/lighthouse/how-to/onboard-customer",
            "waf": "Cost"
        },
        {
            "category": "Azure Billing and Microsoft Entra ID Tenants",
            "checklist": "Azure Landing Zone Review",
            "guid": "a24d0de3-d4b9-4dfb-8ddd-bbfaf123fa01",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-cloud-solution-provider#design-recommendations",
            "services": [
                "Entra"
            ],
            "severity": "Low",
            "subcategory": "Cloud Solution Provider",
            "text": "If you have a CSP partner, define and document your support request and escalation process.",
            "waf": "Cost"
        },
        {
            "category": "Azure Billing and Microsoft Entra ID Tenants",
            "checklist": "Azure Landing Zone Review",
            "guid": "32952499-58c8-4e6f-ada5-972e67893d55",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-microsoft-customer-agreement#design-recommendations",
            "services": [
                "Entra",
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Cloud Solution Provider",
            "text": "Setup Cost Reporting and Views with Azure Cost Management.",
            "training": "https://learn.microsoft.com/training/modules/analyze-costs-create-budgets-azure-cost-management/",
            "waf": "Cost"
        },
        {
            "category": "Azure Billing and Microsoft Entra ID Tenants",
            "checklist": "Azure Landing Zone Review",
            "guid": "685cb4f2-ac9c-4b19-9167-993ed0b32415",
            "link": "https://learn.microsoft.com/azure/cost-management-billing/manage/direct-ea-administration#manage-notification-contacts",
            "services": [
                "Entra",
                "LoadBalancer"
            ],
            "severity": "Medium",
            "subcategory": "Enterprise Agreement",
            "text": "Configure Notification Contacts to a group mailbox.",
            "waf": "Cost"
        },
        {
            "category": "Azure Billing and Microsoft Entra ID Tenants",
            "checklist": "Azure Landing Zone Review",
            "guid": "12cd499f-96e2-4e41-a243-231fb3245a1c",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-enterprise-agreement#design-considerations",
            "services": [
                "Entra",
                "TrafficManager"
            ],
            "severity": "Low",
            "subcategory": "Enterprise Agreement",
            "text": "Use departments and accounts to map your organization's structure to your enrollment hierarchy which can help with separating billing.",
            "training": "https://learn.microsoft.com/azure/cost-management-billing/manage/understand-ea-roles",
            "waf": "Cost"
        },
        {
            "category": "Azure Billing and Microsoft Entra ID Tenants",
            "checklist": "Azure Landing Zone Review",
            "guid": "ca0fe401-12ad-46fc-8a7e-86293866a9f6",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-enterprise-agreement#design-recommendations",
            "services": [
                "Entra",
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Enterprise Agreement",
            "text": "Enable both DA View Charges and AO View Charges on your EA Enrollments to allow users with the correct perms review Cost and Billing Data.",
            "training": "https://learn.microsoft.com/azure/cost-management-billing/costs/assign-access-acm-data#enable-access-to-costs-in-the-azure-portal",
            "waf": "Security"
        },
        {
            "category": "Azure Billing and Microsoft Entra ID Tenants",
            "checklist": "Azure Landing Zone Review",
            "guid": "5cf9f485-2784-49b3-9824-75d9b8bdb57b",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-enterprise-agreement#design-considerations",
            "services": [
                "Subscriptions",
                "Cost",
                "Entra"
            ],
            "severity": "Low",
            "subcategory": "Enterprise Agreement",
            "text": "Use of Enterprise Dev/Test Subscriptions to reduce costs for non-production workloads.",
            "training": "https://learn.microsoft.com/azure/devtest/offer/how-to-manage-monitor-devtest",
            "waf": "Cost"
        },
        {
            "category": "Azure Billing and Microsoft Entra ID Tenants",
            "checklist": "Azure Landing Zone Review",
            "guid": "6ad5c3dd-e5ea-4ff1-81a4-7886ff87845c",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-microsoft-customer-agreement#design-recommendations",
            "services": [
                "Entra"
            ],
            "severity": "Low",
            "subcategory": "Microsoft Customer Agreement",
            "text": "Configure Agreement billing account notification contact email.",
            "training": "https://learn.microsoft.com/azure/cost-management-billing/manage/mca-setup-account",
            "waf": "Cost"
        },
        {
            "category": "Azure Billing and Microsoft Entra ID Tenants",
            "checklist": "Azure Landing Zone Review",
            "guid": "90e87802-602f-4dfb-acea-67c60689f1d7",
            "link": "https://learn.microsoft.com/azure/cost-management-billing/manage/mca-section-invoice",
            "services": [
                "Entra",
                "Cost",
                "Storage"
            ],
            "severity": "Low",
            "subcategory": "Microsoft Customer Agreement",
            "text": "Use Billing Profiles and Invoice sections to structure your agreements billing for effective cost management.",
            "training": "https://learn.microsoft.com/azure/cost-management-billing/understand/mca-overview#billing-profiles",
            "waf": "Cost"
        },
        {
            "category": "Azure Billing and Microsoft Entra ID Tenants",
            "checklist": "Azure Landing Zone Review",
            "guid": "e81a73f0-84c4-4641-b406-14db3b4d1f50",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-microsoft-customer-agreement#design-recommendations",
            "services": [
                "Entra",
                "Cost"
            ],
            "severity": "Low",
            "subcategory": "Microsoft Customer Agreement",
            "text": "Make use of Microsoft Azure plan for dev/test offer to reduce costs for non-production workloads.",
            "training": "https://learn.microsoft.com/azure/devtest/offer/overview-what-is-devtest-offer-visual-studio",
            "waf": "Cost"
        },
        {
            "category": "Azure Billing and Microsoft Entra ID Tenants",
            "checklist": "Azure Landing Zone Review",
            "guid": "ae757485-92a4-482a-8bc9-eefe6f5b5ec3",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-microsoft-customer-agreement#design-recommendations",
            "services": [
                "RBAC",
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Microsoft Customer Agreement",
            "text": "Define and document a process to periodically audit the agreement billing RBAC role assignments to review who has access to your MCA billing account.",
            "training": "https://learn.microsoft.com/azure/cost-management-billing/manage/understand-mca-roles",
            "waf": "Cost"
        },
        {
            "category": "Identity and Access Management",
            "checklist": "Azure Landing Zone Review",
            "guid": "348ef254-c27d-442e-abba-c7571559ab91",
            "link": "https://learn.microsoft.com/azure/role-based-access-control/overview",
            "service": "Entra",
            "services": [
                "Subscriptions",
                "ACR",
                "RBAC",
                "Entra"
            ],
            "severity": "High",
            "subcategory": "Identity",
            "text": "Enforce a RBAC model that aligns to your cloud operating model. Scope and Assign across Management Groups and Subscriptions.",
            "training": "https://learn.microsoft.com/learn/paths/implement-resource-mgmt-security/",
            "waf": "Security"
        },
        {
            "category": "Identity and Access Management",
            "checklist": "Azure Landing Zone Review",
            "guid": "4348bf81-7573-4512-8f46-9061cc198fea",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/identity-access-landing-zones#identity-and-access-management-in-the-azure-landing-zone-accelerator",
            "services": [
                "Entra"
            ],
            "severity": "High",
            "subcategory": "Microsoft Entra ID and Hybrid Identity",
            "text": "Use managed identities instead of service principals for authentication to Azure services. You can check for existing service principals via Entra ID > Sign in Logs > Service principal logins.",
            "training": "https://learn.microsoft.com/azure/active-directory/managed-identities-azure-resources/overview",
            "waf": "Security"
        },
        {
            "category": "Identity and Access Management",
            "checklist": "Azure Landing Zone Review",
            "guid": "12e7f983-f630-4472-8dd6-9c5b5c2622f5",
            "link": "https://learn.microsoft.com/azure/active-directory/roles/security-planning#identify-microsoft-accounts-in-administrative-roles-that-need-to-be-switched-to-work-or-school-accounts",
            "service": "Entra",
            "services": [
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Identity",
            "text": "Only use the authentication type Work or school account for all account types. Avoid using the Microsoft account",
            "training": "https://learn.microsoft.com/learn/modules/explore-basic-services-identity-types/",
            "waf": "Security"
        },
        {
            "category": "Identity and Access Management",
            "checklist": "Azure Landing Zone Review",
            "guid": "4b69bad3-3aad-45e8-a68e-1d76667313b4",
            "link": "https://learn.microsoft.com/azure/active-directory/fundamentals/active-directory-groups-create-azure-portal",
            "service": "Entra",
            "services": [
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Identity",
            "text": "Only use groups to assign permissions. Add on-premises groups to the Entra ID only group if a group management system is already in place.",
            "training": "https://learn.microsoft.com/learn/paths/manage-identity-and-access/",
            "waf": "Security"
        },
        {
            "category": "Identity and Access Management",
            "checklist": "Azure Landing Zone Review",
            "guid": "53e8908a-e28c-484c-93b6-b7808b9fe5c4",
            "link": "https://learn.microsoft.com/azure/active-directory/conditional-access/overview",
            "service": "Entra",
            "services": [
                "AzurePolicy",
                "Entra"
            ],
            "severity": "High",
            "subcategory": "Identity",
            "text": "Enforce Microsoft Entra ID Conditional Access policies for any user with rights to Azure environments.",
            "training": "https://learn.microsoft.com/learn/modules/plan-implement-administer-conditional-access/",
            "waf": "Security"
        },
        {
            "category": "Identity and Access Management",
            "checklist": "Azure Landing Zone Review",
            "guid": "1049d403-a923-4c34-94d0-0018ac6a9e01",
            "link": "https://learn.microsoft.com/azure/active-directory/authentication/concept-mfa-howitworks",
            "service": "Entra",
            "services": [
                "Entra"
            ],
            "severity": "High",
            "subcategory": "Identity",
            "text": "Enforce multi-factor authentication for any user with rights to the Azure environments.",
            "training": "https://learn.microsoft.com/entra/identity/authentication/concept-mandatory-multifactor-authentication",
            "waf": "Security"
        },
        {
            "category": "Identity and Access Management",
            "checklist": "Azure Landing Zone Review",
            "guid": "e6a83de5-de32-4c19-a248-1607d5d1e4e6",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/manage/centralize-operations",
            "services": [
                "Entra",
                "RBAC"
            ],
            "severity": "High",
            "subcategory": "Identity",
            "text": "Enforce centralized and delegated responsibilities to manage resources deployed inside the landing zone, based on role and security requirements.",
            "training": "https://learn.microsoft.com/learn/paths/azure-administrator-manage-identities-governance/",
            "waf": "Security"
        },
        {
            "category": "Identity and Access Management",
            "checklist": "Azure Landing Zone Review",
            "guid": "14658d35-58fd-4772-99b8-21112df27ee4",
            "link": "https://learn.microsoft.com/azure/active-directory/privileged-identity-management/pim-configure",
            "service": "Entra",
            "services": [
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Identity",
            "text": "Enforce Microsoft Entra ID Privileged Identity Management (PIM) to establish zero standing access and least privilege.",
            "training": "https://learn.microsoft.com/learn/modules/azure-ad-privileged-identity-management/",
            "waf": "Security"
        },
        {
            "category": "Identity and Access Management",
            "checklist": "Azure Landing Zone Review",
            "guid": "1559ab91-53e8-4908-ae28-c84c33b6b780",
            "link": "https://learn.microsoft.com/azure/architecture/reference-architectures/identity/adds-extend-domain#vm-recommendations",
            "services": [
                "Entra",
                "ACR",
                "VM"
            ],
            "severity": "High",
            "subcategory": "Identity",
            "text": "When deploying Active Directory Domain Controllers, use a location with Availability Zones and deploy at least two VMs across these zones. If not available, deploy in an Availability Set.",
            "training": "https://learn.microsoft.com/learn/modules/azure-active-directory/",
            "waf": "Reliability"
        },
        {
            "category": "Identity and Access Management",
            "checklist": "Azure Landing Zone Review",
            "guid": "e8aa1e41-870d-4968-94c6-77be14f510ac",
            "link": "https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/ready/considerations/regions#identity",
            "services": [
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Identity",
            "text": "Deploy your Azure landing zone identity resources in multiple regions.  If using domain controllers, associate each region with an Active Directory site so that resources can resolve to their local domain controllers.",
            "training": "https://learn.microsoft.com/learn/modules/azure-active-directory/",
            "waf": "Reliability"
        },
        {
            "category": "Identity and Access Management",
            "checklist": "Azure Landing Zone Review",
            "guid": "f5664b5e-984a-4859-a773-e7d261623a76",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/identity-access#prerequisites-for-a-landing-zone---design-recommendations",
            "services": [
                "Subscriptions",
                "ACR",
                "RBAC",
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Identity",
            "text": "Use Azure custom RBAC roles for the following key roles to provide fine-grain access across your ALZ: Azure platform owner, network management, security operations, subscription owner, application owner. Align these roles to teams and responsibilities within your business.",
            "training": "https://learn.microsoft.com/learn/modules/create-custom-azure-roles-with-rbac/",
            "waf": "Security"
        },
        {
            "category": "Identity and Access Management",
            "checklist": "Azure Landing Zone Review",
            "guid": "8b9fe5c4-1049-4d40-9a92-3c3474d00018",
            "link": "https://learn.microsoft.com/entra/identity/domain-services/overview",
            "service": "Entra",
            "services": [
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Identity",
            "text": "If planning to switch from Active Directory Domain Services to Entra domain services, evaluate the compatibility of all workloads.",
            "training": "https://learn.microsoft.com/learn/modules/implement-hybrid-identity-windows-server/",
            "waf": "Security"
        },
        {
            "category": "Identity and Access Management",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type == 'microsoft.aad/domainservices' | extend replicaSets = properties.replicaSets | where array_length(replicaSets) < 2 | project name=name, id=id, tags=tags, param1=strcat('replicaSetLocation:', replicaSets[0].location)",
            "guid": "0dd4e625-9c4b-4a56-b54a-4357bac12761",
            "link": "https://learn.microsoft.com/entra/identity/domain-services/overview",
            "service": "Entra",
            "services": [
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Identity",
            "text": "When using Microsoft Entra Domain Services use replica sets. Replica sets will improve the resiliency of your managed domain and allow you to deploy to additional regions. ",
            "training": "https://learn.microsoft.com/training/modules/understand-azure-active-directory/6-examine-azure-domain-services",
            "waf": "Reliability"
        },
        {
            "category": "Identity and Access Management",
            "checklist": "Azure Landing Zone Review",
            "guid": "1cf0b8da-70bd-44d0-94af-8d99cfc89ae1",
            "link": "https://learn.microsoft.com/azure/active-directory/reports-monitoring/concept-activity-logs-azure-monitor",
            "service": "Entra",
            "services": [
                "Entra",
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Identity",
            "text": "Integrate Microsoft Entra ID logs with the platform-central Azure Monitor. Azure Monitor allows for a single source of truth around log and monitoring data in Azure, giving organizations a cloud native options to meet requirements around log collection and retention.",
            "training": "https://learn.microsoft.com/entra/identity/monitoring-health/howto-integrate-activity-logs-with-azure-monitor-logs",
            "waf": "Security"
        },
        {
            "ammp": true,
            "category": "Identity and Access Management",
            "checklist": "Azure Landing Zone Review",
            "guid": "984a859c-773e-47d2-9162-3a765a917e1f",
            "link": "https://learn.microsoft.com/azure/active-directory/roles/security-emergency-access",
            "service": "Entra",
            "services": [
                "Entra"
            ],
            "severity": "High",
            "subcategory": "Identity",
            "text": "Implement an emergency access or break-glass accounts to prevent tenant-wide account lockout. MFA will be turned on by default for all users in Oct 2024. We recommend updating these accounts to use passkey (FIDO2) or configure certificate-based authentication for MFA. ",
            "training": "https://learn.microsoft.com/entra/identity/role-based-access-control/security-emergency-access#exclude-at-least-one-account-from-conditional-access-policies",
            "waf": "Security"
        },
        {
            "category": "Identity and Access Management",
            "checklist": "Azure Landing Zone Review",
            "guid": "cd163e39-84a5-4b39-97b7-6973abd70d94",
            "link": "https://learn.microsoft.com/azure/active-directory/hybrid/how-to-connect-sync-staging-server",
            "services": [
                "Entra",
                "ASR"
            ],
            "severity": "Medium",
            "subcategory": "Microsoft Entra ID",
            "text": "When deploying Microsoft Entra Connect, use a staging sever for high availability/disaster recovery.",
            "training": "https://learn.microsoft.com/entra/identity/hybrid/connect/plan-connect-topologies",
            "waf": "Reliability"
        },
        {
            "category": "Identity and Access Management",
            "checklist": "Azure Landing Zone Review",
            "guid": "35037e68-9349-4c15-b371-228514f4cdff",
            "link": "https://learn.microsoft.com/azure/active-directory/roles/best-practices",
            "service": "Entra",
            "services": [
                "Entra",
                "RBAC"
            ],
            "severity": "Medium",
            "subcategory": "Identity",
            "text": "Do not use on-premises synced accounts for Microsoft Entra ID role assignments, unless you have a scenario that specifically requires it.",
            "training": "https://learn.microsoft.com/learn/modules/design-identity-security-strategy/",
            "waf": "Security"
        },
        {
            "category": "Identity and Access Management",
            "checklist": "Azure Landing Zone Review",
            "guid": "d5d1e4e6-1465-48d3-958f-d77249b82111",
            "link": "https://learn.microsoft.com/azure/active-directory/app-proxy/application-proxy",
            "service": "Entra",
            "services": [
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Identity",
            "text": "When using Microsoft Entra ID Application Proxy to give remote users access to applications, manage it as a Platform resource as you can only have one instance per tenant.",
            "training": "https://learn.microsoft.com/learn/paths/implement-applications-external-access-azure-ad/",
            "waf": "Security"
        },
        {
            "category": "Identity and Access Management",
            "checklist": "Azure Landing Zone Review",
            "guid": "9cf5418b-1520-4b7b-add7-88eb28f833e8",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/identity-access-landing-zones#identity-and-access-management-in-the-azure-landing-zone-accelerator",
            "services": [
                "VNet",
                "Entra"
            ],
            "severity": "High",
            "subcategory": "Landing zones",
            "text": "Configure Identity network segmentation through the use of a virtual Network and peer back to the hub. Providing authentication inside application landing zone (legacy).",
            "training": "https://learn.microsoft.com/azure/architecture/example-scenario/identity/adds-extend-domain",
            "waf": "Security"
        },
        {
            "category": "Identity and Access Management",
            "checklist": "Azure Landing Zone Review",
            "guid": "d4d1ad54-1abc-4919-b267-3f342d3b49e4",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/identity-access-landing-zones#rbac-recommendations",
            "services": [
                "AKV",
                "RBAC",
                "Entra",
                "ACR",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Landing zones",
            "text": "Use Azure RBAC to manage data plane access to resources, if possible. E.g. Data Operations across Key Vault, Storage Account and Database Services.",
            "training": "https://learn.microsoft.com/azure/role-based-access-control/overview",
            "waf": "Security"
        },
        {
            "category": "Identity and Access Management",
            "checklist": "Azure Landing Zone Review",
            "guid": "d505ebcb-79b1-4274-9c0d-a27c8bea489c",
            "link": "https://learn.microsoft.com/azure/active-directory/privileged-identity-management/pim-create-roles-and-resource-roles-review",
            "services": [
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Landing zones",
            "text": "Use Microsoft Entra ID PIM access reviews to periodically validate resource entitlements.",
            "training": "https://learn.microsoft.com/entra/id-governance/privileged-identity-management/pim-perform-roles-and-resource-roles-review",
            "waf": "Security"
        },
        {
            "category": "Resource Organization",
            "checklist": "Azure Landing Zone Review",
            "description": "Consider using the Azure naming tool available at https://aka.ms/azurenamingtool",
            "guid": "cacf55bc-e4e4-46be-96bc-57a5f23a269a",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/resource-naming",
            "services": [],
            "severity": "High",
            "subcategory": "Naming and tagging",
            "text": "Use a well defined naming scheme for resources, such as Microsoft Best Practice Naming Standards.",
            "waf": "Security"
        },
        {
            "category": "Resource Organization",
            "checklist": "Azure Landing Zone Review",
            "graph": "resourcecontainers| where type == 'microsoft.resources/subscriptions'| extend ManagementGroup = tostring(tags),mgmtChain = properties.managementGroupAncestorsChain| extend compliant =( array_length(mgmtChain) <= 4 and array_length(mgmtChain) > 1)",
            "guid": "2df27ee4-12e7-4f98-9f63-04722dd69c5b",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/resource-org-management-groups",
            "services": [
                "Subscriptions"
            ],
            "severity": "Medium",
            "subcategory": "Subscriptions",
            "text": "Enforce reasonably flat management group hierarchy with no more than four levels.",
            "training": "https://learn.microsoft.com/learn/modules/azure-architecture-fundamentals/",
            "waf": "Security"
        },
        {
            "category": "Resource Organization",
            "checklist": "Azure Landing Zone Review",
            "guid": "667313b4-f566-44b5-b984-a859c773e7d2",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/resource-org-management-groups#management-group-recommendations",
            "services": [
                "Subscriptions"
            ],
            "severity": "Medium",
            "subcategory": "Subscriptions",
            "text": "Enforce a sandbox management group to allow users to immediately experiment with Azure.",
            "training": "https://learn.microsoft.com/learn/paths/enterprise-scale-architecture/",
            "waf": "Security"
        },
        {
            "category": "Resource Organization",
            "checklist": "Azure Landing Zone Review",
            "guid": "61623a76-5a91-47e1-b348-ef254c27d42e",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/resource-org-management-groups#management-group-recommendations",
            "services": [
                "AzurePolicy",
                "Subscriptions",
                "RBAC"
            ],
            "severity": "Medium",
            "subcategory": "Subscriptions",
            "text": "Enforce a platform management group under the root management group to support common platform policy and Azure role assignment.",
            "training": "https://learn.microsoft.com/learn/paths/enterprise-scale-architecture/",
            "waf": "Security"
        },
        {
            "category": "Resource Organization",
            "checklist": "Azure Landing Zone Review",
            "guid": "8bbac757-1559-4ab9-853e-8908ae28c84c",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/resource-org-management-groups#management-group-recommendations",
            "services": [
                "DNS",
                "Subscriptions",
                "ExpressRoute",
                "VWAN"
            ],
            "severity": "Medium",
            "subcategory": "Subscriptions",
            "text": "Enforce a dedicated connectivity subscription in the Connectivity management group to host an Azure Virtual WAN hub, private non-AD Domain Name System (DNS), ExpressRoute circuit, and other networking resources.",
            "training": "https://learn.microsoft.com/learn/paths/enterprise-scale-architecture/",
            "waf": "Security"
        },
        {
            "category": "Resource Organization",
            "checklist": "Azure Landing Zone Review",
            "graph": "resourcecontainers| where type == 'microsoft.resources/subscriptions'| extend ManagementGroup = tostring(tags),mgmtChain = properties.managementGroupAncestorsChain| extend compliant = (array_length(mgmtChain) > 1)",
            "guid": "33b6b780-8b9f-4e5c-9104-9d403a923c34",
            "link": "https://learn.microsoft.com/azure/governance/management-groups/how-to/protect-resource-hierarchy#setting---default-management-group",
            "services": [
                "Subscriptions"
            ],
            "severity": "Medium",
            "subcategory": "Subscriptions",
            "text": "Enforce no subscriptions are placed under the root management group.",
            "training": "https://learn.microsoft.com/azure/governance/management-groups/overview",
            "waf": "Security"
        },
        {
            "category": "Resource Organization",
            "checklist": "Azure Landing Zone Review",
            "guid": "74d00018-ac6a-49e0-8e6a-83de5de32c19",
            "link": "https://learn.microsoft.com/azure/governance/management-groups/how-to/protect-resource-hierarchy#setting---require-authorization",
            "services": [
                "Subscriptions",
                "RBAC"
            ],
            "severity": "Medium",
            "subcategory": "Subscriptions",
            "text": "Enforce that only privileged users can operate management groups in the tenant by enabling Azure RBAC authorization in the management group hierarchy settings.",
            "training": "https://learn.microsoft.com/training/modules/configure-role-based-access-control/",
            "waf": "Security"
        },
        {
            "category": "Resource Organization",
            "checklist": "Azure Landing Zone Review",
            "guid": "92481607-d5d1-4e4e-9146-58d3558fd772",
            "link": "https://learn.microsoft.com/azure/governance/management-groups/overview",
            "services": [
                "Subscriptions"
            ],
            "severity": "Medium",
            "subcategory": "Subscriptions",
            "text": "Enforce management groups under the root-level management group to represent the types of workloads, based on their security, compliance, connectivity, and feature needs.",
            "waf": "Security"
        },
        {
            "category": "Resource Organization",
            "checklist": "Azure Landing Zone Review",
            "guid": "49b82111-2df2-47ee-912e-7f983f630472",
            "link": "https://learn.microsoft.com/entra/id-governance/access-reviews-overview",
            "services": [
                "AzurePolicy",
                "RBAC",
                "Subscriptions",
                "Cost"
            ],
            "severity": "High",
            "subcategory": "Subscriptions",
            "text": "Enforce a process to make resource owners aware of their roles and responsibilities, access review, budget review, policy compliance and remediate when necessary.",
            "training": "https://learn.microsoft.com/training/modules/plan-implement-manage-access-review/",
            "waf": "Security"
        },
        {
            "category": "Resource Organization",
            "checklist": "Azure Landing Zone Review",
            "guid": "2dd69c5b-5c26-422f-94b6-9bad33aad5e8",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits",
            "services": [
                "Subscriptions"
            ],
            "severity": "Medium",
            "subcategory": "Subscriptions",
            "text": "Ensure that all subscription owners and IT core team are aware of subscription quotas and the impact they have on provision resources for a given subscription.",
            "training": "https://learn.microsoft.com/training/modules/configure-subscriptions/",
            "waf": "Security"
        },
        {
            "category": "Resource Organization",
            "checklist": "Azure Landing Zone Review",
            "guid": "c68e1d76-6673-413b-9f56-64b5e984a859",
            "link": "https://learn.microsoft.com/azure/cost-management-billing/reservations/save-compute-costs-reservations",
            "services": [
                "Subscriptions",
                "Cost"
            ],
            "severity": "High",
            "subcategory": "Subscriptions",
            "text": "Use Reserved Instances where appropriate to optimize cost and ensure available capacity in target regions.",
            "training": "https://learn.microsoft.com/learn/paths/improve-reliability-modern-operations/",
            "waf": "Security"
        },
        {
            "ammp": true,
            "category": "Resource Organization",
            "checklist": "Azure Landing Zone Review",
            "guid": "c773e7d2-6162-43a7-95a9-17e1f348ef25",
            "link": "https://learn.microsoft.com/azure/azure-portal/azure-portal-dashboards",
            "services": [
                "Subscriptions",
                "Monitor",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Subscriptions",
            "text": "Establish dashboards and/or visualizations to monitor compute and storage capacity metrics. (i.e. CPU, memory, disk space)",
            "training": "https://learn.microsoft.com/training/modules/visualize-data-workbooks/",
            "waf": "Security"
        },
        {
            "category": "Resource Organization",
            "checklist": "Azure Landing Zone Review",
            "guid": "ae28c84c-33b6-4b78-88b9-fe5c41049d40",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/get-started/manage-costs",
            "services": [
                "Subscriptions",
                "Cost"
            ],
            "severity": "High",
            "subcategory": "Subscriptions",
            "text": "As part of your cloud adoption, implement a detailed cost management plan using the 'Managed cloud costs' process.",
            "training": "https://learn.microsoft.com/learn/paths/control-spending-manage-bills/",
            "waf": "Security"
        },
        {
            "category": "Resource Organization",
            "checklist": "Azure Landing Zone Review",
            "guid": "3a923c34-74d0-4001-aac6-a9e01e6a83de",
            "link": "https://learn.microsoft.com/azure/governance/management-groups/overview",
            "services": [
                "Entra",
                "Subscriptions"
            ],
            "severity": "Medium",
            "subcategory": "Subscriptions",
            "text": "If servers will be used for Identity services, like domain controllers, establish a dedicated identity subscription in the identity management group, to host these services. Make sure that resources are set to use the domain controllers available in their region.",
            "training": "https://learn.microsoft.com/learn/paths/enterprise-scale-architecture/",
            "waf": "Security"
        },
        {
            "category": "Resource Organization",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | extend compliant = isnotnull(['tags']) | project name, id, subscriptionId, resourceGroup, tags, compliant",
            "guid": "5de32c19-9248-4160-9d5d-1e4e614658d3",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/track-costs",
            "services": [
                "Subscriptions",
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Subscriptions",
            "text": "Ensure tags are used for billing and cost management.",
            "training": "https://learn.microsoft.com/learn/paths/implement-resource-mgmt-security/",
            "waf": "Security"
        },
        {
            "category": "Resource Organization",
            "checklist": "Azure Landing Zone Review",
            "guid": "6cc0ea22-42bb-441e-a345-804ab0a09666",
            "link": "https://github.com/Azure/sovereign-landing-zone/blob/main/docs/02-Architecture.md",
            "services": [
                "Subscriptions"
            ],
            "severity": "Medium",
            "subcategory": "Subscriptions",
            "text": "For Sovereign Landing Zone, have a 'confidential corp' and 'confidential online' management group directly under the 'landing zones' MG.",
            "training": "https://learn.microsoft.com/industry/sovereignty/slz-overview",
            "waf": "Security"
        },
        {
            "category": "Resource Organization",
            "checklist": "Azure Landing Zone Review",
            "guid": "250d81ce-8bbe-4f85-9051-6a18a8221e50",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-setup-guide/regions",
            "services": [
                "Cost"
            ],
            "severity": "High",
            "subcategory": "Regions",
            "text": "Select the right Azure region/s for your deployment. Azure is a global-scale cloud platform that provide global coverage through many regions and geographies. Different Azure regions have different characteristics, access and availability models, costs, capacity, and services offered, then it is important to consider all criteria and requirements.",
            "training": "https://learn.microsoft.com/learn/modules/azure-architecture-fundamentals/",
            "waf": "Reliability"
        },
        {
            "category": "Resource Organization",
            "checklist": "Azure Landing Zone Review",
            "guid": "19ca3f89-397d-44b1-b5b6-5e18661372ac",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-setup-guide/regions#operate-in-multiple-geographic-regions",
            "services": [
                "ASR"
            ],
            "severity": "Medium",
            "subcategory": "Regions",
            "text": "Deploy your Azure landing zone in a multi-region deployment. Depending on customer size, locations, and users presence, operating in multiple regions can be a common choice to deliver services and run applications closer to them. Using a multi-region deployment is also important to provide geo disaster recovery capabilities, to eliminate the dependency from a single region capacity and diminish the risk of a temporary and localized resource capacity constraint.",
            "training": "https://learn.microsoft.com/learn/modules/azure-architecture-fundamentals/",
            "waf": "Reliability"
        },
        {
            "category": "Resource Organization",
            "checklist": "Azure Landing Zone Review",
            "guid": "4c27d42e-8bba-4c75-9155-9ab9153e8908",
            "link": "https://azure.microsoft.com/explore/global-infrastructure/products-by-region/",
            "services": [],
            "severity": "Medium",
            "subcategory": "Regions",
            "text": "Ensure required services and features are available within the chosen deployment regions.",
            "training": "https://learn.microsoft.com/learn/modules/azure-architecture-fundamentals/",
            "waf": "Reliability"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "guid": "373f482f-3e39-4d39-8aa4-7e566f6082b6",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-app-delivery",
            "services": [
                "FrontDoor",
                "AppGW"
            ],
            "severity": "Medium",
            "subcategory": "App delivery",
            "text": "Document a standard for securing the delivery application content from your Workload spokes using Application Gateway and Azure Front Door.  You can use the Application Delivery checklist to for recommendations.",
            "waf": "Operations"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "guid": "e8bbac75-7155-49ab-a153-e8908ae28c84",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/enterprise-scale/network-topology-and-connectivity",
            "service": "VNet",
            "services": [
                "VNet"
            ],
            "severity": "Medium",
            "subcategory": "Hub and spoke",
            "text": "Use a hub-and-spoke network topology for network scenarios that require maximum flexibility.",
            "training": "https://learn.microsoft.com/learn/paths/architect-network-infrastructure/",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "guid": "7dd61623-a364-4a90-9eca-e48ebd54cd7d",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/traditional-azure-networking-topology",
            "service": "VNet",
            "services": [
                "ExpressRoute",
                "Firewall",
                "DNS",
                "Entra",
                "VNet",
                "VPN",
                "NVA"
            ],
            "severity": "High",
            "subcategory": "Hub and spoke",
            "text": "Deploy shared networking services, including ExpressRoute gateways, VPN gateways, and Azure Firewall or partner NVAs in the central-hub virtual network. If necessary, also deploy DNS services.",
            "training": "https://learn.microsoft.com/training/modules/hub-and-spoke-network-architecture/",
            "waf": "Cost"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "guid": "143b16c3-1d7a-4a9b-9470-4489a8042d88",
            "link": "https://learn.microsoft.com/azure/ddos-protection/ddos-protection-overview",
            "service": "VNet",
            "services": [
                "DDoS"
            ],
            "severity": "High",
            "subcategory": "App delivery",
            "text": "Use a DDoS Network or IP protection plan for all public IP addresses in application landing zones.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "guid": "e2e8abac-3571-4559-ab91-53e89f89dc7b",
            "link": "https://learn.microsoft.com/azure/architecture/reference-architectures/dmz/nva-ha",
            "service": "NVA",
            "services": [
                "NVA"
            ],
            "severity": "Medium",
            "subcategory": "Hub and spoke",
            "text": "When deploying partner networking technologies or NVAs, follow the partner vendor's guidance.",
            "waf": "Reliability"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "guid": "ce463dbb-bc8a-4c2a-aebc-92a43da1dae2",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-howto-coexist-resource-manager#to-enable-transit-routing-between-expressroute-and-azure-vpn",
            "service": "ExpressRoute",
            "services": [
                "ExpressRoute",
                "VPN",
                "ARS"
            ],
            "severity": "Low",
            "subcategory": "Hub and spoke",
            "text": "If you need transit between ExpressRoute and VPN gateways in hub and spoke scenarios, use Azure Route Server.",
            "training": "https://learn.microsoft.com/training/modules/intro-to-azure-route-server/",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,subnets=properties.subnets | mv-expand subnets | project id, subnetName = subnets.name, subnetPrefix = subnets.properties.addressPrefix | extend subnetPrefixLength = split(subnetPrefix, '/')[1] | where subnetName == 'RouteServerSubnet' | extend compliant = (subnetPrefixLength <= 27) | distinct id, compliant",
            "guid": "91b9d7d5-91e1-4dcb-8f1f-fa7e465646cc",
            "link": "https://learn.microsoft.com/azure/route-server/quickstart-configure-route-server-portal#create-a-route-server-1",
            "service": "ARS",
            "services": [
                "VNet",
                "ARS"
            ],
            "severity": "Low",
            "subcategory": "Hub and spoke",
            "text": "If using Route Server, use a /27 prefix for the Route Server subnet.",
            "training": "https://learn.microsoft.com/training/modules/intro-to-azure-route-server/",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "guid": "cc881471-607c-41cc-a0e6-14658dd558f9",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-networks-faq#can-i-create-a-peering-connection-to-a-vnet-in-a-different-region",
            "service": "VNet",
            "services": [
                "VNet",
                "ACR"
            ],
            "severity": "Medium",
            "subcategory": "Hub and spoke",
            "text": "For network architectures with multiple hub-and-spoke topologies across Azure regions, use global virtual network peerings between the hub VNets to connect the regions to each other.",
            "training": "https://learn.microsoft.com/learn/paths/azure-administrator-manage-virtual-networks/",
            "waf": "Performance"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "guid": "4722d929-c1b1-4cd6-81f5-4b29bade39ad",
            "link": "https://learn.microsoft.com/azure/azure-monitor/insights/network-insights-overview",
            "service": "VNet",
            "services": [
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Hub and spoke",
            "text": "Use Azure Monitor for Networks to monitor the end-to-end state of the networks on Azure.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-network-monitoring/",
            "waf": "Operations"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type == 'microsoft.network/virtualnetworks' | mvexpand properties.virtualNetworkPeerings | summarize peeringcount = count() by id | extend compliant = (peeringcount < 450) | distinct id,compliant",
            "guid": "0e7c28ec-9366-4572-83b0-f4664b1d944a",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits?toc=/azure/virtual-network/toc.json#azure-resource-manager-virtual-networking-limits",
            "service": "VNet",
            "services": [
                "VNet",
                "ExpressRoute"
            ],
            "severity": "Medium",
            "subcategory": "Hub and spoke",
            "text": "If you have more than 400 spoke networks in a region, deploy an additional hub to bypass VNet peering limits (500) and the maximum number of prefixes that can be advertised via ExpressRoute (1000).",
            "training": "https://learn.microsoft.com/training/modules/hub-and-spoke-network-architecture/",
            "waf": "Reliability"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/routetables' | mvexpand properties.routes | summarize routeCount = count() by id | extend compliant = (routeCount < 360) | distinct id,compliant",
            "guid": "3d457936-e9b7-41eb-bdff-314b26450b12",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits?toc=/azure/virtual-network/toc.json#azure-resource-manager-virtual-networking-limits",
            "service": "VNet",
            "services": [
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Hub and spoke",
            "text": "Limit the number of routes per route table to 400.",
            "training": "https://learn.microsoft.com/training/modules/hub-and-spoke-network-architecture/",
            "waf": "Reliability"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type == 'microsoft.network/virtualnetworks' | mvexpand properties.virtualNetworkPeerings | project id, peeringName=properties_virtualNetworkPeerings.name, compliant = (properties_virtualNetworkPeerings.properties.allowVirtualNetworkAccess == True)",
            "guid": "c76cb5a2-abe2-11ed-afa1-0242ac120002",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-network-manage-peering",
            "service": "VNet",
            "services": [
                "VNet"
            ],
            "severity": "High",
            "subcategory": "Hub and spoke",
            "text": "Use the setting 'Allow traffic to remote virtual network' when configuring VNet peerings.",
            "training": "https://learn.microsoft.com/training/modules/hub-and-spoke-network-architecture/",
            "waf": "Reliability"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type == 'microsoft.network/loadbalancers' | where tolower(sku.name) != 'basic' | mv-expand feIPconfigs = properties.frontendIPConfigurations | extend feConfigName = (feIPconfigs.name), PrivateSubnetId = toupper(feIPconfigs.properties.subnet.id), PrivateIPZones = feIPconfigs.zones, PIPid = toupper(feIPconfigs.properties.publicIPAddress.id), JoinID = toupper(id) | where isnotempty(PrivateSubnetId) | where isnull(PrivateIPZones) or array_length(PrivateIPZones) < 2 | project name, feConfigName, id | union (resources | where type == 'microsoft.network/loadbalancers' | where tolower(sku.name) != 'basic' | mv-expand feIPconfigs = properties.frontendIPConfigurations | extend feConfigName = (feIPconfigs.name), PIPid = toupper(feIPconfigs.properties.publicIPAddress.id), JoinID = toupper(id) | where isnotempty(PIPid) | join kind=innerunique ( resources | where type == 'microsoft.network/publicipaddresses' | where isnull(zones) or array_length(zones) < 2 | extend LBid = toupper(substring(properties.ipConfiguration.id, 0, indexof(properties.ipConfiguration.id, '/frontendIPConfigurations'))), InnerID = toupper(id) ) on $left.PIPid == $right.InnerID) | project name, id, tags, param1='Zones: No Zone or Zonal', param2=strcat('Frontend IP Configuration:', ' ', feConfigName)",
            "guid": "9dcd6250-9c4a-4382-aa9b-5b84c64fc1fe",
            "link": "https://learn.microsoft.com/en-us/azure/reliability/reliability-load-balancer?tabs=graph#zone-redundant",
            "service": "Load Balancers",
            "services": [
                "LoadBalancer"
            ],
            "severity": "High",
            "subcategory": "Hub and spoke",
            "text": "Use Standard Load Balancer SKU with a zone-redundant deployment, Selecting Standard SKU Load Balancer enhances reliability through availability zones and zone resiliency, ensuring deployments withstand zone and region failures. Unlike Basic, it supports global load balancing and offers an SLA.",
            "waf": "Reliability"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type =~ 'Microsoft.Network/loadBalancers' | extend bep = properties.backendAddressPools | extend BackEndPools = array_length(bep) | where BackEndPools == 0 | project name, id, Param1='backendPools', Param2=toint(0), tags | union (resources | where type =~ 'Microsoft.Network/loadBalancers' | where sku.name == 'Standard' | extend bep = properties.backendAddressPools | extend BackEndPools = toint(array_length(bep)) | mv-expand bip = properties.backendAddressPools | extend BackendAddresses = array_length(bip.properties.loadBalancerBackendAddresses) | where toint(BackendAddresses) <= 1 | project name, id, tags, Param1='backendAddresses', Param2=toint(BackendAddresses)) | union ( resources | where type =~ 'Microsoft.Network/loadBalancers' | where sku.name == 'Basic' | mv-expand properties.backendAddressPools | extend backendPoolId = properties_backendAddressPools.id | project id, name, tags, tostring(backendPoolId), Param1='BackEndPools' | join kind = leftouter ( resources | where type =~ 'Microsoft.Network/networkInterfaces' | mv-expand properties.ipConfigurations | mv-expand properties_ipConfigurations.properties.loadBalancerBackendAddressPools | extend backendPoolId = tostring(properties_ipConfigurations_properties_loadBalancerBackendAddressPools.id) | summarize poolMembers = count() by backendPoolId | project tostring(backendPoolId), poolMembers ) on backendPoolId | where toint(poolMembers) <= 1 | extend BackendAddresses = poolMembers | project id, name, tags, Param1='backendAddresses', Param2=toint(BackendAddresses))",
            "guid": "48682fb1-1e86-4458-a686-518ebd47393d",
            "link": "https://learn.microsoft.com/en-us/azure/reliability/reliability-load-balancer?tabs=graph#zone-redundant",
            "service": "Load Balancers",
            "services": [
                "LoadBalancer"
            ],
            "severity": "High",
            "subcategory": "Hub and spoke",
            "text": "Ensure load balancer backend pool(s) contains at least two instances, Deploying Azure Load Balancers with at least two instances in the backend prevents a single point of failure and supports scalability.",
            "waf": "Reliability"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "guid": "de0d5973-cd4c-4d21-a088-137f5e6c4cfd",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-howto-macsec",
            "service": "ExpressRoute",
            "services": [
                "ExpressRoute"
            ],
            "severity": "Medium",
            "subcategory": "Encryption",
            "text": "When you're using ExpressRoute Direct, configure MACsec in order to encrypt traffic at the layer-two level between the organization's routers and MSEE. The diagram shows this encryption in flow.",
            "training": "https://learn.microsoft.com/training/modules/design-implement-azure-expressroute/",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "guid": "ed301d6e-872e-452e-9611-cc58b5a4b151",
            "link": "https://learn.microsoft.com/azure/vpn-gateway/site-to-site-vpn-private-peering",
            "service": "ExpressRoute",
            "services": [
                "ExpressRoute",
                "VPN"
            ],
            "severity": "Medium",
            "subcategory": "Encryption",
            "text": "For scenarios where MACsec isn't an option (for example, not using ExpressRoute Direct), use a VPN gateway to establish IPsec tunnels over ExpressRoute private peering.",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "guid": "558fd772-49b8-4211-82df-27ee412e7f98",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-ip-addressing",
            "service": "ExpressRoute",
            "services": [
                "VNet",
                "ACR"
            ],
            "severity": "High",
            "subcategory": "IP plan",
            "text": "Ensure no overlapping IP address spaces across Azure regions and on-premises locations are used.",
            "training": "https://learn.microsoft.com/learn/paths/architect-network-infrastructure/",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type == 'microsoft.network/virtualnetworks' | extend addressSpace = todynamic(properties.addressSpace) | extend addressPrefix = todynamic(properties.addressSpace.addressPrefixes) | mvexpand addressSpace | mvexpand addressPrefix | project name, id, location, resourceGroup, subscriptionId, cidr = addressPrefix | extend compliant = (cidr matches regex @'^(10\\\\.|172\\\\.(1[6-9]|2[0-9]|3[01])\\\\.|192\\\\.168\\\\.)')  | project id, compliant, cidr",
            "guid": "3f630472-2dd6-49c5-a5c2-622f54b69bad",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-ip-addressing",
            "service": "VNet",
            "services": [
                "VNet"
            ],
            "severity": "Medium",
            "subcategory": "IP plan",
            "text": "Use IP addresses from the address allocation ranges for private internets (RFC 1918).",
            "training": "https://learn.microsoft.com/learn/paths/architect-network-infrastructure/",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type == 'microsoft.network/virtualnetworks' | extend addressSpace = todynamic(properties.addressSpace) | extend addressPrefix = todynamic(properties.addressSpace.addressPrefixes) | mvexpand addressSpace | mvexpand addressPrefix | extend addressMask = split(addressPrefix,'/')[1] | extend compliant = addressMask > 16 | project name, id, subscriptionId, resourceGroup, addressPrefix, compliant",
            "guid": "33aad5e8-c68e-41d7-9667-313b4f5664b5",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-ip-addressing",
            "service": "VNet",
            "services": [
                "VNet"
            ],
            "severity": "High",
            "subcategory": "IP plan",
            "text": "Ensure that IP address space isn't wasted, don't create unnecessarily large virtual networks (for example /16).",
            "training": "https://learn.microsoft.com/learn/paths/architect-network-infrastructure/",
            "waf": "Performance"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "guid": "f348ef25-4c27-4d42-b8bb-ac7571559ab9",
            "link": "https://learn.microsoft.com/azure/site-recovery/concepts-on-premises-to-azure-networking#retain-ip-addresses",
            "service": "VNet",
            "services": [
                "VNet",
                "ASR"
            ],
            "severity": "High",
            "subcategory": "IP plan",
            "text": "Do not use overlapping IP address ranges for production and disaster recovery sites.",
            "training": "https://learn.microsoft.com/learn/paths/az-104-manage-virtual-networks/",
            "waf": "Reliability"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "graph": "Resources | where type =~ 'Microsoft.Network/publicIPAddresses' and sku.tier =~ 'Regional' | where isempty(zones) or array_length(zones) <= 1 | extend az = case(isempty(zones), 'Non-zonal', array_length(zones) <= 1, strcat('Zonal (', strcat_array(zones, ','), ')'), zones) | project name, id, tags, param1 = strcat('sku: ', sku.name), param2 = strcat('availabilityZone: ', az)",
            "guid": "0c47f486-656d-4699-8c30-edef5b8a93c4",
            "link": "https://learn.microsoft.com/azure/virtual-network/ip-services/public-ip-addresses#availability-zone",
            "service": "Public IP Addresses",
            "services": [
                "VNet",
                "ACR"
            ],
            "severity": "High",
            "subcategory": "IP plan",
            "text": "Use Standard SKU and Zone-Redundant IPs when applicable, Public IP addresses in Azure can be of standard SKU, available as non-zonal, zonal, or zone-redundant. Zone-redundant IPs are accessible across all zones, resisting any single zone failure, thereby providing higher resilience. ",
            "training": "https://learn.microsoft.com/en-gb/training/modules/configure-virtual-networks/6-create-public-ip-addressing",
            "waf": "Reliability"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "guid": "153e8908-ae28-4c84-a33b-6b7808b9fe5c",
            "link": "https://learn.microsoft.com/azure/dns/private-dns-getstarted-portal",
            "service": "DNS",
            "services": [
                "DNS",
                "VNet"
            ],
            "severity": "Medium",
            "subcategory": "IP plan",
            "text": "For environments where name resolution in Azure is all that's required, use Azure Private DNS for resolution with a delegated zone for name resolution (such as 'azure.contoso.com').",
            "training": "https://learn.microsoft.com/learn/paths/az-104-manage-virtual-networks/",
            "waf": "Operations"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "guid": "41049d40-3a92-43c3-974d-00018ac6a9e0",
            "link": "https://learn.microsoft.com/azure/dns/dns-private-resolver-overview",
            "service": "DNS",
            "services": [
                "DNS",
                "VNet",
                "ACR"
            ],
            "severity": "Medium",
            "subcategory": "IP plan",
            "text": "For environments where name resolution across Azure and on-premises is required and there is no existing enterprise DNS service like Active Directory, use Azure DNS Private Resolver to route DNS requests to Azure or to on-premises DNS servers.",
            "training": "https://learn.microsoft.com/training/modules/intro-to-azure-dns-private-resolver/",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "guid": "1e6a83de-5de3-42c1-a924-81607d5d1e4e",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-networks-name-resolution-for-vms-and-role-instances",
            "service": "DNS",
            "services": [
                "DNS",
                "VNet"
            ],
            "severity": "Low",
            "subcategory": "IP plan",
            "text": "Special workloads that require and deploy their own DNS (such as Red Hat OpenShift) should use their preferred DNS solution.",
            "training": "https://learn.microsoft.com/training/courses/az-700t00",
            "waf": "Operations"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "guid": "614658d3-558f-4d77-849b-821112df27ee",
            "link": "https://learn.microsoft.com/azure/dns/private-dns-autoregistration",
            "service": "DNS",
            "services": [
                "DNS",
                "VNet",
                "VM"
            ],
            "severity": "High",
            "subcategory": "IP plan",
            "text": "Enable auto-registration for Azure DNS to automatically manage the lifecycle of the DNS records for the virtual machines deployed within a virtual network.",
            "training": "https://learn.microsoft.com/learn/paths/az-104-manage-virtual-networks/",
            "waf": "Operations"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "guid": "18c80eb0-582a-4198-bf5c-d8800b2d263b",
            "link": "https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/ready/azure-best-practices/private-link-and-dns-integration-at-scale#private-link-and-dns-integration-in-hub-and-spoke-network-architectures",
            "service": "DNS",
            "services": [
                "DNS",
                "VNet"
            ],
            "severity": "Medium",
            "subcategory": "IP plan",
            "text": "Implement a plan for managing DNS resolution between multiple Azure regions and when services fail over to another region",
            "training": "https://learn.microsoft.com/learn/paths/az-104-manage-virtual-networks/",
            "waf": "Reliability"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "guid": "ee1ac551-c4d5-46cf-b035-d0a3c50d87ad",
            "link": "https://learn.microsoft.com/azure/bastion/bastion-overview",
            "service": "Bastion",
            "services": [
                "Bastion"
            ],
            "severity": "Medium",
            "subcategory": "Internet",
            "text": "Use Azure Bastion to securely connect to your network.",
            "training": "https://learn.microsoft.com/training/modules/intro-to-azure-bastion/",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,subnets=properties.subnets | mv-expand subnets | project id, subnetName = subnets.name, subnetPrefix = subnets.properties.addressPrefix | extend subnetPrefixLength = split(subnetPrefix, '/')[1] | where subnetName == 'AzureBastionSubnet' | extend compliant = (subnetPrefixLength <= 26) | distinct id, compliant",
            "guid": "6eab9eb6-762b-485e-8ea8-15aa5dba0bd0",
            "link": "https://learn.microsoft.com/azure/bastion/bastion-faq#subnet",
            "service": "Bastion",
            "services": [
                "VNet",
                "Bastion"
            ],
            "severity": "Medium",
            "subcategory": "Internet",
            "text": "Use Azure Bastion in a subnet /26 or larger.",
            "training": "https://learn.microsoft.com/training/modules/intro-to-azure-bastion/",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "guid": "1d7aa9b6-4704-4489-a804-2d88e79d17b7",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/afds-overview",
            "service": "WAF",
            "services": [
                "AzurePolicy",
                "WAF",
                "FrontDoor",
                "ACR"
            ],
            "severity": "Medium",
            "subcategory": "Internet",
            "text": "Use Azure Front Door and WAF policies to provide global protection across Azure regions for inbound HTTP/S connections to a landing zone.",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "guid": "3b22a5a6-7e7a-48ed-9b30-e38c3f29812b",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "service": "WAF",
            "services": [
                "AzurePolicy",
                "WAF",
                "FrontDoor",
                "AppGW"
            ],
            "severity": "Low",
            "subcategory": "Internet",
            "text": "When using Azure Front Door and Azure Application Gateway to help protect HTTP/S apps, use WAF policies in Azure Front Door. Lock down Azure Application Gateway to receive traffic only from Azure Front Door.",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "guid": "2363cefe-179b-4599-be0d-5973cd4cd21b",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "service": "WAF",
            "services": [
                "WAF",
                "VNet"
            ],
            "severity": "High",
            "subcategory": "Internet",
            "text": "When WAFs and other reverse proxies are required for inbound HTTP/S connections, deploy them within a landing-zone virtual network and together with the apps that they're protecting and exposing to the internet.",
            "training": "https://learn.microsoft.com/learn/paths/architect-network-infrastructure/",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "guid": "088137f5-e6c4-4cfd-9e50-4547c2447ec6",
            "link": "https://learn.microsoft.com/azure/ddos-protection/ddos-protection-reference-architectures",
            "service": "VNet",
            "services": [
                "VNet",
                "DDoS"
            ],
            "severity": "High",
            "subcategory": "Internet",
            "text": "Use Azure DDoS Network or IP Protection plans to help protect Public IP Addresses endpoints within the virtual networks.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "guid": "b034c01e-110b-463a-b36e-e3346e57f225",
            "link": "https://learn.microsoft.com/azure/virtual-network/ip-services/default-outbound-access",
            "service": "VNet",
            "services": [],
            "severity": "High",
            "subcategory": "Internet",
            "text": "Plan for how to manage your network outbound traffic configuration and strategy before the upcoming breaking change. On September 30, 2025, default outbound access for new deployments will be retired and only explicit access configurations will be allowed.",
            "training": "https://learn.microsoft.com/training/modules/configure-virtual-networks/",
            "waf": "Reliability"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "guid": "b1c82a3f-2320-4dfa-8972-7ae4823c8930",
            "link": "https://learn.microsoft.com/azure/ddos-protection/ddos-protection-reference-architectures",
            "service": "VNet",
            "services": [
                "DDoS"
            ],
            "severity": "High",
            "subcategory": "Internet",
            "text": "Add diagnostic settings to save DDoS related logs for all the protected public IP addresses (DDoS IP or Network Protection).",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "guid": "3c5a808d-c695-4c14-a63c-c7ab7a510e41",
            "link": "https://github.com/Azure/Enterprise-Scale/wiki/ALZ-Policies#corp",
            "service": "Policy",
            "services": [
                "AzurePolicy",
                "VM"
            ],
            "severity": "High",
            "subcategory": "Internet",
            "text": "Ensure there is a policy assignment to deny Public IP addresses directly tied to Virtual Machines.  Use exclusions if public IPs are needed on specific VMs.",
            "training": "https://learn.microsoft.com/training/modules/configure-azure-policy/",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "guid": "359c373e-7dd6-4162-9a36-4a907ecae48e",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/connectivity-to-azure",
            "service": "ExpressRoute",
            "services": [
                "ExpressRoute",
                "VPN",
                "Backup"
            ],
            "severity": "Medium",
            "subcategory": "Hybrid",
            "text": "Use ExpressRoute as the primary connection to Azure.  Use VPNs as a source of backup connectivity.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Performance"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "description": "You can use AS-path prepending and connection weights to influence traffic from Azure to on-premises, and the full range of BGP attributes in your own routers to influence traffic from on-premises to Azure.",
            "guid": "f29812b2-363c-4efe-879b-599de0d5973c",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-routing",
            "service": "ExpressRoute",
            "services": [
                "ExpressRoute"
            ],
            "severity": "Medium",
            "subcategory": "Hybrid",
            "text": "When you use multiple ExpressRoute circuits or multiple on-prem locations, use BGP attributes to optimize routing.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Reliability"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources| where type == 'microsoft.network/virtualnetworkgateways'| where properties.gatewayType =~ 'vpn' or properties.gatewayType == 'ExpressRoute'| extend SKUName = properties.sku.name, SKUTier = properties.sku.tier, Type = properties.gatewayType| extend compliant = SKUTier !in ('Basic', 'Standard')| project name, id, subscriptionId, resourceGroup, compliant",
            "guid": "d4cd21b0-8813-47f5-b6c4-cfd3e504547c",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-about-virtual-network-gateways?source=recommendations#gwsku",
            "service": "ExpressRoute",
            "services": [
                "ExpressRoute",
                "VPN"
            ],
            "severity": "Medium",
            "subcategory": "Hybrid",
            "text": "Select the right SKU for the ExpressRoute/VPN gateways based on bandwidth and performance requirements.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Performance"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/expressroutecircuits' | extend compliant = (tolower(sku.family) == 'metereddata' or tolower(sku.tier) == 'local') | distinct id,compliant",
            "guid": "7025b442-f6e9-4af6-b11f-c9574916016f",
            "link": "https://learn.microsoft.com/azure/expressroute/plan-manage-cost",
            "service": "ExpressRoute",
            "services": [
                "ExpressRoute",
                "Cost"
            ],
            "severity": "High",
            "subcategory": "Hybrid",
            "text": "Ensure that you're using unlimited-data ExpressRoute circuits only if you reach the bandwidth that justifies their cost.",
            "training": "https://learn.microsoft.com/training/modules/design-implement-azure-expressroute/",
            "waf": "Cost"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/connections' | where properties.connectionType == 'ExpressRoute' | project id, gwid=tostring(properties.virtualNetworkGateway1.id), circuitid=tostring(properties.peer.id) | join (resources | where type=='microsoft.network/expressroutecircuits' | project circuitid=tostring(id), circuitsku=sku.tier) on circuitid | project id=gwid, compliant = (circuitsku == 'Local') | summarize compliant=max(compliant) by id",
            "guid": "f4e7926a-ec35-476e-a412-5dd17136bd62",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-faqs#expressroute-local",
            "service": "ExpressRoute",
            "services": [
                "ExpressRoute",
                "Cost"
            ],
            "severity": "High",
            "subcategory": "Hybrid",
            "text": "Leverage the Local SKU of ExpressRoute to reduce the cost of your circuits, if your circuit peering location supports your Azure regions for the Local SKU.",
            "training": "https://learn.microsoft.com/training/modules/design-implement-azure-expressroute/",
            "waf": "Cost"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources| where type == 'microsoft.network/virtualnetworkgateways'| where properties.gatewayType =~ 'vpn' or properties.gatewayType == 'ExpressRoute'| extend SKUName = properties.sku.name, SKUTier = properties.sku.tier, Type = properties.gatewayType| extend compliant = SKUTier contains 'AZ'| project name, id, subscriptionId, resourceGroup, Type, compliant",
            "guid": "2447ec66-138a-4720-8f1c-e16ed301d6e8",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-about-virtual-network-gateways",
            "service": "ExpressRoute",
            "services": [
                "ExpressRoute"
            ],
            "severity": "Medium",
            "subcategory": "Hybrid",
            "text": "Deploy a zone-redundant ExpressRoute gateway in the supported Azure regions.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Reliability"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "guid": "72e52e36-11cc-458b-9a4b-1511e43a58a9",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/connectivity-to-azure",
            "service": "ExpressRoute",
            "services": [
                "ExpressRoute"
            ],
            "severity": "Medium",
            "subcategory": "Hybrid",
            "text": "For scenarios that require bandwidth higher than 10 Gbps or dedicated 10/100-Gbps ports, use ExpressRoute Direct.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Performance"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "guid": "c2299c4d-7b57-4d0c-9555-62f2b3e4563a",
            "link": "https://learn.microsoft.com/azure/expressroute/about-fastpath",
            "service": "ExpressRoute",
            "services": [
                "ExpressRoute"
            ],
            "severity": "Medium",
            "subcategory": "Hybrid",
            "text": "When low latency is required, or throughput from on-premises to Azure must be greater than 10 Gbps, enable FastPath to bypass the ExpressRoute gateway from the data path.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Performance"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/virtualnetworkgateways' | where properties.gatewayType == 'Vpn' | extend compliant = (tolower(properties.sku.name) contains 'az') | distinct id, compliant",
            "guid": "4d873974-8b66-42d6-b15f-512a65498f6d",
            "link": "https://learn.microsoft.com/azure/vpn-gateway/create-zone-redundant-vnet-gateway",
            "service": "VPN",
            "services": [
                "VPN"
            ],
            "severity": "Medium",
            "subcategory": "Hybrid",
            "text": "Use zone-redundant VPN gateways to connect branches or remote locations to Azure (where available).",
            "training": "https://learn.microsoft.com/training/modules/intro-to-azure-vpn-gateway/",
            "waf": "Reliability"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "guid": "45866df8-cf85-4ca9-bbe2-65ec1478919e",
            "link": "https://learn.microsoft.com/azure/vpn-gateway/vpn-gateway-highlyavailable",
            "service": "VPN",
            "services": [
                "VPN"
            ],
            "severity": "Medium",
            "subcategory": "Hybrid",
            "text": "Use redundant VPN appliances on-premises (active/active or active/passive).",
            "training": "https://learn.microsoft.com/training/modules/intro-to-azure-vpn-gateway/",
            "waf": "Reliability"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "guid": "718cb437-b060-2589-8856-2e93a5c6633b",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-erdirect-about",
            "service": "ExpressRoute",
            "services": [
                "ExpressRoute",
                "Cost"
            ],
            "severity": "High",
            "subcategory": "Hybrid",
            "text": "If using ExpressRoute Direct, consider using ExpressRoute Local circuits to the local Azure regions to save costs.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Cost"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "guid": "8042d88e-79d1-47b7-9b22-a5a67e7a8ed4",
            "link": "https://learn.microsoft.com/azure/architecture/framework/services/networking/expressroute/reliability",
            "service": "ExpressRoute",
            "services": [
                "ExpressRoute"
            ],
            "severity": "Medium",
            "subcategory": "Hybrid",
            "text": "When traffic isolation or dedicated bandwidth is required, such as for separating production and nonproduction environments, use different ExpressRoute circuits. It will help you ensure isolated routing domains and alleviate noisy-neighbor risks.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "guid": "b30e38c3-f298-412b-8363-cefe179b599d",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-monitoring-metrics-alerts",
            "service": "ExpressRoute",
            "services": [
                "ExpressRoute",
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Hybrid",
            "text": "Monitor ExpressRoute availability and utilization using built-in Express Route Insights.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Operations"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "guid": "5bf68dc9-325e-4873-bf88-f8214ef2e5d2",
            "link": "https://learn.microsoft.com/azure/expressroute/how-to-configure-connection-monitor",
            "service": "ExpressRoute",
            "services": [
                "ACR",
                "NetworkWatcher",
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Hybrid",
            "text": "Use Connection Monitor for connectivity monitoring across the network, especially between on-premises and Azure.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Operations"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/connections' | where properties.connectionType == 'ExpressRoute' | project cxId=id, gwId=tostring(properties.virtualNetworkGateway1.id), circuitId=tostring(properties.peer.id) | join (resources | where type=='microsoft.network/expressroutecircuits' | project circuitId=tostring(id), circuitLocation=tostring(properties.serviceProviderProperties.peeringLocation)) on circuitId | distinct gwId, circuitLocation | summarize countErLocations=count() by id=gwId | extend compliant = (countErLocations >= 2)",
            "guid": "e0d5973c-d4cd-421b-8881-37f5e6c4cfd3",
            "link": "https://learn.microsoft.com/azure/expressroute/designing-for-disaster-recovery-with-expressroute-privatepeering#need-for-redundant-connectivity-solution",
            "service": "ExpressRoute",
            "services": [
                "ExpressRoute"
            ],
            "severity": "Medium",
            "subcategory": "Hybrid",
            "text": "Use ExpressRoute circuits from different peering locations for redundancy.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Reliability"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "guid": "cf3fe65c-fec0-495a-8edc-9675200f2add",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-howto-coexist-resource-manager",
            "service": "ExpressRoute",
            "services": [
                "ExpressRoute",
                "VPN"
            ],
            "severity": "Medium",
            "subcategory": "Hybrid",
            "text": "Use site-to-site VPN as failover of ExpressRoute, if only using a single ExpressRoute circuit.",
            "training": "https://learn.microsoft.com/training/modules/design-implement-azure-expressroute/",
            "waf": "Reliability"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,resourceGroup,name,subnets=properties.subnets | mv-expand subnets | project id,resourceGroup,name,subnetName=tostring(subnets.name),routeTableId=tostring(subnets.properties.routeTable.id) | where subnetName == 'GatewaySubnet' | join kind=leftouter (Resources | where type == 'microsoft.network/routetables' | project routeTableName=name,routeTableId=id, disableBgpRoutePropagation=properties.disableBgpRoutePropagation) on routeTableId | project id,compliant = (disableBgpRoutePropagation == False or isnull(disableBgpRoutePropagation))",
            "guid": "72105cc8-aaea-4ee1-8c7a-ad25977afcaf",
            "link": "https://learn.microsoft.com/azure/vpn-gateway/vpn-gateway-about-vpn-gateway-settings#gwsub",
            "service": "ExpressRoute",
            "services": [
                "VNet",
                "Storage"
            ],
            "severity": "High",
            "subcategory": "Hybrid",
            "text": "If you are using a route table in the GatewaySubnet, make sure that gateway routes are propagated.",
            "waf": "Reliability"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "guid": "d581a947-69a2-4783-942e-9df3664324c8",
            "link": "https://learn.microsoft.com/azure/expressroute/designing-for-high-availability-with-expressroute#active-active-connections",
            "service": "ExpressRoute",
            "services": [
                "ACR",
                "ExpressRoute"
            ],
            "severity": "High",
            "subcategory": "Hybrid",
            "text": "If using ExpressRoute, your on-premises routing should be dynamic: in the event of a connection failure it should converge to the remaining connection of the circuit. Load should be shared across both connections ideally as active/active, although active/passive is supported too.",
            "training": "https://learn.microsoft.com/training/modules/design-implement-azure-expressroute/",
            "waf": "Reliability"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "guid": "b258f058-b9f6-46cd-b28d-990106f0c3f8",
            "link": "https://learn.microsoft.com/azure/expressroute/designing-for-high-availability-with-expressroute",
            "service": "ExpressRoute",
            "services": [
                "ExpressRoute"
            ],
            "severity": "Medium",
            "subcategory": "Hybrid",
            "text": "Ensure the two physical links of your ExpressRoute circuit are connected to two distinct edge devices in your network.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Reliability"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "guid": "fe2a1b53-6fbd-4c67-b58a-85d7c7a0afcb",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-bfd",
            "service": "ExpressRoute",
            "services": [],
            "severity": "Medium",
            "subcategory": "Hybrid",
            "text": "Ensure Bidirectional Forwarding Detection (BFD) is enabled and configured on customer or provider edge routing devices.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Reliability"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "guid": "669b215a-ce43-4371-8f6f-11047f6490f1",
            "link": "https://learn.microsoft.com/azure/expressroute/designing-for-disaster-recovery-with-expressroute-privatepeering",
            "service": "ExpressRoute",
            "services": [
                "ExpressRoute"
            ],
            "severity": "High",
            "subcategory": "Hybrid",
            "text": "Connect the ExpressRoute Gateway to two or more circuits from different peering locations for higher resiliency.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Reliability"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "guid": "3f79ed00-203b-4c95-9efd-691505f5a1f9",
            "link": "https://learn.microsoft.com/azure/vpn-gateway/vpn-gateway-howto-setup-alerts-virtual-network-gateway-log",
            "service": "ExpressRoute",
            "services": [
                "VNet",
                "ExpressRoute",
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Hybrid",
            "text": "Configure diagnostic logs and alerts for ExpressRoute virtual network gateway.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Operations"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "guid": "5234c93f-b651-41dd-80c1-234177b91ced",
            "link": "https://learn.microsoft.com/azure/expressroute/virtual-network-connectivity-guidance",
            "service": "ExpressRoute",
            "services": [
                "VNet",
                "ExpressRoute"
            ],
            "severity": "Medium",
            "subcategory": "Hybrid",
            "text": "Do not use ExpressRoute circuits for VNet-to-VNet communication.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Performance"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "guid": "8ac6a9e0-1e6a-483d-b5de-32c199248160",
            "link": "https://learn.microsoft.com/azure/virtual-wan/virtual-wan-about",
            "service": "N/A",
            "services": [
                "ACR"
            ],
            "severity": "Low",
            "subcategory": "Hybrid",
            "text": "Do not send Azure traffic to hybrid locations for inspection.  Instead, follow the principle 'traffic in Azure stays in Azure' so that communication across resources in Azure occurs via the Microsoft backbone network.",
            "waf": "Performance"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "guid": "e6c4cfd3-e504-4547-a244-7ec66138a720",
            "link": "https://learn.microsoft.com/azure/firewall/overview",
            "service": "Firewall",
            "services": [
                "Firewall"
            ],
            "severity": "High",
            "subcategory": "Firewall",
            "text": "Use Azure Firewall to govern Azure outbound traffic to the internet, non-HTTP/S inbound connections, and East/West traffic filtering (if the organization requires it).",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "guid": "5a4b1511-e43a-458a-ac22-99c4d7b57d0c",
            "link": "https://learn.microsoft.com/azure/firewall-manager/policy-overview",
            "service": "Firewall",
            "services": [
                "AzurePolicy",
                "RBAC",
                "ACR",
                "Firewall"
            ],
            "severity": "Medium",
            "subcategory": "Firewall",
            "text": "Create a global Azure Firewall policy to govern security posture across the global network environment and assign it to all Azure Firewall instances. Allow for granular policies to meet requirements of specific regions by delegating incremental firewall policies to local security teams via Azure role-based access control.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "guid": "655562f2-b3e4-4563-a4d8-739748b662d6",
            "link": "https://learn.microsoft.com/azure/firewall-manager/deploy-trusted-security-partner",
            "service": "Firewall",
            "services": [
                "Firewall"
            ],
            "severity": "Low",
            "subcategory": "Firewall",
            "text": "Configure supported partner SaaS security providers within Firewall Manager if the organization wants to use such solutions to help protect outbound connections.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/firewallpolicies' | extend compliant = (properties.dnsSettings.enableProxy == true) | distinct id,compliant",
            "guid": "14d99880-2f88-47e8-a134-62a7d85c94af",
            "link": "https://learn.microsoft.com/azure/firewall/fqdn-filtering-network-rules",
            "service": "Firewall",
            "services": [
                "DNS",
                "Firewall"
            ],
            "severity": "High",
            "subcategory": "Firewall",
            "text": "Use application rules to filter outbound traffic on destination host name for supported protocols.  Use FQDN-based network rules and Azure Firewall with DNS proxy to filter egress traffic to the Internet over other protocols.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/firewallpolicies' | extend compliant = (properties.sku.tier == 'Premium') | distinct id,compliant",
            "guid": "c10d51ef-f999-455d-bba0-5c90ece07447",
            "link": "https://learn.microsoft.com/azure/firewall/premium-features",
            "service": "Firewall",
            "services": [
                "Firewall"
            ],
            "severity": "High",
            "subcategory": "Firewall",
            "text": "Use Azure Firewall Premium to enable additional security features.",
            "training": "https://learn.microsoft.com/training/modules/introduction-azure-firewall/",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/firewallpolicies' | extend compliant = (properties.threatIntelMode == 'Deny') | distinct id,compliant",
            "guid": "e9c8f584-6d5e-473b-8dc5-acc9fbaab4e3",
            "link": "https://learn.microsoft.com/azure/firewall/premium-features#idps-signature-rules",
            "service": "Firewall",
            "services": [
                "Firewall"
            ],
            "severity": "High",
            "subcategory": "Firewall",
            "text": "Configure Azure Firewall Threat Intelligence mode to Alert and Deny for additional protection.",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/firewallpolicies' | extend compliant = (properties.intrusionDetection.mode == 'Deny') | project id, compliant",
            "guid": "b9d0dff5-bdd4-4cd8-88ed-5811610b2b2c",
            "link": "https://learn.microsoft.com/azure/firewall/premium-features#idps",
            "service": "Firewall",
            "services": [
                "Firewall"
            ],
            "severity": "High",
            "subcategory": "Firewall",
            "text": "Configure Azure Firewall IDPS mode to Deny for additional protection.",
            "training": "https://learn.microsoft.com/training/modules/introduction-azure-firewall/",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,resourceGroup,name,subnets=properties.subnets | mv-expand subnets | project id,name,subnetId=tostring(subnets.id), subnetName=tostring(subnets.name),subnetRT=subnets.properties.routeTable.id | where not (subnetName in ('GatewaySubnet', 'AzureFirewallSubnet', 'RouteServerSubnet', 'AzureBastionSubnet')) | extend hasRT = isnotnull(subnetRT) | distinct id, hasRT, subnetId | join kind=fullouter (resources | where type == 'microsoft.network/virtualnetworks' | mvexpand properties.virtualNetworkPeerings | extend isVWAN=(tolower(split(properties_virtualNetworkPeerings.name, '_')[0]) == 'remotevnettohubpeering') | mv-expand properties.subnets | project id, isVWAN, name, subnetId=tostring(properties_subnets.id), subnetName=tostring(properties_subnets.name) | summarize PeeredToVWAN=max(isVWAN) by id, subnetId | project id, subnetId, isVWANpeer = (PeeredToVWAN == true)) on subnetId | project id=iff(isnotempty(id), id, id1), subnetId=iff(isnotempty(subnetId), subnetId, subnetId1), hasRT, isVWANpeer | extend compliant = (hasRT==true or isVWANpeer==true) | distinct id, subnetId, compliant",
            "guid": "a3784907-9836-4271-aafc-93535f8ec08b",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-networks-udr-overview",
            "service": "Firewall",
            "services": [
                "Firewall",
                "VNet",
                "VWAN",
                "NVA",
                "Storage"
            ],
            "severity": "High",
            "subcategory": "Firewall",
            "text": "For subnets in VNets not connected to Virtual WAN, attach a route table so that Internet traffic is redirected to Azure Firewall or a Network Virtual Appliance.",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "guid": "715d833d-4708-4527-90ac-1b142c7045ba",
            "link": "https://learn.microsoft.com/azure/firewall/firewall-structured-logs",
            "service": "Firewall",
            "services": [
                "Firewall",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Firewall",
            "text": "Add diagnostic settings to save logs, using the Resource Specific destination table, for all Azure Firewall deployments.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Operations"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "guid": "e960fc6b-4ab2-4db6-9609-3745135f9ffa",
            "link": "https://learn.microsoft.com/azure/firewall-manager/migrate-to-policy",
            "service": "Firewall",
            "services": [
                "AzurePolicy",
                "Firewall"
            ],
            "severity": "Important",
            "subcategory": "Firewall",
            "text": "Migrate from Azure Firewall Classic rules (if exist) to Firewall Policy.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Operations"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,subnets=properties.subnets | mv-expand subnets | project id, subnetName = subnets.name, subnetPrefix = subnets.properties.addressPrefix | extend subnetPrefixLength = split(subnetPrefix, '/')[1] | where subnetName == 'AzureFirewallSubnet' | extend compliant = (subnetPrefixLength == 26) | distinct id, compliant",
            "guid": "22d6419e-b627-4d95-9e7d-019fa759387f",
            "link": "https://learn.microsoft.com/azure/firewall/firewall-faq#why-does-azure-firewall-need-a--26-subnet-size",
            "service": "Firewall",
            "services": [
                "VNet",
                "Firewall"
            ],
            "severity": "High",
            "subcategory": "Segmentation",
            "text": "Use a /26 prefix for your Azure Firewall subnets.",
            "training": "https://learn.microsoft.com/training/modules/introduction-azure-firewall/",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "guid": "828cec2e-af6c-40c2-8fa2-1b681ee63eb7",
            "link": "https://learn.microsoft.com/azure/firewall-manager/rule-hierarchy",
            "service": "Firewall",
            "services": [
                "AzurePolicy"
            ],
            "severity": "Medium",
            "subcategory": "Firewall",
            "text": "Arrange rules within the firewall policy into Rule Collection Groups and Rule Collections and based on their frequency of use.",
            "training": "https://learn.microsoft.com/training/modules/intro-to-azure-firewall-manager/",
            "waf": "Performance"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "guid": "0da83bb1-2f39-49af-b5c9-835fc455e3d1",
            "link": "https://learn.microsoft.com/azure/firewall/ip-groups",
            "service": "Firewall",
            "services": [
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Firewall",
            "text": "Use IP Groups or IP prefixes to reduce number of IP table rules.",
            "waf": "Performance"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "guid": "c44c6f0e-1642-4a61-a17b-0922f835c93a",
            "link": "https://learn.microsoft.com/azure/firewall/tutorial-firewall-dnat",
            "service": "Firewall",
            "services": [],
            "severity": "Medium",
            "subcategory": "Firewall",
            "text": "Do not use wildcards as a source IP for DNATS, such as * or any, you should specify source IPs for incoming DNATs.",
            "training": "https://learn.microsoft.com/training/modules/introduction-to-azure-virtual-networks/",
            "waf": "Performance"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "guid": "7371dc21-251a-47a3-af14-6e01b9da4757",
            "link": "https://learn.microsoft.com/azure/firewall/integrate-with-nat-gateway",
            "service": "Firewall",
            "services": [
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Firewall",
            "text": "Prevent SNAT Port exhaustion by monitoring SNAT port usage, evaluating NAT Gateway settings, and ensuring seamless failover. If the port count approaches the limit, it’s a sign that SNAT exhaustion might be imminent.",
            "training": "https://learn.microsoft.com/training/modules/introduction-to-azure-virtual-networks/",
            "waf": "Performance"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "guid": "346840b8-1064-496e-8396-4b1340172d52",
            "link": "https://learn.microsoft.com/azure/firewall/premium-features#tls-inspection",
            "service": "Firewall",
            "services": [
                "Firewall"
            ],
            "severity": "High",
            "subcategory": "Firewall",
            "text": "If you are using Azure Firewall Premium, enable TLS Inspection.",
            "waf": "Performance"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "guid": "39990a13-915c-45f9-a2d3-562d7d6c4b7c",
            "link": "https://learn.microsoft.com/azure/firewall/premium-features#web-categories",
            "service": "Firewall",
            "services": [
                "ServiceBus"
            ],
            "severity": "Low",
            "subcategory": "Firewall",
            "text": "Use web categories to allow or deny outbound access to specific topics.",
            "waf": "Performance"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "guid": "6eff7e6c-6c4a-43d7-be3f-6641c2cb3d4a",
            "link": "https://learn.microsoft.com/azure/architecture/example-scenario/gateway/application-gateway-before-azure-firewall",
            "service": "Firewall",
            "services": [],
            "severity": "Medium",
            "subcategory": "Firewall",
            "text": "As part of your TLS inspection, plan for receiving traffic from Azure App Gateways for inspection.",
            "training": "https://learn.microsoft.com/training/modules/configure-azure-application-gateway/",
            "waf": "Performance"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type =~ 'Microsoft.Network/firewallPolicies' | where array_length(properties.firewalls) > 0 | extend compliant = (properties.dnsSettings.enableProxy =~ 'true') | distinct id, compliant",
            "guid": "94f3eede-9aa3-4088-92a3-bb9a56509fad",
            "link": "https://learn.microsoft.com/azure/firewall/dns-details",
            "service": "Firewall",
            "services": [
                "DNS",
                "Firewall"
            ],
            "severity": "Medium",
            "subcategory": "Firewall",
            "text": "Enable Azure Firewall DNS proxy configuration.",
            "training": "https://learn.microsoft.com/training/courses/az-700t00/",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "guid": "1dc04554-dece-4ffb-a49e-5c683e09f8da",
            "link": "https://learn.microsoft.com/azure/firewall/firewall-diagnostics",
            "service": "Firewall",
            "services": [
                "Monitor",
                "Firewall"
            ],
            "severity": "High",
            "subcategory": "Firewall",
            "text": "Integrate Azure Firewall with Azure Monitor and enable diagnostic logging to store and analyze firewall logs and metrics.",
            "training": "https://learn.microsoft.com/training/courses/az-700t00/",
            "waf": "Operations"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "guid": "64e7000e-3c06-485e-b455-ced7f454cba3",
            "link": "https://learn.microsoft.com/azure/well-architected/service-guides/azure-firewall",
            "service": "Firewall",
            "services": [
                "Backup"
            ],
            "severity": "Low",
            "subcategory": "Firewall",
            "text": "Implement backups for your firewall rules",
            "training": "https://learn.microsoft.com/training/courses/az-104t00/",
            "waf": "Operations"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type == 'microsoft.network/azurefirewalls' | where array_length(zones) <= 1 or isnull(zones) | where isempty(properties.virtualHub.id) or isnull(properties.virtualHub.id) | project name, id, tags, param1='multipleZones:false'",
            "guid": "d38ad60c-bc9e-4d49-b699-97e5d4dcf707",
            "link": "https://learn.microsoft.com/azure/firewall/deploy-availability-zone-powershell",
            "service": "Firewall",
            "services": [
                "ACR",
                "Firewall"
            ],
            "severity": "High",
            "subcategory": "Firewall",
            "text": "Deploy Azure Firewall across multiple availability zones. Azure Firewall offers different SLAs depending on its deployment; in a single availability zone or across multiple, potentially improving reliability and performance.",
            "training": "https://learn.microsoft.com/training/courses/az-104t00/",
            "waf": "Reliability"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type =~ 'Microsoft.Network/azureFirewalls' | where isempty(properties.virtualHub.id) or isnull(properties.virtualHub.id) | mv-expand ipConfig = properties.ipConfigurations | project name, firewallId = id, tags, vNetName = split(ipConfig.properties.subnet.id, '/', 8)[0], vNetId = tolower(substring(ipConfig.properties.subnet.id, 0, indexof(ipConfig.properties.subnet.id, /subnet'))) | join kind=fullouter ( resources | where type =~ 'Microsoft.Network/ddosProtectionPlans' | mv-expand vNet = properties.virtualNetworks | project ddosProtectionPlanId = id, vNetId = tolower(vNet.id) ) on vNetId | where isempty(ddosProtectionPlanId) | , name, id = firewallId, tags, param1 = strcat('vNet: ', vNetName), param2 = 'ddosProtection: Disabled'",
            "guid": "e8143efa-0301-4d62-be54-ca7b5ce566dc",
            "link": "https://learn.microsoft.com/en-gb/azure/ddos-protection/ddos-protection-overview",
            "service": "Firewall",
            "services": [
                "VNet",
                "Firewall",
                "DDoS"
            ],
            "severity": "High",
            "subcategory": "Firewall",
            "text": "Configure DDoS Protection on the Azure Firewall VNet, Associate a DDoS protection plan with the virtual network hosting Azure Firewall to provide enhanced mitigation against DDoS attacks. Azure Firewall Manager integrates the creation of firewall infrastructure and DDoS protection plans. ",
            "waf": "Reliability"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "guid": "d301d6e8-72e5-42e3-911c-c58b5a4b1511",
            "link": "https://learn.microsoft.com/azure/virtual-network/vnet-integration-for-azure-services",
            "service": "App Gateway",
            "services": [
                "VNet"
            ],
            "severity": "High",
            "subcategory": "PaaS",
            "text": "Do not disrupt control-plane communication for Azure PaaS services injected into a virtual networks, such as with a 0.0.0.0/0 route or an NSG rule that blocks control plane traffic.",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/?source=learn",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "guid": "e43a58a9-c229-49c4-b7b5-7d0c655562f2",
            "link": "https://learn.microsoft.com/azure/private-link/private-link-overview",
            "services": [
                "PrivateLink"
            ],
            "severity": "Medium",
            "subcategory": "PaaS",
            "text": "Use Private Link, where available, for shared Azure PaaS services.",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "guid": "b3e4563a-4d87-4397-98b6-62d6d15f512a",
            "link": "https://learn.microsoft.com/azure/private-link/private-endpoint-overview",
            "service": "ExpressRoute",
            "services": [
                "ExpressRoute",
                "PrivateLink"
            ],
            "severity": "Medium",
            "subcategory": "PaaS",
            "text": "Access Azure PaaS services from on-premises via private endpoints and ExpressRoute private peering. This method avoids transiting over the public internet.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type =~ 'microsoft.network/virtualnetworks' | project id,resourceGroup,name,subnets = properties.subnets | mv-expand subnets | project id = subnets.id, resourceGroup, VNet = name, serviceEndpoints = subnets.properties.serviceEndpoints, compliant = (isnull(subnets.properties.serviceEndpoints) or array_length(subnets.properties.serviceEndpoints) == 0) | order by compliant asc",
            "guid": "4704489a-8042-4d88-b79d-17b73b22a5a6",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-network-service-endpoints-overview",
            "service": "VNet",
            "services": [
                "VNet"
            ],
            "severity": "High",
            "subcategory": "PaaS",
            "text": "Don't enable virtual network service endpoints by default on all subnets.",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/?source=learn",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "guid": "7e7a8ed4-b30e-438c-9f29-812b2363cefe",
            "link": "azure/private-link/inspect-traffic-with-azure-firewall",
            "service": "Firewall",
            "services": [
                "DNS",
                "NVA",
                "Firewall",
                "PrivateLink"
            ],
            "severity": "Medium",
            "subcategory": "PaaS",
            "text": "Filter egress traffic to Azure PaaS services using FQDNs instead of IP addresses in Azure Firewall or an NVA to prevent data exfiltration. If using Private Link you can block all FQDNs, otherwise allow only the required PaaS services.",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/?source=learn",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,subnets=properties.subnets | mv-expand subnets | project id, subnetName = subnets.name, subnetPrefix = subnets.properties.addressPrefix | extend subnetPrefixLength = split(subnetPrefix, '/')[1] | where subnetName == 'GatewaySubnet' | extend compliant = (subnetPrefixLength <= 27) | distinct id, compliant",
            "guid": "f2aad7e3-bb03-4adc-8606-4123d342a917",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-howto-add-gateway-resource-manager#add-a-gateway",
            "service": "ExpressRoute",
            "services": [
                "VNet",
                "ExpressRoute",
                "VPN"
            ],
            "severity": "High",
            "subcategory": "Segmentation",
            "text": "Use at least a /27 prefix for your Gateway subnets.",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/networksecuritygroups' | mvexpand properties.securityRules | project id,name,ruleAction=properties_securityRules.properties.access,rulePriority=properties_securityRules.properties.priority,ruleDst=properties_securityRules.properties.destinationAddressPrefix,ruleSrc=properties_securityRules.properties.sourceAddressPrefix,ruleProt=properties_securityRules.properties.protocol,ruleDirection=properties_securityRules.properties.direction,rulePort=properties_securityRules.properties.destinationPortRange | summarize StarDenies=countif(ruleAction=='Deny' and ruleDst=='*' and ruleSrc=='*' and ruleProt=='*' and rulePort=='*') by id,tostring(ruleDirection) | where ruleDirection == 'Inbound' | project id,compliant=(StarDenies>0) | union (resources | where type=='microsoft.network/networksecuritygroups' | where array_length(properties.securityRules)==0 | extend compliant=false | project id,compliant)",
            "guid": "11deb39d-8299-4e47-bbe0-0fb5a36318a8",
            "link": "https://learn.microsoft.com/azure/virtual-network/service-tags-overview#available-service-tags",
            "service": "NSG",
            "services": [
                "VNet"
            ],
            "severity": "High",
            "subcategory": "Segmentation",
            "text": "Don't rely on the NSG inbound default rules using the VirtualNetwork service tag to limit connectivity.",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "guid": "c2447ec6-6138-4a72-80f1-ce16ed301d6e",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-landing-zone-network-segmentation",
            "services": [
                "VNet"
            ],
            "severity": "Medium",
            "subcategory": "Segmentation",
            "text": "Delegate subnet creation to the landing zone owner.",
            "training": "https://learn.microsoft.com/learn/paths/implement-resource-mgmt-security/",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type == 'microsoft.network/virtualnetworks' | mv-expand subnet = properties.subnets | where subnet.name !in~ ('GatewaySubnet', 'AzureFirewallSubnet', 'AzureFirewallManagementSubnet', 'RouteServerSubnet') | extend compliant = iff(isnotnull(subnet.properties.networkSecurityGroup.id), true, false) | project id, subnetName = subnet.name, vnetName = name, NSG = subnet.properties.networkSecurityGroup.id, compliant",
            "guid": "872e52e3-611c-4c58-a5a4-b1511e43a58a",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-landing-zone-network-segmentation",
            "service": "NSG",
            "services": [
                "VNet",
                "ACR"
            ],
            "severity": "Medium",
            "subcategory": "Segmentation",
            "text": "Use NSGs to help protect traffic across subnets, as well as east/west traffic across the platform (traffic between landing zones).",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "guid": "a4d87397-48b6-462d-9d15-f512a65498f6",
            "link": "https://learn.microsoft.com/azure/virtual-network/network-security-group-how-it-works",
            "service": "NSG",
            "services": [
                "VNet",
                "NVA",
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Segmentation",
            "text": "Use NSGs and application security groups to micro-segment traffic within the landing zone and avoid using a central NVA to filter traffic flows.",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type =~ 'Microsoft.Network/virtualnetworks' | project subscriptionId, lowerCaseVNetId = tolower(id) | join kind = leftouter (    resources    | where type =~ 'microsoft.network/networkwatchers/flowlogs' and properties.enabled == true and properties.provisioningState =~ 'succeeded'    | where properties.targetResourceId contains '/Microsoft.Network/virtualNetworks/'    | project flowlogId = id, trafficAnalyticsEnabled = properties.flowAnalyticsConfiguration.networkWatcherFlowAnalyticsConfiguration.enabled, lowerCaseTargetVNetId = tolower(properties.targetResourceId)    )    on $left.lowerCaseVNetId == $right.lowerCaseTargetVNetId | extend compliant = iff(isnotempty(lowerCaseTargetVNetId), true, false) | project id = lowerCaseVNetId, flowlogId, trafficAnalyticsEnabled, compliant",
            "guid": "dfe237de-143b-416c-91d7-aa9b64704489",
            "link": "https://learn.microsoft.com/azure/network-watcher/vnet-flow-logs-overview",
            "service": "NSG",
            "services": [
                "VNet",
                "NetworkWatcher"
            ],
            "severity": "Medium",
            "subcategory": "Segmentation",
            "text": "Enable VNet Flow Logs and feed them into Traffic Analytics to gain insights into internal and external traffic flows.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-network-monitoring/",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type == 'microsoft.network/networksecuritygroups' | project id, rules = array_length(properties.securityRules) | project id, compliant = (rules < 900)",
            "guid": "0390417d-53dc-44d9-b3f4-c8832f359b41",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits",
            "service": "NSG",
            "services": [
                "VNet"
            ],
            "severity": "Medium",
            "subcategory": "Segmentation",
            "text": "Do not implement more than 900 NSG rules per NSG, due to the limit of 1000 rules.",
            "training": "https://learn.microsoft.com/azure/virtual-network/network-security-group-how-it-works",
            "waf": "Reliability"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "guid": "412e7f98-3f63-4047-82dd-69c5b5c2622f",
            "link": "https://learn.microsoft.com/azure/virtual-wan/scenario-any-to-any",
            "service": "VWAN",
            "services": [
                "VWAN"
            ],
            "severity": "Medium",
            "subcategory": "Virtual WAN",
            "text": "Use Virtual WAN if your scenario is explicitly described in the list of Virtual WAN routing designs.",
            "training": "https://learn.microsoft.com/learn/modules/introduction-azure-virtual-wan/",
            "waf": "Operations"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "guid": "54b69bad-33aa-4d5e-ac68-e1d76667313b",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/virtual-wan-network-topology#virtual-wan-network-design-recommendationst",
            "service": "VWAN",
            "services": [
                "VWAN",
                "ACR"
            ],
            "severity": "Medium",
            "subcategory": "Virtual WAN",
            "text": "Use a Virtual WAN hub per Azure region to connect multiple landing zones together across Azure regions via a common global Azure Virtual WAN.",
            "training": "https://learn.microsoft.com/training/modules/introduction-azure-virtual-wan/",
            "waf": "Performance"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/virtualhubs' | extend compliant = isnotnull(properties.azureFirewall.id) | project id, compliant",
            "guid": "7d5d1e4e-6146-458d-9558-fd77249b8211",
            "link": "https://learn.microsoft.com/azure/virtual-wan/howto-firewall",
            "service": "VWAN",
            "services": [
                "VWAN",
                "Firewall"
            ],
            "severity": "Medium",
            "subcategory": "Virtual WAN",
            "text": "For outbound Internet traffic protection and filtering, deploy Azure Firewall in secured hubs.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "guid": "6667313b-4f56-464b-9e98-4a859c773e7d",
            "link": "https://learn.microsoft.com/azure/virtual-wan/migrate-from-hub-spoke-topology",
            "service": "VWAN",
            "services": [
                "VWAN"
            ],
            "severity": "Medium",
            "subcategory": "Virtual WAN",
            "text": "Ensure that your virtual WAN network architecture aligns to an identified architecture scenario.",
            "training": "https://learn.microsoft.com/training/modules/introduction-azure-virtual-wan/",
            "waf": "Reliability"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "guid": "261623a7-65a9-417e-8f34-8ef254c27d42",
            "link": "https://learn.microsoft.com/azure/virtual-wan/azure-monitor-insights",
            "service": "VWAN",
            "services": [
                "VWAN",
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Virtual WAN",
            "text": "Use Azure Monitor Insights for Virtual WAN to monitor the end-to-end topology of the Virtual WAN, status, and key metrics.",
            "training": "https://learn.microsoft.com/training/modules/introduction-azure-virtual-wan/",
            "waf": "Operations"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources| where type =~ 'microsoft.network/virtualwans' | extend compliant= (properties.allowBranchToBranchTraffic == 'true') | distinct id,compliant",
            "guid": "727c77e1-b9aa-4a37-a024-129d042422c1",
            "link": "https://learn.microsoft.com/azure/virtual-wan/virtual-wan-faq#is-branch-to-branch-connectivity-allowed-in-virtual-wan",
            "service": "VWAN",
            "services": [
                "VWAN"
            ],
            "severity": "Medium",
            "subcategory": "Virtual WAN",
            "text": "Do not disable branch-to-branch traffic in Virtual WAN, unless these flows should be explicitly blocked.",
            "training": "https://learn.microsoft.com/training/modules/introduction-azure-virtual-wan/",
            "waf": "Reliability"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type =~ 'microsoft.network/virtualhubs'| extend compliant= (properties.hubRoutingPreference =~ 'ASPath') | distinct id,compliant",
            "guid": "d49ac006-6670-4bc9-9948-d3e0a3a94f4d",
            "link": "https://learn.microsoft.com/azure/virtual-wan/about-virtual-hub-routing-preference",
            "service": "VWAN",
            "services": [
                "VWAN",
                "ExpressRoute",
                "VPN"
            ],
            "severity": "Medium",
            "subcategory": "Virtual WAN",
            "text": "Use AS-Path as hub routing preference, since it is more flexible than ExpressRoute or VPN.",
            "training": "https://learn.microsoft.com/training/modules/introduction-azure-virtual-wan/",
            "waf": "Reliability"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "guid": "2586b854-237e-47f1-84a1-d45d4cd2310d",
            "link": "https://learn.microsoft.com/azure/virtual-wan/about-virtual-hub-routing#labels",
            "service": "VWAN",
            "services": [
                "VWAN"
            ],
            "severity": "Medium",
            "subcategory": "Virtual WAN",
            "text": "Configure label-based propagation in Virtual WAN, otherwise connectivity between virtual hubs will be impaired.",
            "training": "https://learn.microsoft.com/training/modules/introduction-azure-virtual-wan/",
            "waf": "Reliability"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type =~ 'microsoft.network/virtualhubs' | extend addressSpace = properties.addressPrefix | extend compliant= (toint(substring(addressSpace, indexof(addressSpace, '/') + 1)) < 23) | distinct name, id, compliant",
            "guid": "9c75dfef-573c-461c-a698-68598595581a",
            "link": "https://learn.microsoft.com/azure/virtual-wan/virtual-wan-faq#what-is-the-recommended-hub-address-space-during-hub-creation",
            "service": "VWAN",
            "services": [
                "VWAN"
            ],
            "severity": "High",
            "subcategory": "Virtual WAN",
            "text": "Assign at least a /23 prefix to virtual hubs to ensure enough IP space is available.",
            "training": "https://learn.microsoft.com/training/modules/introduction-azure-virtual-wan/",
            "waf": "Reliability"
        },
        {
            "category": "Governance",
            "checklist": "Azure Landing Zone Review",
            "guid": "5c986cb2-9131-456a-8247-6e49f541acdc",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "service": "Policy",
            "services": [
                "AzurePolicy"
            ],
            "severity": "High",
            "subcategory": "Governance",
            "text": "Leverage Azure Policy strategically, define controls for your environment, using Policy Initiatives to group related policies.",
            "training": "https://learn.microsoft.com/training/modules/configure-azure-policy/",
            "waf": "Security"
        },
        {
            "category": "Governance",
            "checklist": "Azure Landing Zone Review",
            "guid": "d8a2adb1-17d6-4326-af62-5ca44e5695f2",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "service": "Policy",
            "services": [
                "AzurePolicy",
                "RBAC"
            ],
            "severity": "Medium",
            "subcategory": "Governance",
            "text": "Map regulatory and compliance requirements to Azure Policy definitions and Azure role assignments.",
            "training": "https://learn.microsoft.com/training/modules/governance-security/",
            "waf": "Security"
        },
        {
            "category": "Governance",
            "checklist": "Azure Landing Zone Review",
            "guid": "223ace8c-b123-408c-a501-7f154e3ab369",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "service": "Policy",
            "services": [
                "AzurePolicy",
                "Subscriptions"
            ],
            "severity": "Medium",
            "subcategory": "Governance",
            "text": "Establish Azure Policy definitions at the intermediate root management group so that they can be assigned at inherited scopes.",
            "training": "https://learn.microsoft.com/training/modules/configure-azure-policy/",
            "waf": "Security"
        },
        {
            "category": "Governance",
            "checklist": "Azure Landing Zone Review",
            "guid": "3829e7e3-1618-4368-9a04-77a209945bda",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "service": "Policy",
            "services": [
                "AzurePolicy"
            ],
            "severity": "High",
            "subcategory": "Governance",
            "text": "Manage policy assignments at the highest appropriate level with exclusions at bottom levels, if required.",
            "training": "https://learn.microsoft.com/training/modules/configure-azure-policy/",
            "waf": "Security"
        },
        {
            "category": "Governance",
            "checklist": "Azure Landing Zone Review",
            "guid": "43334f24-9116-4341-a2ba-527526944008",
            "link": "https://learn.microsoft.com/security/benchmark/azure/mcsb-asset-management#am-2-use-only-approved-services",
            "service": "Policy",
            "services": [
                "AzurePolicy",
                "Subscriptions"
            ],
            "severity": "Low",
            "subcategory": "Governance",
            "text": "Use Azure Policy to control which services users can provision at the subscription/management group level.",
            "training": "https://learn.microsoft.com/training/modules/configure-azure-policy/",
            "waf": "Security"
        },
        {
            "category": "Governance",
            "checklist": "Azure Landing Zone Review",
            "guid": "be7d7e48-4327-46d8-adc0-55bcf619e8a1",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "service": "Policy",
            "services": [
                "AzurePolicy"
            ],
            "severity": "High",
            "subcategory": "Governance",
            "text": "Use built-in policies where possible to minimize operational overhead.",
            "training": "https://learn.microsoft.com/training/modules/configure-azure-policy/",
            "waf": "Security"
        },
        {
            "category": "Governance",
            "checklist": "Azure Landing Zone Review",
            "description": "Assigning the Resource Policy Contributor role to specific scopes allows you to delegate policy management to relevant teams. For instance, a central IT team may oversee management group-level policies, while application teams handle policies for their subscriptions, enabling distributed governance with adherence to organizational standards.",
            "guid": "3f988795-25d6-4268-a6d7-0ba6c97be995",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview#azure-rbac-permissions-in-azure-policy",
            "service": "Policy",
            "services": [
                "AzurePolicy",
                "RBAC",
                "Subscriptions",
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Governance",
            "text": "Assign the built-in Resource Policy Contributor role at a particular scope to enable application-level governance.",
            "training": "https://learn.microsoft.com/training/modules/configure-azure-policy/",
            "waf": "Security"
        },
        {
            "category": "Governance",
            "checklist": "Azure Landing Zone Review",
            "guid": "19048384-5c98-46cb-8913-156a12476e49",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "service": "Policy",
            "services": [
                "AzurePolicy",
                "Subscriptions"
            ],
            "severity": "Medium",
            "subcategory": "Governance",
            "text": "Limit the number of Azure Policy assignments made at the root management group scope to avoid managing through exclusions at inherited scopes.",
            "training": "https://learn.microsoft.com/training/modules/configure-azure-policy/",
            "waf": "Security"
        },
        {
            "category": "Governance",
            "checklist": "Azure Landing Zone Review",
            "guid": "5a917e1f-348e-4f25-9c27-d42e8bbac757",
            "link": "https://learn.microsoft.com/industry/release-plan/2023wave2/cloud-sovereignty/enable-data-sovereignty-policy-baseline",
            "service": "Policy",
            "services": [
                "AzurePolicy"
            ],
            "severity": "Medium",
            "subcategory": "Governance",
            "text": "If any data sovereignty requirements exist, Azure Policies should be deployed to enforce them.",
            "training": "https://learn.microsoft.com/learn/paths/secure-your-cloud-data/",
            "waf": "Security"
        },
        {
            "category": "Governance",
            "checklist": "Azure Landing Zone Review",
            "guid": "78b22132-b41c-460b-a4d3-df8f73a67dc2",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/sovereign-landing-zone",
            "service": "Policy",
            "services": [
                "AzurePolicy",
                "Subscriptions"
            ],
            "severity": "Medium",
            "subcategory": "Governance",
            "text": "For Sovereign Landing Zone, deploy sovereignty policy baseline and assign at correct management group level.",
            "waf": "Security"
        },
        {
            "category": "Governance",
            "checklist": "Azure Landing Zone Review",
            "guid": "caeea0e9-1024-41df-a52e-d99c3f22a6f4",
            "link": "https://learn.microsoft.com/industry/sovereignty/policy-portfolio-baseline",
            "service": "Policy",
            "services": [
                "AzurePolicy"
            ],
            "severity": "Medium",
            "subcategory": "Governance",
            "text": "For Sovereign Landing Zone, document Sovereign Control objectives to policy mapping.",
            "waf": "Security"
        },
        {
            "category": "Governance",
            "checklist": "Azure Landing Zone Review",
            "guid": "9b461617-db7b-4399-8ac6-d4eb7153893a",
            "link": "https://learn.microsoft.com/industry/sovereignty/policy-portfolio-baseline#sovereignty-baseline-policy-initiatives",
            "service": "Policy",
            "services": [
                "AzurePolicy"
            ],
            "severity": "Medium",
            "subcategory": "Governance",
            "text": "For Sovereign Landing Zone, ensure process is in place for management of 'Sovereign Control objectives to policy mapping'.",
            "waf": "Security"
        },
        {
            "category": "Governance",
            "checklist": "Azure Landing Zone Review",
            "guid": "29fd366b-a180-452b-9bd7-954b7700c667",
            "link": "https://learn.microsoft.com/azure/cost-management-billing/costs/tutorial-acm-create-budgets?bc=%2Fazure%2Fcloud-adoption-framework%2F_bread%2Ftoc.json&toc=%2Fazure%2Fcloud-adoption-framework%2Ftoc.json",
            "services": [
                "TrafficManager",
                "Monitor",
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Optimize your cloud investment",
            "text": "Configure 'Actual' and 'Forecasted' Budget Alerts.",
            "training": "https://learn.microsoft.com/training/modules/analyze-costs-create-budgets-azure-cost-management/",
            "waf": "Cost"
        },
        {
            "category": "Management",
            "checklist": "Azure Landing Zone Review",
            "guid": "67e7a8ed-4b30-4e38-a3f2-9812b2363cef",
            "link": "https://learn.microsoft.com/en-us/azure/azure-monitor/logs/workspace-design#azure-regions",
            "service": "Monitor",
            "services": [
                "AzurePolicy",
                "Entra",
                "Monitor",
                "RBAC"
            ],
            "severity": "Medium",
            "subcategory": "Monitoring",
            "text": "Use a single monitor logs workspace to manage platforms centrally except where Azure role-based access control (Azure RBAC), data sovereignty requirements, or data retention policies mandate separate workspaces.",
            "training": "https://learn.microsoft.com/azure/azure-monitor/logs/design-logs-deployment",
            "waf": "Operations"
        },
        {
            "category": "Management",
            "checklist": "Azure Landing Zone Review",
            "guid": "7418ada9-4199-4c28-8286-d15e9433e8f3",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/design-logs-deployment",
            "service": "Monitor",
            "services": [
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Monitoring",
            "text": "Decide whether to use a single Azure Monitor Logs workspace for all regions or to create multiple workspaces to cover various geographical regions. Each approach has advantages and disadvantages, including potential cross-region networking charges",
            "training": "https://learn.microsoft.com/azure/azure-monitor/logs/design-logs-deployment",
            "waf": "Reliability"
        },
        {
            "category": "Management",
            "checklist": "Azure Landing Zone Review",
            "guid": "5e6c4cfd-3e50-4454-9c24-47ec66138a72",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/data-retention-archive?tabs=portal-1%2Cportal-2#how-retention-and-archiving-work",
            "service": "Monitor",
            "services": [
                "AzurePolicy",
                "Monitor",
                "ARS",
                "Storage"
            ],
            "severity": "High",
            "subcategory": "Monitoring",
            "text": "Export logs to Azure Storage if your log retention requirements exceed twelve years. Use immutable storage with a write-once, read-many policy to make data non-erasable and non-modifiable for a user-specified interval.",
            "training": "https://learn.microsoft.com/learn/paths/architect-infrastructure-operations/",
            "waf": "Operations"
        },
        {
            "category": "Management",
            "checklist": "Azure Landing Zone Review",
            "guid": "e7d7e484-3276-4d8b-bc05-5bcf619e8a13",
            "link": "https://learn.microsoft.com/azure/governance/machine-configuration/overview",
            "service": "VM",
            "services": [
                "AzurePolicy",
                "Monitor",
                "VM"
            ],
            "severity": "Medium",
            "subcategory": "Monitoring",
            "text": "Monitor OS level virtual machine (VM) configuration drift using Azure Policy. Enabling Azure Automanage Machine Configuration audit capabilities through policy helps application team workloads to immediately consume feature capabilities with little effort.",
            "training": "https://learn.microsoft.com/learn/paths/implement-resource-mgmt-security/",
            "waf": "Operations"
        },
        {
            "category": "Management",
            "checklist": "Azure Landing Zone Review",
            "guid": "f9887952-5d62-4688-9d70-ba6c97be9951",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/management-operational-compliance#update-management-considerations",
            "service": "VM",
            "services": [
                "VM"
            ],
            "severity": "Medium",
            "subcategory": "Operational compliance",
            "text": "Use Azure Update Manager as a patching mechanism for Windows and Linux VMs in Azure.",
            "training": "https://learn.microsoft.com/azure/update-manager/overview?tabs=azure-vms",
            "waf": "Operations"
        },
        {
            "category": "Management",
            "checklist": "Azure Landing Zone Review",
            "guid": "c806c048-26b7-4ddf-b4c2-b4f0c476925d",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/management-operational-compliance#update-management-considerations ",
            "service": "VM",
            "services": [
                "VM"
            ],
            "severity": "Medium",
            "subcategory": "Operational compliance",
            "text": "Use Azure Update Manager as a patching mechanism for Windows and Linux VMs outside of Azure using Azure Arc.",
            "training": "https://learn.microsoft.com/azure/update-manager/overview?tabs=azure-vms",
            "waf": "Operations"
        },
        {
            "category": "Management",
            "checklist": "Azure Landing Zone Review",
            "guid": "90483845-c986-4cb2-a131-56a12476e49f",
            "link": "https://learn.microsoft.com/azure/network-watcher/network-watcher-monitoring-overview",
            "service": "Network Watcher",
            "services": [
                "NetworkWatcher",
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Monitoring",
            "text": "Use Network Watcher to proactively monitor traffic flows.",
            "training": "https://learn.microsoft.com/learn/modules/configure-network-watcher/",
            "waf": "Operations"
        },
        {
            "category": "Management",
            "checklist": "Azure Landing Zone Review",
            "guid": "541acdce-9793-477b-adb3-751ab2ab13ad",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/lock-resources?tabs=json",
            "services": [
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Monitoring",
            "text": "Use resource locks to prevent accidental deletion of critical shared services.",
            "training": "https://learn.microsoft.com/learn/paths/implement-resource-mgmt-security/",
            "waf": "Operations"
        },
        {
            "category": "Management",
            "checklist": "Azure Landing Zone Review",
            "guid": "a6e55d7d-8a2a-4db1-87d6-326af625ca44",
            "link": "https://learn.microsoft.com/azure/governance/policy/concepts/effect-deny",
            "services": [
                "AzurePolicy",
                "RBAC",
                "Monitor"
            ],
            "severity": "Low",
            "subcategory": "Monitoring",
            "text": "Use deny policies to supplement Azure role assignments. The combination of deny policies and Azure role assignments ensures the appropriate guardrails are in place to enforce who can deploy and configure resources and what resources they can deploy and configure.",
            "training": "https://learn.microsoft.com/azure/role-based-access-control/deny-assignments?tabs=azure-portal",
            "waf": "Operations"
        },
        {
            "category": "Management",
            "checklist": "Azure Landing Zone Review",
            "guid": "e5695f22-23ac-4e8c-a123-08ca5017f154",
            "link": "https://learn.microsoft.com/azure/service-health/alerts-activity-log-service-notifications-portal",
            "services": [
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Monitoring",
            "text": "Include service and resource health events as part of the overall platform monitoring solution. Tracking service and resource health from the platform perspective is an important component of resource management in Azure.",
            "training": "https://learn.microsoft.com/training/modules/intro-to-azure-service-health/",
            "waf": "Operations"
        },
        {
            "category": "Management",
            "checklist": "Azure Landing Zone Review",
            "guid": "d5f345bf-97ab-41a7-819c-6104baa7d48c",
            "link": "https://learn.microsoft.com/azure/azure-monitor/alerts/action-groups",
            "services": [
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Monitoring",
            "text": "Include alerts and action groups as part of the Azure Service Health platform to ensure that alerts or issues can be actioned.",
            "training": "https://learn.microsoft.com/en-gb/training/modules/incident-response-with-alerting-on-azure/7-actions-and-alert-processing-rules",
            "waf": "Operations"
        },
        {
            "category": "Management",
            "checklist": "Azure Landing Zone Review",
            "guid": "e3ab3693-829e-47e3-8618-3687a0477a20",
            "link": "https://learn.microsoft.com/azure/sentinel/quickstart-onboard",
            "services": [
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Monitoring",
            "text": "Don't send raw log entries back to on-premises monitoring systems. Instead, adopt a principle that data born in Azure stays in Azure. If on-premises SIEM integration is required, then send critical alerts instead of logs.",
            "training": "https://learn.microsoft.com/azure/cloud-adoption-framework/decision-guides/logging-and-reporting/",
            "waf": "Operations"
        },
        {
            "category": "Management",
            "checklist": "Azure Landing Zone Review",
            "guid": "6944008b-e7d7-4e48-9327-6d8bdc055bcf",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-setup-guide/monitoring-reporting?tabs=AzureMonitor",
            "service": "Monitor",
            "services": [
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Monitoring",
            "text": "Use Azure Monitor Logs for insights and reporting.",
            "training": "https://learn.microsoft.com/training/modules/configure-azure-monitor/",
            "waf": "Operations"
        },
        {
            "category": "Management",
            "checklist": "Azure Landing Zone Review",
            "guid": "619e8a13-f988-4795-85d6-26886d70ba6c",
            "link": "https://learn.microsoft.com/azure/azure-monitor/agents/diagnostics-extension-overview",
            "services": [
                "Monitor",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Monitoring",
            "text": "When necessary, use shared storage accounts within the landing zone for Azure diagnostic extension log storage.",
            "training": "https://learn.microsoft.com/training/modules/configure-virtual-machine-extensions/",
            "waf": "Operations"
        },
        {
            "category": "Management",
            "checklist": "Azure Landing Zone Review",
            "guid": "97be9951-9048-4384-9c98-6cb2913156a1",
            "link": "https://learn.microsoft.com/azure/azure-monitor/alerts/alerts-overview",
            "service": "Monitor",
            "services": [
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Monitoring",
            "text": "Use Azure Monitor alerts for the generation of operational alerts.",
            "training": "https://learn.microsoft.com/training/modules/incident-response-with-alerting-on-azure/",
            "waf": "Operations"
        },
        {
            "category": "Management",
            "checklist": "Azure Landing Zone Review",
            "guid": "859c3900-4514-41eb-b010-475d695abd74",
            "link": "https://learn.microsoft.com/azure/architecture/best-practices/monitoring",
            "services": [
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Monitoring",
            "text": "Ensure that monitoring requirements have been assessed and that appropriate data collection and alerting configurations are applied.",
            "training": "https://learn.microsoft.com/training/paths/az-104-monitor-backup-resources/",
            "waf": "Operations"
        },
        {
            "category": "Management",
            "checklist": "Azure Landing Zone Review",
            "guid": "fed3c55f-a67e-4875-aadd-3aba3f9fde31",
            "link": "https://learn.microsoft.com/azure/automation/how-to/region-mappings",
            "service": "Monitor",
            "services": [
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Monitoring",
            "text": "When using Change and Inventory Tracking via Azure Automation Accounts, ensure that you have selected supported regions for linking your Log Analytics workspace and automation accounts together.",
            "training": "https://learn.microsoft.com/training/modules/explore-azure-automation-devops/",
            "waf": "Operations"
        },
        {
            "category": "Management",
            "checklist": "Azure Landing Zone Review",
            "guid": "aa45be6a-8f2d-4896-b0e3-775e6e94e610",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/management-monitor",
            "services": [
                "AzurePolicy",
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Monitoring",
            "text": "Deploy AMBA to establish monitoring for platform components of your landing zone - AMBA is a framework solution that is available and provides an easy way to scale alerting by using Azure Policy.",
            "training": "https://azure.github.io/azure-monitor-baseline-alerts/patterns/alz/",
            "waf": "Operations"
        },
        {
            "category": "Management",
            "checklist": "Azure Landing Zone Review",
            "guid": "aa45be6a-8f2d-4896-b0e3-885e6e94e770",
            "link": "https://learn.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-overview",
            "services": [
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Monitoring",
            "text": "Use Azure Monitoring Agent (AMA). The Log Analytics agent is deprecated since August 31,2024",
            "training": "https://learn.microsoft.com/azure/azure-monitor/agents/azure-monitor-agent-overview#installation",
            "waf": "Operations"
        },
        {
            "category": "Management",
            "checklist": "Azure Landing Zone Review",
            "graph": "Resources | where type =~ 'Microsoft.Storage/storageAccounts' | where sku.name in~ ('Standard_LRS', 'Premium_LRS') | project name, id, tags, param1 = strcat('sku: ', sku.name)",
            "guid": "0d83fd81-952c-4d47-a6cb-3a930925ef2e",
            "link": "https://learn.microsoft.com/en-gb/azure/storage/common/redundancy-migration?tabs=portal",
            "services": [
                "Cost",
                "Storage"
            ],
            "severity": "High",
            "subcategory": "Data Protection",
            "text": "Ensure that storage accounts are zone or region redundant, Redundancy ensures storage accounts meet availability and durability targets amidst failures, weighing lower costs against higher availability. Locally redundant storage offers the least durability at the lowest cost.",
            "training": "https://learn.microsoft.com/azure/storage/common/storage-redundancy",
            "waf": "Reliability"
        },
        {
            "category": "Management",
            "checklist": "Azure Landing Zone Review",
            "guid": "7ea02e1c-7166-45a3-bdf5-098891367fcb",
            "link": "https://learn.microsoft.com/azure/reliability/cross-region-replication-azure",
            "services": [],
            "severity": "Medium",
            "subcategory": "Data Protection",
            "text": "Enable cross-region replication in Azure for BCDR with paired regions.",
            "training": "https://learn.microsoft.com/training/modules/provide-disaster-recovery-replicate-storage-data/",
            "waf": "Reliability"
        },
        {
            "category": "Management",
            "checklist": "Azure Landing Zone Review",
            "guid": "eba8cf22-45c6-4dc1-9b57-2cceb3b97ce5",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-redundancy",
            "service": "Backup",
            "services": [
                "Backup"
            ],
            "severity": "Low",
            "subcategory": "Data Protection",
            "text": "When using Azure Backup, use the correct backup types (GRS, ZRS & LRS) for your backup, as the default setting is GRS.",
            "training": "https://learn.microsoft.com/training/modules/design-solution-for-backup-disaster-recovery/",
            "waf": "Reliability"
        },
        {
            "category": "Management",
            "checklist": "Azure Landing Zone Review",
            "guid": "f541acdc-e979-4377-acdb-3751ab2ab13a",
            "link": "https://learn.microsoft.com/azure/governance/policy/concepts/guest-configuration",
            "service": "VM",
            "services": [
                "AzurePolicy",
                "VM"
            ],
            "severity": "Medium",
            "subcategory": "Operational compliance",
            "text": "Use Azure guest policies to automatically deploy software configurations through VM extensions and enforce a compliant baseline VM configuration.",
            "waf": "Security"
        },
        {
            "category": "Management",
            "checklist": "Azure Landing Zone Review",
            "description": "Use Azure Policy's guest configuration features  to audit and remediate machine settings (e.g., OS, application, environment) to ensure resources align with expected configurations, and Update Management can enforce patch management for VMs.",
            "guid": "da6e55d7-d8a2-4adb-817d-6326af625ca4",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/management-operational-compliance#monitoring-for-configuration-drift",
            "service": "VM",
            "services": [
                "AzurePolicy",
                "Monitor",
                "VM"
            ],
            "severity": "Medium",
            "subcategory": "Operational compliance",
            "text": "Monitor VM security configuration drift via Azure Policy.",
            "training": "https://learn.microsoft.com/training/paths/implement-resource-mgmt-security/",
            "waf": "Security"
        },
        {
            "category": "Management",
            "checklist": "Azure Landing Zone Review",
            "guid": "2476e49f-541a-4cdc-b979-377bcdb3751a",
            "link": "https://learn.microsoft.com/azure/site-recovery/site-recovery-overview",
            "service": "VM",
            "services": [
                "ACR",
                "VM",
                "ASR"
            ],
            "severity": "Medium",
            "subcategory": "Protect and Recover",
            "text": "Use Azure Site Recovery for Azure-to-Azure Virtual Machines disaster recovery scenarios. This enables you to replicate workloads across regions.",
            "training": "https://learn.microsoft.com/training/modules/protect-infrastructure-with-site-recovery/",
            "waf": "Operations"
        },
        {
            "category": "Management",
            "checklist": "Azure Landing Zone Review",
            "guid": "b2ab13ad-a6e5-45d7-b8a2-adb117d6326a",
            "link": "https://learn.microsoft.com/azure/architecture/framework/resiliency/backup-and-recovery",
            "services": [
                "ASR"
            ],
            "severity": "Medium",
            "subcategory": "Protect and Recover",
            "text": "Use native PaaS service disaster recovery capabilities.  Perform failover testing with these capabilities.",
            "training": "https://learn.microsoft.com/en-us/training/modules/explore-iaas-paas-platform-tools-for-high-availability-disaster-recovery/",
            "waf": "Operations"
        },
        {
            "category": "Management",
            "checklist": "Azure Landing Zone Review",
            "guid": "f625ca44-e569-45f2-823a-ce8cb12308ca",
            "link": "https://learn.microsoft.com/azure/backup/backup-center-overview",
            "service": "Backup",
            "services": [
                "Backup"
            ],
            "severity": "Medium",
            "subcategory": "Protect and Recover",
            "text": "Use Azure-native backup capabilities, or an Azure-compatible, 3rd-party backup solution.",
            "training": "https://learn.microsoft.com/training/modules/design-solution-for-backup-disaster-recovery/",
            "waf": "Operations"
        },
        {
            "category": "Management",
            "checklist": "Azure Landing Zone Review",
            "guid": "89cc5e11-aa4d-4c3b-893d-feb99215266a",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#add-diagnostic-settings-to-save-your-wafs-logs",
            "service": "WAF",
            "services": [
                "WAF",
                "FrontDoor",
                "AppGW"
            ],
            "severity": "High",
            "subcategory": "App delivery",
            "text": "Add diagnostic settings to save WAF logs from application delivery services like Azure Front Door and Azure Application Gateway. Regularly review the logs to check for attacks and for false positive detections.",
            "training": "https://learn.microsoft.com/training/modules/capture-application-logs-app-service/",
            "waf": "Operations"
        },
        {
            "category": "Management",
            "checklist": "Azure Landing Zone Review",
            "guid": "7f408960-c626-44cb-a018-347c8d790cdf",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#send-logs-to-microsoft-sentinel",
            "service": "WAF",
            "services": [
                "WAF",
                "FrontDoor",
                "Sentinel",
                "AppGW"
            ],
            "severity": "Medium",
            "subcategory": "App delivery",
            "text": "Send WAF logs from your application delivery services like Azure Front Door and Azure Application Gateway to Microsoft Sentinel. Detect attacks and integrate WAF telemetry into your overall Azure environment.",
            "training": "https://learn.microsoft.com/training/paths/sc-200-connect-logs-to-azure-sentinel/",
            "waf": "Operations"
        },
        {
            "category": "Security",
            "checklist": "Azure Landing Zone Review",
            "guid": "b86ad884-08e3-4727-94b8-75ba18f20459",
            "link": "https://learn.microsoft.com/security/benchmark/azure/security-control-incident-response",
            "services": [],
            "severity": "Medium",
            "subcategory": "Access control",
            "text": "Determine the incident response plan for Azure services before allowing it into production.",
            "training": "https://learn.microsoft.com/training/modules/intro-to-azure-incident-readiness/",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Landing Zone Review",
            "guid": "01365d38-e43f-49cc-ad86-8266abca264f",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/security-zero-trust",
            "services": [],
            "severity": "Medium",
            "subcategory": "Access control",
            "text": "Apply a zero-trust approach for access to the Azure platform.",
            "training": "https://learn.microsoft.com/training/modules/introduction-zero-trust-best-practice-frameworks/",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Landing Zone Review",
            "guid": "5017f154-e3ab-4369-9829-e7e316183687",
            "link": "https://learn.microsoft.com/azure/key-vault/general/overview",
            "service": "Key Vault",
            "services": [
                "AKV"
            ],
            "severity": "High",
            "subcategory": "Encryption and keys",
            "text": "Use Azure Key Vault to store your secrets and credentials.",
            "training": "https://learn.microsoft.com/training/modules/implement-azure-key-vault/",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Landing Zone Review",
            "graph": "ResourceContainers | where type=='microsoft.resources/subscriptions'| parse id with '/subscriptions/' SubscriptionID| project subscriptionId, SubscriptionName = name| join kind=leftouter (Resources| where type == 'microsoft.keyvault/vaults'| project id, name, subscriptionId) on subscriptionId| join kind= leftouter (Resources| where type == 'microsoft.keyvault/vaults'| summarize ResourceCount = count() by subscriptionId) on subscriptionId| extend RCount = iff(isnull(ResourceCount), 0, ResourceCount)| project-away ResourceCount| extend compliant = (RCount <> 1)",
            "guid": "a0477a20-9945-4bda-9333-4f2491163418",
            "link": "https://learn.microsoft.com/azure/key-vault/general/overview-throttling",
            "service": "Key Vault",
            "services": [
                "AKV"
            ],
            "severity": "Medium",
            "subcategory": "Encryption and keys",
            "text": "Use different Azure Key Vaults for different applications and regions to avoid transaction scale limits and restrict access to secrets.",
            "training": "https://learn.microsoft.com/training/modules/configure-and-manage-azure-key-vault/",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Landing Zone Review",
            "guid": "2ba52752-6944-4008-ae7d-7e4843276d8b",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "services": [
                "AzurePolicy",
                "AKV"
            ],
            "severity": "Medium",
            "subcategory": "Encryption and keys",
            "text": "Provision Azure Key Vault with the soft delete and purge policies enabled to allow retention protection for deleted objects.",
            "training": "https://learn.microsoft.com/training/modules/implement-azure-key-vault/",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Landing Zone Review",
            "guid": "dc055bcf-619e-48a1-9f98-879525d62688",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "services": [
                "AKV",
                "RBAC",
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Encryption and keys",
            "text": "Follow a least privilege model by limiting authorization to permanently delete keys, secrets, and certificates to specialized custom Microsoft Entra ID roles.",
            "training": "https://learn.microsoft.com/training/modules/implement-azure-key-vault/",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Landing Zone Review",
            "guid": "6d70ba6c-97be-4995-8904-83845c986cb2",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "services": [
                "AKV"
            ],
            "severity": "Medium",
            "subcategory": "Encryption and keys",
            "text": "Automate the certificate management and renewal process with public certificate authorities to ease administration.",
            "training": "https://learn.microsoft.com/en-us/training/modules/configure-and-manage-azure-key-vault/",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Landing Zone Review",
            "guid": "913156a1-2476-4e49-b541-acdce979377b",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "services": [
                "AKV"
            ],
            "severity": "Medium",
            "subcategory": "Encryption and keys",
            "text": "Establish an automated process for key and certificate rotation.",
            "training": "https://learn.microsoft.com/training/modules/configure-and-manage-azure-key-vault/",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Landing Zone Review",
            "guid": "cdb3751a-b2ab-413a-ba6e-55d7d8a2adb1",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "services": [
                "AKV",
                "VNet",
                "PrivateLink"
            ],
            "severity": "Medium",
            "subcategory": "Encryption and keys",
            "text": "Enable firewall and virtual network service endpoint or private endpoint on the vault to control access to the key vault.",
            "training": "https://learn.microsoft.com/training/modules/design-implement-private-access-to-azure-services/",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Landing Zone Review",
            "guid": "17d6326a-f625-4ca4-9e56-95f2223ace8c",
            "link": "https://learn.microsoft.com/azure/key-vault/general/monitor-key-vault",
            "service": "Key Vault",
            "services": [
                "AKV",
                "Monitor",
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Encryption and keys",
            "text": "Use the platform-central Azure Monitor Log Analytics workspace to audit key, certificate, and secret usage within each instance of Key Vault.",
            "training": "https://learn.microsoft.com/training/modules/analyze-infrastructure-with-azure-monitor-logs/",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Landing Zone Review",
            "guid": "b12308ca-5017-4f15-9e3a-b3693829e7e3",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "services": [
                "AzurePolicy",
                "AKV"
            ],
            "severity": "Medium",
            "subcategory": "Encryption and keys",
            "text": "Delegate Key Vault instantiation and privileged access and use Azure Policy to enforce a consistent compliant configuration.",
            "training": "https://learn.microsoft.com/training/modules/configure-azure-key-vault-networking-settings/",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Landing Zone Review",
            "guid": "16183687-a047-47a2-8994-5bda43334f24",
            "link": "https://learn.microsoft.com/azure/security/fundamentals/encryption-atrest",
            "services": [
                "AKV"
            ],
            "severity": "Medium",
            "subcategory": "Encryption and keys",
            "text": "Default to Microsoft-managed keys for principal encryption functionality and use customer-managed keys when required.",
            "training": "https://learn.microsoft.com/training/modules/implement-azure-key-vault/",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Landing Zone Review",
            "guid": "91163418-2ba5-4275-8694-4008be7d7e48",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "services": [
                "AKV"
            ],
            "severity": "Medium",
            "subcategory": "Encryption and keys",
            "text": "Use an Azure Key Vault per application per environment per region.",
            "training": "https://learn.microsoft.com/training/modules/implement-azure-key-vault/",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Landing Zone Review",
            "guid": "25d62688-6d70-4ba6-a97b-e99519048384",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "services": [
                "AKV",
                "ACR",
                "ASR"
            ],
            "severity": "Medium",
            "subcategory": "Encryption and keys",
            "text": "If you want to bring your own keys, this might not be supported across all considered services. Implement relevant mitigation so that inconsistencies don't hinder desired outcomes. Choose appropriate region pairs and disaster recovery regions that minimize latency.",
            "training": "https://learn.microsoft.com/training/modules/configure-and-manage-azure-key-vault/",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Landing Zone Review",
            "guid": "4ac6b67c-b3a4-4ff9-8e87-b07a7ce7bbdb",
            "link": "https://learn.microsoft.com/industry/sovereignty/key-management",
            "service": "Key Vault",
            "services": [
                "AKV"
            ],
            "severity": "Medium",
            "subcategory": "Encryption and keys",
            "text": "For Sovereign Landing Zone, use Azure Key Vault managed HSM to store your secrets and credentials.",
            "training": "https://learn.microsoft.com/training/modules/configure-and-manage-azure-key-vault/",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Landing Zone Review",
            "guid": "4e5695f2-223a-4ce8-ab12-308ca5017f15",
            "link": "https://learn.microsoft.com/azure/active-directory/reports-monitoring/overview-reports",
            "service": "Entra",
            "services": [
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Operations",
            "text": "Use Microsoft Entra ID reporting capabilities to generate access control audit reports.",
            "training": "https://learn.microsoft.com/training/modules/monitor-report-aad-security-events/",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Landing Zone Review",
            "guid": "4e3ab369-3829-4e7e-9161-83687a0477a2",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/logs-data-export?tabs=portal",
            "services": [
                "Monitor",
                "ARS",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Operations",
            "text": "Export Azure activity logs to Azure Monitor Logs for long-term data retention. Export to Azure Storage for long-term storage beyond two years, if necessary.",
            "training": "https://learn.microsoft.com/training/modules/analyze-infrastructure-with-azure-monitor-logs/",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Landing Zone Review",
            "guid": "09945bda-4333-44f2-9911-634182ba5275",
            "link": "https://learn.microsoft.com/azure/defender-for-cloud/concept-cloud-security-posture-management",
            "service": "Defender",
            "services": [
                "Subscriptions",
                "Defender"
            ],
            "severity": "High",
            "subcategory": "Operations",
            "text": "Enable Defender Cloud Security Posture Management for all subscriptions.",
            "training": "https://learn.microsoft.com/training/modules/microsoft-defender-cloud-security-posture/",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Landing Zone Review",
            "guid": "36a72a48-fffe-4c40-9747-0ab5064355ba",
            "link": "https://learn.microsoft.com/azure/defender-for-cloud/plan-defender-for-servers-select-plan",
            "service": "Defender",
            "services": [
                "Subscriptions",
                "Defender"
            ],
            "severity": "High",
            "subcategory": "Operations",
            "text": "Enable a Defender Cloud Workload Protection Plan for Servers on all subscriptions.",
            "training": "https://learn.microsoft.com/training/modules/understand-azure-defender-cloud-workload-protection/",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Landing Zone Review",
            "guid": "77425f48-ecba-43a0-aeac-a3ac733ccc6a",
            "link": "https://learn.microsoft.com/azure/defender-for-cloud/connect-azure-subscription",
            "service": "Defender",
            "services": [
                "Subscriptions",
                "Defender"
            ],
            "severity": "High",
            "subcategory": "Operations",
            "text": "Enable Defender Cloud Workload Protection Plans for Azure Resources on all subscriptions.",
            "training": "https://learn.microsoft.com/training/modules/understand-azure-defender-cloud-workload-protection/",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Landing Zone Review",
            "guid": "24d96b30-61ee-4436-a1cc-d6ef08bc574b",
            "link": "https://learn.microsoft.com/mem/configmgr/protect/deploy-use/endpoint-protection",
            "service": "VM",
            "services": [],
            "severity": "High",
            "subcategory": "Operations",
            "text": "Enable Endpoint Protection on IaaS Servers.",
            "training": "https://learn.microsoft.com/training/modules/design-solutions-securing-server-client-endpoints/",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Landing Zone Review",
            "guid": "15833ee7-ad6c-46d3-9331-65c7acbe44ab",
            "link": "https://learn.microsoft.com/azure/security-center/",
            "service": "VM",
            "services": [
                "Monitor",
                "Defender"
            ],
            "severity": "Medium",
            "subcategory": "Operations",
            "text": "Monitor base operating system patching drift via Azure Monitor Logs and Defender for Cloud.",
            "training": "https://learn.microsoft.com/training/modules/create-log-analytics-workspace-microsoft-defender-cloud/",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Landing Zone Review",
            "guid": "e5f8d79f-2e87-4768-924c-516775c6ea95",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/design-logs-deployment",
            "service": "Monitor",
            "services": [
                "Entra",
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Operations",
            "text": "Connect default resource configurations to a centralized Azure Monitor Log Analytics workspace.",
            "training": "https://learn.microsoft.com/training/modules/analyze-infrastructure-with-azure-monitor-logs/",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources| where type == 'microsoft.operationalinsights/workspaces'| extend wsid = properties.customerId| project workspaceResourceId = tolower(id), name, wsid| join (resources| where type == 'microsoft.operationsmanagement/solutions'| where name has 'SecurityInsights'| extend workspaceResourceId = tostring(tolower(properties.workspaceResourceId))| project workspaceResourceId | summarize ResourceCount = count() by workspaceResourceId) on workspaceResourceId| extend RCount = iff(isnull(ResourceCount), 0, ResourceCount)| project-away ResourceCount| extend compliant = (RCount <> 0)",
            "guid": "a56888b2-7e83-4404-bd31-b886528502d1",
            "link": "https://learn.microsoft.com/en-us/azure/well-architected/security/monitor-threats#centralized-threat-detection-with-correlated-logs",
            "service": "Entra",
            "services": [
                "Entra",
                "ACR"
            ],
            "severity": "High",
            "subcategory": "Operations",
            "text": "Centralized threat detection with correlated logs -  consolidate security data in a central location where it can be correlated across various services via SIEM (security information and event management)",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Landing Zone Review",
            "guid": "1761e147-f65e-4d09-bbc2-f464f23e2eba",
            "link": "https://learn.microsoft.com/industry/sovereignty/transparency-logs",
            "service": "Entra",
            "services": [
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Operations",
            "text": "For Sovereign Landing Zone, enable transparancy logs on the Entra ID tenant.",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Landing Zone Review",
            "guid": "d21a922d-5ca7-427a-82a6-35f7b21f1bfc",
            "link": "https://learn.microsoft.com/azure/security/fundamentals/customer-lockbox-overview",
            "service": "Entra",
            "services": [
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Operations",
            "text": "For Sovereign Landing Zone, enable customer Lockbox on the Entra ID tenant.",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Landing Zone Review",
            "guid": "874a748b-662d-46d1-9051-2a66498f6dfe",
            "link": "https://learn.microsoft.com/azure/event-grid/set-alerts",
            "services": [
                "Monitor"
            ],
            "severity": "Low",
            "subcategory": "Operations",
            "text": "Use an Azure Event Grid-based solution for log-oriented, real-time alerts.",
            "training": "https://learn.microsoft.com/training/modules/azure-event-grid/",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Landing Zone Review",
            "guid": "b03ed428-4617-4067-a787-85468b9ccf3f",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-require-secure-transfer",
            "service": "Storage",
            "services": [
                "Storage"
            ],
            "severity": "High",
            "subcategory": "Overview",
            "text": "Enable secure transfer to storage accounts.",
            "training": "https://learn.microsoft.com/training/modules/secure-azure-storage-account/",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Landing Zone Review",
            "guid": "159aac9f-863f-4f48-82cf-00c28fa97a0e",
            "link": "https://learn.microsoft.com/azure/storage/blobs/data-protection-overview#recommendations-for-basic-data-protection",
            "service": "Storage",
            "services": [
                "Storage"
            ],
            "severity": "High",
            "subcategory": "Overview",
            "text": "Enable container soft delete for the storage account to recover a deleted container and its contents.",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Landing Zone Review",
            "guid": "6f704104-85c1-441f-96d3-c9819911645e",
            "link": "https://learn.microsoft.com/azure/active-directory/roles/security-planning",
            "services": [
                "Entra"
            ],
            "severity": "High",
            "subcategory": "Secure privileged access",
            "text": "Separate privileged admin accounts for Azure administrative tasks.",
            "training": "https://learn.microsoft.com/training/modules/design-solutions-secure-privileged-access/",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Landing Zone Review",
            "guid": "9a19bf39-c95d-444c-9c89-19ca1f6d5215",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/service-enablement-framework",
            "services": [],
            "severity": "Medium",
            "subcategory": "Service enablement framework",
            "text": "Plan how new azure services will be implemented.",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure Landing Zone Review",
            "guid": "ae514b93-3d45-485e-8112-9bd7ba012f7b",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/service-enablement-framework",
            "services": [],
            "severity": "Medium",
            "subcategory": "Service enablement framework",
            "text": "Plan how service request will be fulfilled for Azure services.",
            "waf": "Security"
        },
        {
            "category": "Platform Automation and DevOps",
            "checklist": "Azure Landing Zone Review",
            "guid": "e85f4226-bf06-4e35-8a8b-7aee4d2d633a",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/platform-automation-devops",
            "services": [],
            "severity": "High",
            "subcategory": "DevOps Team Topologies",
            "text": "Ensure you have a cross functional DevOps Platform Team to build, manage and maintain your Azure Landing Zone architecture.",
            "training": "https://learn.microsoft.com/training/modules/choose-an-agile-approach/",
            "waf": "Operations"
        },
        {
            "category": "Platform Automation and DevOps",
            "checklist": "Azure Landing Zone Review",
            "guid": "634146bf-7085-4419-a7b5-f96d2726f6da",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/devops-teams-topologies#design-recommendations",
            "services": [],
            "severity": "Low",
            "subcategory": "DevOps Team Topologies",
            "text": "Aim to define functions for Azure Landing Zone Platform team.",
            "training": "https://learn.microsoft.com/training/paths/az-400-work-git-for-enterprise-devops/",
            "waf": "Operations"
        },
        {
            "category": "Platform Automation and DevOps",
            "checklist": "Azure Landing Zone Review",
            "guid": "a9e65070-c59e-4112-8bf6-c11364d4a2a5",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/devops-teams-topologies#design-recommendations",
            "services": [
                "RBAC"
            ],
            "severity": "Low",
            "subcategory": "DevOps Team Topologies",
            "text": "Aim to define functions for application workload teams to be self-sufficient and not require DevOps Platform Team support. Achieve this through the use of custom RBAC role.",
            "training": "https://learn.microsoft.com/training/paths/az-400-work-git-for-enterprise-devops/",
            "waf": "Operations"
        },
        {
            "category": "Platform Automation and DevOps",
            "checklist": "Azure Landing Zone Review",
            "guid": "165eb5e9-b434-448a-9e24-178632186212",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/infrastructure-as-code",
            "services": [],
            "severity": "Medium",
            "subcategory": "DevOps Team Topologies",
            "text": "Use a CI/CD pipeline to deploy IaC artifacts and ensure the quality of your deployment and Azure environments.",
            "training": "https://learn.microsoft.com/training/modules/manage-multiple-environments-using-bicep-azure-pipelines/",
            "waf": "Operations"
        },
        {
            "category": "Platform Automation and DevOps",
            "checklist": "Azure Landing Zone Review",
            "guid": "0cadb8c7-8fa5-4fbf-8f39-d1fadb3b0460",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/development-strategy-development-lifecycle#automated-builds",
            "services": [],
            "severity": "Medium",
            "subcategory": "DevOps Team Topologies",
            "text": "Include unit tests for IaC and application code as part of your build process.",
            "training": "https://learn.microsoft.com/training/modules/run-quality-tests-build-pipeline/",
            "waf": "Operations"
        },
        {
            "category": "Platform Automation and DevOps",
            "checklist": "Azure Landing Zone Review",
            "guid": "108d5099-a11d-4445-bd8b-e12a5e95412e",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/development-strategy-development-lifecycle#automated-builds",
            "service": "Key Vault",
            "services": [
                "AKV",
                "VM"
            ],
            "severity": "High",
            "subcategory": "DevOps Team Topologies",
            "text": "Use Key Vault secrets to avoid hard-coding sensitive information such as credentials (virtual machines user passwords), certificates or keys.",
            "training": "https://learn.microsoft.com/en-us/training/modules/implement-azure-key-vault/",
            "waf": "Operations"
        },
        {
            "category": "Platform Automation and DevOps",
            "checklist": "Azure Landing Zone Review",
            "guid": "a52e0c98-76b9-4a09-a1c9-6b2babf22ac4",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/subscription-vending",
            "services": [
                "Subscriptions"
            ],
            "severity": "Low",
            "subcategory": "DevOps Team Topologies",
            "text": "Implement automation for new landing zone for applications and workloads through subscription vending.",
            "waf": "Operations"
        },
        {
            "category": "Platform Automation and DevOps",
            "checklist": "Azure Landing Zone Review",
            "guid": "cfe363b5-f579-4284-bc56-a42153e4c10b",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/infrastructure-as-code",
            "services": [],
            "severity": "High",
            "subcategory": "Development Lifecycle",
            "text": "Ensure a version control system is used for source code of applications and IaC developed. Microsoft recommends Git.",
            "training": "https://learn.microsoft.com/training/paths/intro-to-vc-git/",
            "waf": "Operations"
        },
        {
            "category": "Platform Automation and DevOps",
            "checklist": "Azure Landing Zone Review",
            "guid": "c7245dd4-af8a-403a-8bb7-890c1a7cfa9d",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/development-strategy-development-lifecycle",
            "services": [],
            "severity": "Low",
            "subcategory": "Development Lifecycle",
            "text": "Follow a branching strategy to allow teams to collaborate better and efficiently manage version control of IaC and application Code. Review options such as Github Flow.",
            "training": "https://learn.microsoft.com/training/modules/manage-git-branches-workflows/",
            "waf": "Operations"
        },
        {
            "category": "Platform Automation and DevOps",
            "checklist": "Azure Landing Zone Review",
            "guid": "12aeea20-9165-4b3e-bdf2-6795fcd3cdbe",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/development-strategy-development-lifecycle",
            "services": [],
            "severity": "Medium",
            "subcategory": "Development Lifecycle",
            "text": "Adopt a pull request strategy to help keep control of code changes merged into branches.",
            "training": "https://learn.microsoft.com/training/modules/review-azure-infrastructure-changes-using-bicep-pull-requests/",
            "waf": "Operations"
        },
        {
            "category": "Platform Automation and DevOps",
            "checklist": "Azure Landing Zone Review",
            "guid": "2676ae46-65ca-444e-8695-fdddeace4cb1",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/management-platform",
            "services": [],
            "severity": "Medium",
            "subcategory": "Development Lifecycle",
            "text": "Establish a process for using code to implement quick fixes. Always register quick fixes in your team's backlog so each fix can be reworked at a later point, and you can limit technical debt.",
            "training": "https://learn.microsoft.com/training/modules/branch-merge-git/",
            "waf": "Operations"
        },
        {
            "category": "Platform Automation and DevOps",
            "checklist": "Azure Landing Zone Review",
            "guid": "2cdc9d99-dbcc-4ad4-97f5-e7d358bdfa73",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/infrastructure-as-code",
            "services": [],
            "severity": "High",
            "subcategory": "Development Strategy",
            "text": "Leverage Declarative Infrastructure as Code Tools such as Azure Bicep, ARM Templates or Terraform to build and maintain your Azure Landing Zone architecture. Both from a Platform and Application workload perspective.",
            "training": "https://learn.microsoft.com/training/modules/introduction-to-infrastructure-as-code-using-bicep/",
            "waf": "Operations"
        },
        {
            "category": "Platform Automation and DevOps",
            "checklist": "Azure Landing Zone Review",
            "guid": "cc87a3bc-c572-4ad2-92ed-8cabab66160f",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/landing-zone-security#secure",
            "services": [],
            "severity": "High",
            "subcategory": "Security",
            "text": "Integrate security into the already combined process of development and operations in DevOps to mitigate risks in the innovation process.",
            "training": "https://learn.microsoft.com/training/paths/az-400-implement-security-validate-code-bases-compliance/",
            "waf": "Operations"
        },
        {
            "category": "Operations Management",
            "checklist": "Azure Synapse Review Checklist",
            "guid": "fda1dae2-dc95-4d48-a6c7-91dca0f6c565",
            "link": "https://learn.microsoft.com/azure/synapse-analytics/sql-data-warehouse/backup-and-restore#geo-backups-and-disaster-recovery",
            "services": [
                "Backup"
            ],
            "severity": "Medium",
            "subcategory": "Backup",
            "text": "Enable Geo Backup ",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Azure Synapse Review Checklist",
            "guid": "89e558b9-37d4-4974-b111-2dbd7baf12e7",
            "link": "https://techcommunity.microsoft.com/t5/azure-synapse-analytics-blog/how-to-use-ci-cd-integration-to-automate-the-deploy-of-a-synapse/ba-p/2248060",
            "services": [],
            "severity": "Medium",
            "subcategory": "DevOps",
            "text": "Integrate with Azure DevOps to deploy Multiple environments",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Azure Synapse Review Checklist",
            "guid": "b94ef6e0-47d2-4da2-a82b-1cd6d2f54b29",
            "link": "https://learn.microsoft.com/azure/architecture/example-scenario/analytics/pipelines-disaster-recovery",
            "services": [],
            "severity": "High",
            "subcategory": "DR",
            "text": "BCDR for Azure Synapse pipelines ",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Azure Synapse Review Checklist",
            "guid": "769e3a69-1e88-438a-a936-667e13c00567",
            "link": "https://learn.microsoft.com/azure/architecture/example-scenario/analytics/pipelines-disaster-recovery",
            "services": [],
            "severity": "High",
            "subcategory": "DR",
            "text": "Use Zone Redudant pipelines in regions supporting Availablity Zones",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Azure Synapse Review Checklist",
            "guid": "4b1e944a-4598-437e-b7ad-6c6d3b365a5c",
            "link": "https://learn.microsoft.com/azure/synapse-analytics/cicd/source-control",
            "services": [],
            "severity": "Low",
            "subcategory": "DevOps",
            "text": "Create Scripts for all DLL Statements and save in Git Repository ",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Azure Synapse Review Checklist",
            "guid": "7acbe48a-be54-4cd7-af2e-87768358c559",
            "link": "https://learn.microsoft.com/azure/synapse-analytics/spark/apache-spark-development-using-notebooks",
            "services": [],
            "severity": "Low",
            "subcategory": "DevOps",
            "text": "When working with Spark Notebooks, make sure to integrate with Git or Azure DevOps",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Azure Synapse Review Checklist",
            "guid": "775c6ee9-5b86-4ad8-a44c-e3b2b38b875b",
            "link": "https://learn.microsoft.com/azure/synapse-analytics/sql-data-warehouse/backup-and-restore",
            "services": [],
            "severity": "Medium",
            "subcategory": "High Availablity",
            "text": "Use Dedicated pools",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Azure Synapse Review Checklist",
            "guid": "a1cf2049-9013-4a5d-9ce4-74dbcbd8682a",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/migrate/azure-best-practices/analytics/azure-synapse",
            "services": [],
            "severity": "Medium",
            "subcategory": "DR",
            "text": "Use Database restore points for Azure Synapse",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Azure Synapse Review Checklist",
            "guid": "6abca2a4-fda1-4dae-8dc9-5d48c6c791dc",
            "link": "https://learn.microsoft.com/azure/synapse-analytics/sql/on-demand-workspace-overview",
            "services": [],
            "severity": "Medium",
            "subcategory": "High Availablity",
            "text": "Use Serverless Pools when required",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Azure Synapse Review Checklist",
            "guid": "a0f6c565-89e5-458b-a37d-4974e1112dbd",
            "link": "https://learn.microsoft.com/azure/synapse-analytics/quickstart-deployment-template-workspaces",
            "services": [
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "DevOps",
            "text": "Use Infrastructure as a Code template to do repeatable deployments",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Azure Synapse Review Checklist",
            "guid": "7baf12e7-b94e-4f6e-847d-2da2982b1cd6",
            "link": "https://learn.microsoft.com/azure/cosmos-db/synapse-link",
            "services": [],
            "severity": "Medium",
            "subcategory": "High Availablity",
            "text": "Make sure to re-eshtablish any Synapse Links",
            "training": "https://learn.microsoft.com/azure/active-directory/managed-identities-azure-resources/overview",
            "waf": "Reliability"
        },
        {
            "category": "BC and DR",
            "checklist": "Azure App Service Review",
            "guid": "b32e1aa1-4813-4602-88fe-27ca2891f421",
            "link": "https://learn.microsoft.com/en-us/azure/architecture/reference-architectures/app-service-web-app/zone-redundant?source=recommendations",
            "service": "App Services",
            "services": [
                "AppSvc"
            ],
            "severity": "Low",
            "subcategory": "High Availability",
            "text": "Refer to baseline highly available zone-redundant web application architecture for best practices",
            "waf": "Reliability"
        },
        {
            "category": "BC and DR",
            "checklist": "Azure App Service Review",
            "graph": "resources | where type =~ 'microsoft.web/serverfarms' | extend compliant = (sku.tier == 'Premium' or sku.tier == 'Standard') | distinct id,compliant",
            "guid": "e4b31c6a-2e3f-4df1-8e8b-9c3aa5a27820",
            "link": "https://learn.microsoft.com/en-us/azure/app-service/overview-hosting-plans",
            "service": "App Services",
            "services": [
                "AppSvc",
                "Backup"
            ],
            "severity": "Medium",
            "subcategory": "High Availability",
            "text": "Use Premium and Standard tiers. These tiers support staging slots and automated backups.",
            "waf": "Reliability"
        },
        {
            "category": "BC and DR",
            "checklist": "Azure App Service Review",
            "guid": "a7e2e6c2-491f-4fa4-a82b-521d0bc3b202",
            "link": "https://learn.microsoft.com/en-us/azure/reliability/migrate-app-service",
            "service": "App Services",
            "services": [
                "AppSvc"
            ],
            "severity": "High",
            "subcategory": "High Availability",
            "text": "Leverage Availability Zones where regionally applicable (requires Premium v2 or v3 tier)",
            "waf": "Reliability"
        },
        {
            "category": "Operations",
            "checklist": "Azure App Service Review",
            "graph": "appserviceresources  | where type =~ 'microsoft.web/sites/config' | extend compliant = (properties.HealthCheckPath != '') | distinct id,compliant",
            "guid": "1275e4a9-7b6a-43c3-a9cd-5ee18d8995ad",
            "link": "https://learn.microsoft.com/en-us/azure/app-service/monitor-instances-health-check",
            "service": "App Services",
            "services": [
                "AppSvc",
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Monitoring",
            "text": "Implement health checks",
            "waf": "Reliability"
        },
        {
            "category": "Operations",
            "checklist": "Azure App Service Review",
            "guid": "35a91c5d-4ad6-4d9b-8e0f-c47db9e6d1e7",
            "link": "https://learn.microsoft.com/en-us/azure/app-service/manage-backup",
            "service": "App Services",
            "services": [
                "AppSvc",
                "Backup"
            ],
            "severity": "High",
            "subcategory": "Multi-tenant service",
            "text": "Refer to backup and restore best practices for Azure App Service",
            "waf": "Reliability"
        },
        {
            "category": "BC and DR",
            "checklist": "Azure App Service Review",
            "guid": "e68cd0ec-afc6-4bd8-a27f-7860ad9a0db2",
            "link": "https://learn.microsoft.com/en-us/azure/architecture/framework/services/compute/azure-app-service/reliability",
            "service": "App Services",
            "services": [
                "AppSvc"
            ],
            "severity": "High",
            "subcategory": "High Availability",
            "text": "Implement Azure App Service reliability best practices",
            "waf": "Reliability"
        },
        {
            "category": "BC and DR",
            "checklist": "Azure App Service Review",
            "guid": "bd2a865c-0835-4418-bb58-4df91a5a9b3f",
            "link": "https://learn.microsoft.com/en-us/azure/app-service/manage-disaster-recovery#recover-app-content-only",
            "service": "App Services",
            "services": [
                "AppSvc"
            ],
            "severity": "Low",
            "subcategory": "High Availability",
            "text": "Familiarize with how to move an App Service app to another region During a disaster",
            "waf": "Reliability"
        },
        {
            "category": "BC and DR",
            "checklist": "Azure App Service Review",
            "guid": "f3d2f1e4-e6d4-4b7a-a5a5-e2a9b2c6f293",
            "link": "https://learn.microsoft.com/en-us/azure/reliability/reliability-app-service",
            "service": "App Services",
            "services": [
                "AppSvc"
            ],
            "severity": "High",
            "subcategory": "High Availability",
            "text": "Familiarize with reliability support in Azure App Service",
            "waf": "Reliability"
        },
        {
            "category": "BC and DR",
            "checklist": "Azure App Service Review",
            "guid": "c7b5f3d1-0569-4fd2-9f32-c0b64e9c0c5e",
            "link": "https://learn.microsoft.com/en-us/azure/azure-functions/dedicated-plan#always-on",
            "service": "App Services",
            "services": [
                "AppSvc"
            ],
            "severity": "Medium",
            "subcategory": "High Availability",
            "text": "Ensure \"Always On\" is enabled for Function Apps running on a app service plan",
            "waf": "Reliability"
        },
        {
            "category": "Operations",
            "checklist": "Azure App Service Review",
            "guid": "a3b4d5f6-758c-4f9d-9e1a-d7c6b7e8f9ab",
            "link": "https://learn.microsoft.com/en-us/azure/app-service/monitor-instances-health-check",
            "service": "App Services",
            "services": [
                "AppSvc",
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Monitoring",
            "text": "Monitor App Service instances using Health checks",
            "waf": "Reliability"
        },
        {
            "category": "Operations",
            "checklist": "Azure App Service Review",
            "guid": "c7d3e5f9-a19c-4833-8ca6-1dcb0128e129",
            "link": "https://learn.microsoft.com/en-us/azure/azure-monitor/app/availability-overview",
            "service": "App Services",
            "services": [
                "AppSvc",
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Monitoring",
            "text": "Monitor availability and responsiveness of web app or website using Application Insights availability tests",
            "waf": "Reliability"
        },
        {
            "category": "Operations",
            "checklist": "Azure App Service Review",
            "guid": "b4e3f2d5-a5c6-4d7e-8b2f-c5d9e7a8f0ea",
            "link": "https://learn.microsoft.com/en-us/azure/azure-monitor/app/availability-standard-tests",
            "service": "App Services",
            "services": [
                "AppSvc",
                "Monitor"
            ],
            "severity": "Low",
            "subcategory": "Monitoring",
            "text": "Use Application Insights Standard test to monitor availability and responsiveness of web app or website",
            "waf": "Reliability"
        },
        {
            "category": "Security",
            "checklist": "Azure App Service Review",
            "description": "Use Azure Key Vault to store any secrets the application needs.  Key Vault provides a safe and audited environment for storing secrets and is well-integrated with App Service through the Key Vault SDK or App Service Key Vault References.",
            "guid": "834ac932-223e-4ce8-8b12-3071a5416415",
            "link": "https://learn.microsoft.com/azure/app-service/app-service-key-vault-references",
            "service": "App Services",
            "services": [
                "AKV",
                "AppSvc"
            ],
            "severity": "High",
            "subcategory": "Data Protection",
            "text": "Use Key Vault to store secrets",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure App Service Review",
            "description": "Use a Managed Identity to connect to Key Vault either using the Key Vault SDK or through App Service Key Vault References.",
            "guid": "833ea3ad-2c2d-4e73-8165-c3acbef4abe1",
            "link": "https://learn.microsoft.com/azure/app-service/app-service-key-vault-references",
            "service": "App Services",
            "services": [
                "AKV",
                "AppSvc",
                "Entra"
            ],
            "severity": "High",
            "subcategory": "Data Protection",
            "text": "Use Managed Identity to connect to Key Vault",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure App Service Review",
            "description": "Store the App Service TLS certificate in Key Vault.",
            "guid": "f8d39fda-4776-4831-9c11-5775c2ea55b4",
            "link": "https://learn.microsoft.com/azure/app-service/configure-ssl-certificate",
            "service": "App Services",
            "services": [
                "AKV",
                "AppSvc"
            ],
            "severity": "High",
            "subcategory": "Data Protection",
            "text": "Use Key Vault to store TLS certificate.",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure App Service Review",
            "description": "Systems that process sensitive information should be isolated.  To do so, use separate App Service Plans or App Service Environments and consider the use of different subscriptions or management groups.",
            "guid": "6ad48408-ee72-4734-a475-ba18fdbf590c",
            "link": "https://learn.microsoft.com/azure/app-service/overview-hosting-plans",
            "service": "App Services",
            "services": [
                "Subscriptions",
                "AppSvc"
            ],
            "severity": "Medium",
            "subcategory": "Data Protection",
            "text": "Isolate systems that process sensitive information",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure App Service Review",
            "description": "Local disks on App Service are not encrypted and sensitive data should not be stored on those.  (For example: D:\\\\Local and %TMP%).",
            "guid": "e65de8e0-3f9b-4cbd-9682-66abca264f9a",
            "link": "https://learn.microsoft.com/azure/app-service/operating-system-functionality#file-access",
            "service": "App Services",
            "services": [
                "AppSvc",
                "TrafficManager"
            ],
            "severity": "Medium",
            "subcategory": "Data Protection",
            "text": "Do not store sensitive data on local disk",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure App Service Review",
            "description": "For authenticated web application, use a well established Identity Provider like Azure AD or Azure AD B2C.  Leverage the application framework of your choice to integrate with this provider or use the App Service Authentication / Authorization feature.",
            "guid": "919ca0b2-c121-459e-814b-933df574eccc",
            "link": "https://learn.microsoft.com/azure/app-service/overview-authentication-authorization",
            "service": "App Services",
            "services": [
                "Entra",
                "AppSvc"
            ],
            "severity": "Medium",
            "subcategory": "Identity and Access Control",
            "text": "Use an established Identity Provider for authentication",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure App Service Review",
            "description": "Deploy code to App Service from a controlled and trusted environment, like a well-managed and secured DevOps deployment pipeline. This avoids code that was not version controlled and verified to be deployed from a malicious host.",
            "guid": "3f9bcbd4-6826-46ab-aa26-4f9a19aed9c5",
            "link": "https://learn.microsoft.com/azure/app-service/deploy-best-practices",
            "service": "App Services",
            "services": [
                "Entra",
                "AppSvc"
            ],
            "severity": "High",
            "subcategory": "Identity and Access Control",
            "text": "Deploy from a trusted environment",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure App Service Review",
            "description": "Disable basic authentication for both FTP/FTPS and for WebDeploy/SCM.  This disables access to these services and enforces the use of Azure AD secured endpoints for deployment.  Note that the SCM site can also be opened using Azure AD credentials.",
            "guid": "5d04c2c3-919c-4a0b-8c12-159e114b933d",
            "link": "https://learn.microsoft.com/azure/app-service/deploy-configure-credentials#disable-basic-authentication",
            "service": "App Services",
            "services": [
                "Entra",
                "AppSvc"
            ],
            "severity": "High",
            "subcategory": "Identity and Access Control",
            "text": "Disable basic authentication",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure App Service Review",
            "description": "Where possible use Managed Identity to connect to Azure AD secured resources.  If this is not possible, store secrets in Key Vault and connect to Key Vault using a Managed Identity instead.",
            "guid": "f574eccc-d9bd-43ba-bcda-3b54eb2eb03d",
            "link": "https://learn.microsoft.com/azure/app-service/overview-managed-identity?tabs=portal%2Chttp",
            "service": "App Services",
            "services": [
                "AKV",
                "Entra",
                "AppSvc"
            ],
            "severity": "High",
            "subcategory": "Identity and Access Control",
            "text": "Use Managed Identity to connect to resources",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure App Service Review",
            "description": "Where using images stored in Azure Container Registry, pull these using a Managed Identity.",
            "guid": "d9a25827-18d2-4ddb-8072-5769ee6691a4",
            "link": "https://learn.microsoft.com/azure/app-service/configure-custom-container#use-managed-identity-to-pull-image-from-azure-container-registry",
            "service": "App Services",
            "services": [
                "ACR",
                "Entra",
                "AppSvc"
            ],
            "severity": "High",
            "subcategory": "Identity and Access Control",
            "text": "Pull containers using a Managed Identity",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure App Service Review",
            "description": "By configuring the diagnostic settings of App Service, you can send all telemetry to Log Analytics as the central destination for logging and monitoring. This allows you to monitor runtime activity of App Service such as HTTP logs, application logs, platform logs, ...",
            "guid": "47768314-c115-4775-a2ea-55b46ad48408",
            "link": "https://learn.microsoft.com/azure/app-service/troubleshoot-diagnostic-logs",
            "service": "App Services",
            "services": [
                "Entra",
                "AppSvc",
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Logging and Monitoring",
            "text": "Send App Service runtime logs to Log Analytics",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure App Service Review",
            "description": "Set up a diagnostic setting to send the activity log to Log Analytics as the central destination for logging and monitoring. This allows you to monitor control plane activity on the App Service resource itself.",
            "guid": "ee72734b-475b-4a18-bdbf-590ce65de8e0",
            "link": "https://learn.microsoft.com/azure/azure-monitor/essentials/activity-log",
            "service": "App Services",
            "services": [
                "Entra",
                "AppSvc",
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Logging and Monitoring",
            "text": "Send App Service activity logs to Log Analytics",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure App Service Review",
            "description": "Control outbound network access using a combination of regional VNet integration, network security groups and UDR's.  Traffic should be routed to an NVA such as Azure Firewall.  Ensure to monitor the Firewall's logs.",
            "guid": "c12159e1-14b9-433d-b574-ecccd9bd3baf",
            "link": "https://learn.microsoft.com/azure/app-service/overview-vnet-integration",
            "service": "App Services",
            "services": [
                "Firewall",
                "VNet",
                "NVA",
                "AppSvc",
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Network Security",
            "text": "Outbound network access should be controlled",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure App Service Review",
            "description": "You can provide a stable outbound IP by using VNet integration and using a VNet NAT Gateway or an NVA like Azure Firewall.  This allows the receiving party to allow-list based on IP, should that be needed.  Note that for communications towards Azure Services often there's no need to depend on the IP address and mechanics like Service Endpoints should be used instead.  (Also the use of private endpoints on the receiving end avoids for SNAT to happen and provides a stable outbound IP range.)",
            "guid": "cda3b54e-b2eb-403d-b9a2-582718d2ddb1",
            "link": "https://learn.microsoft.com/azure/app-service/networking/nat-gateway-integration",
            "service": "App Services",
            "services": [
                "Firewall",
                "PrivateLink",
                "VNet",
                "NVA",
                "AppSvc",
                "Storage"
            ],
            "severity": "Low",
            "subcategory": "Network Security",
            "text": "Ensure a stable IP for outbound communications towards internet addresses",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure App Service Review",
            "description": "Control inbound network access using a combination of App Service Access Restrictions, Service Endpoints or Private Endpoints. Different access restrictions can be required and configured for the web app itself and the SCM site.",
            "guid": "0725769e-e669-41a4-a34a-c932223ece80",
            "link": "https://learn.microsoft.com/azure/app-service/networking-features#access-restrictions",
            "service": "App Services",
            "services": [
                "AppSvc",
                "PrivateLink"
            ],
            "severity": "High",
            "subcategory": "Network Security",
            "text": "Inbound network access should be controlled",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure App Service Review",
            "description": "Protect against malicious inbound traffic using a Web Application Firewall like Application Gateway or Azure Front Door.  Make sure to monitor the WAF's logs.",
            "guid": "b123071a-5416-4415-a33e-a3ad2c2de732",
            "link": "https://learn.microsoft.com/azure/app-service/networking/app-gateway-with-service-endpoints",
            "service": "App Services",
            "services": [
                "WAF",
                "FrontDoor",
                "AppSvc",
                "AppGW",
                "Monitor"
            ],
            "severity": "High",
            "subcategory": "Network Security",
            "text": "Use a WAF in front of App Service",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure App Service Review",
            "description": "Make sure the WAF cannot be bypassed by locking down access to only the WAF.  Use a combination of Access Restrictions, Service Endpoints and Private Endpoints.",
            "guid": "165c3acb-ef4a-4be1-b8d3-9fda47768314",
            "link": "https://learn.microsoft.com/azure/app-service/networking-features#access-restrictions",
            "service": "App Services",
            "services": [
                "WAF",
                "AppSvc",
                "PrivateLink"
            ],
            "severity": "High",
            "subcategory": "Network Security",
            "text": "Avoid for WAF to be bypassed",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure App Service Review",
            "description": "Set minimum TLS policy to 1.2 in App Service configuration.",
            "graph": "appserviceresources | where type =~ 'microsoft.web/sites/config' | extend compliant = (properties.MinTlsVersion>=1.2) | distinct id,compliant",
            "guid": "c115775c-2ea5-45b4-9ad4-8408ee72734b",
            "link": "https://learn.microsoft.com/azure/app-service/configure-ssl-bindings#enforce-tls-versions",
            "service": "App Services",
            "services": [
                "AzurePolicy",
                "AppSvc"
            ],
            "severity": "Medium",
            "subcategory": "Network Security",
            "text": "Set minimum TLS policy to 1.2",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure App Service Review",
            "description": "Configure App Service to use HTTPS only.  This causes App Service to redirect from HTTP to HTTPS.  Strongly consider the use of HTTP Strict Transport Security (HSTS) in your code or from your WAF, which informs browsers that the site should only be accessed using HTTPS.",
            "graph": "where (type=='microsoft.web/sites' and (kind == 'app' or kind == 'app,linux' )) | extend compliant = (properties.httpsOnly==true) | distinct id,compliant",
            "guid": "475ba18f-dbf5-490c-b65d-e8e03f9bcbd4",
            "link": "https://learn.microsoft.com/azure/app-service/configure-ssl-bindings#enforce-https",
            "service": "App Services",
            "services": [
                "WAF",
                "AppSvc"
            ],
            "severity": "High",
            "subcategory": "Network Security",
            "text": "Use HTTPS only",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure App Service Review",
            "description": "Do not use wildcards in your CORS configuration, as this allows all origins to access the service (thereby defeating the purpose of CORS). Specifically only allow the origins that you expect to be able to access the service.",
            "guid": "68266abc-a264-4f9a-89ae-d9c55d04c2c3",
            "link": "https://learn.microsoft.com/azure/app-service/app-service-web-tutorial-rest-api",
            "service": "App Services",
            "services": [
                "AppSvc",
                "Storage"
            ],
            "severity": "High",
            "subcategory": "Network Security",
            "text": "Wildcards must not be used for CORS",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure App Service Review",
            "description": "Remote debugging must not be turned on in production as this opens additional ports on the service which increases the attack surface. Note that the service does turn of remote debugging automatically after 48 hours.",
            "graph": "appserviceresources | where type =~ 'microsoft.web/sites/config' | extend compliant = (properties.RemoteDebuggingEnabled == false) | distinct id,compliant",
            "guid": "d9bd3baf-cda3-4b54-bb2e-b03dd9a25827",
            "link": "https://learn.microsoft.com/azure/app-service/configure-common#configure-general-settings",
            "service": "App Services",
            "services": [
                "AppSvc"
            ],
            "severity": "High",
            "subcategory": "Network Security",
            "text": "Turn off remote debugging",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure App Service Review",
            "description": "Enable Defender for App Service.  This (amongst other threats) detects communications to known malicious IP addresses.  Review the recommendations from Defender for App Service as part of your operations.",
            "guid": "18d2ddb1-0725-4769-be66-91a4834ac932",
            "link": "https://learn.microsoft.com/azure/defender-for-cloud/defender-for-app-service-introduction",
            "service": "App Services",
            "services": [
                "AppSvc",
                "Defender"
            ],
            "severity": "Medium",
            "subcategory": "Network Security",
            "text": "Enable Defender for Cloud - Defender for App Service",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure App Service Review",
            "description": "Azure provides DDoS Basic protection on its network, which can be improved with intelligent DDoS Standard capabilities which learns about normal traffic patterns and can detect unusual behavior. DDoS Standard applies to a Virtual Network so it must be configured for the network resource in front of the app, such as Application Gateway or an NVA.",
            "guid": "223ece80-b123-4071-a541-6415833ea3ad",
            "link": "https://learn.microsoft.com/azure/ddos-protection/ddos-protection-overview",
            "service": "App Services",
            "services": [
                "WAF",
                "VNet",
                "EventHubs",
                "DDoS",
                "NVA",
                "AppSvc",
                "AppGW"
            ],
            "severity": "Medium",
            "subcategory": "Network Security",
            "text": "Enable DDOS Protection Standard on the WAF VNet",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure App Service Review",
            "description": "Where using images stored in Azure Container Registry, pull these over a virtual network from Azure Container Registry using its private endpoint and the app setting 'WEBSITE_PULL_IMAGE_OVER_VNET'.",
            "guid": "2c2de732-165c-43ac-aef4-abe1f8d39fda",
            "link": "https://learn.microsoft.com/azure/app-service/configure-custom-container#use-an-image-from-a-network-protected-registry",
            "service": "App Services",
            "services": [
                "ACR",
                "VNet",
                "AppSvc",
                "PrivateLink"
            ],
            "severity": "Medium",
            "subcategory": "Network Security",
            "text": "Pull containers over a Virtual Network",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure App Service Review",
            "description": "Conduct a penetration test on the web application following the penetration testing rules of engagement.",
            "guid": "eb2eb03d-d9a2-4582-918d-2ddb10725769",
            "link": "https://learn.microsoft.com/azure/security/fundamentals/pen-testing",
            "service": "App Services",
            "services": [
                "AppSvc"
            ],
            "severity": "Medium",
            "subcategory": "Penetration Testing",
            "text": "Conduct a penetration test",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure App Service Review",
            "description": "Deploy trusted code that was validated and scanned for vulnerabilities according to DevSecOps practices.",
            "guid": "19aed9c5-5d04-4c2c-9919-ca0b2c12159e",
            "link": "https://learn.microsoft.com/azure/architecture/solution-ideas/articles/devsecops-in-azure",
            "service": "App Services",
            "services": [
                "AppSvc"
            ],
            "severity": "Medium",
            "subcategory": "Vulnerability Management",
            "text": "Deploy validated code",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure App Service Review",
            "description": "Use the latest versions of supported platforms, programming languages, protocols, and frameworks.",
            "guid": "114b933d-f574-4ecc-ad9b-d3bafcda3b54",
            "link": "https://learn.microsoft.com/azure/app-service/overview-patch-os-runtime",
            "service": "App Services",
            "services": [
                "AppSvc"
            ],
            "severity": "High",
            "subcategory": "Vulnerability Management",
            "text": "Use up-to-date platforms, languages, protocols and frameworks",
            "waf": "Security"
        },
        {
            "category": "SQL Server on Azure VM",
            "checklist": "SQL Migration Review",
            "description": "When you are creating a SQL Server on Azure VM, carefully consider the type of workload necessary. If you are migrating an existing environment, collect a performance baseline to determine your SQL Server on Azure VM requirements. If this is a new VM, then create your new SQL Server VM based on your vendor requirements.",
            "guid": "1fc3fc14-eea6-4e69-b8d9-a3eec218e687",
            "link": "https://learn.microsoft.com/sql/dma/dma-sku-recommend-sql-db?view=sql-server-ver16",
            "services": [
                "VM",
                "SQL"
            ],
            "severity": "High",
            "subcategory": "VM Size",
            "text": "Collect the target workload's performance characteristics and use them to determine the appropriate VM size for your business.",
            "waf": "Performance"
        },
        {
            "category": "SQL Server on Azure VM",
            "checklist": "SQL Migration Review",
            "description": "The memory optimized virtual machine sizes are a primary target for SQL Server VMs and the recommended choice by Microsoft. The memory optimized virtual machines offer stronger memory-to-CPU ratios and medium-to-large cache options.Consider Ebdsv5-series series first for most SQL Server workloads.",
            "guid": "e04abe1f-8d39-4fda-9776-8424c116775c",
            "link": "https://learn.microsoft.com/azure/azure-sql/virtual-machines/windows/performance-guidelines-best-practices-vm-size?view=azuresql#memory-optimized",
            "services": [
                "VM",
                "SQL"
            ],
            "severity": "Medium",
            "subcategory": "VM Size",
            "text": "Use memory optimized virtual machine sizes for the best performance of SQL Server workloads.",
            "waf": "Performance"
        },
        {
            "category": "SQL Server on Azure VM",
            "checklist": "SQL Migration Review",
            "description": "To find the most effective configuration for SQL Server workloads on an Azure VM, start by measuring the storage performance of your business application. Once storage requirements are known, select a virtual machine that supports the necessary IOPS and throughput with the appropriate memory-to-vCore ratio.",
            "guid": "2ea55b56-ad48-4408-be72-734b476ba18f",
            "link": "https://learn.microsoft.com/azure/virtual-machines/premium-storage-performance#counters-to-measure-application-performance-requirements",
            "services": [
                "VM",
                "Storage",
                "SQL"
            ],
            "severity": "Medium",
            "subcategory": "Storage",
            "text": "Determine storage bandwidth and latency requirements for SQL Server data, log, and tempdb files before choosing the disk type.",
            "waf": "Performance"
        },
        {
            "category": "SQL Server on Azure VM",
            "checklist": "SQL Migration Review",
            "description": "This provides more dedicated disk IOPS and throughput on the disk level and also allows you to configure the Azure disk host caching setting for each disk to the optimal setting for that data type.",
            "guid": "dbf590ce-65de-48e0-9f9c-cbd468266abc",
            "link": "https://learn.microsoft.com/azure/azure-sql/virtual-machines/windows/performance-guidelines-best-practices-checklist?view=azuresql#storage",
            "services": [
                "Storage",
                "SQL"
            ],
            "severity": "High",
            "subcategory": "Storage",
            "text": "Place data, log, and tempdb files on separate drives",
            "waf": "Performance"
        },
        {
            "category": "SQL Server on Azure VM",
            "checklist": "SQL Migration Review",
            "description": "Premium SSD is always recommend as a minimum for SQL Server in order to obtain better performance and lower latency. P30 and P40 are recommended because disk caching is not supported for disks 4 TiB and larger ( P50 and above) and they provide the optimal price to performance ratio",
            "guid": "e6a84de5-df43-4d19-a248-1718d5d1e5f6",
            "link": "https://learn.microsoft.com/azure/azure-sql/virtual-machines/windows/performance-guidelines-best-practices-checklist?view=azuresql#storage",
            "services": [
                "Storage",
                "SQL"
            ],
            "severity": "High",
            "subcategory": "Storage",
            "text": "For the data drive, use premium P30 and P40 or smaller disks to ensure the availability of cache support",
            "waf": "Performance"
        },
        {
            "category": "SQL Server on Azure VM",
            "checklist": "SQL Migration Review",
            "description": "Log files have primarily write-heavy operations. Therefore, they do not benefit from the ReadOnly cache. Hence evaluate your price vs performance vs capacity and chose the right storage disk.",
            "guid": "25659d35-58fd-4772-99c9-31112d027fe4",
            "link": "https://learn.microsoft.com/azure/azure-sql/virtual-machines/windows/performance-guidelines-best-practices-checklist?view=azuresql#storage",
            "services": [
                "Cost",
                "Storage",
                "SQL"
            ],
            "severity": "High",
            "subcategory": "Storage",
            "text": "For the log drive plan for capacity and test performance versus cost while evaluating the premium P30 - P80 disks",
            "waf": "Performance"
        },
        {
            "category": "SQL Server on Azure VM",
            "checklist": "SQL Migration Review",
            "description": "Placing TempDB on the D drive can help performance. Consider the size required and always test performance.",
            "guid": "12f70983-f630-4472-8ee6-9d6b5c2622f5",
            "link": "https://learn.microsoft.com/azure/azure-sql/virtual-machines/windows/performance-guidelines-best-practices-checklist?view=azuresql#storage",
            "services": [
                "VM",
                "Storage",
                "SQL"
            ],
            "severity": "Medium",
            "subcategory": "Storage",
            "text": "Place tempdb on the local ephemeral SSD (default D:\\) drive for most SQL Server workloads that are not part of Failover Cluster Instance (FCI) after choosing the optimal VM size.",
            "waf": "Performance"
        },
        {
            "category": "SQL Server on Azure VM",
            "checklist": "SQL Migration Review",
            "description": "Striping Data and Log disk can increase bandwidth. Ensure that VM size also matches expected output",
            "guid": "4b69bad3-4aad-45e8-a78e-1d76667313c4",
            "link": "https://learn.microsoft.com/azure/azure-sql/virtual-machines/windows/performance-guidelines-best-practices-checklist?view=azuresql#storage",
            "services": [
                "VM",
                "Storage",
                "SQL"
            ],
            "severity": "High",
            "subcategory": "Storage",
            "text": "Stripe multiple Azure data disks using Storage Spaces to increase I/O bandwidth",
            "waf": "Performance"
        },
        {
            "category": "SQL Server on Azure VM",
            "checklist": "SQL Migration Review",
            "description": "Your storage caching policy varies depending on the type of SQL Server data files that are hosted on the drive.Enable Read-only caching for the disks hosting SQL Server data files.Reads from cache will be faster than the uncached reads from the data disk.Set the caching policy to None for disks hosting the transaction log. There is no performance benefit to enabling caching for the Transaction log disk.",
            "guid": "05674b5e-985b-4859-a773-e7e261623b77",
            "link": "https://learn.microsoft.com/azure/azure-sql/virtual-machines/windows/performance-guidelines-best-practices-checklist?view=azuresql#storage",
            "services": [
                "AzurePolicy",
                "Storage",
                "SQL"
            ],
            "severity": "High",
            "subcategory": "Storage",
            "text": "Set host caching to read-only for data file disks and none for log file disks.",
            "waf": "Performance"
        },
        {
            "category": "SQL Server on Azure VM",
            "checklist": "SQL Migration Review",
            "description": "Check that you storage is in the same region as your VM. For exaplme if your VM is in EAST US 2 ensure your storage is in East US 2.",
            "guid": "5a917e1f-348e-4f35-9c27-d42e8bbac868",
            "link": "https://learn.microsoft.com/azure/azure-sql/virtual-machines/windows/performance-guidelines-best-practices-checklist?view=azuresql#storage",
            "services": [
                "VM",
                "Storage",
                "SQL"
            ],
            "severity": "High",
            "subcategory": "Storage",
            "text": "Provision the storage account in the same region as the SQL Server VM",
            "waf": "Performance"
        },
        {
            "category": "SQL Server on Azure VM",
            "checklist": "SQL Migration Review",
            "description": "SQL Server uses extents to store data. These are 64KB in size. Therefore, on a SQL Server machine, the NTFS allocation unit size for hosting SQL database files should be 64 KB.",
            "guid": "155abb91-63e9-4908-ae28-c84c33b6b780",
            "link": "https://learn.microsoft.com/azure/azure-sql/virtual-machines/windows/performance-guidelines-best-practices-checklist?view=azuresql#storage",
            "services": [
                "Storage",
                "SQL"
            ],
            "severity": "High",
            "subcategory": "Storage",
            "text": "Format your data disk to use 64 KB block size (allocation unit size) for all data files placed on a drive other than the temporary D:\\ drive",
            "waf": "Performance"
        },
        {
            "category": "SQL Server on Azure VM",
            "checklist": "SQL Migration Review",
            "description": "It is recommended that you determine BCDR needs and requirements ensuring that you are able to meet you SLAs of the environment.",
            "guid": "8b9fe5c4-2049-4d41-9a92-3c3474d11028",
            "link": "https://learn.microsoft.com/azure/azure-sql/virtual-machines/windows/business-continuity-high-availability-disaster-recovery-hadr-overview?view=azuresql#azure-only-disaster-recovery-solutions",
            "services": [
                "VM",
                "SQL"
            ],
            "severity": "Medium",
            "subcategory": "HADR",
            "text": "Determine HA/DR requirements for each VM to be migrated.",
            "waf": "Reliability"
        },
        {
            "category": "SQL Server on Azure VM",
            "checklist": "SQL Migration Review",
            "description": "When depoying High Availability you need to use availability sets or availability zones to avoid unexpected outages.",
            "guid": "ac6aae01-e6a8-44de-9df4-3d1992481718",
            "link": "https://learn.microsoft.com/azure/azure-sql/virtual-machines/windows/business-continuity-high-availability-disaster-recovery-hadr-overview?view=azuresql#high-availability-nodes-in-an-availability-set",
            "services": [
                "VM",
                "SQL"
            ],
            "severity": "High",
            "subcategory": "HADR",
            "text": "Place your VMs in an availability set or different availability zones.",
            "waf": "Reliability"
        },
        {
            "category": "SQL Server on Azure VM",
            "checklist": "SQL Migration Review",
            "description": "Prefered option when deploying an Availability Group. The recommended solution is to use multi-subnets when deploying Always on Availability Groups.",
            "guid": "d5d1e5f6-2565-49d3-958f-d77249c93111",
            "link": "https://learn.microsoft.com/azure/azure-sql/virtual-machines/windows/availability-group-azure-portal-configure?view=azuresql&tabs=azure-cli",
            "services": [
                "VM",
                "VNet",
                "LoadBalancer",
                "SQL"
            ],
            "severity": "Medium",
            "subcategory": "HADR",
            "text": "Deploy your SQL Server VMs to multiple subnets whenever possible to avoid the dependency on an Azure Load Balancer or a distributed network name (DNN) to route traffic to your HADR solution. ( If one is implementing FCI or AG)",
            "waf": "Reliability"
        },
        {
            "category": "SQL Server on Azure VM",
            "checklist": "SQL Migration Review",
            "description": "High availability and disaster recovery (HADR) features, such as the Always On availability group and the failover cluster instance rely on underlying Windows Server Failover Cluster technology. Review the best practices for modifying your HADR settings to better support the cloud environment.",
            "guid": "2d027fe4-12f7-4098-9f63-04722ee69d6b",
            "link": "https://learn.microsoft.com/azure/azure-sql/virtual-machines/windows/performance-guidelines-best-practices-checklist?view=azuresql-vm#hadr-configuration",
            "services": [
                "ASR",
                "SQL"
            ],
            "severity": "High",
            "subcategory": "HADR",
            "text": "Change the cluster to less aggressive parameters to avoid unexpected outages from transient network failures or Azure platform maintenance. ( If one is implementing FCI or AG)",
            "waf": "Reliability"
        },
        {
            "category": "SQL Server on Azure VM",
            "checklist": "SQL Migration Review",
            "description": "Ensure that quorum is set correct for the number of instances deployed.",
            "guid": "5c2622f5-4b69-4bad-94aa-d5e8c78e1d76",
            "link": "https://learn.microsoft.com/azure/azure-sql/virtual-machines/windows/hadr-cluster-best-practices?view=azuresql-vm&tabs=windows2012#quorum-voting",
            "services": [
                "SQL"
            ],
            "severity": "High",
            "subcategory": "HADR",
            "text": "Configure cluster quorum voting to use 3 or more odd number of votes. Don't assign votes to DR regions. ( If one is implementing FCI or AG)",
            "waf": "Reliability"
        },
        {
            "category": "SQL Server on Azure VM",
            "checklist": "SQL Migration Review",
            "description": "On Azure virtual machines, clusters use a load balancer to hold an IP address that needs to be on one cluster node at a time. In this solution, the load balancer holds the IP address for the virtual network name (VNN) listener for the Always On availability group when the SQL Server VMs are in a single subnet.",
            "guid": "667313c4-0567-44b5-b985-b859c773e7e2",
            "link": "https://learn.microsoft.com/azure/azure-sql/virtual-machines/windows/availability-group-vnn-azure-load-balancer-configure?view=azuresql-vm&tabs=ilb",
            "services": [
                "VM",
                "VNet",
                "LoadBalancer",
                "SQL"
            ],
            "severity": "High",
            "subcategory": "HADR",
            "text": "When using the virtual network name (VNN) and Azure Load Balancer to connect to your HADR solution, specify MultiSubnetFailover = true in the connection string, even if your cluster only spans one subnet. ( If one is implementing FCI or AG)",
            "waf": "Reliability"
        },
        {
            "category": "SQL Server on Azure VM",
            "checklist": "SQL Migration Review",
            "description": "SQL Server, Azure SQL Database, and Azure SQL Managed Instance support row and page compression for rowstore tables and indexes, and support columnstore and columnstore archival compression for columnstore tables and indexes.",
            "guid": "61623b77-5a91-47e1-b348-ef354c27d42e",
            "link": "https://learn.microsoft.com/sql/relational-databases/data-compression/data-compression?view=sql-server-ver16",
            "services": [
                "Storage",
                "SQL"
            ],
            "severity": "Low",
            "subcategory": "SQL Server",
            "text": "Enable database page compression where appropriate.",
            "waf": "Performance"
        },
        {
            "category": "SQL Server on Azure VM",
            "checklist": "SQL Migration Review",
            "description": "By default, data and log files are initialized to overwrite any existing data left on the disk from previously deleted files. Data and log files are first initialized by zeroing the files (filling with zeros).In SQL Server, for data files only, instant file initialization (IFI) allows for faster execution of the previously mentioned file operations, since it reclaims used disk space without filling that space with zeros. Instead, disk content is overwritten as new data is written to the files.",
            "guid": "8bbac868-155a-4bb9-863e-9908ae28c84c",
            "link": "https://learn.microsoft.com/sql/relational-databases/databases/database-instant-file-initialization?view=sql-server-ver16",
            "services": [
                "Storage",
                "SQL"
            ],
            "severity": "High",
            "subcategory": "SQL Server",
            "text": "Enable instant file initialization for data files.",
            "waf": "Operations"
        },
        {
            "category": "SQL Server on Azure VM",
            "checklist": "SQL Migration Review",
            "description": "Recommended for best performance and availability migrate all databases to data and log disks",
            "guid": "33b6b780-8b9f-4e5c-9204-9d413a923c34",
            "link": "https://learn.microsoft.com/sql/relational-databases/databases/move-database-files?view=sql-server-ver16",
            "services": [
                "SQL"
            ],
            "severity": "Medium",
            "subcategory": "SQL Server",
            "text": "Move all databases to data disks, including system databases.",
            "waf": "Operations"
        },
        {
            "category": "SQL Server on Azure VM",
            "checklist": "SQL Migration Review",
            "description": "Part of the SQL Server Feature checklist in the link that is recommended when SQL Server Instance is in an Azure VM.",
            "guid": "b824546c-e1ae-4e34-93ae-c8239248725d",
            "link": "https://learn.microsoft.com/azure/azure-sql/virtual-machines/windows/performance-guidelines-best-practices-checklist?view=azuresql-vm#sql-server-features",
            "services": [
                "VM",
                "Storage",
                "SQL"
            ],
            "severity": "Low",
            "subcategory": "SQL Server",
            "text": "Move SQL Server error log and trace file directories to data disks.",
            "waf": "Operations"
        },
        {
            "category": "SQL Server on Azure VM",
            "checklist": "SQL Migration Review",
            "description": "Part of the SQL Server Feature checklist in the link that is recommended when SQL Server Instance is in an Azure VM.",
            "guid": "d68c5b5c-2925-4394-a69a-9d2799c42bb6",
            "link": "https://learn.microsoft.com/sql/database-engine/configure-windows/server-memory-server-configuration-options#use-",
            "services": [
                "VM",
                "SQL"
            ],
            "severity": "High",
            "subcategory": "SQL Server",
            "text": "Set max SQL Server memory limit to leave enough memory for the Operating System.",
            "waf": "Performance"
        },
        {
            "category": "SQL Server on Azure VM",
            "checklist": "SQL Migration Review",
            "description": "Part of the SQL Server Feature checklist in the link that is recommended when SQL Server Instance is in an Azure VM.",
            "guid": "8d1d7555-6246-4b43-a563-b4dc74a748b6",
            "link": "https://learn.microsoft.com/sql/database-engine/configure-windows/enable-the-lock-pages-in-memory-option-windows",
            "services": [
                "VM",
                "SQL"
            ],
            "severity": "High",
            "subcategory": "SQL Server",
            "text": "Enable lock pages in memory.",
            "waf": "Performance"
        },
        {
            "category": "SQL Server on Azure VM",
            "checklist": "SQL Migration Review",
            "description": "Part of the SQL Server Feature checklist in the link that is recommended when SQL Server Instance is in an Azure VM.",
            "guid": "633ad2a0-916a-4664-a8fa-d0e278ee293c",
            "link": "https://learn.microsoft.com/sql/relational-databases/performance/monitoring-performance-by-using-the-query-store",
            "services": [
                "VM",
                "SQL"
            ],
            "severity": "Low",
            "subcategory": "SQL Server",
            "text": "Enable Query Store on all production SQL Server databases following best practices.",
            "waf": "Performance"
        },
        {
            "category": "SQL Server on Azure VM",
            "checklist": "SQL Migration Review",
            "description": "Part of the SQL Server Feature checklist in the link that is recommended when SQL Server Instance is in an Azure VM.",
            "guid": "1bc352ba-aab7-4571-a49a-b8093dc9ec9d",
            "link": "https://learn.microsoft.com/sql/relational-databases/databases/tempdb-database#optimizing-tempdb-performance-in-sql-server",
            "services": [
                "VM",
                "SQL"
            ],
            "severity": "High",
            "subcategory": "SQL Server",
            "text": "Ensure that all tempdb best practices are followed.",
            "waf": "Performance"
        },
        {
            "category": "SQL Server on Azure VM",
            "checklist": "SQL Migration Review",
            "description": "Part of the SQL Server Feature checklist in the link that is recommended when SQL Server Instance is in an Azure VM.",
            "guid": "1bb73b36-a5a6-47fb-a9ed-5b35478c3479",
            "link": "https://docs.microsoft.com/azure/governance/management-groups/how-to/protect-resource-hierarchy#setting---require-authorization",
            "services": [
                "VM",
                "SQL"
            ],
            "severity": "High",
            "subcategory": "SQL Server",
            "text": "Schedule SQL Server Agent jobs to run DBCC CHECKDB, index reorganize, index rebuild, and update statistics jobs.",
            "waf": "Operations"
        },
        {
            "category": "SQL Server on Azure VM",
            "checklist": "SQL Migration Review",
            "description": "Part of the SQL Server Feature checklist in the link that is recommended when SQL Server Instance is in an Azure VM.",
            "guid": "816b2863-cffe-41ca-a599-ef0d5a73dd4c",
            "link": "https://docs.microsoft.com/azure/governance/management-groups/how-to/protect-resource-hierarchy#setting---require-authorization",
            "services": [
                "VM",
                "SQL"
            ],
            "severity": "Medium",
            "subcategory": "SQL Server",
            "text": "Limit autogrowth of the database and Disable autoshrink",
            "waf": "Operations"
        },
        {
            "category": "SQL Server on Azure VM",
            "checklist": "SQL Migration Review",
            "description": "Constrained vCPU virtual machines (VMs) are a type of VM where the vCPU count can be constrained to a half or a quarter of the original VM size. This allows customers to reduce the cost of software licensing while maintaining the same memory, storage, and I/O bandwidth",
            "guid": "e36c1c81-770a-4fbc-9c0d-43918648d285",
            "link": "https://learn.microsoft.com/azure/virtual-machines/constrained-vcpu",
            "services": [
                "VM",
                "Storage",
                "Cost",
                "SQL"
            ],
            "severity": "Low",
            "subcategory": "Cost Optimization",
            "text": "Optimize SQL Server License cost with Constrained vCPU VM's",
            "training": "https://learn.microsoft.com/azure/active-directory/managed-identities-azure-resources/overview",
            "waf": "Cost"
        },
        {
            "category": "SQL Server on Azure VM",
            "checklist": "SQL Migration Review",
            "description": "Azure Hybrid Benefit allows you to exchange your existing licenses for discounted rates on Azure SQL Database and Azure SQL Managed Instance. Y",
            "guid": "7ed67178-b824-4546-ae1a-ee3453aec823",
            "link": "https://azure.microsoft.com/en-ca/pricing/hybrid-benefit/",
            "services": [
                "Cost",
                "SQL"
            ],
            "severity": "Low",
            "subcategory": "Cost Optimization",
            "text": "Leverage Azure Hybrid benefit to maximize the value of your on premises licenses in the cloud",
            "waf": "Cost"
        },
        {
            "category": "SQL Server on Azure VM",
            "checklist": "SQL Migration Review",
            "description": "The SQL Server IaaS Agent extension (SqlIaasExtension) runs on SQL Server on Azure Windows Virtual Machines (VMs) to automate management and administration tasks.",
            "guid": "9248725d-d68c-45b5-a292-5394a69a9d27",
            "link": "https://learn.microsoft.com/azure/azure-sql/virtual-machines/windows/sql-agent-extension-automatic-registration-all-vms?view=azuresql-vm&tabs=azure-cli",
            "services": [
                "VM",
                "SQL"
            ],
            "severity": "Medium",
            "subcategory": "Azure",
            "text": "Register with the SQL IaaS Agent Extension to unlock a number of feature benefits.",
            "training": "https://learn.microsoft.com/learn/modules/azure-ad-privileged-identity-management/",
            "waf": "Operations"
        },
        {
            "category": "SQL Server on Azure VM",
            "checklist": "SQL Migration Review",
            "description": "Accelerated Networking provides consistent ultra-low network latency via Azure's in-house programmable hardware and technologies",
            "guid": "99c42bb6-8d1d-4755-9624-6b438563b4dc",
            "link": "https://learn.microsoft.com/azure/virtual-network/accelerated-networking-overview?tabs=redhat",
            "services": [
                "VM",
                "SQL"
            ],
            "severity": "High",
            "subcategory": "Azure",
            "text": "Ensure Accelerated Networking is enabled on the virtual machine.",
            "waf": "Operations"
        },
        {
            "category": "SQL Server on Azure VM",
            "checklist": "SQL Migration Review",
            "description": "Microsoft Defender detects anomalous activities indicating unusual and potentially harmful attempts to access or exploit databases on the SQL server.",
            "guid": "74a748b6-633a-4d2a-8916-a66498fad0e2",
            "link": "https://learn.microsoft.com/azure/defender-for-cloud/secure-score-security-controls",
            "services": [
                "VM",
                "Defender",
                "SQL"
            ],
            "severity": "High",
            "subcategory": "Azure",
            "text": "Leverage Microsoft Defender for Cloud to improve the overall security posture of your virtual machine deployment.",
            "training": "https://learn.microsoft.com/learn/paths/implement-resource-mgmt-security/",
            "waf": "Security"
        },
        {
            "category": "SQL Managed Instance",
            "checklist": "SQL Migration Review",
            "description": "There are some PaaS limitations that are introduced in SQL Managed Instance and some behavior changes compared to SQL Server. It is important to review and understand these differences.",
            "guid": "78ee293c-1bc3-452b-aaab-7571849ab809",
            "link": "https://learn.microsoft.com/azure/azure-sql/managed-instance/transact-sql-tsql-differences-sql-server?view=azuresql",
            "services": [
                "EventHubs",
                "SQL"
            ],
            "severity": "High",
            "subcategory": "Pre Migration",
            "text": "Review the major differences between SQL Server and Managed Instance",
            "training": "https://learn.microsoft.com/learn/modules/plan-implement-administer-conditional-access/",
            "waf": "Operations"
        },
        {
            "category": "SQL Managed Instance",
            "checklist": "SQL Migration Review",
            "description": "SQL Managed Instance has characteristics and resource limits that depend on the underlying infrastructure and architecture. It is important to review these limits.",
            "guid": "3dc9ec9d-1bb7-43b3-9a5a-67fba9ed5b35",
            "link": "https://docs.microsoft.com/azure/azure-sql/managed-instance/resource-limits",
            "services": [
                "SQL"
            ],
            "severity": "High",
            "subcategory": "Pre Migration",
            "text": "Review capacity limits for SQL MI",
            "training": "https://learn.microsoft.com/learn/modules/secure-aad-users-with-mfa/",
            "waf": "Performance"
        },
        {
            "category": "SQL Managed Instance",
            "checklist": "SQL Migration Review",
            "description": "The instance settings between managed instance and your source SQL Server can be different . It is important to review those differences that can impact performance.",
            "guid": "8bc178bd-c5a0-46ca-9144-351e19dd3442",
            "link": "https://medium.com/azure-sqldb-managed-instance/compare-environment-settings-on-sql-server-and-azure-sql-that-may-impact-performance-e90c21fa9b08",
            "services": [
                "SQL"
            ],
            "severity": "High",
            "subcategory": "Pre Migration",
            "text": "Compare instance settings on SQL Server and Azure SQL MI that may impact performance",
            "training": "https://learn.microsoft.com/learn/paths/azure-administrator-manage-identities-governance/",
            "waf": "Performance"
        },
        {
            "category": "SQL Managed Instance",
            "checklist": "SQL Migration Review",
            "description": "Assess on-premises SQL Server instance(s) migrating to Azure SQL Managed Instance. The assessment workflow helps you to detect issues that block the migration itself and also partially supported and unsupported features",
            "guid": "9eb72281-37a1-451c-9bb4-e4f1814287d5",
            "link": "https://docs.microsoft.com/azure/dms/ads-sku-recommend",
            "services": [
                "SQL"
            ],
            "severity": "High",
            "subcategory": "Pre Migration",
            "text": "Run Data Migration assistant or Azure Data Studio Migration Extension to detect compatibility issues that can impact database functionality on Managed Instance",
            "training": "https://learn.microsoft.com/learn/modules/azure-ad-privileged-identity-management/",
            "waf": "Operations"
        },
        {
            "category": "SQL Managed Instance",
            "checklist": "SQL Migration Review",
            "description": "The SKU recommendation feature can evaluate the source SQL Server performance and utilization characteristics to recommend a right-sized Azure SQL Managed Instance to assist with your migration journey.",
            "guid": "ca8c26c9-b32a-4b5b-afc6-898a135e3378",
            "link": "https://learn.microsoft.com/azure/dms/ads-sku-recommend",
            "services": [
                "SQL"
            ],
            "severity": "High",
            "subcategory": "Pre Migration",
            "text": "Select the right compute resources for your workload by leveraging the SKU recommendation tools.",
            "training": "https://learn.microsoft.com/learn/modules/explore-basic-services-identity-types/",
            "waf": "Performance"
        },
        {
            "category": "SQL Managed Instance",
            "checklist": "SQL Migration Review",
            "description": "Review Unsupported Features, Migration Blockers and Breaking Changes for each database from the Assessment",
            "guid": "97e31c67-d68c-4b69-82ac-19f906d697c8",
            "link": "https://learn.microsoft.com/azure/dms/ads-sku-recommend",
            "services": [
                "SQL"
            ],
            "severity": "High",
            "subcategory": "Pre Migration",
            "text": "Review and address the issues highlighted in DMA/Azure Data Studio",
            "training": "https://learn.microsoft.com/learn/paths/manage-identity-and-access/",
            "waf": "Operations"
        },
        {
            "category": "SQL Managed Instance",
            "checklist": "SQL Migration Review",
            "description": "The SQL Managed Instance default DNS zone .database.windows.net can be changed with your own. However, the managed instance hostname part of its FQDN should remain the same.",
            "guid": "eaded26b-dd18-46f0-ac25-1b999a68af87",
            "link": "https://learn.microsoft.com/azure/azure-sql/managed-instance/frequently-asked-questions-faq?view=azuresql-mi#can-a-managed-instance-have-the-same-name-as-a-sql-server-on-premises-instance",
            "services": [
                "DNS",
                "SQL"
            ],
            "severity": "High",
            "subcategory": "Pre Migration",
            "text": "Plan for connection string changes as changing a managed instance name is not supported",
            "training": "https://learn.microsoft.com/learn/modules/create-custom-azure-roles-with-rbac/",
            "waf": "Operations"
        },
        {
            "category": "SQL Managed Instance",
            "checklist": "SQL Migration Review",
            "description": "There are addional requirements in configuring a vnet and subnet hosting the managed instance.",
            "guid": "c9a7f821-b8eb-48c0-aa77-e25e4d5aeaa8",
            "link": "https://learn.microsoft.com/azure/azure-sql/managed-instance/vnet-existing-add-subnet?view=azuresql-mi",
            "services": [
                "VNet",
                "SQL"
            ],
            "severity": "Medium",
            "subcategory": "Pre Migration",
            "text": "Review managed instance VNet requirements",
            "training": "https://learn.microsoft.com/learn/paths/secure-your-cloud-data/",
            "waf": "Operations"
        },
        {
            "category": "SQL Managed Instance",
            "checklist": "SQL Migration Review",
            "description": "Though it's possible to deploy managed instances to a subnet with a number of IP addresses that's less than the output of the subnet formula, always consider using bigger subnets instead. Using a bigger subnet can help avoid future issues stemming from a lack of IP addresses, such as the inability to create additional instances within the subnet or scale existing instances.",
            "guid": "dc4e2436-bb33-46d7-85f1-7960eee0b9b5",
            "link": "https://learn.microsoft.com/azure/azure-sql/managed-instance/vnet-subnet-determine-size?view=azuresql-mi",
            "services": [
                "VNet",
                "SQL"
            ],
            "severity": "High",
            "subcategory": "Deployment",
            "text": "Ensure managed instance subnet has sufficient IP addresses available",
            "training": "https://learn.microsoft.com/learn/modules/azure-active-directory/",
            "waf": "Operations"
        },
        {
            "category": "SQL Managed Instance",
            "checklist": "SQL Migration Review",
            "description": "SQL Managed Instance has characteristics and resource limits that depend on the underlying infrastructure and architecture. SQL Managed Instance can be deployed on multiple hardware configurations.",
            "guid": "c8defc4d-721d-431d-850f-b707ae9eab40",
            "link": "https://learn.microsoft.com/azure/azure-sql/managed-instance/resource-limits?view=azuresql-mi#service-tier-characteristics",
            "services": [
                "SQL"
            ],
            "severity": "High",
            "subcategory": "Pre Migration",
            "text": "Plan between General Purpose and Business Critical tiers of MI",
            "training": "https://learn.microsoft.com/learn/modules/implement-hybrid-identity-windows-server/",
            "waf": "Performance"
        },
        {
            "category": "SQL Managed Instance",
            "checklist": "SQL Migration Review",
            "description": "The auto-failover groups feature allows you to manage the replication and failover of user databases in a managed instance to a managed instance in another Azure region. Auto-failover groups are designed to simplify deployment and management of geo-replicated databases at scale.",
            "guid": "ed329079-8bc1-478b-bc5a-06ca7144351e",
            "link": "https://learn.microsoft.com/azure/azure-sql/managed-instance/auto-failover-group-sql-mi?view=azuresql-mi&tabs=azure-powershell",
            "services": [
                "SQL"
            ],
            "severity": "High",
            "subcategory": "Pre Migration",
            "text": "Based on your RPO/RTO's , determine if Auto failover Group needs to be implemented. If so, plan for the deployment attributes of the second instance.",
            "training": "https://learn.microsoft.com/learn/paths/implement-windows-server-iaas-virtual-machine-identity/",
            "waf": "Reliability"
        },
        {
            "category": "SQL Managed Instance",
            "checklist": "SQL Migration Review",
            "description": "There are multiple ways to connect your application to the managed instance. Review and understand the pros and cons and decide on the best approach for your application.",
            "guid": "5d226886-d30b-466c-97be-595190f83845",
            "link": "https://learn.microsoft.com/azure/azure-sql/managed-instance/connect-application-instance?view=azuresql-mi",
            "services": [
                "SQL"
            ],
            "severity": "Low",
            "subcategory": "Pre Migration",
            "text": "Review the Connectivity Design between Database and Application, test & validate it",
            "training": "https://learn.microsoft.com/learn/paths/implement-applications-external-access-azure-ad/",
            "waf": "Operations"
        },
        {
            "category": "SQL Managed Instance",
            "checklist": "SQL Migration Review",
            "description": "Compare migration options to choose the path that's appropriate to your business needs.",
            "guid": "c586cb29-1ec1-46a1-b076-ef9f141acdce",
            "link": "https://learn.microsoft.com/azure/azure-sql/migration-guides/managed-instance/sql-server-to-managed-instance-overview?view=azuresql-mi#migration-tools",
            "services": [
                "SQL"
            ],
            "severity": "Medium",
            "subcategory": "Pre Migration",
            "text": "Plan for the Migration Method. Depending on the DB Size and Application downtime window, select the preferred Migration Method.",
            "training": "https://learn.microsoft.com/learn/modules/design-identity-security-strategy/",
            "waf": "Operations"
        },
        {
            "category": "SQL Managed Instance",
            "checklist": "SQL Migration Review",
            "description": "After you verify that data is the same on both source and target, you can cut over from the source to the target environment. It's important to plan the cutover process with business / application teams to ensure minimal interruption during cutover doesn't affect business continuity.",
            "guid": "579377bc-db37-451a-a2ac-1fad66e15d4d",
            "link": "https://learn.microsoft.com/azure/dms/tutorial-sql-server-managed-instance-online#performing-migration-cutover",
            "services": [
                "SQL"
            ],
            "severity": "Medium",
            "subcategory": "Pre Migration",
            "text": "Plan the cutover process with business / application teams to ensure minimal interruption during cutover and it does not affect business continuity.",
            "training": "https://learn.microsoft.com/azure/architecture/example-scenario/identity/adds-extend-domain",
            "waf": "Reliability"
        },
        {
            "category": "SQL Managed Instance",
            "checklist": "SQL Migration Review",
            "description": "A time zone of a managed instance can be set during instance creation only. The default time zone is UTC",
            "guid": "4a2adb1c-3d23-426a-b225-ca44e1695fdd",
            "link": "https://learn.microsoft.com/azure/azure-sql/managed-instance/timezones-overview?view=azuresql#set-a-time-zone",
            "services": [
                "SQL"
            ],
            "severity": "High",
            "subcategory": "Deployment",
            "text": "Ensure you customize your time zone setting at the instance creation time. One cannot change it later.",
            "training": "https://learn.microsoft.com/azure/role-based-access-control/overview",
            "waf": "Operations"
        },
        {
            "category": "SQL Managed Instance",
            "checklist": "SQL Migration Review",
            "description": "Server-level collation in Azure SQL Managed Instance can be specified when the instance is created and cannot be changed later.Default server-level collation is SQL_Latin1_General_CP1_CI_AS.",
            "guid": "deace4cb-1deb-44c6-90c3-fc14eebb3693",
            "link": "https://learn.microsoft.com/sql/relational-databases/collations/set-or-change-the-server-collation?view=sql-server-ver16",
            "services": [
                "SQL"
            ],
            "severity": "High",
            "subcategory": "Deployment",
            "text": "Ensure you select the right collation setting at the instance creation time. One cannot change it later",
            "waf": "Operations"
        },
        {
            "category": "SQL Managed Instance",
            "checklist": "SQL Migration Review",
            "description": "When you're migrating a database protected by Transparent Data Encryption (TDE) to Azure SQL Managed Instance using the native restore option, the corresponding certificate from the SQL Server instance needs to be migrated before database restore.",
            "guid": "829e3eec-2183-4687-a007-7a2b5945bda4",
            "link": "https://learn.microsoft.com/azure/azure-sql/managed-instance/tde-certificate-migrate?view=azuresql-mi&tabs=azure-powershell",
            "services": [
                "VM",
                "SQL"
            ],
            "severity": "Medium",
            "subcategory": "Deployment",
            "text": "For TDE Enabled Database, corresponding certificate from the on-premises or Azure VM SQL Server needs to be migrated before database restore",
            "waf": "Operations"
        },
        {
            "category": "SQL Managed Instance",
            "checklist": "SQL Migration Review",
            "description": "System databases can be restored only from backups that are created on the version of SQL Server that the server instance is currently running. This is not the case when you are migrating to SQL Managed Instance.Azure PowerShell and DBATools PowerShell libraries enable you to easily script and automate and customize all parts of the migration process.",
            "guid": "3334fdf9-1c23-4418-8b65-275269440b4b",
            "link": "https://learn.microsoft.com/azure/azure-sql/migration-guides/managed-instance/sql-server-to-managed-instance-guide?view=azuresql-mi#backup-and-restore",
            "services": [
                "Backup",
                "SQL"
            ],
            "severity": "Low",
            "subcategory": "Migration",
            "text": "Restore of system databases is not supported. To migrate instance-level objects (stored in master or msdb databases), we recommend to script them out and run T-SQL scripts on the destination instance.",
            "waf": "Operations"
        },
        {
            "category": "SQL Managed Instance",
            "checklist": "SQL Migration Review",
            "description": "When using migration options that continuously replicate / sync data changes from source to the target, the source data and schema can change and drift from the target. During data sync, ensure that all changes on the source are captured and applied to the target during the migration process.",
            "guid": "e3d3e084-3276-4d4b-bc01-5bcf219e4a1e",
            "services": [
                "SQL"
            ],
            "severity": "High",
            "subcategory": "Migration",
            "text": "Ensure that all changes on the source are captured and applied to the target during the migration process.",
            "waf": "Operations"
        },
        {
            "category": "SQL Managed Instance",
            "checklist": "SQL Migration Review",
            "description": "Ensure that the application is able to succesffuly connect to the managed instance post migration of the databases.",
            "guid": "b5887952-5d22-4688-9d30-b66c57be5951",
            "link": "https://learn.microsoft.com/azure/azure-sql/managed-instance/connect-application-instance?view=azuresql-mi",
            "services": [
                "SQL"
            ],
            "severity": "Medium",
            "subcategory": "Migration",
            "text": "Test Application Connectivity to MI and Databases",
            "waf": "Operations"
        },
        {
            "category": "SQL Managed Instance",
            "checklist": "SQL Migration Review",
            "description": "High availability is a fundamental part of SQL Managed Instance platform that works transparently for your database applications. Failovers from primary to secondary nodes in case of node degradation or fault detection, or during regular monthly software updates are an expected occurrence for all applications using SQL Managed Instance in Azure.",
            "guid": "90f83845-c586-4cb2-a1ec-16a1d076ef9f",
            "link": "https://learn.microsoft.com/azure/azure-sql/managed-instance/user-initiated-failover?view=azuresql",
            "services": [
                "SQL"
            ],
            "severity": "High",
            "subcategory": "Post Migration",
            "text": "Consider executing a manual failover on SQL Managed Instance to test for fault and failover resiliency.",
            "training": "https://learn.microsoft.com/azure/azure-monitor/logs/design-logs-deployment",
            "waf": "Reliability"
        },
        {
            "category": "SQL Managed Instance",
            "checklist": "SQL Migration Review",
            "description": "Ensuring that your applications are failover resilient prior to deploying to production will help mitigate the risk of application faults in production and will contribute to application availability for your customers.",
            "guid": "141acdce-5793-477b-adb3-751ab2ac1fad",
            "link": "https://learn.microsoft.com/azure/azure-sql/managed-instance/auto-failover-group-configure-sql-mi?view=azuresql&tabs=azure-portal#test-failover",
            "services": [
                "EventHubs",
                "LoadBalancer",
                "SQL"
            ],
            "severity": "High",
            "subcategory": "Post Migration",
            "text": "If failover groups have been implemented, Test Manual Failover and Failback and test application connectivity behavior during failover/failback",
            "waf": "Reliability"
        },
        {
            "category": "SQL Managed Instance",
            "checklist": "SQL Migration Review",
            "description": "This provides more dedicated disk IOPS and throughput",
            "guid": "aa359272-8e6e-4205-8726-76ae46691e88",
            "link": "https://techcommunity.microsoft.com/t5/azure-sql-blog/storage-performance-best-practices-and-considerations-for-azure/ba-p/305525",
            "services": [
                "Storage",
                "SQL"
            ],
            "severity": "High",
            "subcategory": "Post Migration",
            "text": "Optimize Storage Performance for General Purpose Managed Instance",
            "training": "https://learn.microsoft.com/learn/paths/architect-infrastructure-operations/",
            "waf": "Performance"
        },
        {
            "category": "SQL Managed Instance",
            "checklist": "SQL Migration Review",
            "description": "Many organizations have policies that require that certificates or encryption keys be created and managed internally. If your organization has a similar policy, this architecture might apply to you. If your customers require internal management of these items, the architecture also might apply to you.",
            "guid": "35ad9422-23e1-4381-8523-081a94174158",
            "link": "https://learn.microsoft.com/azure/architecture/example-scenario/data/sql-managed-instance-cmk",
            "services": [
                "AzurePolicy",
                "AKV",
                "Backup",
                "SQL"
            ],
            "severity": "Low",
            "subcategory": "Post Migration",
            "text": "Enable Customer managed TDE for taking your own copy only full backups",
            "training": "https://learn.microsoft.com/learn/paths/architect-infrastructure-operations/",
            "waf": "Security"
        },
        {
            "category": "SQL Managed Instance",
            "checklist": "SQL Migration Review",
            "description": "The maintenance window feature provides you with the ability to onboard Azure SQL resource to prescheduled time blocks outside of business hours.",
            "guid": "33ef7ad7-c6d3-4733-865c-7acbe44bbe60",
            "link": "https://learn.microsoft.com/azure/azure-sql/database/planned-maintenance?view=azuresql",
            "services": [
                "SQL"
            ],
            "severity": "Medium",
            "subcategory": "Post Migration",
            "text": "Plan for Azure maintenance events",
            "training": "https://learn.microsoft.com/learn/paths/implement-resource-mgmt-security/",
            "waf": "Operations"
        },
        {
            "category": "SQL Managed Instance",
            "checklist": "SQL Migration Review",
            "description": "By using the long-term retention (LTR) feature, you can store specified SQL Database and SQL Managed Instance full backups in Azure Blob storage with configured redundancy for up to 10 years.",
            "guid": "9d89f2e8-7778-4424-b516-785c6fa96b96",
            "link": "https://learn.microsoft.com/azure/azure-sql/database/long-term-retention-overview?view=azuresql-mi",
            "services": [
                "Backup",
                "ARS",
                "Storage",
                "SQL"
            ],
            "severity": "Low",
            "subcategory": "Post Migration",
            "text": "Configure Long Term backup retention, view backups and restore from backups",
            "training": "https://learn.microsoft.com/learn/paths/azure-administrator-manage-compute-resources/",
            "waf": "Reliability"
        },
        {
            "category": "SQL Managed Instance",
            "checklist": "SQL Migration Review",
            "description": "By using Azure Hybrid Benefit, you can achieve cost savings, modernise and maintain a flexible hybrid environment while optimising business applications.",
            "guid": "ad88408f-3727-434c-a76b-a28021459014",
            "link": "https://azure.microsoft.com/en-gb/pricing/hybrid-benefit/#overview",
            "services": [
                "Cost",
                "SQL"
            ],
            "severity": "Low",
            "subcategory": "Post Migration",
            "text": "Take advantage of Azure Hybrid Benefit and Azure Reservations where applicable.",
            "training": "https://learn.microsoft.com/learn/modules/configure-network-watcher/",
            "waf": "Cost"
        },
        {
            "category": "SQL Managed Instance",
            "checklist": "SQL Migration Review",
            "description": "If you don't have threat protection Advanced Threat Protection is part of the Microsoft Defender for SQL offering, which is a unified package for advanced SQL security capabilities.",
            "guid": "65d38e53-f9cc-4bd8-9926-6acca274faa1",
            "link": "https://learn.microsoft.com/azure/azure-sql/database/threat-detection-overview?view=azuresql",
            "services": [
                "Defender",
                "SQL"
            ],
            "severity": "Medium",
            "subcategory": "Post Migration",
            "text": "Leverage Microsoft Defender for Cloud to improve the overall security posture",
            "training": "https://learn.microsoft.com/learn/paths/implement-resource-mgmt-security/",
            "waf": "Security"
        },
        {
            "category": "BC and DR",
            "checklist": "IoT Hub Review",
            "guid": "ac1d6380-f866-4bbd-a9b4-b1ee5d7908b8",
            "link": "https://learn.microsoft.com/azure/iot-hub/iot-hub-ha-dr#availability-zones",
            "service": "IoT",
            "services": [],
            "severity": "High",
            "subcategory": "High Availability",
            "text": "Leverage  Availability Zones if regionally applicable (this is automatically enabled)",
            "waf": "Reliability"
        },
        {
            "category": "BC and DR",
            "checklist": "IoT Hub Review",
            "guid": "35f651e8-0124-4ef7-8c57-658e38609e6e",
            "link": "https://learn.microsoft.com/azure/iot-hub/iot-hub-ha-dr#microsoft-initiated-failover",
            "service": "IoT",
            "services": [],
            "severity": "Medium",
            "subcategory": "High Availability",
            "text": "Be aware of Microsoft-initiated failovers. These are exercised by Microsoft in rare situations to fail over all the IoT hubs from an affected region to the corresponding geo-paired region.",
            "waf": "Reliability"
        },
        {
            "category": "BC and DR",
            "checklist": "IoT Hub Review",
            "guid": "4ed3e490-dc06-4a1e-b467-5d0239d85540",
            "link": "https://learn.microsoft.com/azure/iot-hub/iot-hub-ha-dr#cross-region-dr",
            "service": "IoT",
            "services": [],
            "severity": "High",
            "subcategory": "High Availability",
            "text": "Consider a Cross-Region DR strategy for critical workloads",
            "waf": "Reliability"
        },
        {
            "category": "BC and DR",
            "checklist": "IoT Hub Review",
            "guid": "a11ecab0-db47-46f7-9aa7-17764e7e45a1",
            "link": "https://learn.microsoft.com/azure/iot-hub/iot-hub-ha-dr#microsoft-initiated-failover",
            "service": "IoT",
            "services": [],
            "severity": "High",
            "subcategory": "High Availability",
            "text": "Learn how to trigger a manual failover.",
            "waf": "Reliability"
        },
        {
            "category": "BC and DR",
            "checklist": "IoT Hub Review",
            "guid": "f9db8dfb-1194-460b-aedd-34dd6a69db22",
            "link": "https://learn.microsoft.com/azure/iot-hub/iot-hub-ha-dr#failback",
            "service": "IoT",
            "services": [],
            "severity": "High",
            "subcategory": "High Availability",
            "text": "Learn how to fail back after a failover.",
            "waf": "Reliability"
        },
        {
            "category": "Compute",
            "checklist": "Resiliency Review",
            "description": "Automatic instance repairs ensure that unhealthy instances are promptly identified and replaced, maintaining a set of healthy instances within your scale set.",
            "guid": "7e13c105-675c-41e9-95b4-59837ff7ae7c",
            "link": "https://learn.microsoft.com/azure/virtual-machine-scale-sets/virtual-machine-scale-sets-automatic-instance-repairs",
            "service": "VMSS",
            "services": [
                "VM"
            ],
            "severity": "Low",
            "subcategory": "VM Scale Sets",
            "text": "Enable automatic instance repairs for enhanced VM Scale Sets resiliency",
            "waf": "Reliability"
        },
        {
            "category": "Compute",
            "checklist": "Resiliency Review",
            "description": "Ensure that Azure Backup is utilized appropriately to meet your organization's resiliency requirements for Azure virtual machines (VMs).",
            "guid": "4d874a74-8b66-42d6-b150-512a66498f6d",
            "link": "https://learn.microsoft.com/azure/backup/backup-azure-vms-introduction",
            "service": "VM",
            "services": [
                "VM",
                "Backup"
            ],
            "severity": "High",
            "subcategory": "Virtual Machines",
            "text": "Consider Azure Backup to meet your resiliency requirements for Azure VMs",
            "waf": "Reliability"
        },
        {
            "category": "Compute",
            "checklist": "Resiliency Review",
            "description": "Single Instance VMs using Premium SSD or Ultra Disk for all Operating System Disks and Data Disks are guaranteed to have Virtual Machine Connectivity of at least 99.9%",
            "guid": "8052d88e-79d1-47b7-9b22-a5a67e7a8ed4",
            "link": "https://learn.microsoft.com/azure/virtual-machines/disks-types",
            "service": "VM",
            "services": [
                "VM"
            ],
            "severity": "High",
            "subcategory": "Virtual Machines",
            "text": "Use Premium or Ultra disks for production VMs",
            "waf": "Reliability"
        },
        {
            "category": "Compute",
            "checklist": "Resiliency Review",
            "description": "Azure automatically replicates managed disks within a region to ensure data durability and protect against single-point failures.",
            "guid": "b31e38c3-f298-412b-8363-cffe179b599d",
            "link": "https://learn.microsoft.com/azure/virtual-machines/managed-disks-overview",
            "service": "VM",
            "services": [
                "VM"
            ],
            "severity": "High",
            "subcategory": "Virtual Machines",
            "text": "Ensure Managed Disks are used for all VMs",
            "waf": "Reliability"
        },
        {
            "category": "Compute",
            "checklist": "Resiliency Review",
            "description": "Temporary disks are intended for short-term storage of non-persistent data such as page files, swap files, or SQL Server tempdb. Storing persistent data on temporary disks can lead to data loss during maintenance events or VM redeployment.",
            "guid": "e0d5973c-d4ce-432c-8881-37f6f7c4c0d4",
            "link": "https://learn.microsoft.com/azure/virtual-machines/managed-disks-overview#temporary-disk",
            "service": "VM",
            "services": [
                "VM",
                "Storage",
                "SQL"
            ],
            "severity": "Medium",
            "subcategory": "Virtual Machines",
            "text": "Do not use the Temp disk for anything that is not acceptable to be lost",
            "waf": "Reliability"
        },
        {
            "category": "Compute",
            "checklist": "Resiliency Review",
            "description": "Co-locate your compute, storage, networking, and data resources across an availability zone, and replicate this arrangement in other availability zones.",
            "guid": "e514548d-2447-4ec6-9138-b8200f1ce16e",
            "link": "https://learn.microsoft.com/azure/reliability/availability-zones-overview",
            "service": "VM",
            "services": [
                "ACR",
                "VM",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Virtual Machines",
            "text": "Leverage Availability Zones for your VMs in regions where they are supported",
            "waf": "Reliability"
        },
        {
            "category": "Compute",
            "checklist": "Resiliency Review",
            "description": "Use at least two VMs in Availability Sets to isolate VMs on different fault and update domains.",
            "guid": "5a785d6f-e96c-496a-b884-4cf3b2b38c88",
            "link": "https://learn.microsoft.com/azure/virtual-machines/availability-set-overview",
            "service": "VM",
            "services": [
                "VM"
            ],
            "severity": "Medium",
            "subcategory": "Virtual Machines",
            "text": "For regions that do not support Availability Zones deploy VMs into Availability Sets",
            "waf": "Reliability"
        },
        {
            "category": "Compute",
            "checklist": "Resiliency Review",
            "description": "Azure provides multiple options for VM redundancy to meet different requirements (Availability Zones, Virtual Machine Scale Sets, Availability Sets, Azure Site Recovery)",
            "guid": "6ba2c021-4991-414a-9d3c-e574dccbd979",
            "link": "https://learn.microsoft.com/azure/virtual-machines/availability",
            "service": "VM",
            "services": [
                "VM",
                "ASR"
            ],
            "severity": "High",
            "subcategory": "Virtual Machines",
            "text": "Avoid running a production workload on a single VM",
            "waf": "Reliability"
        },
        {
            "category": "Compute",
            "checklist": "Resiliency Review",
            "description": "Azure Site Recovery enables you to achieve low RTO (Recovery Time Objective) for your Azure and hybrid VMs by providing continuous replication and failover capabilities.",
            "guid": "2a6bcca2-b5fe-4a1e-af3d-d95d48c7c891",
            "link": "https://learn.microsoft.com/azure/site-recovery/site-recovery-overview",
            "service": "VM",
            "services": [
                "AVS",
                "VM",
                "ASR"
            ],
            "severity": "High",
            "subcategory": "Virtual Machines",
            "text": "For Azure and on-premises VMs (Hyper-V/Phyiscal/VMware) with low RTO requirements use Azure Site Recovery",
            "waf": "Reliability"
        },
        {
            "category": "Compute",
            "checklist": "Resiliency Review",
            "description": "By using Capacity Reservations, you can effectively manage capacity for critical workloads, ensuring resource availability in specified regions.",
            "guid": "bd7bb012-f7b9-45e0-9e15-8e3ea3992c2d",
            "link": "https://learn.microsoft.com/azure/virtual-machines/capacity-reservation-overview",
            "service": "VM",
            "services": [
                "VM"
            ],
            "severity": "Low",
            "subcategory": "Virtual Machines",
            "text": "Use Capacity Reservations for critical workloads that require guaranteed capacity",
            "waf": "Reliability"
        },
        {
            "category": "Compute",
            "checklist": "Resiliency Review",
            "description": "By ensuring that the necessary quotas are increased in your DR region before testing failover with ASR, you can avoid any potential resource constraints during the recovery process for failed over VMs.",
            "guid": "e6e2065b-3a76-4af4-a691-e8939ada4666",
            "link": "https://learn.microsoft.com/azure/quotas/per-vm-quota-requests",
            "service": "VM",
            "services": [
                "VM",
                "ASR"
            ],
            "severity": "Medium",
            "subcategory": "Virtual Machines",
            "text": "Increase quotas in DR region before testing failover with ASR",
            "waf": "Reliability"
        },
        {
            "category": "Compute",
            "checklist": "Resiliency Review",
            "description": "Scheduled Events is an Azure Metadata Service that provides information about upcoming maintenance events for virtual machines (VMs). By leveraging Scheduled Events, you can proactively prepare your applications for VM maintenance, minimizing disruption and improving the availability of your VMs.",
            "guid": "6d3b475a-5c7a-4cbe-99bb-e64dd8902e87",
            "link": "https://learn.microsoft.com/azure/virtual-machines/windows/scheduled-events",
            "service": "VM",
            "services": [
                "VM"
            ],
            "severity": "Low",
            "subcategory": "Virtual Machines",
            "text": "Utilize Scheduled Events to prepare for VM maintenance",
            "waf": "Reliability"
        },
        {
            "category": "Data",
            "checklist": "Resiliency Review",
            "description": "Use Zone-redundant Storage (ZRS) in the primary region for scenarios that require high availability and for restricting replication to a particular country or region. For protection against regional disasters, use Geo-zone-redundant Storage (GZRS), which combines ZRS in the primary region with geo-replication to a secondary region?.",
            "guid": "48c7c891-dcb1-4f7d-9769-ae568ba38d4a",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-redundancy",
            "service": "Azure Storage",
            "services": [
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Storage Accounts",
            "text": "Choose the most appropriate data redundancy option for Azure Storage based on your requirements",
            "waf": "Reliability"
        },
        {
            "category": "Data",
            "checklist": "Resiliency Review",
            "description": "Assigning a Delete lock to your storage account helps protect the availability of your data, minimizing the risk of disruptions to your business operations.",
            "guid": "85e2213d-bd7b-4b01-8f7b-95e06e158e3e",
            "link": "https://learn.microsoft.com/azure/storage/common/lock-account-resource",
            "service": "Azure Storage",
            "services": [
                "Storage"
            ],
            "severity": "Low",
            "subcategory": "Storage Accounts",
            "text": "Apply a Delete lock to prevent accidental or malicious deletion of storage accounts",
            "waf": "Reliability"
        },
        {
            "category": "Data",
            "checklist": "Resiliency Review",
            "description": "Container soft delete protects your data from being accidentally deleted by maintaining the deleted data in the system for a specified period of time.",
            "guid": "a3992c2d-e6e2-4065-a3a7-6af4a691e893",
            "link": "https://learn.microsoft.com/azure/storage/blobs/soft-delete-container-enable",
            "service": "Azure Storage",
            "services": [
                "Storage"
            ],
            "severity": "Low",
            "subcategory": "Storage Accounts",
            "text": "Enable soft delete for Storage Account Containers",
            "waf": "Reliability"
        },
        {
            "category": "Data",
            "checklist": "Resiliency Review",
            "description": "Blob soft delete protects an individual blob and its versions, snapshots, and metadata from accidental deletes or overwrites by maintaining the deleted data in the system for a specified period of time.",
            "guid": "9ada4666-7e13-4c10-96b9-153d89f89dc7",
            "link": "https://learn.microsoft.com/azure/storage/blobs/soft-delete-blob-enable",
            "service": "Azure Storage",
            "services": [
                "Storage"
            ],
            "severity": "Low",
            "subcategory": "Storage Accounts",
            "text": "Enable soft delete for blobs",
            "waf": "Reliability"
        },
        {
            "category": "General",
            "checklist": "Resiliency Review",
            "description": "Azure Backup enhanced soft delete provides critical protection against ransomware attacks by retaining deleted backups, enabling recovery from potential ransomware encryption or deletion.",
            "guid": "b44be3b1-a27f-48b9-b91b-e1038df03a82",
            "link": "https://learn.microsoft.com/azure/backup/backup-azure-enhanced-soft-delete-about",
            "service": "Azure Backup",
            "services": [
                "Backup"
            ],
            "severity": "Medium",
            "subcategory": "Backup",
            "text": "Enable Azure Backup enhanced soft delete for improved data protection and recovery",
            "waf": "Reliability"
        },
        {
            "category": "General",
            "checklist": "Resiliency Review",
            "description": "Azure Backup's multi-user authorization enables fine-grained control over user access to backup resources, allowing you to restrict privileges and ensure proper authentication and authorization for backup operations.",
            "guid": "2cd463cb-bbc8-4ac2-a9eb-c92a43da1dae",
            "link": "https://learn.microsoft.com/azure/backup/multi-user-authorization-concept",
            "service": "Azure Backup",
            "services": [
                "Backup"
            ],
            "severity": "Low",
            "subcategory": "Backup",
            "text": "Implement multi-user authorization for Azure Backup to ensure secure and controlled access to backup resources",
            "waf": "Reliability"
        },
        {
            "category": "General",
            "checklist": "Resiliency Review",
            "description": "Azure Immutable Storage provides an additional layer of security by ensuring that backup data stored in the vault cannot be modified or deleted for a specified retention period. This helps safeguard your backups from ransomware attacks that may attempt to compromise or manipulate your backup data.",
            "guid": "2cc88147-0607-4c1c-aa0e-614658dd458e",
            "link": "https://learn.microsoft.com/azure/backup/backup-azure-immutable-vault-concept?source=recommendations&tabs=recovery-services-vault",
            "service": "Azure Backup",
            "services": [
                "Storage",
                "Backup"
            ],
            "severity": "Low",
            "subcategory": "Backup",
            "text": "Implement Immutable Storage for your vaults to protect against ransomware and prevent unauthorized modifications to backups",
            "waf": "Reliability"
        },
        {
            "category": "General",
            "checklist": "Resiliency Review",
            "description": "Clearly define your organization's business continuity and disaster recovery requirements for your Azure environment. This includes identifying the critical applications, data, and services that need to be protected, as well as specifying the desired recovery objectives and strategies.",
            "guid": "72e52e36-11dd-458c-9a4b-1521e43a58a9",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/management-business-continuity-disaster-recovery",
            "services": [
                "ASR"
            ],
            "severity": "High",
            "subcategory": "Design",
            "text": "Define business continuity and disaster recovery requirements",
            "waf": "Reliability"
        },
        {
            "category": "General",
            "checklist": "Resiliency Review",
            "description": "Ensure that your Azure architectures are designed with a focus on reliability. Consider implementing fault-tolerant mechanisms, redundancy, and resiliency patterns to minimize the impact of failures and maximize the availability of your applications and services.",
            "guid": "c2399c4d-7b67-4d0c-9555-62f2b3e4563a",
            "link": "https://learn.microsoft.com/azure/architecture/reliability/architect",
            "services": [],
            "severity": "High",
            "subcategory": "Design",
            "text": "Implement reliability best practices in Azure architectures",
            "waf": "Reliability"
        },
        {
            "category": "General",
            "checklist": "Resiliency Review",
            "description": "IaC configurations can play a role in your disaster recovery plan, particularly in situations where recovery time is not time-sensitive. In the event of infrastructure recreation in a second region, IaC can be used to reproduce the necessary infrastructure.",
            "guid": "fe237de2-43b1-46c3-8d7a-a9b7570449aa",
            "link": "https://learn.microsoft.com/azure/well-architected/devops/automation-infrastructure",
            "services": [
                "RBAC",
                "ASR"
            ],
            "severity": "Medium",
            "subcategory": "DevOps",
            "text": "Implement Infrastructure as Code (IaC) for Rapid Infrastructure Recovery",
            "waf": "Reliability"
        },
        {
            "category": "General",
            "checklist": "Resiliency Review",
            "description": "Azure offers region pairs that are geographically separated and can be used for cross-region replication and disaster recovery. These region pairs provide redundancy and protection against regional or large-scale disasters.",
            "guid": "dcb1f7d5-769a-4e56-aba3-8d4a85e2213d",
            "link": "https://learn.microsoft.com/azure/reliability/cross-region-replication-azure",
            "services": [
                "ASR"
            ],
            "severity": "Medium",
            "subcategory": "Multi-region",
            "text": "Plan for cross-region recovery by leveraging region pairs",
            "waf": "Reliability"
        },
        {
            "category": "Network",
            "checklist": "Resiliency Review",
            "description": "By deploying an Application Gateway with a minimum instance count of two, you will have at least two instances available under normal circumstances. In the event that one of the instances encounters a problem, the other instance will handle the traffic while a new instance is being created. This approach significantly reduces the risk of service disruption and ensures a seamless experience for your users.",
            "guid": "93c76286-37a5-451c-9b04-e4f1854387e5",
            "link": "https://learn.microsoft.com/azure/application-gateway/application-gateway-autoscaling-zone-redundant#autoscaling-and-high-availability",
            "services": [
                "AppGW"
            ],
            "severity": "Medium",
            "subcategory": "Application Gateways",
            "text": "Deploy Application Gateways with a minimum instance count of 2 to avoid instance provisioning downtime",
            "waf": "Reliability"
        },
        {
            "category": "Network",
            "checklist": "Resiliency Review",
            "description": "The v2 SKU offers several advantages and critical new features that enhance the availability and resilience of your application infrastructure. One notable feature supported by the v2 SKU is zone redundancy, which allows an Application Gateway deployment to span multiple Availability Zones.",
            "guid": "ced126cd-032a-4f5b-8fc6-998a535e3378",
            "link": "https://learn.microsoft.com/azure/application-gateway/overview-v2",
            "services": [
                "AppGW",
                "Storage"
            ],
            "severity": "High",
            "subcategory": "Application Gateways",
            "text": "Deploy Azure Application Gateway v2 for zone redundancy support",
            "waf": "Reliability"
        },
        {
            "category": "Network",
            "checklist": "Resiliency Review",
            "description": "Azure Front Door provides automatic failover capabilities, ensuring continuity in the event of a primary region becoming unavailable. However, during the failover process, there may be a brief period (typically 20-60 seconds) when clients cannot reach the application. It is essential to review the Azure Front Door service level agreement (SLA) to determine whether relying solely on Front Door meets your business requirements for high availability. ",
            "guid": "97e31c67-d68c-4f6a-92a1-194956d697dc",
            "link": "https://learn.microsoft.com/azure/architecture/reference-architectures/app-service-web-app/multi-region#azure-front-door",
            "services": [
                "FrontDoor"
            ],
            "severity": "Low",
            "subcategory": "Azure Front Door",
            "text": "Consider a redundant traffic management solution in conjunction with Azure Front Door",
            "waf": "Reliability"
        },
        {
            "category": "Network",
            "checklist": "Resiliency Review",
            "description": "By implementing Traffic Manager, you can configure it to continuously monitor the health of your application endpoints and automatically redirect traffic to an alternate endpoint when necessary. This automation minimizes downtime and provides a more seamless experience for your users during disaster recovery scenarios.",
            "guid": "8df03a82-2cd4-463c-abbc-8ac299ebc92a",
            "link": "https://learn.microsoft.com/azure/networking/disaster-recovery-dns-traffic-manager",
            "services": [
                "DNS",
                "Monitor",
                "TrafficManager",
                "ASR"
            ],
            "severity": "Low",
            "subcategory": "DNS",
            "text": "Plan for automated failover using Traffic Manager for DNS Traffic",
            "waf": "Reliability"
        },
        {
            "category": "Network",
            "checklist": "Resiliency Review",
            "description": "To eliminate a single point of failure in your on-premises DNS services and ensure reliable DNS resolution during business continuity and disaster recovery scenarios, it is recommended to utilize Azure DNS Private Resolvers in multiple regions. By deploying two or more Azure DNS private resolvers across different regions, you can enable DNS failover and achieve resiliency in your DNS infrastructure.",
            "guid": "43da1dae-2cc8-4814-9060-7c1cca0e6146",
            "link": "https://learn.microsoft.com/azure/dns/tutorial-dns-private-resolver-failover",
            "service": "DNS",
            "services": [
                "DNS",
                "ACR",
                "ASR"
            ],
            "severity": "Low",
            "subcategory": "DNS",
            "text": "Implement DNS Failover using Azure DNS Private Resolvers",
            "waf": "Reliability"
        },
        {
            "category": "Network",
            "checklist": "Resiliency Review",
            "description": "Use an on-premises data gateway cluster to avoid single points of failure and to load balance traffic across gateways.",
            "guid": "89f89dc7-b44b-4e3b-8a27-f8b9e91be103",
            "link": "https://learn.microsoft.com/data-integration/gateway/service-gateway-high-availability-clusters",
            "service": "Data Gateways",
            "services": [
                "ACR"
            ],
            "severity": "Medium",
            "subcategory": "Data Gateways",
            "text": "Use on-premises data gateway clusters to ensure high availability for business-critical data",
            "waf": "Reliability"
        },
        {
            "category": "Network",
            "checklist": "Resiliency Review",
            "description": "When using ExpressRoute, it's important to design for high availability by incorporating redundancy in both the partner and customer networks. This can include multiple ExpressRoute circuits, redundant connections from your network to Microsoft, and ensuring your on-premises network equipment has redundant connections.",
            "guid": "c0e7c28d-c936-4657-802b-ff4564b0d934",
            "link": "https://learn.microsoft.com/azure/expressroute/designing-for-high-availability-with-expressroute",
            "services": [
                "ExpressRoute"
            ],
            "severity": "Medium",
            "subcategory": "ExpressRoute",
            "text": "Ensure redundancy within both the partner network and customer network when utilizing ExpressRoute for high availability",
            "waf": "Reliability"
        },
        {
            "category": "Network",
            "checklist": "Resiliency Review",
            "description": "The primary circuit should handle regular traffic while the backup circuit stays ready to take over if the primary circuit fails. Utilize BGP attributes to influence routing and designate your primary and backup circuits effectively.",
            "guid": "a359c373-e7dd-4616-83a3-64a907ebae48",
            "link": "https://learn.microsoft.com/azure/expressroute/designing-for-disaster-recovery-with-expressroute-privatepeering",
            "services": [
                "ExpressRoute",
                "Backup"
            ],
            "severity": "Medium",
            "subcategory": "ExpressRoute",
            "text": "When using multiple ExpressRoute circuits ensure that routing allows for a primary and backup",
            "waf": "Reliability"
        },
        {
            "category": "Network",
            "checklist": "Resiliency Review",
            "description": "S2S VPN connection can provide a cost-effective, resilient backup solution in the event of an ExpressRoute circuit failure. By using S2S VPN as a failover, you can maintain connectivity to your Azure resources without relying solely on ExpressRoute.",
            "guid": "ead53cc7-de2e-48aa-ab35-71549ab9153d",
            "link": "https://learn.microsoft.com/azure/expressroute/use-s2s-vpn-as-backup-for-expressroute-privatepeering",
            "services": [
                "ExpressRoute",
                "Cost",
                "VPN",
                "Backup"
            ],
            "severity": "Low",
            "subcategory": "ExpressRoute",
            "text": "Consider deploying site-to-site VPN as a backup for your ExpressRoute private peering",
            "waf": "Reliability"
        },
        {
            "category": "Network",
            "checklist": "Resiliency Review",
            "description": "Standard Load Balancer SKU offers an SLA of 99.99% and a higher level of service availability compared to the Basic Load Balancer SKU.",
            "guid": "778468d5-5a78-45d6-be96-c96ad8844cf3",
            "link": "https://learn.microsoft.com/azure/load-balancer/skus",
            "services": [
                "LoadBalancer"
            ],
            "severity": "Medium",
            "subcategory": "Load Balancers",
            "text": "Leverage the Standard SKU for Load Balancers that handle traffic to production applications",
            "waf": "Reliability"
        },
        {
            "category": "Network",
            "checklist": "Resiliency Review",
            "description": "By configuring the load balancer with a zone-redundant frontend, it can serve zonal resources in any zone with a single IP address. As long as at least one zone remains healthy within the region, the IP address associated with the frontend can survive one or more zone failures. It is recommended to have multiple zonal resources, such as virtual machines from different zones, in the backend pool of the load balancer. ",
            "guid": "b2b38c88-6ba2-4c02-8499-114a5d3ce574",
            "link": "https://learn.microsoft.com/azure/load-balancer/load-balancer-standard-availability-zones",
            "services": [
                "VM",
                "LoadBalancer"
            ],
            "severity": "Low",
            "subcategory": "Load Balancers",
            "text": "For load balancers, consider using a zone-redundant frontend with multiple zonal resources in the backend",
            "waf": "Reliability"
        },
        {
            "category": "Network",
            "checklist": "Resiliency Review",
            "description": "When designing health probes for your Azure Load Balancer, it is important to follow best practices to ensure reliable and accurate monitoring of your backend instances.",
            "guid": "dccbd979-2a6b-4cca-8b5f-ea1ebf3dd95d",
            "link": "https://learn.microsoft.com/azure/load-balancer/load-balancer-custom-probe-overview#design-guidance",
            "services": [
                "Monitor",
                "LoadBalancer"
            ],
            "severity": "Low",
            "subcategory": "Load Balancers",
            "text": "Select the right protocol, appropriate intervals and timeouts, representative paths and probe responses when defining Load Balancer Health Probes",
            "waf": "Reliability"
        },
        {
            "category": "Network",
            "checklist": "Resiliency Review",
            "description": "When choosing the best option for deploying NVAs in Azure, it is crucial to consider the vendor's recommendations and validate that the specific design has been vetted and validated by the NVA vendor. The vendor should also provide the necessary NVA configuration for seamless integration in Azure.",
            "guid": "8b1188b3-c6a4-46ce-a544-451e192d3442",
            "link": "https://learn.microsoft.com/azure/architecture/reference-architectures/dmz/nva-ha",
            "service": "NVA",
            "services": [
                "NVA"
            ],
            "severity": "High",
            "subcategory": "NVAs",
            "text": "Deploy Network Virtual Appliances (NVAs) in a vendor supported configuration for High Availability",
            "waf": "Reliability"
        },
        {
            "category": "Network",
            "checklist": "Resiliency Review",
            "description": "By deploying VPN Gateways in an active-active mode, you can distribute VPN traffic across multiple gateways, improving reliability and ensuring continuous connectivity in case of failures or maintenance.",
            "guid": "927139b8-2110-42db-b6ea-f11e6f843e53",
            "link": "https://learn.microsoft.com/azure/vpn-gateway/vpn-gateway-highlyavailable",
            "services": [
                "ACR",
                "VPN"
            ],
            "severity": "Medium",
            "subcategory": "VPN Gateways",
            "text": "Deploy Azure VPN Gateways in an active-active mode to ensure high availability and redundancy for your VPN connections.",
            "waf": "Reliability"
        },
        {
            "category": "Network",
            "checklist": "Resiliency Review",
            "description": "Zone-redundant SKUs ensure that your VPN gateways are physically and logically separated within a region, providing resiliency and scalability. This deployment configuration safeguards your on-premises network connectivity to Azure from zone-level failures.",
            "guid": "f4722d92-8c1b-41cd-921f-54b29b9de39a",
            "link": "https://learn.microsoft.com/azure/vpn-gateway/about-zone-redundant-vnet-gateways",
            "services": [
                "VPN"
            ],
            "severity": "Medium",
            "subcategory": "VPN Gateways",
            "text": "Use zone-redundant SKUs when deploying VPN Gateways to enhance resilience and protect against zone-level failures",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Stream Analytics Review Checklist",
            "guid": "32e52e36-11c8-418b-8a0b-c511e43a18a9",
            "link": "https://github.com/Azure/fta-resiliencyplaybooks/blob/main/paas-foundations-playbooks-stream_analytics_v1.docx",
            "services": [],
            "severity": "High",
            "subcategory": "High Availablity ",
            "text": "Leverage FTA Resiliency  Handbook for Stream Analytics",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Stream Analytics Review Checklist",
            "description": "Azure Stream Analytics provides high availability (99.9% SLA) for jobs and clusters within a region, the details of which are transparent to the end customer. If failures occur within the service, per the documentation �Azure Stream Analytics guarantees exactly once event processing and at-least-once delivery of events, so events are never lost.�",
            "guid": "cd289ced-6b17-4db8-8554-62f2aee4553a",
            "link": "https://azure.microsoft.com/en-in/products/stream-analytics",
            "services": [],
            "severity": "Medium",
            "subcategory": "High Availablity ",
            "text": "Understand High Availability 99% SLA and use it to plan your DR strategy",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Stream Analytics Review Checklist",
            "description": "Azure Stream Analytics resources (jobs, clusters, etc.) are regional and do not provide automatic geo-failover. However, you can achieve geo-redundancy by deploying identical Stream Analytics jobs in multiple Azure regions. Each job connects to local input and output sources. It is the responsibility of your application to both send input data into the two regional inputs and reconcile between the two regional outputs.",
            "guid": "fc833934-8b26-42d6-ac5f-512925498e6d",
            "link": "https://learn.microsoft.com/azure/stream-analytics/geo-redundancy",
            "services": [],
            "severity": "Medium",
            "subcategory": "Geo Redundancy",
            "text": "Plan for Geo Redudancy of the service",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Stream Analytics Review Checklist",
            "guid": "b9d37dac-43bc-46cd-8d7a-a9b24604489a",
            "link": "https://learn.microsoft.com/azure/stream-analytics/geo-redundancy",
            "services": [],
            "severity": "Medium",
            "subcategory": "Geo Redundancy",
            "text": "Depending on your availablity requirement, configure Active/Active configuration or Active/Passive configuration ",
            "waf": "Reliability"
        },
        {
            "category": "Governance",
            "checklist": "Azure Key Vault",
            "guid": "6d37a33b-531c-4a91-871a-b69d8044f04e",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "services": [
                "AKV",
                "Backup"
            ],
            "severity": "High",
            "subcategory": "Deployment best practices",
            "text": "Familiarize yourself with the Key Vault's best practices such as isolation recommendations, access control, data protection, backup, and logging.",
            "waf": "Reliability"
        },
        {
            "category": "BC and DR",
            "checklist": "Azure Key Vault",
            "guid": "7ba4d380-7b9e-4a8b-a0c3-2d8e49c11872",
            "link": "https://learn.microsoft.com/azure/key-vault/general/disaster-recovery-guidance",
            "service": "Key Vault",
            "services": [
                "AKV",
                "ACR"
            ],
            "severity": "Medium",
            "subcategory": "High Availability",
            "text": "Key Vault is a managed service and Microsoft will handle the failover within and across region. Familiarize yourself with the Key Vault's availability and redundancy.",
            "waf": "Reliability"
        },
        {
            "category": "BC and DR",
            "checklist": "Azure Key Vault",
            "guid": "17fb86a2-eb45-42a4-9c34-52b92a2a1842",
            "link": "https://learn.microsoft.com/azure/key-vault/general/disaster-recovery-guidance#data-replication",
            "service": "Key Vault",
            "services": [
                "AKV"
            ],
            "severity": "Medium",
            "subcategory": "High Availability",
            "text": "The contents of your key vault are replicated within the region and to a secondary region at least 150 miles away, but within the same geography to maintain high durability of your keys and secrets. Familiarize yourself with the Key Vault's data replication.",
            "waf": "Reliability"
        },
        {
            "category": "BC and DR",
            "checklist": "Azure Key Vault",
            "guid": "614682ca-6e0c-4f34-9f03-c6d3f2b99a32",
            "link": "https://learn.microsoft.com/azure/key-vault/general/disaster-recovery-guidance#failover-across-regions",
            "service": "Key Vault",
            "services": [
                "AzurePolicy",
                "AKV"
            ],
            "severity": "Medium",
            "subcategory": "High Availability",
            "text": "During failover, access policy or firewall configurations and settings can't be changed. The key vault will be in read-only mode during failover. Familiarize yourself with the Key Vault's failover guidance.",
            "waf": "Reliability"
        },
        {
            "category": "Management",
            "checklist": "Azure Key Vault",
            "guid": "9ef2b0d2-3206-4c94-b47a-4f07e6a1c509",
            "link": "https://learn.microsoft.com/azure/key-vault/general/backup?tabs=azure-cli#design-considerations",
            "service": "Key Vault",
            "services": [
                "AKV",
                "ASR",
                "Backup",
                "Subscriptions",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Business continuity and disaster recovery",
            "text": "When you back up a key vault object, such as a secret, key, or certificate, the backup operation will download the object as an encrypted blob. This blob can't be decrypted outside of Azure. To get usable data from this blob, you must restore the blob into a key vault within the same Azure subscription and Azure geography. Familiarize yourself with the Key Vault's backup and restore guidance.",
            "waf": "Reliability"
        },
        {
            "category": "Management",
            "checklist": "Azure Key Vault",
            "guid": "2df045b1-c0f6-47d3-9a9b-99cf6999684e",
            "link": "https://learn.microsoft.com/azure/key-vault/general/soft-delete-overview",
            "service": "Key Vault",
            "services": [
                "AKV",
                "ASR"
            ],
            "severity": "High",
            "subcategory": "Business continuity and disaster recovery",
            "text": "If you want protection against accidental or malicious deletion of your secrets, configure soft-delete and purge protection features on your key vault.",
            "waf": "Reliability"
        },
        {
            "category": "Management",
            "checklist": "Azure Key Vault",
            "guid": "cbfa96b0-5249-4e6f-947c-d0e79509708c",
            "link": "https://learn.microsoft.com/azure/key-vault/general/soft-delete-overview",
            "service": "Key Vault",
            "services": [
                "AKV",
                "ASR"
            ],
            "severity": "Low",
            "subcategory": "Business continuity and disaster recovery",
            "text": "Key Vault's soft-deleted resources are retained for a set period of 90 calendar days. Familiarize yourself with the Key Vault's soft-delete guidance.",
            "waf": "Reliability"
        },
        {
            "category": "Management",
            "checklist": "Azure Key Vault",
            "guid": "e8659d11-7e02-4db0-848c-c6541dbab68c",
            "link": "https://learn.microsoft.com/azure/key-vault/general/backup?tabs=azure-cli#limitations",
            "service": "Key Vault",
            "services": [
                "AKV",
                "ASR",
                "Backup"
            ],
            "severity": "Low",
            "subcategory": "Business continuity and disaster recovery",
            "text": "Understand Key Vault's backup limitations. Key Vault does not support the ability to backup more than 500 past versions of a key, secret, or certificate object. Attempting to backup a key, secret, or certificate object may result in an error. It is not possible to delete previous versions of a key, secret, or certificate.",
            "waf": "Reliability"
        },
        {
            "category": "Management",
            "checklist": "Azure Key Vault",
            "guid": "45c25e29-d0ef-4f07-aa04-0f8c64cbcc04",
            "link": "https://learn.microsoft.com/azure/key-vault/general/backup?tabs=azure-cli#limitations",
            "service": "Key Vault",
            "services": [
                "AKV",
                "ASR",
                "Backup"
            ],
            "severity": "Low",
            "subcategory": "Business continuity and disaster recovery",
            "text": "Key Vault doesn't currently provide a way to back up an entire key vault in a single operation and keys, secrets and certitificates must be backup indvidually. Familiarize yourself with the Key Vault's backup and restore guidance.",
            "waf": "Reliability"
        },
        {
            "category": "Management",
            "checklist": "Azure Key Vault",
            "guid": "0f15640b-31e5-4de6-85a7-d2c652fa09d3",
            "link": "https://learn.microsoft.com/azure/key-vault/general/soft-delete-overview#purge-protection",
            "service": "Key Vault",
            "services": [
                "AKV",
                "EventHubs",
                "ASR"
            ],
            "severity": "Medium",
            "subcategory": "Business continuity and disaster recovery",
            "text": "Purge protection is recommended when using keys for encryption to prevent data loss. Purge protection is an optional Key Vault behavior and is not enabled by default. Purge protection can only be enabled once soft-delete is enabled. It can be turned on via CLI, PowerShell or Portal.",
            "waf": "Reliability"
        },
        {
            "category": "Security",
            "checklist": "Azure Key Vault",
            "graph": "resources| where type =~ 'microsoft.keyvault/vaults' | extend compliant = (properties.enableRbacAuthorization == true) | distinct id, compliant",
            "guid": "d0642c1c-312b-4116-94ab-439e1c836819",
            "link": "https://learn.microsoft.com/azure/key-vault/general/rbac-guide?tabs=azure-cli",
            "service": "Key Vault",
            "services": [
                "AKV",
                "RBAC",
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Identity and Access Management",
            "text": "RBAC is recommended to control access to your key vault. Familiarize yourself with the Key Vault's access control guidance.",
            "waf": "Security"
        },
        {
            "category": "BC and DR",
            "checklist": "Azure Data Explorer Review Checklist",
            "description": "Using the correct approach to feed a datalake with cold data and having the Kusto query engine at your disposal at the same time, as in the short-term storage",
            "guid": "ba7da7be-9951-4914-a384-5d997cb39132",
            "link": "https://learn.microsoft.com/azure/data-explorer/kusto/management/data-export/continuous-data-export",
            "service": "Azure Data Explorer",
            "services": [
                "Cost",
                "Storage"
            ],
            "subcategory": "Replication",
            "text": "Leverage External Tables and Continuous data export overview to reduce costs",
            "waf": "Reliability"
        },
        {
            "category": "BC and DR",
            "checklist": "Azure Data Explorer Review Checklist",
            "description": "Azure Data Explorer provides an optional follower capability for a leader cluster to be followed by other follower clusters for read-only access to the leader's data and metadata. Changes in the leader, such as create, append, and drop are automatically synchronized to the follower. While the leaders could span Azure regions, the follower clusters should be hosted in the same region(s) as the leader. If the leader cluster is down or databases or tables are accidentally dropped, the follower clusters will lose access until access is recovered in the leader.",
            "guid": "56a22586-f490-4641-addd-ea8a377cdeb3",
            "link": "https://learn.microsoft.com/azure/data-explorer/follower?tabs=csharp",
            "service": "Azure Data Explorer",
            "services": [
                "Storage"
            ],
            "subcategory": "Replication",
            "text": "To share data, explore Leader-follower cluster configuration",
            "waf": "Reliability"
        },
        {
            "category": "BC and DR",
            "checklist": "Azure Data Explorer Review Checklist",
            "description": "Azure Data Explorer doesn't support automatic protection against the outage of an entire Azure region. This disruption can happen during a natural disaster, like an earthquake. If you require a solution for a disaster recovery situation, do the following steps to ensure business continuity. In these steps, you'll replicate your clusters, management, and data ingestion in two Azure paired regions.",
            "guid": "861bb2bc-14ae-4a6e-95d8-d9a3adc218e6",
            "link": "https://learn.microsoft.com/azure/data-explorer/business-continuity-create-solution#create-multiple-independent-clusters",
            "service": "Azure Data Explorer",
            "services": [
                "ASR"
            ],
            "subcategory": "Replication",
            "text": "To protect against regional failure, create Multiple independent clusters, preferably in two Azure Paired regions",
            "waf": "Reliability"
        },
        {
            "category": "BC and DR",
            "checklist": "Azure Data Explorer Review Checklist",
            "guid": "436b0635-cb45-4e57-a603-324ace8cc123",
            "link": "https://learn.microsoft.com/azure/data-explorer/business-continuity-create-solution#replicate-management-activities",
            "service": "Azure Data Explorer",
            "services": [
                "RBAC",
                "Storage"
            ],
            "subcategory": "Replication",
            "text": "Replicate all management activities such as creating new tables or managing user roles on each cluster.",
            "waf": "Reliability"
        },
        {
            "category": "BC and DR",
            "checklist": "Azure Data Explorer Review Checklist",
            "guid": "18ca6017-0265-4f4b-a46a-393af7f31728",
            "link": "https://learn.microsoft.com/azure/data-explorer/business-continuity-create-solution",
            "service": "Azure Data Explorer",
            "services": [],
            "subcategory": "Replication",
            "text": "Ingest data into each cluster in parallel",
            "waf": "Reliability"
        },
        {
            "category": "BC and DR",
            "checklist": "Azure Data Explorer Review Checklist",
            "description": "This configuration is also called 'always-on'. For critical application deployments with no tolerance for outages, you should use multiple Azure Data Explorer clusters across Azure paired regions.",
            "guid": "58a9c279-9c42-4bb6-9d0c-65556246b338",
            "link": "https://learn.microsoft.com/azure/data-explorer/business-continuity-overview#active-active-active-configuration",
            "service": "Azure Data Explorer",
            "services": [
                "ACR"
            ],
            "subcategory": "DR Configuration",
            "text": "For critical application with no tolerance for outages, create Active-Active-Active (always-on) configuration",
            "waf": "Reliability"
        },
        {
            "category": "BC and DR",
            "checklist": "Azure Data Explorer Review Checklist",
            "description": "This configuration is identical to the active-active-active configuration, but only involves two Azure paired regions. Configure dual ingestion, processing, and curation. Users are routed to the nearest region. The cluster SKU must be the same across regions.",
            "guid": "563a4dc7-4a74-48b6-922a-d190916a6649",
            "link": "https://learn.microsoft.com/azure/data-explorer/business-continuity-overview#active-active-configuration",
            "service": "Azure Data Explorer",
            "services": [
                "ACR"
            ],
            "subcategory": "DR Configuration",
            "text": "For critical applications, create Active-Active configuration in two paired regions",
            "waf": "Reliability"
        },
        {
            "category": "BC and DR",
            "checklist": "Azure Data Explorer Review Checklist",
            "description": "The Active-Hot configuration is similar to the Active-Active configuration in dual ingest, processing, and curation. While the standby cluster is online for ingestion, process, and curation, it isn't available to query. The standby cluster doesn't need to be in the same SKU as the primary cluster. It can be of a smaller SKU and scale, which may result in it being less performant. In a disaster scenario, users are redirected to the standby cluster, which can optionally be scaled up to increase performance.",
            "guid": "8fadfe27-7de2-483b-8ac3-52baa9b75708",
            "link": "https://learn.microsoft.com/azure/data-explorer/business-continuity-overview#active-hot-standby-configuration",
            "service": "Azure Data Explorer",
            "services": [],
            "subcategory": "DR Configuration",
            "text": "For applications, which required only read during failure, create Active-Hot standby configuration",
            "waf": "Reliability"
        },
        {
            "category": "BC and DR",
            "checklist": "Azure Data Explorer Review Checklist",
            "description": "This solution offers the least resiliency (highest RPO and RTO), is the lowest in cost and highest in effort. In this configuration, there's no data recovery cluster. Configure continuous export of curated data (unless raw and intermediate data is also required) to a storage account that is configured GRS (Geo Redundant Storage). A data recovery cluster is spun up if there is a disaster recovery scenario. At that time, DDLs, configuration, policies, and processes are applied. Data is ingested from storage with the ingestion property kustoCreationTime to over-ride the ingestion time that defaults to system time.",
            "guid": "49aa8092-dc8e-4b9d-8bb7-3b26a5a67eba",
            "link": "https://learn.microsoft.com/azure/data-explorer/business-continuity-overview#on-demand-data-recovery-configuration",
            "service": "Azure Data Explorer",
            "services": [
                "AzurePolicy",
                "Cost",
                "Storage",
                "ASR"
            ],
            "subcategory": "DR Configuration",
            "text": "For applications, where cost is a concern and can withstand some downtime during failure, create on-demand data recovery cluster configuration",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Azure Data Explorer Review Checklist",
            "description": "All database objects, policies, and configurations should be persisted in source control so they can be released to the cluster from your release automation tool.",
            "guid": "5a907e1e-348e-4f25-9c27-d32e8bbac757",
            "link": "https://learn.microsoft.com/azure/data-explorer/devops",
            "service": "Azure Data Explorer",
            "services": [
                "AzurePolicy"
            ],
            "subcategory": "IaC",
            "text": "Wrap DevOps and source control around all your code",
            "training": "https://learn.microsoft.com/learn/paths/secure-your-cloud-data/",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Azure Data Explorer Review Checklist",
            "guid": "1559ab91-53e8-4908-ae28-b84c33b6b780",
            "link": "https://learn.microsoft.com/azure/data-explorer/devops",
            "service": "Azure Data Explorer",
            "services": [],
            "subcategory": "IaC",
            "text": "Design, develop, and implement validation routines to ensure all clusters are in-sync from a data perspective.",
            "training": "https://learn.microsoft.com/learn/modules/azure-active-directory/",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Azure Data Explorer Review Checklist",
            "guid": "8b9fe5c4-1049-4d40-9a82-2c3474d00f18",
            "link": "https://learn.microsoft.com/azure/data-explorer/devops",
            "service": "Azure Data Explorer",
            "services": [],
            "subcategory": "IaC",
            "text": "Be fully cognizant of what it takes to build a cluster from scratch. Leverage Infrastructure as a Code for your deployments",
            "training": "https://learn.microsoft.com/learn/modules/implement-hybrid-identity-windows-server/",
            "waf": "Reliability"
        },
        {
            "category": "Automation",
            "checklist": "SAP Checklist",
            "guid": "4620dc87-e948-4ce8-8426-f3e6e5d7bd85",
            "link": "https://learn.microsoft.com/azure/sap/center-sap-solutions/overview",
            "service": "SAP",
            "services": [
                "SAP"
            ],
            "severity": "Medium",
            "subcategory": "ACSS",
            "text": "Azure Center for SAP solutions (ACSS) is an Azure offering that makes SAP a top-level workload on Azure. ACSS is an end-to-end solution that enables you to create and run SAP systems as a unified workload on Azure and provides a more seamless foundation for innovation. You can take advantage of the management capabilities for both new and existing Azure-based SAP systems.",
            "training": "https://learn.microsoft.com/training/modules/explore-azure-center-sap-solutions/?source=recommendations",
            "waf": "Operations"
        },
        {
            "category": "Automation",
            "checklist": "SAP Checklist",
            "guid": "5d75e99d-624d-4afe-91d9-e17adc580790",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/sap/eslz-platform-automation-and-devops",
            "service": "SAP",
            "services": [
                "SAP"
            ],
            "severity": "Medium",
            "subcategory": "SDAF",
            "text": "Azure supports automating SAP deployments in Linux and Windows. SAP Deployment Automation Framework is an open-source orchestration tool that can deploy, install, and maintain SAP environments.",
            "training": "https://github.com/Azure/sap-automation",
            "waf": "Operations"
        },
        {
            "category": "Business Continuity and Disaster Recovery",
            "checklist": "SAP Checklist",
            "guid": "d17f6f39-a377-48a2-931f-5ead3ebe33a8",
            "link": "https://learn.microsoft.com/azure/well-architected/sap/design-areas/data-platform",
            "service": "SAP",
            "services": [
                "SAP",
                "ASR",
                "Backup"
            ],
            "severity": "Medium",
            "subcategory": "Backup and restore",
            "text": "Perform a point-in-time recovery for your production databases at any point and in a time frame that meets your RTO; point-in-time recovery typically includes operator errors deleting data either on the DBMS layer or through SAP, incidentally",
            "waf": "Reliability"
        },
        {
            "category": "Business Continuity and Disaster Recovery",
            "checklist": "SAP Checklist",
            "guid": "c4b8e117-930b-4dbd-ae50-7bc5faf6f91a",
            "service": "SAP",
            "services": [
                "SAP",
                "ASR",
                "Backup"
            ],
            "severity": "Medium",
            "subcategory": "Disaster recovery",
            "text": "Test the backup and recovery times to verify that they meet your RTO requirements for restoring all systems simultaneously after a disaster.",
            "waf": "Reliability"
        },
        {
            "category": "Business Continuity and Disaster Recovery",
            "checklist": "SAP Checklist",
            "guid": "b651423c-8552-42db-a545-5cb50c05527a",
            "link": "https://learn.microsoft.com/azure/reliability/cross-region-replication-azure",
            "service": "SAP",
            "services": [
                "SQL",
                "SAP",
                "ASR",
                "Backup",
                "Storage"
            ],
            "severity": "High",
            "subcategory": "Disaster recovery",
            "text": "You can replicate standard storage between paired regions, but you can't use standard storage to store your databases or virtual hard disks. You can replicate backups only between paired regions that you use. For all your other data, run your replication by using native DBMS features like SQL Server Always On or SAP HANA System Replication. Use a combination of Site Recovery, rsync or robocopy, and other third-party software for the SAP application layer.",
            "training": "https://learn.microsoft.com/training/paths/ensure-business-continuity-implement-disaster-recovery/",
            "waf": "Reliability"
        },
        {
            "category": "Business Continuity and Disaster Recovery",
            "checklist": "SAP Checklist",
            "guid": "aa208dca-784f-46c6-9014-cc919c542dc9",
            "link": "https://learn.microsoft.com/azure/sap/workloads/high-availability-zones",
            "service": "SAP",
            "services": [
                "SAP",
                "ASR"
            ],
            "severity": "Medium",
            "subcategory": "Disaster recovery",
            "text": "When using Azure Availability Zones to achieve high availability, you must consider latency between SAP application servers and database servers. For zones with high latencies, operational procedures need to be in place to ensure that SAP application servers and database servers are running in the same zone at all times.",
            "training": "https://learn.microsoft.com/training/modules/implement-high-availability-for-sap-workloads-azure/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "category": "Business Continuity and Disaster Recovery",
            "checklist": "SAP Checklist",
            "guid": "ba07c007-1f90-43e9-aa4f-601346b80352",
            "link": "https://learn.microsoft.com/azure/expressroute/designing-for-disaster-recovery-with-expressroute-privatepeering",
            "service": "SAP",
            "services": [
                "SAP",
                "ExpressRoute",
                "VPN",
                "ASR"
            ],
            "severity": "High",
            "subcategory": "Disaster recovery",
            "text": "Set up ExpressRoute connections from on-premises to the primary and secondary Azure disaster recovery regions. Also, as an alternative to using ExpressRoute, consider setting up VPN connections from on-premises to the primary and secondary Azure disaster recovery regions.",
            "training": "https://learn.microsoft.com/azure/expressroute/use-s2s-vpn-as-backup-for-expressroute-privatepeering",
            "waf": "Reliability"
        },
        {
            "category": "Business Continuity and Disaster Recovery",
            "checklist": "SAP Checklist",
            "guid": "d2b30195-b11d-4a8f-a672-28b2b4169a7c",
            "link": "https://learn.microsoft.com/azure/key-vault/general/disaster-recovery-guidance",
            "service": "SAP",
            "services": [
                "AKV",
                "SAP",
                "ACR",
                "ASR"
            ],
            "severity": "Low",
            "subcategory": "Disaster recovery",
            "text": "Replicate key vault contents like certificates, secrets, or keys across regions so you can decrypt data in the DR region.",
            "waf": "Reliability"
        },
        {
            "category": "Business Continuity and Disaster Recovery",
            "checklist": "SAP Checklist",
            "guid": "05f1101d-250f-40e7-b2a1-b674ab50edbd",
            "link": "https://learn.microsoft.com/azure/architecture/guide/sap/sap-s4hana",
            "service": "SAP",
            "services": [
                "VNet",
                "SAP",
                "ASR"
            ],
            "severity": "Medium",
            "subcategory": "Disaster recovery",
            "text": "Peer the primary and disaster recovery virtual networks. For example, for HANA System Replication, an SAP HANA DB virtual network needs to be peered to the disaster recovery site's SAP HANA DB virtual network.",
            "waf": "Reliability"
        },
        {
            "category": "Business Continuity and Disaster Recovery",
            "checklist": "SAP Checklist",
            "guid": "d3351bf7-628a-46de-917d-dfc11d3b6b40",
            "link": "https://learn.microsoft.com/azure/azure-netapp-files/azure-netapp-files-service-levels",
            "service": "SAP",
            "services": [
                "ASR",
                "SAP",
                "Storage"
            ],
            "severity": "Low",
            "subcategory": "Disaster recovery",
            "text": "If you use Azure NetApp Files storage for your SAP deployments, at a minimum, create two Azure NetApp Files accounts in the Premium tier, in two regions.",
            "training": "https://learn.microsoft.com/training/modules/choose-service-level-azure-netapp-files-hpc-applications/2-identify-decision-criteria",
            "waf": "Reliability"
        },
        {
            "category": "Business Continuity and Disaster Recovery",
            "checklist": "SAP Checklist",
            "guid": "726a1d3e-5508-4a06-9d54-93f4b50040c1",
            "link": "https://learn.microsoft.com/azure/sap/workloads/disaster-recovery-sap-guide?tabs=windows",
            "service": "SAP",
            "services": [
                "SAP",
                "ASR"
            ],
            "severity": "High",
            "subcategory": "Disaster recovery",
            "text": "Native database replication technology should be used to synchronize the database in a HA pair.",
            "training": "https://learn.microsoft.com/training/modules/implement-disaster-recovery-for-sap-workloads-azure/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "category": "Business Continuity and Disaster Recovery",
            "checklist": "SAP Checklist",
            "guid": "6561f847-3db5-4ff8-9200-5ad3c3b436ad",
            "link": "https://learn.microsoft.com/ja-jp/azure/virtual-network/virtual-networks-faq",
            "service": "SAP",
            "services": [
                "VNet",
                "SAP",
                "ASR"
            ],
            "severity": "High",
            "subcategory": "Disaster recovery",
            "text": "The CIDR for the primary virtual network (VNet) shouldn't conflict or overlap with the CIDR of the DR site's VNet",
            "training": "https://learn.microsoft.com/training/paths/azure-fundamentals-describe-azure-architecture-services/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "category": "Business Continuity and Disaster Recovery",
            "checklist": "SAP Checklist",
            "guid": "0258ed30-fe42-434f-87b9-58f91f908e0a",
            "service": "SAP",
            "services": [
                "VM",
                "SAP",
                "Entra",
                "ASR"
            ],
            "severity": "High",
            "subcategory": "Disaster recovery",
            "text": "Use Site Recovery to replicate an application server to a DR site. Site Recovery can also help with replicating central-services cluster VMs to the DR site. When you invoke DR, you'll need to reconfigure the Linux Pacemaker cluster on the DR site (for example, replace the VIP or SBD, run corosync.conf, and more).",
            "training": "https://learn.microsoft.com/training/paths/ensure-business-continuity-implement-disaster-recovery/",
            "waf": "Reliability"
        },
        {
            "category": "Business Continuity and Disaster Recovery",
            "checklist": "SAP Checklist",
            "guid": "8300cb30-766b-4084-b126-0dd8fb1269a1",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/sap/eslz-business-continuity-and-disaster-recovery",
            "service": "SAP",
            "services": [
                "SAP",
                "ASR"
            ],
            "severity": "High",
            "subcategory": "High availability",
            "text": "Consider the availability of SAP software against single points of failure. This includes single points of failure within applications such as DBMSs utilized in SAP NetWeaver and SAP S/4HANA architectures, SAP ABAP and ASCS + SCS. Also, other tools such as SAP Web Dispatcher.",
            "training": "https://learn.microsoft.com/training/modules/implement-high-availability-for-sap-workloads-azure/2-explore-high-availability-disaster-recovery-support-azure-for-sap-workloads?source=recommendations",
            "waf": "Reliability"
        },
        {
            "category": "Business Continuity and Disaster Recovery",
            "checklist": "SAP Checklist",
            "guid": "56402f11-ccbe-42c3-a2f6-c6f6f38ab579",
            "link": "https://learn.microsoft.com/azure/sap/workloads/planning-supported-configurations",
            "service": "SAP",
            "services": [
                "SAP",
                "ASR"
            ],
            "severity": "High",
            "subcategory": "High availability",
            "text": "For SAP and SAP databases, consider implementing automatic failover clusters. In Windows, Windows Server Failover Clustering supports failover. In Linux, Linux Pacemaker or third-party tools like SIOS Protection Suite and Veritas InfoScale support failover.",
            "training": "https://learn.microsoft.com/training/modules/implement-ha-sap-netweaver-anydb/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "category": "Business Continuity and Disaster Recovery",
            "checklist": "SAP Checklist",
            "guid": "afae6bec-2671-49ae-bc69-140b8ec8d320",
            "link": "https://learn.microsoft.com/azure/sap/workloads/disaster-recovery-sap-guide?tabs=windows",
            "service": "SAP",
            "services": [
                "ASR",
                "SAP",
                "VM",
                "Storage"
            ],
            "severity": "High",
            "subcategory": "High availability",
            "text": "Azure doesn't support architectures in which the primary and secondary VMs share storage for DBMS data. For the DBMS layer, the common architecture pattern is to replicate databases at the same time and with different storage stacks than the ones that the primary and secondary VMs use.",
            "training": "https://learn.microsoft.com/training/paths/ensure-business-continuity-implement-disaster-recovery/?source=recommendationshttps%3A%2F%2Flearn.microsoft.com%2Fja-jp%2Ftraining%2Fpaths%2Fensure-business-continuity-implement-disaster-recovery%2F%3Fsource%3Drecommendations",
            "waf": "Reliability"
        },
        {
            "category": "Business Continuity and Disaster Recovery",
            "checklist": "SAP Checklist",
            "guid": "ac614e95-6767-4bc3-b8a4-9953533da6ba",
            "link": "https://learn.microsoft.com/azure/sap/workloads/dbms-guide-general",
            "service": "SAP",
            "services": [
                "ASR",
                "SAP",
                "Storage"
            ],
            "severity": "High",
            "subcategory": "High availability",
            "text": "The DBMS data and transaction/redo log files are stored in Azure supported block storage or Azure NetApp Files. Azure Files or Azure Premium Files isn't supported as storage for DBMS data and/or redo log files with SAP workload.",
            "training": "https://learn.microsoft.com/training/modules/explore-azure-databases/2-explore-database-support-azure-for-sap-workloads",
            "waf": "Reliability"
        },
        {
            "category": "Business Continuity and Disaster Recovery",
            "checklist": "SAP Checklist",
            "guid": "1f737179-8e7f-4e1a-a30c-e5a649a3092b",
            "link": "https://learn.microsoft.com/azure/sap/workloads/sap-high-availability-guide-wsfc-shared-disk",
            "service": "SAP",
            "services": [
                "SAP",
                "ASR"
            ],
            "severity": "High",
            "subcategory": "High availability",
            "text": "You can use Azure shared disks in Windows for ASCS + SCS components and specific high-availability scenarios. Set up your failover clusters separately for SAP application layer components and the DBMS layer. Azure doesn't currently support high-availability architectures that combine SAP application layer components and the DBMS layer into one failover cluster.",
            "training": "https://learn.microsoft.com/training/modules/implement-ha-sap-netweaver-anydb/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "category": "Business Continuity and Disaster Recovery",
            "checklist": "SAP Checklist",
            "guid": "a78b3d31-3170-44f2-b5d7-651a29f4ccf5",
            "link": "https://learn.microsoft.com/azure/sap/workloads/high-availability-guide-standard-load-balancer-outbound-connections",
            "service": "SAP",
            "services": [
                "SAP",
                "LoadBalancer",
                "ASR"
            ],
            "severity": "High",
            "subcategory": "High availability",
            "text": "Most failover clusters for SAP application layer components (ASCS) and the DBMS layer require a virtual IP address for a failover cluster.  Azure Load Balancer should handle the virtual IP address for all other cases. One design principle is to use one load balancer per cluster configuration. We recommend that you use the standard version of the load balancer (Standard Load Balancer SKU).",
            "training": "https://learn.microsoft.com/training/modules/implement-high-availability-for-sap-workloads-azure/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "category": "Business Continuity and Disaster Recovery",
            "checklist": "SAP Checklist",
            "guid": "1a541741-5833-4fb4-ae3c-2df743165c3a",
            "link": "https://learn.microsoft.com/azure/load-balancer/load-balancer-ha-ports-overview?source=recommendations",
            "service": "SAP",
            "services": [
                "SAP",
                "LoadBalancer",
                "ASR"
            ],
            "severity": "High",
            "subcategory": "High availability",
            "text": "Make sure the Floating IP is enabled on the Load balancer",
            "training": "https://learn.microsoft.com/training/modules/load-balancing-non-https-traffic-azure/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "category": "Business Continuity and Disaster Recovery",
            "checklist": "SAP Checklist",
            "guid": "c47cc4f3-f105-452c-845e-9b307b3856c1",
            "link": "https://learn.microsoft.com/azure/virtual-machines/availability",
            "service": "SAP",
            "services": [
                "SAP",
                "ASR"
            ],
            "severity": "High",
            "subcategory": "High availability",
            "text": "Before you deploy your high-availability infrastructure, and depending on the region you choose, determine whether to deploy with an Azure availability set or an availability zone.",
            "training": "https://learn.microsoft.com/training/modules/configure-virtual-machine-availability/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "category": "Business Continuity and Disaster Recovery",
            "checklist": "SAP Checklist",
            "guid": "844f69c3-07e5-4ec1-bff7-4be27bcf5fea",
            "link": "https://www.microsoft.com/licensing/docs/view/Service-Level-Agreements-SLA-for-Online-Services?lang=1",
            "service": "SAP",
            "services": [
                "SAP",
                "VM",
                "ASR",
                "Entra"
            ],
            "severity": "High",
            "subcategory": "High availability",
            "text": "If you want to meet the infrastructure SLAs for your applications for SAP components (central services, application servers, and databases), you must choose the same high availability options (VMs, availability sets, availability zones) for all components.",
            "waf": "Reliability"
        },
        {
            "category": "Business Continuity and Disaster Recovery",
            "checklist": "SAP Checklist",
            "guid": "cbe05bbe-209d-4490-ba47-778424d11678",
            "link": "https://learn.microsoft.com/azure/virtual-machines/availability-set-overview",
            "service": "SAP",
            "services": [
                "SAP",
                "ASR",
                "RBAC",
                "Entra",
                "VM"
            ],
            "severity": "High",
            "subcategory": "High availability",
            "text": "Do not mix servers of different roles in the same availability set. Keep central services VMs, database VMs, application VMs in their own availability sets",
            "training": "https://learn.microsoft.com/training/modules/configure-virtual-machine-availability/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "category": "Business Continuity and Disaster Recovery",
            "checklist": "SAP Checklist",
            "guid": "f2201000-d045-40a6-a79a-d7cdc01b4d86",
            "link": "https://learn.microsoft.com/azure/virtual-machines/co-location",
            "service": "SAP",
            "services": [
                "SAP",
                "ASR"
            ],
            "severity": "Medium",
            "subcategory": "High availability",
            "text": "You can't deploy Azure availability sets within an Azure availability zone unless you use proximity placement groups.",
            "training": "https://learn.microsoft.com/azure/sap/workloads/proximity-placement-scenarios",
            "waf": "Reliability"
        },
        {
            "category": "Business Continuity and Disaster Recovery",
            "checklist": "SAP Checklist",
            "guid": "9674e7c7-7796-4181-8920-09f4429543ba",
            "link": "https://learn.microsoft.com/azure/virtual-machines/availability-set-overview",
            "service": "SAP",
            "services": [
                "SAP",
                "VM",
                "ASR"
            ],
            "severity": "High",
            "subcategory": "High availability",
            "text": "When you create availability sets, use the maximum number of fault domains and update domains available. For example, if you deploy more than two VMs in one availability set, use the maximum number of fault domains (three) and enough update domains to limit the effect of potential physical hardware failures, network outages, or power interruptions, in addition to Azure planned maintenance. The default number of fault domains is two, and you can't change it online later.",
            "training": "https://learn.microsoft.com/training/modules/configure-virtual-machine-availability/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "category": "Business Continuity and Disaster Recovery",
            "checklist": "SAP Checklist",
            "guid": "ae4ecb95-b70f-428f-8b9a-4c5b7e3478a2",
            "link": "https://learn.microsoft.com/azure/sap/workloads/proximity-placement-scenarios",
            "service": "SAP",
            "services": [
                "SAP",
                "Entra",
                "ASR"
            ],
            "severity": "High",
            "subcategory": "High availability",
            "text": "When you use Azure proximity placement groups in an availability set deployment, all three SAP components (central services, application server, and database) should be in the same proximity placement group.",
            "waf": "Reliability"
        },
        {
            "category": "Business Continuity and Disaster Recovery",
            "checklist": "SAP Checklist",
            "guid": "5d2fa56c-56ad-4484-88fe-72734c486ba2",
            "link": "https://learn.microsoft.com/azure/sap/workloads/proximity-placement-scenarios",
            "service": "SAP",
            "services": [
                "SAP",
                "ACR",
                "ASR"
            ],
            "severity": "High",
            "subcategory": "High availability",
            "text": "Use one proximity placement group per SAP SID. Groups don't span across Availability Zones or Azure regions",
            "waf": "Reliability"
        },
        {
            "category": "Business Continuity and Disaster Recovery",
            "checklist": "SAP Checklist",
            "guid": "bca3b10e-0ff5-4aec-ac16-4c4bd1a1c13f",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/sap/eslz-business-continuity-and-disaster-recovery",
            "service": "SAP",
            "services": [
                "SAP",
                "Entra",
                "ASR"
            ],
            "severity": "High",
            "subcategory": "High availability",
            "text": "Use one of the following services to run SAP central services clusters, depending on the operating system.",
            "training": "https://learn.microsoft.com/training/modules/implement-ha-sap-netweaver-anydb/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "category": "Business Continuity and Disaster Recovery",
            "checklist": "SAP Checklist",
            "guid": "ed46b937-913e-4018-9c62-8393ab037e53",
            "link": "https://learn.microsoft.com/azure/sap/workloads/high-availability-guide-suse-multi-sid",
            "service": "SAP",
            "services": [
                "VM",
                "SAP",
                "Entra",
                "ASR"
            ],
            "severity": "Medium",
            "subcategory": "High availability",
            "text": "Azure doesn't currently support combining ASCS and DB HA in the same Linux Pacemaker cluster; separate them into individual clusters. However, you can combine up to five multiple central-services clusters into a pair of VMs.",
            "training": "https://learn.microsoft.com/training/modules/implement-ha-sap-netweaver-anydb/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "category": "Business Continuity and Disaster Recovery",
            "checklist": "SAP Checklist",
            "guid": "f656e745-0cfb-453e-8008-0528fa21c933",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/sap/eslz-business-continuity-and-disaster-recovery",
            "service": "SAP",
            "services": [
                "ASR",
                "SAP",
                "VM",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "High availability",
            "text": "Deploy both VMs in the high-availability pair in an availability set or in availability zones. These VMs should be the same size and have the same storage configuration.",
            "waf": "Reliability"
        },
        {
            "category": "Business Continuity and Disaster Recovery",
            "checklist": "SAP Checklist",
            "guid": "7f684ebc-95da-425e-b329-e782dbed050f",
            "link": "https://learn.microsoft.com/azure/sap/workloads/high-availability-guide-rhel-with-hana-ascs-ers-dialog-instance",
            "service": "SAP",
            "services": [
                "SAP",
                "ASR"
            ],
            "severity": "Medium",
            "subcategory": "High availability",
            "text": "Azure supports installing and configuring SAP HANA and ASCS/SCS and ERS instances on the same high availability cluster running on Red Hat Enterprise Linux (RHEL).",
            "training": "https://learn.microsoft.com/training/modules/implement-ha-sap-netweaver-anydb/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "category": "Business Continuity and Disaster Recovery",
            "checklist": "SAP Checklist",
            "guid": "07991f7d-6598-4d90-9431-45c62605d3a5",
            "link": "https://learn.microsoft.com/azure/sap/workloads/planning-guide-storage",
            "service": "SAP",
            "services": [
                "ASR",
                "SAP",
                "Storage"
            ],
            "severity": "High",
            "subcategory": "Storage",
            "text": "Run all production systems on Premium managed SSDs and use Azure NetApp Files or Ultra Disk Storage. At least the OS disk should be on the Premium tier so you can achieve better performance and the best SLA.",
            "training": "https://learn.microsoft.com/training/modules/explore-azure-storage/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "category": "Business Continuity and Disaster Recovery",
            "checklist": "SAP Checklist",
            "guid": "73cdaecc-7d74-48d8-a040-88416eebc98c",
            "link": "https://learn.microsoft.com/azure/sap/workloads/hana-vm-operations-storage",
            "service": "SAP",
            "services": [
                "ASR",
                "SAP",
                "Storage"
            ],
            "severity": "High",
            "subcategory": "Storage",
            "text": "You should run SAP HANA on Azure only on the types of storage that are certified by SAP. Note that certain volumes must be run on certain disk configurations, where applicable. These configurations include enabling Write Accelerator and using Premium storage. You also need to ensure that the file system that runs on storage is compatible with the DBMS that runs on the machine.",
            "training": "https://learn.microsoft.com/azure/sap/workloads/hana-vm-premium-ssd-v1?source=recommendations",
            "waf": "Reliability"
        },
        {
            "category": "Business Continuity and Disaster Recovery",
            "checklist": "SAP Checklist",
            "guid": "51904867-a70e-4fa0-b4ff-3e6292846d7c",
            "link": "https://learn.microsoft.com/azure/sap/workloads/disaster-recovery-overview-guide#storage",
            "service": "SAP",
            "services": [
                "SAP",
                "Storage",
                "ASR"
            ],
            "severity": "High",
            "subcategory": "Storage",
            "text": "Consider configuring high availability depending on the type of storage you use for your SAP workloads. Some storage services available in Azure are not supported by Azure Site Recovery, so your high availability configuration may differ.",
            "training": "https://learn.microsoft.com/training/modules/implement-disaster-recovery-for-sap-workloads-azure/2-explore-disaster-recovery-sap-workloads",
            "waf": "Reliability"
        },
        {
            "category": "Business Continuity and Disaster Recovery",
            "checklist": "SAP Checklist",
            "guid": "1ac2d928-c9b7-42c6-ba18-23b1aea78693",
            "link": "https://azure.microsoft.com/ja-jp/explore/global-infrastructure/products-by-region/",
            "service": "SAP",
            "services": [
                "ASR",
                "SAP",
                "Storage"
            ],
            "severity": "High",
            "subcategory": "Storage",
            "text": "Different native Azure storage services (like Azure Files, Azure NetApp Files, Azure Shared Disk) may not be available in all regions. So to have similar SAP setup on the DR region after failover, ensure the respective storage service is offered in DR site.",
            "waf": "Reliability"
        },
        {
            "category": "Cost Optimization",
            "checklist": "SAP Checklist",
            "guid": "925d1f8c-01f3-4a67-948e-aabf0a1fad60",
            "link": "https://techcommunity.microsoft.com/t5/running-sap-applications-on-the/optimize-your-azure-costs-by-automating-sap-system-start-stop/ba-p/2120675",
            "service": "SAP",
            "services": [
                "SAP",
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "&nbsp",
            "text": "Automate SAP System Start-Stop to manage costs.",
            "waf": "Cost"
        },
        {
            "category": "Cost Optimization",
            "checklist": "SAP Checklist",
            "guid": "71dc00cd-4392-4262-8949-20c05e6c0333",
            "link": "https://learn.microsoft.com/azure/sap/workloads/hana-vm-premium-ssd-v1",
            "service": "SAP",
            "services": [
                "VM",
                "SAP",
                "Cost",
                "Storage"
            ],
            "severity": "Low",
            "subcategory": "&nbsp",
            "text": "In the case of using Azure Premium Storage with SAP HANA, Azure Standard SSD storage can be used to select a cost-conscious storage solution. However, please note that choosing Standard SSD or Standard HDD Azure storage will affect the SLA of the individual VMs. Also, for systems with lower I/O throughput and low latency, such as non-production environments, lower series VMs can be used.",
            "waf": "Cost"
        },
        {
            "category": "Cost Optimization",
            "checklist": "SAP Checklist",
            "guid": "9877f353-2591-4e8b-8381-e9043fed1010",
            "link": "https://learn.microsoft.com/azure/sap/workloads/hana-vm-premium-ssd-v1",
            "service": "SAP",
            "services": [
                "VM",
                "SAP",
                "Cost",
                "Storage"
            ],
            "severity": "Low",
            "subcategory": "&nbsp",
            "text": "As a lower-cost alternative configuration (multipurpose), you can choose a low-performance SKU for your non-production HANA database server VMs. However, it is important to note that some VM types, such as E-series, are not HANA certified (SAP HANA Hardware Directory) or cannot achieve storage latency of less than 1ms.",
            "waf": "Cost"
        },
        {
            "category": "Identity and Access",
            "checklist": "SAP Checklist",
            "guid": "fda1dbf3-dc95-4d48-a7c7-91dca0f6c565",
            "link": "https://learn.microsoft.com/azure/well-architected/sap/design-areas/security",
            "service": "SAP",
            "services": [
                "SAP",
                "Subscriptions",
                "RBAC",
                "Entra"
            ],
            "severity": "High",
            "subcategory": "Identity",
            "text": "Enforce a RBAC model for management groups, subscriptions, resource groups and resources",
            "training": "https://learn.microsoft.com/training/paths/implement-resource-mgmt-security/",
            "waf": "Security"
        },
        {
            "category": "Identity and Access",
            "checklist": "SAP Checklist",
            "guid": "45911475-e39e-4530-accc-d979366bcda2",
            "link": "https://learn.microsoft.com/azure/active-directory/fundamentals/scenario-azure-first-sap-identity-integration",
            "service": "SAP",
            "services": [
                "SAP",
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Identity",
            "text": "Enforce Principal propagation for forwarding the identity from SAP cloud application to SAP on-premises (Including IaaS) through cloud connector",
            "training": "https://learn.microsoft.com/training/modules/explore-identity-services/2-explore-azure-virtual-machine-auth-access-control",
            "waf": "Security"
        },
        {
            "category": "Identity and Access",
            "checklist": "SAP Checklist",
            "guid": "750ab1ab-039d-495d-94c7-c8929cb107d5",
            "link": "https://learn.microsoft.com/azure/active-directory/fundamentals/scenario-azure-first-sap-identity-integration",
            "service": "SAP",
            "services": [
                "SAP",
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Identity",
            "text": "Implement SSO to SAP SaaS applications like SAP Analytics Cloud, SAP Cloud Platform, Business by design, SAP Qualtrics and SAP C4C with Azure AD using SAML.",
            "waf": "Security"
        },
        {
            "category": "Identity and Access",
            "checklist": "SAP Checklist",
            "guid": "325ae525-ba34-4d46-a5e2-213ace7bb122",
            "link": "https://learn.microsoft.com/azure/active-directory/saas-apps/sap-netweaver-tutorial",
            "service": "SAP",
            "services": [
                "SAP",
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Identity",
            "text": "Implement SSO to SAP NetWeaver-based web applications like SAP Fiori and SAP Web GUI by using SAML.",
            "training": "https://learn.microsoft.com/training/modules/explore-identity-services/8-exercise-integrate-azure-active-directory-sap-netweaver",
            "waf": "Security"
        },
        {
            "category": "Identity and Access",
            "checklist": "SAP Checklist",
            "guid": "9eb54dad-7861-4e1c-973a-f3bb003fc9c1",
            "service": "SAP",
            "services": [
                "SAP",
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Identity",
            "text": "Implement SSO to SAP NetWeaver-based web applications like SAP Fiori and SAP Web GUI by using SAML.",
            "training": "https://learn.microsoft.com/training/modules/explore-identity-services/6-exercise-integrate-azure-active-directory-sap-fiori",
            "waf": "Security"
        },
        {
            "category": "Identity and Access",
            "checklist": "SAP Checklist",
            "guid": "f29676ef-0c9c-4c4d-ab21-a55504c0c829",
            "link": "https://learn.microsoft.com/azure/active-directory/saas-apps/sap-netweaver-tutorial",
            "service": "SAP",
            "services": [
                "SAP",
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Identity",
            "text": "You can implement SSO to SAP GUI by using SAP NetWeaver SSO or a partner solution.",
            "training": "https://learn.microsoft.com/training/modules/explore-identity-services/8-exercise-integrate-azure-active-directory-sap-netweaver",
            "waf": "Security"
        },
        {
            "category": "Identity and Access",
            "checklist": "SAP Checklist",
            "guid": "23181aa4-1742-4694-9ff8-ae7d7d474317",
            "service": "SAP",
            "services": [
                "AKV",
                "SAP",
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Identity",
            "text": "For SSO for SAP GUI and web browser access, implement SNC / Kerberos/SPNEGO (simple and protected GSSAPI negotiation mechanism) due to its ease of configuration and maintenance. For SSO with X.509 client certificates, consider the SAP Secure Login Server, which is a component of the SAP SSO solution.",
            "training": "https://learn.microsoft.com/training/modules/explore-identity-services/9-exercise-integrate-active-directory-sap-single-sign-on",
            "waf": "Security"
        },
        {
            "category": "Identity and Access",
            "checklist": "SAP Checklist",
            "guid": "6c8bcbf4-5bbe-4609-b8a0-3e97778424d6",
            "link": "https://blogs.sap.com/2017/07/12/sap-single-sign-on-protect-your-sap-landscape-with-x.509-certificates/",
            "service": "SAP",
            "services": [
                "AKV",
                "SAP",
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Identity",
            "text": "For SSO for SAP GUI and web browser access, implement SNC / Kerberos/SPNEGO (simple and protected GSSAPI negotiation mechanism) due to its ease of configuration and maintenance. For SSO with X.509 client certificates, consider the SAP Secure Login Server, which is a component of the SAP SSO solution.",
            "waf": "Security"
        },
        {
            "category": "Identity and Access",
            "checklist": "SAP Checklist",
            "guid": "16785d6f-a96c-496a-b885-18f482734c88",
            "link": "https://learn.microsoft.com/azure/active-directory/saas-apps/sap-netweaver-tutorial#configure-sap-netweaver-for-oauth",
            "service": "SAP",
            "services": [
                "SAP",
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Identity",
            "text": "Implement SSO by using OAuth for SAP NetWeaver to allow third-party or custom applications to access SAP NetWeaver OData services.",
            "waf": "Security"
        },
        {
            "category": "Identity and Access",
            "checklist": "SAP Checklist",
            "guid": "a747c350-8d4c-449c-93af-393dbca77c48",
            "link": "https://learn.microsoft.com/azure/active-directory/saas-apps/saphana-tutorial",
            "service": "SAP",
            "services": [
                "SAP",
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Identity",
            "text": "Implement SSO to SAP HANA",
            "waf": "Security"
        },
        {
            "category": "Identity and Access",
            "checklist": "SAP Checklist",
            "guid": "c7bae5bf-daf9-4761-9c56-f92891890aa4",
            "link": "https://learn.microsoft.com/azure/sap/workloads/rise-integration#connectivity-with-sap-rise",
            "service": "SAP",
            "services": [
                "SAP",
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Identity",
            "text": "Consider Azure AD an identity provider for SAP systems hosted on RISE. For more information, see Integrating the Service with Azure AD.",
            "waf": "Security"
        },
        {
            "category": "Identity and Access",
            "checklist": "SAP Checklist",
            "guid": "e4e48226-ce54-44b6-bb6b-bfa15bd8f753",
            "link": "https://github.com/azuredevcollege/SAP/blob/master/sap-oauth-saml-flow/README.md",
            "service": "SAP",
            "services": [
                "SAP",
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Identity",
            "text": "For applications that access SAP, you might want to use principal propagation to establish SSO.",
            "waf": "Security"
        },
        {
            "category": "Identity and Access",
            "checklist": "SAP Checklist",
            "guid": "59921095-4980-4fc1-a5b6-524a5a560c79",
            "link": "https://learn.microsoft.com/azure/active-directory/saas-apps/sap-hana-cloud-platform-identity-authentication-tutorial",
            "service": "SAP",
            "services": [
                "SAP",
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Identity",
            "text": "If you're using SAP BTP services or SaaS solutions that require SAP Identity Authentication Service (IAS), consider implementing SSO between SAP Cloud Identity Authentication Services and Azure AD to access those SAP services. This integration lets SAP IAS act as a proxy identity provider and forwards authentication requests to Azure AD as the central user store and identity provider.",
            "waf": "Security"
        },
        {
            "category": "Identity and Access",
            "checklist": "SAP Checklist",
            "guid": "a709c664-317e-41e4-9e34-67d9016a86f4",
            "link": "https://learn.microsoft.com/azure/active-directory/saas-apps/sap-hana-cloud-platform-tutorial",
            "service": "SAP",
            "services": [
                "SAP",
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Identity",
            "text": "Implement SSO to SAP BTP",
            "waf": "Security"
        },
        {
            "category": "Identity and Access",
            "checklist": "SAP Checklist",
            "guid": "01f11b7f-38df-4251-9c76-4dec19abd3e8",
            "link": "https://learn.microsoft.com/azure/active-directory/saas-apps/sap-successfactors-inbound-provisioning-cloud-only-tutorial",
            "service": "SAP",
            "services": [
                "SAP",
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Identity",
            "text": "If you're using SAP SuccessFactors, consider using the Azure AD automated user provisioning. With this integration, as you add new employees to SAP SuccessFactors, you can automatically create their user accounts in Azure AD. Optionally, you can create user accounts in Microsoft 365 or other SaaS applications that are supported by Azure AD. Use write-back of the email address to SAP SuccessFactors.",
            "waf": "Security"
        },
        {
            "category": "Management Group and Subscriptions",
            "checklist": "SAP Checklist",
            "guid": "6ba28021-4591-4147-9e39-e5309cccd979",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/resource-org-management-groups",
            "service": "SAP",
            "services": [
                "AzurePolicy",
                "SAP",
                "Subscriptions"
            ],
            "severity": "Medium",
            "subcategory": "Subscriptions",
            "text": "enforce existing Management Group policies to SAP Subscriptions",
            "training": "https://learn.microsoft.com/training/modules/enterprise-scale-organization/4-management-group-subscription-organization",
            "waf": "Operations"
        },
        {
            "category": "Management Group and Subscriptions",
            "checklist": "SAP Checklist",
            "guid": "366bcda2-750a-4b1a-a039-d95d54c7c892",
            "link": "https://learn.microsoft.com/azure/architecture/guide/sap/sap-whole-landscape",
            "service": "SAP",
            "services": [
                "SAP",
                "Subscriptions"
            ],
            "severity": "High",
            "subcategory": "Subscriptions",
            "text": "Integrate tightly coupled applications into the same SAP subscription to avoid additional routing and management complexity",
            "training": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/resource-org-subscriptions",
            "waf": "Operations"
        },
        {
            "category": "Management Group and Subscriptions",
            "checklist": "SAP Checklist",
            "guid": "9cb107d5-325a-4e52-9ba3-4d4685e2213a",
            "link": "https://learn.microsoft.com/azure/architecture/guide/sap/sap-whole-landscape",
            "service": "SAP",
            "services": [
                "SAP",
                "Subscriptions"
            ],
            "severity": "High",
            "subcategory": "Subscriptions",
            "text": "Leverage Subscription as scale unit and scaling our resources, consider deploying subscription per environment eg. Sandbox, non-prod, prod ",
            "training": "https://learn.microsoft.com/training/modules/configure-subscriptions/?source=recommendations",
            "waf": "Operations"
        },
        {
            "category": "Management Group and Subscriptions",
            "checklist": "SAP Checklist",
            "guid": "ce7bb122-f7c9-45f0-9e15-4e3aa3592829",
            "link": "https://learn.microsoft.com/azure/quotas/quotas-overview",
            "service": "SAP",
            "services": [
                "SAP",
                "Subscriptions",
                "VM"
            ],
            "severity": "High",
            "subcategory": "Subscriptions",
            "text": "Ensure quota increase as a part of subscription provisioning (e.g. total available VM cores within a subscription)",
            "training": "https://learn.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits",
            "waf": "Operations"
        },
        {
            "category": "Management Group and Subscriptions",
            "checklist": "SAP Checklist",
            "guid": "ce4fab2f-433a-4d59-a5a9-3d1032e03ebc",
            "link": "https://learn.microsoft.com/rest/api/reserved-vm-instances/quotaapi?branch=capacity",
            "service": "SAP",
            "services": [
                "SAP",
                "Subscriptions"
            ],
            "severity": "Low",
            "subcategory": "Subscriptions",
            "text": "The Quota API is a REST API that you can use to view and manage quotas for Azure services. Consider using it if necessary.",
            "waf": "Operations"
        },
        {
            "category": "Management Group and Subscriptions",
            "checklist": "SAP Checklist",
            "guid": "cbfad17b-f240-42bf-a1d8-f4f4cee661c8",
            "link": "https://learn.microsoft.com/azure/quotas/quickstart-increase-quota-portal",
            "service": "SAP",
            "services": [
                "SAP",
                "Subscriptions",
                "VM"
            ],
            "severity": "High",
            "subcategory": "Subscriptions",
            "text": "If deploying to an availability zone, ensure that the VM's zone deployment is available once the quota has been approved. Submit a support request with the subscription, VM series, number of CPUs and availability zone required.",
            "waf": "Operations"
        },
        {
            "category": "Management Group and Subscriptions",
            "checklist": "SAP Checklist",
            "guid": "e6e20617-3686-4af4-9791-f8935ada4332",
            "link": "https://azure.microsoft.com/explore/global-infrastructure/products-by-region/",
            "service": "SAP",
            "services": [
                "SAP",
                "Subscriptions"
            ],
            "severity": "High",
            "subcategory": "Subscriptions",
            "text": "Ensure required services and features are available within the chosen deployment regions eg. ANF , Zone etc.",
            "training": "https://learn.microsoft.com/azure/cloud-adoption-framework/migrate/azure-best-practices/multiple-regions?source=recommendations",
            "waf": "Operations"
        },
        {
            "category": "Management Group and Subscriptions",
            "checklist": "SAP Checklist",
            "guid": "4e138115-2318-41aa-9174-26943ff8ae7d",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/sap/eslz-resource-organization",
            "service": "SAP",
            "services": [
                "SAP",
                "Subscriptions",
                "TrafficManager",
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Subscriptions",
            "text": "Leverage Azure resource tag for cost categorization and resource grouping (: BillTo, Department (or Business Unit), Environment (Production, Stage, Development), Tier (Web Tier, Application Tier), Application Owner, ProjectName)",
            "training": "https://learn.microsoft.com/training/paths/implement-resource-mgmt-security/",
            "waf": "Operations"
        },
        {
            "category": "Management and Monitoring",
            "checklist": "SAP Checklist",
            "guid": "2f7c95f0-6e15-44e3-aa35-92829e6e2061",
            "link": "https://learn.microsoft.com/azure/backup/sap-hana-database-about",
            "service": "SAP",
            "services": [
                "SAP",
                "Monitor",
                "Backup"
            ],
            "severity": "High",
            "subcategory": "BCDR",
            "text": "Help protect your HANA database by using the Azure Backup service.",
            "training": "https://learn.microsoft.com/training/modules/implement-azure-backup-sap-workloads-azure-virtual-machines/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "category": "Management and Monitoring",
            "checklist": "SAP Checklist",
            "guid": "302a2fbf-3745-4a5f-a365-c9d1a16ca22c",
            "link": "https://learn.microsoft.com/azure/azure-netapp-files/azacsnap-introduction",
            "service": "SAP",
            "services": [
                "SAP",
                "Entra",
                "Monitor",
                "VM",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "BCDR",
            "text": "If you deploy Azure NetApp Files for your HANA, Oracle, or DB2 database, use the Azure Application Consistent Snapshot tool (AzAcSnap) to take application-consistent snapshots. AzAcSnap also supports Oracle databases. Consider using AzAcSnap on a central VM rather than on individual VMs.",
            "waf": "Reliability"
        },
        {
            "category": "Management and Monitoring",
            "checklist": "SAP Checklist",
            "guid": "42d37218-a3a7-45df-bff6-1173e7f249ea",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/sap/eslz-management-and-monitoring",
            "service": "SAP",
            "services": [
                "SAP",
                "Monitor"
            ],
            "severity": "High",
            "subcategory": "Management",
            "text": "Ensure time-zone matches between the operating system and the SAP system.",
            "waf": "Operations"
        },
        {
            "category": "Management and Monitoring",
            "checklist": "SAP Checklist",
            "guid": "c3c7abc0-716c-4486-893c-40e181d65539",
            "link": "https://learn.microsoft.com/azure/sap/workloads/high-availability-guide-rhel-multi-sid",
            "service": "SAP",
            "services": [
                "SAP",
                "Monitor",
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Management",
            "text": "Don't group different application services in the same cluster. For example, don't combine DRBD and central services clusters on the same cluster. However, you can use the same Pacemaker cluster to manage approximately five different central services (multi-SID cluster).",
            "training": "https://learn.microsoft.com/training/modules/implement-ha-sap-netweaver-anydb/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "category": "Management and Monitoring",
            "checklist": "SAP Checklist",
            "guid": "a491dfc4-9353-4213-9217-eef0949f9467",
            "link": "https://azure.microsoft.com/pricing/offers/dev-test/",
            "service": "SAP",
            "services": [
                "SAP",
                "Monitor",
                "Cost"
            ],
            "severity": "Low",
            "subcategory": "Management",
            "text": "Consider running dev/test systems in a snooze model to save and optimize Azure run costs.",
            "waf": "Cost"
        },
        {
            "category": "Management and Monitoring",
            "checklist": "SAP Checklist",
            "guid": "b7056168-6199-4732-a514-cdbb2d5c9c54",
            "link": "https://learn.microsoft.com/azure/lighthouse/overview",
            "service": "SAP",
            "services": [
                "SAP",
                "Monitor",
                "Entra"
            ],
            "severity": "Medium",
            "subcategory": "Management",
            "text": "If you partner with customers by managing their SAP estates, consider Azure Lighthouse. Azure Lighthouse allows managed service providers to use Azure native identity services to authenticate to the customers' environment. It puts the control in the hands of customers, because they can revoke access at any time and audit service providers' actions.",
            "waf": "Operations"
        },
        {
            "category": "Management and Monitoring",
            "checklist": "SAP Checklist",
            "guid": "4d116785-d2fa-456c-96ad-48408fe72734",
            "link": "https://learn.microsoft.com/azure/update-manager/scheduled-patching?tabs=schedule-updates-single-machine%2Cschedule-updates-scale-overview",
            "service": "SAP",
            "services": [
                "SAP",
                "Monitor",
                "VM"
            ],
            "severity": "Medium",
            "subcategory": "Management",
            "text": "Use Azure Update Manager to check the status of available updates for a single VM or multiple VMs and consider scheduling regular patching.",
            "training": "https://learn.microsoft.com/training/modules/keep-your-virtual-machines-updated/?source=recommendations",
            "waf": "Operations"
        },
        {
            "category": "Management and Monitoring",
            "checklist": "SAP Checklist",
            "guid": "76c8bcbf-45bb-4e60-ad8a-03e97778424d",
            "link": "https://learn.microsoft.com/azure/sap/workloads/lama-installation",
            "service": "SAP",
            "services": [
                "SAP",
                "Monitor"
            ],
            "severity": "Low",
            "subcategory": "Management",
            "text": "Optimize and manage SAP Basis operations by using SAP Landscape Management (LaMa). Use the SAP LaMa connector for Azure to relocate, copy, clone, and refresh SAP systems.",
            "training": "https://learn.microsoft.com/training/modules/explore-azure-remote-management/?source=recommendations",
            "waf": "Operations"
        },
        {
            "category": "Management and Monitoring",
            "checklist": "SAP Checklist",
            "guid": "14591147-5e39-4e53-89cc-cd979366bcda",
            "link": "https://learn.microsoft.com/azure/sap/monitor/about-azure-monitor-sap-solutions",
            "service": "SAP",
            "services": [
                "SAP",
                "Monitor",
                "SQL"
            ],
            "severity": "Medium",
            "subcategory": "Monitoring",
            "text": "Use Azure Monitor for SAP solutions to monitor your SAP workloads(SAP HANA, high-availability SUSE clusters, and SQL systems) on Azure. Consider supplementing Azure Monitor for SAP solutions with SAP Solution Manager.",
            "training": "https://learn.microsoft.com/training/modules/implement-azure-monitoring-sap-workloads-azure-virtual-machines/?source=recommendations",
            "waf": "Operations"
        },
        {
            "category": "Management and Monitoring",
            "checklist": "SAP Checklist",
            "guid": "2750ab1a-b039-4d95-b54c-7c8929cb107d",
            "link": "https://learn.microsoft.com/azure/sap/workloads/vm-extension-for-sap",
            "service": "SAP",
            "services": [
                "SAP",
                "Monitor",
                "VM",
                "Entra"
            ],
            "severity": "High",
            "subcategory": "Monitoring",
            "text": "Run a VM Extension for SAP check. VM Extension for SAP uses the assigned managed identity of a virtual machine (VM) to access VM monitoring and configuration data. The check ensures that all performance metrics in your SAP application come from the underlying Azure Extension for SAP.",
            "training": "https://learn.microsoft.com/training/modules/configure-azure-enhanced-monitoring-extension-for-sap/?source=recommendations",
            "waf": "Operations"
        },
        {
            "category": "Management and Monitoring",
            "checklist": "SAP Checklist",
            "guid": "5325ae52-5ba3-44d4-985e-2213ace7bb12",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/design-logs-deployment",
            "service": "SAP",
            "services": [
                "AzurePolicy",
                "SAP",
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Monitoring",
            "text": "Use Azure Policy for access control and compliance reporting. Azure Policy provides the ability to enforce organization-wide settings to ensure consistent policy adherence and fast violation detection. ",
            "training": "https://learn.microsoft.com/learn/paths/architect-infrastructure-operations/",
            "waf": "Operations"
        },
        {
            "category": "Management and Monitoring",
            "checklist": "SAP Checklist",
            "guid": "523181aa-4174-4269-93ff-8ae7d7d47431",
            "link": "https://learn.microsoft.com/azure/network-watcher/connection-monitor-overview",
            "service": "SAP",
            "services": [
                "SAP",
                "NetworkWatcher",
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Monitoring",
            "text": "Use Connection Monitor in Azure Network Watcher to monitor latency metrics for SAP databases and application servers. Or collect and display network latency measurements by using Azure Monitor.",
            "training": "https://techcommunity.microsoft.com/t5/running-sap-applications-on-the/collecting-and-displaying-niping-network-latency-measurements/ba-p/1833979",
            "waf": "Operations"
        },
        {
            "category": "Management and Monitoring",
            "checklist": "SAP Checklist",
            "guid": "73686af4-6791-4f89-95ad-a43324e13811",
            "link": "https://github.com/Azure/SAP-on-Azure-Scripts-and-Utilities/tree/main/QualityCheck",
            "service": "SAP",
            "services": [
                "SAP",
                "Monitor",
                "VM"
            ],
            "severity": "Medium",
            "subcategory": "Monitoring",
            "text": "Perform a quality check for SAP HANA on the provisioned Azure infrastructure to verify that provisioned VMs comply with SAP HANA on Azure best practices.",
            "waf": "Operations"
        },
        {
            "category": "Management and Monitoring",
            "checklist": "SAP Checklist",
            "guid": "616785d6-fa96-4c96-ad88-518f482734c8",
            "link": "https://learn.microsoft.com/azure/sap/workloads/high-availability-zones",
            "service": "SAP",
            "services": [
                "SAP",
                "Subscriptions",
                "Monitor"
            ],
            "severity": "High",
            "subcategory": "Monitoring",
            "text": "For each Azure subscription, run a latency test on Azure availability zones before zonal deployment to choose low-latency zones for deployment of SAP on Azure.",
            "training": "https://github.com/Azure/SAP-on-Azure-Scripts-and-Utilities/tree/main/AvZone-Latency-Test",
            "waf": "Performance"
        },
        {
            "category": "Management and Monitoring",
            "checklist": "SAP Checklist",
            "guid": "410adcba-db46-424f-a6c4-05ecde75c52e",
            "link": "https://learn.microsoft.com/azure/advisor/advisor-how-to-improve-reliability",
            "service": "SAP",
            "services": [
                "SAP",
                "Monitor",
                "Storage",
                "ASR"
            ],
            "severity": "Medium",
            "subcategory": "Monitoring",
            "text": "Run the Resiliency Report to ensure that the configuration of the entire provisioned Azure infrastructure (Compute, Database, Networking, Storage, Site Recovery) complies with the configuration defined by Cloud Adaption Framework for Azure.",
            "training": "https://learn.microsoft.com/training/paths/azure-well-architected-framework/",
            "waf": "Reliability"
        },
        {
            "category": "Management and Monitoring",
            "checklist": "SAP Checklist",
            "guid": "86ba2802-1459-4114-95e3-9e5309cccd97",
            "link": "https://learn.microsoft.com/azure/sentinel/sap/deployment-overview",
            "service": "SAP",
            "services": [
                "SAP",
                "Sentinel",
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Monitoring",
            "text": "Implement threat protection by using the Microsoft Sentinel solution for SAP. Use this solution to monitor your SAP systems and detect sophisticated threats throughout the business logic and application layers.",
            "training": "https://learn.microsoft.com/training/modules/plan-microsoft-sentinel-deployment-sap/?source=recommendations",
            "waf": "Security"
        },
        {
            "category": "Management and Monitoring",
            "checklist": "SAP Checklist",
            "guid": "579266bc-ca27-45fa-a1ab-fe9d55d04c3c",
            "link": "https://learn.microsoft.com/azure/cost-management-billing/costs/enable-tag-inheritance",
            "service": "SAP",
            "services": [
                "SAP",
                "Monitor",
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Monitoring",
            "text": "Azure tagging can be leveraged to logically group and track resources, automate their deployments, and most importantly, provide visibility on the incurred costs.",
            "training": "https://learn.microsoft.com/training/modules/analyze-costs-create-budgets-azure-cost-management/?source=recommendations",
            "waf": "Operations"
        },
        {
            "category": "Management and Monitoring",
            "checklist": "SAP Checklist",
            "guid": "04b8e5e5-13cb-4b22-af62-5a8ecfcf0337",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-network-test-latency?tabs=windows",
            "service": "SAP",
            "services": [
                "SAP",
                "Monitor",
                "VM"
            ],
            "severity": "Low",
            "subcategory": "Performance",
            "text": "Use inter-VM latency monitoring for latency-sensitive applications.",
            "waf": "Performance"
        },
        {
            "category": "Management and Monitoring",
            "checklist": "SAP Checklist",
            "guid": "07e5ed53-3d96-43d8-87ea-631b77da5aba",
            "link": "https://learn.microsoft.com/azure/sap/workloads/planning-guide-storage",
            "service": "SAP",
            "services": [
                "SAP",
                "Monitor",
                "ASR"
            ],
            "severity": "Medium",
            "subcategory": "Performance",
            "text": "Use Azure Site Recovery monitoring to maintain the health of the disaster recovery service for SAP application servers.",
            "training": "https://learn.microsoft.com/training/modules/explore-azure-storage/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "category": "Management and Monitoring",
            "checklist": "SAP Checklist",
            "guid": "abb6af9c-982c-4cf1-83fb-329fafd1ee56",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/sap/eslz-management-and-monitoring",
            "service": "SAP",
            "services": [
                "SAP",
                "Monitor",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Performance",
            "text": "Exclude all the database file systems and executable programs from antivirus scans. Including them could lead to performance problems. Check with the database vendors for prescriptive details on the exclusion list. For example, Oracle recommends excluding /oracle/<sid>/sapdata from antivirus scans.",
            "waf": "Performance"
        },
        {
            "category": "Management and Monitoring",
            "checklist": "SAP Checklist",
            "guid": "c027f893-f404-41a9-b33d-39d625a14964",
            "link": "https://sapit-forme-prod.authentication.eu11.hana.ondemand.com/login",
            "service": "SAP",
            "services": [
                "SAP",
                "Monitor"
            ],
            "severity": "Low",
            "subcategory": "Performance",
            "text": "Consider collecting full database statistics for non-HANA databases after migration. For example, implement SAP note 1020260 - Delivery of Oracle statistics.",
            "waf": "Performance"
        },
        {
            "category": "Management and Monitoring",
            "checklist": "SAP Checklist",
            "guid": "fdafb1f5-3eee-4354-a8c9-deb8127ebc2e",
            "link": "https://learn.microsoft.com/azure/virtual-machines/workloads/oracle/configure-oracle-asm",
            "service": "SAP",
            "services": [
                "SAP",
                "Monitor",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Performance",
            "text": "Consider using Oracle Automatic Storage Management (ASM) for all Oracle deployments that use SAP on Azure.",
            "training": "https://learn.microsoft.com/training/paths/administer-infrastructure-resources-in-azure/?source=recommendations",
            "waf": "Performance"
        },
        {
            "category": "Management and Monitoring",
            "checklist": "SAP Checklist",
            "guid": "33c5d5bf-daf3-4f0d-bd50-6010fdcec22e",
            "link": "https://techcommunity.microsoft.com/t5/running-sap-applications-on-the/announcement-sap-on-azure-oracle-performance-efficiency-scripts/ba-p/3725178",
            "service": "SAP",
            "services": [
                "SAP",
                "Monitor",
                "SQL"
            ],
            "severity": "Medium",
            "subcategory": "Performance",
            "text": "For SAP on Azure running Oracle, a collection of SQL scripts can help you diagnose performance problems.  Automatic Workload Repository (AWR) reports contain valuable information for diagnosing problems in the Oracle system. We recommend that you run an AWR report during several sessions and choose peak times for it, to ensure broad coverage for the analysis.",
            "training": "https://learn.microsoft.com/ja-jp/azure/well-architected/oracle-iaas/performance-efficiency",
            "waf": "Performance"
        },
        {
            "category": "Management and Monitoring",
            "checklist": "SAP Checklist",
            "guid": "d89fd98d-23e4-4b40-a92e-32db9365522c",
            "link": "https://learn.microsoft.com/azure/site-recovery/site-recovery-monitor-and-troubleshoot",
            "service": "SAP",
            "services": [
                "SAP",
                "Monitor",
                "ASR"
            ],
            "severity": "High",
            "subcategory": "Reliability",
            "text": "Use Azure Site Recovery monitoring to maintain the health of the disaster recovery service for SAP application servers.",
            "training": "https://learn.microsoft.com/training/modules/protect-on-premises-infrastructure-with-azure-site-recovery/?source=recommendations",
            "waf": "Operations"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "SAP Checklist",
            "guid": "5ba34d46-85e2-4213-ace7-bb122f7c95f0",
            "link": "https://learn.microsoft.com/azure/ddos-protection/ddos-protection-overview",
            "service": "SAP",
            "services": [
                "AzurePolicy",
                "SAP",
                "AppGW",
                "WAF"
            ],
            "severity": "Medium",
            "subcategory": "App delivery",
            "text": "For secure delivery of HTTP/S apps, use Application Gateway v2 and ensure that WAF protection and policies are enabled.",
            "training": "https://learn.microsoft.com/training/modules/introduction-azure-web-application-firewall/",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "SAP Checklist",
            "guid": "fa9d30bc-1b82-4e4b-bfdf-6b017938b9e6",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/sap/eslz-network-topology-and-connectivity",
            "service": "SAP",
            "services": [
                "DNS",
                "SAP",
                "VM"
            ],
            "severity": "Medium",
            "subcategory": "DNS",
            "text": "If the virtual machine's DNS or virtual name is not changed during migration to Azure, Background DNS and virtual names connect many system interfaces in the SAP landscape, and customers are only sometimes aware of the interfaces that developers define over time. Connection challenges arise between various systems when virtual or DNS names change after migrations, and it's recommended to retain DNS aliases to prevent these types of difficulties.",
            "training": "https://learn.microsoft.com/training/modules/explore-azure-networking/4-explore-name-resolution",
            "waf": "Operations"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "SAP Checklist",
            "guid": "a2858f78-105b-4f52-b7a9-5b0f4439743b",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/sap/eslz-network-topology-and-connectivity",
            "service": "SAP",
            "services": [
                "DNS",
                "SAP",
                "VNet"
            ],
            "severity": "Medium",
            "subcategory": "DNS",
            "text": "Use different DNS zones to distinguish each environment (sandbox, development, preproduction, and production) from each other. The exception is for SAP deployments with their own VNet; here, private DNS zones might not be necessary.",
            "training": "https://learn.microsoft.com/training/modules/explore-azure-networking/4-explore-name-resolution",
            "waf": "Operations"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "SAP Checklist",
            "guid": "a3592829-e6e2-4061-9368-6af46791f893",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-network-peering-overview",
            "service": "SAP",
            "services": [
                "VNet",
                "SAP",
                "ACR"
            ],
            "severity": "Medium",
            "subcategory": "Hybrid",
            "text": "Local and global VNet peering provide connectivity and are the preferred approaches to ensure connectivity between landing zones for SAP deployments across multiple Azure regions",
            "training": "https://learn.microsoft.com/training/modules/configure-vnet-peering/?source=recommendations",
            "waf": "Reliability"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "SAP Checklist",
            "guid": "41742694-3ff8-4ae7-b7d4-743176c8bcbf",
            "link": "https://learn.microsoft.com/azure/sap/workloads/planning-guide",
            "service": "SAP",
            "services": [
                "SAP",
                "NVA"
            ],
            "severity": "High",
            "subcategory": "Hybrid",
            "text": "It is not supported to deploy any NVA between SAP application and SAP Database server",
            "training": "https://me.sap.com/notes/2731110",
            "waf": "Performance"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "SAP Checklist",
            "guid": "7d4bc7d2-c34a-452e-8f1d-6ae3c8eafcc3",
            "link": "https://learn.microsoft.com/training/modules/introduction-azure-virtual-wan/?source=recommendations",
            "service": "SAP",
            "services": [
                "VWAN",
                "SAP",
                "ACR"
            ],
            "severity": "Medium",
            "subcategory": "Hybrid",
            "text": "Use Virtual WAN for Azure deployments in new, large, or global networks where you need global transit connectivity across Azure regions and on-premises locations. With this approach, you won't need to manually set up transitive routing for Azure networking, and you can follow a standard for SAP on Azure deployments.",
            "training": "https://learn.microsoft.com/azure/virtual-wan/virtual-wan-about",
            "waf": "Operations"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "SAP Checklist",
            "guid": "0cedb1f6-ae6c-492b-8b17-8061f50b16d3",
            "link": "https://learn.microsoft.com/azure/well-architected/services/networking/network-virtual-appliances/reliability",
            "service": "SAP",
            "services": [
                "VNet",
                "SAP",
                "NVA"
            ],
            "severity": "Medium",
            "subcategory": "Hybrid",
            "text": "Consider deploying network virtual appliances (NVAs) between regions only if partner NVAs are used. NVAs between regions or VNets aren't required if native NVAs are present. When you're deploying partner networking technologies and NVAs, follow the vendor's guidance to verify conflicting configurations with Azure networking.",
            "training": "https://learn.microsoft.com/training/modules/control-network-traffic-flow-with-routes/?source=recommendations",
            "waf": "Operations"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "SAP Checklist",
            "guid": "facc08c6-ea95-4641-91cd-fa09e573adbd",
            "link": "https://learn.microsoft.com/azure/architecture/networking/hub-spoke-vwan-architecture",
            "service": "SAP",
            "services": [
                "VNet",
                "SAP",
                "NVA",
                "VWAN"
            ],
            "severity": "Medium",
            "subcategory": "Hybrid",
            "text": "Virtual WAN manages connectivity between spoke VNets for virtual-WAN-based topologies (no need to set up user-defined routing [UDR] or NVAs), and maximum network throughput for VNet-to-VNet traffic in the same virtual hub is 50 gigabits per second. If necessary, SAP landing zones can use VNet peering to connect to other landing zones and overcome this bandwidth limitation.",
            "training": "https://learn.microsoft.com/training/modules/hub-and-spoke-network-architecture/?source=recommendations",
            "waf": "Operations"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "SAP Checklist",
            "guid": "82734c88-6ba2-4802-8459-11475e39e530",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-ip-addressing",
            "service": "SAP",
            "services": [
                "VNet",
                "SAP",
                "VM"
            ],
            "severity": "High",
            "subcategory": "IP plan",
            "text": "Public IP assignment to VM running SAP Workload is not recommended.",
            "training": "https://learn.microsoft.com/training/modules/design-ip-addressing-for-azure/?source=recommendations",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "SAP Checklist",
            "guid": "9cccd979-366b-4cda-8750-ab1ab039d95d",
            "link": "https://learn.microsoft.com/training/modules/protect-on-premises-infrastructure-with-azure-site-recovery/?source=recommendations",
            "service": "SAP",
            "services": [
                "VNet",
                "SAP",
                "ASR"
            ],
            "severity": "High",
            "subcategory": "IP plan",
            "text": "Consider reserving IP address on DR side when configuring ASR",
            "training": "https://learn.microsoft.com/learn/paths/architect-network-infrastructure/",
            "waf": "Operations"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "SAP Checklist",
            "guid": "54c7c892-9cb1-407d-9325-ae525ba34d46",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-ip-addressing",
            "service": "SAP",
            "services": [
                "VNet",
                "SAP"
            ],
            "severity": "High",
            "subcategory": "IP plan",
            "text": "Avoid using overlapping IP address ranges for production and DR sites.",
            "training": "https://learn.microsoft.com/training/modules/design-ip-addressing-for-azure/?source=recommendations",
            "waf": "Operations"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "SAP Checklist",
            "guid": "6e154e3a-a359-4282-ae6e-206173686af4",
            "link": "https://learn.microsoft.com/azure/azure-netapp-files/azure-netapp-files-delegate-subnet",
            "service": "SAP",
            "services": [
                "VNet",
                "SAP",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "IP plan",
            "text": "While Azure does help you to create multiple delegated subnets in a VNet, only one delegated subnet can exist in a VNet for Azure NetApp Files. Attempts to create a new volume will fail if you use more than one delegated subnet for Azure NetApp Files.",
            "training": "https://learn.microsoft.com/azure/azure-netapp-files/azure-netapp-files-network-topologies?source=recommendations",
            "waf": "Operations"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "SAP Checklist",
            "guid": "d8a03e97-7784-424d-9167-85d6fa96c96a",
            "link": "https://learn.microsoft.com/azure/well-architected/services/networking/azure-firewall?toc=%2Fazure%2Ffirewall%2Ftoc.json&bc=%2Fazure%2Ffirewall%2Fbreadcrumb%2Ftoc.json",
            "service": "SAP",
            "services": [
                "SAP",
                "Firewall"
            ],
            "severity": "Medium",
            "subcategory": "Internet",
            "text": "Use Azure Firewall to govern Azure outbound traffic to the internet, non-HTTP/S inbound connections, and East/West traffic filtering (if the organization requires it)",
            "training": "https://learn.microsoft.com/training/paths/secure-networking-infrastructure/",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "SAP Checklist",
            "guid": "91a65e40-be90-45b3-9f73-f3edbf8dc324",
            "link": "https://learn.microsoft.com/azure/sap/workloads/expose-sap-process-orchestration-on-azure",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP",
                "AppGW"
            ],
            "severity": "Medium",
            "subcategory": "Internet",
            "text": "Application Gateway and Web Application Firewall have limitations when Application Gateway serves as a reverse proxy for SAP web apps, as shown in the comparison between Application Gateway, SAP Web Dispatcher, and other third-party services.",
            "training": "https://help.sap.com/docs/SUPPORT_CONTENT/si/3362959506.html",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "SAP Checklist",
            "guid": "5e39e530-9ccc-4d97-a366-bcda2750ab1a",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "service": "SAP",
            "services": [
                "WAF",
                "FrontDoor",
                "SAP",
                "AzurePolicy",
                "ACR"
            ],
            "severity": "Medium",
            "subcategory": "Internet",
            "text": "Use Azure Front Door and WAF policies to provide global protection across Azure regions for inbound HTTP/S connections to a landing zone.",
            "training": "https://learn.microsoft.com/training/paths/secure-application-delivery/",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "SAP Checklist",
            "guid": "b039d95d-54c7-4c89-89cb-107d5325ae52",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/afds-overview",
            "service": "SAP",
            "services": [
                "WAF",
                "FrontDoor",
                "SAP",
                "AzurePolicy",
                "AppGW"
            ],
            "severity": "Medium",
            "subcategory": "Internet",
            "text": "Take advantage of Web Application Firewall policies in Azure Front Door when you're using Azure Front Door and Application Gateway to protect HTTP/S applications. Lock down Application Gateway to receive traffic only from Azure Front Door.",
            "training": "https://learn.microsoft.com/training/modules/introduction-azure-web-application-firewall/?source=recommendations",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "SAP Checklist",
            "guid": "5ada4332-4e13-4811-9231-81aa41742694",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP",
                "AppGW",
                "LoadBalancer"
            ],
            "severity": "Medium",
            "subcategory": "Internet",
            "text": "Use a web application firewall to scan your traffic when it's exposed to the internet. Another option is to use it with your load balancer or with resources that have built-in firewall capabilities like Application Gateway or third-party solutions.",
            "training": "https://learn.microsoft.com/training/modules/introduction-azure-web-application-firewall/?source=recommendations",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "SAP Checklist",
            "guid": "e73de7d5-6f36-4217-a526-e1a621ecddde",
            "link": "https://learn.microsoft.com/azure/frontdoor/front-door-overview",
            "service": "SAP",
            "services": [
                "VWAN",
                "SAP",
                "ACR"
            ],
            "severity": "Medium",
            "subcategory": "Internet",
            "text": "Use Virtual WAN for Azure deployments in new, large, or global networks where you need global transit connectivity across Azure regions and on-premises locations. With this approach, you won't need to manually set up transitive routing for Azure networking, and you can follow a standard for SAP on Azure deployments.",
            "training": "https://learn.microsoft.com/training/modules/explore-azure-networking/10-explore-azure-front-door",
            "waf": "Performance"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "SAP Checklist",
            "guid": "3c536a3e-1b6b-4e87-95ca-15edb47251c0",
            "link": "https://learn.microsoft.com/azure/virtual-network/vnet-integration-for-azure-services",
            "service": "SAP",
            "services": [
                "SAP",
                "PrivateLink",
                "VNet",
                "ACR",
                "Backup",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Internet",
            "text": "To prevent data leakage, use Azure Private Link to securely access platform as a service resources like Azure Blob Storage, Azure Files, Azure Data Lake Storage Gen2, Azure Data Factory, and more. Azure Private Endpoint can also help to secure traffic between VNets and services like Azure Storage, Azure Backup, and more. Traffic between your VNet and the Private Endpoint enabled service travels across the Microsoft global network, which prevents its exposure to the public internet.",
            "training": "https://learn.microsoft.com/training/modules/design-implement-private-access-to-azure-services/?source=recommendations",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "SAP Checklist",
            "guid": "85e2213a-ce7b-4b12-8f7c-95f06e154e3a",
            "link": "https://learn.microsoft.com/azure/virtual-network/accelerated-networking-overview?tabs=redhat",
            "service": "SAP",
            "services": [
                "SAP",
                "VM"
            ],
            "severity": "High",
            "subcategory": "Segmentation",
            "text": "Make sure that Azure accelerated networking is enabled on the VMs used in the SAP application and DBMS layers.",
            "training": "https://learn.microsoft.com/training/paths/azure-fundamentals-describe-azure-architecture-services/?source=recommendations",
            "waf": "Performance"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "SAP Checklist",
            "guid": "3ff8ae7d-7d47-4431-96c8-bcbf45bbe609",
            "link": "https://learn.microsoft.com/azure/load-balancer/load-balancer-multivip-overview",
            "service": "SAP",
            "services": [
                "SAP",
                "LoadBalancer"
            ],
            "severity": "Medium",
            "subcategory": "Segmentation",
            "text": "Make sure that internal deployments for Azure Load Balancer are set up to use Direct Server Return (DSR). This setting (Enabling Floating IP) will reduce latency when internal load balancer configurations are used for high-availability configurations on the DBMS layer.",
            "training": "https://learn.microsoft.com/ja-jp/training/modules/load-balancing-non-https-traffic-azure/?source=recommendations",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "SAP Checklist",
            "guid": "6791f893-5ada-4433-84e1-3811523181aa",
            "link": "https://learn.microsoft.com/azure/virtual-network/network-security-group-how-it-works",
            "service": "SAP",
            "services": [
                "VNet",
                "SAP",
                "VM"
            ],
            "severity": "Medium",
            "subcategory": "Segmentation",
            "text": "You can use application security group (ASG) and NSG rules to define network security access-control lists between the SAP application and DBMS layers. ASGs group virtual machines to help manage their security.",
            "training": "https://learn.microsoft.com/training/modules/configure-network-security-groups/?source=recommendations",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "SAP Checklist",
            "guid": "45bbe609-d8a0-43e9-9778-424d616785d6",
            "link": "https://me.sap.com/notes/2015553",
            "service": "SAP",
            "services": [
                "VNet",
                "SAP"
            ],
            "severity": "High",
            "subcategory": "Segmentation",
            "text": "Placing of the SAP application layer and SAP DBMS in different Azure VNets that aren't peered isn't supported.",
            "training": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/sap/eslz-network-topology-and-connectivity",
            "waf": "Performance"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "SAP Checklist",
            "guid": "fa96c96a-d885-418f-9827-34c886ba2802",
            "link": "https://learn.microsoft.com/azure/sap/workloads/proximity-placement-scenarios",
            "service": "SAP",
            "services": [
                "SAP"
            ],
            "severity": "Medium",
            "subcategory": "Segmentation",
            "text": "For optimal network latency with SAP applications, consider using Azure proximity placement groups.",
            "training": "https://learn.microsoft.com/azure/virtual-machines/co-location#planned-maintenance-and-proximity-placement-groups",
            "waf": "Performance"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "SAP Checklist",
            "guid": "18c8b61c-855a-4405-b6ed-266455e4f4ce",
            "link": "https://me.sap.com/notes/2015553",
            "service": "SAP",
            "services": [
                "SAP"
            ],
            "severity": "High",
            "subcategory": "Segmentation",
            "text": "It is NOT supported at all to run an SAP Application Server layer and DBMS layer split between on-premise and Azure. Both layers need to completely reside either on-premise or in Azure.",
            "training": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/sap/eslz-network-topology-and-connectivity",
            "waf": "Performance"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "SAP Checklist",
            "guid": "b65c878b-4b14-4f4e-92d8-d873936493f2",
            "link": "https://me.sap.com/notes/2015553",
            "service": "SAP",
            "services": [
                "VNet",
                "SAP",
                "Cost"
            ],
            "severity": "High",
            "subcategory": "Segmentation",
            "text": "It isn't recommended to host the database management system (DBMS) and application layers of SAP systems in different VNets and connect them with VNet peering because of the substantial costs that excessive network traffic between the layers can produce. Recommend using subnets within the Azure virtual network to separate the SAP application layer and DBMS layer.",
            "training": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/sap/eslz-network-topology-and-connectivity",
            "waf": "Cost"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "SAP Checklist",
            "guid": "402a9846-d515-4061-aff8-cd30088693fa",
            "link": "https://learn.microsoft.com/azure/sap/workloads/high-availability-guide-rhel",
            "service": "SAP",
            "services": [
                "SAP",
                "LoadBalancer"
            ],
            "severity": "High",
            "subcategory": "Segmentation",
            "text": "If using Load Balancer with Linux guest operating systems, check that the Linux network parameter net.ipv4.tcp_timestamps is set to 0.",
            "training": "https://learn.microsoft.com/training/modules/implement-ha-sap-netweaver-anydb/?source=recommendations",
            "waf": "Performance"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "SAP Checklist",
            "guid": "87585797-5551-4d53-bb7d-a94ee415734d",
            "link": "https://learn.microsoft.com/azure/sap/workloads/rise-integration",
            "service": "SAP",
            "services": [
                "VNet",
                "SAP"
            ],
            "severity": "Medium",
            "subcategory": "Segmentation",
            "text": "For SAP RISE/ECS deployments, virtual peering is the preferred way to establish connectivity with customer's existing Azure environment. Both the SAP vnet and customer vnet(s) are protected with network security groups (NSG), enabling communication on SAP and database ports through the vnet peering",
            "waf": "Security"
        },
        {
            "category": "Operational Excellence",
            "checklist": "SAP Checklist",
            "guid": "ff5136bd-dcf1-4d2b-ae52-39333efdf45a",
            "link": "https://learn.microsoft.com/azure/backup/sap-hana-database-about",
            "service": "SAP",
            "services": [
                "SAP",
                "VM",
                "Backup"
            ],
            "severity": "High",
            "subcategory": "&nbsp",
            "text": "Review SAP HANA database backups for Azure VMs.",
            "waf": "Cost"
        },
        {
            "category": "Operational Excellence",
            "checklist": "SAP Checklist",
            "guid": "cafde29d-a0af-4bcd-87c0-0f299d63f0e8",
            "link": "https://learn.microsoft.com/azure/site-recovery/site-recovery-monitor-and-troubleshoot",
            "service": "SAP",
            "services": [
                "SAP",
                "Monitor",
                "ASR"
            ],
            "severity": "Medium",
            "subcategory": "&nbsp",
            "text": "Review Site Recovery built-in monitoring, where used for SAP.",
            "waf": "Cost"
        },
        {
            "category": "Operational Excellence",
            "checklist": "SAP Checklist",
            "guid": "82d7b8de-d3f1-44a0-830b-38e200e82acf",
            "link": "https://help.sap.com/docs/SAP_HANA_PLATFORM/c4d7c773af4a4e5dbebb6548d6e2d4f4/e3111d2ebb5710149510cc120646bf3f.html?locale=en-US",
            "service": "SAP",
            "services": [
                "SAP",
                "Monitor"
            ],
            "severity": "High",
            "subcategory": "&nbsp",
            "text": "Review the Monitoring the SAP HANA System Landscape guidance.",
            "waf": "Operations"
        },
        {
            "category": "Operational Excellence",
            "checklist": "SAP Checklist",
            "guid": "c823873a-2bec-4c2a-b684-a1ce8ae80efd",
            "link": "https://learn.microsoft.com/azure/virtual-machines/workloads/oracle/oracle-database-backup-strategies",
            "service": "SAP",
            "services": [
                "SAP",
                "VM",
                "Backup"
            ],
            "severity": "Medium",
            "subcategory": "&nbsp",
            "text": "Review Oracle Database in Azure Linux VM backup strategies.",
            "waf": "Operations"
        },
        {
            "category": "Operational Excellence",
            "checklist": "SAP Checklist",
            "guid": "2943b6d8-1d31-4e19-ade7-78e6b26d1962",
            "link": "https://learn.microsoft.com/sql/relational-databases/tutorial-use-azure-blob-storage-service-with-sql-server-2016?view=sql-server-ver16",
            "service": "SAP",
            "services": [
                "SAP",
                "Storage",
                "SQL"
            ],
            "severity": "Medium",
            "subcategory": "&nbsp",
            "text": "Review the use of Azure Blob Storage with SQL Server 2016.",
            "waf": "Operations"
        },
        {
            "category": "Operational Excellence",
            "checklist": "SAP Checklist",
            "guid": "b82e650f-676d-417d-994d-fc33ca54ec14",
            "link": "https://learn.microsoft.com/azure/azure-sql/virtual-machines/windows/automated-backup?view=azuresql",
            "service": "SAP",
            "services": [
                "SAP",
                "VM",
                "Backup"
            ],
            "severity": "Medium",
            "subcategory": "&nbsp",
            "text": "Review the use of Automated Backup v2 for Azure VMs.",
            "waf": "Operations"
        },
        {
            "category": "Operational Excellence",
            "checklist": "SAP Checklist",
            "guid": "347c2dcc-e6eb-4b04-80c5-628b171aa62d",
            "service": "SAP",
            "services": [
                "SAP"
            ],
            "severity": "High",
            "subcategory": "&nbsp",
            "text": "Enabling Write accelerator for M series when using premium disks(V1)",
            "waf": "Operations"
        },
        {
            "category": "Performant",
            "checklist": "SAP Checklist",
            "guid": "b96512cf-996f-4b17-b9b8-6b16db1a2a94",
            "link": "https://github.com/Azure/SAP-on-Azure-Scripts-and-Utilities/tree/main/AvZone-Latency-Test",
            "service": "SAP",
            "services": [
                "SAP"
            ],
            "severity": "Medium",
            "subcategory": "&nbsp",
            "text": "Test availability zone latency.",
            "waf": "Performance"
        },
        {
            "category": "Performant",
            "checklist": "SAP Checklist",
            "guid": "9fd7ffd4-da11-49f6-a374-8d03e94c511d",
            "link": "https://support.sap.com/en/offerings-programs/support-services/earlywatch-alert.html",
            "service": "SAP",
            "services": [
                "SAP"
            ],
            "severity": "Medium",
            "subcategory": "&nbsp",
            "text": "Activate SAP EarlyWatch Alert for all SAP components.",
            "training": "https://help.sap.com/docs/SUPPORT_CONTENT/techops/3362700736.html",
            "waf": "Performance"
        },
        {
            "category": "Performant",
            "checklist": "SAP Checklist",
            "guid": "b9b140cf-413a-483d-aad2-8802c4e3c017",
            "link": "https://techcommunity.microsoft.com/t5/running-sap-applications-on-the/sap-on-azure-general-update-march-2019/ba-p/377456",
            "service": "SAP",
            "services": [
                "SAP"
            ],
            "severity": "Medium",
            "subcategory": "&nbsp",
            "text": "Review SAP application server to database server latency using SAP ABAPMeter report /SSA/CAT.",
            "training": "https://me.sap.com/notes/0002879613",
            "waf": "Performance"
        },
        {
            "category": "Performant",
            "checklist": "SAP Checklist",
            "guid": "62fbf0f8-51db-49e1-a961-bb5df7a35f80",
            "service": "SAP",
            "services": [
                "SAP",
                "Monitor",
                "SQL"
            ],
            "severity": "Medium",
            "subcategory": "&nbsp",
            "text": "Review SQL Server performance monitoring using CCMS.",
            "waf": "Performance"
        },
        {
            "category": "Performant",
            "checklist": "SAP Checklist",
            "guid": "35709da7-fc7d-4efe-bb20-2e91547b7390",
            "link": "https://me.sap.com/notes/500235",
            "service": "SAP",
            "services": [
                "SAP",
                "VM"
            ],
            "severity": "Medium",
            "subcategory": "&nbsp",
            "text": "Test network latency between SAP application layer VMs and DBMS VMs (NIPING).",
            "training": "https://me.sap.com/notes/1100926/E",
            "waf": "Performance"
        },
        {
            "category": "Performant",
            "checklist": "SAP Checklist",
            "guid": "9e9bb4c8-e934-4e4b-a13c-6f7c7c38eb43",
            "link": "https://learn.microsoft.com/en-us/azure/sap/large-instances/hana-monitor-troubleshoot",
            "service": "SAP",
            "services": [
                "SAP",
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "&nbsp",
            "text": "Review SAP HANA studio alerts.",
            "waf": "Performance"
        },
        {
            "category": "Performant",
            "checklist": "SAP Checklist",
            "guid": "f1a92ab5-9509-4b57-86ff-b0ade361b694",
            "link": "https://me.sap.com/notes/1969700",
            "service": "SAP",
            "services": [
                "SAP"
            ],
            "severity": "Medium",
            "subcategory": "&nbsp",
            "text": "Perform SAP HANA health checks using HANA_Configuration_Minichecks.",
            "waf": "Performance"
        },
        {
            "category": "Security, Governance and Compliance",
            "checklist": "SAP Checklist",
            "guid": "18dffcf3-248c-4039-a67c-dec8e3a5f804",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/sap/sap-lza-security-operations",
            "service": "SAP",
            "services": [
                "SAP",
                "VM"
            ],
            "severity": "Medium",
            "subcategory": "Governance",
            "text": "If you run Windows and Linux VMs in Azure, on-premises, or in other cloud environments, you can use the Update management center in Azure Automation to manage operating system updates, including security patches.",
            "training": "https://learn.microsoft.com/azure/automation/update-management/overview",
            "waf": "Security"
        },
        {
            "category": "Security, Governance and Compliance",
            "checklist": "SAP Checklist",
            "guid": "08951710-79a2-492a-adbc-06d7a401545b",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/sap/sap-lza-security-operations",
            "service": "SAP",
            "services": [
                "SAP"
            ],
            "severity": "Medium",
            "subcategory": "Governance",
            "text": "Routinely review the SAP security OSS notes because SAP releases highly critical security patches, or hot fixes, that require immediate action to protect your SAP systems.",
            "training": "https://support.sap.com/en/my-support/knowledge-base/security-notes-news.html",
            "waf": "Security"
        },
        {
            "category": "Security, Governance and Compliance",
            "checklist": "SAP Checklist",
            "guid": "1b8b394e-ae64-4a74-8933-357b523ea0a0",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/sap/sap-lza-database-security",
            "service": "SAP",
            "services": [
                "SAP",
                "SQL"
            ],
            "severity": "Low",
            "subcategory": "Governance",
            "text": "For SAP on SQL Server, you can disable the SQL Server system administrator account because the SAP systems on SQL Server don't use the account. Ensure that another user with system administrator rights can access the server before disabling the original system administrator account.",
            "waf": "Security"
        },
        {
            "category": "Security, Governance and Compliance",
            "checklist": "SAP Checklist",
            "guid": "5a76a033-ced9-4eef-9a43-5e4f96634c8e",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/sap/sap-lza-database-security",
            "service": "SAP",
            "services": [
                "SAP",
                "SQL"
            ],
            "severity": "High",
            "subcategory": "Governance",
            "text": "Disable xp_cmdshell. The SQL Server feature xp_cmdshell enables a SQL Server internal operating system command shell. It's a potential risk in security audits.",
            "training": "https://me.sap.com/notes/3019299/E",
            "waf": "Security"
        },
        {
            "category": "Security, Governance and Compliance",
            "checklist": "SAP Checklist",
            "guid": "cf65de8e-1309-4ccc-b579-266bcca275fa",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/sap/eslz-security-governance-and-compliance",
            "service": "SAP",
            "services": [
                "AKV",
                "SQL",
                "SAP",
                "Backup",
                "Storage"
            ],
            "severity": "High",
            "subcategory": "Secrets",
            "text": "Encrypting SAP HANA database servers on Azure uses SAP HANA native encryption technology. Additionally, if you are using SQL Server on Azure, use Transparent Data Encryption (TDE) to protect your data and log files and ensure that your backups are also encrypted.",
            "training": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/sap/sap-lza-database-security",
            "waf": "Security"
        },
        {
            "category": "Security, Governance and Compliance",
            "checklist": "SAP Checklist",
            "guid": "a1abfe9d-55d0-44c3-a491-9cb1b3d1325a",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-service-encryption",
            "service": "SAP",
            "services": [
                "AKV",
                "SAP",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Secrets",
            "text": "Azure Storage encryption is enabled for all Azure Resource Manager and classic storage accounts, and can't be disabled. Because your data is encrypted by default, you don't need to modify your code or applications to use Azure Storage encryption.",
            "training": "https://learn.microsoft.com/training/modules/encrypt-sector-data/?source=recommendations",
            "waf": "Security"
        },
        {
            "category": "Security, Governance and Compliance",
            "checklist": "SAP Checklist",
            "guid": "ce9bd3bb-0cdb-43b5-9eb2-ec14eeaa3592",
            "link": "https://learn.microsoft.com/azure/key-vault/general/overview",
            "service": "SAP",
            "services": [
                "AKV",
                "SAP"
            ],
            "severity": "High",
            "subcategory": "Secrets",
            "text": "Use Azure Key Vault to store your secrets and credentials",
            "training": "https://learn.microsoft.com/training/modules/manage-secrets-with-azure-key-vault/?source=recommendations",
            "waf": "Security"
        },
        {
            "category": "Security, Governance and Compliance",
            "checklist": "SAP Checklist",
            "guid": "829e2edb-2173-4676-aff6-691b4935ada4",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/lock-resources?tabs=json",
            "service": "SAP",
            "services": [
                "AKV",
                "SAP",
                "AzurePolicy",
                "RBAC",
                "Subscriptions"
            ],
            "severity": "Medium",
            "subcategory": "Secrets",
            "text": "It is recommended to LOCK the Azure Resources post successful deployment to safeguard against unauthorized changes. You can also enforce LOCK constraints and rules on your per-subscription basis using customized Azure policies(Custome role).",
            "training": "https://learn.microsoft.com/training/modules/use-azure-resource-manager/?source=recommendations",
            "waf": "Security"
        },
        {
            "category": "Security, Governance and Compliance",
            "checklist": "SAP Checklist",
            "guid": "2223ece8-1b12-4318-8a54-17415833fb4a",
            "link": "https://learn.microsoft.com/azure/key-vault/general/soft-delete-overview",
            "service": "SAP",
            "services": [
                "AzurePolicy",
                "SAP",
                "AKV"
            ],
            "severity": "Medium",
            "subcategory": "Secrets",
            "text": "Provision Azure Key Vault with the soft delete and purge policies enabled to allow retention protection for deleted objects.",
            "training": "https://learn.microsoft.com/training/modules/manage-secrets-with-azure-key-vault/?source=recommendations",
            "waf": "Security"
        },
        {
            "category": "Security, Governance and Compliance",
            "checklist": "SAP Checklist",
            "guid": "e3c2df74-3165-4c3a-abe0-5bbe209d490d",
            "link": "https://learn.microsoft.com/azure/role-based-access-control/security-controls-policy",
            "service": "SAP",
            "services": [
                "AzurePolicy",
                "SAP",
                "RBAC",
                "AKV"
            ],
            "severity": "High",
            "subcategory": "Secrets",
            "text": "Based on existing requirements, regulatory and compliance controls (internal/external) - Determine what Azure Policies and Azure RBAC role are needed",
            "training": "https://learn.microsoft.com/training/paths/describe-azure-management-governance/?source=recommendations",
            "waf": "Security"
        },
        {
            "category": "Security, Governance and Compliance",
            "checklist": "SAP Checklist",
            "guid": "a4777842-4d11-4678-9d2f-a56c56ad4840",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/sap/eslz-security-governance-and-compliance",
            "service": "SAP",
            "services": [
                "AKV",
                "SAP",
                "Storage",
                "Defender"
            ],
            "severity": "High",
            "subcategory": "Secrets",
            "text": "When enabling Microsoft Defender for Endpoint on SAP environment, recommend excluding data and log files on DBMS servers instead of targeting all servers. Follow your DBMS vendor's recommendations when excluding target files.",
            "training": "https://techcommunity.microsoft.com/t5/running-sap-applications-on-the/microsoft-defender-endpoint-mde-for-sap-applications-on-windows/ba-p/3912268",
            "waf": "Security"
        },
        {
            "category": "Security, Governance and Compliance",
            "checklist": "SAP Checklist",
            "guid": "8fe72734-c486-4ba2-a0dc-0591cf65de8e",
            "link": "https://learn.microsoft.com/azure/defender-for-cloud/just-in-time-access-overview?tabs=defender-for-container-arch-aks",
            "service": "SAP",
            "services": [
                "AKV",
                "SAP",
                "RBAC",
                "Defender"
            ],
            "severity": "High",
            "subcategory": "Secrets",
            "text": "Delegate an SAP admin custom role with just-in-time access of Microsoft Defender for Cloud.",
            "training": "https://learn.microsoft.com/training/modules/secure-vms-with-azure-security-center/?source=recommendations",
            "waf": "Security"
        },
        {
            "category": "Security, Governance and Compliance",
            "checklist": "SAP Checklist",
            "guid": "1309cccd-5792-466b-aca2-75faa1abfe9d",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/sap/eslz-security-governance-and-compliance",
            "service": "SAP",
            "services": [
                "AKV",
                "SAP"
            ],
            "severity": "Low",
            "subcategory": "Secrets",
            "text": "encrypt data in transit by integrating the third-party security product with secure network communications (SNC) for DIAG (SAP GUI), RFC, and SPNEGO for HTTPS",
            "training": "https://learn.microsoft.com/azure/security/fundamentals/encryption-overview#encryption-of-data-in-transit",
            "waf": "Security"
        },
        {
            "category": "Security, Governance and Compliance",
            "checklist": "SAP Checklist",
            "guid": "eeaa3592-829e-42ed-a217-3676aff6691b",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-encryption-key-model-get?tabs=portal",
            "service": "SAP",
            "services": [
                "AKV",
                "SAP"
            ],
            "severity": "Medium",
            "subcategory": "Secrets",
            "text": "Default to Microsoft-managed keys for principal encryption functionality and use customer-managed keys when required.",
            "training": "https://learn.microsoft.com/training/modules/manage-secrets-with-azure-key-vault/?source=recommendations",
            "waf": "Security"
        },
        {
            "category": "Security, Governance and Compliance",
            "checklist": "SAP Checklist",
            "guid": "4935ada4-2223-4ece-a1b1-23181a541741",
            "link": "https://learn.microsoft.com/ja-jp/azure/key-vault/general/best-practices",
            "service": "SAP",
            "services": [
                "AKV",
                "SAP"
            ],
            "severity": "High",
            "subcategory": "Secrets",
            "text": "Use an Azure Key Vault per application per environment per region.",
            "training": "https://learn.microsoft.com/training/modules/manage-secrets-with-azure-key-vault/?source=recommendations",
            "waf": "Security"
        },
        {
            "category": "Security, Governance and Compliance",
            "checklist": "SAP Checklist",
            "guid": "abc9634d-c44d-41e9-a530-e8444e16aa3c",
            "link": "https://learn.microsoft.com/azure/key-vault/certificates/certificate-scenarios",
            "service": "SAP",
            "services": [
                "AKV",
                "SAP"
            ],
            "severity": "High",
            "subcategory": "Secrets",
            "text": "To control and manage disk encryption keys and secrets for non-HANA Windows and non-Windows operating systems, use Azure Key Vault. SAP HANA isn't supported with Azure Key Vault, so you must use alternate methods like SAP ABAP or SSH keys.",
            "training": "https://learn.microsoft.com/training/modules/configure-and-manage-azure-key-vault/?source=recommendations",
            "waf": "Security"
        },
        {
            "category": "Security, Governance and Compliance",
            "checklist": "SAP Checklist",
            "guid": "209d490d-a477-4784-84d1-16785d2fa56c",
            "link": "https://learn.microsoft.com/azure/role-based-access-control/built-in-roles",
            "service": "SAP",
            "services": [
                "SAP",
                "Subscriptions",
                "RBAC"
            ],
            "severity": "High",
            "subcategory": "Security",
            "text": "Customize role-based access control (RBAC) roles for SAP on Azure spoke subscriptions to avoid accidental network-related changes",
            "training": "https://learn.microsoft.com/training/modules/secure-azure-resources-with-rbac/?source=recommendations",
            "waf": "Security"
        },
        {
            "category": "Security, Governance and Compliance",
            "checklist": "SAP Checklist",
            "guid": "56ad4840-8fe7-4273-9c48-6ba280dc0591",
            "link": "https://blogs.sap.com/2019/07/21/sap-security-operations-on-azure/",
            "service": "SAP",
            "services": [
                "SAP",
                "NVA",
                "PrivateLink"
            ],
            "severity": "High",
            "subcategory": "Security",
            "text": "Isolate DMZs and NVAs from the rest of the SAP estate, configure Azure Private Link, and securely manage and control the SAP on Azure resources",
            "training": "https://learn.microsoft.com/azure/architecture/reference-architectures/dmz/secure-vnet-dmz?tabs=portal",
            "waf": "Security"
        },
        {
            "category": "Security, Governance and Compliance",
            "checklist": "SAP Checklist",
            "guid": "e124ba34-df68-45ed-bce9-bd3bb0cdb3b5",
            "link": "https://learn.microsoft.com/en-us/training/modules/secure-vms-with-azure-security-center/?source=recommendations",
            "service": "SAP",
            "services": [
                "SAP",
                "VM",
                "Storage"
            ],
            "severity": "Low",
            "subcategory": "Security",
            "text": "Consider using Microsoft anti-malware software on Azure to protect your virtual machines from malicious files, adware, and other threats.",
            "training": "https://azure.microsoft.com/blog/deploying-antimalware-solutions-on-azure-virtual-machines/",
            "waf": "Security"
        },
        {
            "category": "Security, Governance and Compliance",
            "checklist": "SAP Checklist",
            "guid": "5eb2ec14-eeaa-4359-8829-e2edb2173676",
            "link": "https://learn.microsoft.com/microsoft-365/security/defender-endpoint/microsoft-defender-endpoint?view=o365-worldwide",
            "service": "SAP",
            "services": [
                "SAP",
                "Defender"
            ],
            "severity": "Low",
            "subcategory": "Security",
            "text": "For even more powerful protection, consider using Microsoft Defender for Endpoint.",
            "training": "https://learn.microsoft.com/training/modules/implement-endpoint-protection-use-microsoft-defender/?source=recommendations",
            "waf": "Security"
        },
        {
            "category": "Security, Governance and Compliance",
            "checklist": "SAP Checklist",
            "guid": "87a924c4-25c2-419f-a2f0-96c7c4fe4525",
            "link": "https://learn.microsoft.com/azure/architecture/guide/sap/sap-whole-landscape",
            "service": "SAP",
            "services": [
                "VNet",
                "SAP"
            ],
            "severity": "High",
            "subcategory": "Security",
            "text": "Isolate the SAP application and database servers from the internet or from the on-premises network by passing all traffic through the hub virtual network, which is connected to the spoke network by virtual network peering. The peered virtual networks guarantee that the SAP on Azure solution is isolated from the public internet.",
            "training": "https://learn.microsoft.com/training/modules/explore-azure-networking/?source=recommendations",
            "waf": "Security"
        },
        {
            "category": "Security, Governance and Compliance",
            "checklist": "SAP Checklist",
            "guid": "491ca1c4-3d40-42c0-9d85-b8933999590b",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/sap/eslz-security-governance-and-compliance",
            "service": "SAP",
            "services": [
                "WAF",
                "SAP"
            ],
            "severity": "Low",
            "subcategory": "Security",
            "text": "For internet-facing applications like SAP Fiori, make sure to distribute load per application requirements while maintaining security levels. For Layer 7 security, you can use a third-party Web Application Firewall (WAF) available in the Azure Marketplace.",
            "training": "https://learn.microsoft.com/training/modules/simplify-cloud-procurement-governance-azure-marketplace/?source=recommendations",
            "waf": "Security"
        },
        {
            "category": "Security, Governance and Compliance",
            "checklist": "SAP Checklist",
            "guid": "9fc945b9-0527-47af-8200-9d652fe02fcc",
            "link": "https://learn.microsoft.com/azure/sap/monitor/enable-tls-azure-monitor-sap-solutions",
            "service": "SAP",
            "services": [
                "AKV",
                "SAP",
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Security",
            "text": "To enable secure communication in Azure Monitor for SAP solutions, you can choose to use either a root certificate or a server certificate. We highly recommend that you use root certificates.",
            "training": "https://learn.microsoft.com/training/modules/implement-azure-monitoring-sap-workloads-azure-virtual-machines/?source=recommendations",
            "waf": "Security"
        },
        {
            "category": "Operations Management",
            "checklist": "Cognitive Search Review Checklist",
            "guid": "41faa1ed-b7f0-447d-8cba-4a4905e5bb83",
            "link": "https://learn.microsoft.com/azure/search/search-reliability#high-availability",
            "service": "Cognitive Search",
            "services": [],
            "severity": "High",
            "subcategory": "High Availablity",
            "text": "Enable 2 replicas to have 99.9% availability for read operations",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Cognitive Search Review Checklist",
            "guid": "7d956fd9-788a-4845-9b9f-c0340972d810",
            "link": "https://learn.microsoft.com/azure/search/search-reliability#high-availability",
            "service": "Cognitive Search",
            "services": [],
            "severity": "Medium",
            "subcategory": "High Availablity",
            "text": "Enable 3 replicas to have 99.9% availability for read/write operations",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Cognitive Search Review Checklist",
            "guid": "44dc5f2b-a032-4d03-aae8-90c3f2c0a4c3",
            "link": "https://learn.microsoft.com/azure/search/search-reliability#availability-zone-support",
            "service": "Cognitive Search",
            "services": [],
            "severity": "High",
            "subcategory": "High Availablity",
            "text": "Leverage Availability Zones by enabling read and/or write replicas",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Cognitive Search Review Checklist",
            "guid": "cd0730f0-0ff1-4b77-9a2b-2a1f7dd5e291",
            "link": "https://learn.microsoft.com/azure/search/search-reliability#multiple-services-in-separate-geographic-regions",
            "service": "Cognitive Search",
            "services": [
                "ACR"
            ],
            "severity": "Medium",
            "subcategory": "Georeplication",
            "text": "For regional redudancy, Manually create services in 2 or more regions for Search as it doesn't provide an automated method of replicating search indexes across geographic regions",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Cognitive Search Review Checklist",
            "guid": "3c964882-aec9-4d44-9f68-4b5f2efbbdb6",
            "link": "https://learn.microsoft.com/azure/search/search-reliability#synchronize-data-across-multiple-services",
            "service": "Cognitive Search",
            "services": [
                "ACR"
            ],
            "severity": "Medium",
            "subcategory": "Georeplication",
            "text": "To synchronize data across multiple services either Use indexers for updating content on multiple services or Use REST APIs for pushing content updates on multiple services",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Cognitive Search Review Checklist",
            "guid": "85ee93c9-f53c-4803-be51-e6e4aa37ff4e",
            "link": "https://learn.microsoft.com/azure/search/search-reliability#use-azure-traffic-manager-to-coordinate-requests",
            "service": "Cognitive Search",
            "services": [
                "TrafficManager"
            ],
            "severity": "Medium",
            "subcategory": "Georeplication",
            "text": "Use Azure Traffic Manager to coordinate requests",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Cognitive Search Review Checklist",
            "guid": "7be10278-57c1-4a61-8ee3-895aebfec5aa",
            "link": "https://learn.microsoft.com/azure/search/search-reliability#back-up-and-restore-alternatives",
            "service": "Cognitive Search",
            "services": [
                "ASR",
                "Storage",
                "Backup"
            ],
            "severity": "High",
            "subcategory": "Disaster Recovery",
            "text": "Backup and Restore an Azure Cognitive Search Index. Use this sample code to back up index definition and snapshot to a series of Json files",
            "waf": "Reliability"
        },
        {
            "category": "Cleanup",
            "checklist": "Cost Optimization Checklist",
            "guid": "a95b86ad-8840-48e3-9273-4b875ba18f20",
            "link": "https://learn.microsoft.com/azure/architecture/guide/multitenant/considerations/tenancy-models",
            "service": "Azure Monitor",
            "services": [
                "Monitor",
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Azure Monitor - enforce data collection rules",
            "text": "Data collection rules in Azure Monitor -https://learn.microsoft.com/azure/azure-monitor/essentials/data-collection-rule-overview",
            "training": "https://azure.microsoft.com/pricing/reservations/",
            "waf": "Cost"
        },
        {
            "category": "Cleanup",
            "checklist": "Cost Optimization Checklist",
            "guid": "45901365-d38e-443f-abcb-d868266abca2",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/multi-tenant/automation",
            "service": "Azure Backup",
            "services": [
                "Cost",
                "Backup"
            ],
            "severity": "Medium",
            "subcategory": "Backup",
            "text": "check backup instances with the underlying datasource not found",
            "waf": "Cost"
        },
        {
            "category": "Cleanup",
            "checklist": "Cost Optimization Checklist",
            "guid": "64f9a19a-f29c-495d-94c6-c7919ca0f6c5",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/multi-tenant/lighthouse",
            "service": "VM",
            "services": [
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Delete/archive",
            "text": "Delete or archive unassociated services (disks, nics, ip addresses etc)",
            "waf": "Cost"
        },
        {
            "category": "Cleanup",
            "checklist": "Cost Optimization Checklist",
            "guid": "659d3958-fd77-4289-a835-556df2bfe456",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-microsoft-customer-agreement#design-recommendations",
            "services": [
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Delete/archive",
            "text": "Consider snooze and stop technique (snooze a service after x days, stop after 2x, delete/deallocate after 3x)",
            "waf": "Cost"
        },
        {
            "category": "Cleanup",
            "checklist": "Cost Optimization Checklist",
            "guid": "3b0d834a-3487-426d-b69c-6b5c2a26494b",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-microsoft-customer-agreement#design-recommendations",
            "services": [
                "Cost",
                "Storage",
                "Backup"
            ],
            "severity": "Medium",
            "subcategory": "Delete/archive",
            "text": "Delete or archive unused resources (old backups, logs, storage accounts, etc...)",
            "waf": "Cost"
        },
        {
            "category": "Cleanup",
            "checklist": "Cost Optimization Checklist",
            "guid": "69bad37a-ad53-4cc7-ae1d-76667357c449",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-microsoft-customer-agreement#design-recommendations",
            "service": "Azure Backup",
            "services": [
                "Cost",
                "Storage",
                "ASR",
                "Backup"
            ],
            "severity": "Medium",
            "subcategory": "Delete/archive",
            "text": "Consider a good balance between site recovery storage and backup for non mission critical applications",
            "waf": "Cost"
        },
        {
            "category": "Cleanup",
            "checklist": "Cost Optimization Checklist",
            "guid": "674b5ed8-5a85-49c7-933b-e2a1a27b765a",
            "link": "https://learn.microsoft.com/azure/cost-management-billing/manage/direct-ea-administration#manage-notification-contacts",
            "service": "Azure Monitor",
            "services": [
                "Monitor",
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Log Analytics retention for workspaces",
            "text": "Check spending and savings opportunities among the 40 different log analytics workspaces- use different retention and data collection for nonprod workspaces-create daily cap for awareness and tier sizing -  If you do set a daily cap, in addition to creating an alert when the cap is reached,ensure that you also create an alert rule to be notified when some percentage has been reached (90% for example). - consider workspace transformation if possible - https://learn.microsoft.com/azure/azure-monitor/essentials/data-collection-transformations#workspace-transformation-dcr ",
            "training": "https://learn.microsoft.com/azure/cost-management-billing/costs/understand-work-scopes",
            "waf": "Cost"
        },
        {
            "category": "Cleanup",
            "checklist": "Cost Optimization Checklist",
            "guid": "91be1f38-8ef3-494c-8bd4-63cbbac75819",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-enterprise-agreement#design-considerations",
            "service": "Azure Monitor",
            "services": [
                "AzurePolicy",
                "Cost",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Policy",
            "text": "Enforce a purging log policy and automation (if needed, logs can be moved to cold storage)",
            "training": "https://www.youtube.com/watch?v=nHQYcYGKuyw",
            "waf": "Cost"
        },
        {
            "category": "Cleanup",
            "checklist": "Cost Optimization Checklist",
            "guid": "59bb91a3-ed90-4cae-8cc8-4c37b6b780cb",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-enterprise-agreement#design-considerations",
            "services": [
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Run orphaned resources workbook - delete or snooze ghost items",
            "text": "https://github.com/dolevshor/azure-orphan-resources",
            "training": "https://learn.microsoft.com/azure/cost-management-billing/costs/tutorial-acm-create-budgets",
            "waf": "Cost"
        },
        {
            "category": "Cleanup",
            "checklist": "Cost Optimization Checklist",
            "guid": "9fe5c464-89d4-457a-a27c-3874d0102cac",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-enterprise-agreement#design-considerations",
            "services": [
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Shutdown/deallocate",
            "text": "Shutdown underutilized instances",
            "training": "https://learn.microsoft.com/azure/cost-management-billing/understand/analyze-unexpected-charges",
            "waf": "Cost"
        },
        {
            "category": "Cleanup",
            "checklist": "Cost Optimization Checklist",
            "guid": "6aae01e6-a84d-4e5d-b36d-1d92881a1bd5",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-enterprise-agreement#design-considerations",
            "service": "VM",
            "services": [
                "VM",
                "Cost",
                "Storage",
                "Backup"
            ],
            "severity": "Medium",
            "subcategory": "stopped/deallocated VMs: check disks",
            "text": "Check that the disks are really needed, if not: delete. If they are needed, find lower storage tiers or use backup -",
            "training": "https://learn.microsoft.com/azure/cost-management-billing/costs/manage-automation",
            "waf": "Cost"
        },
        {
            "category": "Cleanup",
            "checklist": "Cost Optimization Checklist",
            "guid": "d1e44a19-659d-4395-afd7-7289b835556d",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-enterprise-agreement#design-considerations",
            "service": "Storage",
            "services": [
                "AzurePolicy",
                "Cost",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "storage accounts lifecycle policy",
            "text": "Consider moving unused storage to lower tier, with customized rule - https://learn.microsoft.com/azure/storage/blobs/lifecycle-management-policy-configure  ",
            "training": "https://learn.microsoft.com/azure/cost-management-billing/costs/enable-tag-inheritance",
            "waf": "Cost"
        },
        {
            "category": "Cleanup",
            "checklist": "Cost Optimization Checklist",
            "guid": "f2bfe456-3b0d-4834-a348-726de69c6b5c",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-microsoft-customer-agreement#design-recommendations",
            "services": [
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Tagging",
            "text": "Use specific tags for temporary items with 'delete by DATE' format - and automate monthly cleanup",
            "waf": "Cost"
        },
        {
            "category": "DB/App tuning",
            "checklist": "Cost Optimization Checklist",
            "guid": "2a26494b-69ba-4d37-aad5-3cc78e1d7666",
            "link": "https://learn.microsoft.com/azure/cost-management-billing/manage/mca-section-invoice",
            "services": [
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "DB optimization",
            "text": "Plan for db optimization with the intent of downsizing the related services (and improve performance)",
            "waf": "Cost"
        },
        {
            "category": "DB/APP tuning",
            "checklist": "Cost Optimization Checklist",
            "guid": "7357c449-674b-45ed-a5a8-59c7733be2a1",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-microsoft-customer-agreement#design-recommendations",
            "services": [
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "App modernization",
            "text": "Modernizing the app towards a microservices architecture will have the effect of letting the app scale according to the single service and not the entire stack",
            "waf": "Cost"
        },
        {
            "category": "DB/APP tuning",
            "checklist": "Cost Optimization Checklist",
            "guid": "a27b765a-91be-41f3-a8ef-394c2bd463cb",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-microsoft-customer-agreement#design-recommendations",
            "services": [
                "VM",
                "Cost",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "DB optimization",
            "text": "optimizing the DB queries will increase performance and allow better right-sizing of storage and VMs",
            "waf": "Cost"
        },
        {
            "category": "DB/APP tuning",
            "checklist": "Cost Optimization Checklist",
            "guid": "bac75819-59bb-491a-9ed9-0cae2cc84c37",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "services": [
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Demand shaping",
            "text": "Using demand shaping on PaaS services will optimize costs and performances",
            "waf": "Cost"
        },
        {
            "category": "Process Administration",
            "checklist": "Cost Optimization Checklist",
            "guid": "b6b780cb-9fe5-4c46-989d-457a927c3874",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/naming-and-tagging",
            "services": [
                "Entra",
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Advisor",
            "text": "Start from the Azure Advisor page suggestions.",
            "waf": "Cost"
        },
        {
            "category": "Process Administration",
            "checklist": "Cost Optimization Checklist",
            "guid": "d0102cac-6aae-401e-9a84-de5de36d1d92",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "service": "VM",
            "services": [
                "VM",
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Advisor",
            "text": "Make sure advisor is configured for VM right sizing ",
            "waf": "Cost"
        },
        {
            "category": "Process Administration",
            "checklist": "Cost Optimization Checklist",
            "guid": "881a1bd5-d1e4-44a1-a659-d3958fd77289",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "services": [
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Automation",
            "text": "Consider implementing IaC scripts or devops pipelines to match the cost governance process",
            "waf": "Cost"
        },
        {
            "category": "Process Administration",
            "checklist": "Cost Optimization Checklist",
            "guid": "b835556d-f2bf-4e45-93b0-d834a348726d",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "services": [
                "Monitor",
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Automation",
            "text": "Set up cost alerts for applications that have variable costs (ideally for all of them)",
            "waf": "Cost"
        },
        {
            "category": "Process Administration",
            "checklist": "Cost Optimization Checklist",
            "guid": "e69c6b5c-2a26-4494-a69b-ad37aad53cc7",
            "link": "https://learn.microsoft.com/security/benchmark/azure/mcsb-asset-management#am-2-use-only-approved-services",
            "services": [
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Automation",
            "text": "Use Azure Automation: Automate repetitive tasks can help you save time and resources, reducing costs in the process. ",
            "waf": "Cost"
        },
        {
            "category": "Process Administration",
            "checklist": "Cost Optimization Checklist",
            "guid": "8e1d7666-7357-4c44-a674-b5ed85a859c7",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "services": [
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Automation",
            "text": "Run orphaned resources workbook",
            "waf": "Cost"
        },
        {
            "category": "Process Administration",
            "checklist": "Cost Optimization Checklist",
            "guid": "733be2a1-a27b-4765-a91b-e1f388ef394c",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview#azure-rbac-permissions-in-azure-policy",
            "services": [
                "Cost",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Baseline",
            "text": "Try and establish a baseline of monthly spending and an acceptable saving target against the baseline (new services will not be optimized at this stage)",
            "waf": "Cost"
        },
        {
            "category": "Process Administration",
            "checklist": "Cost Optimization Checklist",
            "guid": "2bd463cb-bac7-4581-a59b-b91a3ed90cae",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "services": [
                "AzurePolicy",
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Baseline",
            "text": "Establish a cost optimization baseline by using a policy that tags every new resource as #NEW",
            "waf": "Cost"
        },
        {
            "category": "Process Administration",
            "checklist": "Cost Optimization Checklist",
            "guid": "2cc84c37-b6b7-480c-a9fe-5c46489d457a",
            "link": "https://learn.microsoft.com/azure/automation/automation-solution-vm-management-config",
            "services": [
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Baseline",
            "text": "Organize resources to maximize cost insights and accountability",
            "waf": "Cost"
        },
        {
            "category": "Process Administration",
            "checklist": "Cost Optimization Checklist",
            "guid": "927c3874-d010-42ca-a6aa-e01e6a84de5d",
            "link": "https://learn.microsoft.com/azure/cost-management-billing/costs/tutorial-acm-create-budgets?bc=%2Fazure%2Fcloud-adoption-framework%2F_bread%2Ftoc.json&toc=%2Fazure%2Fcloud-adoption-framework%2Ftoc.json",
            "services": [
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Budgets",
            "text": "Create budgets",
            "waf": "Cost"
        },
        {
            "category": "Process Administration",
            "checklist": "Cost Optimization Checklist",
            "guid": "e36d1d92-881a-41bd-9d1e-44a19659d395",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/identity-access-landing-zones#identity-and-access-management-in-the-azure-landing-zone-accelerator",
            "services": [
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Cost Analysis",
            "text": "In cost analysis - use daily granularity, grouped by service name to analyze the spending of the past 3 months and identify the top 3 spenders",
            "waf": "Cost"
        },
        {
            "category": "Process Administration",
            "checklist": "Cost Optimization Checklist",
            "guid": "8fd77289-b835-4556-bf2b-fe4563b0d834",
            "link": "https://learn.microsoft.com/azure/active-directory/hybrid/how-to-connect-sync-staging-server",
            "services": [
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Cost Analysis",
            "text": "Check daily for cost spikes and anomalies (ideally with automatic billing exports)",
            "waf": "Cost"
        },
        {
            "category": "Process Administration",
            "checklist": "Cost Optimization Checklist",
            "guid": "a348726d-e69c-46b5-a2a2-6494b69bad37",
            "link": "https://learn.microsoft.com/azure/active-directory/roles/security-emergency-access",
            "services": [
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Cost Analysis",
            "text": "Automate cost retrieval for deep analysis or integration",
            "waf": "Cost"
        },
        {
            "category": "Process Administration",
            "checklist": "Cost Optimization Checklist",
            "guid": "aad53cc7-8e1d-4766-9735-7c449674b5ed",
            "link": "https://learn.microsoft.com/azure/active-directory/reports-monitoring/concept-activity-logs-azure-monitor",
            "services": [
                "ACR",
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Free services",
            "text": "Take advantage of Azure free services: Azure offers a number of free services, such as DevOps, Azure Container Registry, and Azure Logic Apps, that can help you save costs on development and operations. ",
            "waf": "Cost"
        },
        {
            "category": "Process Administration",
            "checklist": "Cost Optimization Checklist",
            "guid": "96c96ad8-844c-4f3b-8b38-c886ba2c0214",
            "link": "https://learn.microsoft.com/azure/role-based-access-control/overview",
            "services": [
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Tagging",
            "text": "Tag shared resources",
            "waf": "Cost"
        },
        {
            "category": "Process Administration",
            "checklist": "Cost Optimization Checklist",
            "guid": "99014a5d-3ce5-474d-acbd-9792a6bcca2b",
            "link": "https://learn.microsoft.com/azure/active-directory/conditional-access/overview",
            "services": [
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Tagging",
            "text": "Consider using tags to all services for cost allocation",
            "waf": "Cost"
        },
        {
            "category": "reservations",
            "checklist": "Cost Optimization Checklist",
            "guid": "4fea1dbf-3dd9-45d4-ac7c-891dcb1f7d57",
            "link": "https://learn.microsoft.com/azure/active-directory/authentication/concept-mfa-howitworks",
            "services": [
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "automation",
            "text": "Consider Reservation automation to track and promptly react to changes",
            "waf": "Cost"
        },
        {
            "category": "Reservations",
            "checklist": "Cost Optimization Checklist",
            "description": "check by searching the Meter Category Licenses in the Cost analysys",
            "guid": "59ae568b-a38d-4498-9e22-13dbd7bb012f",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/manage/centralize-operations",
            "service": "VM",
            "services": [
                "AzurePolicy",
                "VM",
                "Cost",
                "SQL"
            ],
            "severity": "Medium",
            "subcategory": "check AHUB is applied to all Windows VMs, RHEL and SQL",
            "text": "run the script on all windows VMs https://learn.microsoft.com/azure/virtual-machines/windows/hybrid-use-benefit-licensing?ref=andrewmatveychuk.com#convert-an-existing-vm-using-azure-hybrid-benefit-for-windows-server- consider implementing a policy if windows VMs are created frequently",
            "waf": "Cost"
        },
        {
            "category": "Reservations",
            "checklist": "Cost Optimization Checklist",
            "guid": "7b95e06e-158e-42ea-9992-c2de6e2065b3",
            "link": "https://learn.microsoft.com/azure/active-directory/privileged-identity-management/pim-configure",
            "service": "VM",
            "services": [
                "LoadBalancer",
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Check Red Hat Licences if applicable",
            "text": " this can be also put under AHUB if you already have licenses https://learn.microsoft.com/azure/virtual-machines/linux/azure-hybrid-benefit-linux?tabs=rhelpayg%2Crhelbyos%2CrhelEnablebyos%2Crhelcompliance",
            "waf": "Cost"
        },
        {
            "category": "Reservations",
            "checklist": "Cost Optimization Checklist",
            "guid": "a76af4a6-91e8-4839-ada4-6667e13c1056",
            "link": "https://learn.microsoft.com/azure/active-directory/roles/security-planning#identify-microsoft-accounts-in-administrative-roles-that-need-to-be-switched-to-work-or-school-accounts",
            "services": [
                "AppSvc",
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Functions",
            "text": "Saving plans will provide 17% on select app service plans",
            "waf": "Cost"
        },
        {
            "category": "Reservations",
            "checklist": "Cost Optimization Checklist",
            "guid": "75c1e945-b459-4837-bf7a-e7c6d3b475a5",
            "link": "https://learn.microsoft.com/azure/active-directory/fundamentals/active-directory-groups-create-azure-portal",
            "service": "VM",
            "services": [
                "VM",
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Planning",
            "text": "Consolidate reserved VM families with flexibility option (no more than 4-5 families)",
            "training": "https://learn.microsoft.com/azure/automation/automation-solution-vm-management",
            "waf": "Cost"
        },
        {
            "category": "Reservations",
            "checklist": "Cost Optimization Checklist",
            "guid": "c7acbe49-bbe6-44dd-a9f2-e87778468d55",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/identity-access#prerequisites-for-a-landing-zone---design-recommendations",
            "service": "VM",
            "services": [
                "VM",
                "Cost",
                "ARS"
            ],
            "severity": "Medium",
            "subcategory": "Reservations/savings plans",
            "text": "Utilize Azure Reserved Instances: This feature allows you to reserve VMs for a period of 1 or 3 years, providing significant cost savings compared to PAYG prices.",
            "waf": "Cost"
        },
        {
            "category": "Reservations",
            "checklist": "Cost Optimization Checklist",
            "guid": "a785c6fe-96c9-46ad-a844-cf3b2b38c886",
            "link": "https://azure.microsoft.com/resources/achieving-compliant-data-residency-and-security-with-azure/",
            "services": [
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Reservations/savings plans",
            "text": "Plan for Azure Savings Plans for all the workloads that are dynamic and need maximum flexibility",
            "waf": "Cost"
        },
        {
            "category": "Reservations",
            "checklist": "Cost Optimization Checklist",
            "guid": "ba2c0214-9901-44a5-b3ce-574dccbd9792",
            "link": "https://learn.microsoft.com/azure/active-directory-domain-services/overview",
            "services": [
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Reservations/savings plans",
            "text": "Plan for Azure Reservations for all the workloads that are less dynamic and won't change much",
            "waf": "Cost"
        },
        {
            "category": "Reservations",
            "checklist": "Cost Optimization Checklist",
            "guid": "a6bcca2b-4fea-41db-b3dd-95d48c7c891d",
            "link": "https://learn.microsoft.com/azure/active-directory-domain-services/overview",
            "service": "VM",
            "services": [
                "Cost",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Reserve storage",
            "text": "Only larger disks can be reserved => 1 TiB -",
            "waf": "Cost"
        },
        {
            "category": "Reservations",
            "checklist": "Cost Optimization Checklist",
            "guid": "cb1f7d57-59ae-4568-aa38-d4985e2213db",
            "link": "https://learn.microsoft.com/azure/architecture/reference-architectures/identity/adds-extend-domain",
            "service": "VM",
            "services": [
                "VM",
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Reserve VMs with normalized and rationalized sizes",
            "text": "After the right-sizing optimization",
            "waf": "Cost"
        },
        {
            "category": "Reservations",
            "checklist": "Cost Optimization Checklist",
            "guid": "d7bb012f-7b95-4e06-b158-e2ea3992c2de",
            "link": "https://learn.microsoft.com/azure/active-directory/app-proxy/application-proxy",
            "service": "Azure SQL",
            "services": [
                "AzurePolicy",
                "Cost",
                "SQL"
            ],
            "severity": "Medium",
            "subcategory": "SQL Database AHUB",
            "text": "Check if applicable and enforce policy/change https://learn.microsoft.com/azure/azure-sql/azure-hybrid-benefit?view=azuresql&tabs=azure-portalhttps://learn.microsoft.com/azure/cost-management-billing/scope-level/create-sql-license-assignments?source=recommendations",
            "waf": "Cost"
        },
        {
            "category": "Reservations",
            "checklist": "Cost Optimization Checklist",
            "guid": "6e2065b3-a76a-4f4a-991e-8839ada46667",
            "link": "https://learn.microsoft.com/azure/active-directory/roles/best-practices",
            "service": "VM",
            "services": [
                "VM",
                "Cost",
                "SQL"
            ],
            "severity": "Medium",
            "subcategory": "SQL Database Reservations",
            "text": "The VM + license part discount (ahub + 3YRI) is around 70% discount",
            "waf": "Cost"
        },
        {
            "category": "Reservations",
            "checklist": "Cost Optimization Checklist",
            "guid": "e13c1056-75c1-4e94-9b45-9837ff7ae7c6",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/identity-access-landing-zones#managed-identities",
            "services": [
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Tracking",
            "text": "Make sure you Azure Reservations and Savings plans are close to 100% utilization or make the necessary changes to reach it.",
            "waf": "Cost"
        },
        {
            "category": "Reservations",
            "checklist": "Cost Optimization Checklist",
            "guid": "d3b475a5-c7ac-4be4-abbe-64dd89f2e877",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/identity-access-landing-zones#rbac-recommendations",
            "services": [
                "AzurePolicy",
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Tracking",
            "text": "Make sure that your reservations usage is close to 100%. If not, either enforce an allowed SKU policy or exchange the reservation",
            "waf": "Cost"
        },
        {
            "category": "Right-sizing",
            "checklist": "Cost Optimization Checklist",
            "guid": "78468d55-a785-4c6f-b96c-96ad8844cf3b",
            "link": "https://learn.microsoft.com/azure/active-directory/privileged-identity-management/pim-create-roles-and-resource-roles-review",
            "services": [
                "AzurePolicy",
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Automation",
            "text": "Plan and enforce a On/Off policy for production services, where possible",
            "waf": "Cost"
        },
        {
            "category": "Right-sizing",
            "checklist": "Cost Optimization Checklist",
            "guid": "2b38c886-ba2c-4021-9990-14a5d3ce574d",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#add-diagnostic-settings-to-save-your-wafs-logs",
            "services": [
                "AzurePolicy",
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Automation",
            "text": "Plan and enforce a On-Demand policy with auto-shutdown for non-production services, where possible",
            "waf": "Cost"
        },
        {
            "category": "Right-sizing",
            "checklist": "Cost Optimization Checklist",
            "guid": "ccbd9792-a6bc-4ca2-a4fe-a1dbf3dd95d4",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#send-logs-to-microsoft-sentinel",
            "service": "VM",
            "services": [
                "VM",
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Autoscale",
            "text": "Consider using a VMSS to match demand rather than flat sizing",
            "waf": "Cost"
        },
        {
            "category": "Right-sizing",
            "checklist": "Cost Optimization Checklist",
            "guid": "c1b1cd52-1e54-4a29-a9de-39ac0e7c28dc",
            "link": "https://learn.microsoft.com/azure/reliability/cross-region-replication-azure",
            "service": "AKS",
            "services": [
                "AKS",
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Autoscale",
            "text": "Use AKS autoscaler to match your clusters usage (make sure the pods requirements match the scaler)",
            "waf": "Cost"
        },
        {
            "category": "Right-sizing",
            "checklist": "Cost Optimization Checklist",
            "guid": "93665720-2bff-4456-9b0d-934a359c363e",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-redundancy",
            "services": [
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Autoscale",
            "text": "Right-size PaaS service according to average use and accomodate spikes with auto or manual scaling",
            "waf": "Cost"
        },
        {
            "category": "Right-sizing",
            "checklist": "Cost Optimization Checklist",
            "guid": "7dd61623-a364-4a90-9eba-e38ead53cc7d",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/design-logs-deployment",
            "services": [
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Autoscale",
            "text": "Plan for demand shaping where applicable",
            "waf": "Cost"
        },
        {
            "category": "Right-sizing",
            "checklist": "Cost Optimization Checklist",
            "guid": "e2e8aaab-3571-4549-ab91-53d89f89dc7b",
            "services": [
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Autoscale",
            "text": "Consider implementing a service re-scaling logic within the application",
            "training": "https://learn.microsoft.com/azure/cost-management-billing/savings-plan/",
            "waf": "Cost"
        },
        {
            "category": "Right-sizing",
            "checklist": "Cost Optimization Checklist",
            "guid": "44be3b1a-27f8-4b9e-a1be-1f38df03a822",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/data-retention-archive?tabs=portal-1%2Cportal-2#how-retention-and-archiving-work",
            "service": "Azure Backup",
            "services": [
                "Cost",
                "Backup"
            ],
            "severity": "Medium",
            "subcategory": "Backup",
            "text": "Move recovery points to vault-archive where applicable (Validate)",
            "training": "https://azure.microsoft.com/pricing/reservations/",
            "waf": "Cost"
        },
        {
            "category": "Right-sizing",
            "checklist": "Cost Optimization Checklist",
            "guid": "cd463cbb-bc8a-4c29-aebc-91a43da1dae2",
            "link": "https://learn.microsoft.com/azure/databricks/clusters/cluster-config-best-practices#automatic-termination",
            "service": "Databricks",
            "services": [
                "LoadBalancer",
                "VM",
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Databricks",
            "text": "Consider using Spot VMs with fallback where possible. Consider autotermination of clusters.",
            "waf": "Cost"
        },
        {
            "category": "Right-sizing",
            "checklist": "Cost Optimization Checklist",
            "guid": "cc881470-607c-41cc-a0e6-14658dd458e9",
            "link": "https://learn.microsoft.com/azure/governance/policy/how-to/guest-configuration-create",
            "service": "Azure Functions",
            "services": [
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Functions",
            "text": "Functions - Reuse connections",
            "training": "https://learn.microsoft.com/azure/cost-management-billing/reservations/reservation-apis?toc=%2Fazure%2Fcost-management-billing%2Ftoc.json",
            "waf": "Cost"
        },
        {
            "category": "Right-sizing",
            "checklist": "Cost Optimization Checklist",
            "guid": "27139b82-1102-4dbd-9eaf-11e6f843e52f",
            "link": "https://learn.microsoft.com/azure/automation/update-management/overview",
            "service": "Azure Functions",
            "services": [
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Functions",
            "text": "Functions - Cache data locally",
            "training": "https://learn.microsoft.com/learn/paths/azure-administrator-manage-compute-resources/",
            "waf": "Cost"
        },
        {
            "category": "Right-sizing",
            "checklist": "Cost Optimization Checklist",
            "guid": "4722d928-c1b1-4cd5-81e5-4a29b9de39ac",
            "link": "https://learn.microsoft.com/azure/network-watcher/network-watcher-monitoring-overview",
            "service": "Azure Functions",
            "services": [
                "Cost",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Functions",
            "text": "Functions - Cold starts-Use the 'Run from package' functionality. This way, the code is downloaded as a single zip file. This can, for example, result in significant improvements with Javascript functions, which have a lot of node modules.Use language specific tools to reduce the package size, for example, tree shaking Javascript applications.",
            "training": "https://learn.microsoft.com/learn/modules/configure-network-watcher/",
            "waf": "Cost"
        },
        {
            "category": "Right-sizing",
            "checklist": "Cost Optimization Checklist",
            "guid": "0e7c28dc-9366-4572-82bf-f4564b0d934a",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/lock-resources?tabs=json",
            "service": "Azure Functions",
            "services": [
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Functions",
            "text": "Functions - Keep your functions warm",
            "training": "https://learn.microsoft.com/learn/paths/implement-resource-mgmt-security/",
            "waf": "Cost"
        },
        {
            "category": "Right-sizing",
            "checklist": "Cost Optimization Checklist",
            "guid": "359c363e-7dd6-4162-9a36-4a907ebae38e",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "service": "Azure Functions",
            "services": [
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Functions",
            "text": "When using autoscale with different functions, there might be one driving all the autoscale for all the resources - consider moving it to a separate consumption plan (and consider higher plan for CPU)",
            "waf": "Cost"
        },
        {
            "category": "Right-sizing",
            "checklist": "Cost Optimization Checklist",
            "guid": "ad53cc7d-e2e8-4aaa-a357-1549ab9153d8",
            "link": "https://learn.microsoft.com/azure/service-health/alerts-activity-log-service-notifications-portal",
            "service": "Azure Functions",
            "services": [
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Functions",
            "text": "Function apps in a given plan are all scaled together, so any issues with scaling can affect all apps in the plan.",
            "waf": "Cost"
        },
        {
            "category": "Right-sizing",
            "checklist": "Cost Optimization Checklist",
            "guid": "9f89dc7b-44be-43b1-a27f-8b9e91be1f38",
            "link": "https://learn.microsoft.com/azure/azure-monitor/alerts/action-groups",
            "service": "Azure Functions",
            "services": [
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Functions",
            "text": "Am I billed for 'await time'? This question is typically asked in the context of a C# function that does an async operation and waits for the result, e.g. await Task.Delay(1000) or await client.GetAsync('http://google.com'). The answer is yes - the GB second calculation is based on the start and end time of the function and the memory usage over that period. What actually happens over that time in terms of CPU activity is not factored into the calculation.One exception to this rule is if you are using durable functions. You are not billed for time spent at awaits in orchestrator functions.apply demand shaping techinques where possible (dev environments?) https://github.com/Azure-Samples/functions-csharp-premium-scaler",
            "waf": "Cost"
        },
        {
            "category": "Right-sizing",
            "checklist": "Cost Optimization Checklist",
            "guid": "df03a822-cd46-43cb-abc8-ac299ebc91a4",
            "link": "https://learn.microsoft.com/azure/sentinel/quickstart-onboard",
            "services": [
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Networking",
            "text": "Evaluate your network topology against networking costs and where applicable reduce the egress and peering data",
            "waf": "Cost"
        },
        {
            "category": "Right-sizing",
            "checklist": "Cost Optimization Checklist",
            "guid": "3da1dae2-cc88-4147-8607-c1cca0e61465",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/design-logs-deployment",
            "service": "Front Door",
            "services": [
                "FrontDoor",
                "EventHubs",
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Networking",
            "text": "Frontdoor - Turn off the default homepageIn the application settings of your App, set AzureWebJobsDisableHomepage to true. This will return a 204 (No Content) to the PoP so only header data is returned.",
            "waf": "Cost"
        },
        {
            "category": "Right-sizing",
            "checklist": "Cost Optimization Checklist",
            "guid": "8dd458e9-2713-49b8-8110-2dbd6eaf11e6",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-setup-guide/monitoring-reporting?tabs=AzureMonitor",
            "service": "Front Door",
            "services": [
                "FrontDoor",
                "AppSvc",
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Networking",
            "text": "Frontdoor - Route to something that returns nothing. Either set up a Function, Function Proxy, or add a route in your WebApp that returns 200 (OK) and sends no or minimal content. The advantage of this is you will be able to log out when it is called.",
            "waf": "Cost"
        },
        {
            "category": "Right-sizing",
            "checklist": "Cost Optimization Checklist",
            "guid": "f843e52f-4722-4d92-ac1b-1cd521e54a29",
            "link": "https://learn.microsoft.com/azure/azure-monitor/agents/diagnostics-extension-overview",
            "services": [
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "PaaS",
            "text": "Consider using free tiers where applicable for all non-production environments",
            "waf": "Cost"
        },
        {
            "category": "Right-sizing",
            "checklist": "Cost Optimization Checklist",
            "guid": "b9de39ac-0e7c-428d-a936-657202bff456",
            "link": "https://learn.microsoft.com/azure/azure-monitor/alerts/alerts-overview",
            "services": [
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Serverless",
            "text": "Using serverless patterns for spikes can help keeping costs down",
            "waf": "Cost"
        },
        {
            "category": "Right-sizing",
            "checklist": "Cost Optimization Checklist",
            "guid": "7e31c67d-68cf-46a6-8a11-94956d697dc3",
            "link": "https://learn.microsoft.com/azure/architecture/best-practices/monitoring",
            "service": "Storage",
            "services": [
                "Cost",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Storage",
            "text": "Consider archiving tiers for less used data",
            "waf": "Cost"
        },
        {
            "category": "Right-sizing",
            "checklist": "Cost Optimization Checklist",
            "guid": "a2ed27b2-d186-4f1a-8252-bddde68a487c",
            "link": "https://learn.microsoft.com/azure/automation/how-to/region-mappings",
            "service": "VM",
            "services": [
                "Cost",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Storage",
            "text": "Check disk sizes where the size does not match the tier (i.e. A 513 GiB disk will pay a P30 (1TiB) and consider resizing",
            "waf": "Cost"
        },
        {
            "category": "Right-sizing",
            "checklist": "Cost Optimization Checklist",
            "guid": "dec4861b-c3bc-410a-b77e-26e4d5a3bec2",
            "link": "https://learn.microsoft.com/azure/governance/policy/concepts/guest-configuration",
            "service": "Storage",
            "services": [
                "Cost",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Storage",
            "text": "Consider using standard SSD rather than Premium or Ultra where possible",
            "waf": "Cost"
        },
        {
            "category": "Right-sizing",
            "checklist": "Cost Optimization Checklist",
            "guid": "c4e2436b-1336-4db5-9f17-960eee0bdf5c",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/management-operational-compliance#monitoring-for-configuration-drift",
            "service": "Storage",
            "services": [
                "Cost",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Storage",
            "text": "For storage accounts, make sure that the chosen tier is not adding up transaction charges (it might be cheaper to move to the next tier)",
            "waf": "Cost"
        },
        {
            "category": "Right-sizing",
            "checklist": "Cost Optimization Checklist",
            "guid": "c2efc5d7-61d4-41d2-900b-b47a393a040f",
            "link": "https://learn.microsoft.com/azure/site-recovery/site-recovery-overview",
            "service": "Site Recovery",
            "services": [
                "Cost",
                "Storage",
                "ASR"
            ],
            "severity": "Medium",
            "subcategory": "Storage",
            "text": "For ASR, consider using Standard SSD disks if the RPO/RTO and replication throughput allow it",
            "waf": "Cost"
        },
        {
            "category": "Right-sizing",
            "checklist": "Cost Optimization Checklist",
            "guid": "d3294798-b118-48b2-a5a4-6ceb544451e1",
            "link": "https://learn.microsoft.com/azure/architecture/framework/resiliency/backup-and-recovery",
            "service": "Storage",
            "services": [
                "Cost",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "storage",
            "text": "Storage accounts: check hot tier and/or GRS necessary",
            "waf": "Cost"
        },
        {
            "category": "Right-sizing",
            "checklist": "Cost Optimization Checklist",
            "guid": "92d34429-3c76-4286-97a5-51c5b04e4f18",
            "link": "https://learn.microsoft.com/azure/backup/backup-center-overview",
            "service": "VM",
            "services": [
                "Cost",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Storage",
            "text": "Disks - validate use of Premium SSD disks everywhere: for example, non-prod could swap to Standard SSD or on-demand Premium SSD  ",
            "waf": "Cost"
        },
        {
            "category": "Right-sizing",
            "checklist": "Cost Optimization Checklist",
            "guid": "54387e5c-ed12-46cd-832a-f5b2fc6998a5",
            "link": "https://learn.microsoft.com/azure/reliability/availability-zones-overview",
            "service": "Synapse",
            "services": [
                "EventHubs",
                "Cost",
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Synapse",
            "text": "Create budgets to manage costs and create alerts that automatically notify stakeholders of spending anomalies and overspending risks.",
            "waf": "Cost"
        },
        {
            "category": "Right-sizing",
            "checklist": "Cost Optimization Checklist",
            "guid": "35e33789-7e31-4c67-b68c-f6a62a119495",
            "link": "https://learn.microsoft.com/azure/virtual-machines/availability",
            "service": "Synapse",
            "services": [
                "Cost",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Synapse",
            "text": "Export cost data to a storage account for additional data analysis.",
            "waf": "Cost"
        },
        {
            "category": "Right-sizing",
            "checklist": "Cost Optimization Checklist",
            "guid": "6d697dc3-a2ed-427b-8d18-6f1a1252bddd",
            "link": "https://learn.microsoft.com/azure/load-balancer/load-balancer-overview",
            "service": "Synapse",
            "services": [
                "Cost",
                "SQL"
            ],
            "severity": "Medium",
            "subcategory": "Synapse",
            "text": "Control costs for a dedicated SQL pool by pausing the resource when it is not in use.",
            "waf": "Cost"
        },
        {
            "category": "Right-sizing",
            "checklist": "Cost Optimization Checklist",
            "guid": "e68a487c-dec4-4861-ac3b-c10ae77e26e4",
            "link": "https://learn.microsoft.com/azure/virtual-machine-scale-sets/overview",
            "service": "Synapse",
            "services": [
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Synapse",
            "text": "Enable the serverless Apache Spark automatic pause feature and set your timeout value accordingly.",
            "waf": "Cost"
        },
        {
            "category": "Right-sizing",
            "checklist": "Cost Optimization Checklist",
            "guid": "d5a3bec2-c4e2-4436-a133-6db55f17960e",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-latest-version-for-customer-managed-certificates",
            "service": "Synapse",
            "services": [
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Synapse",
            "text": "Create multiple Apache Spark pool definitions of various sizes.",
            "waf": "Cost"
        },
        {
            "category": "Right-sizing",
            "checklist": "Cost Optimization Checklist",
            "guid": "ee0bdf5c-c2ef-4c5d-961d-41d2500bb47a",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/resource-org-management-groups#management-groups-in-the-azure-landing-zone-accelerator",
            "service": "Synapse",
            "services": [
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Synapse",
            "text": "Purchase Azure Synapse commit units (SCU) for one year with a pre-purchase plan to save on your Azure Synapse Analytics costs.",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "Cost"
        },
        {
            "category": "Right-sizing",
            "checklist": "Cost Optimization Checklist",
            "guid": "393a040f-d329-4479-ab11-88b2c5a46ceb",
            "link": "https://learn.microsoft.com/azure/application-gateway/overview-v2",
            "service": "VM",
            "services": [
                "VM",
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "VM",
            "text": "Use Spot VMs for interruptible jobs: These are VMs that can be bid on and purchased at a discounted price, providing a cost-effective solution for non-critical workloads.",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "Cost"
        },
        {
            "category": "Right-sizing",
            "checklist": "Cost Optimization Checklist",
            "guid": "544451e1-92d3-4442-a3c7-628637a551c5",
            "link": "https://learn.microsoft.com/azure/load-balancer/load-balancer-overview",
            "service": "VM",
            "services": [
                "VM",
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "VM",
            "text": "Right-sizing all VMs",
            "waf": "Cost"
        },
        {
            "category": "Right-sizing",
            "checklist": "Cost Optimization Checklist",
            "guid": "b04e4f18-5438-47e5-aed1-26cd032af5b2",
            "link": "https://learn.microsoft.com/azure/application-gateway/configuration-infrastructure#size-of-the-subnet",
            "service": "VM",
            "services": [
                "VM",
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "VM",
            "text": "Swap VM sized with normalized and most recent sizes",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "Cost"
        },
        {
            "category": "Right-sizing",
            "checklist": "Cost Optimization Checklist",
            "guid": "fc6998a5-35e3-4378-a7e3-1c67d68cf6a6",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "service": "VM",
            "services": [
                "VM",
                "Monitor",
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "VM",
            "text": "right-sizing VMs - start with monitoring usage below 5% and then work up to 40%",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "Cost"
        },
        {
            "category": "Right-sizing",
            "checklist": "Cost Optimization Checklist",
            "guid": "2a119495-6d69-47dc-9a2e-d27b2d186f1a",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "service": "VM",
            "services": [
                "VM",
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "VM",
            "text": "Containerizing an application can improve VM density and save money on scaling it",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Cost"
        },
        {
            "category": "Responsible AI",
            "checklist": "Azure OpenAI Review",
            "guid": "a85b86ad-884f-48e3-9273-4b875ba18f10",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/concepts/system-message#define-additional-safety-and-behavioral-guardrails",
            "service": "Azure OpenAI",
            "services": [],
            "severity": "High",
            "subcategory": "Metaprompting",
            "text": "Follow Metaprompting guardrails for resonsible AI",
            "waf": "Operational Excellence"
        },
        {
            "category": "Operations Management",
            "checklist": "Azure OpenAI Review",
            "guid": "d4391898-cd28-48be-b6b1-7cb8245451e1",
            "link": "https://github.com/Azure-Samples/AI-Gateway",
            "service": "Azure OpenAI",
            "services": [
                "Entra",
                "APIM"
            ],
            "severity": "High",
            "subcategory": "Load Balancing",
            "text": "Consider Gateway patterns with APIM  or solutions like AI central for better rate limiting, load balancing, authentication and logging",
            "waf": "Operational Excellence"
        },
        {
            "category": "Operations Management",
            "checklist": "Azure OpenAI Review",
            "guid": "aed3453a-ec72-4392-97a1-52d6cc5e4029",
            "link": "https://techcommunity.microsoft.com/t5/fasttrack-for-azure/azure-openai-insights-monitoring-ai-with-confidence/ba-p/4026850",
            "service": "Azure OpenAI",
            "services": [
                "Monitor"
            ],
            "severity": "High",
            "subcategory": "Monitoring",
            "text": "Enable monitoring for your AOAI instances",
            "waf": "Operational Excellence"
        },
        {
            "category": "Operations Management",
            "checklist": "Azure OpenAI Review",
            "guid": "697cb391-ed16-4b2d-886f-0a0241addde6",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/monitoring#set-up-alerts",
            "service": "Azure OpenAI",
            "services": [
                "AKV",
                "Subscriptions",
                "Monitor"
            ],
            "severity": "High",
            "subcategory": "Alerts",
            "text": "Create alerts to notify teams of events such as an entry in the activity log created by an action performed on the resource, such as regenerating its subscription keys or a metric threshold such as the number of errors exceeding 10 in an hour",
            "waf": "Operational Excellence"
        },
        {
            "category": "Operations Management",
            "checklist": "Azure OpenAI Review",
            "guid": "8a477cde-b486-41bc-9bc1-0ae66e25d4d5",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/monitoring",
            "service": "Azure OpenAI",
            "services": [
                "Monitor"
            ],
            "severity": "High",
            "subcategory": "Monitoring",
            "text": "Monitor token usage to prevent service disruptions due to capacity",
            "waf": "Operational Excellence"
        },
        {
            "category": "Operations Management",
            "checklist": "Azure OpenAI Review",
            "guid": "a3aec2c4-e243-46b0-936c-b45e17960eee",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/monitoring",
            "service": "Azure OpenAI",
            "services": [
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Observability",
            "text": "observe metrics like processed inference tokens, generated completion tokens monitor for rate limit",
            "waf": "Operational Excellence"
        },
        {
            "category": "Operations Management",
            "checklist": "Azure OpenAI Review",
            "guid": "fbdf4cc2-eec4-4d76-8c31-d25ffbb46a39",
            "link": "https://techcommunity.microsoft.com/t5/apps-on-azure-blog/build-an-enterprise-ready-azure-openai-solution-with-azure-api/ba-p/3907562",
            "service": "Azure OpenAI",
            "services": [
                "APIM"
            ],
            "severity": "Low",
            "subcategory": "Observability",
            "text": "Enable and configure Diagnostics for the Azure OpenAI Service. If not sufficient, consider using a gateway such as Azure API Managements in front of Azure OpenAI to log both incoming prompts and outgoing responses, where permitted",
            "waf": "Operational Excellence"
        },
        {
            "category": "Operations Management",
            "checklist": "Azure OpenAI Review",
            "guid": "3af30ed3-2947-498b-8178-a2c5a46ceb54",
            "link": "https://github.com/Azure-Samples/openai-enterprise-iac",
            "service": "Azure OpenAI",
            "services": [],
            "severity": "High",
            "subcategory": "Infrastructure Deployment",
            "text": "Use Infrastructure as code to deploy the Azure OpenAI Service, model deployments, and all related resources",
            "waf": "Operational Excellence"
        },
        {
            "category": "Governance and Security",
            "checklist": "Azure OpenAI Review",
            "guid": "4350d092-d234-4292-a752-8537a551c5bf",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/managed-identity",
            "service": "Azure OpenAI",
            "services": [
                "Entra"
            ],
            "severity": "High",
            "subcategory": "Authentication",
            "text": "Use Microsoft Entra Authentication with Managed Identity instead of API Key",
            "waf": "Security"
        },
        {
            "category": "Responsible AI",
            "checklist": "Azure OpenAI Review",
            "guid": "4e4f1854-287d-45cd-a126-cc031af5b1fc",
            "link": "https://learn.microsoft.com/azure/machine-learning/prompt-flow/how-to-bulk-test-evaluate-flow?view=azureml-api-2",
            "service": "Azure OpenAI",
            "services": [],
            "severity": "High",
            "subcategory": "Evaluation",
            "text": "Evaluate the performance/accuracy of the system with a known golden dataset which has the inputs and the correct answers. Leverage capabilities in PromptFlow for Evaluation.",
            "waf": "Operational Excellence"
        },
        {
            "category": "Operations Management",
            "checklist": "Azure OpenAI Review",
            "guid": "68889535-e327-4897-b31b-67d67be5962a",
            "link": "https://learn.microsoft.com/azure/architecture/ai-ml/architecture/baseline-openai-e2e-chat#azure-openai---performance-efficiency",
            "service": "Azure OpenAI",
            "services": [],
            "severity": "High",
            "subcategory": "Hosting model",
            "text": "Evaluate usage of Provisioned throughput model ",
            "waf": "Performance"
        },
        {
            "category": "Responsible AI",
            "checklist": "Azure OpenAI Review",
            "guid": "cd288bed-6b17-4cb8-8454-51e1aed3453a",
            "link": "https://learn.microsoft.com/azure/ai-services/content-safety/overview",
            "service": "Azure OpenAI",
            "services": [],
            "severity": "High",
            "subcategory": "Content Safety",
            "text": "Review and implement Azure AI content safety",
            "waf": "Operational Excellence"
        },
        {
            "category": "Operations Management",
            "checklist": "Azure OpenAI Review",
            "guid": "1193846d-697c-4b39-8ed1-6b2d186f0a02",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/latency#system-level-throughput",
            "service": "Azure OpenAI",
            "services": [],
            "severity": "High",
            "subcategory": "Throughput definition",
            "text": "Define and evaluate the throughput of the system based on tokens & response per minute and align with requirements",
            "waf": "Performance"
        },
        {
            "category": "Operations Management",
            "checklist": "Azure OpenAI Review",
            "guid": "41addde6-8a47-47cd-bb48-61bc3bc10ae6",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/latency#improve-performance",
            "service": "Azure OpenAI",
            "services": [],
            "severity": "Medium",
            "subcategory": "Latency improvement",
            "text": "Improve latency of the system by limiting token sizes, streaming options for applications like chatbots or conversational interfaces. Streaming can enhance the perceived performance of Azure OpenAI applications by delivering responses to users in an incremental manner",
            "waf": "Performance"
        },
        {
            "category": "Operations Management",
            "checklist": "Azure OpenAI Review",
            "guid": "6e25d4d5-a3ae-4c2c-9e24-36b0336cb45e",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/latency#batching",
            "service": "Azure OpenAI",
            "services": [
                "ServiceBus",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Elasticity segregation",
            "text": "Estimate elasticity demands to determine synchronous and batch request segregation based on priority. For high priority, use synchronous approach and for low priority, asynchronous batch processing with queue is preferred",
            "waf": "Performance"
        },
        {
            "category": "Operations Management",
            "checklist": "Azure OpenAI Review",
            "guid": "5bda4332-4f24-4811-9331-82ba51752694",
            "link": "https://github.com/Azure/azure-openai-benchmark/",
            "service": "Azure OpenAI",
            "services": [],
            "severity": "High",
            "subcategory": "Benchmarking",
            "text": "Benchmark token consumption requirements based on estimated demands from consumers. Consider using the Azure OpenAI benchmarking tool to help you validate the throughput if you are using Provisioned Throughput Unit deployments",
            "waf": "Performance"
        },
        {
            "category": "Operations Management",
            "checklist": "Azure OpenAI Review",
            "guid": "4008ae7d-7e47-4432-96d8-bdcf55bce619",
            "link": "https://techcommunity.microsoft.com/t5/fasttrack-for-azure/optimizing-azure-openai-a-guide-to-limits-quotas-and-best/ba-p/4076268",
            "service": "Azure OpenAI",
            "services": [],
            "severity": "Medium",
            "subcategory": "Elasticity ",
            "text": "If you are using Provisioned Throughput Units (PTUs), consider deploying a token-per-minute (TPM) deployment for overflow requests. Use a gateway to route requests to the TPM deployment when the PTU limits are reached.",
            "waf": "Performance"
        },
        {
            "category": "Operations Management",
            "checklist": "Azure OpenAI Review",
            "guid": "e8a13f98-8794-424d-9267-86d60b96c97b",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/concepts/models",
            "service": "Azure OpenAI",
            "services": [],
            "severity": "High",
            "subcategory": "Model choice",
            "text": "Choose the right model for the right task. Pick models with right tradeoff between speed, quality of response and output complexity",
            "waf": "Performance"
        },
        {
            "category": "Operations Management",
            "checklist": "Azure OpenAI Review",
            "guid": "e9951904-8384-45c9-a6cb-2912156a1147",
            "link": "https://github.com/Azure/azure-openai-benchmark/",
            "service": "Azure OpenAI",
            "services": [],
            "severity": "Medium",
            "subcategory": "Fine tuning",
            "text": "Have a baseline for performance without fine-tuning for knowing whether or not fine-tuning has improved model performance",
            "waf": "Performance"
        },
        {
            "category": "BC and DR",
            "checklist": "Azure OpenAI Review",
            "guid": "5e39f541-accc-4d97-a376-bcdb3750ab2a",
            "link": "https://learn.microsoft.com/azure/architecture/ai-ml/architecture/baseline-openai-e2e-chat#azure-openai---reliability",
            "service": "Azure OpenAI",
            "services": [
                "ACR"
            ],
            "severity": "Low",
            "subcategory": "Multi-region architecture",
            "text": "Deploy multiple OAI instances across regions",
            "waf": "Reliability"
        },
        {
            "category": "BC and DR",
            "checklist": "Azure OpenAI Review",
            "guid": "b039da6d-55d7-4c89-8adb-107d5325af62",
            "link": "https://learn.microsoft.com/azure/architecture/ai-ml/architecture/baseline-openai-e2e-chat#azure-openai---reliability",
            "service": "Azure OpenAI",
            "services": [
                "Entra",
                "APIM"
            ],
            "severity": "High",
            "subcategory": "Load balancing",
            "text": "Implement retry & healthchecks with Gateway pattern like APIM",
            "waf": "Reliability"
        },
        {
            "category": "BC and DR",
            "checklist": "Azure OpenAI Review",
            "guid": "5ca44e46-85e2-4223-ace8-bb12308ca5f1",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/quota?tabs=rest#introduction-to-quota",
            "service": "Azure OpenAI",
            "services": [],
            "severity": "Medium",
            "subcategory": "Quotas",
            "text": "Ensure having adequate quotas of TPM & RPM for the workload",
            "waf": "Reliability"
        },
        {
            "category": "Responsible AI",
            "checklist": "Azure OpenAI Review",
            "guid": "ec723923-7a15-42d6-ac5e-402925387e5c",
            "link": "https://www.microsoft.com/research/project/guidelines-for-human-ai-interaction/",
            "service": "Azure OpenAI",
            "services": [],
            "severity": "Medium",
            "subcategory": "UX best practice",
            "text": "Review the considerations in HAI toolkit guidance and apply those interaction practices for the slution",
            "waf": "Operational Excellence"
        },
        {
            "category": "BC and DR",
            "checklist": "Azure OpenAI Review",
            "guid": "7f154e3a-a369-4282-ae7e-316183687a04",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/business-continuity-disaster-recovery",
            "service": "Azure OpenAI",
            "services": [
                "ACR"
            ],
            "severity": "Medium",
            "subcategory": "Load balancing",
            "text": "Deploy separate fine tuned models across regions if finetuning is employed",
            "waf": "Reliability"
        },
        {
            "category": "BC and DR",
            "checklist": "Azure OpenAI Review",
            "guid": "77a1f893-5bda-4433-84f2-4811633182ba",
            "link": "https://learn.microsoft.com/azure/backup/backup-overview",
            "service": "Azure OpenAI",
            "services": [
                "ASR",
                "Backup"
            ],
            "severity": "Medium",
            "subcategory": "Data Backup and Disaster Recovery",
            "text": "Regularly backup and replicate critical data to ensure data availability and recoverability in case of data loss or system failures. Leverage Azure's backup and disaster recovery services to protect your data.",
            "waf": "Reliability"
        },
        {
            "category": "BC and DR",
            "checklist": "Azure OpenAI Review",
            "guid": "95b96ad8-844c-4e3b-8b38-b876ba2cf204",
            "link": "https://www.microsoft.com/licensing/docs/view/Service-Level-Agreements-SLA-for-Online-Services?lang=1",
            "service": "Azure OpenAI",
            "services": [],
            "severity": "High",
            "subcategory": "SLA considerations",
            "text": "Azure AI search service tiers should be choosen to have a SLA ",
            "waf": "Reliability"
        },
        {
            "category": "Governance and Security",
            "checklist": "Azure OpenAI Review",
            "guid": "99013a5d-3ce4-474d-acbd-8682a6abca2a",
            "link": "https://learn.microsoft.com/purview/purview",
            "service": "Azure OpenAI",
            "services": [],
            "severity": "Low",
            "subcategory": "Data Sensitivity",
            "text": "Classify data and sensitivity, labeling with Microsoft Purview before generating the embeddings and make sure to treat the embeddings generated with same sensitivity and classification",
            "waf": "Security"
        },
        {
            "category": "Governance and Security",
            "checklist": "Azure OpenAI Review",
            "guid": "4fda1dbf-3dd9-45d4-ac7c-891dca1f6d56",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/use-your-data-securely",
            "service": "Azure OpenAI",
            "services": [],
            "severity": "High",
            "subcategory": "Encryption at Rest",
            "text": "Encrypt data used for RAG with SSE/Disk encryption with optional BYOK",
            "waf": "Security"
        },
        {
            "category": "Governance and Security",
            "checklist": "Azure OpenAI Review",
            "guid": "59ae558b-937d-4498-9e11-12dbd7ba012f",
            "link": "https://learn.microsoft.com/azure/search/search-security-overview",
            "service": "Azure OpenAI",
            "services": [
                "ACR"
            ],
            "severity": "High",
            "subcategory": "Transit Encryption",
            "text": "Ensure TLS is enforced for data in transit across data sources, AI search used for Retrieval-Augmented Generation (RAG) and LLM communication",
            "waf": "Security"
        },
        {
            "category": "Governance and Security",
            "checklist": "Azure OpenAI Review",
            "guid": "7b94ef6e-047d-42ea-8992-b1cd6e2054b2",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/role-based-access-control",
            "service": "Azure OpenAI",
            "services": [
                "RBAC"
            ],
            "severity": "High",
            "subcategory": "Access Control",
            "text": "Use RBAC to manage access to Azure OpenAI services. Assign appropriate permissions to users and restrict access based on their roles and responsibilities",
            "waf": "Security"
        },
        {
            "category": "Governance and Security",
            "checklist": "Azure OpenAI Review",
            "guid": "9769e4a6-91e8-4838-ac93-6667e13c0056",
            "link": "https://learn.microsoft.com/azure/security/fundamentals/data-encryption-best-practices",
            "service": "Azure OpenAI",
            "services": [],
            "severity": "Medium",
            "subcategory": "Data Masking and Redaction",
            "text": "Implement data encryption,  masking or redaction techniques to hide sensitive data or replace it with obfuscated values in non-production environments or when sharing data for testing or troubleshooting purposes",
            "waf": "Security"
        },
        {
            "category": "Governance and Security",
            "checklist": "Azure OpenAI Review",
            "guid": "74b1e945-b459-4837-be7a-d6c6d3b375a5",
            "link": "https://learn.microsoft.com/azure/defender-for-cloud/defender-for-cloud-introduction",
            "service": "Azure OpenAI",
            "services": [
                "Sentinel",
                "Monitor",
                "Defender"
            ],
            "severity": "High",
            "subcategory": "Threat Detection and Monitoring",
            "text": "Utilize Azure Defender to detect and respond to security threats and set up monitoring and alerting mechanisms to identify suspicious activities or breaches. Leverage Azure Sentinel for advanced threat detection and response",
            "waf": "Security"
        },
        {
            "category": "Governance and Security",
            "checklist": "Azure OpenAI Review",
            "guid": "c7acbe48-abe5-44cd-99f2-e87768468c55",
            "link": "https://techcommunity.microsoft.com/t5/azure-storage-blog/managing-long-term-log-retention-or-any-business-data/ba-p/2494791",
            "service": "Azure OpenAI",
            "services": [
                "AzurePolicy"
            ],
            "severity": "Medium",
            "subcategory": "Data Retention and Disposal",
            "text": "Establish data retention and disposal policies to adhere to compliance regulations. Implement secure deletion methods for data that is no longer required and maintain an audit trail of data retention and disposal activities",
            "waf": "Security"
        },
        {
            "category": "Responsible AI",
            "checklist": "Azure OpenAI Review",
            "guid": "a9c27d9c-42bb-46bd-8c69-99a246f3389a",
            "link": "https://learn.microsoft.com/azure/ai-services/content-safety/concepts/jailbreak-detection",
            "service": "Azure OpenAI",
            "services": [],
            "severity": "High",
            "subcategory": "Jail break Safety",
            "text": "Implement Prompt shields and groundedness detection using Content Safety ",
            "waf": "Operational Excellence"
        },
        {
            "category": "Governance and Security",
            "checklist": "Azure OpenAI Review",
            "guid": "a775c6ee-95b9-46ad-a844-ce3b2b38b876",
            "link": "https://learn.microsoft.com/azure/compliance/",
            "service": "Azure OpenAI",
            "services": [],
            "severity": "High",
            "subcategory": "Data Privacy and Compliance",
            "text": "Ensure compliance with relevant data protection regulations, such as GDPR or HIPAA, by implementing privacy controls and obtaining necessary consents or permissions for data processing activities.",
            "waf": "Security"
        },
        {
            "category": "Governance and Security",
            "checklist": "Azure OpenAI Review",
            "guid": "ba2cf204-9901-43a5-b3ce-474dccbd8682",
            "service": "Azure OpenAI",
            "services": [],
            "severity": "Medium",
            "subcategory": "Employee Awareness and Training",
            "text": "Educate your employees about data security best practices, the importance of handling data securely, and potential risks associated with data breaches. Encourage them to follow data security protocols diligently.",
            "waf": "Security"
        },
        {
            "category": "Governance and Security",
            "checklist": "Azure OpenAI Review",
            "guid": "eae01e6e-842e-452f-9721-d928c1b1cd52",
            "service": "Azure OpenAI",
            "services": [],
            "severity": "High",
            "subcategory": "Environment segregation",
            "text": "Keep production data separate from development and testing data. Only use real sensitive data in production and utilize anonymized or synthetic data in development and test environments.",
            "waf": "Security"
        },
        {
            "category": "Governance and Security",
            "checklist": "Azure OpenAI Review",
            "guid": "1e54a29a-9de3-499c-bd7b-28dc93555620",
            "service": "Azure OpenAI",
            "services": [],
            "severity": "Medium",
            "subcategory": "Index Segregation",
            "text": "If you have varying levels of data sensitivity, consider creating separate indexes for each level. For instance, you could have one index for general data and another for sensitive data, each governed by different access protocols",
            "waf": "Security"
        },
        {
            "category": "Governance and Security",
            "checklist": "Azure OpenAI Review",
            "guid": "2bfe4564-b0d8-434a-948b-263e6dd60512",
            "service": "Azure OpenAI",
            "services": [
                "AzurePolicy",
                "RBAC"
            ],
            "severity": "Medium",
            "subcategory": "Sensitive Data in Separate Instances",
            "text": "Take segregation a step further by placing sensitive datasets in different instances of the service. Each instance can be controlled with its own specific set of RBAC policies",
            "waf": "Security"
        },
        {
            "category": "Governance and Security",
            "checklist": "Azure OpenAI Review",
            "guid": "a36498f6-dbad-438e-ad53-cc7ce1d7aaab",
            "service": "Azure OpenAI",
            "services": [],
            "severity": "High",
            "subcategory": "Embedding and Vector handling",
            "text": "Recognize that embeddings and vectors generated from sensitive information are themselves sensitive. This data should be afforded the same protective measures as the source material",
            "waf": "Security"
        },
        {
            "category": "Governance and Security",
            "checklist": "Azure OpenAI Review",
            "guid": "3571449a-b805-43d8-af89-dc7b33be2a1a",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/role-based-access-control",
            "service": "Azure OpenAI",
            "services": [
                "RBAC"
            ],
            "severity": "High",
            "subcategory": "Access control",
            "text": "Apply RBAC to th data stores having embeddings and vectors and scope access based on role's access requirements",
            "waf": "Security"
        },
        {
            "category": "Governance and Security",
            "checklist": "Azure OpenAI Review",
            "guid": "27f7b9e9-1be1-4f38-aef3-9812bd463cbb",
            "link": "https://techcommunity.microsoft.com/t5/azure-architecture-blog/azure-openai-private-endpoints-connecting-across-vnet-s/ba-p/3913325",
            "service": "Azure OpenAI",
            "services": [
                "PrivateLink"
            ],
            "severity": "High",
            "subcategory": "Network security",
            "text": "Configure private endpoint for AI services to restrict service access within your network",
            "waf": "Security"
        },
        {
            "category": "Governance and Security",
            "checklist": "Azure OpenAI Review",
            "guid": "ac8ac199-ebb9-41a3-9d90-cae2cc881370",
            "service": "Azure OpenAI",
            "services": [
                "VNet",
                "Firewall"
            ],
            "severity": "High",
            "subcategory": "Network security",
            "text": "Enforce strict inbound and outbound traffic control with Azure Firewall and UDRs and limit the external integration points",
            "waf": "Security"
        },
        {
            "category": "Governance and Security",
            "checklist": "Azure OpenAI Review",
            "guid": "6f7c0cba-fe51-4464-add4-57e927138b82",
            "service": "Azure OpenAI",
            "services": [],
            "severity": "High",
            "subcategory": "Control Network Access",
            "text": "Implement network segmentation and access controls to restrict access to the LLM application only to authorized users and systems and prevent lateral movement",
            "waf": "Security"
        },
        {
            "category": "Cost Optimization",
            "checklist": "Azure OpenAI Review",
            "guid": "7f42c78e-78cb-46a2-8ad1-90916e6a8d8f",
            "link": "https://www.microsoft.com/research/blog/llmlingua-innovating-llm-efficiency-with-prompt-compression/",
            "service": "Azure OpenAI",
            "services": [
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Token Optimization",
            "text": "Use prompt compression tools like LLMLingua or gprtrim",
            "waf": "Cost Optimization"
        },
        {
            "category": "Governance and Security",
            "checklist": "Azure OpenAI Review",
            "guid": "1102cac6-eae0-41e6-b842-e52f4721d928",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/managed-identity",
            "service": "Azure OpenAI",
            "services": [
                "AKV",
                "Entra"
            ],
            "severity": "High",
            "subcategory": "Secure APIs and Endpoints",
            "text": "Ensure that APIs and endpoints used by the LLM application are properly secured with authentication and authorization mechanisms, such as Managed identities,  API keys or OAuth, to prevent unauthorized access.",
            "waf": "Security"
        },
        {
            "category": "Governance and Security",
            "checklist": "Azure OpenAI Review",
            "guid": "c1b1cd52-1e54-4a29-a9de-399cfd7b28dc",
            "link": "https://techcommunity.microsoft.com/t5/azure-architecture-blog/security-best-practices-for-genai-applications-openai-in-azure/ba-p/4027885",
            "service": "Azure OpenAI",
            "services": [],
            "severity": "Medium",
            "subcategory": "Implement Strong Authentication",
            "text": "Enforce strong end user authentication mechanisms, such as multi-factor authentication, to prevent unauthorized access to the LLM application and associated network resources",
            "waf": "Security"
        },
        {
            "category": "Governance and Security",
            "checklist": "Azure OpenAI Review",
            "guid": "93555620-2bfe-4456-9b0d-834a348b263e",
            "service": "Azure OpenAI",
            "services": [
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Use Network Monitoring",
            "text": "Implement network monitoring tools to detect and analyze network traffic for any suspicious or malicious activities. Enable logging to capture network events and facilitate forensic analysis in case of security incidents",
            "waf": "Security"
        },
        {
            "category": "Governance and Security",
            "checklist": "Azure OpenAI Review",
            "guid": "6dd60512-a364-498f-9dba-d38ead53cc7c",
            "service": "Azure OpenAI",
            "services": [],
            "severity": "Medium",
            "subcategory": "Security Audits and Penetration Testing",
            "text": "Conduct security audits and penetration testing to identify and address any network security weaknesses or vulnerabilities in the LLM application's network infrastructure",
            "waf": "Security"
        },
        {
            "category": "Governance and Security",
            "checklist": "Azure OpenAI Review",
            "guid": "e1d7aaab-3571-4449-ab80-53d89f89dc7b",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/tag-resources?tabs=json",
            "service": "Azure OpenAI",
            "services": [],
            "severity": "Low",
            "subcategory": "Infrastructure Deployment",
            "text": "Azure AI Services are properly tagged for better management",
            "waf": "Operational Excellence"
        },
        {
            "category": "Governance and Security",
            "checklist": "Azure OpenAI Review",
            "guid": "77036e5e-6b4b-4ed3-b503-547c1347dc56",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/resource-abbreviations",
            "service": "Azure OpenAI",
            "services": [],
            "severity": "Low",
            "subcategory": "Infrastructure Deployment",
            "text": "Azure AI Service accounts follows organizational naming conventions",
            "waf": "Operational Excellence"
        },
        {
            "category": "Governance and Security",
            "checklist": "Azure OpenAI Review",
            "guid": "028a71ff-e1ce-415d-b3f0-d5e772d41e36",
            "link": "https://learn.microsoft.com/azure/ai-services/diagnostic-logging",
            "service": "Azure OpenAI",
            "services": [],
            "severity": "High",
            "subcategory": "Diagnostics Logging",
            "text": "Diagnostic logs in Azure AI services resources should be enabled",
            "waf": "Operational Excellence"
        },
        {
            "category": "Identity and Access Management",
            "checklist": "Azure OpenAI Review",
            "guid": "11cc57b4-a4b1-4410-b439-58a8c2289b3d",
            "link": "https://learn.microsoft.com/azure/ai-services/authentication",
            "service": "Azure OpenAI",
            "services": [
                "Entra"
            ],
            "severity": "High",
            "subcategory": "Entra ID based access",
            "text": "Key access (local authentication) is recommended to be disabled for security.  After disabling key based access, Microsoft Entra ID becomes the only access method, which allows maintaining minimum privilege principle and granular control. ",
            "waf": "Security"
        },
        {
            "category": "Governance and Security",
            "checklist": "Azure OpenAI Review",
            "guid": "6b57cfc6-5546-41e1-a3e3-453a3c863964",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Azure OpenAI",
            "services": [
                "AKV",
                "Entra"
            ],
            "severity": "High",
            "subcategory": "Secure Key Management",
            "text": "Store and manage keys securely using Azure Key Vault. Avoid hard-coding or embedding sensitive keys within your LLM application's code and retrieve them securely from Azure Key Vault using managed identities",
            "waf": "Security"
        },
        {
            "category": "Governance and Security",
            "checklist": "Azure OpenAI Review",
            "guid": "8b652d6c-15f5-4129-9539-8e6ded227dd1",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Azure OpenAI",
            "services": [
                "AKV"
            ],
            "severity": "High",
            "subcategory": "Key Rotation and Expiration",
            "text": "Regularly rotate and expire keys stored in Azure Key Vault to minimize the risk of unauthorized access.",
            "waf": "Security"
        },
        {
            "category": "Cost Optimization",
            "checklist": "Azure OpenAI Review",
            "guid": "adfe27be-e297-401a-a352-baaab79b088d",
            "link": "https://github.com/openai/tiktoken",
            "service": "Azure OpenAI",
            "services": [
                "Cost"
            ],
            "severity": "High",
            "subcategory": "Token Optimization",
            "text": "Use tiktoken to understand token sizes for token optimizations in conversational mode",
            "waf": "Cost Optimization"
        },
        {
            "category": "Governance and Security",
            "checklist": "Azure OpenAI Review",
            "guid": "42b06c21-d799-49a6-96f4-389a7f42c78e",
            "link": "https://learn.microsoft.com/azure/security/develop/secure-dev-overview",
            "service": "Azure OpenAI",
            "services": [],
            "severity": "High",
            "subcategory": "Secure coding practice",
            "text": "Follow secure coding practices to prevent common vulnerabilities such as injection attacks, cross-site scripting (XSS), or security misconfigurations",
            "waf": "Security"
        },
        {
            "category": "Governance and Security",
            "checklist": "Azure OpenAI Review",
            "guid": "78c06a73-a22a-4495-9e6a-8dc4a20e27c3",
            "link": "https://learn.microsoft.com/azure/devops/repos/security/github-advanced-security-dependency-scanning?view=azure-devops",
            "service": "Azure OpenAI",
            "services": [],
            "severity": "High",
            "subcategory": "Patching and updates",
            "text": "Setup a process to regularly update and patch the LLM libraries and other system components",
            "waf": "Security"
        },
        {
            "category": "Responsible AI",
            "checklist": "Azure OpenAI Review",
            "guid": "e29711b1-352b-4eee-879b-588defc4972c",
            "link": "https://learn.microsoft.com/legal/cognitive-services/openai/code-of-conduct",
            "service": "Azure OpenAI",
            "services": [
                "AzurePolicy"
            ],
            "severity": "High",
            "subcategory": "Governance",
            "text": "Adhere to Azure OpenAI or other LLMs terms of use, policies and guidance and allowed use cases",
            "waf": "Operational Excellence"
        },
        {
            "category": "Cost Optimization",
            "checklist": "Azure OpenAI Review",
            "guid": "d3cd21bf-7703-46e5-b6b4-bed3d503547c",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/manage-costs#base-series-and-codex-series-fine-tuned-models",
            "service": "Azure OpenAI",
            "services": [
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Cost familiarization",
            "text": "Understand difference in cost of base models and fine tuned models and token step sizes",
            "waf": "Cost Optimization"
        },
        {
            "category": "Cost Optimization",
            "checklist": "Azure OpenAI Review",
            "guid": "1347dc56-028a-471f-be1c-e15dd3f0d5e7",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/latency#batching",
            "service": "Azure OpenAI",
            "services": [
                "Cost"
            ],
            "severity": "High",
            "subcategory": "Batch processing",
            "text": "Batch requests, where possible, to minimize the per-call overhead which can reduce overall costs. Ensure you optimize batch size",
            "waf": "Cost Optimization"
        },
        {
            "category": "Cost Optimization",
            "checklist": "Azure OpenAI Review",
            "guid": "72d41e36-11cc-457b-9a4b-1410d43958a8",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/manage-costs",
            "service": "Azure OpenAI",
            "services": [
                "Monitor",
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Cost monitoring",
            "text": "Set up a cost tracking system that monitors model usage and use that information to help inform model choices and prompt sizes",
            "waf": "Cost Optimization"
        },
        {
            "category": "Cost Optimization",
            "checklist": "Azure OpenAI Review",
            "guid": "166cd072-af9b-4141-a898-a535e737897e",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/quota?tabs=rest#understanding-rate-limits",
            "service": "Azure OpenAI",
            "services": [
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Token limit",
            "text": "Set a maximum limit on the number of tokens per model response (max_tokens and the number of completions to generate). Optimize the size to ensure it is large enough for a valid response",
            "waf": "Cost Optimization"
        },
        {
            "category": "Operations Management",
            "checklist": "Azure OpenAI Review",
            "guid": "71ca7da8-cfa9-462a-8594-946da97dc3a2",
            "link": "https://learn.microsoft.com/azure/search/search-reliability",
            "service": "Azure OpenAI",
            "services": [],
            "severity": "Medium",
            "subcategory": "AI Search Reliability",
            "text": "Review the guidance provided on setting up AI search for Reliability",
            "waf": "Operational Excellence"
        },
        {
            "category": "Operations Management",
            "checklist": "Azure OpenAI Review",
            "guid": "3266b225-86f4-4a16-92bd-ddea8a487cde",
            "link": "https://learn.microsoft.com/azure/search/vector-search-index-size?tabs=portal-vector-quota",
            "service": "Azure OpenAI",
            "services": [
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "AI Search Vector Limits",
            "text": "Plan and manage AI Search Vector storage",
            "waf": "Operational Excellence"
        },
        {
            "category": "Operations Management",
            "checklist": "Azure OpenAI Review",
            "guid": "b4861bc3-bc14-4aeb-9e66-e8d9a3aec218",
            "link": "https://learn.microsoft.com/azure/machine-learning/prompt-flow/how-to-end-to-end-llmops-with-prompt-flow?view=azureml-api-2",
            "service": "Azure OpenAI",
            "services": [
                "ACR"
            ],
            "severity": "Medium",
            "subcategory": "DevOps",
            "text": "Ensure deployment of Azure OpenAI instances across your various environments, such as development, test, and production supporting lrarning & experimentation. Apply LLMOps practices to automate the lifecycle management of your GenAI applications",
            "waf": "Operational Excellence"
        },
        {
            "category": "Cost Optimization",
            "checklist": "Azure OpenAI Review",
            "guid": "aa80932c-8ec9-4d1b-a770-26e5e6beba9e",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/provisioned-throughput-onboarding#understanding-the-provisioned-throughput-purchase-model",
            "service": "Azure OpenAI",
            "services": [
                "Cost",
                "Storage"
            ],
            "severity": "High",
            "subcategory": "Costing Model",
            "text": "Evaluate usage of billing models - PAYG vs PTU. Start with PAYG and consider PTU when the usage is predictable in production since it offers dedicated memory and compute, reserved capacity, and consistent maximum latency for the specified model version",
            "waf": "Cost Optimization"
        },
        {
            "category": "Operations Management",
            "checklist": "Azure OpenAI Review",
            "guid": "e6436b07-36db-455f-9796-03334bdf9cc2",
            "link": "https://techcommunity.microsoft.com/t5/ai-azure-ai-services-blog/how-to-control-azure-openai-models/ba-p/4146793",
            "service": "Azure OpenAI",
            "services": [],
            "severity": "Medium",
            "subcategory": "DevOps",
            "text": "Evaluate the quality of  prompts and applications when switching between model versions",
            "waf": "Operational Excellence"
        },
        {
            "category": "Operations Management",
            "checklist": "Azure OpenAI Review",
            "guid": "3418db61-2712-4650-9bb4-7a393a080327",
            "link": "https://learn.microsoft.com/azure/machine-learning/prompt-flow/concept-model-monitoring-generative-ai-evaluation-metrics?view=azureml-api-2",
            "service": "Azure OpenAI",
            "services": [
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Development",
            "text": "Evaluate, monitor and refine your GenAI apps for features like groundedness, relevance, accuracy, coherence and fluency",
            "waf": "Operational Excellence"
        },
        {
            "category": "Operations Management",
            "checklist": "Azure OpenAI Review",
            "guid": "294798b1-578b-4219-a46c-eb5443513592",
            "service": "Azure OpenAI",
            "services": [],
            "severity": "Medium",
            "subcategory": "Development",
            "text": "Evaluate your Azure AI Search results based on different search parameters",
            "waf": "Operational Excellence"
        },
        {
            "category": "Operations Management",
            "checklist": "Azure OpenAI Review",
            "guid": "2744293b-b628-4537-a551-19b08e8f5854",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/concepts/fine-tuning-considerations",
            "service": "Azure OpenAI",
            "services": [],
            "severity": "Medium",
            "subcategory": "Development",
            "text": "Look at fine tuning models as way of increasing accuracy only when you have tried other basic approaches like prompt engineering and RAG with your data",
            "waf": "Operational Excellence"
        },
        {
            "category": "Operations Management",
            "checklist": "Azure OpenAI Review",
            "guid": "287d9cec-166c-4d07-8af9-b141a898a535",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/concepts/advanced-prompt-engineering?pivots=programming-language-chat-completions",
            "service": "Azure OpenAI",
            "services": [],
            "severity": "Medium",
            "subcategory": "Development",
            "text": "Use prompt engineering techniques to improve the accuracy of LLM responses",
            "waf": "Operational Excellence"
        },
        {
            "category": "Governance and Security",
            "checklist": "Azure OpenAI Review",
            "guid": "e737897e-71ca-47da-acfa-962a1594946d",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/concepts/red-teaming",
            "service": "Azure OpenAI",
            "services": [],
            "severity": "Medium",
            "subcategory": "Security Audits and Penetration Testing",
            "text": "Red team your GenAI applications",
            "waf": "Security"
        },
        {
            "category": "Operations Management",
            "checklist": "Azure OpenAI Review",
            "guid": "edb117e6-76aa-4f66-aca4-8e5a95f2223e",
            "link": "https://www.microsoft.com/haxtoolkit/guideline/encourage-granular-feedback/",
            "service": "Azure OpenAI",
            "services": [],
            "severity": "Medium",
            "subcategory": "End user feedback",
            "text": "Provide end users with scoring options for LLM responses and track these scores. ",
            "waf": "Operational Excellence"
        },
        {
            "category": "Cost Optimization",
            "checklist": "Azure OpenAI Review",
            "guid": "d5f3547c-c346-4d81-9028-a71ffe1b9b5d",
            "link": "https://techcommunity.microsoft.com/t5/fasttrack-for-azure/optimizing-azure-openai-a-guide-to-limits-quotas-and-best/ba-p/4076268",
            "service": "Azure OpenAI",
            "services": [
                "Cost"
            ],
            "severity": "High",
            "subcategory": "Quota Management",
            "text": "Consider Quota management practices. Use dynamic quota for certain use cases when your application can use extra capacity opportunistically or the application itself is driving the rate at which the Azure OpenAI API is called",
            "waf": "Cost Optimization"
        },
        {
            "category": "Operations Management",
            "checklist": "Azure OpenAI Review",
            "guid": "9de0d5d7-31d4-41e3-911c-817bfafbc410",
            "link": "https://github.com/Azure/aoai-apim/blob/main/README.md",
            "service": "Azure OpenAI",
            "services": [
                "Entra",
                "ACR",
                "LoadBalancer",
                "APIM"
            ],
            "severity": "Medium",
            "subcategory": "Load Balancing",
            "text": "Use Load balancer solutions like APIM based gateway for balancing load and capacity across services and regions",
            "waf": "Operational Excellence"
        },
        {
            "category": "Operations Management",
            "checklist": "Azure OpenAI Review",
            "guid": "9de0d5d7-31d4-41e3-911c-817bfafbc411",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/fine-tuning?tabs=turbo%2Cpython-new&pivots=programming-language-studio#import-training-data-from-azure-blob-store",
            "service": "Azure OpenAI",
            "services": [
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Fine tuning",
            "text": "Follow the guidance for fine-tuning with large data files and import the data from an Azure blob store. Large files, 100 MB or larger, can become unstable when uploaded through multipart forms because the requests are atomic and can't be retried or resumed",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Azure OpenAI Review",
            "guid": "9de0d5d7-31d4-41e3-911c-817bfafbc412",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/quota?tabs=rest",
            "service": "Azure OpenAI",
            "services": [
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Monitoring",
            "text": "Manage rate limits for your model deployments and monitor usage of tokens per minute (TPM) and requests per minute (RPM) for pay-as-you-go deployments",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "Azure OpenAI Review",
            "guid": "9de0d5d7-31d4-41e3-911c-817bfafbc413",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/monitor-openai",
            "service": "Azure OpenAI",
            "services": [
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Monitoring",
            "text": "Monitor provision-managed utilization if you're using the provisioned throughput payment model",
            "waf": "Reliability"
        },
        {
            "category": "Responsible AI",
            "checklist": "Azure OpenAI Review",
            "guid": "9de0d5d7-31d4-41e3-911c-817bfafbc414",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/content-filters",
            "service": "Azure OpenAI",
            "services": [],
            "severity": "Medium",
            "subcategory": "Content Safety",
            "text": "Tune content filters to minimize false positives from overly aggressive filters",
            "waf": "Reliability"
        },
        {
            "category": "Governance and Security",
            "checklist": "Azure OpenAI Review",
            "guid": "9de0d5d7-31d4-41e3-911c-817bfafbc415",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/encrypt-data-at-rest",
            "service": "Azure OpenAI",
            "services": [
                "AKV"
            ],
            "severity": "Medium",
            "subcategory": "Key Management",
            "text": "Use customer-managed keys for fine-tuned models and training data that's uploaded to Azure OpenAI",
            "waf": "Security"
        },
        {
            "category": "Governance and Security",
            "checklist": "Azure OpenAI Review",
            "guid": "9de0d5d7-31d4-41e3-911c-817bfafbc416",
            "link": "https://learn.microsoft.com/azure/ai-services/content-safety/concepts/jailbreak-detection",
            "service": "Azure OpenAI",
            "services": [
                "LoadBalancer"
            ],
            "severity": "Medium",
            "subcategory": "Jailbreak protection",
            "text": "Implement jailbreak risk detection to safeguard your language model deployments against prompt injection attacks",
            "waf": "Security"
        },
        {
            "category": "Governance and Security",
            "checklist": "Azure OpenAI Review",
            "guid": "9de0d5d7-31d4-41e3-911c-817bfafbc417",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/monitor-openai",
            "service": "Azure OpenAI",
            "services": [],
            "severity": "Medium",
            "subcategory": "Quota exhaustion",
            "text": "Use security controls like throttling, service isolation and gateway pattern to prevent attacks that might exhaust model usage quotas",
            "waf": "Security"
        },
        {
            "category": "Cost Optimization",
            "checklist": "Azure OpenAI Review",
            "guid": "72d41e36-11cc-457b-9a4b-1410d43958a9",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/manage-costs",
            "service": "Azure OpenAI",
            "services": [
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Cost estimation",
            "text": "Develop your cost model, considering prompt sizes. Understanding prompt input and response sizes and how text translates into tokens helps you create a viable cost model",
            "waf": "Cost Optimization"
        },
        {
            "category": "Cost Optimization",
            "checklist": "Azure OpenAI Review",
            "guid": "72d41e36-11cc-457b-9a4b-1410d43958a1",
            "link": "https://azure.microsoft.com/pricing/details/cognitive-services/openai-service/",
            "service": "Azure OpenAI",
            "services": [
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Model selection",
            "text": "Consider model pricing and capabilities when you choose models. Start with less-costly models for less-complex tasks like text generation or completion tasks and for complex tasks like language translation or content understanding, consider using more advanced models. Optimize costs while still achieving the desired application performance",
            "waf": "Cost Optimization"
        },
        {
            "category": "Cost Optimization",
            "checklist": "Azure OpenAI Review",
            "guid": "72d41e36-11cc-457b-9a4b-1410d43958a2",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/manage-costs",
            "service": "Azure OpenAI",
            "services": [
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Usage Optimization",
            "text": "Maximize Azure OpenAI price breakpoints like fine-tuning and model breakpoints like image generation to your advantage. Fine-tuning is charged per hour, use as much time as you have available per hour to improve results without slipping into the next billing period. The cost for generating 100 images is the same as the cost for 1 image",
            "waf": "Cost Optimization"
        },
        {
            "category": "Cost Optimization",
            "checklist": "Azure OpenAI Review",
            "guid": "72d41e36-11cc-457b-9a4b-1410d43958a3",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/manage-costs",
            "service": "Azure OpenAI",
            "services": [
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Usage Optimization",
            "text": "Remove unused fine-tuned models when they're no longer being consumed to avoid incurring an ongoing hosting fee",
            "waf": "Cost Optimization"
        },
        {
            "category": "Cost Optimization",
            "checklist": "Azure OpenAI Review",
            "guid": "7f42c78e-78cb-46a2-8ad1-90916e6a8d8g",
            "link": "https://learn.microsoft.com/azure/ai-services/openai/how-to/manage-costs",
            "service": "Azure OpenAI",
            "services": [
                "Cost"
            ],
            "severity": "Medium",
            "subcategory": "Token Optimization",
            "text": "Create concise prompts that provide enough context for the model to generate a useful response. Also ensure that you optimize the limit of the response length.",
            "waf": "Cost Optimization"
        },
        {
            "category": "Operations Management",
            "checklist": "Azure OpenAI Review",
            "guid": "b4861bc3-bc14-4aeb-9e66-e8d9a3aec219",
            "link": "https://learn.microsoft.com/azure/ai-services/create-account-bicep",
            "service": "Azure OpenAI",
            "services": [],
            "severity": "Medium",
            "subcategory": "IaC",
            "text": "Use infrastructure as code (IaC) to deploy Azure OpenAI, model deployments, and other infrastructure required for fine-tuning models",
            "waf": "Operational Excellence"
        },
        {
            "category": "Operations Management",
            "checklist": "Azure OpenAI Review",
            "guid": "2744293b-b628-4537-a551-19b08e8f5855",
            "link": "https://learn.microsoft.com/azure/architecture/guide/multitenant/service/openai",
            "service": "Azure OpenAI",
            "services": [],
            "severity": "Medium",
            "subcategory": "Development",
            "text": "Consider using dedicated model deployments per consumer group to provide per-model usage isolation that can help prevent noisy neighbors between your consumer groups",
            "waf": "Operational Excellence"
        },
        {
            "category": "Governance",
            "checklist": "Azure API Management Review",
            "guid": "d7941d4a-7b6f-458f-8714-2f8f8c059ad4",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-error-handling-policies",
            "service": "APIM",
            "services": [
                "AzurePolicy",
                "APIM"
            ],
            "severity": "Medium",
            "subcategory": "Development best practices",
            "text": "Implement an error handling policy at the global level",
            "waf": "Operations"
        },
        {
            "category": "Governance",
            "checklist": "Azure API Management Review",
            "guid": "0b0c0765-ff37-4369-90bd-3eb23ce71b08",
            "link": "https://learn.microsoft.com/azure/api-management/set-edit-policies?tabs=form#use-base-element-to-set-policy-evaluation-order",
            "service": "APIM",
            "services": [
                "AzurePolicy",
                "APIM"
            ],
            "severity": "Medium",
            "subcategory": "Development best practices",
            "text": "Ensure all APIs policies include a <base/> element.",
            "waf": "Operations"
        },
        {
            "category": "Governance",
            "checklist": "Azure API Management Review",
            "guid": "a5c45b03-93b6-42fe-b16b-8fccb6a79902",
            "link": "https://learn.microsoft.com/azure/api-management/policy-fragments",
            "service": "APIM",
            "services": [
                "AzurePolicy",
                "ACR",
                "APIM"
            ],
            "severity": "Medium",
            "subcategory": "Development best practices",
            "text": "Use Policy Fragments to avoid repeating same policies definitions across multiple APIs",
            "waf": "Operations"
        },
        {
            "category": "Governance",
            "checklist": "Azure API Management Review",
            "guid": "c3818a95-6ff3-4474-88dc-e809b46dad6a",
            "link": "https://learn.microsoft.com/azure/api-management/monetization-support",
            "service": "APIM",
            "services": [
                "APIM"
            ],
            "severity": "Medium",
            "subcategory": "Monetization",
            "text": "If you are planning to monetize your APIs, review the 'monetization support' article for best practices",
            "waf": "Operations"
        },
        {
            "category": "Governance",
            "checklist": "Azure API Management Review",
            "guid": "a7d0840a-c8c4-4e83-adec-5ca578eb4049",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-use-azure-monitor#resource-logs",
            "service": "APIM",
            "services": [
                "Monitor",
                "APIM"
            ],
            "severity": "High",
            "subcategory": "Monitoring",
            "text": "Enable Diagnostics Settings to export logs to Azure Monitor",
            "waf": "Operations"
        },
        {
            "category": "Governance",
            "checklist": "Azure API Management Review",
            "guid": "8691fa38-45ed-4299-a247-fecd98d35deb",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-app-insights",
            "service": "APIM",
            "services": [
                "Monitor",
                "APIM"
            ],
            "severity": "Medium",
            "subcategory": "Monitoring",
            "text": "Enable Application Insights for more detailed telemetry",
            "waf": "Operations"
        },
        {
            "category": "Governance",
            "checklist": "Azure API Management Review",
            "guid": "55fd27bb-76ac-4a91-bc37-049e885be6b7",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-use-azure-monitor",
            "service": "APIM",
            "services": [
                "Monitor",
                "APIM"
            ],
            "severity": "High",
            "subcategory": "Monitoring",
            "text": "Configure alerts on the most critical metrics",
            "waf": "Operations"
        },
        {
            "category": "Identity and Access Management",
            "checklist": "Azure API Management Review",
            "guid": "39460bdb-156f-4dc2-a87f-1e8c11ab0998",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/api-management-security-baseline?toc=%2Fazure%2Fapi-management%2F&bc=%2Fazure%2Fapi-management%2Fbreadcrumb%2Ftoc.json#certificate-management-in-azure-key-vault",
            "service": "APIM",
            "services": [
                "AKV",
                "Entra",
                "APIM"
            ],
            "severity": "High",
            "subcategory": "Data protection",
            "text": "Ensure that custom SSL certificates are stored an Azure Key Vault so they can be securely accessed and updated",
            "waf": "Security"
        },
        {
            "category": "Identity and Access Management",
            "checklist": "Azure API Management Review",
            "guid": "e9217997-5f6c-479d-8576-8f2adf706ec8",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/api-management-security-baseline?toc=%2Fazure%2Fapi-management%2F&bc=%2Fazure%2Fapi-management%2Fbreadcrumb%2Ftoc.json#azure-ad-authentication-required-for-data-plane-access",
            "service": "APIM",
            "services": [
                "Entra",
                "APIM"
            ],
            "severity": "High",
            "subcategory": "Identity",
            "text": "Protect incoming requests to APIs (data plane) with Azure AD",
            "waf": "Security"
        },
        {
            "category": "Identity and Access Management",
            "checklist": "Azure API Management Review",
            "guid": "5e5f64ba-c90e-480e-8888-398d96cf0bfb",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-aad",
            "service": "APIM",
            "services": [
                "Entra",
                "APIM"
            ],
            "severity": "Medium",
            "subcategory": "Identity",
            "text": "Use Microsoft Entra ID to authenticate users in the Developer Portal",
            "waf": "Security"
        },
        {
            "category": "Identity and Access Management",
            "checklist": "Azure API Management Review",
            "guid": "f8e574ce-280f-49c8-b2ef-68279b081cf3",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-create-groups",
            "service": "APIM",
            "services": [
                "Entra",
                "APIM"
            ],
            "severity": "Medium",
            "subcategory": "Privileged access",
            "text": "Create appropriate groups to control the visibility of the products",
            "waf": "Security"
        },
        {
            "category": "Management",
            "checklist": "Azure API Management Review",
            "guid": "06862505-2d9a-4874-9491-2837b00a3475",
            "link": "https://learn.microsoft.com/azure/api-management/backends",
            "service": "APIM",
            "services": [
                "APIM"
            ],
            "severity": "Medium",
            "subcategory": "Best practices",
            "text": "Use Backends feature to eliminate redundant API backend configurations",
            "waf": "Operations"
        },
        {
            "category": "Management",
            "checklist": "Azure API Management Review",
            "guid": "03b125d5-b69b-4739-b7fd-84b86da4933e",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-properties?tabs=azure-portal",
            "service": "APIM",
            "services": [
                "AzurePolicy",
                "APIM"
            ],
            "severity": "Medium",
            "subcategory": "Best practices",
            "text": "Use Named Values to store common values that can be used in policies",
            "waf": "Operations"
        },
        {
            "category": "Management",
            "checklist": "Azure API Management Review",
            "guid": "beae759e-4ddb-4326-bf26-47f87d3454b6",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-deploy-multi-region",
            "service": "APIM",
            "services": [
                "ACR",
                "ASR",
                "APIM"
            ],
            "severity": "Medium",
            "subcategory": "Business continuity and disaster recovery",
            "text": "For DR, leverage the premium tier with deployments scaled across two or more regions for 99.99% SLA",
            "waf": "Reliability"
        },
        {
            "category": "Management",
            "checklist": "Azure API Management Review",
            "guid": "9c8d1664-dd9a-49d4-bd83-950af0af4044",
            "link": "https://learn.microsoft.com/azure/api-management/high-availability",
            "service": "APIM",
            "services": [
                "ASR",
                "APIM"
            ],
            "severity": "Medium",
            "subcategory": "Business continuity and disaster recovery",
            "text": "Deploy at least one unit in two or more availability zones for an increased SLA of 99.99%",
            "waf": "Reliability"
        },
        {
            "category": "Management",
            "checklist": "Azure API Management Review",
            "guid": "8d2db6e8-85c6-4118-a52c-ae76a4f27934",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/api-management-security-baseline?toc=%2Fazure%2Fapi-management%2F&bc=%2Fazure%2Fapi-management%2Fbreadcrumb%2Ftoc.json#service-native-backup-capability",
            "service": "APIM",
            "services": [
                "Backup",
                "ASR",
                "APIM"
            ],
            "severity": "High",
            "subcategory": "Business continuity and disaster recovery",
            "text": "Ensure there is an automated backup routine",
            "waf": "Reliability"
        },
        {
            "category": "Management",
            "checklist": "Azure API Management Review",
            "guid": "43e60b94-7bca-43a2-aadf-efb04d63a485",
            "link": "https://learn.microsoft.com/azure/api-management/retry-policy",
            "service": "APIM",
            "services": [
                "AzurePolicy",
                "APIM"
            ],
            "severity": "Medium",
            "subcategory": "Failover and Caching",
            "text": "Use Policies to add a fail-over backend URL and caching to reduce failing calls.",
            "waf": "Reliability"
        },
        {
            "category": "Management",
            "checklist": "Azure API Management Review",
            "guid": "f96ddac5-77ec-4fa9-8833-4327f052059e",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-cache-external",
            "services": [
                "AzurePolicy",
                "APIM"
            ],
            "severity": "Medium",
            "subcategory": "Performance and scalability",
            "text": "Consider using a external cache policy for APIs that can benefit from caching",
            "training": "https://learn.microsoft.com/training/modules/improve-api-performance-with-apim-caching-policy/"
        },
        {
            "category": "Management",
            "checklist": "Azure API Management Review",
            "guid": "8210699f-8d43-45c2-8f19-57e54134bd8f",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-log-event-hubs",
            "service": "APIM",
            "services": [
                "AzurePolicy",
                "EventHubs",
                "APIM"
            ],
            "severity": "Low",
            "subcategory": "Performance and scalability",
            "text": "If you need to log at high performance levels, consider Event Hubs policy",
            "waf": "Operations"
        },
        {
            "category": "Management",
            "checklist": "Azure API Management Review",
            "guid": "121bfc39-fa7b-4096-b93b-ab56c1bc0bed",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-sample-flexible-throttling",
            "service": "APIM",
            "services": [
                "AzurePolicy",
                "APIM"
            ],
            "severity": "Medium",
            "subcategory": "Performance and scalability",
            "text": "Apply throttling policies to control the number of requests per second",
            "training": "https://learn.microsoft.com/training/modules/protect-apis-on-api-management/",
            "waf": "Performance"
        },
        {
            "category": "Management",
            "checklist": "Azure API Management Review",
            "guid": "bb5f356b-3daf-47a2-a9ee-867a8100bbd5",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-autoscale",
            "service": "APIM",
            "services": [
                "APIM"
            ],
            "severity": "Medium",
            "subcategory": "Performance and scalability",
            "text": "Configure autoscaling to scale out the number of instances when the load increases",
            "waf": "Performance"
        },
        {
            "category": "Management",
            "checklist": "Azure API Management Review",
            "guid": "84b94abb-59b6-4b9d-8587-3413669468e8",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-provision-self-hosted-gateway",
            "service": "APIM",
            "services": [
                "APIM"
            ],
            "severity": "Medium",
            "subcategory": "Performance and scalability",
            "text": "Deploy self-hosted gateways where Azure doesn't have a region close to the backend APIs.",
            "waf": "Performance"
        },
        {
            "category": "Management",
            "checklist": "Azure API Management Review",
            "guid": "1fe8db45-a017-4888-8c4d-4422583cfae0",
            "link": "https://learn.microsoft.com/azure/api-management/upgrade-and-scale#upgrade-and-scale",
            "service": "APIM",
            "services": [
                "APIM"
            ],
            "severity": "Medium",
            "subcategory": "Premium Tier",
            "text": "Use the premium tier for production workloads.",
            "waf": "Reliability"
        },
        {
            "category": "Management",
            "checklist": "Azure API Management Review",
            "guid": "1b8d68a4-66cd-44d5-ba94-3ee94440e8d6",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-deploy-multi-region#-route-api-calls-to-regional-backend-services",
            "service": "APIM",
            "services": [
                "AzurePolicy",
                "APIM"
            ],
            "severity": "Medium",
            "subcategory": "Request Routing",
            "text": "In multi-region model, use Policies to route the requests to regional backends based on availability or latency.",
            "waf": "Reliability"
        },
        {
            "category": "Management",
            "checklist": "Azure API Management Review",
            "guid": "46f07d33-ef9a-44e8-8f98-67c097c5d8cd",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits#api-management-limits",
            "service": "APIM",
            "services": [
                "Entra",
                "APIM"
            ],
            "severity": "High",
            "subcategory": "Resource Limits",
            "text": "Be aware of APIM's limits",
            "waf": "Reliability"
        },
        {
            "category": "Management",
            "checklist": "Azure API Management Review",
            "guid": "10f58602-f0f9-4d77-972a-956f6e0f2600",
            "link": "https://learn.microsoft.com/en-us/azure/api-management/self-hosted-gateway-overview",
            "service": "APIM",
            "services": [
                "APIM"
            ],
            "severity": "High",
            "subcategory": "Self-Hosted",
            "text": "Ensure that the self-hosted gateway deployments are resilient.",
            "waf": "Reliability"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure API Management Review",
            "guid": "7519e385-a88b-4d34-966b-6269d686e890",
            "link": "https://learn.microsoft.com/azure/api-management/front-door-api-management",
            "service": "APIM",
            "services": [
                "Entra",
                "FrontDoor",
                "APIM"
            ],
            "severity": "Medium",
            "subcategory": "Connectivity",
            "text": "Use Azure Front Door in front of APIM for multi-region deployment",
            "waf": "Performance"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure API Management Review",
            "guid": "cd45c90e-7690-4753-930b-bf290c69c074",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/api-management-security-baseline?toc=%2Fazure%2Fapi-management%2F&bc=%2Fazure%2Fapi-management%2Fbreadcrumb%2Ftoc.json#virtual-network-integration",
            "service": "APIM",
            "services": [
                "VNet",
                "APIM"
            ],
            "severity": "Medium",
            "subcategory": "Security",
            "text": "Deploy the service within a Virtual Network (VNet)",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure API Management Review",
            "guid": "02661582-b3d1-48d1-9d7b-c6a918a0ca33",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/api-management-security-baseline?toc=%2Fazure%2Fapi-management%2F&bc=%2Fazure%2Fapi-management%2Fbreadcrumb%2Ftoc.json#network-security-group-support",
            "service": "APIM",
            "services": [
                "VNet",
                "Monitor",
                "Entra",
                "APIM"
            ],
            "severity": "Medium",
            "subcategory": "Security",
            "text": "Deploy network security groups (NSG) to your subnets to restrict or monitor traffic to/from APIM.",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure API Management Review",
            "guid": "67437a28-2721-4a2c-becd-caa54c8237a5",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/api-management-security-baseline?toc=%2Fazure%2Fapi-management%2F&bc=%2Fazure%2Fapi-management%2Fbreadcrumb%2Ftoc.json#azure-private-link",
            "service": "APIM",
            "services": [
                "VNet",
                "Entra",
                "PrivateLink",
                "APIM"
            ],
            "severity": "Medium",
            "subcategory": "Security",
            "text": "Deploy Private Endpoints to filter incoming traffic when APIM is not deployed to a VNet.",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure API Management Review",
            "guid": "d698adbd-3288-44cb-b10a-9b572da395ae",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/api-management-security-baseline?toc=%2Fazure%2Fapi-management%2F&bc=%2Fazure%2Fapi-management%2Fbreadcrumb%2Ftoc.json#disable-public-network-access",
            "service": "APIM",
            "services": [
                "APIM"
            ],
            "severity": "High",
            "subcategory": "Security",
            "text": "Disable Public Network Access",
            "waf": "Security"
        },
        {
            "category": "Platform automation and DevOps",
            "checklist": "Azure API Management Review",
            "guid": "0674d750-0c6f-4ac0-8717-ceec04d0bdbd",
            "link": "https://learn.microsoft.com/azure/api-management/automation-manage-api-management",
            "service": "APIM",
            "services": [
                "APIM"
            ],
            "severity": "Medium",
            "subcategory": "Automation",
            "text": "Simplify management with PowerShell automation scripts",
            "waf": "Operations"
        },
        {
            "category": "Platform automation and DevOps",
            "checklist": "Azure API Management Review",
            "guid": "c385bfcd-49fd-4786-81ba-cedbb4c57345",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/app-platform/api-management/platform-automation-and-devops#design-recommendations",
            "service": "APIM",
            "services": [
                "Entra",
                "APIM"
            ],
            "severity": "Medium",
            "subcategory": "Best practices",
            "text": "Configure APIM via Infrastructure-as-code. Review DevOps best practices from the Cloud Adaption Framework APIM Landing Zone Accelerator",
            "waf": "Operations"
        },
        {
            "category": "Platform automation and DevOps",
            "checklist": "Azure API Management Review",
            "guid": "6c3a27c0-197f-426c-9ffa-86fed51d9ab6",
            "link": "https://learn.microsoft.com/azure/api-management/visual-studio-code-tutorial",
            "service": "APIM",
            "services": [
                "Entra",
                "APIM"
            ],
            "severity": "Medium",
            "subcategory": "Best practices",
            "text": "Promote usage of Visual Studio Code APIM extension for faster API development",
            "waf": "Operations"
        },
        {
            "category": "Platform automation and DevOps",
            "checklist": "Azure API Management Review",
            "guid": "354f1c03-8112-4965-85ad-c0074bddf231",
            "link": "https://learn.microsoft.com/azure/api-management/devops-api-development-templates",
            "service": "APIM",
            "services": [
                "APIM"
            ],
            "severity": "Medium",
            "subcategory": "DevOps",
            "text": "Implement DevOps and CI/CD in your workflow",
            "waf": "Operations"
        },
        {
            "category": "Security",
            "checklist": "Azure API Management Review",
            "guid": "b6439493-426a-45f3-9697-cf65baee208d",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-mutual-certificates-for-clients",
            "service": "APIM",
            "services": [
                "APIM"
            ],
            "severity": "Medium",
            "subcategory": "APIs",
            "text": "Secure APIs using client certificate authentication",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure API Management Review",
            "guid": "2a67d143-1033-4c0a-8732-680896478f08",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-mutual-certificates",
            "service": "APIM",
            "services": [
                "APIM"
            ],
            "severity": "Medium",
            "subcategory": "APIs",
            "text": "Secure backend services using client certificate authentication",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure API Management Review",
            "guid": "074435f5-4a46-41ac-b521-d6114cb5d845",
            "link": "https://learn.microsoft.com/azure/api-management/mitigate-owasp-api-threats",
            "service": "APIM",
            "services": [
                "APIM"
            ],
            "severity": "Medium",
            "subcategory": "APIs",
            "text": "Review 'Recommendations to mitigate OWASP API Security Top 10 threats' article and check what is applicable to your APIs",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure API Management Review",
            "guid": "5507c4b8-a7f8-41d6-9661-418c987100c9",
            "link": "https://learn.microsoft.com/azure/api-management/authorizations-overview",
            "service": "APIM",
            "services": [
                "APIM"
            ],
            "severity": "Medium",
            "subcategory": "APIs",
            "text": "Use Authorizations feature to simplify management of OAuth 2.0 token for your backend APIs",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure API Management Review",
            "guid": "2deee033-b906-4bc2-9f26-c8d3699fe091",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-manage-protocols-ciphers",
            "service": "APIM",
            "services": [
                "APIM"
            ],
            "severity": "High",
            "subcategory": "Ciphers",
            "text": "Use the latest TLS version when encrypting information in transit. Disable outdated and unnecessary protocols and ciphers when possible.",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure API Management Review",
            "guid": "f8af3d94-1d2b-4070-846f-849197524258",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/api-management-security-baseline?toc=%2Fazure%2Fapi-management%2F&bc=%2Fazure%2Fapi-management%2Fbreadcrumb%2Ftoc.json#im-8-restrict-the-exposure-of-credential-and-secrets",
            "service": "APIM",
            "services": [
                "AKV",
                "APIM"
            ],
            "severity": "High",
            "subcategory": "Data protection",
            "text": "Ensure that secrets (Named values) are stored an Azure Key Vault so they can be securely accessed and updated",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure API Management Review",
            "guid": "791abd8b-7706-4e31-9569-afefde724be3",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/api-management-security-baseline?toc=%2Fazure%2Fapi-management%2F&bc=%2Fazure%2Fapi-management%2Fbreadcrumb%2Ftoc.json#managed-identities",
            "service": "APIM",
            "services": [
                "Entra",
                "APIM"
            ],
            "severity": "Medium",
            "subcategory": "Identities",
            "text": "Use managed identities to authenticate to other Azure resources whenever possible",
            "waf": "Security"
        },
        {
            "category": "Security",
            "checklist": "Azure API Management Review",
            "guid": "220c4ca6-6688-476b-b2b5-425a78e6fb87",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/api-management-security-baseline?toc=%2Fazure%2Fapi-management%2F&bc=%2Fazure%2Fapi-management%2Fbreadcrumb%2Ftoc.json#ns-6-deploy-web-application-firewall",
            "service": "APIM",
            "services": [
                "WAF",
                "Entra",
                "AppGW",
                "APIM"
            ],
            "severity": "High",
            "subcategory": "Network",
            "text": "Use web application firewall (WAF) by deploying Application Gateway in front of APIM",
            "waf": "Security"
        },
        {
            "category": "BCDR",
            "checklist": "Azure SQLDB Security Checklist (Preview)",
            "description": "Ensure that your backups are protected against attacks. This should include encryption of the backups to protect against loss of confidentiality. For regular Azure service backup, backup data is automatically encrypted using Azure platform-managed keys. You can also choose to encrypt the backup using a customer-managed key. In this case, ensure this customer-managed key in the key vault is also in the backup scope.",
            "guid": "676f6951-0368-49e9-808d-c33a692c9a64",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/sql-database-security-baseline#br-2-encrypt-backup-data",
            "services": [
                "AKV",
                "Backup",
                "SQL"
            ],
            "severity": "Medium",
            "subcategory": "Azure Key Vault",
            "text": "Protect your backup data with encryption and store keys safely in Azure Key Vault",
            "waf": "Security"
        },
        {
            "category": "BCDR",
            "checklist": "Azure SQLDB Security Checklist (Preview)",
            "description": "Azure SQL Database uses SQL Server technology to create full backups every week, differential backup every 12-24 hours, and transaction log backup every 5 to 10 minutes. By default, SQL Database stores data in geo-redundant storage blobs that are replicated to a paired region.",
            "guid": "e2518261-b3bc-4bd1-b331-637fb2df833f",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/sql-database-security-baseline#br-1-ensure-regular-automated-backups",
            "services": [
                "Backup",
                "Storage",
                "SQL"
            ],
            "severity": "Medium",
            "subcategory": "Backup",
            "text": "Configure Azure SQL Database automated backups",
            "waf": "Security"
        },
        {
            "category": "BCDR",
            "checklist": "Azure SQLDB Security Checklist (Preview)",
            "description": "By default, SQL Database stores data in geo-redundant storage blobs that are replicated to a paired region. For SQL Database, the backup storage redundancy can be configured at the time of database creation or can be updated for an existing database; the changes made to an existing database apply to future backups only.",
            "guid": "f8c7cda2-3ed7-43fb-a100-85dcd12a0ee4",
            "link": "https://learn.microsoft.com/azure/azure-sql/database/automated-backups-overview?tabs=single-database&view=azuresql#backup-storage-redundancy",
            "services": [
                "Backup",
                "Storage",
                "SQL"
            ],
            "severity": "Low",
            "subcategory": "Backup",
            "text": "Enable geo-redundant backup storage to protect against single region failure and data loss",
            "waf": "Security"
        },
        {
            "category": "Code",
            "checklist": "Azure SQLDB Security Checklist (Preview)",
            "description": "Malicious code can potentially circumvent security controls. Before deploying custom code to production, it is essential to review what's being deployed. Use a database tool like Azure Data Studio that supports source control. Implement tools and logic for code analysis, vulnerability and credential scanning.",
            "guid": "7ca9f006-d2a9-4652-951c-de8e4ac5e76e",
            "link": "https://learn.microsoft.com/azure/azure-sql/database/transparent-data-encryption-byok-create-server",
            "services": [
                "SQL"
            ],
            "severity": "Medium",
            "subcategory": "Source Control and Code Review",
            "text": "Use Source Control systems to store, maintain and review application code deployed inside Azure SQLDB Database",
            "waf": "Security"
        },
        {
            "category": "Data Discovery and Classification",
            "checklist": "Azure SQLDB Security Checklist (Preview)",
            "description": "In case of classification requirements Purview is the preferred option. Only use SQL Data Discovery & Classification in case Purview is not an option. Discover columns that potentially contain sensitive data. What is considered sensitive data heavily depends on the customer, compliance regulation, etc., and needs to be evaluated by the users in charge of that data. Classify the columns to use advanced sensitivity-based auditing and protection scenarios. Review results of automated discovery and finalize the classification if necessary.",
            "guid": "d401509b-2629-4484-9a7f-af0d29a7778f",
            "link": "https://learn.microsoft.com/azure/azure-sql/database/data-discovery-and-classification-overview?view=azuresql#faq---advanced-classification-capabilities",
            "services": [
                "SQL"
            ],
            "severity": "Low",
            "subcategory": "Data Discovery and Classification",
            "text": "Plan and configure Data Discovery & Classification to protect the sensitive data",
            "waf": "Security"
        },
        {
            "category": "Data Masking",
            "checklist": "Azure SQLDB Security Checklist (Preview)",
            "description": "Usage of this feature is recommended only if column encryption is not an option and there is a specific requirement to preserve data types and formats. Dynamic data masking limits sensitive data exposure by masking it to non-privileged users. Dynamic data masking helps prevent unauthorized access to sensitive data by enabling customers to designate how much of the sensitive data to reveal with minimal impact on the application layer.",
            "guid": "9391fd50-135e-453e-90a7-c1a23f88cc13",
            "link": "https://learn.microsoft.com/azure/azure-sql/database/dynamic-data-masking-overview",
            "services": [
                "SQL"
            ],
            "severity": "Low",
            "subcategory": "Data Masking",
            "text": "Use Data Masking to prevent unauthorized non-admin users data access if no encryption is possible",
            "waf": "Security"
        },
        {
            "category": "Defender",
            "checklist": "Azure SQLDB Security Checklist (Preview)",
            "description": "SQL Advanced Threat Detection (ATP) provides a layer of security that detects potential vulnerabilities and anomalous activity in databases such as SQL injection attacks and unusual behavior patterns. When a potential threat is detected Threat Detection sends an actionable real-time alert by email and in Microsoft Defender for Cloud, which includes clear investigation and remediation steps for the specific threat.",
            "guid": "4e52d73f-5d37-428f-b3a2-e6997e835979",
            "link": "https://learn.microsoft.com/azure/azure-sql/database/threat-detection-configure",
            "services": [
                "EventHubs",
                "Defender",
                "SQL"
            ],
            "severity": "High",
            "subcategory": "Advanced Threat Protection",
            "text": "Review and complete Advanced Threat Protection (ATP) configuration",
            "waf": "Security"
        },
        {
            "category": "Defender",
            "checklist": "Azure SQLDB Security Checklist (Preview)",
            "description": "Enable Microsoft Defender for Azure SQL at the subscription level to automatically onboard and protect all existing and future servers and databases. When you enable on the subscription level, all databases in Azure SQL Database and Azure SQL Managed Instance are protected. You can then disable them individually if you choose. If you want to manually manage which databases are protected, disable at the subscription level and enable each database that you want protected.",
            "guid": "dff87489-9edb-4cef-bdda-86e8212b2aa1",
            "link": "https://learn.microsoft.com/azure/azure-sql/database/azure-defender-for-sql?view=azuresql#enable-microsoft-defender-for-sql ",
            "services": [
                "Subscriptions",
                "Defender",
                "SQL"
            ],
            "severity": "High",
            "subcategory": "Defender for Azure SQL",
            "text": "Enable Microsoft Defender for Azure SQL",
            "waf": "Security"
        },
        {
            "category": "Defender",
            "checklist": "Azure SQLDB Security Checklist (Preview)",
            "description": "Microsoft Defender for Azure SQL ATP detects anomalous activities indicating unusual and potentially harmful attempts to access or exploit databases. Alerts can be configured and generated and will be reported in the Defender for console.",
            "guid": "ca342fdf-d25a-4427-b105-fcd50ff8a0ea",
            "link": "https://learn.microsoft.com/azure/azure-sql/database/threat-detection-configure",
            "services": [
                "Monitor",
                "Defender",
                "SQL"
            ],
            "severity": "High",
            "subcategory": "Defender for Azure SQL",
            "text": "Prepare a security response plan to promptly react to Microsoft Defender for Azure SQL alerts",
            "waf": "Security"
        },
        {
            "category": "Defender",
            "checklist": "Azure SQLDB Security Checklist (Preview)",
            "description": "Azure SQLDB vulnerability assessment is a service that provides visibility into your security state. Vulnerability assessment includes actionable steps to resolve security issues and enhance your database security. It can help you to monitor a dynamic database environment where changes are difficult to track and improve your SQL security posture.",
            "guid": "a6101ae7-534c-45ab-86fd-b34c55ea21ca",
            "link": "https://learn.microsoft.com/azure/defender-for-cloud/sql-azure-vulnerability-assessment-overview",
            "services": [
                "Monitor",
                "Defender",
                "SQL"
            ],
            "severity": "High",
            "subcategory": "Vulnerability Assessment",
            "text": "Configure Vulnerability Assessment (VA) findings and review recommendations",
            "waf": "Security"
        },
        {
            "category": "Defender",
            "checklist": "Azure SQLDB Security Checklist (Preview)",
            "description": "Microsoft Defender for Cloud provides vulnerability assessment for your Azure SQL Databases. Vulnerability assessment scans your databases for software vulnerabilities and provides a list of findings. You can use the findings to remediate software vulnerabilities and disable findings.",
            "guid": "c8c5f112-1e50-4f77-9264-8195b4cd61ac",
            "link": "https://learn.microsoft.com/azure/defender-for-cloud/sql-azure-vulnerability-assessment-find?view=azuresql",
            "services": [
                "Defender",
                "SQL"
            ],
            "severity": "High",
            "subcategory": "Vulnerability Assessment",
            "text": "Regularly review of Vulnerability Assessment (VA) findings and recommendations and prepare a plan to fix",
            "waf": "Security"
        },
        {
            "category": "Encryption",
            "checklist": "Azure SQLDB Security Checklist (Preview)",
            "description": "Always Encrypted with Secure Enclaves expands confidential computing capabilities of Always Encrypted by enabling in-place encryption and richer confidential queries. Always Encrypted with Secure Enclaves addresses these limitations by allowing some computations on plaintext data inside a secure enclave on the server side. Usage of this feature is recommended for the cases where you need to limit administrator access and need your queries to support more than equality matching of encrypted columns.",
            "guid": "65d7e54a-10a6-4094-b673-9ff3809c9277",
            "link": "https://learn.microsoft.com/sql/relational-databases/security/encryption/always-encrypted-enclaves",
            "services": [
                "SQL"
            ],
            "severity": "Medium",
            "subcategory": "Always Encrypted",
            "text": "If protecting sensitive PII data from admin users is a key requirement, but Column Encryption limitations cannot be tolerated, consider the adoption of Always Encrypted with Secure Enclaves",
            "waf": "Security"
        },
        {
            "category": "Encryption",
            "checklist": "Azure SQLDB Security Checklist (Preview)",
            "description": "With Azure SQL Database, you can apply symmetric encryption to a column of data by using Transact-SQL. This approach is called column encryption, because you can use it to encrypt specific columns with different encryption keys. Doing so gives you more granular encryption capability than TDE, which encrypts data in pages. Using Always Encrypted to ensure sensitive data isn't exposed in plaintext in Azure SQL Database or SQL Managed Instance, even in memory/in use. Always Encrypted protects the data from Database Administrators (DBAs) and cloud admins (or bad actors who can impersonate high-privileged but unauthorized users) and gives you more control over who can access your data.",
            "guid": "c03ce136-e3d5-4e17-bf25-ed955ee480d3",
            "link": "https://learn.microsoft.com/azure/azure-sql/database/security-best-practice?view=azuresql#control-access-of-application-users-to-sensitive-data-through-encryption",
            "services": [
                "AKV",
                "Storage",
                "SQL"
            ],
            "severity": "Low",
            "subcategory": "Column Encryption",
            "text": "To protect sensitive PII data from non-admin users in specific table columns, consider using Column Encryption",
            "waf": "Security"
        },
        {
            "category": "Encryption",
            "checklist": "Azure SQLDB Security Checklist (Preview)",
            "description": "Enabled by default, Transparent data encryption (TDE) helps to protect the database files against information disclosure by performing real-time encryption and decryption of the database, associated backups, and transaction log files 'at rest', without requiring changes to the application.",
            "guid": "c614ac47-bebf-4061-b0a1-43e0c6b5e00d",
            "link": "https://learn.microsoft.com/azure/azure-sql/database/transparent-data-encryption-byok-create-server",
            "services": [
                "Backup",
                "Storage",
                "SQL"
            ],
            "severity": "High",
            "subcategory": "Transparent Data Encryption",
            "text": "Ensure Transparent Data Encryption (TDE) is kept enabled",
            "waf": "Security"
        },
        {
            "category": "Encryption",
            "checklist": "Azure SQLDB Security Checklist (Preview)",
            "description": "If separation of duties in the management of keys and data within the organization is required, leverage Customer Managed Keys (CMK) for Transparent Data Encryption (TDE) for your Azure SQLDB and use Azure Key Vault to store (refer to its checklist). Leverage this feature when you have strict security requirements which cannot be met by the managed service keys.",
            "guid": "2edb4165-4f54-47cc-a891-5c82c2f21e25",
            "link": "https://learn.microsoft.com/azure/azure-sql/database/transparent-data-encryption-byok-overview",
            "services": [
                "AKV",
                "SQL"
            ],
            "severity": "Medium",
            "subcategory": "Transparent Data Encryption",
            "text": "Use customer-managed keys (CMK) in Azure Key Vault (AKV) if you need increased transparency and granular control over the TDE protection",
            "waf": "Security"
        },
        {
            "category": "Encryption",
            "checklist": "Azure SQLDB Security Checklist (Preview)",
            "description": "The minimal Transport Layer Security (TLS) version setting allows customers to choose which version of TLS their SQL database uses. It's possible to change the minimum TLS version by using the Azure portal, Azure PowerShell, and the Azure CLI.",
            "guid": "7754b605-57fd-4bcb-8213-52c39d8e8225",
            "link": "https://learn.microsoft.com/azure/azure-sql/database/connectivity-settings?source=recommendations&view=azuresql&tabs=azure-portal#minimal-tls-version",
            "services": [
                "SQL"
            ],
            "severity": "High",
            "subcategory": "Transport Layer Security",
            "text": "Enforce minimum TLS version to the latest available",
            "waf": "Security"
        },
        {
            "category": "Identity",
            "checklist": "Azure SQLDB Security Checklist (Preview)",
            "description": "Use Azure Active Directory (Azure AD) authentication for centralized identity management. Use SQL Authentication only if really necessary and document as exceptions.",
            "guid": "c9b8b6bf-2c6b-453d-b400-de9a43a549d7",
            "link": "https://learn.microsoft.com/azure/azure-sql/database/authentication-aad-overview",
            "services": [
                "Entra",
                "SQL"
            ],
            "severity": "Medium",
            "subcategory": "Azure Active Directory",
            "text": "Leverage Azure AD authentication for connections to Azure SQL Databases",
            "waf": "Security"
        },
        {
            "category": "Identity",
            "checklist": "Azure SQLDB Security Checklist (Preview)",
            "description": "Using Azure AD groups simplifies permission management and both the group owner, and the resource owner can add/remove members to/from the group. Create a separate group for Azure AD administrators for each  logical server. Monitor Azure AD group membership changes using Azure AD audit activity reports.",
            "guid": "29820254-1d14-4778-ae90-ff4aeba504a3",
            "link": "https://learn.microsoft.com/azure/azure-sql/database/security-best-practice?view=azuresql#central-management-for-identities",
            "services": [
                "Entra",
                "Monitor",
                "SQL"
            ],
            "severity": "Medium",
            "subcategory": "Azure Active Directory",
            "text": "Create a separate Azure AD group with two admin accounts for each Azure SQL Database logical server",
            "waf": "Security"
        },
        {
            "category": "Identity",
            "checklist": "Azure SQLDB Security Checklist (Preview)",
            "description": "Ensure that distinct system and user assigned managed identities, that are dedicated to the function, with least permissions assigned, are used for communication from Azure services and applications to the Azure SQLDB databases.",
            "guid": "df3a09ee-03bb-4198-8637-d141acf5f289",
            "link": "https://learn.microsoft.com/azure/azure-sql/database/security-best-practice?view=azuresql#minimize-the-use-of-password-based-authentication-for-applications",
            "services": [
                "Entra",
                "SQL"
            ],
            "severity": "Medium",
            "subcategory": "Azure Active Directory",
            "text": "Minimize the use of password-based authentication for applications",
            "waf": "Security"
        },
        {
            "category": "Identity",
            "checklist": "Azure SQLDB Security Checklist (Preview)",
            "description": "System or User assigned managed identities enable Azure SQLDB to authenticate to other cloud services (e.g. Azure Key Vault) without storing credentials in code. Once enabled, all necessary permissions can be granted via Azure role-based-access-control to the specific Azure SQLDB instance. Do not share user assigned managed identities across multiple services if not strictly required.",
            "guid": "69891194-5074-4e30-8f69-4efc3c580900",
            "link": "https://learn.microsoft.com/azure/active-directory/managed-identities-azure-resources/overview",
            "services": [
                "AKV",
                "SQL",
                "Entra",
                "RBAC",
                "ACR"
            ],
            "severity": "Low",
            "subcategory": "Managed Identities",
            "text": "Assign Azure SQL Database a managed identity for outbound resource access",
            "waf": "Security"
        },
        {
            "category": "Identity",
            "checklist": "Azure SQLDB Security Checklist (Preview)",
            "description": "Use an Azure AD integrated authentication that eliminates the use of passwords. Password-based authentication methods are a weaker form of authentication. Credentials can be compromised or mistakenly given away. Use single sign-on authentication using Windows credentials. Federate the on-premises AD domain with Azure AD and use integrated Windows authentication (for domain-joined machines with Azure AD).",
            "guid": "88287d4a-8bb8-4640-ad78-03f51354d003",
            "link": "https://learn.microsoft.com/azure/azure-sql/database/authentication-aad-configure?view=azuresql&tabs=azure-powershell#active-directory-integrated-authentication",
            "services": [
                "Entra",
                "SQL"
            ],
            "severity": "Medium",
            "subcategory": "Passwords",
            "text": "Minimize the use of password-based authentication for users",
            "waf": "Security"
        },
        {
            "category": "Ledger",
            "checklist": "Azure SQLDB Security Checklist (Preview)",
            "description": "The hash of the latest block in the database ledger is called the database digest. It represents the state of all ledger tables in the database at the time when the block was generated. Generating a database digest is efficient, because it involves computing only the hashes of the blocks that were recently appended. Azure Confidential Ledger is one of the supported store, it can be used and supports automatic generation and storage of database digests. Azure Ledger provides advanced security features like Blockchain Ledger Proof and Confidential Hardware Enclaves. Use it only if advanced security features are required, otherwise revert to Azure storage.",
            "guid": "0e853380-50ba-4bce-b2fd-5c7391c85ecc",
            "link": "https://learn.microsoft.com/azure/architecture/guide/technology-choices/multiparty-computing-service#confidential-ledger-and-azure-blob-storage",
            "services": [
                "Storage",
                "SQL"
            ],
            "severity": "Medium",
            "subcategory": "Database Digest",
            "text": "Use Azure Confidential Ledger to store database digests only if advanced security features are required",
            "waf": "Security"
        },
        {
            "category": "Ledger",
            "checklist": "Azure SQLDB Security Checklist (Preview)",
            "description": "The hash of the latest block in the database ledger is called the database digest. It represents the state of all ledger tables in the database at the time when the block was generated. Generating a database digest is efficient, because it involves computing only the hashes of the blocks that were recently appended. Azure Blob Storage with Immutable Storage feature can be used and supports automatic generation and storage of database digests. To prevent tampering of your digest files, configure and lock a retention policy for your container.",
            "guid": "afefb2d3-95da-4ac9-acf5-33d18b32ef9a",
            "link": "https://learn.microsoft.com/sql/relational-databases/security/ledger/ledger-digest-management",
            "services": [
                "AzurePolicy",
                "Storage",
                "SQL"
            ],
            "severity": "Medium",
            "subcategory": "Database Digest",
            "text": "If Azure storage account is used to store database digests, ensure security is properly configured",
            "waf": "Security"
        },
        {
            "category": "Ledger",
            "checklist": "Azure SQLDB Security Checklist (Preview)",
            "description": "Ledger provides a form of data integrity called forward integrity, which provides evidence of data tampering on data in your ledger tables. The database verification process takes as input one or more previously generated database digests. It then recomputes the hashes stored in the database ledger based on the current state of the ledger tables. If the computed hashes don't match the input digests, the verification fails. The failure indicates that the data has been tampered with. The verification process reports all inconsistencies that it detects.",
            "guid": "f8d4ffda-8aac-4cc6-b72b-c81cb8625420",
            "link": "https://learn.microsoft.com/sql/relational-databases/security/ledger/ledger-database-verification",
            "services": [
                "Storage",
                "SQL"
            ],
            "severity": "Medium",
            "subcategory": "Integrity",
            "text": "Schedule the Ledger verification process regularly to verify data integrity",
            "waf": "Security"
        },
        {
            "category": "Ledger",
            "checklist": "Azure SQLDB Security Checklist (Preview)",
            "description": "The Ledger feature provides tamper-evidence capabilities in your database. You can cryptographically attest to other parties, such as auditors or other business parties, that your data hasn't been tampered with. Ledger helps protect data from any attacker or high-privileged user, including database administrators (DBAs), system administrators, and cloud administrators.",
            "guid": "2563f498-e2d3-42ea-9e7b-5517881a06a2",
            "link": "https://learn.microsoft.com/sql/relational-databases/security/ledger/ledger-overview",
            "services": [
                "SQL"
            ],
            "severity": "Medium",
            "subcategory": "Ledger",
            "text": "If cryptographic proof of data integrity  is a critical requirement, Ledger feature should be considered",
            "waf": "Security"
        },
        {
            "category": "Ledger",
            "checklist": "Azure SQLDB Security Checklist (Preview)",
            "description": "Depending on the type of tampering, there are cases where you can repair the ledger without losing data. In the article contained in the --More Info-- column, different scenarios and recovery techniques are described.",
            "guid": "804fc554-6554-4842-91c1-713b32f99902",
            "link": "https://learn.microsoft.com/sql/relational-databases/security/ledger/ledger-how-to-recover-after-tampering",
            "services": [
                "SQL"
            ],
            "severity": "Medium",
            "subcategory": "Recovery",
            "text": "Prepare a response plan to investigate and repair a database after a tampering event",
            "waf": "Security"
        },
        {
            "category": "Logging",
            "checklist": "Azure SQLDB Security Checklist (Preview)",
            "description": "Azure SQL Database Auditing tracks database events and writes them to an audit log in your Azure storage account. Auditing helps you understand database activity and gain insight into discrepancies and anomalies that could indicate business concerns or suspected security violations as well as helps you meet regulatory compliance. By default auditing policy includes all actions (queries, stored procedures and successful and failed logins) against the databases, which may result in high volume of audit logs. It's recommended for customers to configure auditing for different types of actions and action groups using PowerShell.",
            "guid": "4082e31d-35f4-4a49-8507-d3172cc930a6",
            "link": "https://learn.microsoft.com/azure/azure-sql/database/auditing-overview",
            "services": [
                "AzurePolicy",
                "Storage",
                "SQL"
            ],
            "severity": "Medium",
            "subcategory": "Auditing",
            "text": "Ensure that Azure SQL Database Auditing is enabled at the server level",
            "waf": "Security"
        },
        {
            "category": "Logging",
            "checklist": "Azure SQLDB Security Checklist (Preview)",
            "description": "Azure SQL Database Auditing logs can be written to external storage accounts, Log Analytics workspace or Event Hub. Be sure to protect the target repository using backups and secured configuration. Use Azure SQL Database Managed Identity to access the storage and set an explicit retention period. Do not grant permissions to administrators to the audit log repository. Use a different target storage for --Enabling Auditing of Microsoft support operations--. ",
            "guid": "9b64bc50-b60f-4035-bf7a-28c4806dfb46",
            "link": "https://learn.microsoft.com/azure/azure-sql/database/auditing-overview",
            "services": [
                "SQL",
                "Entra",
                "EventHubs",
                "Backup",
                "Monitor",
                "Storage"
            ],
            "severity": "Low",
            "subcategory": "Auditing",
            "text": "Ensure that Azure SQL Database Auditing logs are backed up and secured in the selected repository type",
            "waf": "Security"
        },
        {
            "category": "Logging",
            "checklist": "Azure SQLDB Security Checklist (Preview)",
            "description": "The Azure Monitor activity log is a platform log in Azure that provides insight into subscription-level events. The activity log includes information like when a resource is modified. It is recommended to send this activity log to the same external storage repository as the Azure SQL Database Audit Log (storage account, Log Analytics workspace, Event Hub).",
            "guid": "fcd34708-87ac-4efc-aaf6-57a47f76644a",
            "link": "https://learn.microsoft.com/azure/azure-monitor/essentials/activity-log",
            "services": [
                "SQL",
                "EventHubs",
                "Subscriptions",
                "Monitor",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Auditing",
            "text": "Ensure that Azure SQL Database Activity Log is collected and integrated with Auditing logs",
            "waf": "Security"
        },
        {
            "category": "Logging",
            "checklist": "Azure SQLDB Security Checklist (Preview)",
            "description": "Forward any logs from Azure SQL to your  Security Information and Event Management (SIEM) and Security Orchestration Automation and Response (SOAR). Ensure that you are monitoring different types of Azure assets for potential threats and anomalies. Focus on getting high-quality alerts to reduce false positives for analysts to sort through. Alerts can be sourced from log data, agents, or other data.",
            "guid": "f96e127e-9572-453a-b325-ff89ae9f6b44",
            "link": "https://learn.microsoft.com/azure/azure-sql/database/auditing-overview",
            "services": [
                "Monitor",
                "SQL"
            ],
            "severity": "Medium",
            "subcategory": "SIEM/SOAR",
            "text": "Ensure that Azure SQL Database Auditing logs are being presented in to your organizations SIEM/SOAR",
            "waf": "Security"
        },
        {
            "category": "Logging",
            "checklist": "Azure SQLDB Security Checklist (Preview)",
            "description": "Forward any logs from Azure SQL to your  Security Information and Event Management (SIEM) and Security Orchestration Automation and Response (SOAR), which can be used to set up custom threat detections. Ensure that you are monitoring different types of Azure assets for potential threats and anomalies. Focus on getting high-quality alerts to reduce false positives for analysts to sort through. Alerts can be sourced from log data, agents, or other data.",
            "guid": "41503bf8-73da-4a10-af9f-5f7fceb5456f",
            "link": "https://learn.microsoft.com/azure/azure-monitor/essentials/activity-log",
            "services": [
                "Monitor",
                "SQL"
            ],
            "severity": "Medium",
            "subcategory": "SIEM/SOAR",
            "text": "Ensure that Azure SQL Database Activity Log data is presented in to your SIEM/SOAR",
            "waf": "Security"
        },
        {
            "category": "Logging",
            "checklist": "Azure SQLDB Security Checklist (Preview)",
            "description": "Security Operation Center (SOC) team should create an incident response plan (playbooks or manual responses) to investigate and mitigate tampering, malicious activities, and other anomalous behaviors.",
            "guid": "19ec7c97-c563-4e1d-82f0-54d6ec12e754",
            "link": "https://learn.microsoft.com/azure/azure-monitor/essentials/activity-log",
            "services": [
                "EventHubs",
                "SQL"
            ],
            "severity": "Medium",
            "subcategory": "SIEM/SOAR",
            "text": "Ensure that you have response plans for malicious or aberrant audit logging events",
            "waf": "Security"
        },
        {
            "category": "Networking",
            "checklist": "Azure SQLDB Security Checklist (Preview)",
            "description": "When you create a logical server from the Azure portal for Azure SQL Database, the result is a public endpoint that is visible and reachable over the public network (Public Access). You can then limit connectivity based on firewall rules and Service Endpoint. You can also configure private connectivity only limiting connections to internal networks using Private Endpoint (Private Access). Private Access using Private Endpoint should be the default unless a business case or performance/technical reason applies that cannot support it. Usage of Private Endpoints has performance implications that need to be considered and assessed.",
            "guid": "2c6d356a-1784-475b-a42c-ec187dc8c925",
            "link": "https://learn.microsoft.com/azure/azure-sql/database/network-access-controls-overview",
            "services": [
                "PrivateLink",
                "SQL"
            ],
            "severity": "High",
            "subcategory": "Connectivity",
            "text": "Review Public vs. Private Access connectivity methods and select the appropriate one for the workload",
            "waf": "Security"
        },
        {
            "category": "Networking",
            "checklist": "Azure SQLDB Security Checklist (Preview)",
            "description": "IMPORTANT: Connections to private endpoint only support Proxy as the connection policy. When using private endpoints connections are proxied via the Azure SQL Database gateway to the database nodes. Clients will not have a direct connection.",
            "guid": "557b3ce5-bada-4296-8d52-a2d447bc1718",
            "link": "https://learn.microsoft.com/azure/azure-sql/database/connectivity-architecture",
            "services": [
                "AzurePolicy",
                "PrivateLink",
                "SQL"
            ],
            "severity": "Low",
            "subcategory": "Connectivity",
            "text": "Keep default Azure SQL Database Connection Policy if not differently required and justified",
            "waf": "Security"
        },
        {
            "category": "Networking",
            "checklist": "Azure SQLDB Security Checklist (Preview)",
            "description": "This option configures the firewall to allow all connections from Azure, including connections from the subscriptions of other customers. If you select this option, make sure that your login and user permissions limit access to authorized users only. If not strictly required, keep this setting to OFF.",
            "guid": "f48efacf-4405-4e8d-9dd0-16c5302ed082",
            "link": "https://learn.microsoft.com/azure/azure-sql/database/network-access-controls-overview",
            "services": [
                "Subscriptions",
                "SQL"
            ],
            "severity": "High",
            "subcategory": "Connectivity",
            "text": "Ensure Allow Azure Services and Resources to Access this Server setting is disabled in Azure SQL Database firewall",
            "waf": "Security"
        },
        {
            "category": "Networking",
            "checklist": "Azure SQLDB Security Checklist (Preview)",
            "description": "Azure SQL Database has a new built-in feature that allows native integration with external REST endpoints. This means that integration of Azure SQL Database with Azure Functions, Azure Logic Apps, Cognitive Services, Event Hubs, Event Grid, Azure Containers, API Management and in general any REST or even GraphQL endpoint. If not properly restricted, code inside an Azure SQL Database database could leverage this mechanism to exfiltrate data. If not strictly required, it is recommended to block or restrict this feature using Outbound Firewall Rules.",
            "guid": "cb3274a7-e36d-46f6-8de5-46d30c8dde8e",
            "link": "https://learn.microsoft.com/sql/relational-databases/system-stored-procedures/sp-invoke-external-rest-endpoint-transact-sql",
            "services": [
                "APIM",
                "EventHubs",
                "SQL"
            ],
            "severity": "Medium",
            "subcategory": "Outbound Control",
            "text": "Block or restrict outbound REST API calls to external endpoints",
            "waf": "Security"
        },
        {
            "category": "Networking",
            "checklist": "Azure SQLDB Security Checklist (Preview)",
            "description": "Outbound firewall rules limit network traffic from the Azure SQL Database logical server to a customer defined list of Azure Storage accounts and Azure SQL Database logical servers. Any attempt to access storage accounts or databases not in this list is denied.",
            "guid": "a566dd3d-314e-4a94-9378-102c42d82b38",
            "link": "https://learn.microsoft.com/azure/azure-sql/database/outbound-firewall-rule-overview",
            "services": [
                "Storage",
                "SQL"
            ],
            "severity": "Medium",
            "subcategory": "Outbound Control",
            "text": "If outbound network access is required, it is recommended to configure outbound networking restrictions using built-in Azure SQL Database control feature",
            "waf": "Security"
        },
        {
            "category": "Networking",
            "checklist": "Azure SQLDB Security Checklist (Preview)",
            "description": "Private Endpoint is created inside a subnet in an Azure Virtual Network. Proper security configuration must be applied also to the containing network environment, including NSG/ASG, UDR, firewall, monitoring and auditing.",
            "guid": "246cd832-f550-4af0-9c74-ca9baeeb8860",
            "link": "https://learn.microsoft.com/azure/azure-sql/database/private-endpoint-overview?view=azuresql#disable-public-access-to-your-logical-server",
            "services": [
                "Firewall",
                "SQL",
                "PrivateLink",
                "VNet",
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Private Access",
            "text": "If Private Access connectivity is used, ensure that you are using the Private Endpoint, Azure Virtual Network, Azure Firewall, and Azure Network Security Group checklists",
            "waf": "Security"
        },
        {
            "category": "Networking",
            "checklist": "Azure SQLDB Security Checklist (Preview)",
            "description": "When adding a Private Endpoint connection, public routing to your logical server isn't blocked by default. In the --Firewall and virtual networks-- pane, the setting --Deny public network access-- is not selected by default. To disable public network access, ensure that you select --Deny public network access--.",
            "guid": "3a0808ee-ea7a-47ab-bdce-920a6a2b3881",
            "link": "https://learn.microsoft.com/azure/azure-sql/database/private-endpoint-overview?view=azuresql#disable-public-access-to-your-logical-server",
            "services": [
                "VNet",
                "PrivateLink",
                "SQL"
            ],
            "severity": "High",
            "subcategory": "Private Access",
            "text": "If Private Endpoint (Private Access) is used, consider disabling Public Access connectivity",
            "waf": "Security"
        },
        {
            "category": "Networking",
            "checklist": "Azure SQLDB Security Checklist (Preview)",
            "description": "Network Security Group (NSG) and Application Security Group (ASG) can be now applied to subnet containing Private Endpoints to restrict connections to Azure SQLDB based on internal source IP ranges.",
            "guid": "8600527e-e8c4-4424-90ef-1f0dca0224f2",
            "link": "https://learn.microsoft.com/azure/private-link/private-endpoint-overview#network-security-of-private-endpoints",
            "services": [
                "VNet",
                "PrivateLink",
                "SQL"
            ],
            "severity": "Medium",
            "subcategory": "Private Access",
            "text": "If Private Endpoint (Private Access) is used, apply NSG and eventually ASG to limit incoming source IP address ranges",
            "waf": "Security"
        },
        {
            "category": "Networking",
            "checklist": "Azure SQLDB Security Checklist (Preview)",
            "description": "A Managed Instance (SQL MI) can be isolated inside a virtual network to prevent external access. Applications and tools that are in the same or peered virtual network in the same region could access it directly. Applications and tools that are in different region could use virtual-network-to-virtual-network connection or ExpressRoute circuit peering to establish connection. Customer should use Network Security Groups (NSG), and eventually internal firewalls, to restrict access over port 1433 only to resources that require access to a managed instance.",
            "guid": "18123ef4-a0a6-45e3-87fe-7f454f65d975",
            "link": "https://learn.microsoft.com/azure/azure-sql/managed-instance/connectivity-architecture-overview",
            "services": [
                "VNet",
                "ExpressRoute",
                "SQL"
            ],
            "severity": "Medium",
            "subcategory": "Private Access",
            "text": "Apply Network Security Groups (NSG) and firewall rules to restrict access to Azure SQL Managed Instance internal subnet",
            "waf": "Security"
        },
        {
            "category": "Networking",
            "checklist": "Azure SQLDB Security Checklist (Preview)",
            "description": "Azure Virtual Network Service Endpoint is preferred solution if you want to establish a direct connection to the Azure SQL Database backend nodes using Redirect policy. This will allow access in high performance mode and is the recommended approach from a performance perspective.",
            "guid": "55187443-6852-4fbd-99c6-ce303597ca7f",
            "link": "https://learn.microsoft.com/azure/azure-sql/database/network-access-controls-overview?view=azuresql#ip-vs-virtual-network-firewall-rules",
            "services": [
                "AzurePolicy",
                "VNet",
                "SQL"
            ],
            "severity": "High",
            "subcategory": "Public Access",
            "text": "If Public Access connectivity is used, leverage Service Endpoint to restrict access from selected Azure Virtual Networks",
            "waf": "Security"
        },
        {
            "category": "Networking",
            "checklist": "Azure SQLDB Security Checklist (Preview)",
            "description": "The Azure SQL Database firewall allows you to specify IP address ranges from which communications are accepted. This approach is fine for stable IP addresses that are outside the Azure private network.",
            "guid": "a73e32da-b3f4-4960-b5ec-2f42a557bf31",
            "link": "https://learn.microsoft.com/azure/azure-sql/database/network-access-controls-overview",
            "services": [
                "Storage",
                "SQL"
            ],
            "severity": "Medium",
            "subcategory": "Public Access",
            "text": "If Public Access connectivity is used, ensure that only specific known IPs are added to the firewall",
            "waf": "Security"
        },
        {
            "category": "Networking",
            "checklist": "Azure SQLDB Security Checklist (Preview)",
            "description": "We recommend that you use database-level IP firewall rules whenever possible. This practice enhances security and makes your database more portable. Use server-level IP firewall rules for administrators. Also use them when you have many databases that have the same access requirements, and you don't want to configure each database individually.",
            "guid": "e0f31ac9-35c8-4bfd-9865-edb60ffc6768",
            "link": "https://learn.microsoft.com/azure/azure-sql/database/firewall-configure",
            "services": [
                "Storage",
                "SQL"
            ],
            "severity": "Low",
            "subcategory": "Public Access",
            "text": "If Public Access connectivity is used and controlled by Azure SQL Database firewall rules, use database-level over server-level IP rules",
            "waf": "Security"
        },
        {
            "category": "Networking",
            "checklist": "Azure SQLDB Security Checklist (Preview)",
            "description": "A Managed Instance (SQL MI) can be isolated inside a virtual network to prevent external access. The Managed Instance public endpoint is not enabled by default, must be explicitly enabled, only if strictly required. If company policy disallows the use of public endpoints, use Azure Policy to prevent enabling public endpoints in the first place.",
            "guid": "b8435656-143e-41a8-9922-61d34edb751a",
            "link": "https://learn.microsoft.com/azure/azure-sql/managed-instance/public-endpoint-overview",
            "services": [
                "AzurePolicy",
                "VNet",
                "SQL"
            ],
            "severity": "High",
            "subcategory": "Public Access",
            "text": "Do not enable Azure SQL Managed Instance public endpoint",
            "waf": "Security"
        },
        {
            "category": "Networking",
            "checklist": "Azure SQLDB Security Checklist (Preview)",
            "description": "A Managed Instance (SQL MI) public endpoint is not enabled by default, must be explicitly enabled, only if strictly required. In this case, it is recommended to apply a Network Security Groups (NSG) to restrict access to port 3342 only to trusted source IP addresses.",
            "guid": "057dd298-8726-4aa6-b590-1f81d2e30421",
            "link": "https://learn.microsoft.com/azure/azure-sql/managed-instance/public-endpoint-overview",
            "services": [
                "VNet",
                "SQL"
            ],
            "severity": "High",
            "subcategory": "Public Access",
            "text": "Restrict access if Azure SQL Managed Instance public endpoint is required",
            "waf": "Security"
        },
        {
            "category": "Privileged Access",
            "checklist": "Azure SQLDB Security Checklist (Preview)",
            "description": "Most operations, support, and troubleshooting performed by Microsoft personnel and sub-processors do not require access to customer data. In those rare circumstances where such access is required, Customer Lockbox for Microsoft Azure provides an interface for customers to review and approve or reject customer data access requests.  In support scenarios where Microsoft needs to access customer data, Azure SQL Database supports Customer Lockbox to provide an interface for you to review and approve or reject customer data access requests.",
            "guid": "37b6eb0f-553d-488f-8a8a-cb9bf97388ff",
            "link": "https://learn.microsoft.com/azure/security/fundamentals/customer-lockbox-overview",
            "services": [
                "SQL"
            ],
            "severity": "Low",
            "subcategory": "Lockbox",
            "text": "Review and enable Customer Lockbox for Azure SQL Database access by Microsoft personnel",
            "waf": "Security"
        },
        {
            "category": "Privileged Access",
            "checklist": "Azure SQLDB Security Checklist (Preview)",
            "description": "The principle of least privilege states that users shouldn't have more privileges than needed to complete their tasks. High-privileged database and server users can perform many configuration and maintenance activities on the database and can also drop databases in Azure SQL instance. Tracking database owners and privileged accounts is important to avoid having excessive permission.",
            "guid": "5fe5281f-f0f9-4842-a682-8baf18bd8316",
            "link": "https://learn.microsoft.com/azure/azure-sql/database/security-best-practice?view=azuresql#implement-principle-of-least-privilege",
            "services": [
                "SQL"
            ],
            "severity": "Medium",
            "subcategory": "Permissions",
            "text": "Ensure that users are assigned the minimum level of access necessarily to complete their job functions",
            "waf": "Security"
        },
        {
            "category": "Privileged Access",
            "checklist": "Azure SQLDB Security Checklist (Preview)",
            "description": "Identities (both Users and SPNs) should be scoped to the least amount of access needed to perform the function.  A higher number of tightly scoped SPNs should be used, instead of having one SPN with multiple sets of unrelated permissions. For example, if there are three external web applications hosted on-prem that make queries to the Azure SQL Database, they should not all use the same SPN for these activities.  Instead, they should each have their own tightly scoped SPN.",
            "guid": "7b5b55e5-4750-4920-be97-eb726c256a5c",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/sql-database-security-baseline#im-3-use-azure-ad-single-sign-on-sso-for-application-access",
            "services": [
                "Entra",
                "SQL"
            ],
            "severity": "Low",
            "subcategory": "Permissions",
            "text": "Ensure that distinct applications will be assigned different credentials with minimal permissions to access Azure SQL Database",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "graph": "cdnresources | where type =~ 'microsoft.Cdn/profiles/secrets' | extend frontDoorId = substring(id, 0, indexof(id, '/secrets')) | where properties.parameters.type =~ 'CustomerCertificate' | extend compliant = properties.parameters.useLatestVersion == true | project compliant, id=frontDoorId, certificateName = name | distinct id, certificateName, compliant",
            "guid": "f00a69de-7076-4734-a734-6e4552cad9e1",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-latest-version-for-customer-managed-certificates",
            "service": "Front Door",
            "services": [
                "AKV",
                "FrontDoor"
            ],
            "severity": "Medium",
            "subcategory": "Front Door",
            "text": "If you use customer-managed TLS certificates with Azure Front Door, use the 'Latest' certificate version. Reduce the risk of outages caused by manual certificate renewal.",
            "waf": "Operations"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "graph": "resources | where type =~ 'microsoft.cdn/profiles' and sku has 'AzureFrontDoor' | project name, cdnprofileid=tolower(id), tostring(tags), resourceGroup, subscriptionId,skuname=tostring(sku.name) | join kind= fullouter ( cdnresources | where type == 'microsoft.cdn/profiles/securitypolicies' | extend wafpolicyid=tostring(properties['parameters']['wafPolicy']['id']) | extend splitid=split(id, '/') | extend cdnprofileid=tolower(strcat_array(array_slice(splitid, 0, 8), '/')) | project secpolname=name, cdnprofileid, wafpolicyid ) on cdnprofileid | project name, cdnprofileid, secpolname, wafpolicyid,skuname | join kind = fullouter ( resources | where type == 'microsoft.network/frontdoorwebapplicationfirewallpolicies' | extend managedrulesenabled=iff(tostring(properties.managedRules.managedRuleSets) != '[]', true, false), enabledState = tostring(properties.policySettings.enabledState) | project afdwafname=name, managedrulesenabled, wafpolicyid=id, enabledState, tostring(tags) ) on wafpolicyid | where name != '' | summarize associatedsecuritypolicies=countif(secpolname != ''), wafswithmanagedrules=countif(managedrulesenabled == 1) by name, id=cdnprofileid, tags,skuname | extend compliant = (associatedsecuritypolicies > 0 and wafswithmanagedrules > 0) | project id, compliant",
            "guid": "e79d17b7-3b22-4a5a-97e7-a8ed4b30e38c",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "service": "Front Door",
            "services": [
                "AzurePolicy",
                "WAF",
                "FrontDoor"
            ],
            "severity": "Medium",
            "subcategory": "Front Door",
            "text": "Use Azure Front Door with WAF policies to deliver and help protect global HTTP/S apps that span multiple Azure regions.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "guid": "3f29812b-2363-4cef-b179-b599de0d5973",
            "link": "https://learn.microsoft.com/azure/frontdoor/origin-security?tabs=application-gateway&pivots=front-door-standard-premium#example-configuration",
            "service": "Front Door",
            "services": [
                "AzurePolicy",
                "WAF",
                "FrontDoor",
                "AppGW"
            ],
            "severity": "Medium",
            "subcategory": "Front Door",
            "text": "When using Front Door and Application Gateway to help protect HTTP/S apps, use WAF policies in Front Door. Lock down Application Gateway to receive traffic only from Front Door.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "graph": "resources | where type == 'microsoft.network/frontdoorwebapplicationfirewallpolicies' | project policyName=name, policyId=id,policySku=sku.name, links=properties.securityPolicyLinks, enabledState=properties.policySettings.enabledState, mode=properties.policySettings.mode | mvexpand links | extend securityPolicy=links.id | extend securityPolicyParts=split(securityPolicy, '/') | extend profileId=strcat_array(array_slice(securityPolicyParts, 0, -3), '/') | project id=profileId, compliant=((enabledState=='Enabled') and (mode=='Prevention')), enabledState, mode",
            "guid": "ae248989-b306-4591-9186-de482e3f0f0e",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-policy-settings",
            "service": "Front Door",
            "services": [
                "AzurePolicy",
                "WAF",
                "FrontDoor"
            ],
            "severity": "High",
            "subcategory": "Front Door",
            "text": "Deploy your WAF policy for Front Door in 'Prevention' mode' so that Web Application Firewall takes appropriate action to allow or deny traffic.",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "graph": "cdnresources | where type =~ 'microsoft.cdn/profiles/origingroups/origins' | extend frontDoorId = substring(id, 0, indexof(id, '/origingroups')) | extend compliant = properties['hostName'] !endswith '.trafficmanager.net' | project compliant, id=frontDoorId",
            "guid": "062d5839-4d36-402f-bfa4-02811eb936e9",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#avoid-combining-traffic-manager-and-front-door",
            "service": "Front Door",
            "services": [
                "FrontDoor",
                "EventHubs",
                "TrafficManager"
            ],
            "severity": "High",
            "subcategory": "Front Door",
            "text": "Avoid placing Traffic Manager behind Front Door.",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "graph": "cdnresources | where type =~ 'microsoft.cdn/profiles/origingroups/origins' | extend frontDoorId = substring(id, 0, indexof(id, '/origins')) | extend compliant = isempty(properties.originHostHeader) or (tostring(properties.hostName) =~ tostring(properties.originHostHeader)) | project id=frontDoorId, originName = name, compliant",
            "guid": "5efeb96a-003f-4b18-8fcd-b4d84459c2b2",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-the-same-domain-name-on-front-door-and-your-origin",
            "service": "Front Door",
            "services": [
                "FrontDoor"
            ],
            "severity": "High",
            "subcategory": "Front Door",
            "text": "Use the same domain name on Azure Front Door and your origin. Mismatched host names can cause subtle bugs.",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "graph": "cdnresources | where type =~ 'microsoft.cdn/profiles/origingroups/origins' | extend frontDoorId = substring(id, 0, indexof(id, '/origingroups')) | extend originGroupId = substring(id, 0, indexof(id, '/origins')) | join kind=inner (cdnresources | where type =~ 'microsoft.cdn/profiles/origingroups' | extend originGroupName = name | extend hasHealthProbe = isnotnull(properties.healthProbeSettings)) on $left.originGroupId == $right.id | summarize numberOrigins = count() by originGroupId, subscriptionId, frontDoorId, hasHealthProbe, originGroupName | extend compliant = not(numberOrigins == 1 and hasHealthProbe) | project id = frontDoorId, compliant",
            "guid": "0b5a380c-4bfb-47bc-b1d7-dcfef363a61b",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#disable-health-probes-when-theres-only-one-origin-in-an-origin-group",
            "service": "Front Door",
            "services": [
                "FrontDoor"
            ],
            "severity": "Low",
            "subcategory": "Front Door",
            "text": "Disable health probes when there is only one origin in an Azure Front Door origin group.",
            "waf": "Performance"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "guid": "5567048e-e5d7-4206-9c55-b5ed45d2cc0c",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#select-good-health-probe-endpoints",
            "service": "Front Door",
            "services": [
                "FrontDoor"
            ],
            "severity": "Medium",
            "subcategory": "Front Door",
            "text": "Select good health probe endpoints for Azure Front Door. Consider building health endpoints that check all of your application's dependencies.",
            "waf": "Reliability"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "graph": "cdnresources | where type =~ 'microsoft.cdn/profiles/origingroups' | extend frontDoorId = substring(id, 0, indexof(id, '/origingroups/')) | extend compliant = (isnull(properties['healthProbeSettings']['probeRequestType']) or toupper(properties['healthProbeSettings']['probeRequestType']) == 'HEAD') | project compliant, id=frontDoorId",
            "guid": "a13f72f3-8f5c-4864-95e5-75bf37fbbeb1",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-head-health-probes",
            "service": "Front Door",
            "services": [
                "FrontDoor"
            ],
            "severity": "Low",
            "subcategory": "Front Door",
            "text": "Use HEAD health probes with Azure Front Door, to reduce the traffic that Front Door sends to your application.",
            "waf": "Performance"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "graph": "cdnresources | where type =~ 'microsoft.cdn/profiles/customdomains' | extend frontDoorId = substring(id, 0, indexof(id, '/customdomains')) | extend compliant = (isnull(properties['tlsSettings']['certificateType']) or tolower(properties['tlsSettings']['certificateType']) =~ 'customercertificate') | project compliant, id = frontDoorId",
            "guid": "af95c92d-d723-4f4a-98d7-8722324efd4d",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-managed-tls-certificates",
            "service": "Front Door",
            "services": [
                "AKV",
                "FrontDoor",
                "Cost"
            ],
            "severity": "High",
            "subcategory": "Front Door",
            "text": "Use managed TLS certificates with Azure Front Door. Reduce operational cost and risk of outages due to certificate renewals.",
            "waf": "Operations"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "guid": "189ea962-3969-4863-8f5a-5ad808c2cf4b",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#define-your-waf-configuration-as-code",
            "service": "Front Door",
            "services": [
                "WAF",
                "FrontDoor"
            ],
            "severity": "Medium",
            "subcategory": "Front Door",
            "text": "Define your Azure Front Door WAF configuration as code. By using code, you can more easily adopt new rule set version and gain additional protection.",
            "waf": "Operations"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "graph": "cdnresources | where type == 'microsoft.cdn/profiles/afdendpoints/routes' | extend frontDoorId = substring(id, 0, indexof(id, '/afdendpoints')) | extend forwardingProtocol=tostring(properties.forwardingProtocol),supportedProtocols=properties.supportedProtocols,httpsRedirect=properties.httpsRedirect | extend compliant = forwardingProtocol =~ 'httpsonly' and (supportedProtocols has 'https' or httpsRedirect =~ 'enabled') | project id = frontDoorId, compliant",
            "guid": "2e30abab-5478-417c-81bf-bf1ad4ed1ed4",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-end-to-end-tls",
            "service": "Front Door",
            "services": [
                "FrontDoor"
            ],
            "severity": "High",
            "subcategory": "Front Door",
            "text": "Use end-to-end TLS with Azure Front Door. Use TLS for connections from your clients to Front Door, and from Front Door to your origin.",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "graph": "cdnresources | where type == 'microsoft.cdn/profiles/afdendpoints/routes' | extend frontDoorId = substring(id, 0, indexof(id, '/afdendpoints')) | extend forwardingProtocol=tostring(properties.forwardingProtocol),supportedProtocols=properties.supportedProtocols,httpsRedirect=properties.httpsRedirect | extend compliant = httpsRedirect =~ 'enabled' | project id = frontDoorId, compliant",
            "guid": "10aa45af-166f-44c4-9f36-b6d592dac2ca",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-http-to-https-redirection",
            "service": "Front Door",
            "services": [
                "FrontDoor"
            ],
            "severity": "Medium",
            "subcategory": "Front Door",
            "text": "Use HTTP to HTTPS redirection with Azure Front Door. Support older clients by redirecting them to an HTTPS request automatically.",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "guid": "28b9ee82-b2c7-45aa-bc98-6de6f59a095d",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#enable-the-waf",
            "service": "Front Door",
            "services": [
                "WAF",
                "FrontDoor"
            ],
            "severity": "High",
            "subcategory": "Front Door",
            "text": "Enable the Azure Front Door WAF. Protect your application from a range of attacks.",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "guid": "2902d8cc-1b0c-4495-afad-624ab70f7bd6",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#tune-your-waf",
            "service": "Front Door",
            "services": [
                "WAF",
                "FrontDoor"
            ],
            "severity": "High",
            "subcategory": "Front Door",
            "text": "Tune the Azure Front Door WAF for your workload by configuring the WAF in Detection mode to reduce and fix false positive detections.",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "guid": "17ba124b-127d-42b6-9322-388d5b2bbcfc",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/application-gateway-waf-request-size-limits#request-body-inspection",
            "service": "Front Door",
            "services": [
                "AzurePolicy",
                "WAF",
                "FrontDoor"
            ],
            "severity": "High",
            "subcategory": "Front Door",
            "text": "Enable request body inspection feature enabled in Azure Front Door WAF policy.",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "guid": "49a98f2b-ec22-4a87-9415-6a10b00d6555",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#enable-default-rule-sets",
            "service": "Front Door",
            "services": [
                "WAF",
                "FrontDoor"
            ],
            "severity": "High",
            "subcategory": "Front Door",
            "text": "Enable the Azure Front Door WAF default rule sets. The default rule sets detect and block common attacks.",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "guid": "147a13d4-2a2f-4824-a524-f5855b52b946",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#enable-bot-management-rules",
            "service": "Front Door",
            "services": [
                "WAF",
                "FrontDoor"
            ],
            "severity": "High",
            "subcategory": "Front Door",
            "text": "Enable the Azure Front Door WAF bot protection rule set. The bot rules detect good and bad bots.",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "guid": "d7dcdcb9-0d99-44b9-baab-ac7570ede79a",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#use-the-latest-ruleset-versions",
            "service": "Front Door",
            "services": [
                "WAF",
                "FrontDoor"
            ],
            "severity": "Medium",
            "subcategory": "Front Door",
            "text": "Use the latest Azure Front Door WAF rule set version. Rule set updates are regularly updated to take account of the current threat landscape.",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "guid": "b9620385-1cde-418f-914b-a84a06982ffc",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#add-rate-limiting",
            "service": "Front Door",
            "services": [
                "WAF",
                "FrontDoor"
            ],
            "severity": "Medium",
            "subcategory": "Front Door",
            "text": "Add rate limiting to the Azure Front Door WAF. Rate limiting blocks clients accidentally or intentionally sending large amounts of traffic in a short period of time.",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "guid": "6dc36c52-0124-4ffe-9eaf-23ec1282dedb",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#use-a-high-threshold-for-rate-limits",
            "service": "Front Door",
            "services": [
                "WAF",
                "FrontDoor"
            ],
            "severity": "Medium",
            "subcategory": "Front Door",
            "text": "Use a high threshold for Azure Front Door WAF rate limits. High rate limit thresholds avoid blocking legitimate traffic, while still providing protection against extremely high numbers of requests that might overwhelm your infrastructure.",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "guid": "388a3d0e-0a43-4367-90b2-3dd2aeece5ee",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#geo-filter-traffic",
            "service": "Front Door",
            "services": [
                "FrontDoor"
            ],
            "severity": "Low",
            "subcategory": "Front Door",
            "text": "If you are not expecting traffic from all geographical regions, use geo-filters to block traffic from non-expected countries.",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "guid": "00acd8a9-6975-414f-8491-2be6309893b8",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#specify-the-unknown-zz-location",
            "service": "Front Door",
            "services": [
                "WAF",
                "FrontDoor"
            ],
            "severity": "Medium",
            "subcategory": "Front Door",
            "text": "Specify the unknown (ZZ) location when geo-filtering traffic with the Azure Front Door WAF. Avoid accidentally blocking legitimate requests when IP addresses can't be geo-matched.",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "guid": "4cea4050-7946-4a7c-89e6-b021b73c352d",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#add-diagnostic-settings-to-save-your-wafs-logs",
            "service": "Front Door",
            "services": [
                "WAF",
                "FrontDoor",
                "Monitor"
            ],
            "severity": "Medium",
            "subcategory": "Front Door",
            "text": "Capture logs and metrics by turning on Diagnostic Settings. Include resource activity logs, access logs, health probe logs, and WAF logs. Set up alerts.",
            "waf": "Operations"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "guid": "845f5f91-9c21-4674-a725-5ce890850e20",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#send-logs-to-microsoft-sentinel",
            "service": "Front Door",
            "services": [
                "WAF",
                "FrontDoor",
                "Sentinel"
            ],
            "severity": "Medium",
            "subcategory": "Front Door",
            "text": "Send Azure Front Door WAF logs to Microsoft Sentinel.",
            "waf": "Operations"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "guid": "3bb0a854-ea3d-4212-bd8e-3f0cb7792b02",
            "link": "https://learn.microsoft.com/azure/frontdoor/routing-methods",
            "service": "Front Door",
            "services": [
                "FrontDoor",
                "Backup"
            ],
            "severity": "Medium",
            "subcategory": "Front Door",
            "text": "Choose a routing method that supports your deployment strategy. The weighted method, which distributes traffic based on the configured weight coefficient, supports active-active models. A priority-based value that configures the primary region to receive all traffic and send traffic to the secondary region as a backup supports active-passive models. Combine the preceding methods with latency so that the origin with the lowest latency receives traffic.",
            "waf": "Reliability"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "graph": "cdnresources | where type =~ 'microsoft.cdn/profiles/origingroups' | extend frontDoorId = substring(id, 0, indexof(id, '/origingroups')) | extend healthprobe=tostring(properties.healthProbeSettings) | project origingroupname=name, id, tags, resourceGroup, subscriptionId, healthprobe, frontDoorId | join ( cdnresources | where type =~ 'microsoft.cdn/profiles/origingroups/Origins' | extend origingroupname = tostring(properties.originGroupName) ) on origingroupname | summarize origincount=count(), enabledhealthprobecount=countif(healthprobe != '') by origingroupname, id, tostring(tags), resourceGroup, subscriptionId, frontDoorId | extend compliant = origincount > 1 | project id = frontDoorId, compliant",
            "guid": "c3a769e4-cc78-40a9-b36a-f9bcab19ec2d",
            "link": "https://learn.microsoft.com/azure/frontdoor/quickstart-create-front-door",
            "service": "Front Door",
            "services": [
                "FrontDoor"
            ],
            "severity": "High",
            "subcategory": "Front Door",
            "text": "Support redundancy by having multiple origins in one or more back-end pools. Always have redundant instances of your application and make sure each instance exposes an endpoint or origin. You can place those origins in one or more back-end pools.",
            "waf": "Reliability"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "guid": "999852be-2137-4179-8fc3-30d1df6fed1d",
            "link": "https://learn.microsoft.com/azure/frontdoor/troubleshoot-issues#troubleshooting-steps",
            "service": "Front Door",
            "services": [
                "FrontDoor"
            ],
            "severity": "Medium",
            "subcategory": "Front Door",
            "text": "Set a timeout on forwarding requests to the back end. Adjust the timeout setting according to your endpoints' needs. If you don't, Azure Front Door might close the connection before the origin sends the response. You can also lower the default timeout for Azure Front Door if all of your origins have a shorter timeout.",
            "waf": "Reliability"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "guid": "17bf6351-3e5e-41f1-87bb-d5ad0b4e3de6",
            "link": "https://learn.microsoft.com/azure/frontdoor/routing-methods#23session-affinity",
            "service": "Front Door",
            "services": [
                "FrontDoor"
            ],
            "severity": "Medium",
            "subcategory": "Front Door",
            "text": "Decide if your application requires session affinity. If you have high reliability requirements, we recommend that you disable session affinity.",
            "waf": "Reliability"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "guid": "425bfb31-94c4-4007-b9ae-46da9fe57cc7",
            "link": "https://learn.microsoft.com/azure/frontdoor/origin?pivots=front-door-standard-premium#origin-host-header",
            "service": "Front Door",
            "services": [
                "FrontDoor"
            ],
            "severity": "Medium",
            "subcategory": "Front Door",
            "text": "Send the host header to the back end. The back-end services should be aware of the host name so that they can create rules to accept traffic only from that host.",
            "waf": "Security"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "guid": "81a5398a-2414-450f-9fc3-e048bc65784c",
            "link": "https://learn.microsoft.com/azure/frontdoor/front-door-caching",
            "service": "Front Door",
            "services": [
                "FrontDoor"
            ],
            "severity": "Medium",
            "subcategory": "Front Door",
            "text": "Use caching for endpoints that support it.",
            "waf": "Cost"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "graph": "cdnresources | where type =~ 'microsoft.cdn/profiles/origingroups' | extend frontDoorId = substring(id, 0, indexof(id, '/origingroups')) | extend healthprobe=tostring(properties.healthProbeSettings) | project origingroupname=name, id, tags, resourceGroup, subscriptionId, healthprobe, frontDoorId | join ( cdnresources | where type =~ 'microsoft.cdn/profiles/origingroups/Origins' | extend origingroupname = tostring(properties.originGroupName) ) on origingroupname | summarize origincount=count(), enabledhealthprobecount=countif(healthprobe != '') by origingroupname, id, tostring(tags), resourceGroup, subscriptionId, frontDoorId | extend compliant = origincount > 1 or (origincount == 1 and enabledhealthprobecount == 0) | project id = frontDoorId, compliant",
            "guid": "34069d73-e4de-46c5-a36f-625f87575a56",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#disable-health-probes-when-theres-only-one-origin-in-an-origin-group",
            "service": "Front Door",
            "services": [
                "FrontDoor"
            ],
            "severity": "Low",
            "subcategory": "Front Door",
            "text": "Disable health checks in single back-end pools. If you have only one origin configured in your Azure Front Door origin group, these calls are unnecessary. This is only recommended if you can't have multiple origins in your endpoint.",
            "waf": "Cost"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "guid": "c92d6786-cdd1-444d-9cad-934a192a276a",
            "link": "https://learn.microsoft.com/azure/frontdoor/standard-premium/how-to-reports",
            "service": "Front Door",
            "services": [
                "FrontDoor",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Front Door",
            "text": "We recommend using the Premium Tier for leveraging the Security reports while the Standard Azure Front Door Profile provides only traffic reports under built-in analytics/reports.",
            "waf": "Operations"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "guid": "440cf7de-30a1-4550-ab50-c9f6eac140cd",
            "link": "https://learn.microsoft.com/azure/frontdoor/front-door-wildcard-domain",
            "service": "Front Door",
            "services": [
                "AKV",
                "FrontDoor"
            ],
            "severity": "Medium",
            "subcategory": "Front Door",
            "text": "Use wildcard TLS certificates when possible.",
            "waf": "Operations"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "guid": "556e2733-6ca9-4edd-9cc7-26de66d46c2e",
            "link": "https://learn.microsoft.com/azure/frontdoor/front-door-caching",
            "service": "Front Door",
            "services": [
                "FrontDoor"
            ],
            "severity": "Medium",
            "subcategory": "Front Door",
            "text": "Optimize your application query string for caching. For purely static content, ignore query strings to maximize your use of the cache. If your application uses query strings, consider including them in the cache key. Including the query strings in the cache key allows Azure Front Door to serve cached responses or other responses, based on your configuration.",
            "waf": "Performance"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "guid": "c0b7e55e-fcab-4e66-bdae-bd0290f6aece",
            "link": "https://learn.microsoft.com/azure/frontdoor/standard-premium/how-to-compression",
            "service": "Front Door",
            "services": [
                "FrontDoor",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Front Door",
            "text": "Use file compression when you're accessing downloadable content.",
            "waf": "Performance"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "graph": "resources | where type =~ 'microsoft.network/frontdoors' and properties['resourceState'] !~ 'migrated' | extend compliant = false | project id, compliant",
            "guid": "cb8eb8c0-aa73-4a26-a495-6eba8dc4a243",
            "link": "https://learn.microsoft.com/azure/cdn/tier-migration",
            "service": "Front Door",
            "services": [
                "FrontDoor"
            ],
            "severity": "High",
            "subcategory": "Front Door",
            "text": "Consider migrating to Standard or Premium SKU if you are using Classic Azure Front Door currently as Classic Azure Front Door will be deprecated by March 2027.",
            "waf": "Operations"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "guid": "67c33697-15b1-4752-aeee-0b9b588defc4",
            "link": "https://learn.microsoft.com/azure/architecture/guide/networking/global-web-applications/mission-critical-content-delivery",
            "service": "Front Door",
            "services": [
                "FrontDoor",
                "TrafficManager",
                "Storage"
            ],
            "severity": "Medium",
            "subcategory": "Front Door",
            "text": "Consider using Traffic Manager load balancing Azure Front Door and a third party CDN provider CDN profile for mission critical high availability scenario. ",
            "waf": "Reliability"
        },
        {
            "category": "Network Topology and Connectivity",
            "checklist": "Azure Application Delivery Networking",
            "guid": "972cd4cd-25b0-4b70-96e9-eab4bfd32907",
            "link": "https://learn.microsoft.com/azure/app-service/app-service-ip-restrictions?tabs=azurecli#restrict-access-to-a-specific-azure-front-door-instance",
            "service": "Front Door",
            "services": [
                "FrontDoor",
                "AppSvc"
            ],
            "severity": "High",
            "subcategory": "Front Door",
            "text": "When using Front Door with origin as App services, consider locking down the traffic to app services only through Azure Front Door using access restrictions. ",
            "waf": "Security"
        },
        {
            "category": "Operations Management",
            "checklist": "MySQL Review Checklist",
            "guid": "388c3e25-e800-4ad2-9df3-f3d6ae1050b7",
            "link": "https://learn.microsoft.com/azure/mysql/flexible-server/overview",
            "service": "Azure MySQL",
            "services": [
                "SQL"
            ],
            "severity": "Medium",
            "subcategory": "Best Practices",
            "text": "Leverage Flexible Server",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "MySQL Review Checklist",
            "guid": "de3aad1e-8c38-4ec9-9666-7313c005674b",
            "link": "https://learn.microsoft.com/azure/mysql/flexible-server/overview#high-availability-within-and-across-availability-zones",
            "service": "Azure MySQL",
            "services": [
                "SQL"
            ],
            "severity": "High",
            "subcategory": "Best Practices",
            "text": "Leverage Availability Zones where regionally applicable",
            "waf": "Reliability"
        },
        {
            "category": "Operations Management",
            "checklist": "MySQL Review Checklist",
            "guid": "1e944a45-9c37-43e7-bd61-623b365a917e",
            "link": "https://learn.microsoft.com/azure/mysql/flexible-server/overview#setup-hybrid-or-multi-cloud-data-synchronization-with-data-in-replication",
            "service": "Azure MySQL",
            "services": [
                "SQL"
            ],
            "severity": "Medium",
            "subcategory": "Best Practices",
            "text": "Leverage Data-in replication for cross-region DR scenarios",
            "waf": "Reliability"
        }
    ],
    "metadata": {
        "name": "Master checklist",
        "timestamp": "October 01, 2024"
    },
    "severities": [
        {
            "name": "High"
        },
        {
            "name": "Medium"
        },
        {
            "name": "Low"
        }
    ],
    "status": [
        {
            "description": "This check has not been looked at yet",
            "name": "Not verified"
        },
        {
            "description": "There is an action item associated to this check",
            "name": "Open"
        },
        {
            "description": "This check has been verified, and there are no further action items associated to it",
            "name": "Fulfilled"
        },
        {
            "description": "Recommendation understood, but not needed by current requirements",
            "name": "Not required"
        },
        {
            "description": "Not applicable for current design",
            "name": "N/A"
        }
    ]
}
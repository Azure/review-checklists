{
    "categories": [
        {
            "name": "Identidad y acceso"
        },
        {
            "name": "Topología y conectividad de red"
        },
        {
            "name": "Seguridad, gobernanza y cumplimiento"
        },
        {
            "name": "Gestión y Monitoreo"
        },
        {
            "name": "Grupo de administración y suscripciones"
        },
        {
            "name": "Operaciones"
        },
        {
            "name": "Copia de seguridad y recuperación ante desastres"
        }
    ],
    "items": [
        {
            "category": "Copia de seguridad y recuperación ante desastres",
            "guid": "7ea02e1c-7166-45a3-bdf5-098891367fcb",
            "link": "https://learn.microsoft.com/azure/reliability/cross-region-replication-azure",
            "severity": "Medio",
            "subcategory": "Protección de datos",
            "text": "Considere la replicación entre regiones en Azure para BCDR con regiones emparejadas",
            "waf": "Fiabilidad"
        },
        {
            "category": "Copia de seguridad y recuperación ante desastres",
            "guid": "eba8cf22-45c6-4dc1-9b57-2cceb3b97ce5",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-redundancy",
            "severity": "Medio",
            "subcategory": "Protección de datos",
            "text": "Al usar Azure Backup, tenga en cuenta los diferentes tipos de copia de seguridad (GRS, ZRS Y LRS) ya que la configuración predeterminada es GRS",
            "waf": "Fiabilidad"
        },
        {
            "category": "Identidad y acceso",
            "guid": "984a859c-773e-47d2-9162-3a765a917e1f",
            "link": "https://learn.microsoft.com/azure/active-directory/roles/security-emergency-access",
            "severity": "Alto",
            "subcategory": "Identidad",
            "text": "Implementar para el acceso de emergencia o cuentas de vidrio roto para evitar el bloqueo de cuentas en todo el inquilino",
            "training": "https://learn.microsoft.com/learn/modules/azure-ad-privileged-identity-management/",
            "waf": "Seguridad"
        },
        {
            "category": "Identidad y acceso",
            "guid": "348ef254-c27d-442e-abba-c7571559ab91",
            "link": "https://learn.microsoft.com/azure/role-based-access-control/overview",
            "severity": "Alto",
            "subcategory": "Identidad",
            "text": "Aplicar un modelo RBAC para grupos de administración, suscripciones, grupos de recursos y recursos",
            "training": "https://learn.microsoft.com/learn/paths/implement-resource-mgmt-security/",
            "waf": "Seguridad"
        },
        {
            "category": "Identidad y acceso",
            "guid": "53e8908a-e28c-484c-93b6-b7808b9fe5c4",
            "link": "https://learn.microsoft.com/azure/active-directory/conditional-access/overview",
            "severity": "Bajo",
            "subcategory": "Identidad",
            "text": "Aplicar directivas de acceso condicional de Azure AD para cualquier usuario con derechos en entornos de Azure",
            "training": "https://learn.microsoft.com/learn/modules/plan-implement-administer-conditional-access/",
            "waf": "Seguridad"
        },
        {
            "category": "Identidad y acceso",
            "guid": "1049d403-a923-4c34-94d0-0018ac6a9e01",
            "link": "https://learn.microsoft.com/azure/active-directory/authentication/concept-mfa-howitworks",
            "severity": "Alto",
            "subcategory": "Identidad",
            "text": "Aplicar la autenticación multifactor para cualquier usuario con derechos en los entornos de Azure",
            "training": "https://learn.microsoft.com/learn/modules/secure-aad-users-with-mfa/",
            "waf": "Seguridad"
        },
        {
            "category": "Identidad y acceso",
            "guid": "e6a83de5-de32-4c19-a248-1607d5d1e4e6",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/manage/centralize-operations",
            "severity": "Medio",
            "subcategory": "Identidad",
            "text": "Aplique responsabilidades centralizadas y delegadas para administrar los recursos implementados dentro de la zona de aterrizaje, en función de los requisitos de rol y seguridad",
            "training": "https://learn.microsoft.com/learn/paths/azure-administrator-manage-identities-governance/",
            "waf": "Seguridad"
        },
        {
            "category": "Identidad y acceso",
            "guid": "14658d35-58fd-4772-99b8-21112df27ee4",
            "link": "https://learn.microsoft.com/azure/active-directory/privileged-identity-management/pim-configure",
            "severity": "Medio",
            "subcategory": "Identidad",
            "text": "Aplicar Azure AD Privileged Identity Management (PIM) para establecer un acceso sin pie y privilegios mínimos",
            "training": "https://learn.microsoft.com/learn/modules/azure-ad-privileged-identity-management/",
            "waf": "Seguridad"
        },
        {
            "category": "Identidad y acceso",
            "guid": "12e7f983-f630-4472-8dd6-9c5b5c2622f5",
            "link": "https://learn.microsoft.com/azure/active-directory/roles/security-planning#identify-microsoft-accounts-in-administrative-roles-that-need-to-be-switched-to-work-or-school-accounts",
            "severity": "Alto",
            "subcategory": "Identidad",
            "text": "Utilice únicamente el tipo de autenticación Cuenta profesional o educativa para todos los tipos de cuenta. Evite usar la cuenta Microsoft",
            "training": "https://learn.microsoft.com/learn/modules/explore-basic-services-identity-types/",
            "waf": "Seguridad"
        },
        {
            "category": "Identidad y acceso",
            "guid": "4b69bad3-3aad-45e8-a68e-1d76667313b4",
            "link": "https://learn.microsoft.com/azure/active-directory/fundamentals/active-directory-groups-create-azure-portal",
            "severity": "Medio",
            "subcategory": "Identidad",
            "text": "Utilice solo grupos para asignar permisos. Agregue grupos locales al grupo solo de Azure AD si ya hay un sistema de administración de grupos implementado.",
            "training": "https://learn.microsoft.com/learn/paths/manage-identity-and-access/",
            "waf": "Seguridad"
        },
        {
            "category": "Identidad y acceso",
            "guid": "f5664b5e-984a-4859-a773-e7d261623a76",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/identity-access#prerequisites-for-a-landing-zone---design-recommendations",
            "severity": "Medio",
            "subcategory": "Identidad",
            "text": "Considere la posibilidad de usar roles personalizados de Azure para los siguientes roles clave: propietario de la plataforma Azure, administración de red, operaciones de seguridad, propietario de la suscripción, propietario de la aplicación",
            "training": "https://learn.microsoft.com/learn/modules/create-custom-azure-roles-with-rbac/",
            "waf": "Seguridad"
        },
        {
            "category": "Identidad y acceso",
            "guid": "5a917e1f-348e-4f25-9c27-d42e8bbac757",
            "link": "https://azure.microsoft.com/resources/achieving-compliant-data-residency-and-security-with-azure/",
            "severity": "Medio",
            "subcategory": "Identidad",
            "text": "Si existen requisitos de soberanía de datos, se pueden implementar directivas de Azure para aplicarlos",
            "training": "https://learn.microsoft.com/learn/paths/secure-your-cloud-data/",
            "waf": "Seguridad"
        },
        {
            "category": "Identidad y acceso",
            "guid": "1559ab91-53e8-4908-ae28-c84c33b6b780",
            "link": "https://learn.microsoft.com/azure/active-directory-domain-services/overview",
            "severity": "Medio",
            "subcategory": "Identidad",
            "text": "Si Azure Active Directory Domains Services (AADDS) está en uso, implemente AADDS dentro de la región principal, ya que este servicio solo se puede proyectar en una suscripción.",
            "training": "https://learn.microsoft.com/learn/modules/azure-active-directory/",
            "waf": "Seguridad"
        },
        {
            "category": "Identidad y acceso",
            "guid": "8b9fe5c4-1049-4d40-9a92-3c3474d00018",
            "link": "https://learn.microsoft.com/azure/active-directory-domain-services/overview",
            "severity": "Medio",
            "subcategory": "Identidad",
            "text": "Si AADDS está en uso, evalúe la compatibilidad de todas las cargas de trabajo",
            "training": "https://learn.microsoft.com/learn/modules/implement-hybrid-identity-windows-server/",
            "waf": "Seguridad"
        },
        {
            "category": "Identidad y acceso",
            "guid": "ac6a9e01-e6a8-43de-9de3-2c1992481607",
            "link": "https://learn.microsoft.com/azure/architecture/reference-architectures/identity/adds-extend-domain",
            "severity": "Medio",
            "subcategory": "Identidad",
            "text": "Si AD en Windows Server está en uso, ¿pueden todos los recursos necesarios acceder al controlador de dominio correcto?",
            "training": "https://learn.microsoft.com/learn/paths/implement-windows-server-iaas-virtual-machine-identity/",
            "waf": "Seguridad"
        },
        {
            "category": "Identidad y acceso",
            "guid": "d5d1e4e6-1465-48d3-958f-d77249b82111",
            "link": "https://learn.microsoft.com/azure/active-directory/app-proxy/application-proxy",
            "severity": "Medio",
            "subcategory": "Identidad",
            "text": "Considere la posibilidad de usar Azure AD Application Proxy como reemplazo de VPN o proxy inverso para proporcionar a los usuarios remotos acceso seguro y autenticado a las aplicaciones internas (hospedadas en la nube o localmente).",
            "training": "https://learn.microsoft.com/learn/paths/implement-applications-external-access-azure-ad/",
            "waf": "Seguridad"
        },
        {
            "category": "Identidad y acceso",
            "guid": "35037e68-9349-4c15-b371-228514f4cdff",
            "link": "https://learn.microsoft.com/azure/active-directory/roles/best-practices",
            "severity": "Medio",
            "subcategory": "Identidad",
            "text": "Evite usar cuentas sincronizadas locales para las asignaciones de roles de Azure AD.",
            "training": "https://learn.microsoft.com/learn/modules/design-identity-security-strategy/",
            "waf": "Seguridad"
        },
        {
            "category": "Grupo de administración y suscripciones",
            "graph": "resourcecontainers| where type == 'microsoft.resources/subscriptions'| extend ManagementGroup = tostring(tags),mgmtChain = properties.managementGroupAncestorsChain| extend compliant =( array_length(mgmtChain) <= 4 and array_length(mgmtChain) > 1)",
            "guid": "2df27ee4-12e7-4f98-9f63-04722dd69c5b",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/resource-org-management-groups",
            "severity": "Medio",
            "subcategory": "Suscripciones",
            "text": "Aplique una jerarquía de grupos de administración razonablemente plana con no más de tres o cuatro niveles, idealmente",
            "training": "https://learn.microsoft.com/learn/modules/azure-architecture-fundamentals/",
            "waf": "Seguridad"
        },
        {
            "category": "Grupo de administración y suscripciones",
            "graph": "resources | extend compliant = isnotnull(['tags']) | project name, id, subscriptionId, resourceGroup, tags, compliant",
            "guid": "5c2622f5-4b69-4bad-93aa-d5e8c68e1d76",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/decision-guides/resource-tagging/?toc=/azure/azure-resource-manager/management/toc.json",
            "severity": "Medio",
            "subcategory": "Suscripciones",
            "text": "Aplicación o anexión de etiquetas de recursos a través de Azure Policy",
            "training": "https://learn.microsoft.com/learn/paths/implement-resource-mgmt-security/",
            "waf": "Seguridad"
        },
        {
            "category": "Grupo de administración y suscripciones",
            "guid": "667313b4-f566-44b5-b984-a859c773e7d2",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/resource-org-management-groups#management-group-recommendations",
            "severity": "Medio",
            "subcategory": "Suscripciones",
            "text": "Aplicación de un grupo de administración de espacio aislado para permitir a los usuarios experimentar inmediatamente con Azure",
            "training": "https://learn.microsoft.com/learn/paths/enterprise-scale-architecture/",
            "waf": "Seguridad"
        },
        {
            "category": "Grupo de administración y suscripciones",
            "guid": "61623a76-5a91-47e1-b348-ef254c27d42e",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/resource-org-management-groups#management-group-recommendations",
            "severity": "Medio",
            "subcategory": "Suscripciones",
            "text": "Aplicación de un grupo de administración de plataforma en el grupo de administración raíz para admitir la directiva de plataforma común y la asignación de roles de Azure",
            "training": "https://learn.microsoft.com/learn/paths/enterprise-scale-architecture/",
            "waf": "Seguridad"
        },
        {
            "category": "Grupo de administración y suscripciones",
            "guid": "8bbac757-1559-4ab9-853e-8908ae28c84c",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/resource-org-management-groups#management-group-recommendations",
            "severity": "Medio",
            "subcategory": "Suscripciones",
            "text": "Aplique una suscripción de conectividad dedicada en el grupo de administración de plataforma para hospedar un concentrador WAN virtual de Azure, un sistema de nombres de dominio (DNS) privado, un circuito ExpressRoute y otros recursos de red.",
            "training": "https://learn.microsoft.com/learn/paths/enterprise-scale-architecture/",
            "waf": "Seguridad"
        },
        {
            "category": "Grupo de administración y suscripciones",
            "graph": "resourcecontainers| where type == 'microsoft.resources/subscriptions'| extend ManagementGroup = tostring(tags),mgmtChain = properties.managementGroupAncestorsChain| extend compliant = (array_length(mgmtChain) > 1)",
            "guid": "33b6b780-8b9f-4e5c-9104-9d403a923c34",
            "link": "https://learn.microsoft.com/azure/governance/management-groups/how-to/protect-resource-hierarchy#setting---default-management-group",
            "severity": "Medio",
            "subcategory": "Suscripciones",
            "text": "Exigir que no se coloquen suscripciones en el grupo de administración raíz",
            "waf": "Seguridad"
        },
        {
            "category": "Grupo de administración y suscripciones",
            "guid": "74d00018-ac6a-49e0-8e6a-83de5de32c19",
            "link": "https://learn.microsoft.com/azure/governance/management-groups/how-to/protect-resource-hierarchy#setting---require-authorization",
            "severity": "Medio",
            "subcategory": "Suscripciones",
            "text": "Exigir que solo los usuarios con privilegios puedan operar grupos de administración en el inquilino habilitando la autorización RBAC de Azure en la configuración de la jerarquía de grupos de administración",
            "waf": "Seguridad"
        },
        {
            "category": "Grupo de administración y suscripciones",
            "guid": "92481607-d5d1-4e4e-9146-58d3558fd772",
            "link": "https://learn.microsoft.com/azure/governance/management-groups/overview",
            "severity": "Medio",
            "subcategory": "Suscripciones",
            "text": "Aplique grupos de administración bajo el grupo de administración de nivel raíz para representar los tipos de cargas de trabajo, en función de sus necesidades de seguridad, cumplimiento, conectividad y características.",
            "waf": "Seguridad"
        },
        {
            "category": "Grupo de administración y suscripciones",
            "guid": "49b82111-2df2-47ee-912e-7f983f630472",
            "link": "https://learn.microsoft.com/azure/governance/management-groups/overview",
            "severity": "Alto",
            "subcategory": "Suscripciones",
            "text": "Aplique un proceso para que los propietarios de recursos conozcan sus roles y responsabilidades, acceda a la revisión, la revisión del presupuesto, el cumplimiento de las políticas y corrija cuando sea necesario.",
            "waf": "Seguridad"
        },
        {
            "category": "Grupo de administración y suscripciones",
            "guid": "2dd69c5b-5c26-422f-94b6-9bad33aad5e8",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits",
            "severity": "Medio",
            "subcategory": "Suscripciones",
            "text": "Asegúrese de que todos los propietarios de suscripciones y el equipo central de TI conozcan las limitaciones de recursos de suscripción como parte de las sesiones de diseño de cargas de trabajo.",
            "waf": "Seguridad"
        },
        {
            "category": "Grupo de administración y suscripciones",
            "guid": "c68e1d76-6673-413b-9f56-64b5e984a859",
            "link": "https://learn.microsoft.com/azure/cost-management-billing/reservations/save-compute-costs-reservations",
            "severity": "Alto",
            "subcategory": "Suscripciones",
            "text": "Utilice instancias reservadas cuando corresponda para optimizar los costos y garantizar la capacidad disponible en las regiones de destino. Explique el uso de SKU de máquina virtual de instancia reservada adquiridas a través de Azure Policy.",
            "training": "https://learn.microsoft.com/learn/paths/improve-reliability-modern-operations/",
            "waf": "Seguridad"
        },
        {
            "category": "Grupo de administración y suscripciones",
            "guid": "c773e7d2-6162-43a7-95a9-17e1f348ef25",
            "link": "https://learn.microsoft.com/azure/architecture/framework/scalability/design-capacity",
            "severity": "Alto",
            "subcategory": "Suscripciones",
            "text": "Aplicar un panel, un libro de trabajo o un proceso manual para supervisar los niveles de capacidad utilizados",
            "training": "https://learn.microsoft.com/learn/paths/monitor-usage-performance-availability-resources-azure-monitor/",
            "waf": "Seguridad"
        },
        {
            "category": "Grupo de administración y suscripciones",
            "guid": "4c27d42e-8bba-4c75-9155-9ab9153e8908",
            "link": "https://azure.microsoft.com/global-infrastructure/services/",
            "severity": "Medio",
            "subcategory": "Suscripciones",
            "text": "Asegúrese de que los servicios y características necesarios estén disponibles dentro de las regiones de implementación elegidas",
            "training": "https://learn.microsoft.com/learn/modules/azure-architecture-fundamentals/",
            "waf": "Seguridad"
        },
        {
            "category": "Grupo de administración y suscripciones",
            "guid": "ae28c84c-33b6-4b78-88b9-fe5c41049d40",
            "link": "https://learn.microsoft.com/azure/cost-management-billing/cost-management-billing-overview",
            "severity": "Alto",
            "subcategory": "Suscripciones",
            "text": "Aplicar un proceso para la gestión de costos",
            "training": "https://learn.microsoft.com/learn/paths/control-spending-manage-bills/",
            "waf": "Seguridad"
        },
        {
            "category": "Grupo de administración y suscripciones",
            "guid": "3a923c34-74d0-4001-aac6-a9e01e6a83de",
            "link": "https://learn.microsoft.com/azure/governance/management-groups/overview",
            "severity": "Medio",
            "subcategory": "Suscripciones",
            "text": "Si AD es Windows Server, establezca una suscripción de identidad dedicada en el grupo de administración de plataforma para hospedar controladores de dominio de Windows Server Active Directory",
            "training": "https://learn.microsoft.com/learn/paths/enterprise-scale-architecture/",
            "waf": "Seguridad"
        },
        {
            "category": "Grupo de administración y suscripciones",
            "graph": "resources | extend compliant = isnotnull(['tags']) | project name, id, subscriptionId, resourceGroup, tags, compliant",
            "guid": "5de32c19-9248-4160-9d5d-1e4e614658d3",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/track-costs",
            "severity": "Medio",
            "subcategory": "Suscripciones",
            "text": "Asegúrese de que las etiquetas se utilizan para la facturación y la gestión de costos",
            "training": "https://learn.microsoft.com/learn/paths/implement-resource-mgmt-security/",
            "waf": "Seguridad"
        },
        {
            "category": "Gestión y Monitoreo",
            "guid": "89cc5e11-aa4d-4c3b-893d-feb99215266a",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#add-diagnostic-settings-to-save-your-wafs-logs",
            "severity": "Alto",
            "subcategory": "Entrega de aplicaciones",
            "text": "Agregue la configuración de diagnóstico para guardar los registros de WAF de Azure Front Door. Revise regularmente los registros para comprobar si hay ataques y detecciones de falsos positivos.",
            "waf": "Operaciones"
        },
        {
            "category": "Gestión y Monitoreo",
            "guid": "7f408960-c626-44cb-a018-347c8d790cdf",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#send-logs-to-microsoft-sentinel",
            "severity": "Medio",
            "subcategory": "Entrega de aplicaciones",
            "text": "Envíe los registros de Azure Front Door a Microsoft Sentinel. Detecte ataques e integre la telemetría de puerta principal en su entorno general de Azure.",
            "waf": "Operaciones"
        },
        {
            "category": "Gestión y Monitoreo",
            "guid": "67e7a8ed-4b30-4e38-a3f2-9812b2363cef",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/design-logs-deployment",
            "severity": "Medio",
            "subcategory": "Monitorización",
            "text": "Use un único área de trabajo de registros de monitor para administrar plataformas de forma centralizada, excepto donde el control de acceso basado en rol de Azure (RBAC de Azure), los requisitos de soberanía de datos o las directivas de retención de datos exijan áreas de trabajo independientes.",
            "training": "https://learn.microsoft.com/azure/azure-monitor/logs/design-logs-deployment",
            "waf": "Operaciones"
        },
        {
            "category": "Gestión y Monitoreo",
            "guid": "e179b599-de0d-4597-9cd4-cd21b088137f",
            "severity": "Medio",
            "subcategory": "Monitorización",
            "text": "¿Está documentada la zona de aterrizaje?",
            "waf": "Operaciones"
        },
        {
            "category": "Gestión y Monitoreo",
            "guid": "5e6c4cfd-3e50-4454-9c24-47ec66138a72",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/design-logs-deployment",
            "severity": "Medio",
            "subcategory": "Monitorización",
            "text": "Exporte registros a Azure Storage si los requisitos de retención de registros superan los dos años. Utilice el almacenamiento inmutable con una política de escritura única y lectura múltiple para que los datos no se puedan borrar ni modificar durante un intervalo especificado por el usuario.",
            "training": "https://learn.microsoft.com/learn/paths/architect-infrastructure-operations/",
            "waf": "Operaciones"
        },
        {
            "category": "Gestión y Monitoreo",
            "guid": "00f1ce16-ed30-41d6-b872-e52e3611cc58",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/design-logs-deployment",
            "severity": "Medio",
            "subcategory": "Monitorización",
            "text": "Use Azure Policy para el control de acceso y los informes de cumplimiento. Azure Policy proporciona la capacidad de aplicar la configuración de toda la organización para garantizar el cumplimiento coherente de las directivas y la detección rápida de infracciones. ",
            "training": "https://learn.microsoft.com/learn/paths/architect-infrastructure-operations/",
            "waf": "Operaciones"
        },
        {
            "category": "Gestión y Monitoreo",
            "guid": "e7d7e484-3276-4d8b-bc05-5bcf619e8a13",
            "link": "https://learn.microsoft.com/azure/governance/policy/how-to/guest-configuration-create",
            "severity": "Medio",
            "subcategory": "Monitorización",
            "text": "Supervise la desviación de la configuración de la máquina virtual (VM) invitada mediante Azure Policy. Habilitar las capacidades de auditoría de configuración de invitados a través de políticas ayuda a las cargas de trabajo del equipo de aplicaciones a consumir inmediatamente las capacidades de las características con poco esfuerzo.",
            "training": "https://learn.microsoft.com/learn/paths/implement-resource-mgmt-security/",
            "waf": "Operaciones"
        },
        {
            "category": "Gestión y Monitoreo",
            "guid": "f9887952-5d62-4688-9d70-ba6c97be9951",
            "link": "https://learn.microsoft.com/azure/automation/update-management/overview",
            "severity": "Medio",
            "subcategory": "Monitorización",
            "text": "Use Update Management en Azure Automation como mecanismo de revisión a largo plazo para máquinas virtuales Windows y Linux. ",
            "training": "https://learn.microsoft.com/learn/paths/azure-administrator-manage-compute-resources/",
            "waf": "Operaciones"
        },
        {
            "category": "Gestión y Monitoreo",
            "guid": "90483845-c986-4cb2-a131-56a12476e49f",
            "link": "https://learn.microsoft.com/azure/network-watcher/network-watcher-monitoring-overview",
            "severity": "Medio",
            "subcategory": "Monitorización",
            "text": "Usar Network Watcher para supervisar de forma proactiva los flujos de tráfico",
            "training": "https://learn.microsoft.com/learn/modules/configure-network-watcher/",
            "waf": "Operaciones"
        },
        {
            "category": "Gestión y Monitoreo",
            "guid": "541acdce-9793-477b-adb3-751ab2ab13ad",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/lock-resources?tabs=json",
            "severity": "Medio",
            "subcategory": "Monitorización",
            "text": "Utilice bloqueos de recursos para evitar la eliminación accidental de servicios compartidos críticos.",
            "training": "https://learn.microsoft.com/learn/paths/implement-resource-mgmt-security/",
            "waf": "Operaciones"
        },
        {
            "category": "Gestión y Monitoreo",
            "guid": "a6e55d7d-8a2a-4db1-87d6-326af625ca44",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "severity": "Bajo",
            "subcategory": "Monitorización",
            "text": "Use directivas de denegación para complementar las asignaciones de roles de Azure. La combinación de directivas de denegación y asignaciones de roles de Azure garantiza que existan las barreras de protección adecuadas para exigir quién puede implementar y configurar recursos y qué recursos pueden implementar y configurar.",
            "waf": "Operaciones"
        },
        {
            "category": "Gestión y Monitoreo",
            "guid": "e5695f22-23ac-4e8c-a123-08ca5017f154",
            "link": "https://learn.microsoft.com/azure/service-health/alerts-activity-log-service-notifications-portal",
            "severity": "Medio",
            "subcategory": "Monitorización",
            "text": "Incluya eventos de estado de servicio y recursos como parte de la solución general de supervisión de la plataforma. El seguimiento del estado del servicio y de los recursos desde la perspectiva de la plataforma es un componente importante de la administración de recursos en Azure.",
            "waf": "Operaciones"
        },
        {
            "category": "Gestión y Monitoreo",
            "guid": "d5f345bf-97ab-41a7-819c-6104baa7d48c",
            "link": "https://learn.microsoft.com/azure/azure-monitor/alerts/action-groups",
            "severity": "Medio",
            "subcategory": "Monitorización",
            "text": "Incluir alertas y grupos de acción como parte de la plataforma Azure Service Health para garantizar que se puedan realizar acciones en las alertas o los problemas.",
            "waf": "Operaciones"
        },
        {
            "category": "Gestión y Monitoreo",
            "guid": "e3ab3693-829e-47e3-8618-3687a0477a20",
            "link": "https://learn.microsoft.com/azure/sentinel/quickstart-onboard",
            "severity": "Medio",
            "subcategory": "Monitorización",
            "text": "No envíe entradas de registro sin procesar a los sistemas de supervisión locales. En su lugar, adopte el principio de que los datos nacidos en Azure permanezcan en Azure. Si se requiere la integración de SIEM local, envíe alertas críticas en lugar de registros.",
            "waf": "Operaciones"
        },
        {
            "category": "Gestión y Monitoreo",
            "guid": "9945bda4-3334-4f24-a116-34182ba52752",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/design-logs-deployment",
            "severity": "Medio",
            "subcategory": "Monitorización",
            "text": "Use un área de trabajo centralizada de Azure Monitor Log Analytics para recopilar registros y métricas de los recursos de aplicaciones de IaaS y PaaS y controlar el acceso al registro con RBAC de Azure.",
            "waf": "Operaciones"
        },
        {
            "category": "Gestión y Monitoreo",
            "guid": "6944008b-e7d7-4e48-9327-6d8bdc055bcf",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-setup-guide/monitoring-reporting?tabs=AzureMonitor",
            "severity": "Medio",
            "subcategory": "Monitorización",
            "text": "Use los registros de Azure Monitor para obtener información e informes.",
            "waf": "Operaciones"
        },
        {
            "category": "Gestión y Monitoreo",
            "guid": "619e8a13-f988-4795-85d6-26886d70ba6c",
            "link": "https://learn.microsoft.com/azure/azure-monitor/agents/diagnostics-extension-overview",
            "severity": "Medio",
            "subcategory": "Monitorización",
            "text": "Cuando sea necesario, use cuentas de almacenamiento compartido dentro de la zona de aterrizaje para el almacenamiento del registro de extensión de diagnóstico de Azure.",
            "waf": "Operaciones"
        },
        {
            "category": "Gestión y Monitoreo",
            "guid": "97be9951-9048-4384-9c98-6cb2913156a1",
            "link": "https://learn.microsoft.com/azure/azure-monitor/alerts/alerts-overview",
            "severity": "Medio",
            "subcategory": "Monitorización",
            "text": "Use alertas de Azure Monitor para la generación de alertas operativas.",
            "waf": "Operaciones"
        },
        {
            "category": "Gestión y Monitoreo",
            "guid": "2476e49f-541a-4cdc-b979-377bcdb3751a",
            "link": "https://learn.microsoft.com/azure/site-recovery/site-recovery-overview",
            "severity": "Medio",
            "subcategory": "Monitorización",
            "text": "Use Azure Site Recovery para escenarios de recuperación ante desastres de Azure a Azure Virtual Machines. Esto le permite replicar cargas de trabajo entre regiones.",
            "waf": "Operaciones"
        },
        {
            "category": "Gestión y Monitoreo",
            "guid": "b2ab13ad-a6e5-45d7-b8a2-adb117d6326a",
            "link": "https://learn.microsoft.com/azure/architecture/framework/resiliency/backup-and-recovery",
            "severity": "Medio",
            "subcategory": "Monitorización",
            "text": "Asegúrese de usar y probar las capacidades nativas de recuperación ante desastres del servicio PaaS.",
            "waf": "Operaciones"
        },
        {
            "category": "Gestión y Monitoreo",
            "guid": "f625ca44-e569-45f2-823a-ce8cb12308ca",
            "link": "https://learn.microsoft.com/azure/backup/backup-center-overview",
            "severity": "Medio",
            "subcategory": "Monitorización",
            "text": "Use funcionalidades de copia de seguridad nativas de Azure. Compruebe que el asociado/cliente conoce Azure Backup y todas las nuevas funcionalidades, lo que puede simplificar enormemente la administración de copias de seguridad",
            "waf": "Operaciones"
        },
        {
            "category": "Gestión y Monitoreo",
            "guid": "859c3900-4514-41eb-b010-475d695abd74",
            "link": "https://learn.microsoft.com/azure/architecture/best-practices/monitoring",
            "severity": "Medio",
            "subcategory": "Monitorización",
            "text": "Asegúrese de que se han evaluado los requisitos de supervisión y que se aplican las configuraciones adecuadas de recopilación de datos y alertas.",
            "waf": "Operaciones"
        },
        {
            "category": "Gestión y Monitoreo",
            "guid": "fed3c55f-a67e-4875-aadd-3aba3f9fde31",
            "link": "https://learn.microsoft.com/azure/automation/how-to/region-mappings",
            "severity": "Medio",
            "subcategory": "Monitorización",
            "text": "Considerar las regiones admitidas para el área de trabajo de Log Analytics vinculada y las cuentas de automatización",
            "waf": "Operaciones"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "f00a69de-7076-4734-a734-6e4552cad9e1",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-latest-version-for-customer-managed-certificates",
            "severity": "Medio",
            "subcategory": "Entrega de aplicaciones",
            "text": "Si usa certificados TLS administrados por el cliente con Azure Front Door, use la versión de certificado \"más reciente\". Reduzca el riesgo de interrupciones causadas por la renovación manual de certificados.",
            "waf": "Operaciones"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "6138a720-0f1c-4e16-bd30-1d6e872e52e3",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/resource-org-management-groups#management-groups-in-the-azure-landing-zone-accelerator",
            "severity": "Medio",
            "subcategory": "Entrega de aplicaciones",
            "text": "Realice la entrega de aplicaciones dentro de las zonas de aterrizaje para aplicaciones internas (corporativas) y externas (en línea).",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "graph": "resources | where type == 'microsoft.network/applicationgateways' | project id, compliant = properties.sku.name in ('Standard_v2', 'WAF_v2') | project id,compliant",
            "guid": "553585a6-abe0-11ed-afa1-0242ac120002",
            "link": "https://learn.microsoft.com/azure/application-gateway/overview-v2",
            "severity": "Medio",
            "subcategory": "Entrega de aplicaciones",
            "text": "Asegúrese de que está utilizando SKU de Application Gateway v2",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "graph": "resources | where type=='microsoft.network/applicationgateways' | extend subnetId = tostring(properties.gatewayIPConfigurations[0].properties.subnet.id) | project id, subnetId | join (resources | where type=='microsoft.network/virtualnetworks' | project id,subnets=properties.subnets | mv-expand subnets | project id, subnetId = tostring(subnets.id), subnetPrefixLength = split(subnets.properties.addressPrefix, '/')[1]) on subnetId | extend compliant = (subnetPrefixLength <= 26) | distinct id,compliant",
            "guid": "dfc50f87-3800-424c-937b-ed5f186e7c15",
            "link": "https://learn.microsoft.com/azure/application-gateway/configuration-infrastructure#size-of-the-subnet",
            "severity": "Medio",
            "subcategory": "Entrega de aplicaciones",
            "text": "Las puertas de enlace de aplicaciones deben implementarse en subredes con prefijos IP iguales o mayores que /26",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "description": "La administración de proxies inversos en general y WAF en particular está más cerca de la aplicación que de la red, por lo que pertenecen a la misma suscripción que la aplicación. La centralización de Application Gateway y WAF en la suscripción de conectividad podría estar bien si está administrada por un solo equipo.",
            "guid": "48b662d6-d15f-4512-a654-98f6dfe237de",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "severity": "Medio",
            "subcategory": "Entrega de aplicaciones",
            "text": "Implemente Azure Application Gateway v2 o NVA de asociados que se usan para enviar conexiones HTTP(S) entrantes dentro de la red virtual de la zona de aterrizaje y con las aplicaciones que están protegiendo.",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "143b16c3-1d7a-4a9b-9470-4489a8042d88",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "severity": "Medio",
            "subcategory": "Entrega de aplicaciones",
            "text": "Utilice una red DDoS o planes de protección IP para todas las direcciones IP públicas en las zonas de aterrizaje de la aplicación.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "e79d17b7-3b22-4a5a-97e7-a8ed4b30e38c",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "severity": "Medio",
            "subcategory": "Entrega de aplicaciones",
            "text": "Use Azure Front Door con directivas WAF para entregar y ayudar a proteger aplicaciones HTTP/S globales que abarcan varias regiones de Azure.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "3f29812b-2363-4cef-b179-b599de0d5973",
            "link": "https://learn.microsoft.com/azure/ddos-protection/ddos-protection-overview",
            "severity": "Medio",
            "subcategory": "Entrega de aplicaciones",
            "text": "Cuando use Front Door y Application Gateway para ayudar a proteger las aplicaciones HTTP/S, use directivas WAF en Front Door. Bloquee Application Gateway para recibir tráfico solo desde Front Door.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "cd4cd21b-0881-437f-9e6c-4cfd3e504547",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "severity": "Alto",
            "subcategory": "Entrega de aplicaciones",
            "text": "Use el Administrador de tráfico para entregar aplicaciones globales que abarquen protocolos distintos de HTTP/S.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Fiabilidad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "3b4b3e88-a459-4ed5-a22f-644dfbc58204",
            "link": "https://learn.microsoft.com/azure/active-directory/app-proxy/application-proxy#how-application-proxy-works",
            "severity": "Bajo",
            "subcategory": "Entrega de aplicaciones",
            "text": "Si los usuarios solo necesitan acceso a aplicaciones internas, ¿se ha considerado Azure AD Application Proxy como una alternativa a Azure Virtual Desktop (AVD)?",
            "training": "https://learn.microsoft.com/learn/modules/configure-azure-ad-application-proxy/",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "01ca7cf1-5754-442d-babb-8ba6772e5c30",
            "link": "https://learn.microsoft.com/azure/active-directory/app-proxy/application-proxy#how-application-proxy-works",
            "severity": "Medio",
            "subcategory": "Entrega de aplicaciones",
            "text": "Para reducir el número de puertos de firewall abiertos para las conexiones entrantes en la red, considere la posibilidad de usar el proxy de aplicación de Azure AD para proporcionar a los usuarios remotos acceso seguro y autenticado a las aplicaciones internas.",
            "training": "https://learn.microsoft.com/learn/paths/implement-applications-external-access-azure-ad/",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "graph": "resources | where type == 'microsoft.network/frontdoorwebapplicationfirewallpolicies' | project policyName=name, policyId=id,policySku=sku.name, links=properties.securityPolicyLinks, enabledState=properties.policySettings.enabledState, mode=properties.policySettings.mode | mvexpand links | extend securityPolicy=links.id | extend securityPolicyParts=split(securityPolicy, '/') | extend profileId=strcat_array(array_slice(securityPolicyParts, 0, -3), '/') | project id=profileId, compliant=((enabledState=='Enabled') and (mode=='Prevention')), enabledState, mode",
            "guid": "ae248989-b306-4591-9186-de482e3f0f0e",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-policy-settings",
            "severity": "Alto",
            "subcategory": "Entrega de aplicaciones",
            "text": "Implemente sus perfiles WAF para Front Door en modo 'Prevención'.",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "062d5839-4d36-402f-bfa4-02811eb936e9",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#avoid-combining-traffic-manager-and-front-door",
            "severity": "Alto",
            "subcategory": "Entrega de aplicaciones",
            "text": "Evite combinar Azure Traffic Manager y Azure Front Door.",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "5efeb96a-003f-4b18-8fcd-b4d84459c2b2",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-the-same-domain-name-on-front-door-and-your-origin",
            "severity": "Alto",
            "subcategory": "Entrega de aplicaciones",
            "text": "Use el mismo nombre de dominio en Azure Front Door y su origen. Los nombres de host no coincidentes pueden causar errores sutiles.",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "0b5a380c-4bfb-47bc-b1d7-dcfef363a61b",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#disable-health-probes-when-theres-only-one-origin-in-an-origin-group",
            "severity": "Bajo",
            "subcategory": "Entrega de aplicaciones",
            "text": "Deshabilite los sondeos de mantenimiento cuando solo hay un origen en un grupo de origen de Azure Front Door.",
            "waf": "Rendimiento"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "5567048e-e5d7-4206-9c55-b5ed45d2cc0c",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#select-good-health-probe-endpoints",
            "severity": "Medio",
            "subcategory": "Entrega de aplicaciones",
            "text": "Seleccione puntos de conexión de sondeo de buen estado para Azure Front Door. Considere la posibilidad de crear extremos de mantenimiento que comprueben todas las dependencias de la aplicación.",
            "waf": "Fiabilidad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "a13f72f3-8f5c-4864-95e5-75bf37fbbeb1",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-head-health-probes",
            "severity": "Bajo",
            "subcategory": "Entrega de aplicaciones",
            "text": "Use sondeos de estado HEAD con Azure Front Door para reducir el tráfico que Front Door envía a la aplicación.",
            "waf": "Rendimiento"
        },
        {
            "category": "Topología y conectividad de red",
            "graph": "resources | where type=='microsoft.network/loadbalancers' | extend countOutRules=array_length(properties.outboundRules) | extend compliant = (countOutRules == 0) | distinct id,compliant",
            "guid": "97a2fd46-64b0-1dfa-b72d-9c8869496d75",
            "link": "https://learn.microsoft.com/azure/nat-gateway/nat-overview#outbound-connectivity",
            "severity": "Alto",
            "subcategory": "Entrega de aplicaciones",
            "text": "Use Azure NAT Gateway en lugar de reglas de salida del equilibrador de carga para una mejor escalabilidad de SNAT",
            "waf": "Fiabilidad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "de0d5973-cd4c-4d21-a088-137f5e6c4cfd",
            "link": "https://learn.microsoft.com/azure/virtual-network/network-security-group-how-it-works",
            "severity": "Medio",
            "subcategory": "Encriptación",
            "text": "Cuando use ExpressRoute Direct, configure MACsec para cifrar el tráfico en el nivel de capa dos entre los enrutadores de la organización y MSEE. El diagrama muestra este cifrado en flujo.",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "ed301d6e-872e-452e-9611-cc58b5a4b151",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-erdirect-about",
            "severity": "Bajo",
            "subcategory": "Encriptación",
            "text": "Para escenarios en los que MACsec no es una opción (por ejemplo, no usar ExpressRoute Direct), use una puerta de enlace VPN para establecer túneles IPsec sobre el emparejamiento privado de ExpressRoute. ",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "e8bbac75-7155-49ab-a153-e8908ae28c84",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/enterprise-scale/network-topology-and-connectivity",
            "severity": "Medio",
            "subcategory": "Hub and spoke",
            "text": "Considere un diseño de red basado en la topología de red radial tradicional para escenarios de red que requieren la máxima flexibilidad.",
            "training": "https://learn.microsoft.com/learn/paths/architect-network-infrastructure/",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "7dd61623-a364-4a90-9eca-e48ebd54cd7d",
            "link": "https://learn.microsoft.com/azure/architecture/reference-architectures/hybrid-networking/expressroute",
            "severity": "Alto",
            "subcategory": "Hub and spoke",
            "text": "Asegúrese de que los servicios de red compartidos, incluidas las puertas de enlace de ExpressRoute, las puertas de enlace VPN y Azure Firewall o NVA asociados en la red virtual del concentrador central. Si es necesario, implemente también controladores de dominio de Active Directory y servidores DNS.",
            "waf": "Costar"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "e2e8abac-3571-4559-ab91-53e89f89dc7b",
            "link": "https://learn.microsoft.com/azure/architecture/reference-architectures/dmz/nva-ha",
            "severity": "Medio",
            "subcategory": "Hub and spoke",
            "text": "Al implementar tecnologías de red de socios o NVA, siga las instrucciones del proveedor del socio",
            "waf": "Fiabilidad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "ce463dbb-bc8a-4c2a-aebc-92a43da1dae2",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-howto-coexist-resource-manager#to-enable-transit-routing-between-expressroute-and-azure-vpn",
            "severity": "Bajo",
            "subcategory": "Hub and spoke",
            "text": "Si necesita tránsito entre ExpressRoute y puertas de enlace VPN en escenarios radiales, use Azure Route Server.",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,subnets=properties.subnets | mv-expand subnets | project id, subnetName = subnets.name, subnetPrefix = subnets.properties.addressPrefix | extend subnetPrefixLength = split(subnetPrefix, '/')[1] | where subnetName == 'RouteServerSubnet' | extend compliant = (subnetPrefixLength <= 27) | distinct id, compliant",
            "guid": "91b9d7d5-91e1-4dcb-8f1f-fa7e465646cc",
            "link": "https://learn.microsoft.com/azure/route-server/quickstart-configure-route-server-portal#create-a-route-server-1",
            "severity": "Bajo",
            "subcategory": "Hub and spoke",
            "text": "Si utiliza Route Server, utilice un prefijo /27 para la subred de Route Server.",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "cc881471-607c-41cc-a0e6-14658dd558f9",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-networks-faq#can-i-create-a-peering-connection-to-a-vnet-in-a-different-region",
            "severity": "Medio",
            "subcategory": "Hub and spoke",
            "text": "Para arquitecturas de red con varias topologías radiales en regiones de Azure, use emparejamientos de redes virtuales globales entre las redes virtuales de concentradores para conectar las regiones entre sí. ",
            "training": "https://learn.microsoft.com/learn/paths/azure-administrator-manage-virtual-networks/",
            "waf": "Rendimiento"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "4722d929-c1b1-4cd6-81f5-4b29bade39ad",
            "link": "https://learn.microsoft.com/azure/azure-monitor/insights/network-insights-overview",
            "severity": "Medio",
            "subcategory": "Hub and spoke",
            "text": "Use Azure Monitor for Networks para supervisar el estado completo de las redes en Azure.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-network-monitoring/",
            "waf": "Operaciones"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "0e7c28ec-9366-4572-83b0-f4664b1d944a",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits?toc=/azure/virtual-network/toc.json#azure-resource-manager-virtual-networking-limits",
            "severity": "Medio",
            "subcategory": "Hub and spoke",
            "text": "Al conectar redes virtuales radiales a la red virtual del concentrador central, tenga en cuenta los límites de emparejamiento de red virtual y el número máximo de prefijos que se pueden anunciar a través de ExpressRoute",
            "waf": "Fiabilidad"
        },
        {
            "category": "Topología y conectividad de red",
            "graph": "resources | where type == 'microsoft.network/virtualnetworks' | mvexpand properties.virtualNetworkPeerings | project id, peeringName=properties_virtualNetworkPeerings.name, compliant = (properties_virtualNetworkPeerings.properties.allowVirtualNetworkAccess == True)",
            "guid": "c76cb5a2-abe2-11ed-afa1-0242ac120002",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-network-manage-peering",
            "severity": "Alto",
            "subcategory": "Hub and spoke",
            "text": "Use la configuración \"Permitir tráfico a la red virtual remota\" al configurar emparejamientos de red virtual de red virtual",
            "waf": "Fiabilidad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "359c373e-7dd6-4162-9a36-4a907ecae48e",
            "link": "https://learn.microsoft.com/azure/architecture/reference-architectures/hybrid-networking/hub-spoke?tabs=cli",
            "severity": "Medio",
            "subcategory": "Híbrido",
            "text": "Asegúrese de que ha investigado la posibilidad de usar ExpressRoute como conexión principal a Azure.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Rendimiento"
        },
        {
            "category": "Topología y conectividad de red",
            "description": "Puede usar los pesos de conexión y pendientes de ruta para influir en el tráfico de Azure al local, y toda la gama de atributos BGP en sus propios enrutadores para influir en el tráfico del entorno local a Azure.",
            "guid": "f29812b2-363c-4efe-879b-599de0d5973c",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-routing",
            "severity": "Medio",
            "subcategory": "Híbrido",
            "text": "Cuando use varios circuitos ExpressRoute o varias ubicaciones locales, asegúrese de optimizar el enrutamiento con atributos BGP, si se prefieren determinadas rutas de acceso.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Fiabilidad"
        },
        {
            "category": "Topología y conectividad de red",
            "graph": "resources| where type == 'microsoft.network/virtualnetworkgateways'| where properties.gatewayType =~ 'vpn' or properties.gatewayType == 'ExpressRoute'| extend SKUName = properties.sku.name, SKUTier = properties.sku.tier, Type = properties.gatewayType| extend compliant = SKUTier !in ('Basic', 'Standard')| project name, id, subscriptionId, resourceGroup, compliant",
            "guid": "d4cd21b0-8813-47f5-b6c4-cfd3e504547c",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-routing",
            "severity": "Medio",
            "subcategory": "Híbrido",
            "text": "Asegúrese de usar la SKU correcta para las puertas de enlace ExpressRoute/VPN en función de los requisitos de ancho de banda y rendimiento.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Rendimiento"
        },
        {
            "category": "Topología y conectividad de red",
            "graph": "resources | where type=='microsoft.network/expressroutecircuits' | extend compliant = (tolower(sku.family) == 'metereddata' or tolower(sku.tier) == 'local') | distinct id,compliant",
            "guid": "7025b442-f6e9-4af6-b11f-c9574916016f",
            "link": "https://learn.microsoft.com/azure/expressroute/plan-manage-cost",
            "severity": "Alto",
            "subcategory": "Híbrido",
            "text": "Asegúrese de usar circuitos ExpressRoute de datos ilimitados solo si alcanza el ancho de banda que justifica su costo.",
            "waf": "Costar"
        },
        {
            "category": "Topología y conectividad de red",
            "graph": "resources | where type=='microsoft.network/connections' | where properties.connectionType == 'ExpressRoute' | project id, gwid=tostring(properties.virtualNetworkGateway1.id), circuitid=tostring(properties.peer.id) | join (resources | where type=='microsoft.network/expressroutecircuits' | project circuitid=tostring(id), circuitsku=sku.tier) on circuitid | project id=gwid, compliant = (circuitsku == 'Local') | summarize compliant=max(compliant) by id",
            "guid": "f4e7926a-ec35-476e-a412-5dd17136bd62",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-faqs#expressroute-local",
            "severity": "Alto",
            "subcategory": "Híbrido",
            "text": "Aproveche la SKU local de ExpressRoute para reducir el costo de los circuitos, si la ubicación de emparejamiento de los circuitos admite las regiones de Azure para la SKU local.",
            "waf": "Costar"
        },
        {
            "category": "Topología y conectividad de red",
            "graph": "resources| where type == 'microsoft.network/virtualnetworkgateways'| where properties.gatewayType =~ 'vpn' or properties.gatewayType == 'ExpressRoute'| extend SKUName = properties.sku.name, SKUTier = properties.sku.tier, Type = properties.gatewayType| extend compliant = SKUTier contains 'AZ'| project name, id, subscriptionId, resourceGroup, Type, compliant",
            "guid": "2447ec66-138a-4720-8f1c-e16ed301d6e8",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-about-virtual-network-gateways",
            "severity": "Medio",
            "subcategory": "Híbrido",
            "text": "Implemente una puerta de enlace de ExpressRoute con redundancia de zona en las regiones de Azure admitidas.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Fiabilidad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "72e52e36-11cc-458b-9a4b-1511e43a58a9",
            "link": "https://learn.microsoft.com/azure/networking/",
            "severity": "Medio",
            "subcategory": "Híbrido",
            "text": "Para escenarios que requieren un ancho de banda superior a 10 Gbps o puertos dedicados de 10/100 Gbps, use ExpressRoute Direct.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Rendimiento"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "c2299c4d-7b57-4d0c-9555-62f2b3e4563a",
            "link": "https://learn.microsoft.com/azure/expressroute/about-fastpath",
            "severity": "Medio",
            "subcategory": "Híbrido",
            "text": "Cuando se requiera una latencia baja o el rendimiento del entorno local a Azure deba ser superior a 10 Gbps, habilite FastPath para omitir la puerta de enlace de ExpressRoute de la ruta de datos.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Rendimiento"
        },
        {
            "category": "Topología y conectividad de red",
            "graph": "resources | where type=='microsoft.network/virtualnetworkgateways' | where properties.gatewayType == 'Vpn' | extend compliant = (tolower(properties.sku.name) contains 'az') | distinct id, compliant",
            "guid": "4d873974-8b66-42d6-b15f-512a65498f6d",
            "link": "https://learn.microsoft.com/azure/vpn-gateway/create-zone-redundant-vnet-gateway",
            "severity": "Medio",
            "subcategory": "Híbrido",
            "text": "Use puertas de enlace VPN para conectar sucursales o ubicaciones remotas a Azure. Para una mayor resiliencia, implemente puertas de enlace con redundancia de zona (donde estén disponibles).",
            "training": "https://learn.microsoft.com/training/modules/intro-to-azure-vpn-gateway/",
            "waf": "Fiabilidad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "718cb437-b060-2589-8856-2e93a5c6633b",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-erdirect-about",
            "severity": "Alto",
            "subcategory": "Híbrido",
            "text": "Si usa ExpressRoute Direct, considere la posibilidad de usar circuitos locales de ExpressRoute en las regiones locales de Azure para ahorrar costos",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Costar"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "8042d88e-79d1-47b7-9b22-a5a67e7a8ed4",
            "link": "https://learn.microsoft.com/azure/architecture/framework/services/networking/expressroute/reliability",
            "severity": "Medio",
            "subcategory": "Híbrido",
            "text": "Cuando se requiere aislamiento de tráfico o ancho de banda dedicado, como para separar entornos de producción y no producción, use circuitos ExpressRoute diferentes. Le ayudará a garantizar dominios de enrutamiento aislados y aliviar los riesgos de vecinos ruidosos.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "b30e38c3-f298-412b-8363-cefe179b599d",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-monitoring-metrics-alerts",
            "severity": "Medio",
            "subcategory": "Híbrido",
            "text": "Supervise la disponibilidad y el uso de ExpressRoute mediante métricas integradas de Azure Monitor.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Operaciones"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "5bf68dc9-325e-4873-bf88-f8214ef2e5d2",
            "link": "https://learn.microsoft.com/azure/expressroute/how-to-configure-connection-monitor",
            "severity": "Medio",
            "subcategory": "Híbrido",
            "text": "Utilice el Monitor de conexión para la supervisión de la conectividad en todo el entorno.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Operaciones"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "e0d5973c-d4cd-421b-8881-37f5e6c4cfd3",
            "link": "https://learn.microsoft.com/azure/expressroute/designing-for-disaster-recovery-with-expressroute-privatepeering#challenges-of-using-multiple-expressroute-circuits",
            "severity": "Medio",
            "subcategory": "Híbrido",
            "text": "Use circuitos ExpressRoute de diferentes ubicaciones de emparejamiento para la redundancia.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Fiabilidad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "cd163e39-84a5-4b39-97b7-6973abd70d94",
            "link": "https://learn.microsoft.com/azure/active-directory/hybrid/how-to-connect-sync-staging-server",
            "severity": "Medio",
            "subcategory": "Híbrido",
            "text": "Al implementar una máquina virtual de AD Connect, considere la posibilidad de tener un servidor de ensayo para alta disponibilidad / recuperación ante desastres",
            "waf": "Fiabilidad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "2df4930f-6a43-49a3-926b-309f02c302f0",
            "link": "https://learn.microsoft.com/azure/architecture/reference-architectures/identity/adds-extend-domain#vm-recommendations",
            "severity": "Alto",
            "subcategory": "Híbrido",
            "text": "Si va a implementar al menos dos máquinas virtuales que ejecutan AD DS como controladores de dominio, agréguelas a diferentes zonas de disponibilidad. Si no está disponible en la región, implemente en un conjunto de disponibilidad.",
            "waf": "Fiabilidad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "558fd772-49b8-4211-82df-27ee412e7f98",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-ip-addressing",
            "severity": "Alto",
            "subcategory": "Plan IP",
            "text": "Asegúrese de que no se usen espacios de direcciones IP superpuestos entre regiones de Azure y ubicaciones locales",
            "training": "https://learn.microsoft.com/learn/paths/architect-network-infrastructure/",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "graph": "resources | where type == 'microsoft.network/virtualnetworks' | extend addressSpace = todynamic(properties.addressSpace) | extend addressPrefix = todynamic(properties.addressSpace.addressPrefixes) | mvexpand addressSpace | mvexpand addressPrefix | project name, id, location, resourceGroup, subscriptionId, cidr = addressPrefix | extend compliant = (cidr matches regex @'^(10\\\\.|172\\\\.(1[6-9]|2[0-9]|3[01])\\\\.|192\\\\.168\\\\.)')  | project id, compliant, cidr",
            "guid": "3f630472-2dd6-49c5-a5c2-622f54b69bad",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-ip-addressing",
            "severity": "Bajo",
            "subcategory": "Plan IP",
            "text": "Utilice direcciones IP de los intervalos de asignación de direcciones para Internets privadas (RFC 1918).",
            "training": "https://learn.microsoft.com/learn/paths/architect-network-infrastructure/",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "graph": "resources | where type == 'microsoft.network/virtualnetworks' | extend addressSpace = todynamic(properties.addressSpace) | extend addressPrefix = todynamic(properties.addressSpace.addressPrefixes) | mvexpand addressSpace | mvexpand addressPrefix | extend addressMask = split(addressPrefix,'/')[1] | extend compliant = addressMask > 16 | project name, id, subscriptionId, resourceGroup, addressPrefix, compliant",
            "guid": "33aad5e8-c68e-41d7-9667-313b4f5664b5",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-ip-addressing",
            "severity": "Alto",
            "subcategory": "Plan IP",
            "text": "Asegúrese de que no se desperdicie espacio de direcciones IP, no cree redes virtuales innecesariamente grandes (por ejemplo, /16) ",
            "training": "https://learn.microsoft.com/learn/paths/architect-network-infrastructure/",
            "waf": "Rendimiento"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "f348ef25-4c27-4d42-b8bb-ac7571559ab9",
            "link": "https://learn.microsoft.com/azure/site-recovery/concepts-on-premises-to-azure-networking#retain-ip-addresses",
            "severity": "Alto",
            "subcategory": "Plan IP",
            "text": "Evite usar rangos de direcciones IP superpuestos para los sitios de producción y DR.",
            "training": "https://learn.microsoft.com/learn/paths/az-104-manage-virtual-networks/",
            "waf": "Fiabilidad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "153e8908-ae28-4c84-a33b-6b7808b9fe5c",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-networks-name-resolution-for-vms-and-role-instances",
            "severity": "Medio",
            "subcategory": "Plan IP",
            "text": "Para entornos en los que la resolución de nombres en Azure es todo lo que se requiere, use Azure Private DNS para la resolución con una zona delegada para la resolución de nombres (como 'azure.contoso.com').",
            "training": "https://learn.microsoft.com/learn/paths/az-104-manage-virtual-networks/",
            "waf": "Operaciones"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "41049d40-3a92-43c3-974d-00018ac6a9e0",
            "link": "https://learn.microsoft.com/azure/dns/dns-private-resolver-overview",
            "severity": "Medio",
            "subcategory": "Plan IP",
            "text": "Para entornos en los que se requiere la resolución de nombres en Azure y en el entorno local, considere la posibilidad de usar Azure DNS Private Resolver.",
            "training": "https://learn.microsoft.com/training/modules/intro-to-azure-dns-private-resolver/",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "1e6a83de-5de3-42c1-a924-81607d5d1e4e",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-networks-name-resolution-for-vms-and-role-instances",
            "severity": "Bajo",
            "subcategory": "Plan IP",
            "text": "Las cargas de trabajo especiales que requieren e implementan su propio DNS (como Red Hat OpenShift) deben usar su solución DNS preferida.",
            "waf": "Operaciones"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "614658d3-558f-4d77-849b-821112df27ee",
            "link": "https://learn.microsoft.com/azure/dns/private-dns-autoregistration",
            "severity": "Alto",
            "subcategory": "Plan IP",
            "text": "Habilite el registro automático de DNS de Azure para administrar automáticamente el ciclo de vida de los registros DNS de las máquinas virtuales implementadas en una red virtual.",
            "training": "https://learn.microsoft.com/learn/paths/az-104-manage-virtual-networks/",
            "waf": "Operaciones"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "ee1ac551-c4d5-46cf-b035-d0a3c50d87ad",
            "link": "https://learn.microsoft.com/azure/bastion/bastion-overview",
            "severity": "Medio",
            "subcategory": "Internet",
            "text": "Considere la posibilidad de usar Azure Bastion para conectarse de forma segura a la red.",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,subnets=properties.subnets | mv-expand subnets | project id, subnetName = subnets.name, subnetPrefix = subnets.properties.addressPrefix | extend subnetPrefixLength = split(subnetPrefix, '/')[1] | where subnetName == 'AzureBastionSubnet' | extend compliant = (subnetPrefixLength <= 26) | distinct id, compliant",
            "guid": "6eab9eb6-762b-485e-8ea8-15aa5dba0bd0",
            "link": "https://learn.microsoft.com/en-us/azure/bastion/bastion-faq#subnet",
            "severity": "Medio",
            "subcategory": "Internet",
            "text": "Use Azure Bastion en una subred /26 o superior.",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "e6c4cfd3-e504-4547-a244-7ec66138a720",
            "link": "https://learn.microsoft.com/azure/app-service/networking-features",
            "severity": "Alto",
            "subcategory": "Internet",
            "text": "Use Azure Firewall para controlar el tráfico saliente de Azure a Internet, las conexiones entrantes que no son HTTP/S y el filtrado de tráfico Este/Oeste (si la organización lo requiere)",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "5a4b1511-e43a-458a-ac22-99c4d7b57d0c",
            "link": "https://learn.microsoft.com/azure/firewall/",
            "severity": "Medio",
            "subcategory": "Internet",
            "text": "Cree una directiva global de Azure Firewall para controlar la postura de seguridad en todo el entorno de red global y asígnela a todas las instancias de Azure Firewall. Permita que las directivas granulares cumplan los requisitos de regiones específicas delegando directivas de firewall incrementales a equipos de seguridad locales a través del control de acceso basado en roles de Azure.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "655562f2-b3e4-4563-a4d8-739748b662d6",
            "link": "https://learn.microsoft.com/azure/firewall/",
            "severity": "Bajo",
            "subcategory": "Internet",
            "text": "Configure los proveedores de seguridad SaaS de socios compatibles en Firewall Manager si la organización desea usar dichas soluciones para ayudar a proteger las conexiones salientes.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "1d7aa9b6-4704-4489-a804-2d88e79d17b7",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/afds-overview",
            "severity": "Medio",
            "subcategory": "Internet",
            "text": "Use Azure Front Door y las directivas WAF para proporcionar protección global en todas las regiones de Azure para las conexiones HTTP/S entrantes a una zona de aterrizaje.",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "3b22a5a6-7e7a-48ed-9b30-e38c3f29812b",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "severity": "Bajo",
            "subcategory": "Internet",
            "text": "Cuando use Azure Front Door y Azure Application Gateway para ayudar a proteger las aplicaciones HTTP/S, use directivas WAF en Azure Front Door. Bloquee Azure Application Gateway para recibir tráfico solo de Azure Front Door.",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "2363cefe-179b-4599-be0d-5973cd4cd21b",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "severity": "Alto",
            "subcategory": "Internet",
            "text": "Se requieren implementar WAF y otros proxies inversos para las conexiones HTTP / S entrantes, implementarlos dentro de una red virtual de zona de aterrizaje y junto con las aplicaciones que están protegiendo y exponiendo a Internet.",
            "training": "https://learn.microsoft.com/learn/paths/architect-network-infrastructure/",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "088137f5-e6c4-4cfd-9e50-4547c2447ec6",
            "link": "https://learn.microsoft.com/azure/ddos-protection/ddos-protection-reference-architectures",
            "severity": "Alto",
            "subcategory": "Internet",
            "text": "Use planes de protección IP o de red DDoS de Azure para ayudar a proteger los puntos de conexión de direcciones IP públicas dentro de las redes virtuales.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "graph": "resources | where type=='microsoft.network/firewallpolicies' | extend compliant = (properties.dnsSettings.enableProxy == true) | distinct id,compliant",
            "guid": "14d99880-2f88-47e8-a134-62a7d85c94af",
            "link": "https://learn.microsoft.com/azure/firewall/fqdn-filtering-network-rules",
            "severity": "Alto",
            "subcategory": "Internet",
            "text": "Use reglas de red basadas en FQDN y Azure Firewall con proxy DNS para filtrar el tráfico de salida a Internet no admitido por las reglas de aplicación.",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "graph": "resources | where type=='microsoft.network/firewallpolicies' | extend compliant = (properties.sku.tier == 'Premium') | distinct id,compliant",
            "guid": "c10d51ef-f999-455d-bba0-5c90ece07447",
            "link": "https://learn.microsoft.com/azure/firewall/premium-features",
            "severity": "Alto",
            "subcategory": "Internet",
            "text": "Use Azure Firewall Premium para obtener seguridad y protección adicionales.",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "graph": "resources | where type=='microsoft.network/firewallpolicies' | extend compliant = (properties.threatIntelMode == 'Deny') | distinct id,compliant",
            "guid": "e9c8f584-6d5e-473b-8dc5-acc9fbaab4e3",
            "link": "https://learn.microsoft.com/azure/firewall/premium-features",
            "severity": "Alto",
            "subcategory": "Internet",
            "text": "Configure el modo Inteligencia de amenazas de Azure Firewall en Alerta y Denegar para obtener protección adicional.",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "graph": "resources | where type=='microsoft.network/firewallpolicies' | extend compliant = (properties.intrusionDetection.mode == 'Deny') | project id, compliant",
            "guid": "b9d0dff5-bdd4-4cd8-88ed-5811610b2b2c",
            "link": "https://learn.microsoft.com/azure/firewall/premium-features#idps",
            "severity": "Alto",
            "subcategory": "Internet",
            "text": "Configure el modo IDPS de Azure Firewall en Denegar para obtener protección adicional.",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,resourceGroup,name,subnets=properties.subnets | mv-expand subnets | project id,name,subnetId=tostring(subnets.id), subnetName=tostring(subnets.name),subnetRT=subnets.properties.routeTable.id | where not (subnetName in ('GatewaySubnet', 'AzureFirewallSubnet', 'RouteServerSubnet', 'AzureBastionSubnet')) | extend hasRT = isnotnull(subnetRT) | distinct id, hasRT, subnetId | join kind=fullouter (resources | where type == 'microsoft.network/virtualnetworks' | mvexpand properties.virtualNetworkPeerings | extend isVWAN=(tolower(split(properties_virtualNetworkPeerings.name, '_')[0]) == 'remotevnettohubpeering') | mv-expand properties.subnets | project id, isVWAN, name, subnetId=tostring(properties_subnets.id), subnetName=tostring(properties_subnets.name) | summarize PeeredToVWAN=max(isVWAN) by id, subnetId | project id, subnetId, isVWANpeer = (PeeredToVWAN == true)) on subnetId | project id=iff(isnotempty(id), id, id1), subnetId=iff(isnotempty(subnetId), subnetId, subnetId1), hasRT, isVWANpeer | extend compliant = (hasRT==true or isVWANpeer==true) | distinct id, subnetId, compliant",
            "guid": "a3784907-9836-4271-aafc-93535f8ec08b",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-networks-udr-overview",
            "severity": "Alto",
            "subcategory": "Internet",
            "text": "Para las subredes de redes virtuales no conectadas a Virtual WAN, adjunte una tabla de ruteo para que el tráfico de Internet se redirija a Azure Firewall o a un dispositivo virtual de red",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "d301d6e8-72e5-42e3-911c-c58b5a4b1511",
            "link": "https://learn.microsoft.com/azure/virtual-network/vnet-integration-for-azure-services",
            "severity": "Alto",
            "subcategory": "Paas",
            "text": "Asegúrese de que la comunicación del plano de control para los servicios PaaS de Azure insertados en una red virtual no se interrumpe, por ejemplo, con una ruta 0.0.0.0/0 o una regla de NSG que bloquee el tráfico del plano de control.",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/?source=learn",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "e43a58a9-c229-49c4-b7b5-7d0c655562f2",
            "link": "https://learn.microsoft.com/azure/app-service/networking-features",
            "severity": "Medio",
            "subcategory": "Paas",
            "text": "Use Private Link, donde esté disponible, para los servicios PaaS de Azure compartidos.",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "b3e4563a-4d87-4397-98b6-62d6d15f512a",
            "link": "https://learn.microsoft.com/azure/app-service/networking-features",
            "severity": "Medio",
            "subcategory": "Paas",
            "text": "Acceda a los servicios PaaS de Azure desde el entorno local a través de puntos de conexión privados y emparejamiento privado de ExpressRoute. Este método evita el tránsito a través de la Internet pública.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "graph": "resources | where type =~ 'microsoft.network/virtualnetworks' | project id,resourceGroup,name,subnets = properties.subnets | mv-expand subnets | project id = subnets.id, resourceGroup, VNet = name, serviceEndpoints = subnets.properties.serviceEndpoints, compliant = (isnull(subnets.properties.serviceEndpoints) or array_length(subnets.properties.serviceEndpoints) == 0) | order by compliant asc",
            "guid": "4704489a-8042-4d88-b79d-17b73b22a5a6",
            "link": "https://learn.microsoft.com/azure/app-service/networking-features",
            "severity": "Medio",
            "subcategory": "Paas",
            "text": "No habilite los extremos del servicio de red virtual de forma predeterminada en todas las subredes.",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/?source=learn",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "7e7a8ed4-b30e-438c-9f29-812b2363cefe",
            "link": "https://learn.microsoft.com/azure/app-service/networking-features",
            "severity": "Medio",
            "subcategory": "Paas",
            "text": "Si usa extremos de servicio de red virtual, filtre los FQDN de salida en un NVA para evitar la exfiltración de datos.",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/?source=learn",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,subnets=properties.subnets | mv-expand subnets | project id, subnetName = subnets.name, subnetPrefix = subnets.properties.addressPrefix | extend subnetPrefixLength = split(subnetPrefix, '/')[1] | where subnetName == 'AzureFirewallSubnet' | extend compliant = (subnetPrefixLength == 26) | distinct id, compliant",
            "guid": "22d6419e-b627-4d95-9e7d-019fa759387f",
            "link": "https://learn.microsoft.com/azure/firewall/firewall-faq#why-does-azure-firewall-need-a--26-subnet-size",
            "severity": "Alto",
            "subcategory": "Segmentación",
            "text": "Use un prefijo /26 para las subredes de Azure Firewall.",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,subnets=properties.subnets | mv-expand subnets | project id, subnetName = subnets.name, subnetPrefix = subnets.properties.addressPrefix | extend subnetPrefixLength = split(subnetPrefix, '/')[1] | where subnetName == 'GatewaySubnet' | extend compliant = (subnetPrefixLength <= 27) | distinct id, compliant",
            "guid": "f2aad7e3-bb03-4adc-8606-4123d342a917",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-howto-add-gateway-resource-manager#add-a-gateway",
            "severity": "Alto",
            "subcategory": "Segmentación",
            "text": "Usar al menos un prefijo /27 para las subredes de puerta de enlace",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "graph": "resources | where type=='microsoft.network/networksecuritygroups' | mvexpand properties.securityRules | project id,name,ruleAction=properties_securityRules.properties.access,rulePriority=properties_securityRules.properties.priority,ruleDst=properties_securityRules.properties.destinationAddressPrefix,ruleSrc=properties_securityRules.properties.sourceAddressPrefix,ruleProt=properties_securityRules.properties.protocol,ruleDirection=properties_securityRules.properties.direction,rulePort=properties_securityRules.properties.destinationPortRange | summarize StarDenies=countif(ruleAction=='Deny' and ruleDst=='*' and ruleSrc=='*' and ruleProt=='*' and rulePort=='*') by id,tostring(ruleDirection) | where ruleDirection == 'Inbound' | project id,compliant=(StarDenies>0) | union (resources | where type=='microsoft.network/networksecuritygroups' | where array_length(properties.securityRules)==0 | extend compliant=false | project id,compliant)",
            "guid": "11deb39d-8299-4e47-bbe0-0fb5a36318a8",
            "link": "https://learn.microsoft.com/azure/virtual-network/service-tags-overview#available-service-tags",
            "severity": "Medio",
            "subcategory": "Segmentación",
            "text": "No confíe en las reglas predeterminadas de entrada de NSG mediante la etiqueta de servicio VirtualNetwork para limitar la conectividad.",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "c2447ec6-6138-4a72-80f1-ce16ed301d6e",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-landing-zone-network-segmentation",
            "severity": "Medio",
            "subcategory": "Segmentación",
            "text": "Delegue la creación de subredes al propietario de la zona de aterrizaje. ",
            "training": "https://learn.microsoft.com/learn/paths/implement-resource-mgmt-security/",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "872e52e3-611c-4c58-a5a4-b1511e43a58a",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "severity": "Medio",
            "subcategory": "Segmentación",
            "text": "Utilice NSG para ayudar a proteger el tráfico a través de subredes, así como el tráfico este/oeste a través de la plataforma (tráfico entre zonas de aterrizaje).",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "graph": "Resources | where type=='microsoft.network/virtualnetworks' | project id,resourceGroup,name,subnets=properties.subnets | mv-expand subnets | project id,name,subnetName=subnets.name,subnetNsg=subnets.properties.networkSecurityGroup | where not (subnetName in ('GatewaySubnet', 'AzureFirewallSubnet', 'RouteServerSubnet', 'AzureBastionSubnet')) | extend compliant = isnotnull(subnetNsg)",
            "guid": "9c2299c4-d7b5-47d0-a655-562f2b3e4563",
            "severity": "Medio",
            "subcategory": "Segmentación",
            "text": "El equipo de aplicaciones debe usar grupos de seguridad de aplicaciones en los grupos de seguridad de red de nivel de subred para ayudar a proteger las máquinas virtuales de varios niveles dentro de la zona de aterrizaje.",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "a4d87397-48b6-462d-9d15-f512a65498f6",
            "link": "https://learn.microsoft.com/azure/virtual-network/network-security-group-how-it-works",
            "severity": "Medio",
            "subcategory": "Segmentación",
            "text": "Utilice grupos de seguridad de aplicaciones y NSG para microsegmentar el tráfico dentro de la zona de aterrizaje y evite usar un NVA central para filtrar los flujos de tráfico.",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "dfe237de-143b-416c-91d7-aa9b64704489",
            "link": "https://learn.microsoft.com/azure/virtual-network/network-security-group-how-it-works",
            "severity": "Medio",
            "subcategory": "Segmentación",
            "text": "Habilite los registros de flujo de NSG y introdúzcalos en Traffic Analytics para obtener información sobre los flujos de tráfico internos y externos.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-network-monitoring/",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "412e7f98-3f63-4047-82dd-69c5b5c2622f",
            "link": "https://learn.microsoft.com/azure/virtual-wan/scenario-any-to-any",
            "severity": "Medio",
            "subcategory": "Virtual WAN",
            "text": "Considere Virtual WAN para simplificar la administración de redes de Azure y asegúrese de que su escenario se describe explícitamente en la lista de diseños de enrutamiento de Virtual WAN",
            "training": "https://learn.microsoft.com/learn/modules/introduction-azure-virtual-wan/",
            "waf": "Operaciones"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "54b69bad-33aa-4d5e-ac68-e1d76667313b",
            "link": "https://learn.microsoft.com/azure/virtual-wan/virtual-wan-about",
            "severity": "Medio",
            "subcategory": "Virtual WAN",
            "text": "Use un centro de WAN virtual por región de Azure para conectar varias zonas de aterrizaje entre regiones de Azure a través de una WAN virtual de Azure global común.",
            "waf": "Rendimiento"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "8ac6a9e0-1e6a-483d-b5de-32c199248160",
            "link": "https://learn.microsoft.com/azure/virtual-wan/virtual-wan-about",
            "severity": "Bajo",
            "subcategory": "Virtual WAN",
            "text": "Siga el principio \"el tráfico en Azure permanece en Azure\" para que la comunicación entre los recursos de Azure se produzca a través de la red troncal de Microsoft",
            "waf": "Rendimiento"
        },
        {
            "category": "Topología y conectividad de red",
            "graph": "resources | where type=='microsoft.network/virtualhubs' | extend compliant = isnotnull(properties.azureFirewall.id) | project id, compliant",
            "guid": "7d5d1e4e-6146-458d-9558-fd77249b8211",
            "link": "https://learn.microsoft.com/azure/virtual-wan/virtual-wan-about",
            "severity": "Medio",
            "subcategory": "Virtual WAN",
            "text": "Para la protección y el filtrado del tráfico saliente de Internet, implemente Azure Firewall en centros seguros",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "6667313b-4f56-464b-9e98-4a859c773e7d",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits",
            "severity": "Medio",
            "subcategory": "Virtual WAN",
            "text": "Asegúrese de que la arquitectura de red está dentro de los límites de Azure Virtual WAN.",
            "waf": "Fiabilidad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "261623a7-65a9-417e-8f34-8ef254c27d42",
            "link": "https://learn.microsoft.com/azure/virtual-wan/azure-monitor-insights",
            "severity": "Medio",
            "subcategory": "Virtual WAN",
            "text": "Use Azure Monitor Insights for Virtual WAN para supervisar la topología de un extremo a otro de la WAN virtual, el estado y las métricas clave.",
            "waf": "Operaciones"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "727c77e1-b9aa-4a37-a024-129d042422c1",
            "link": "https://learn.microsoft.com/azure/virtual-wan/virtual-wan-faq#is-branch-to-branch-connectivity-allowed-in-virtual-wan",
            "severity": "Medio",
            "subcategory": "Virtual WAN",
            "text": "Asegúrese de que las implementaciones de IaC no deshabilitan el tráfico de rama a rama en Virtual WAN, a menos que estos flujos se bloqueen explícitamente.",
            "waf": "Fiabilidad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "d49ac006-6670-4bc9-9948-d3e0a3a94f4d",
            "link": "https://learn.microsoft.com/azure/virtual-wan/about-virtual-hub-routing-preference",
            "severity": "Medio",
            "subcategory": "Virtual WAN",
            "text": "Utilice AS-Path como preferencia de enrutamiento de concentradores, ya que es más flexible que ExpressRoute o VPN.",
            "waf": "Fiabilidad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "2586b854-237e-47f1-84a1-d45d4cd2310d",
            "link": "https://learn.microsoft.com/azure/virtual-wan/about-virtual-hub-routing#labels",
            "severity": "Medio",
            "subcategory": "Virtual WAN",
            "text": "Asegúrese de que las implementaciones de IaC configuran la propagación basada en etiquetas en Virtual WAN; de lo contrario, la conectividad entre los concentradores virtuales se verá afectada.",
            "waf": "Fiabilidad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "9c75dfef-573c-461c-a698-68598595581a",
            "link": "https://learn.microsoft.com/azure/virtual-wan/virtual-wan-faq#what-is-the-recommended-hub-address-space-during-hub-creation",
            "severity": "Alto",
            "subcategory": "Virtual WAN",
            "text": "Asigne suficiente espacio IP a los concentradores virtuales, idealmente un prefijo /23.",
            "waf": "Fiabilidad"
        },
        {
            "category": "Operaciones",
            "guid": "af95c92d-d723-4f4a-98d7-8722324efd4d",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-managed-tls-certificates",
            "severity": "Alto",
            "subcategory": "Entrega de aplicaciones",
            "text": "Use certificados TLS administrados con Azure Front Door. Reduzca el costo operativo y el riesgo de interrupciones debido a la renovación de certificados.",
            "waf": "Operaciones"
        },
        {
            "category": "Operaciones",
            "guid": "189ea962-3969-4863-8f5a-5ad808c2cf4b",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#define-your-waf-configuration-as-code",
            "severity": "Medio",
            "subcategory": "Entrega de aplicaciones",
            "text": "Defina la configuración de Azure Front Door WAF como código. Mediante el uso de código, puede adoptar más fácilmente nuevas versiones del conjunto de reglas y obtener protección adicional.",
            "waf": "Operaciones"
        },
        {
            "category": "Seguridad, gobernanza y cumplimiento",
            "guid": "2e30abab-5478-417c-81bf-bf1ad4ed1ed4",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-end-to-end-tls",
            "severity": "Alto",
            "subcategory": "Entrega de aplicaciones",
            "text": "Use TLS de un extremo a otro con Azure Front Door. Utilice TLS para las conexiones de sus clientes a la puerta principal, y de la puerta principal a su origen.",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad, gobernanza y cumplimiento",
            "guid": "10aa45af-166f-44c4-9f36-b6d592dac2ca",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-http-to-https-redirection",
            "severity": "Medio",
            "subcategory": "Entrega de aplicaciones",
            "text": "Use la redirección de HTTP a HTTPS con Azure Front Door. Admite clientes más antiguos redirigiéndolos automáticamente a una solicitud HTTPS.",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad, gobernanza y cumplimiento",
            "guid": "28b9ee82-b2c7-45aa-bc98-6de6f59a095d",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#enable-the-waf",
            "severity": "Alto",
            "subcategory": "Entrega de aplicaciones",
            "text": "Habilite Azure Front Door WAF. Proteja su aplicación de una variedad de ataques.",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad, gobernanza y cumplimiento",
            "guid": "2902d8cc-1b0c-4495-afad-624ab70f7bd6",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#tune-your-waf",
            "severity": "Alto",
            "subcategory": "Entrega de aplicaciones",
            "text": "Ajuste el WAF de puerta delantera de Azure para su carga de trabajo. Reduzca las detecciones de falsos positivos.",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad, gobernanza y cumplimiento",
            "guid": "17ba124b-127d-42b6-9322-388d5b2bbcfc",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#use-prevention-mode",
            "severity": "Alto",
            "subcategory": "Entrega de aplicaciones",
            "text": "Use el modo de prevención con Azure Front Door WAF. El modo de prevención garantiza que el WAF bloquee las solicitudes maliciosas.",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad, gobernanza y cumplimiento",
            "guid": "49a98f2b-ec22-4a87-9415-6a10b00d6555",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#enable-default-rule-sets",
            "severity": "Alto",
            "subcategory": "Entrega de aplicaciones",
            "text": "Habilite los conjuntos de reglas predeterminadas de Azure Front Door WAF. Los conjuntos de reglas predeterminados detectan y bloquean ataques comunes.",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad, gobernanza y cumplimiento",
            "guid": "147a13d4-2a2f-4824-a524-f5855b52b946",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#enable-bot-management-rules",
            "severity": "Alto",
            "subcategory": "Entrega de aplicaciones",
            "text": "Habilite las reglas de administración de bots de Azure Front Door WAF. Las reglas del bot detectan bots buenos y malos.",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad, gobernanza y cumplimiento",
            "guid": "d7dcdcb9-0d99-44b9-baab-ac7570ede79a",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#use-the-latest-ruleset-versions",
            "severity": "Medio",
            "subcategory": "Entrega de aplicaciones",
            "text": "Use las versiones más recientes del conjunto de reglas de Azure Front Door WAF. Las actualizaciones del conjunto de reglas se actualizan periódicamente para tener en cuenta el panorama actual de amenazas.",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad, gobernanza y cumplimiento",
            "guid": "b9620385-1cde-418f-914b-a84a06982ffc",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#add-rate-limiting",
            "severity": "Medio",
            "subcategory": "Entrega de aplicaciones",
            "text": "Agregue limitación de velocidad al WAF de Azure Front Door. La limitación de velocidad bloquea a los clientes accidental o intencionalmente enviando grandes cantidades de tráfico en un corto período de tiempo.",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad, gobernanza y cumplimiento",
            "guid": "6dc36c52-0124-4ffe-9eaf-23ec1282dedb",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#use-a-high-threshold-for-rate-limits",
            "severity": "Medio",
            "subcategory": "Entrega de aplicaciones",
            "text": "Use un umbral alto para los límites de velocidad WAF de Azure Front Door. Los umbrales de límite de alta velocidad evitan bloquear el tráfico legítimo, al tiempo que proporcionan protección contra un número extremadamente alto de solicitudes que podrían abrumar su infraestructura. ",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad, gobernanza y cumplimiento",
            "guid": "388a3d0e-0a43-4367-90b2-3dd2aeece5ee",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#geo-filter-traffic",
            "severity": "Bajo",
            "subcategory": "Entrega de aplicaciones",
            "text": "Filtre geográficamente el tráfico mediante Azure Front Door WAF. Permitir el tráfico solo de las regiones esperadas y bloquear el tráfico de otras regiones.",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad, gobernanza y cumplimiento",
            "guid": "00acd8a9-6975-414f-8491-2be6309893b8",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#specify-the-unknown-zz-location",
            "severity": "Medio",
            "subcategory": "Entrega de aplicaciones",
            "text": "Especifique la ubicación desconocida (ZZ) al filtrar geográficamente el tráfico con Azure Front Door WAF. Evite bloquear accidentalmente solicitudes legítimas cuando las direcciones IP no se pueden igualar geográficamente.",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad, gobernanza y cumplimiento",
            "guid": "5c986cb2-9131-456a-8247-6e49f541acdc",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "severity": "Alto",
            "subcategory": "Gobernanza",
            "text": "Aproveche la directiva de Azure",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad, gobernanza y cumplimiento",
            "guid": "e979377b-cdb3-4751-ab2a-b13ada6e55d7",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/naming-and-tagging",
            "severity": "Medio",
            "subcategory": "Gobernanza",
            "text": "Identifique las etiquetas de Azure necesarias y use el modo de directiva anexar para aplicar el uso.",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad, gobernanza y cumplimiento",
            "guid": "d8a2adb1-17d6-4326-af62-5ca44e5695f2",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "severity": "Medio",
            "subcategory": "Gobernanza",
            "text": "Asigne los requisitos normativos y de cumplimiento a las definiciones de directivas de Azure y las asignaciones de roles de Azure.",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad, gobernanza y cumplimiento",
            "guid": "223ace8c-b123-408c-a501-7f154e3ab369",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "severity": "Medio",
            "subcategory": "Gobernanza",
            "text": "Establecer definiciones de directivas de Azure en el grupo de administración raíz de nivel superior para que se puedan asignar en ámbitos heredados",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad, gobernanza y cumplimiento",
            "guid": "3829e7e3-1618-4368-9a04-77a209945bda",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "severity": "Medio",
            "subcategory": "Gobernanza",
            "text": "Administre las asignaciones de directivas en el nivel más alto apropiado con exclusiones en los niveles inferiores, si es necesario",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad, gobernanza y cumplimiento",
            "guid": "43334f24-9116-4341-a2ba-527526944008",
            "link": "https://learn.microsoft.com/security/benchmark/azure/mcsb-asset-management#am-2-use-only-approved-services",
            "severity": "Bajo",
            "subcategory": "Gobernanza",
            "text": "Use Azure Policy para controlar qué servicios pueden aprovisionar los usuarios en el nivel de grupo de suscripción/administración",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad, gobernanza y cumplimiento",
            "guid": "be7d7e48-4327-46d8-adc0-55bcf619e8a1",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "severity": "Medio",
            "subcategory": "Gobernanza",
            "text": "Utilice políticas integradas siempre que sea posible para minimizar la sobrecarga operativa.",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad, gobernanza y cumplimiento",
            "description": "La asignación del rol Colaborador de directivas de recursos a ámbitos específicos permite delegar la administración de directivas a los equipos pertinentes. Por ejemplo, un equipo central de TI puede supervisar las políticas de nivel de grupo de administración, mientras que los equipos de aplicaciones manejan las políticas para sus suscripciones, lo que permite un gobierno distribuido con el cumplimiento de los estándares de la organización.",
            "guid": "3f988795-25d6-4268-a6d7-0ba6c97be995",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview#azure-rbac-permissions-in-azure-policy",
            "severity": "Medio",
            "subcategory": "Gobernanza",
            "text": "Asigne el rol integrado de colaborador de directivas de recursos en un ámbito determinado para habilitar el gobierno de nivel de aplicación.",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad, gobernanza y cumplimiento",
            "guid": "19048384-5c98-46cb-8913-156a12476e49",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "severity": "Medio",
            "subcategory": "Gobernanza",
            "text": "Limite el número de asignaciones de directivas de Azure realizadas en el ámbito del grupo de administración raíz para evitar la administración mediante exclusiones en ámbitos heredados.",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad, gobernanza y cumplimiento",
            "guid": "f541acdc-e979-4377-acdb-3751ab2ab13a",
            "link": "https://learn.microsoft.com/azure/governance/policy/concepts/guest-configuration",
            "severity": "Medio",
            "subcategory": "Gobernanza",
            "text": "Use directivas de Azure para implementar automáticamente configuraciones de software a través de extensiones de máquina virtual y aplicar una configuración de máquina virtual de línea base compatible.",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad, gobernanza y cumplimiento",
            "guid": "9b5e2a28-9823-4faf-ab7e-afa5f6c57221",
            "link": "Configure Azure Automation Start/Stop VMs during off-hours | Microsoft Learn",
            "severity": "Medio",
            "subcategory": "Gobernanza",
            "text": "Considere el uso de etiquetas de automatización para iniciar/detener máquinas virtuales en su entorno para ahorrar costos.",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad, gobernanza y cumplimiento",
            "description": "Las características de configuración de invitado de Azure Policy pueden auditar y corregir la configuración del equipo (por ejemplo, SO, aplicación, entorno) para garantizar que los recursos se alineen con las configuraciones esperadas, y Update Management puede aplicar la administración de revisiones para máquinas virtuales.",
            "guid": "da6e55d7-d8a2-4adb-817d-6326af625ca4",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/management-operational-compliance#monitoring-for-configuration-drift",
            "severity": "Medio",
            "subcategory": "Gobernanza",
            "text": "Supervise la desviación de la configuración de seguridad de VM a través de Azure Policy.",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad, gobernanza y cumplimiento",
            "guid": "5017f154-e3ab-4369-9829-e7e316183687",
            "link": "https://learn.microsoft.com/azure/key-vault/general/overview",
            "severity": "Alto",
            "subcategory": "Secretos",
            "text": "Uso del Almacén de claves de Azure para almacenar sus secretos y credenciales",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad, gobernanza y cumplimiento",
            "graph": "ResourceContainers | where type=='microsoft.resources/subscriptions'| parse id with '/subscriptions/' SubscriptionID| project subscriptionId, SubscriptionName = name| join kind=leftouter (Resources| where type == 'microsoft.keyvault/vaults'| project id, name, subscriptionId) on subscriptionId| join kind= leftouter (Resources| where type == 'microsoft.keyvault/vaults'| summarize ResourceCount = count() by subscriptionId) on subscriptionId| extend RCount = iff(isnull(ResourceCount), 0, ResourceCount)| project-away ResourceCount| extend compliant = (RCount <> 1)",
            "guid": "a0477a20-9945-4bda-9333-4f2491163418",
            "link": "https://learn.microsoft.com/azure/key-vault/general/overview-throttling",
            "severity": "Medio",
            "subcategory": "Secretos",
            "text": "Use diferentes almacenes de claves de Azure para diferentes aplicaciones y regiones para evitar los límites de escala de transacciones y restringir el acceso a los secretos.",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad, gobernanza y cumplimiento",
            "guid": "2ba52752-6944-4008-ae7d-7e4843276d8b",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "severity": "Medio",
            "subcategory": "Secretos",
            "text": "Aprovisione Azure Key Vault con las directivas de eliminación y purga temporal habilitadas para permitir la protección de retención de objetos eliminados.",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad, gobernanza y cumplimiento",
            "guid": "dc055bcf-619e-48a1-9f98-879525d62688",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "severity": "Medio",
            "subcategory": "Secretos",
            "text": "Siga un modelo de privilegios mínimos limitando la autorización para eliminar permanentemente claves, secretos y certificados a roles personalizados especializados de Azure Active Directory (Azure AD).",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad, gobernanza y cumplimiento",
            "guid": "6d70ba6c-97be-4995-8904-83845c986cb2",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "severity": "Medio",
            "subcategory": "Secretos",
            "text": "Automatice el proceso de gestión y renovación de certificados con las autoridades de certificación públicas para facilitar la administración.",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad, gobernanza y cumplimiento",
            "guid": "913156a1-2476-4e49-b541-acdce979377b",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "severity": "Medio",
            "subcategory": "Secretos",
            "text": "Establezca un proceso automatizado para la rotación de claves y certificados.",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad, gobernanza y cumplimiento",
            "guid": "cdb3751a-b2ab-413a-ba6e-55d7d8a2adb1",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "severity": "Medio",
            "subcategory": "Secretos",
            "text": "Habilite el firewall y el punto de conexión del servicio de red virtual o el punto de conexión privado en el almacén para controlar el acceso al almacén de claves.",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad, gobernanza y cumplimiento",
            "guid": "17d6326a-f625-4ca4-9e56-95f2223ace8c",
            "link": "https://learn.microsoft.com/azure/key-vault/general/monitor-key-vault",
            "severity": "Medio",
            "subcategory": "Secretos",
            "text": "Use el área de trabajo de Azure Monitor Log Analytics central para auditar el uso de claves, certificados y secretos dentro de cada instancia de Key Vault.",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad, gobernanza y cumplimiento",
            "guid": "b12308ca-5017-4f15-9e3a-b3693829e7e3",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "severity": "Medio",
            "subcategory": "Secretos",
            "text": "Delegue la creación de instancias del Almacén de claves y el acceso con privilegios, y use Azure Policy para aplicar una configuración compatible coherente.",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad, gobernanza y cumplimiento",
            "guid": "16183687-a047-47a2-8994-5bda43334f24",
            "link": "https://learn.microsoft.com/azure/security/fundamentals/encryption-atrest",
            "severity": "Medio",
            "subcategory": "Secretos",
            "text": "De forma predeterminada, utilice las claves administradas por Microsoft para la funcionalidad de cifrado principal y use claves administradas por el cliente cuando sea necesario.",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad, gobernanza y cumplimiento",
            "guid": "91163418-2ba5-4275-8694-4008be7d7e48",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "severity": "Medio",
            "subcategory": "Secretos",
            "text": "Use un Almacén de claves de Azure por aplicación por entorno y región.",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad, gobernanza y cumplimiento",
            "guid": "25d62688-6d70-4ba6-a97b-e99519048384",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "severity": "Medio",
            "subcategory": "Secretos",
            "text": "Si desea traer sus propias claves, es posible que no se admitan en todos los servicios considerados. Implemente una mitigación relevante para que las inconsistencias no obstaculicen los resultados deseados. Elija pares de regiones y regiones de recuperación ante desastres adecuadas que minimicen la latencia.",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad, gobernanza y cumplimiento",
            "guid": "4e5695f2-223a-4ce8-ab12-308ca5017f15",
            "link": "https://learn.microsoft.com/azure/active-directory/reports-monitoring/overview-reports",
            "severity": "Medio",
            "subcategory": "Seguridad",
            "text": "Use las funcionalidades de informes de Azure AD para generar informes de auditoría de control de acceso.",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad, gobernanza y cumplimiento",
            "guid": "4e3ab369-3829-4e7e-9161-83687a0477a2",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/logs-data-export?tabs=portal",
            "severity": "Medio",
            "subcategory": "Seguridad",
            "text": "Exporte los registros de actividad de Azure a los registros de Azure Monitor para la retención de datos a largo plazo. Exporte a Azure Storage para almacenamiento a largo plazo más allá de dos años, si es necesario.",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad, gobernanza y cumplimiento",
            "guid": "09945bda-4333-44f2-9911-634182ba5275",
            "link": "https://learn.microsoft.com/azure/security-center/",
            "severity": "Medio",
            "subcategory": "Seguridad",
            "text": "Habilite Defender for Cloud Standard para todas las suscripciones.",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad, gobernanza y cumplimiento",
            "guid": "15833ee7-ad6c-46d3-9331-65c7acbe44ab",
            "link": "https://learn.microsoft.com/azure/security-center/",
            "severity": "Medio",
            "subcategory": "Seguridad",
            "text": "Supervise la desviación de la revisión del sistema operativo base a través de Azure Monitor Logs y Defender for Cloud.",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad, gobernanza y cumplimiento",
            "guid": "e5f8d79f-2e87-4768-924c-516775c6ea95",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/design-logs-deployment",
            "severity": "Medio",
            "subcategory": "Seguridad",
            "text": "Conecte las configuraciones de recursos predeterminadas a un área de trabajo centralizada de Azure Monitor Log Analytics.",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad, gobernanza y cumplimiento",
            "guid": "b86ad884-08e3-4727-94b8-75ba18f20459",
            "link": "https://learn.microsoft.com/security/benchmark/azure/security-control-incident-response",
            "severity": "Medio",
            "subcategory": "Seguridad",
            "text": "Determine el plan de respuesta a incidentes para los servicios de Azure antes de permitirlo en producción.",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad, gobernanza y cumplimiento",
            "guid": "01365d38-e43f-49cc-ad86-8266abca264f",
            "link": "https://www.microsoft.com/security/business/zero-trust",
            "severity": "Medio",
            "subcategory": "Seguridad",
            "text": "Implemente un enfoque de confianza cero para el acceso a la plataforma Azure, cuando corresponda.",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad, gobernanza y cumplimiento",
            "guid": "9a19bf39-c95d-444c-9c89-19ca1f6d5215",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/service-enablement-framework",
            "severity": "Medio",
            "subcategory": "Seguridad",
            "text": "Planeación de cómo se implementarán los nuevos servicios de Azure",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad, gobernanza y cumplimiento",
            "guid": "ae514b93-3d45-485e-8112-9bd7ba012f7b",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/service-enablement-framework",
            "severity": "Medio",
            "subcategory": "Seguridad",
            "text": "Planeación de cómo se cumplirá la solicitud de servicio para los servicios de Azure",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad, gobernanza y cumplimiento ",
            "guid": "cacf55bc-e4e4-46be-96bc-57a5f23a269a",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/resource-naming",
            "severity": "Alto",
            "subcategory": "Gobernanza",
            "text": "Se recomienda seguir los estándares de nomenclatura de procedimientos recomendados de Microsoft",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad, gobernanza y cumplimiento ",
            "guid": "b03ed428-4617-4067-a787-85468b9ccf3f",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-require-secure-transfer",
            "severity": "Alto",
            "subcategory": "Seguridad",
            "text": "La transferencia segura a cuentas de almacenamiento debe estar habilitada",
            "waf": "Seguridad"
        },
        {
            "category": "Seguridad, gobernanza y cumplimiento ",
            "guid": "159aac9f-863f-4f48-82cf-00c28fa97a0e",
            "link": "https://learn.microsoft.com/azure/storage/blobs/data-protection-overview#recommendations-for-basic-data-protection",
            "severity": "Alto",
            "subcategory": "Seguridad",
            "text": "Habilite la eliminación temporal del contenedor para que la cuenta de almacenamiento recupere un contenedor eliminado y su contenido.",
            "waf": "Seguridad"
        }
    ],
    "metadata": {
        "name": "Azure Landing Zone Review",
        "state": "GA",
        "timestamp": "June 16, 2023"
    },
    "severities": [
        {
            "name": "Alto"
        },
        {
            "name": "Medio"
        },
        {
            "name": "Bajo"
        }
    ],
    "status": [
        {
            "description": "Esta comprobación aún no se ha examinado",
            "name": "No verificado"
        },
        {
            "description": "Hay un elemento de acción asociado a esta comprobación",
            "name": "Abrir"
        },
        {
            "description": "Esta comprobación se ha comprobado y no hay más elementos de acción asociados a ella",
            "name": "Cumplido"
        },
        {
            "description": "Recomendación entendida, pero no necesaria por los requisitos actuales",
            "name": "No es necesario"
        },
        {
            "description": "No aplicable para el diseño actual",
            "name": "N/A"
        }
    ],
    "waf": [
        {
            "name": "Fiabilidad"
        },
        {
            "name": "Seguridad"
        },
        {
            "name": "Costar"
        },
        {
            "name": "Operaciones"
        },
        {
            "name": "Rendimiento"
        }
    ]
}
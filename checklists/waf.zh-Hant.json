{
    "items": [
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "ab5351f6-383a-45ed-9c5e-b143b16db40a",
            "link": "https://learn.microsoft.com/azure/aks/use-windows-hpc",
            "service": "AKS",
            "severity": "低",
            "text": "如果 AKS Windows 工作負載需要，可以使用 HostProcess 容器",
            "waf": "可靠性"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "a280dcf5-90ce-465d-b8e1-3f9ccbd46926",
            "link": "https://learn.microsoft.com/azure/azure-functions/functions-kubernetes-keda",
            "service": "AKS",
            "severity": "低",
            "text": "如果運行事件驅動的工作負載，請使用KEDA",
            "waf": "性能"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "26886d20-b66c-457b-a591-19bf8e8f5c58",
            "link": "https://dapr.io/",
            "service": "AKS",
            "severity": "低",
            "text": "使用 Dapr 簡化微服務開發",
            "waf": "操作"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (sku.tier=='Paid') | distinct id,compliant",
            "guid": "71d41e36-10cc-457b-9a4b-1410d4395898",
            "link": "https://learn.microsoft.com/azure/aks/uptime-sla",
            "service": "AKS",
            "severity": "高",
            "text": "使用 SLA 支援的 AKS 產品/服務",
            "waf": "可靠性"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "c1288b3c-6a57-4cfc-9444-51e1a3d3453a",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-scheduler",
            "service": "AKS",
            "severity": "低",
            "text": "在容器和部署定義中使用中斷預算",
            "waf": "可靠性"
        },
        {
            "checklist": "Azure AKS Review",
            "guid": "3c763963-7a55-42d5-a15e-401955387e5c",
            "link": "https://learn.microsoft.com/azure/container-registry/container-registry-geo-replication",
            "service": "ACR",
            "severity": "高",
            "text": "如果使用專用註冊表，請配置區域複製以將映像存儲在多個區域中",
            "waf": "可靠性"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "f82cb8eb-8c0a-4a63-a25a-4956eaa8dc4a",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/aks/eslz-cost-governance-with-kubecost",
            "service": "AKS",
            "severity": "低",
            "text": "使用外部應用（如 kubecost）將成本分配給不同的使用者",
            "waf": "成本"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "4d3dfbab-9924-4831-a68d-fdf0d72f462c",
            "link": "https://learn.microsoft.com/azure/aks/scale-down-mode",
            "service": "AKS",
            "severity": "低",
            "text": "使用縮減模式刪除/取消分配節點",
            "waf": "成本"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "87e651ea-bc4a-4a87-a6df-c06a4b570ebc",
            "link": "https://learn.microsoft.com/azure/aks/gpu-multi-instance",
            "service": "AKS",
            "severity": "中等",
            "text": "需要時，請在 AKS 群集上使用多實例分組 GPU",
            "waf": "成本"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "2b72a08b-0410-4cd6-9093-e068a5cf27e8",
            "link": "https://learn.microsoft.com/azure/aks/start-stop-nodepools",
            "service": "AKS",
            "severity": "低",
            "text": "如果運行開發/測試群集，請使用 NodePool Start/Stop",
            "waf": "成本"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (isnotnull(properties.addonProfiles.azurepolicy) and properties.addonProfiles.azurepolicy.enabled==true) | distinct id,compliant",
            "guid": "9ca48e4a-85e2-4223-bce8-bb12307ca5f1",
            "link": "https://learn.microsoft.com/azure/governance/policy/concepts/policy-for-kubernetes",
            "service": "AKS",
            "severity": "中等",
            "text": "使用適用於 Kubernetes 的 Azure Policy 確保群集符合性",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | project id,resourceGroup,name,pools=properties.agentPoolProfiles | project id,name,resourceGroup,poolcount=array_length(pools) | extend compliant = (poolcount > 1)",
            "guid": "6f158e3e-a3a9-42c2-be7e-2165c3a87af4",
            "link": "https://learn.microsoft.com/azure/aks/use-system-pools",
            "service": "AKS",
            "severity": "中等",
            "text": "使用使用者/系統節點池將應用程式與控制平面分開",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "a7a1f893-9bda-4477-98f2-4c116775c2ea",
            "link": "https://learn.microsoft.com/azure/aks/use-system-pools",
            "service": "AKS",
            "severity": "低",
            "text": "向系統節點池添加污點以使其專用",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "55b46a94-8008-4ae7-b7e4-b475b6c8bdbf",
            "link": "https://learn.microsoft.com/azure/container-registry/",
            "service": "AKS",
            "severity": "中等",
            "text": "對映像使用專用註冊表，例如 ACR",
            "waf": "安全"
        },
        {
            "checklist": "Azure AKS Review",
            "guid": "59bce65d-e8a0-43f9-9879-468d66a786d6",
            "link": "https://learn.microsoft.com/azure/security-center/container-security",
            "service": "ACR",
            "severity": "中等",
            "text": "掃描映像以查找漏洞",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "d167dd18-2b0a-4c24-8b99-9a646f8389a7",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-cluster-isolation",
            "service": "AKS",
            "severity": "高",
            "text": "定義應用分離要求（命名空間/節點池/集群）",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "5e3df584-eccc-4d97-a3b6-bcda3b50eb2e",
            "link": "https://github.com/Azure/secrets-store-csi-driver-provider-azure",
            "service": "AKS",
            "severity": "中等",
            "text": "使用 CSI 機密存儲驅動程式將機密存儲在 Azure Key Vault 中",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "b03dda6d-58d7-4c89-8ddb-107d5769ae66",
            "link": "https://learn.microsoft.com/azure/aks/update-credentials",
            "service": "AKS",
            "severity": "高",
            "text": "如果將服務主體用於群集，請定期刷新憑據（如每季度）",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "e7ba73a3-0508-4f80-806f-527db30cee96",
            "link": "https://learn.microsoft.com/azure/aks/use-kms-etcd-encryption",
            "service": "AKS",
            "severity": "中等",
            "text": "如果需要，請添加金鑰管理服務 etcd 加密",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "ec8e4e42-0344-41b0-b865-9123e8956d31",
            "link": "https://learn.microsoft.com/azure/confidential-computing/confidential-nodes-aks-overview",
            "service": "AKS",
            "severity": "低",
            "text": "如果需要，請考慮使用適用於 AKS 的機密計算",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "c9e95ffe-6dd1-4a17-8c5f-110389ca9b21",
            "link": "https://learn.microsoft.com/azure/defender-for-cloud/defender-for-containers-enable",
            "service": "AKS",
            "severity": "中等",
            "text": "考慮使用 Defender for Containers",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (properties.servicePrincipalProfile.clientId=='msi') | distinct id,compliant",
            "guid": "ed127dd1-42b0-46b2-8c69-99a646f3389a",
            "link": "https://learn.microsoft.com/azure/aks/use-managed-identity",
            "service": "AKS",
            "severity": "高",
            "text": "使用託管標識而不是服務主體",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = isnotnull(properties.aadProfile) | distinct id,compliant",
            "guid": "7e42c78e-78c0-46a6-8a21-94956e698dc4",
            "link": "https://learn.microsoft.com/azure/aks/managed-aad",
            "service": "AKS",
            "severity": "中等",
            "text": "將身份驗證與 AAD（使用託管集成）集成",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "a2fe27b2-e287-401a-8352-beedf79b488d",
            "link": "https://learn.microsoft.com/azure/aks/control-kubeconfig-access",
            "service": "AKS",
            "severity": "中等",
            "text": "限制對管理員 kubeconfig （get-credentials --admin） 的訪問",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "eec4962c-c3bd-421b-b77f-26e5e6b3bec3",
            "link": "https://learn.microsoft.com/azure/aks/manage-azure-rbac",
            "service": "AKS",
            "severity": "中等",
            "text": "將授權與 AAD RBAC 集成",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "d4f3537c-1346-4dc5-9027-a71ffe1bd05d",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-identity",
            "service": "AKS",
            "severity": "高",
            "text": "在 Kubernetes 中使用命名空間限制 RBAC 許可權",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "d2e0d5d7-71d4-41e3-910c-c57b4a4b1410",
            "link": "https://learn.microsoft.com/azure/aks/workload-identity-migration-sidecar",
            "service": "AKS",
            "severity": "中等",
            "text": "對於 Pod Identity Access Management，請使用 Azure AD 工作負載標識（預覽版）",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "f4dcf690-1b30-407d-abab-6f8aa780d3a3",
            "link": "https://learn.microsoft.com/azure/aks/managed-aad#non-interactive-sign-in-with-kubelogin",
            "service": "AKS",
            "severity": "中等",
            "text": "對於 AKS 非互動式登錄名，請使用 kubelogin（預覽版）",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (properties.disableLocalAccounts==true) | distinct id,compliant",
            "guid": "b085b1f2-3119-4771-8c9a-bbf4411810ec",
            "link": "https://learn.microsoft.com/azure/aks/managed-aad#disable-local-accounts",
            "service": "AKS",
            "severity": "中等",
            "text": "禁用 AKS 本地帳戶",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "36abb0db-c118-4f4c-9880-3f30f9a2deb6",
            "link": "https://learn.microsoft.com/azure/aks/managed-aad#configure-just-in-time-cluster-access-with-azure-ad-and-aks",
            "service": "AKS",
            "severity": "低",
            "text": "如果需要，請配置 Just-in-time 群集訪問",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "c4d7f4c6-79bf-45d0-aa05-ce8fc717e150",
            "link": "https://learn.microsoft.com/azure/aks/managed-aad#use-conditional-access-with-azure-ad-and-aks",
            "service": "AKS",
            "severity": "低",
            "text": "如果需要，為 AKS 配置 AAD 條件訪問",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "e1123a7c-a333-4eb4-a120-4ee3f293c9f3",
            "link": "https://learn.microsoft.com/azure/aks/use-group-managed-service-accounts",
            "service": "AKS",
            "severity": "低",
            "text": "如果 Windows AKS 工作負載需要，請配置 gMSA",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "1f711a74-3672-470b-b8b8-a2148d640d79",
            "link": "https://learn.microsoft.com/azure/aks/use-managed-identity#use-a-pre-created-kubelet-managed-identity",
            "service": "AKS",
            "severity": "中等",
            "text": "為了獲得更精細的控制，請考慮使用託管的 Kubelet 身份",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "cbd8ac2a-aebc-4a2a-94da-1dbf3dc99248",
            "link": "https://azure.github.io/application-gateway-kubernetes-ingress/setup/install-existing/",
            "service": "AKS",
            "severity": "中等",
            "text": "如果使用 AGIC，請勿跨集群共用 AppGW",
            "waf": "可靠性"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (isnull(properties.addonProfiles.httpApplicationRouting) or properties.addonProfiles.httpApplicationRouting.enabled==false) | distinct id,compliant",
            "guid": "8008ae7d-7e4b-4475-a6c8-bdbf59bce65d",
            "link": "https://learn.microsoft.com/azure/aks/http-application-routing",
            "service": "AKS",
            "severity": "高",
            "text": "不要使用 AKS HTTP 路由載入項，而是將託管 NGINX 入口與應用程式路由載入項一起使用。",
            "waf": "可靠性"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "7bacd7b9-c025-4a9d-a5d2-25d6bc5439d9",
            "link": "https://learn.microsoft.com/azure/virtual-network/accelerated-networking-overview",
            "service": "AKS",
            "severity": "中等",
            "text": "對於 Windows 工作負載，請使用加速網路",
            "waf": "性能"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (tolower(properties.networkProfile.loadBalancerSku)=='standard') | distinct id,compliant",
            "guid": "ba7da7be-9952-4914-a384-5d997cb39132",
            "link": "https://learn.microsoft.com/azure/aks/load-balancer-standard",
            "service": "AKS",
            "severity": "高",
            "text": "使用標準 ALB（而不是基本 ALB）",
            "waf": "可靠性"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "22fbe8d6-9b40-47ef-9011-25bb1a555a6b",
            "link": "https://learn.microsoft.com/azure/aks/use-multiple-node-pools#add-a-node-pool-with-a-unique-subnet",
            "service": "AKS",
            "severity": "中等",
            "text": "如果使用 Azure CNI，請考慮對 NodePool 使用不同的子網",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "c3c39c98-6bb2-4c12-859a-114b5e3df584",
            "link": "https://learn.microsoft.com/azure/private-link/private-link-overview",
            "service": "AKS",
            "severity": "中等",
            "text": "使用專用終結點（首選）或虛擬網路服務終結點從群集訪問 PaaS 服務",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (properties.networkProfile.networkPlugin=='azure') | distinct id,compliant",
            "guid": "a0f61565-9de5-458f-a372-49c831112dbd",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-network",
            "service": "AKS",
            "severity": "高",
            "text": "選擇最適合你要求的 CNI 網路外掛程式（建議使用 Azure CNI）",
            "waf": "可靠性"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "7faf12e7-0943-4f63-8472-2da29c2b1cd6",
            "link": "https://learn.microsoft.com/azure/aks/configure-azure-cni",
            "service": "AKS",
            "severity": "高",
            "text": "如果使用 Azure CNI，請根據每個節點的最大 Pod 數相應地調整子網的大小",
            "waf": "性能"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "22f54b29-bade-43aa-b1e8-c38ec9366673",
            "link": "https://learn.microsoft.com/azure/aks/configure-azure-cni",
            "service": "AKS",
            "severity": "高",
            "text": "如果使用 Azure CNI，請檢查每個節點的最大 Pod 數（預設為 30）",
            "waf": "性能"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "description": "對於內部應用，組織通常會在其防火牆中打開整個AKS子網。這也會打開對節點的網路訪問，並可能打開對 Pod 的訪問（如果使用 Azure CNI）。如果 LoadBalancer IP 位於不同的子網中，則只有此子網可供應用用戶端使用。另一個原因是，如果 AKS 子網中的 IP 位址是稀缺資源，則將其 IP 位址用於服務會降低群集的最大可伸縮性。",
            "guid": "13c00567-4b1e-4945-a459-c373e7ed6162",
            "link": "https://learn.microsoft.com/azure/aks/internal-lb",
            "service": "AKS",
            "severity": "低",
            "text": "如果使用專用IP LoadBalancer服務，請使用專用子網（而不是 AKS 子網）",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "43f63047-22d9-429c-8b1c-d622f54b29ba",
            "link": "https://learn.microsoft.com/azure/aks/configure-azure-cni",
            "service": "AKS",
            "severity": "高",
            "text": "相應調整服務 IP 位址範圍的大小（這將限制群集的可伸縮性）",
            "waf": "可靠性"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "57bf217f-6dc8-481c-81e2-785773e9c00f",
            "link": "https://learn.microsoft.com/azure/aks/use-byo-cni",
            "service": "AKS",
            "severity": "低",
            "text": "如果需要，請添加您自己的 CNI 外掛程式",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "4b3bb365-9458-44d9-9ed1-5c8f52890364",
            "link": "https://learn.microsoft.com/azure/aks/use-multiple-node-pools#assign-a-public-ip-per-node-for-your-node-pools",
            "service": "AKS",
            "severity": "低",
            "text": "如果需要，請在 AKS 中配置每個節點的公共 IP",
            "waf": "性能"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "b3808b9f-a1cf-4204-ad01-3a923ce474db",
            "link": "https://learn.microsoft.com/azure/aks/concepts-network",
            "service": "AKS",
            "severity": "中等",
            "text": "使用入口控制器公開基於 Web 的應用，而不是使用 LoadBalancer 類型的服務公開它們",
            "waf": "可靠性"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "ccb534e7-416e-4a1d-8e93-533b53199085",
            "link": "https://learn.microsoft.com/azure/aks/nat-gateway",
            "service": "AKS",
            "severity": "低",
            "text": "使用 Azure NAT 閘道作為 outboundType 來縮放出口流量",
            "waf": "可靠性"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "8ee9a69a-1b58-4b1e-9c61-476e110a160b",
            "link": "https://learn.microsoft.com/azure/aks/configure-azure-cni#dynamic-allocation-of-ips-and-enhanced-subnet-support",
            "service": "AKS",
            "severity": "中等",
            "text": "使用IP的動態分配來避免 Azure CNI IP 耗盡",
            "waf": "可靠性"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (properties.networkProfile.outboundType=='userDefinedRouting') | distinct id,compliant",
            "guid": "3b365a91-7ecb-4e48-bbe5-4cd7df2e8bba",
            "link": "https://learn.microsoft.com/azure/aks/limit-egress-traffic",
            "service": "AKS",
            "severity": "高",
            "text": "如果安全要求要求，請使用 AzFW/NVA 篩選出口流量",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = ((isnull(properties.apiServerAccessProfile.enablePrivateCluster) or properties.apiServerAccessProfile.enablePrivateCluster==false) and isnotnull(properties.apiServerAccessProfile.authorizedIPRanges)) | distinct id,compliant",
            "guid": "c4581559-bb91-463e-a908-aed8c44ce3b2",
            "link": "https://learn.microsoft.com/azure/aks/api-server-authorized-ip-ranges",
            "service": "AKS",
            "severity": "中等",
            "text": "如果使用公共 API 終端節點，請限制可以存取它的 IP 位址",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | where isnotnull(properties.apiServerAccessProfile.enablePrivateCluster) | extend compliant = (properties.apiServerAccessProfile.enablePrivateCluster==true) | distinct id, compliant",
            "guid": "ecccd979-3b6b-4cda-9b50-eb2eb03dda6d",
            "link": "https://learn.microsoft.com/azure/aks/private-clusters",
            "service": "AKS",
            "severity": "高",
            "text": "如果要求要求，請使用私有集群",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | where isnotnull(properties.apiServerAccessProfile.enablePrivateCluster) | extend compliant = (properties.apiServerAccessProfile.enablePrivateCluster==true) | distinct id, compliant",
            "guid": "ce7f2a7c-297c-47c6-adea-a6ff838db665",
            "link": "https://learn.microsoft.com/azure/aks/use-network-policies",
            "service": "AKS",
            "severity": "中等",
            "text": "對於 Windows 2019 和 2022 AKS 節點，可以使用 Calico 網路策略",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = isnotnull(properties.networkProfile.networkPolicy) | distinct id,compliant",
            "guid": "58d7c892-ddb1-407d-9769-ae669ca48e4a",
            "link": "https://learn.microsoft.com/azure/aks/use-network-policies",
            "service": "AKS",
            "severity": "高",
            "text": "啟用 Kubernetes 網路策略選項 （Calico/Azure）",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "85e2223e-ce8b-4b12-907c-a5f16f158e3e",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-network",
            "service": "AKS",
            "severity": "高",
            "text": "使用 Kubernetes 網路策略提高集群內安全性",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "a3a92c2d-e7e2-4165-a3a8-7af4a7a1f893",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-network",
            "service": "AKS",
            "severity": "高",
            "text": "將 WAF 用於 Web 工作負載（UI 或 API）",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "Resources | where type=~'microsoft.containerservice/managedclusters' | project resourceGroup,name,pools=properties.agentPoolProfiles | mv-expand pools | project subnetId=tostring(pools.vnetSubnetID) | where isnotempty(subnetId) | join (Resources | where type=='microsoft.network/virtualnetworks' | project id,resourceGroup,name,enableDdosProtection=tostring(properties.enableDdosProtection),subnets=properties.subnets | mv-expand subnets | project id,resourceGroup,name,enableDdosProtection,subnetId=tostring(subnets.id)) on subnetId | distinct id,resourceGroup,name,enableDdosProtection | extend compliant = (enableDdosProtection == 'true')",
            "guid": "9bda4776-8f24-4c11-9775-c2ea55b46a94",
            "link": "https://learn.microsoft.com/azure/virtual-network/ddos-protection-overview",
            "service": "AKS",
            "severity": "中等",
            "text": "在 AKS 虛擬網路中使用 DDoS 標準",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "Resources | where type=~'microsoft.containerservice/managedclusters' | project resourceGroup,name,pools=properties.agentPoolProfiles | mv-expand pools | project subnetId=tostring(pools.vnetSubnetID) | where isnotempty(subnetId) | join (Resources | where type=='microsoft.network/virtualnetworks' | project id,resourceGroup,name,enableDdosProtection=tostring(properties.enableDdosProtection),subnets=properties.subnets | mv-expand subnets | project id,resourceGroup,name,enableDdosProtection,subnetId=tostring(subnets.id)) on subnetId | distinct id,resourceGroup,name,enableDdosProtection | extend compliant = (enableDdosProtection == 'true')",
            "guid": "6c46b91a-1107-4485-ad66-3183e2a8c266",
            "link": "https://learn.microsoft.com/azure/aks/http-proxy",
            "service": "AKS",
            "severity": "低",
            "text": "如果需要，請添加公司 HTTP 代理",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "e9855d04-c3c3-49c9-a6bb-2c12159a114b",
            "link": "https://learn.microsoft.com/azure/aks/servicemesh-about",
            "service": "AKS",
            "severity": "中等",
            "text": "考慮使用服務網格進行高級微服務通信管理",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "67f7a9ed-5b31-4f38-a3f3-9812b2463cff",
            "link": "https://learn.microsoft.com/azure/azure-monitor/insights/container-insights-metric-alerts",
            "service": "AKS",
            "severity": "高",
            "text": "設定有關最關鍵指標的警報（請參閱容器見解以獲取建議）",
            "waf": "操作"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "337453a3-cc63-4963-9a65-22ac19e80696",
            "link": "https://learn.microsoft.com/azure/advisor/advisor-get-started",
            "service": "AKS",
            "severity": "低",
            "text": "定期查看 Azure 顧問，瞭解有關群集的建議",
            "waf": "操作"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "3aa70560-e7e7-4968-be3d-628af35b2ced",
            "link": "https://learn.microsoft.com/azure/aks/certificate-rotation",
            "service": "AKS",
            "severity": "低",
            "text": "啟用 AKS 自動證書輪換",
            "waf": "操作"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "e189c599-df0d-45a7-9dd4-ce32c1881370",
            "link": "https://learn.microsoft.com/azure/aks/supported-kubernetes-versions",
            "service": "AKS",
            "severity": "高",
            "text": "定期（例如，每季度）升級 kubernetes 版本，或使用 AKS 自動升級功能",
            "waf": "操作"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "6f7c4c0d-4e51-4464-ad24-57ed67138b82",
            "link": "https://learn.microsoft.com/azure/aks/node-updates-kured",
            "service": "AKS",
            "severity": "高",
            "text": "如果您不使用 node-image 升級，請使用 kured 進行 Linux 節點升級",
            "waf": "操作"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "139c9580-ade3-426a-ba09-cf157d9f6477",
            "link": "https://learn.microsoft.com/azure/aks/node-image-upgrade",
            "service": "AKS",
            "severity": "高",
            "text": "定期（例如，每周）升級群集節點映像的常規過程",
            "waf": "操作"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "0102ce16-ee30-41e6-b882-e52e4621dd68",
            "link": "https://learn.microsoft.com/azure/architecture/example-scenario/bedrock/bedrock-automated-deployments",
            "service": "AKS",
            "severity": "低",
            "text": "考慮使用 gitops 將應用程式或集群配置部署到多個集群",
            "waf": "操作"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "d7672c26-7602-4482-85a4-14527fbe855c",
            "link": "https://learn.microsoft.com/azure/aks/command-invoke",
            "service": "AKS",
            "severity": "低",
            "text": "請考慮在專用群集上使用 AKS 命令調用",
            "waf": "操作"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "31d7aaab-7571-4449-ab80-53d89e89d17b",
            "link": "https://learn.microsoft.com/azure/aks/node-auto-repair#node-autodrain",
            "service": "AKS",
            "severity": "低",
            "text": "對於計劃的事件，請考慮使用 Node Auto Drain",
            "waf": "操作"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "ed0fda7f-211b-47c7-8b6e-c18873fb473c",
            "link": "https://learn.microsoft.com/azure/aks/faq",
            "service": "AKS",
            "severity": "高",
            "text": "開發自己的治理實踐，以確保節點 RG（又名“基礎設施 RG”）中的操作員不會執行任何更改",
            "waf": "操作"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (properties.nodeResourceGroup !startswith 'MC_') | distinct id,compliant",
            "guid": "73b32a5a-67f7-4a9e-b5b3-1f38c3f39812",
            "link": "https://learn.microsoft.com/azure/aks/cluster-configuration",
            "service": "AKS",
            "severity": "低",
            "text": "使用自定義節點 RG（又名“Infra RG”）名稱",
            "waf": "操作"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "b2463cff-e189-4c59-adf0-d5a73dd4ce32",
            "link": "https://kubernetes.io/docs/setup/release/notes/",
            "service": "AKS",
            "severity": "中等",
            "text": "請勿在 YAML 清單中使用已棄用的 Kubernetes API",
            "waf": "操作"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "c1881370-6f7c-44c0-b4e5-14648d2457ed",
            "link": "https://learn.microsoft.com/azure-stack/aks-hci/adapt-apps-mixed-os-clusters",
            "service": "AKS",
            "severity": "低",
            "text": "污染 Windows 節點",
            "waf": "操作"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "67138b82-0102-4ce1-9ee3-01e6e882e52e",
            "link": "https://learn.microsoft.com/virtualization/windowscontainers/deploy-containers/version-compatibility?tabs=windows-server-20H2%2Cwindows-10-20H2",
            "service": "AKS",
            "severity": "低",
            "text": "使 Windows 容器修補程式級別與主機修補程式級別保持同步",
            "waf": "操作"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "description": "通過群集級別的診斷設置",
            "guid": "5b56ad48-408f-4e72-934c-476ba280dcf5",
            "link": "https://learn.microsoft.com/azure/aks/monitor-aks",
            "service": "AKS",
            "severity": "低",
            "text": "將主日誌（又名 API 紀錄）發送到 Azure Monitor 或首選日誌管理解決方案",
            "waf": "操作"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "64d1a846-e28a-4b6b-9a33-22a635c15a21",
            "link": "https://learn.microsoft.com/azure/aks/node-pool-snapshot",
            "service": "AKS",
            "severity": "低",
            "text": "如果需要，請使用 nodePool 快照",
            "waf": "成本"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "c5a5b252-1e44-4a59-a9d2-399c4d7b68d0",
            "link": "https://learn.microsoft.com/azure/aks/spot-node-pool",
            "service": "AKS",
            "severity": "低",
            "text": "考慮將現成節點池用於對時間敏感的工作負載",
            "waf": "操作"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (isnotnull(properties.addonProfiles.aciConnectorLinux) and properties.addonProfiles.aciConnectorLinux.enabled==true) | distinct id,compliant",
            "guid": "c755562f-2b4e-4456-9b4d-874a748b662e",
            "link": "https://learn.microsoft.com/azure/aks/concepts-scale",
            "service": "AKS",
            "severity": "低",
            "text": "考慮用於快速突發的 AKS 虛擬節點",
            "waf": "操作"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "6f8389a7-f82c-4b8e-a8c0-aa63a25a4956",
            "link": "https://learn.microsoft.com/azure/azure-monitor/insights/container-insights-overview",
            "service": "AKS",
            "severity": "高",
            "text": "使用 Container Insights（或 Prometheus 等其他工具）監控集群指標",
            "waf": "操作"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (isnotnull(properties.addonProfiles.omsagent) and properties.addonProfiles.omsagent.enabled==true) | distinct id,compliant",
            "guid": "eaa8dc4a-2436-47b3-9697-15b1752beee0",
            "link": "https://learn.microsoft.com/azure/azure-monitor/insights/container-insights-overview",
            "service": "AKS",
            "severity": "高",
            "text": "使用 Container Insights（或 Telegraf/ElasticSearch 等其他工具）存儲和分析集群日誌",
            "waf": "操作"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "4621dd68-c5a5-4be2-bdb1-1726769ef669",
            "link": "https://learn.microsoft.com/azure/azure-monitor/containers/container-insights-analyze",
            "service": "AKS",
            "severity": "中等",
            "text": "監控節點的 CPU 和記憶體利用率",
            "waf": "操作"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "1a4835ac-9422-423e-ae80-b123081a5417",
            "link": "https://learn.microsoft.com/azure/aks/configure-azure-cni",
            "service": "AKS",
            "severity": "中等",
            "text": "如果使用 Azure CNI，請監視每個節點消耗的 Pod IP 的百分比",
            "waf": "操作"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "description": "OS 磁碟上的 I/O 是關鍵資源。如果節點中的操作系統在 I/O 上受到限制，這可能會導致不可預知的行為，通常最終導致節點被聲明為 NotReady",
            "guid": "415833ea-3ad3-4c2d-b733-165c3acbe04b",
            "link": "https://learn.microsoft.com/azure/virtual-machines/premium-storage-performance",
            "service": "AKS",
            "severity": "中等",
            "text": "監視節點中的OS磁碟佇列深度",
            "waf": "操作"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "be209d39-fda4-4777-a424-d116785c2fa5",
            "link": "https://learn.microsoft.com/azure/aks/load-balancer-standard",
            "service": "AKS",
            "severity": "中等",
            "text": "如果不對 AzFW/NVA 使用出口篩選，請監視標準 ALB 分配的 SNAT 連接埠",
            "waf": "操作"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "74c2ee76-569b-4a79-a57e-dedf91b022c9",
            "link": "https://learn.microsoft.com/azure/aks/aks-resource-health",
            "service": "AKS",
            "severity": "中等",
            "text": "訂閱 AKS 群集的資源運行狀況通知",
            "waf": "操作"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "b54eb2eb-03dd-4aa3-9927-18e2edb11726",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-scheduler",
            "service": "AKS",
            "severity": "高",
            "text": "在 Pod 規範中配置請求和限制",
            "waf": "操作"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "769ef669-1a48-435a-a942-223ece80b123",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-scheduler",
            "service": "AKS",
            "severity": "中等",
            "text": "強制實施命名空間的資源配額",
            "waf": "操作"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "081a5417-4158-433e-a3ad-3c2de733165c",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits",
            "service": "AKS",
            "severity": "高",
            "text": "確保訂閱具有足夠的配額來橫向擴展節點池",
            "waf": "操作"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (isnotnull(properties.autoScalerProfile)) | distinct id,compliant",
            "guid": "90ce65de-8e13-4f9c-abd4-69266abca264",
            "link": "https://learn.microsoft.com/azure/aks/concepts-scale",
            "service": "AKS",
            "severity": "中等",
            "text": "使用群集自動縮放程式",
            "waf": "性能"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (isnotnull(properties.austoscalerProfile)) | distinct id,compliant",
            "guid": "831c2872-c693-4b39-a887-a561bada49bc",
            "link": "https://learn.microsoft.com/azure/aks/custom-node-configuration",
            "service": "AKS",
            "severity": "低",
            "text": "自定義 AKS 節點池的節點配置",
            "waf": "性能"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "faa19bfe-9d55-4d04-a3c4-919ca1b2d121",
            "link": "https://learn.microsoft.com/azure/aks/concepts-scale",
            "service": "AKS",
            "severity": "中等",
            "text": "需要時使用 Horizontal Pod Autoscaler",
            "waf": "性能"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "description": "更大的節點將帶來更高的性能和功能，例如臨時磁碟和加速網路，但它們會增加爆炸半徑並降低擴展粒度",
            "guid": "5ae124ba-34df-4585-bcdc-e9bd3bb0cdb3",
            "link": "https://blog.cloudtrooper.net/2020/10/23/which-vm-size-should-i-choose-as-aks-node/",
            "service": "AKS",
            "severity": "高",
            "text": "考慮適當的節點大小，不要太大或太小",
            "waf": "性能"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "38800e6a-ae01-40a2-9fbc-ae5a06e5462d",
            "link": "https://learn.microsoft.com/azure/aks/quotas-skus-regions#service-quotas-and-limits",
            "service": "AKS",
            "severity": "低",
            "text": "如果可伸縮性需要超過 5000 個節點，請考慮使用其他 AKS 群集",
            "waf": "性能"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "9583c0f6-6083-43f6-aa6b-df7102c901bb",
            "link": "https://learn.microsoft.com/azure/event-grid/event-schema-aks",
            "service": "AKS",
            "severity": "低",
            "text": "考慮訂閱 EventGrid Events for AKS 自動化",
            "waf": "性能"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "c5016d8c-c6c9-4165-89ae-673ef0fff19d",
            "link": "https://learn.microsoft.com/azure/aks/manage-abort-operations",
            "service": "AKS",
            "severity": "低",
            "text": "若要在 AKS 群集上長時間運行操作，請考慮事件終止",
            "waf": "性能"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "c4e37133-f186-4ce1-aed9-9f1b32f6e021",
            "link": "https://learn.microsoft.com/azure/aks/use-azure-dedicated-hosts",
            "service": "AKS",
            "severity": "低",
            "text": "如果需要，請考慮將 Azure 專用主機用於 AKS 節點",
            "waf": "性能"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | project id,resourceGroup,name,pools=properties.agentPoolProfiles | mvexpand pools | extend compliant = (pools.osDiskType=='Ephemeral') | project id,name=strcat(name,'-',pools.name), resourceGroup, compliant",
            "guid": "24367b33-6971-45b1-952b-eee0b9b588de",
            "link": "https://learn.microsoft.com/azure/aks/cluster-configuration",
            "service": "AKS",
            "severity": "高",
            "text": "使用臨時OS磁碟",
            "waf": "性能"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "f0ce315f-1120-4166-8206-94f2cf3a4d07",
            "link": "https://learn.microsoft.com/azure/virtual-machines/disks-types",
            "service": "AKS",
            "severity": "高",
            "text": "對於非臨時磁碟，在運行多個 Pod/節點時，請為節點使用高 IOPS 和更大的 OS 磁碟，因為它需要高性能才能運行多個 Pod，並且會生成具有預設 AKS 日誌輪換閾值的大量日誌",
            "waf": "性能"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "39c486ce-d5af-4062-89d5-18bb5fd795db",
            "link": "https://learn.microsoft.com/azure/aks/use-ultra-disks",
            "service": "AKS",
            "severity": "低",
            "text": "對於超高性能存儲選項，請在 AKS 上使用超級磁碟For hyper performance storage option use Ultra Disks on AKS",
            "waf": "性能"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "9f7547c1-747d-4c56-868a-714435bd19dd",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-multi-region",
            "service": "AKS",
            "severity": "中等",
            "text": "避免將狀態保留在群集中，並將數據存儲在外部（AzStorage、AzSQL、Cosmos 等）",
            "waf": "性能"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "24429eb7-2281-4376-85cc-57b4a4b18142",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-storage",
            "service": "AKS",
            "severity": "中等",
            "text": "如果使用 AzFiles Standard，出於性能原因，請考慮使用 AzFiles Premium 和/或 ANF",
            "waf": "性能"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "83958a8c-2689-4b32-ab57-cfc64546135a",
            "link": "https://learn.microsoft.com/azure/aks/availability-zones#azure-disk-availability-zone-support",
            "service": "AKS",
            "severity": "中等",
            "text": "如果使用 Azure 磁碟和可用區，請考慮在區域內為 LRS 磁碟設置節點池，並使用 VolumeBindingMode：WaitForFirstConsumer 在正確的區域中預配存儲，或將 ZRS 磁碟用於跨多個區域的節點池",
            "waf": "性能"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "32e42e36-11c8-418b-8a0b-c510e43a18a9",
            "service": "AVS",
            "severity": "高",
            "text": "確保在本機 Azure 的標識訂閱中部署了 ADDS 域控制器",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "75089c20-990d-4927-b105-885576f76fc2",
            "service": "AVS",
            "severity": "中等",
            "text": "確保將 ADDS 網站和服務配置為將來自基於 Azure 的資源（包括 Azure VMware 解決方案）的身份驗證請求保留到 Azure 本地",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "de3aad1e-7c28-4ec9-9666-b7570449aa80",
            "service": "AVS",
            "severity": "高",
            "text": "確保 vCenter 已連接到 ADDS，以啟用基於「指定用戶帳戶」的身份驗證",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "cd289ced-6b17-4db8-8554-61e2aee3553a",
            "service": "AVS",
            "severity": "中等",
            "text": "確保從 vCenter 到 ADDS 的連接使用安全協定 （LDAPS）",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "b9d37dac-43bc-46cd-8d79-a9b24604489a",
            "service": "AVS",
            "severity": "中等",
            "text": "vCenter IdP 中的 CloudAdmin 帳戶僅用作緊急帳戶 （break-glass）",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "53d88e89-d17b-473b-82a5-a67e7a9ed5b3",
            "service": "AVS",
            "severity": "高",
            "text": "確保 NSX-Manager 與外部身份提供程式 （LDAPS） 集成",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "ae0e37ce-e297-411b-b352-caaab79b198d",
            "service": "AVS",
            "severity": "中等",
            "text": "是否已創建 RBAC 模型以在 VMware vSphere 中使用",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "ab81932c-9fc9-4d1b-a780-36f5e6bfbb9e",
            "service": "AVS",
            "severity": "中等",
            "text": "RBAC 許可權應授予 ADDS 組，而不是特定使用者",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "d503547c-c447-4e82-9128-a71f0f1cac6d",
            "service": "AVS",
            "severity": "高",
            "text": "Azure 中 Azure VMware 解決方案資源的 RBAC 許可權僅「鎖定」為一組有限的擁有者",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "fd9f0df4-68dc-4976-b9a9-e6a79f7682c5",
            "service": "AVS",
            "severity": "高",
            "text": "確保所有自定義角色的範圍都具有 CloudAdmin 允許的授權",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "9ef1d5e8-32e4-42e3-911c-818b0a0bc510",
            "link": "https://github.com/Azure/AzureCAT-AVS/tree/main/networking",
            "service": "AVS",
            "severity": "高",
            "text": "是否為手頭的客戶用例選擇了正確的 Azure VMware 解決方案連接模型",
            "waf": "性能"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "eb710a37-cbc1-4055-8dd5-a936a8bb7cf5",
            "service": "AVS",
            "severity": "高",
            "text": "確保使用「連接監視器」監視從本地到 Azure 的 ExpressRoute 或 VPN 連接",
            "waf": "操作"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "976e24f2-a7f8-426c-9253-2a92a2a7ed99",
            "service": "AVS",
            "severity": "中等",
            "text": "確保創建從 Azure 本機資源到 Azure VMware 解決方案虛擬機的連接監視器，以監視 Azure VMware 解決方案後端 ExpressRoute 連接",
            "waf": "操作"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "f41ce6a0-64f3-4805-bc65-3ab50df01265",
            "service": "AVS",
            "severity": "中等",
            "text": "確保創建從本地資源到 Azure VMware 解決方案虛擬機的連接監視器，以監視端到端連接",
            "waf": "操作"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "563b4dc7-4a74-48b6-933a-d1a0916a6649",
            "service": "AVS",
            "severity": "高",
            "text": "使用路由伺服器時，請確保從路由伺服器到 ExR 閘道再到本地的路由不超過 1000 個（ARS 限制）。",
            "waf": "操作"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "6128a71f-0f1c-4ac6-b9ef-1d5e832e42e3",
            "service": "AVS",
            "severity": "高",
            "text": "是否為在 Azure 門戶中管理 Azure VMware 解決方案資源的角色實現了 Privileged Identity Management（不允許長期許可權）",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "c4e2436b-b336-4d71-9f17-960eee0b9b5c",
            "service": "AVS",
            "severity": "高",
            "text": "應為 Azure VMware 解決方案 PIM 角色實現 Privileged Identity Management 審核報告",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "78c447a8-26b2-4863-af0f-1cac599ef1d5",
            "service": "AVS",
            "severity": "中等",
            "text": "如果使用 Privileged Identity Management，請確保使用有效的 SMTP 記錄創建啟用了 Entra ID 的有效帳戶，以便 Azure VMware 解決方案自動主機更換通知。（需要長期許可）",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "8defc4d7-21d3-41d2-90fb-707ae9eab40e",
            "service": "AVS",
            "severity": "高",
            "text": "將 CloudAdmin 帳戶的使用限制為僅緊急訪問",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "d329f798-bc17-48bd-a5a0-6ca7144351d1",
            "service": "AVS",
            "severity": "中等",
            "text": "在 vCenter 中創建自定義 RBAC 角色，以在 vCenter 中實施最小特權模型",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "9dd24429-eb72-4281-97a1-51c5bb4e4f18",
            "service": "AVS",
            "severity": "中等",
            "text": "是定義為定期輪換 cloudadmin （vCenter） 和管理員 （NSX） 憑據的過程",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "586cb291-ec16-4a1d-876e-f9f141acdce5",
            "service": "AVS",
            "severity": "高",
            "text": "使用集中式識別提供者用於在 Azure VMware 解決方案上運行的工作負載 （VM）",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "79377bcd-b375-41ab-8ab0-ead66e15d3d4",
            "service": "AVS",
            "severity": "中等",
            "text": "是否在 NSX-T 中實施了東西向流量篩選",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "a2adb1c3-d232-46af-825c-a44e1695fddd",
            "service": "AVS",
            "severity": "高",
            "text": "Azure VMware 解決方案上的工作負載不會直接向 Internet 公開。流量由 Azure 應用程式閘道、Azure 防火牆或第三方解決方案進行篩選和檢查",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "eace4cb1-deb4-4c65-8c3f-c14eeab36938",
            "service": "AVS",
            "severity": "高",
            "text": "對 Azure VMware 解決方案和基於 Azure VMware 解決方案的工作負載的入站 Internet 請求實施審核和日誌記錄",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "29e3eec2-1836-487a-8077-a2b5945bda43",
            "service": "AVS",
            "severity": "中等",
            "text": "對來自 Azure VMware 解決方案或基於 Azure VMware 解決方案的工作負載的出站 Internet 連接實施會話監視，以識別可疑/惡意活動",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "334fdf91-c234-4182-a652-75269440b4be",
            "service": "AVS",
            "severity": "中等",
            "text": "是否在 Azure 的 ExR/VPN 閘道子網上啟用了 DDoS 標準防護",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "3d3e0843-276d-44bd-a015-bcf219e4a1eb",
            "service": "AVS",
            "severity": "中等",
            "text": "使用專用特權訪問工作站 （PAW） 管理 Azure VMware 解決方案、vCenter、NSX Manager 和 HCX Manager",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "9ccbd869-266a-4cca-874f-aa19bf39d95d",
            "service": "AVS",
            "severity": "中等",
            "text": "為 Azure VMware 解決方案上運行的工作負載啟用高級威脅檢測（Microsoft Defender for Cloud，又名 ASC）",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "44c7c891-9ca1-4f6d-9315-ae524ba34d45",
            "service": "AVS",
            "severity": "中等",
            "text": "使用適用於伺服器的 Azure ARC 使用 Azure 本機技術正確管理在 Azure VMware 解決方案上運行的工作負載（適用於 Azure VMware 解決方案的 Azure ARC 尚不可用）",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "85e12139-bd7b-4b01-8f7b-95ef6e043e2a",
            "service": "AVS",
            "severity": "低",
            "text": "確保 Azure VMware 解決方案上的工作負載在運行時使用足夠的數據加密（如來賓內磁碟加密和 SQL TDE）。（vSAN 靜態加密為預設加密）",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "a3592718-e6e2-4051-9267-6ae46691e883",
            "service": "AVS",
            "severity": "低",
            "text": "使用來賓內加密時，請盡可能將加密密鑰存儲在 Azure Key Vault 中",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "5ac94222-3e13-4810-9230-81a941741583",
            "service": "AVS",
            "severity": "中等",
            "text": "請考慮對 Azure VMware 解決方案上運行的工作負載使用擴展的安全更新支援（Azure VMware 解決方案符合 ESU 條件）",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "3ef7ad7c-6d37-4331-95c7-acbe44bbe609",
            "service": "AVS",
            "severity": "高",
            "text": "確保使用適當的 vSAN 資料冗餘方法（RAID 規範）",
            "waf": "可靠性"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "d88408f3-7273-44c8-96ba-280214590146",
            "service": "AVS",
            "severity": "高",
            "text": "確保允許失敗策略已到位，以滿足您的 vSAN 儲存需求",
            "waf": "可靠性"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "d89f2e87-7784-424d-9167-85c6fa95b96a",
            "service": "AVS",
            "severity": "高",
            "text": "確保已請求足夠的配額，確保已考慮增長和災難恢復要求",
            "waf": "可靠性"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "5d38e53f-9ccb-4d86-a266-acca274faa19",
            "service": "AVS",
            "severity": "中等",
            "text": "確保瞭解對 ESXi 的訪問限制，其中存在可能影響第三方解決方案的訪問限制。",
            "waf": "操作"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "bf39d95d-44c7-4c89-89ca-1f6d5315ae52",
            "service": "AVS",
            "severity": "中等",
            "text": "確保您制定了有關ESXi主機密度和效率的策略，並牢記請求新節點的提前期",
            "waf": "操作"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "4ba34d45-85e1-4213-abd7-bb012f7b95ef",
            "service": "AVS",
            "severity": "中等",
            "text": "確保 Azure VMware 解決方案的良好成本管理流程已到位 - 可以使用 Azure 成本管理",
            "waf": "成本"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "6e043e2a-a359-4271-ae6e-205172676ae4",
            "service": "AVS",
            "severity": "低",
            "text": "Azure 預留實例是否用於優化使用 Azure VMware 解決方案的成本",
            "waf": "成本"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "6691e883-5ac9-4422-83e1-3810523081a9",
            "service": "AVS",
            "severity": "中等",
            "text": "使用其他 Azure 本機服務時，請考慮使用 Azure 專用連結",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "db611712-6904-40b4-aa3d-3e0803276d4b",
            "service": "AVS",
            "severity": "高",
            "text": "確保所有必需的資源都駐留在同一個 Azure 可用性區域中",
            "waf": "性能"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "48b262d6-cc5f-4512-a253-98e6db9d37da",
            "service": "AVS",
            "severity": "中等",
            "text": "為 Azure VMware 解決方案來賓 VM 工作負載啟用 Microsoft Defender for Cloud",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "41741583-3ef7-4ad7-a6d3-733165c7acbe",
            "service": "AVS",
            "severity": "中等",
            "text": "使用已啟用 Azure Arc 的伺服器管理 Azure VMware 解決方案來賓 VM 工作負載",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "88f03a4d-2cd4-463c-abbc-868295abc91a",
            "service": "AVS",
            "severity": "高",
            "text": "在 Azure VMware 解決方案上啟用診斷和指標日誌記錄",
            "waf": "操作"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "4ed90dae-2cc8-44c4-9b6b-781cbafe6c46",
            "service": "AVS",
            "severity": "中等",
            "text": "將Log Analytics代理部署到 Azure VMware 解決方案來賓 VM 工作負載",
            "waf": "操作"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "589d457a-927c-4397-9d11-02cad6aae11e",
            "service": "AVS",
            "severity": "中等",
            "text": "確保已針對 Azure VMware 解決方案 VM 工作負載記錄並實施了備份策略和解決方案",
            "waf": "操作"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "ee29711b-d352-4caa-ab79-b198dab81932",
            "service": "AVS",
            "severity": "中等",
            "text": "使用 Microsoft Defender for Cloud 對 Azure VMware 解決方案上運行的工作負載進行合規性監視",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "c9fc9d1b-b780-436f-9e6b-fbb9ed503547",
            "service": "AVS",
            "severity": "中等",
            "text": "是否將適用的合規性基線添加到 Microsoft Defender for Cloud",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "cc447e82-6128-4a71-b0f1-cac6d9ef1d5e",
            "service": "AVS",
            "severity": "高",
            "text": "在選擇要用於 Azure VMware 解決方案部署的 Azure 區域時是否評估了數據駐留",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "832e42e3-611c-4818-a0a0-bc510e43a18a",
            "service": "AVS",
            "severity": "高",
            "text": "數據處理影響（服務提供者/服務消費者模型）是否清晰且有據可查",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "547c1747-dc56-4068-a714-435cd19dd244",
            "service": "AVS",
            "severity": "中等",
            "text": "僅當出於合規性原因需要時，才考慮將CMK（客戶管理的密鑰）用於 vSAN。",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "e43a18a9-cd28-49ce-b6b1-7db8255461e2",
            "service": "AVS",
            "severity": "高",
            "text": "創建儀錶板以啟用核心 Azure VMware 解決方案監視見解",
            "waf": "操作"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "6b84ee5d-f47d-42d9-8881-b1cd5d1e54a2",
            "service": "AVS",
            "severity": "高",
            "text": "針對 Azure VMware 解決方案性能（CPU >80%、平均記憶體 >80%、vSAN >70%）自動警報的關鍵閾值創建警告警報",
            "waf": "操作"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "9659e396-80e7-4828-ac93-5657d02bff45",
            "service": "AVS",
            "severity": "高",
            "text": "確保創建嚴重警示以監控 vSAN 消耗量是否低於 75%，因為這是 VMware 的支援閾值",
            "waf": "操作"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "64b0d934-a348-4726-be79-d6b5c3a36495",
            "service": "AVS",
            "severity": "高",
            "text": "確保為 Azure 服務運行狀況警報和通知配置警報",
            "waf": "操作"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "b6abad38-aad5-43cc-99e1-d86667357c54",
            "service": "AVS",
            "severity": "中等",
            "text": "將 Azure VMware 解決方案記錄設定為發送到 Azure 儲存帳戶或 Azure EventHub 進行處理",
            "waf": "操作"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "9674c5ed-85b8-459c-9733-be2b1a27b775",
            "service": "AVS",
            "severity": "低",
            "text": "如果需要深入瞭解 VMware vSphere：解決方案中是否使用了 vRealize Operations 和/或 vRealize Network Insights？",
            "waf": "操作"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "a91be1f3-88f0-43a4-b2cd-463cbbbc8682",
            "service": "AVS",
            "severity": "高",
            "text": "確保虛擬機的 vSAN 儲存策略不是預設存儲策略，因為此策略應用厚置備",
            "waf": "操作"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "d9ef1d5e-832d-442e-9611-c818b0afbc51",
            "service": "AVS",
            "severity": "中等",
            "text": "確保未將 vSphere 內容庫放置在 vSAN 上，因為 vSAN 是有限的資源",
            "waf": "操作"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "0e43a18a-9cd2-489b-bd6b-17db8255461e",
            "service": "AVS",
            "severity": "中等",
            "text": "確保備份解決方案的數據存儲庫存儲在 vSAN 儲存之外。在 Azure 本機或磁碟池支持的數據存儲中",
            "waf": "操作"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "2aee3453-aec8-4339-848b-262d6cc5f512",
            "service": "AVS",
            "severity": "中等",
            "text": "確保使用 Azure Arc for Servers 進行混合管理，確保在 Azure VMware 解決方案上運行的工作負載（Arc for Azure VMware 解決方案處於預覽狀態）",
            "waf": "操作"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "925398e6-da9d-437d-ac43-bc6cd1d79a9b",
            "service": "AVS",
            "severity": "中等",
            "text": "確保使用 Azure Log Analytics 和 Azure Monitor 監視在 Azure VMware 解決方案上運行的工作負載",
            "waf": "操作"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "24604489-a8f4-42d7-ae78-cb6a33bd2a09",
            "service": "AVS",
            "severity": "中等",
            "text": "在現有更新管理工具或 Azure 更新管理中包括在 Azure VMware 解決方案上運行的工作負載",
            "waf": "操作"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "17e7a8d9-0ae0-4e27-aee2-9711bd352caa",
            "service": "AVS",
            "severity": "中等",
            "text": "使用 Azure Policy 在 Azure 管理、監視和安全解決方案中加入 Azure VMware 解決方案工作負載",
            "waf": "操作"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "aee3553a-fc83-4392-98b2-62d6cc5f5129",
            "service": "AVS",
            "severity": "中等",
            "text": "確保在 Azure VMware 解決方案上運行的工作負載已載入 Microsoft Defender for Cloud",
            "waf": "安全"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "25398e6d-b9d3-47da-a43b-c6cd1d79a9b2",
            "service": "AVS",
            "severity": "中等",
            "text": "確保備份不存儲在 vSAN 上，因為 vSAN 是有限的資源",
            "waf": "可靠性"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "5e6bfbb9-ed50-4354-9cc4-47e826028a71",
            "service": "AVS",
            "severity": "中等",
            "text": "是否考慮了所有災難恢復解決方案，並決定了最適合您業務的解決方案？[SRM/JetStream/Zerto/Veeam/...]",
            "waf": "可靠性"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "f0f1cac6-d9ef-41d5-b832-d42e3611c818",
            "service": "AVS",
            "severity": "中等",
            "text": "當災難恢復技術是本機 Azure IaaS 時，請使用 Azure Site Recovery",
            "waf": "可靠性"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "b0afbc51-0e43-4a18-a9cd-289bed6b17db",
            "service": "AVS",
            "severity": "高",
            "text": "將自動恢復計劃與任一災難解決方案結合使用，盡可能避免手動任務",
            "waf": "可靠性"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "8255461e-2aee-4345-9aec-8339248b262d",
            "service": "AVS",
            "severity": "中等",
            "text": "使用地緣政治區域對作為輔助災難恢復環境",
            "waf": "可靠性"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "6cc5f512-9253-498e-9da9-d37dac43bc6c",
            "service": "AVS",
            "severity": "高",
            "text": "在區域之間使用 2 個不同的地址空間，例如：10.0.0.0/16 和 192.168.0.0/16 用於不同的區域",
            "waf": "可靠性"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "d1d79a9b-2460-4448-aa8f-42d78e78cb6a",
            "service": "AVS",
            "severity": "中等",
            "text": "ExpressRoute Global Reach 是用於主 Azure VMware 解決方案私有雲和輔助 Azure VMware 解決方案私有雲之間的連接，還是通過網路虛擬設備完成路由？",
            "waf": "可靠性"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "33bd2a09-17e7-4a8d-a0ae-0e27cee29711",
            "service": "AVS",
            "severity": "中等",
            "text": "是否考慮了所有備份解決方案，並決定了最適合您業務的解決方案？[ MABS/CommVault/Metallic.io/Veeam/ .",
            "waf": "可靠性"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "bd352caa-ab79-4b18-adab-81932c9fc9d1",
            "service": "AVS",
            "severity": "中等",
            "text": "將備份解決方案部署在與 Azure VMware 解決方案私有雲相同的區域中",
            "waf": "可靠性"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "bb77036f-5e6b-4fbb-aed5-03547cc447e8",
            "service": "AVS",
            "severity": "中等",
            "text": "在 vSan 外部的 Azure 本機組件上部署備份解決方案",
            "waf": "可靠性"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "26028a71-f0f1-4cac-9d9e-f1d5e832d42e",
            "service": "AVS",
            "severity": "低",
            "text": "是否已制定請求還原由 Azure 平臺管理的 VMware 元件的流程？",
            "waf": "可靠性"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "4604489a-8f42-4d78-b78c-b7a33bd2a0a1",
            "service": "AVS",
            "severity": "低",
            "text": "對於手動部署，必須記錄所有配置和部署",
            "waf": "操作"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "7e7a8d90-ae0e-437c-be29-711bd352caaa",
            "service": "AVS",
            "severity": "低",
            "text": "對於手動部署，請考慮實施資源鎖，以防止對 Azure VMware 解決方案私有雲執行意外操作",
            "waf": "操作"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "b79b198d-ab81-4932-a9fc-9d1bb78036f5",
            "service": "AVS",
            "severity": "低",
            "text": "對於自動化部署，請部署最小的私有雲並根據需要進行擴展",
            "waf": "操作"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "e6bfbb9e-d503-4547-ac44-7e826128a71f",
            "service": "AVS",
            "severity": "低",
            "text": "對於自動部署，請在開始部署之前請求或預留配額",
            "waf": "操作"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "0f1cac6d-9ef1-4d5e-a32e-42e3611c818b",
            "service": "AVS",
            "severity": "低",
            "text": "對於自動部署，請確保通過自動化或 Azure Policy 創建相關資源鎖，以便進行適當的治理",
            "waf": "操作"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "e2cc95d4-8c6b-4791-bca0-f6c56589e558",
            "service": "AVS",
            "severity": "低",
            "text": "為 ExR 授權金鑰實現人類可理解的名稱，以便輕鬆識別密鑰的目的/用途",
            "waf": "操作"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "255461e2-aee3-4553-afc8-339248b262d6",
            "service": "AVS",
            "severity": "低",
            "text": "當使用單獨的服務原則部署 Azure VMware 解決方案和 ExpressRoute 時，請使用 Key Vault 儲存機密和授權密鑰",
            "waf": "操作"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "cc5f5129-2539-48e6-bb9d-37dac43bc6cd",
            "service": "AVS",
            "severity": "低",
            "text": "當需要在 Azure VMware 解決方案中/上部署許多資源時，定義用於在 IaC 中序列化操作的資源依賴項，因為 Azure VMware 解決方案僅支援有限數量的並行操作。",
            "waf": "操作"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "1d79a9b2-4604-4489-a8f4-2d78e78cb7a3",
            "service": "AVS",
            "severity": "低",
            "text": "使用單個 Tier-1 閘道執行 NSX-T 分段的自動配置時，請使用 Azure 門戶 API 而不是 NSX-Manager API",
            "waf": "操作"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "3bd2a0a1-7e7a-48d9-8ae0-e37cee29711b",
            "service": "AVS",
            "severity": "中等",
            "text": "打算使用自動橫向擴展時，請務必為運行 Azure VMware 解決方案的訂閱申請足夠的 Azure VMware 解決方案配額",
            "waf": "性能"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "d352caaa-b79b-4198-bab8-1932c9fc9d1b",
            "service": "AVS",
            "severity": "中等",
            "text": "打算使用自動縮減時，請務必在執行此操作之前考慮存儲策略要求",
            "waf": "性能"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "b78036f5-e6bf-4bb9-bd50-3547cc447e82",
            "service": "AVS",
            "severity": "中等",
            "text": "擴展操作始終需要在單個 SDDC 中序列化，因為一次只能執行一個擴展操作（即使使用多個集群也是如此）",
            "waf": "性能"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "bf15bce2-19e4-4a0e-a588-79424d226786",
            "service": "AVS",
            "severity": "中等",
            "text": "考慮並驗證體系結構中使用的第三方解決方案的縮放操作（支援與否）",
            "waf": "性能"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "d20b56c5-7be5-4851-a0f8-3835c586cb29",
            "service": "AVS",
            "severity": "中等",
            "text": "在自動化中為環境定義和強制實施橫向擴展/橫向擴展最大限制",
            "waf": "性能"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "1dc15a1c-075e-4e9f-841a-cccd579376bc",
            "service": "AVS",
            "severity": "中等",
            "text": "實施監控規則以監控自動擴展操作，並監控成功和失敗，以啟用適當的（自動化）回應",
            "waf": "操作"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "c5972cd4-cd21-4b07-9036-f5e6b4bfd3d5",
            "link": "https://learn.microsoft.com/azure/active-directory/app-proxy/application-proxy#how-application-proxy-works",
            "service": "AVS",
            "severity": "高",
            "text": "使用 MON 時，請注意同時配置的 VM 的限制（HCX 的 MON 限制 [400 - 標準，1000 - 大型設備]）",
            "training": "https://learn.microsoft.com/learn/modules/configure-azure-ad-application-proxy/",
            "waf": "可靠性"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "be1f38cf-03a8-422b-b463-cbbbc8ac299e",
            "link": "https://learn.microsoft.com/azure/active-directory/app-proxy/application-proxy#how-application-proxy-works",
            "service": "AVS",
            "severity": "高",
            "text": "使用 MON 時，不能在超過 100 個網路分機上啟用 MON",
            "training": "https://learn.microsoft.com/learn/paths/implement-applications-external-access-azure-ad/",
            "waf": "可靠性"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "bc91a43d-90da-4e2c-a881-4706f7c1cbaf",
            "service": "AVS",
            "severity": "中等",
            "text": "如果使用 VPN 連接進行遷移，請相應地調整 MTU 大小。",
            "waf": "性能"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "e614658d-d457-4e92-9139-b821102cad6e",
            "service": "AVS",
            "severity": "中等",
            "text": "對於連接到 Azure（500Mbps 或更低）的低連接區域，請考慮部署 HCX WAN 優化設備",
            "waf": "性能"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "ae01e6e8-43e5-42f4-922d-928c1b1cd521",
            "service": "AVS",
            "severity": "中等",
            "text": "確保從本地裝置啟動遷移，而不是從雲端裝置啟動遷移（不要執行反向遷移）",
            "waf": "可靠性"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "e54a29a9-de39-4ac0-b7c2-8dc935657202",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-policy-settings",
            "service": "AVS",
            "severity": "中等",
            "text": "使用 Azure Netapp Files 擴展 Azure VMware 解決方案的儲存時，請考慮將其用作 VMware 資料儲存庫，而不是直接附加到 VM 。",
            "waf": "可靠性"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "bff4564b-0d93-44a3-98b2-63e7dd60513a",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#avoid-combining-traffic-manager-and-front-door",
            "service": "AVS",
            "severity": "中等",
            "text": "確保將專用 ExpressRoute 閘道用於外部資料儲存解決方案",
            "waf": "可靠性"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "3649906e-bad3-48ea-b53c-c7de1d8aaab3",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-the-same-domain-name-on-front-door-and-your-origin",
            "service": "AVS",
            "severity": "中等",
            "text": "確保在用於外部數據存儲解決方案的 ExpressRoute 閘道上啟用了 FastPath",
            "waf": "可靠性"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "571549ab-8153-4d89-b89d-c7b33be2b1a2",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#disable-health-probes-when-theres-only-one-origin-in-an-origin-group",
            "service": "AVS",
            "severity": "高",
            "text": "如果使用延伸群集，請確保供應商支援所選的災難恢復解決方案",
            "waf": "可靠性"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "4c486b6d-8bdc-4059-acf7-5ee8a1309888",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#select-good-health-probe-endpoints",
            "service": "AVS",
            "severity": "高",
            "text": "如果使用延伸群集，請確保提供的 SLA 符合您的要求",
            "waf": "可靠性"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "9579d66b-896d-471f-a6ca-7be9955d04c3",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-head-health-probes",
            "service": "AVS",
            "severity": "高",
            "text": "如果使用延伸群集，請確保兩條 ExpressRoute 線路都連接到連接中心。",
            "waf": "可靠性"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "c49d987c-b3d1-4325-aa12-4b6e4d0685ed",
            "link": "https://learn.microsoft.com/azure/nat-gateway/nat-overview#outbound-connectivity",
            "service": "AVS",
            "severity": "高",
            "text": "如果使用延伸群集，請確保兩條 ExpressRoute 線路都啟用了 GlobalReach。",
            "waf": "可靠性"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "dce9793b-7bcd-4b3b-91eb-2ec14eea6e59",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-managed-tls-certificates",
            "service": "AVS",
            "severity": "高",
            "text": "是否正確考慮了網站容災設置，並在需要時為您的業務進行了更改。",
            "waf": "可靠性"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "d7941d4a-7b6f-458f-8714-2f8f8c059ad4",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-error-handling-policies",
            "service": "APIM",
            "severity": "中等",
            "text": "在全域級別實施錯誤處理策略",
            "waf": "操作"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "0b0c0765-ff37-4369-90bd-3eb23ce71b08",
            "link": "https://learn.microsoft.com/azure/api-management/set-edit-policies?tabs=form#use-base-element-to-set-policy-evaluation-order",
            "service": "APIM",
            "severity": "中等",
            "text": "確保所有 API 策略都包含一個<base/>元素。",
            "waf": "操作"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "a5c45b03-93b6-42fe-b16b-8fccb6a79902",
            "link": "https://learn.microsoft.com/azure/api-management/policy-fragments",
            "service": "APIM",
            "severity": "中等",
            "text": "使用策略片段可避免在多個 API 之間重複相同的策略定義",
            "waf": "操作"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "c3818a95-6ff3-4474-88dc-e809b46dad6a",
            "link": "https://learn.microsoft.com/azure/api-management/monetization-support",
            "service": "APIM",
            "severity": "中等",
            "text": "如果您打算通過 API 獲利，請查看「獲利支援」一文，瞭解最佳做法",
            "waf": "操作"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "a7d0840a-c8c4-4e83-adec-5ca578eb4049",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-use-azure-monitor#resource-logs",
            "service": "APIM",
            "severity": "高",
            "text": "啟用診斷設置以將日誌導出到 Azure Monitor",
            "waf": "操作"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "8691fa38-45ed-4299-a247-fecd98d35deb",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-app-insights",
            "service": "APIM",
            "severity": "中等",
            "text": "啟用 Application Insights 以獲取更詳細的遙測Enable Application Insights for more detailed telemetry",
            "waf": "操作"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "55fd27bb-76ac-4a91-bc37-049e885be6b7",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-use-azure-monitor",
            "service": "APIM",
            "severity": "高",
            "text": "針對最關鍵的指標配置警報",
            "waf": "操作"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "39460bdb-156f-4dc2-a87f-1e8c11ab0998",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/api-management-security-baseline?toc=%2Fazure%2Fapi-management%2F&bc=%2Fazure%2Fapi-management%2Fbreadcrumb%2Ftoc.json#certificate-management-in-azure-key-vault",
            "service": "APIM",
            "severity": "高",
            "text": "確保自定義 SSL 證書儲存在 Azure Key Vault 中，以便可以安全地訪問和更新它們",
            "waf": "安全"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "e9217997-5f6c-479d-8576-8f2adf706ec8",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/api-management-security-baseline?toc=%2Fazure%2Fapi-management%2F&bc=%2Fazure%2Fapi-management%2Fbreadcrumb%2Ftoc.json#azure-ad-authentication-required-for-data-plane-access",
            "service": "APIM",
            "severity": "高",
            "text": "使用 Azure AD 保護對 API（數據平面）的傳入請求",
            "waf": "安全"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "5e5f64ba-c90e-480e-8888-398d96cf0bfb",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-aad",
            "service": "APIM",
            "severity": "中等",
            "text": "使用 Azure AD 在開發人員門戶中對用戶進行身份驗證",
            "waf": "安全"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "f8e574ce-280f-49c8-b2ef-68279b081cf3",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-create-groups",
            "service": "APIM",
            "severity": "中等",
            "text": "創建適當的組來控制產品的可見性",
            "waf": "安全"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "06862505-2d9a-4874-9491-2837b00a3475",
            "link": "https://learn.microsoft.com/azure/api-management/backends",
            "service": "APIM",
            "severity": "中等",
            "text": "使用後端功能消除冗餘的 API 後端配置",
            "waf": "操作"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "03b125d5-b69b-4739-b7fd-84b86da4933e",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-properties?tabs=azure-portal",
            "service": "APIM",
            "severity": "中等",
            "text": "使用命名值存儲可在策略中使用的通用值",
            "waf": "操作"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "beae759e-4ddb-4326-bf26-47f87d3454b6",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-deploy-multi-region",
            "service": "APIM",
            "severity": "中等",
            "text": "部署到多個 Azure 區域",
            "waf": "可靠性"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "9c8d1664-dd9a-49d4-bd83-950af0af4044",
            "link": "https://learn.microsoft.com/azure/api-management/high-availability",
            "service": "APIM",
            "severity": "中等",
            "text": "在每個區域的兩個可用性區域中部署至少兩個縮放單元，以實現最佳可用性和性能",
            "waf": "可靠性"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "8d2db6e8-85c6-4118-a52c-ae76a4f27934",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/api-management-security-baseline?toc=%2Fazure%2Fapi-management%2F&bc=%2Fazure%2Fapi-management%2Fbreadcrumb%2Ftoc.json#service-native-backup-capability",
            "service": "APIM",
            "severity": "高",
            "text": "確保有自動備份例程",
            "waf": "可靠性"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "8210699f-8d43-45c2-8f19-57e54134bd8f",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-log-event-hubs",
            "service": "APIM",
            "severity": "低",
            "text": "如果需要以高性能級別登錄，請考慮事件中心策略",
            "waf": "操作"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "121bfc39-fa7b-4096-b93b-ab56c1bc0bed",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-sample-flexible-throttling",
            "service": "APIM",
            "severity": "中等",
            "text": "應用限制策略以控制每秒的請求數",
            "training": "https://learn.microsoft.com/training/modules/protect-apis-on-api-management/",
            "waf": "性能"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "bb5f356b-3daf-47a2-a9ee-867a8100bbd5",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-autoscale",
            "service": "APIM",
            "severity": "中等",
            "text": "配置自動縮放以在負載增加時橫向擴展實例數",
            "waf": "性能"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "84b94abb-59b6-4b9d-8587-3413669468e8",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-provision-self-hosted-gateway",
            "service": "APIM",
            "severity": "中等",
            "text": "在 Azure 沒有靠近後端 API 的區域的地方部署自承載閘道。",
            "waf": "性能"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "7519e385-a88b-4d34-966b-6269d686e890",
            "link": "https://learn.microsoft.com/azure/api-management/front-door-api-management",
            "service": "APIM",
            "severity": "中等",
            "text": "在APIM前面使用 Azure Front Door 進行多區域部署",
            "waf": "性能"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "cd45c90e-7690-4753-930b-bf290c69c074",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/api-management-security-baseline?toc=%2Fazure%2Fapi-management%2F&bc=%2Fazure%2Fapi-management%2Fbreadcrumb%2Ftoc.json#virtual-network-integration",
            "service": "APIM",
            "severity": "中等",
            "text": "在虛擬網络 （VNet） 中部署服務Deploy the service within a Virtual Network （VNet）",
            "waf": "安全"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "02661582-b3d1-48d1-9d7b-c6a918a0ca33",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/api-management-security-baseline?toc=%2Fazure%2Fapi-management%2F&bc=%2Fazure%2Fapi-management%2Fbreadcrumb%2Ftoc.json#network-security-group-support",
            "service": "APIM",
            "severity": "中等",
            "text": "將網路安全組 （NSG） 部署到子網，以限制或監視傳入/傳出APIM的流量。",
            "waf": "安全"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "67437a28-2721-4a2c-becd-caa54c8237a5",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/api-management-security-baseline?toc=%2Fazure%2Fapi-management%2F&bc=%2Fazure%2Fapi-management%2Fbreadcrumb%2Ftoc.json#azure-private-link",
            "service": "APIM",
            "severity": "中等",
            "text": "部署專用終結點以在 APIM 未部署到 VNet 時篩選傳入流量。",
            "waf": "安全"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "d698adbd-3288-44cb-b10a-9b572da395ae",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/api-management-security-baseline?toc=%2Fazure%2Fapi-management%2F&bc=%2Fazure%2Fapi-management%2Fbreadcrumb%2Ftoc.json#disable-public-network-access",
            "service": "APIM",
            "severity": "高",
            "text": "禁用公網訪問",
            "waf": "安全"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "0674d750-0c6f-4ac0-8717-ceec04d0bdbd",
            "link": "https://learn.microsoft.com/azure/api-management/automation-manage-api-management",
            "service": "APIM",
            "severity": "中等",
            "text": "使用 PowerShell 自動化腳本簡化管理",
            "waf": "操作"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "c385bfcd-49fd-4786-81ba-cedbb4c57345",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/app-platform/api-management/platform-automation-and-devops#design-recommendations",
            "service": "APIM",
            "severity": "中等",
            "text": "查看 Cloud Adaption Framework APIM 登陸區域加速器中的 DevOps 最佳實踐",
            "waf": "操作"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "6c3a27c0-197f-426c-9ffa-86fed51d9ab6",
            "link": "https://learn.microsoft.com/azure/api-management/visual-studio-code-tutorial",
            "service": "APIM",
            "severity": "中等",
            "text": "促進 Visual Studio Code APIM 擴展的使用，以加快 API 開發速度",
            "waf": "操作"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "354f1c03-8112-4965-85ad-c0074bddf231",
            "link": "https://learn.microsoft.com/azure/api-management/devops-api-development-templates",
            "service": "APIM",
            "severity": "中等",
            "text": "在工作流中實施DevOps和 CI/CD",
            "waf": "操作"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "b6439493-426a-45f3-9697-cf65baee208d",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-mutual-certificates-for-clients",
            "service": "APIM",
            "severity": "中等",
            "text": "使用用戶端證書身份驗證保護 API",
            "waf": "安全"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "2a67d143-1033-4c0a-8732-680896478f08",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-mutual-certificates",
            "service": "APIM",
            "severity": "中等",
            "text": "使用用戶端證書身份驗證保護後端服務",
            "waf": "安全"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "074435f5-4a46-41ac-b521-d6114cb5d845",
            "link": "https://learn.microsoft.com/azure/api-management/mitigate-owasp-api-threats",
            "service": "APIM",
            "severity": "中等",
            "text": "查看“緩解 OWASP API 安全 10 大威脅的建議”一文，並檢查適用於您的 API 的內容",
            "waf": "安全"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "5507c4b8-a7f8-41d6-9661-418c987100c9",
            "link": "https://learn.microsoft.com/azure/api-management/authorizations-overview",
            "service": "APIM",
            "severity": "中等",
            "text": "使用授權功能簡化後端 API 的 OAuth 2.0 令牌管理",
            "waf": "安全"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "2deee033-b906-4bc2-9f26-c8d3699fe091",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-manage-protocols-ciphers",
            "service": "APIM",
            "severity": "高",
            "text": "加密傳輸中的資訊時，請使用最新的 TLS 版本。盡可能禁用過時和不必要的協議和密碼。",
            "waf": "安全"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "f8af3d94-1d2b-4070-846f-849197524258",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/api-management-security-baseline?toc=%2Fazure%2Fapi-management%2F&bc=%2Fazure%2Fapi-management%2Fbreadcrumb%2Ftoc.json#im-8-restrict-the-exposure-of-credential-and-secrets",
            "service": "APIM",
            "severity": "高",
            "text": "確保機密（命名值）存儲在 Azure Key Vault 中，以便可以安全地訪問和更新它們",
            "waf": "安全"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "791abd8b-7706-4e31-9569-afefde724be3",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/api-management-security-baseline?toc=%2Fazure%2Fapi-management%2F&bc=%2Fazure%2Fapi-management%2Fbreadcrumb%2Ftoc.json#managed-identities",
            "service": "APIM",
            "severity": "中等",
            "text": "盡可能使用託管標識向其他 Azure 資源進行身份驗證",
            "waf": "安全"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "220c4ca6-6688-476b-b2b5-425a78e6fb87",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/api-management-security-baseline?toc=%2Fazure%2Fapi-management%2F&bc=%2Fazure%2Fapi-management%2Fbreadcrumb%2Ftoc.json#ns-6-deploy-web-application-firewall",
            "service": "APIM",
            "severity": "高",
            "text": "使用 APIM 前面部署應用程式閘道來使用 Web 應用程式防火牆 （WAF）",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "70c15989-c726-42c7-b0d3-24b7375b9201",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/multi-tenant/considerations-recommendations",
            "service": "Entra",
            "severity": "中等",
            "text": "使用一個 Entra 租戶來管理 Azure 資源，除非你對多租戶有明確的法規或業務要求。",
            "waf": "操作"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "6309957b-821a-43d1-b9d9-7fcf1802b747",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/multi-tenant/automation",
            "service": "Entra",
            "severity": "低",
            "text": "確保採用多租戶自動化方法來管理 Microsoft Entra ID 租戶",
            "waf": "操作"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "78e11934-499a-45ed-8ef7-aae5578f0ecf",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/multi-tenant/lighthouse",
            "service": "Entra",
            "severity": "低",
            "text": "利用 Azure Lighthouse 進行多租戶管理",
            "waf": "操作"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "5d82e6df-6f61-42f2-82e2-3132d293be3d",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-microsoft-customer-agreement#design-recommendations",
            "service": "Entra",
            "severity": "中等",
            "text": "確保 Azure Lighthouse 用於按合作夥伴管理租戶",
            "waf": "成本"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "984a859c-773e-47d2-9162-3a765a917e1f",
            "link": "https://learn.microsoft.com/azure/active-directory/roles/security-emergency-access",
            "service": "Entra",
            "severity": "高",
            "text": "實施緊急訪問或打破玻璃帳戶，以防止租戶範圍的帳戶鎖定",
            "training": "https://learn.microsoft.com/learn/modules/azure-ad-privileged-identity-management/",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "1cf0b8da-70bd-44d0-94af-8d99cfc89ae1",
            "link": "https://learn.microsoft.com/azure/active-directory/reports-monitoring/concept-activity-logs-azure-monitor",
            "service": "Entra",
            "severity": "中等",
            "text": "將 Microsoft Entra ID 紀錄與平臺中心的 Azure 監視器整合。Azure Monitor 允許圍繞 Azure 中的日誌和監視數據提供單一事實來源，為組織提供雲原生選項，以滿足日誌收集和保留方面的要求。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "348ef254-c27d-442e-abba-c7571559ab91",
            "link": "https://learn.microsoft.com/azure/role-based-access-control/overview",
            "service": "Entra",
            "severity": "高",
            "text": "強制實施與雲操作模型一致的 RBAC 模型。跨管理組和訂閱確定範圍和分配範圍。",
            "training": "https://learn.microsoft.com/learn/paths/implement-resource-mgmt-security/",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "53e8908a-e28c-484c-93b6-b7808b9fe5c4",
            "link": "https://learn.microsoft.com/azure/active-directory/conditional-access/overview",
            "service": "Entra",
            "severity": "低",
            "text": "對具有 Azure 環境許可權的任何使用者強制實施 Microsoft Entra ID 條件訪問策略",
            "training": "https://learn.microsoft.com/learn/modules/plan-implement-administer-conditional-access/",
            "waf": "安全"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "1049d403-a923-4c34-94d0-0018ac6a9e01",
            "link": "https://learn.microsoft.com/azure/active-directory/authentication/concept-mfa-howitworks",
            "service": "Entra",
            "severity": "高",
            "text": "對有權訪問 Azure 環境的任何使用者強制實施多重身份驗證",
            "training": "https://learn.microsoft.com/learn/modules/secure-aad-users-with-mfa/",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "14658d35-58fd-4772-99b8-21112df27ee4",
            "link": "https://learn.microsoft.com/azure/active-directory/privileged-identity-management/pim-configure",
            "service": "Entra",
            "severity": "中等",
            "text": "強制實施 Microsoft Entra ID 特權標識管理 （PIM） 以建立零長期訪問許可權和最低特權",
            "training": "https://learn.microsoft.com/learn/modules/azure-ad-privileged-identity-management/",
            "waf": "安全"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "12e7f983-f630-4472-8dd6-9c5b5c2622f5",
            "link": "https://learn.microsoft.com/azure/active-directory/roles/security-planning#identify-microsoft-accounts-in-administrative-roles-that-need-to-be-switched-to-work-or-school-accounts",
            "service": "Entra",
            "severity": "高",
            "text": "僅對所有帳戶類型使用身份驗證類型「工作或學校帳戶」。避免使用 Microsoft 帳戶",
            "training": "https://learn.microsoft.com/learn/modules/explore-basic-services-identity-types/",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "4b69bad3-3aad-45e8-a68e-1d76667313b4",
            "link": "https://learn.microsoft.com/azure/active-directory/fundamentals/active-directory-groups-create-azure-portal",
            "service": "Entra",
            "severity": "中等",
            "text": "僅使用組來分配許可權。如果組管理系統已到位，請將本地組添加到僅限 Azure-AD 的組。",
            "training": "https://learn.microsoft.com/learn/paths/manage-identity-and-access/",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "8b9fe5c4-1049-4d40-9a92-3c3474d00018",
            "link": "https://learn.microsoft.com/azure/active-directory-domain-services/overview",
            "service": "Entra",
            "severity": "中等",
            "text": "如果正在使用 Entra 域服務，請評估所有工作負載的相容性",
            "training": "https://learn.microsoft.com/learn/modules/implement-hybrid-identity-windows-server/",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "d5d1e4e6-1465-48d3-958f-d77249b82111",
            "link": "https://learn.microsoft.com/azure/active-directory/app-proxy/application-proxy",
            "service": "Entra",
            "severity": "中等",
            "text": "如果需要，請使用 Microsoft Entra ID 應用程式代理為遠端使用者提供對內部應用程式（託管在雲中或本地）的安全且經過身份驗證的訪問。",
            "training": "https://learn.microsoft.com/learn/paths/implement-applications-external-access-azure-ad/",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "35037e68-9349-4c15-b371-228514f4cdff",
            "link": "https://learn.microsoft.com/azure/active-directory/roles/best-practices",
            "service": "Entra",
            "severity": "中等",
            "text": "避免將本地同步帳戶用於 Microsoft Entra ID 角色分配。",
            "training": "https://learn.microsoft.com/learn/modules/design-identity-security-strategy/",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "143b16c3-1d7a-4a9b-9470-4489a8042d88",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "service": "VNet",
            "severity": "中等",
            "text": "對應用程式登陸區域中的所有公共IP位址使用 DDoS 網路或IP保護計畫。",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "guid": "de0d5973-cd4c-4d21-a088-137f5e6c4cfd",
            "link": "https://learn.microsoft.com/azure/virtual-network/network-security-group-how-it-works",
            "service": "ExpressRoute",
            "severity": "中等",
            "text": "使用 ExpressRoute Direct 時，請配置 MACsec，以便在組織路由器和 MSEE 之間的第二層級別加密流量。該圖顯示了流中的這種加密。",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "guid": "ed301d6e-872e-452e-9611-cc58b5a4b151",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-erdirect-about",
            "service": "ExpressRoute",
            "severity": "低",
            "text": "對於無法使用MACsec的方案（例如，不使用ExpressRoute Direct），請使用 VPN 閘道通過 ExpressRoute 專用對等互連建立 IPsec 隧道。",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "e8bbac75-7155-49ab-a153-e8908ae28c84",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/enterprise-scale/network-topology-and-connectivity",
            "service": "VNet",
            "severity": "中等",
            "text": "利用基於傳統中心輻射型網路拓撲的網路設計，實現需要最大靈活性的網路方案。",
            "training": "https://learn.microsoft.com/learn/paths/architect-network-infrastructure/",
            "waf": "安全"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "7dd61623-a364-4a90-9eca-e48ebd54cd7d",
            "link": "https://learn.microsoft.com/azure/architecture/reference-architectures/hybrid-networking/expressroute",
            "service": "VNet",
            "severity": "高",
            "text": "確保共用網路服務，包括 ExpressRoute 閘道、VPN 閘道和 Azure 防火牆或中心虛擬網路中的合作夥伴 NVA。如有必要，還可以部署 DNS 伺服器。",
            "waf": "成本"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "e2e8abac-3571-4559-ab91-53e89f89dc7b",
            "link": "https://learn.microsoft.com/azure/architecture/reference-architectures/dmz/nva-ha",
            "service": "NVA",
            "severity": "中等",
            "text": "部署合作夥伴網路技術或 NVA 時，請遵循合作夥伴供應商的指導",
            "waf": "可靠性"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "guid": "ce463dbb-bc8a-4c2a-aebc-92a43da1dae2",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-howto-coexist-resource-manager#to-enable-transit-routing-between-expressroute-and-azure-vpn",
            "service": "ExpressRoute",
            "severity": "低",
            "text": "如果需要在中心輻射型方案中的 ExpressRoute 和 VPN 閘道之間傳輸，請使用 Azure 路由伺服器。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,subnets=properties.subnets | mv-expand subnets | project id, subnetName = subnets.name, subnetPrefix = subnets.properties.addressPrefix | extend subnetPrefixLength = split(subnetPrefix, '/')[1] | where subnetName == 'RouteServerSubnet' | extend compliant = (subnetPrefixLength <= 27) | distinct id, compliant",
            "guid": "91b9d7d5-91e1-4dcb-8f1f-fa7e465646cc",
            "link": "https://learn.microsoft.com/azure/route-server/quickstart-configure-route-server-portal#create-a-route-server-1",
            "service": "ARS",
            "severity": "低",
            "text": "如果使用路由伺服器，請對路由伺服器子網使用 /27 前置綴。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "cc881471-607c-41cc-a0e6-14658dd558f9",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-networks-faq#can-i-create-a-peering-connection-to-a-vnet-in-a-different-region",
            "service": "VNet",
            "severity": "中等",
            "text": "對於跨 Azure 區域具有多個中心輻射型拓撲的網路體系結構，請在中心 VNet 之間使用全域虛擬網路對等互連將區域相互連接。",
            "training": "https://learn.microsoft.com/learn/paths/azure-administrator-manage-virtual-networks/",
            "waf": "性能"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "4722d929-c1b1-4cd6-81f5-4b29bade39ad",
            "link": "https://learn.microsoft.com/azure/azure-monitor/insights/network-insights-overview",
            "service": "VNet",
            "severity": "中等",
            "text": "使用用於網路的 Azure Monitor 監視 Azure 上網路的端到端狀態。",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-network-monitoring/",
            "waf": "操作"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type == 'microsoft.network/virtualnetworks' | mvexpand properties.virtualNetworkPeerings | summarize peeringcount = count() by id | extend compliant = (peeringcount < 450) | distinct id,compliant",
            "guid": "0e7c28ec-9366-4572-83b0-f4664b1d944a",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits?toc=/azure/virtual-network/toc.json#azure-resource-manager-virtual-networking-limits",
            "service": "VNet",
            "severity": "中等",
            "text": "將分支虛擬網路連接到中心虛擬網路時，請考慮 VNet 對等互連限制 （500），即可通過 ExpressRoute 播發的最大前綴數 （1000）",
            "waf": "可靠性"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/routetables' | mvexpand properties.routes | summarize routeCount = count() by id | extend compliant = (routeCount < 360) | distinct id,compliant",
            "guid": "3d457936-e9b7-41eb-bdff-314b26450b12",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits?toc=/azure/virtual-network/toc.json#azure-resource-manager-virtual-networking-limits",
            "service": "VNet",
            "severity": "中等",
            "text": "考慮每個路由表的路由限制 （400）。",
            "waf": "可靠性"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type == 'microsoft.network/virtualnetworks' | mvexpand properties.virtualNetworkPeerings | project id, peeringName=properties_virtualNetworkPeerings.name, compliant = (properties_virtualNetworkPeerings.properties.allowVirtualNetworkAccess == True)",
            "guid": "c76cb5a2-abe2-11ed-afa1-0242ac120002",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-network-manage-peering",
            "service": "VNet",
            "severity": "高",
            "text": "配置 VNet 對等互連時，使用「允許流量流向遠端虛擬網路」設置",
            "waf": "可靠性"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "guid": "359c373e-7dd6-4162-9a36-4a907ecae48e",
            "link": "https://learn.microsoft.com/azure/architecture/reference-architectures/hybrid-networking/hub-spoke?tabs=cli",
            "service": "ExpressRoute",
            "severity": "中等",
            "text": "確保已調查使用 ExpressRoute 作為與 Azure 的主要連接的可能性。",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "性能"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "description": "可以使用 AS 路徑預置和連接權重來影響從 Azure 到本地的流量，並使用自己的路由器中的全部 BGP 屬性來影響從本地到 Azure 的流量。",
            "guid": "f29812b2-363c-4efe-879b-599de0d5973c",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-routing",
            "service": "ExpressRoute",
            "severity": "中等",
            "text": "使用多條 ExpressRoute 線路或多個本地位置時，請確保使用 BGP 屬性優化路由（如果首選某些路徑）。",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "可靠性"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources| where type == 'microsoft.network/virtualnetworkgateways'| where properties.gatewayType =~ 'vpn' or properties.gatewayType == 'ExpressRoute'| extend SKUName = properties.sku.name, SKUTier = properties.sku.tier, Type = properties.gatewayType| extend compliant = SKUTier !in ('Basic', 'Standard')| project name, id, subscriptionId, resourceGroup, compliant",
            "guid": "d4cd21b0-8813-47f5-b6c4-cfd3e504547c",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-routing",
            "service": "ExpressRoute",
            "severity": "中等",
            "text": "確保根據頻寬和性能要求為 ExpressRoute/VPN 閘道使用正確的 SKU。",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "性能"
        },
        {
            "ammp": true,
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/expressroutecircuits' | extend compliant = (tolower(sku.family) == 'metereddata' or tolower(sku.tier) == 'local') | distinct id,compliant",
            "guid": "7025b442-f6e9-4af6-b11f-c9574916016f",
            "link": "https://learn.microsoft.com/azure/expressroute/plan-manage-cost",
            "service": "ExpressRoute",
            "severity": "高",
            "text": "確保僅在達到證明其成本合理的頻寬時才使用無限數據 ExpressRoute 線路。",
            "waf": "成本"
        },
        {
            "ammp": true,
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/connections' | where properties.connectionType == 'ExpressRoute' | project id, gwid=tostring(properties.virtualNetworkGateway1.id), circuitid=tostring(properties.peer.id) | join (resources | where type=='microsoft.network/expressroutecircuits' | project circuitid=tostring(id), circuitsku=sku.tier) on circuitid | project id=gwid, compliant = (circuitsku == 'Local') | summarize compliant=max(compliant) by id",
            "guid": "f4e7926a-ec35-476e-a412-5dd17136bd62",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-faqs#expressroute-local",
            "service": "ExpressRoute",
            "severity": "高",
            "text": "如果線路的對等互連位置支援本地 SKU 的 Azure 區域，則利用 ExpressRoute 的本地 SKU 來降低線路成本。",
            "waf": "成本"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources| where type == 'microsoft.network/virtualnetworkgateways'| where properties.gatewayType =~ 'vpn' or properties.gatewayType == 'ExpressRoute'| extend SKUName = properties.sku.name, SKUTier = properties.sku.tier, Type = properties.gatewayType| extend compliant = SKUTier contains 'AZ'| project name, id, subscriptionId, resourceGroup, Type, compliant",
            "guid": "2447ec66-138a-4720-8f1c-e16ed301d6e8",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-about-virtual-network-gateways",
            "service": "ExpressRoute",
            "severity": "中等",
            "text": "在受支援的 Azure 區域中部署區域冗餘 ExpressRoute 閘道。",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "可靠性"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "guid": "72e52e36-11cc-458b-9a4b-1511e43a58a9",
            "link": "https://learn.microsoft.com/azure/networking/",
            "service": "ExpressRoute",
            "severity": "中等",
            "text": "對於需要頻寬高於 10 Gbps 或專用 10/100 Gbps 埠的方案，請使用 ExpressRoute Direct。",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "性能"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "guid": "c2299c4d-7b57-4d0c-9555-62f2b3e4563a",
            "link": "https://learn.microsoft.com/azure/expressroute/about-fastpath",
            "service": "ExpressRoute",
            "severity": "中等",
            "text": "如果需要低延遲，或者從本地到 Azure 的輸送量必須大於 10 Gbps，請啟用 FastPath 以從數據路徑繞過 ExpressRoute 閘道。",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "性能"
        },
        {
            "arm-service": "microsoft.network/vpnGateways",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/virtualnetworkgateways' | where properties.gatewayType == 'Vpn' | extend compliant = (tolower(properties.sku.name) contains 'az') | distinct id, compliant",
            "guid": "4d873974-8b66-42d6-b15f-512a65498f6d",
            "link": "https://learn.microsoft.com/azure/vpn-gateway/create-zone-redundant-vnet-gateway",
            "service": "VPN",
            "severity": "中等",
            "text": "使用區域冗餘 VPN 閘道將分支或遠端位置連接到 Azure（如果可用）。",
            "training": "https://learn.microsoft.com/training/modules/intro-to-azure-vpn-gateway/",
            "waf": "可靠性"
        },
        {
            "arm-service": "microsoft.network/vpnGateways",
            "checklist": "Azure Landing Zone Review",
            "guid": "45866df8-cf85-4ca9-bbe2-65ec1478919e",
            "link": "https://learn.microsoft.com/azure/vpn-gateway/vpn-gateway-highlyavailable",
            "service": "VPN",
            "severity": "中等",
            "text": "在本地使用冗餘 VPN 設備（主動/主動或主動/被動）。",
            "training": "https://learn.microsoft.com/training/modules/intro-to-azure-vpn-gateway/",
            "waf": "可靠性"
        },
        {
            "ammp": true,
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "guid": "718cb437-b060-2589-8856-2e93a5c6633b",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-erdirect-about",
            "service": "ExpressRoute",
            "severity": "高",
            "text": "如果使用 ExpressRoute Direct，請考慮使用到本地 Azure 區域的 ExpressRoute 本地線路以節省成本",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "成本"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "guid": "8042d88e-79d1-47b7-9b22-a5a67e7a8ed4",
            "link": "https://learn.microsoft.com/azure/architecture/framework/services/networking/expressroute/reliability",
            "service": "ExpressRoute",
            "severity": "中等",
            "text": "當需要流量隔離或專用頻寬時，例如用於分離生產環境和非生產環境，請使用不同的 ExpressRoute 線路。它將幫助您確保隔離的路由域並減輕嘈雜的鄰居風險。",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "guid": "b30e38c3-f298-412b-8363-cefe179b599d",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-monitoring-metrics-alerts",
            "service": "ExpressRoute",
            "severity": "中等",
            "text": "使用內置的 Express Route 見解監視 ExpressRoute 可用性和利用率。",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "操作"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "guid": "5bf68dc9-325e-4873-bf88-f8214ef2e5d2",
            "link": "https://learn.microsoft.com/azure/expressroute/how-to-configure-connection-monitor",
            "service": "ExpressRoute",
            "severity": "中等",
            "text": "使用連接監視器監視整個網路的連接，尤其是本地和 Azure 之間的連接。",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "操作"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "guid": "e0d5973c-d4cd-421b-8881-37f5e6c4cfd3",
            "link": "https://learn.microsoft.com/azure/expressroute/designing-for-disaster-recovery-with-expressroute-privatepeering#challenges-of-using-multiple-expressroute-circuits",
            "service": "ExpressRoute",
            "severity": "中等",
            "text": "使用來自不同對等互連位置的 ExpressRoute 線路來實現冗餘。",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "可靠性"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "guid": "cf3fe65c-fec0-495a-8edc-9675200f2add",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-howto-coexist-resource-manager",
            "service": "ExpressRoute",
            "severity": "中等",
            "text": "使用網站到網站 VPN 作為 ExpressRoute 的故障轉移，尤其是在僅使用單個 ExpressRoute 線路時。",
            "waf": "可靠性"
        },
        {
            "ammp": true,
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,resourceGroup,name,subnets=properties.subnets | mv-expand subnets | project id,resourceGroup,name,subnetName=tostring(subnets.name),routeTableId=tostring(subnets.properties.routeTable.id) | where subnetName == 'GatewaySubnet' | join kind=leftouter (Resources | where type == 'microsoft.network/routetables' | project routeTableName=name,routeTableId=id, disableBgpRoutePropagation=properties.disableBgpRoutePropagation) on routeTableId | project id,compliant = (disableBgpRoutePropagation == False or isnull(disableBgpRoutePropagation))",
            "guid": "72105cc8-aaea-4ee1-8c7a-ad25977afcaf",
            "link": "https://learn.microsoft.com/azure/vpn-gateway/vpn-gateway-about-vpn-gateway-settings#gwsub",
            "service": "ExpressRoute",
            "severity": "高",
            "text": "如果在 GatewaySubnet 中使用路由表，請確保傳播閘道路由。",
            "waf": "可靠性"
        },
        {
            "ammp": true,
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "guid": "d581a947-69a2-4783-942e-9df3664324c8",
            "link": "https://learn.microsoft.com/azure/expressroute/designing-for-high-availability-with-expressroute#active-active-connections",
            "service": "ExpressRoute",
            "severity": "高",
            "text": "如果使用 ExpressRoute，則本地路由應是動態的：如果連接失敗，它應收斂到線路的剩餘連接。負載應在兩個連接之間共用，理想情況下應作為主動/主動共用，儘管也支持主動/被動。",
            "waf": "可靠性"
        },
        {
            "ammp": true,
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "guid": "558fd772-49b8-4211-82df-27ee412e7f98",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-ip-addressing",
            "service": "ExpressRoute",
            "severity": "高",
            "text": "確保 Azure 區域和本地位置之間不使用重疊的 IP 位址空間",
            "training": "https://learn.microsoft.com/learn/paths/architect-network-infrastructure/",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type == 'microsoft.network/virtualnetworks' | extend addressSpace = todynamic(properties.addressSpace) | extend addressPrefix = todynamic(properties.addressSpace.addressPrefixes) | mvexpand addressSpace | mvexpand addressPrefix | project name, id, location, resourceGroup, subscriptionId, cidr = addressPrefix | extend compliant = (cidr matches regex @'^(10\\\\.|172\\\\.(1[6-9]|2[0-9]|3[01])\\\\.|192\\\\.168\\\\.)')  | project id, compliant, cidr",
            "guid": "3f630472-2dd6-49c5-a5c2-622f54b69bad",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-ip-addressing",
            "service": "VNet",
            "severity": "低",
            "text": "使用專用 Internet 位址分配範圍中的 IP 位址 （RFC 1918）。",
            "training": "https://learn.microsoft.com/learn/paths/architect-network-infrastructure/",
            "waf": "安全"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type == 'microsoft.network/virtualnetworks' | extend addressSpace = todynamic(properties.addressSpace) | extend addressPrefix = todynamic(properties.addressSpace.addressPrefixes) | mvexpand addressSpace | mvexpand addressPrefix | extend addressMask = split(addressPrefix,'/')[1] | extend compliant = addressMask > 16 | project name, id, subscriptionId, resourceGroup, addressPrefix, compliant",
            "guid": "33aad5e8-c68e-41d7-9667-313b4f5664b5",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-ip-addressing",
            "service": "VNet",
            "severity": "高",
            "text": "確保不會浪費 IP 位址空間，不要建立不必要的大型虛擬網路（例如 /16）",
            "training": "https://learn.microsoft.com/learn/paths/architect-network-infrastructure/",
            "waf": "性能"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "f348ef25-4c27-4d42-b8bb-ac7571559ab9",
            "link": "https://learn.microsoft.com/azure/site-recovery/concepts-on-premises-to-azure-networking#retain-ip-addresses",
            "service": "VNet",
            "severity": "高",
            "text": "避免對生產網站和DR網站使用重疊的IP位址範圍。",
            "training": "https://learn.microsoft.com/learn/paths/az-104-manage-virtual-networks/",
            "waf": "可靠性"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "153e8908-ae28-4c84-a33b-6b7808b9fe5c",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-networks-name-resolution-for-vms-and-role-instances",
            "service": "DNS",
            "severity": "中等",
            "text": "對於只需要在 Azure 中進行名稱解析的環境，請使用 Azure 專用 DNS 進行解析，並使用委託區域進行名稱解析（例如“azure.contoso.com”）。",
            "training": "https://learn.microsoft.com/learn/paths/az-104-manage-virtual-networks/",
            "waf": "操作"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "41049d40-3a92-43c3-974d-00018ac6a9e0",
            "link": "https://learn.microsoft.com/azure/dns/dns-private-resolver-overview",
            "service": "DNS",
            "severity": "中等",
            "text": "對於需要跨 Azure 和本地進行名稱解析的環境，請考慮使用 Azure DNS 專用解析程式。",
            "training": "https://learn.microsoft.com/training/modules/intro-to-azure-dns-private-resolver/",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "1e6a83de-5de3-42c1-a924-81607d5d1e4e",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-networks-name-resolution-for-vms-and-role-instances",
            "service": "DNS",
            "severity": "低",
            "text": "需要並部署自己的 DNS（例如 Red Hat OpenShift）的特殊工作負載應使用其首選的 DNS 解決方案。",
            "waf": "操作"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "614658d3-558f-4d77-849b-821112df27ee",
            "link": "https://learn.microsoft.com/azure/dns/private-dns-autoregistration",
            "service": "DNS",
            "severity": "高",
            "text": "啟用 Azure DNS 的自動註冊，以自動管理虛擬網路中部署的虛擬機的 DNS 記錄的生命週期。",
            "training": "https://learn.microsoft.com/learn/paths/az-104-manage-virtual-networks/",
            "waf": "操作"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "ee1ac551-c4d5-46cf-b035-d0a3c50d87ad",
            "link": "https://learn.microsoft.com/azure/bastion/bastion-overview",
            "service": "Bastion",
            "severity": "中等",
            "text": "請考慮使用 Azure Bastion 安全地連接到網路。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,subnets=properties.subnets | mv-expand subnets | project id, subnetName = subnets.name, subnetPrefix = subnets.properties.addressPrefix | extend subnetPrefixLength = split(subnetPrefix, '/')[1] | where subnetName == 'AzureBastionSubnet' | extend compliant = (subnetPrefixLength <= 26) | distinct id, compliant",
            "guid": "6eab9eb6-762b-485e-8ea8-15aa5dba0bd0",
            "link": "https://learn.microsoft.com/azure/bastion/bastion-faq#subnet",
            "service": "Bastion",
            "severity": "中等",
            "text": "在子網 /26 或更大的情況下使用 Azure Bastion。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "e6c4cfd3-e504-4547-a244-7ec66138a720",
            "link": "https://learn.microsoft.com/azure/app-service/networking-features",
            "service": "Firewall",
            "severity": "高",
            "text": "使用 Azure 防火牆管理發往 Internet、非 HTTP/S 入站連接和東西方流量篩選的 Azure 出站流量（如果組織需要）",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "5a4b1511-e43a-458a-ac22-99c4d7b57d0c",
            "link": "https://learn.microsoft.com/azure/firewall/",
            "service": "Firewall",
            "severity": "中等",
            "text": "創建全域 Azure 防火牆策略來管理全球網路環境中的安全狀況，並將其分配給所有 Azure 防火牆實例。通過 Azure 基於角色的訪問控制將增量防火牆策略委派給本地安全團隊，從而允許精細策略來滿足特定區域的要求。",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "655562f2-b3e4-4563-a4d8-739748b662d6",
            "link": "https://learn.microsoft.com/azure/firewall/",
            "service": "Firewall",
            "severity": "低",
            "text": "如果組織希望使用此類解決方案來幫助保護出站連接，請在 Firewall Manager 中配置受支援的合作夥伴 SaaS 安全提供者。",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "1d7aa9b6-4704-4489-a804-2d88e79d17b7",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/afds-overview",
            "service": "WAF",
            "severity": "中等",
            "text": "使用 Azure Front Door 和 WAF 策略跨 Azure 區域為登陸區域的入站 HTTP/S 連接提供全域保護。",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "3b22a5a6-7e7a-48ed-9b30-e38c3f29812b",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "service": "WAF",
            "severity": "低",
            "text": "使用 Azure Front Door 和 Azure 應用程式閘道幫助保護 HTTP/S 應用時，請在 Azure Front Door 中使用 WAF 策略。鎖定 Azure 應用程式閘道，以便僅接收來自 Azure Front Door 的流量。",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "安全"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "2363cefe-179b-4599-be0d-5973cd4cd21b",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "service": "WAF",
            "severity": "高",
            "text": "入站 HTTP/S 連接需要部署 WAF 和其他反向代理，將它們部署在登陸區域虛擬網路中，並將它們與它們保護和公開給 Internet 的應用一起部署。",
            "training": "https://learn.microsoft.com/learn/paths/architect-network-infrastructure/",
            "waf": "安全"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "088137f5-e6c4-4cfd-9e50-4547c2447ec6",
            "link": "https://learn.microsoft.com/azure/ddos-protection/ddos-protection-reference-architectures",
            "service": "VNet",
            "severity": "高",
            "text": "使用 Azure DDoS 網路或 IP 防護計劃來幫助保護虛擬網路中的公共 IP 位址終結點。",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "安全"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/firewallpolicies' | extend compliant = (properties.dnsSettings.enableProxy == true) | distinct id,compliant",
            "guid": "14d99880-2f88-47e8-a134-62a7d85c94af",
            "link": "https://learn.microsoft.com/azure/firewall/fqdn-filtering-network-rules",
            "service": "Firewall",
            "severity": "高",
            "text": "使用基於 FQDN 的網路規則和具有 DNS 代理的 Azure 防火牆，通過應用程式規則不支援的協定篩選流向 Internet 的出口流量。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/firewallpolicies' | extend compliant = (properties.sku.tier == 'Premium') | distinct id,compliant",
            "guid": "c10d51ef-f999-455d-bba0-5c90ece07447",
            "link": "https://learn.microsoft.com/azure/firewall/premium-features",
            "service": "Firewall",
            "severity": "高",
            "text": "使用 Azure 防火牆高級版獲得額外的安全性和保護。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/firewallpolicies' | extend compliant = (properties.threatIntelMode == 'Deny') | distinct id,compliant",
            "guid": "e9c8f584-6d5e-473b-8dc5-acc9fbaab4e3",
            "link": "https://learn.microsoft.com/azure/firewall/premium-features",
            "service": "Firewall",
            "severity": "高",
            "text": "將 Azure 防火牆威脅情報模式配置為「警報」和「拒絕」，以獲得額外保護。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/firewallpolicies' | extend compliant = (properties.intrusionDetection.mode == 'Deny') | project id, compliant",
            "guid": "b9d0dff5-bdd4-4cd8-88ed-5811610b2b2c",
            "link": "https://learn.microsoft.com/azure/firewall/premium-features#idps",
            "service": "Firewall",
            "severity": "高",
            "text": "將 Azure 防火牆 IDPS 模式配置為「拒絕」以獲得額外保護。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,resourceGroup,name,subnets=properties.subnets | mv-expand subnets | project id,name,subnetId=tostring(subnets.id), subnetName=tostring(subnets.name),subnetRT=subnets.properties.routeTable.id | where not (subnetName in ('GatewaySubnet', 'AzureFirewallSubnet', 'RouteServerSubnet', 'AzureBastionSubnet')) | extend hasRT = isnotnull(subnetRT) | distinct id, hasRT, subnetId | join kind=fullouter (resources | where type == 'microsoft.network/virtualnetworks' | mvexpand properties.virtualNetworkPeerings | extend isVWAN=(tolower(split(properties_virtualNetworkPeerings.name, '_')[0]) == 'remotevnettohubpeering') | mv-expand properties.subnets | project id, isVWAN, name, subnetId=tostring(properties_subnets.id), subnetName=tostring(properties_subnets.name) | summarize PeeredToVWAN=max(isVWAN) by id, subnetId | project id, subnetId, isVWANpeer = (PeeredToVWAN == true)) on subnetId | project id=iff(isnotempty(id), id, id1), subnetId=iff(isnotempty(subnetId), subnetId, subnetId1), hasRT, isVWANpeer | extend compliant = (hasRT==true or isVWANpeer==true) | distinct id, subnetId, compliant",
            "guid": "a3784907-9836-4271-aafc-93535f8ec08b",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-networks-udr-overview",
            "service": "Firewall",
            "severity": "高",
            "text": "對於未連接到虛擬 WAN 的 VNet 中的子網，請附加路由表，以便將 Internet 流量重定向到 Azure 防火牆或網路虛擬設備",
            "waf": "安全"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "b034c01e-110b-463a-b36e-e3346e57f225",
            "link": "https://learn.microsoft.com/en-us/azure/virtual-network/ip-services/default-outbound-access",
            "service": "VNet",
            "severity": "高",
            "text": "在即將到來的重大更改之前評估和審查網路出站流量配置和策略。2025 年 9 月 30 日，新部署的預設出站訪問將停用，僅允許顯式訪問配置",
            "waf": "可靠性"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "d301d6e8-72e5-42e3-911c-c58b5a4b1511",
            "link": "https://learn.microsoft.com/azure/virtual-network/vnet-integration-for-azure-services",
            "service": "App Gateway",
            "severity": "高",
            "text": "確保注入虛擬網路的 Azure PaaS 服務的控制平面通信不會中斷，例如使用 0.0.0.0/0 路由或阻止控制平面流量的 NSG 規則。",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/?source=learn",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "guid": "b3e4563a-4d87-4397-98b6-62d6d15f512a",
            "link": "https://learn.microsoft.com/azure/app-service/networking-features",
            "service": "ExpressRoute",
            "severity": "中等",
            "text": "通過專用終結點和 ExpressRoute 專用對等互連從本地訪問 Azure PaaS 服務。此方法可避免通過公共 Internet 傳輸。",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type =~ 'microsoft.network/virtualnetworks' | project id,resourceGroup,name,subnets = properties.subnets | mv-expand subnets | project id = subnets.id, resourceGroup, VNet = name, serviceEndpoints = subnets.properties.serviceEndpoints, compliant = (isnull(subnets.properties.serviceEndpoints) or array_length(subnets.properties.serviceEndpoints) == 0) | order by compliant asc",
            "guid": "4704489a-8042-4d88-b79d-17b73b22a5a6",
            "link": "https://learn.microsoft.com/azure/app-service/networking-features",
            "service": "VNet",
            "severity": "中等",
            "text": "默認情況下，不要在所有子網上啟用虛擬網路服務終結點。",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/?source=learn",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "7e7a8ed4-b30e-438c-9f29-812b2363cefe",
            "link": "https://learn.microsoft.com/azure/app-service/networking-features",
            "service": "Firewall",
            "severity": "中等",
            "text": "使用 FQDN（而不是 Azure 防火牆或 NVA 中的 IP 位址）篩選發往 Azure PaaS 服務的出口流量，以防止數據外洩。如果使用專用連結，則可以阻止所有 FQDN，否則僅允許所需的 PaaS 服務。",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/?source=learn",
            "waf": "安全"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,subnets=properties.subnets | mv-expand subnets | project id, subnetName = subnets.name, subnetPrefix = subnets.properties.addressPrefix | extend subnetPrefixLength = split(subnetPrefix, '/')[1] | where subnetName == 'AzureFirewallSubnet' | extend compliant = (subnetPrefixLength == 26) | distinct id, compliant",
            "guid": "22d6419e-b627-4d95-9e7d-019fa759387f",
            "link": "https://learn.microsoft.com/azure/firewall/firewall-faq#why-does-azure-firewall-need-a--26-subnet-size",
            "service": "Firewall",
            "severity": "高",
            "text": "對 Azure 防火牆子網使用 /26 前置綴。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,subnets=properties.subnets | mv-expand subnets | project id, subnetName = subnets.name, subnetPrefix = subnets.properties.addressPrefix | extend subnetPrefixLength = split(subnetPrefix, '/')[1] | where subnetName == 'GatewaySubnet' | extend compliant = (subnetPrefixLength <= 27) | distinct id, compliant",
            "guid": "f2aad7e3-bb03-4adc-8606-4123d342a917",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-howto-add-gateway-resource-manager#add-a-gateway",
            "service": "ExpressRoute",
            "severity": "高",
            "text": "至少對閘道子網使用 /27 前置綴",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/networksecuritygroups' | mvexpand properties.securityRules | project id,name,ruleAction=properties_securityRules.properties.access,rulePriority=properties_securityRules.properties.priority,ruleDst=properties_securityRules.properties.destinationAddressPrefix,ruleSrc=properties_securityRules.properties.sourceAddressPrefix,ruleProt=properties_securityRules.properties.protocol,ruleDirection=properties_securityRules.properties.direction,rulePort=properties_securityRules.properties.destinationPortRange | summarize StarDenies=countif(ruleAction=='Deny' and ruleDst=='*' and ruleSrc=='*' and ruleProt=='*' and rulePort=='*') by id,tostring(ruleDirection) | where ruleDirection == 'Inbound' | project id,compliant=(StarDenies>0) | union (resources | where type=='microsoft.network/networksecuritygroups' | where array_length(properties.securityRules)==0 | extend compliant=false | project id,compliant)",
            "guid": "11deb39d-8299-4e47-bbe0-0fb5a36318a8",
            "link": "https://learn.microsoft.com/azure/virtual-network/service-tags-overview#available-service-tags",
            "service": "NSG",
            "severity": "中等",
            "text": "不要依賴使用 VirtualNetwork 服務標記的 NSG 入站預設規則來限制連接。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "872e52e3-611c-4c58-a5a4-b1511e43a58a",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "service": "NSG",
            "severity": "中等",
            "text": "使用 NSG 説明保護跨子網的流量，以及跨平台的東/西流量（登陸區域之間的流量）。",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "graph": "Resources | where type=='microsoft.network/virtualnetworks' | project id,resourceGroup,name,subnets=properties.subnets | mv-expand subnets | project id,name,subnetName=subnets.name,subnetNsg=subnets.properties.networkSecurityGroup | where not (subnetName in ('GatewaySubnet', 'AzureFirewallSubnet', 'RouteServerSubnet', 'AzureBastionSubnet')) | extend compliant = isnotnull(subnetNsg)",
            "guid": "9c2299c4-d7b5-47d0-a655-562f2b3e4563",
            "service": "NSG",
            "severity": "中等",
            "text": "應用程式團隊應在子網級別的NSG上使用應用程式安全組來幫助保護登陸區域中的多層 VM。",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "a4d87397-48b6-462d-9d15-f512a65498f6",
            "link": "https://learn.microsoft.com/azure/virtual-network/network-security-group-how-it-works",
            "service": "NSG",
            "severity": "中等",
            "text": "使用 NSG 和應用程式安全組對登陸區域內的流量進行微分段，並避免使用中心 NVA 篩選流量流。",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "dfe237de-143b-416c-91d7-aa9b64704489",
            "link": "https://learn.microsoft.com/azure/virtual-network/network-security-group-how-it-works",
            "service": "NSG",
            "severity": "中等",
            "text": "啟用 VNet 流日誌並將其饋送到流量分析中，以深入了解內部和外部流量流。",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-network-monitoring/",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type == 'microsoft.network/networksecuritygroups' | project id, rules = array_length(properties.securityRules) | project id, compliant = (rules < 900)",
            "guid": "0390417d-53dc-44d9-b3f4-c8832f359b41",
            "link": "https://learn.microsoft.com/en-us/azure/azure-resource-manager/management/azure-subscription-service-limits",
            "service": "NSG",
            "severity": "中等",
            "text": "請考慮每個 NSG 的 NSG 規則限制 （1000）。",
            "training": "https://learn.microsoft.com/en-us/azure/virtual-network/network-security-group-how-it-works",
            "waf": "可靠性"
        },
        {
            "arm-service": "microsoft.network/virtualWans",
            "checklist": "Azure Landing Zone Review",
            "guid": "412e7f98-3f63-4047-82dd-69c5b5c2622f",
            "link": "https://learn.microsoft.com/azure/virtual-wan/scenario-any-to-any",
            "service": "VWAN",
            "severity": "中等",
            "text": "請考慮使用虛擬 WAN 來簡化 Azure 網路管理，並確保在虛擬 WAN 路由設計清單中明確描述你的方案",
            "training": "https://learn.microsoft.com/learn/modules/introduction-azure-virtual-wan/",
            "waf": "操作"
        },
        {
            "arm-service": "microsoft.network/virtualWans",
            "checklist": "Azure Landing Zone Review",
            "guid": "54b69bad-33aa-4d5e-ac68-e1d76667313b",
            "link": "https://learn.microsoft.com/azure/virtual-wan/virtual-wan-about",
            "service": "VWAN",
            "severity": "中等",
            "text": "使用每個 Azure 區域的虛擬 WAN 中心，透過通用的全球 Azure 虛擬 WAN 跨 Azure 區域將多個登陸區域連接在一起。",
            "waf": "性能"
        },
        {
            "arm-service": "microsoft.network/virtualWans",
            "checklist": "Azure Landing Zone Review",
            "guid": "8ac6a9e0-1e6a-483d-b5de-32c199248160",
            "link": "https://learn.microsoft.com/azure/virtual-wan/virtual-wan-about",
            "service": "VWAN",
            "severity": "低",
            "text": "遵循“Azure 中的流量保留在 Azure 中”的原則，以便通過 Microsoft 主幹網络跨 Azure 中的資源進行通信",
            "waf": "性能"
        },
        {
            "arm-service": "microsoft.network/virtualWans",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/virtualhubs' | extend compliant = isnotnull(properties.azureFirewall.id) | project id, compliant",
            "guid": "7d5d1e4e-6146-458d-9558-fd77249b8211",
            "link": "https://learn.microsoft.com/azure/virtual-wan/virtual-wan-about",
            "service": "VWAN",
            "severity": "中等",
            "text": "若要進行出站 Internet 流量保護和篩選，請在安全中心部署 Azure 防火牆",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "安全"
        },
        {
            "arm-service": "microsoft.network/virtualWans",
            "checklist": "Azure Landing Zone Review",
            "guid": "6667313b-4f56-464b-9e98-4a859c773e7d",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits",
            "service": "VWAN",
            "severity": "中等",
            "text": "確保網路體系結構在 Azure 虛擬 WAN 限制範圍內。",
            "waf": "可靠性"
        },
        {
            "arm-service": "microsoft.network/virtualWans",
            "checklist": "Azure Landing Zone Review",
            "guid": "261623a7-65a9-417e-8f34-8ef254c27d42",
            "link": "https://learn.microsoft.com/azure/virtual-wan/azure-monitor-insights",
            "service": "VWAN",
            "severity": "中等",
            "text": "使用適用於虛擬 WAN 的 Azure Monitor 見解監視虛擬 WAN 的端到端拓撲、狀態和關鍵指標。",
            "waf": "操作"
        },
        {
            "arm-service": "microsoft.network/virtualWans",
            "checklist": "Azure Landing Zone Review",
            "guid": "727c77e1-b9aa-4a37-a024-129d042422c1",
            "link": "https://learn.microsoft.com/azure/virtual-wan/virtual-wan-faq#is-branch-to-branch-connectivity-allowed-in-virtual-wan",
            "service": "VWAN",
            "severity": "中等",
            "text": "請確保 IaC 部署不會在虛擬 WAN 中禁用分支到分支流量，除非應顯式阻止這些流。",
            "waf": "可靠性"
        },
        {
            "arm-service": "microsoft.network/virtualWans",
            "checklist": "Azure Landing Zone Review",
            "guid": "d49ac006-6670-4bc9-9948-d3e0a3a94f4d",
            "link": "https://learn.microsoft.com/azure/virtual-wan/about-virtual-hub-routing-preference",
            "service": "VWAN",
            "severity": "中等",
            "text": "使用 AS-Path 作為中心路由首選項，因為它比 ExpressRoute 或 VPN 更靈活。",
            "waf": "可靠性"
        },
        {
            "arm-service": "microsoft.network/virtualWans",
            "checklist": "Azure Landing Zone Review",
            "guid": "2586b854-237e-47f1-84a1-d45d4cd2310d",
            "link": "https://learn.microsoft.com/azure/virtual-wan/about-virtual-hub-routing#labels",
            "service": "VWAN",
            "severity": "中等",
            "text": "請確保 IaC 部署在虛擬 WAN 中配置基於標籤的傳播，否則虛擬中心之間的連接將受到損害。",
            "waf": "可靠性"
        },
        {
            "ammp": true,
            "arm-service": "microsoft.network/virtualWans",
            "checklist": "Azure Landing Zone Review",
            "guid": "9c75dfef-573c-461c-a698-68598595581a",
            "link": "https://learn.microsoft.com/azure/virtual-wan/virtual-wan-faq#what-is-the-recommended-hub-address-space-during-hub-creation",
            "service": "VWAN",
            "severity": "高",
            "text": "為虛擬中心分配足夠的IP空間，最好是 /23前置綴。",
            "waf": "可靠性"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "5c986cb2-9131-456a-8247-6e49f541acdc",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "service": "Policy",
            "severity": "高",
            "text": "戰略性地利用 Azure Policy，為環境定義控制，使用策略計劃對相關策略進行分組。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "e979377b-cdb3-4751-ab2a-b13ada6e55d7",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/naming-and-tagging",
            "service": "Policy",
            "severity": "中等",
            "text": "確定所需的 Azure 標記，並使用「追加」策略模式通過 Azure Policy 強制使用。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "d8a2adb1-17d6-4326-af62-5ca44e5695f2",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "service": "Policy",
            "severity": "中等",
            "text": "將法規和合規性要求映射到 Azure Policy 定義和 Azure 角色分配。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "223ace8c-b123-408c-a501-7f154e3ab369",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "service": "Policy",
            "severity": "中等",
            "text": "在中間根管理組建立 Azure Policy 定義，以便可以在繼承的範圍內分配這些定義",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "3829e7e3-1618-4368-9a04-77a209945bda",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "service": "Policy",
            "severity": "中等",
            "text": "如果需要，在適當的最高級別管理策略分配，並在底層管理排除項。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "43334f24-9116-4341-a2ba-527526944008",
            "link": "https://learn.microsoft.com/security/benchmark/azure/mcsb-asset-management#am-2-use-only-approved-services",
            "service": "Policy",
            "severity": "低",
            "text": "使用 Azure Policy 控制使用者可以在訂閱/管理組級別預配哪些服務",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "be7d7e48-4327-46d8-adc0-55bcf619e8a1",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "service": "Policy",
            "severity": "中等",
            "text": "盡可能使用內置策略，以最大程度地減少運營開銷。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "description": "通過將「資源策略參與者」角色分配給特定範圍，可以將策略管理委派給相關團隊。例如，中心 IT 團隊可以監督管理組級別的策略，而應用程式團隊則處理其訂閱的策略，從而在遵守組織標準的情況下實現分散式治理。",
            "guid": "3f988795-25d6-4268-a6d7-0ba6c97be995",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview#azure-rbac-permissions-in-azure-policy",
            "service": "Policy",
            "severity": "中等",
            "text": "在特定範圍內分配內置的「資源策略參與者」角色，以啟用應用程式級治理。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "19048384-5c98-46cb-8913-156a12476e49",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "service": "Policy",
            "severity": "中等",
            "text": "限制在根管理組範圍內進行的 Azure Policy 分配數，以避免在繼承的範圍內通過排除項進行管理。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "5a917e1f-348e-4f25-9c27-d42e8bbac757",
            "link": "https://azure.microsoft.com/resources/achieving-compliant-data-residency-and-security-with-azure/",
            "service": "Policy",
            "severity": "中等",
            "text": "如果存在任何數據主權要求，可以部署 Azure 策略來強制實施這些要求",
            "training": "https://learn.microsoft.com/learn/paths/secure-your-cloud-data/",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "78b22132-b41c-460b-a4d3-df8f73a67dc2",
            "link": "https://github.com/Azure/sovereign-landing-zone/blob/main/docs/scenarios/Sovereignty-Policy-Baseline.md",
            "service": "Policy",
            "severity": "中等",
            "text": "對於主權登陸區域，主權策略基線的策略計劃在正確的 MG 級別部署和分配。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "caeea0e9-1024-41df-a52e-d99c3f22a6f4",
            "link": "https://learn.microsoft.com/en-us/industry/sovereignty/policy-portfolio-baseline",
            "service": "Policy",
            "severity": "中等",
            "text": "對於主權登陸區，記錄了主權控制目標到策略映射。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "9b461617-db7b-4399-8ac6-d4eb7153893a",
            "service": "Policy",
            "severity": "中等",
            "text": "對於主權登陸區，“主權控制目標到策略映射”的 CRUD 流程已到位。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "9b5e2a28-9823-4faf-ab7e-afa5f6c57221",
            "link": "https://learn.microsoft.com/azure/automation/automation-solution-vm-management-config",
            "service": "VM",
            "severity": "低",
            "text": "請考慮使用自動化標記來啟動/停止環境中的 VM，以節省成本。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "ecdc7506-6f37-4ea9-be87-fc5d3df08a64",
            "link": "https://learn.microsoft.com/azure/virtual-machine-scale-sets/overview",
            "service": "VMSS",
            "severity": "中等",
            "text": "利用 Azure 虛擬機規模集根據負載進行橫向擴展和橫向擴展。",
            "waf": "可靠性"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "89cc5e11-aa4d-4c3b-893d-feb99215266a",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#add-diagnostic-settings-to-save-your-wafs-logs",
            "service": "WAF",
            "severity": "高",
            "text": "添加診斷設置以保存 Azure Front Door 和 Azure 應用程式閘道等應用程式交付服務中的 WAF 紀錄。定期查看日誌，以檢查攻擊和誤報檢測。",
            "waf": "操作"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "7f408960-c626-44cb-a018-347c8d790cdf",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#send-logs-to-microsoft-sentinel",
            "service": "WAF",
            "severity": "中等",
            "text": "將 WAF 日誌從 Azure Front Door 和 Azure 應用程式閘道等應用程式交付服務發送到 Microsoft Sentinel。檢測攻擊並將 WAF 遙測集成到整個 Azure 環境中。",
            "waf": "操作"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "eba8cf22-45c6-4dc1-9b57-2cceb3b97ce5",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-redundancy",
            "service": "Backup",
            "severity": "中等",
            "text": "使用 Azure 備份時，請考慮不同的備份類型（GRS、ZRS 和 LRS），因為預設設置為 GRS",
            "waf": "可靠性"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "67e7a8ed-4b30-4e38-a3f2-9812b2363cef",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/design-logs-deployment",
            "service": "Monitor",
            "severity": "中等",
            "text": "使用單個監視器日誌工作區集中管理平臺，但 Azure 基於角色的訪問控制 （Azure RBAC）、數據主權要求或數據保留策略要求使用單獨的工作區的情況除外。",
            "training": "https://learn.microsoft.com/azure/azure-monitor/logs/design-logs-deployment",
            "waf": "操作"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "5e6c4cfd-3e50-4454-9c24-47ec66138a72",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/data-retention-archive?tabs=portal-1%2Cportal-2#how-retention-and-archiving-work",
            "service": "Monitor",
            "severity": "中等",
            "text": "當日志保留要求超過兩年時，請使用 Azure Monitor 日誌。目前，您可以將數據保留長達 7 年的存檔狀態。",
            "training": "https://learn.microsoft.com/learn/paths/architect-infrastructure-operations/",
            "waf": "操作"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "00f1ce16-ed30-41d6-b872-e52e3611cc58",
            "link": "https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/govern/policy-compliance/regulatory-compliance",
            "service": "Policy",
            "severity": "中等",
            "text": "使用 Azure Policy 進行訪問控制和合規性報告。Azure Policy 提供強制實施組織範圍設置的功能，以確保一致的策略遵守和快速的違規檢測。",
            "training": "https://learn.microsoft.com/en-us/azure/governance/policy/concepts/effects",
            "waf": "操作"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "e7d7e484-3276-4d8b-bc05-5bcf619e8a13",
            "link": "https://learn.microsoft.com/azure/governance/policy/how-to/guest-configuration-create",
            "service": "VM",
            "severity": "中等",
            "text": "使用 Azure Policy 監視來賓內虛擬機 （VM） 配置偏移。通過策略啟用來賓配置審核功能有助於應用程式團隊工作負載立即使用功能，而無需付出任何努力。",
            "training": "https://learn.microsoft.com/learn/paths/implement-resource-mgmt-security/",
            "waf": "操作"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "f9887952-5d62-4688-9d70-ba6c97be9951",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/management-operational-compliance#update-management-considerations ",
            "service": "VM",
            "severity": "中等",
            "text": "使用 Azure Update Manager 作為 Azure 中 Windows 和 Linux VM 的修補機制。",
            "training": "https://learn.microsoft.com/azure/update-manager/overview?tabs=azure-vms",
            "waf": "操作"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "c806c048-26b7-4ddf-b4c2-b4f0c476925d",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/management-operational-compliance#update-management-considerations ",
            "service": "VM",
            "severity": "中等",
            "text": "使用 Azure Arc 將 Azure Update Manager 用作 Azure 外部 Windows 和 Linux VM 的修補機制。",
            "training": "https://learn.microsoft.com/azure/update-manager/overview?tabs=azure-vms",
            "waf": "操作"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "90483845-c986-4cb2-a131-56a12476e49f",
            "link": "https://learn.microsoft.com/azure/network-watcher/network-watcher-monitoring-overview",
            "service": "Network Watcher",
            "severity": "中等",
            "text": "使用網路觀察程序主動監視流量",
            "training": "https://learn.microsoft.com/learn/modules/configure-network-watcher/",
            "waf": "操作"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "9945bda4-3334-4f24-a116-34182ba52752",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/design-logs-deployment",
            "service": "Monitor",
            "severity": "中等",
            "text": "使用集中式 Azure Monitor Log Analytics 工作區從 IaaS 和 PaaS 應用程式資源收集日誌和指標，並使用 Azure RBAC 控制日誌訪問。",
            "waf": "操作"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "6944008b-e7d7-4e48-9327-6d8bdc055bcf",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-setup-guide/monitoring-reporting?tabs=AzureMonitor",
            "service": "Monitor",
            "severity": "中等",
            "text": "使用 Azure Monitor 紀錄獲取見解和報告。",
            "waf": "操作"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "97be9951-9048-4384-9c98-6cb2913156a1",
            "link": "https://learn.microsoft.com/azure/azure-monitor/alerts/alerts-overview",
            "service": "Monitor",
            "severity": "中等",
            "text": "使用 Azure Monitor 警報生成操作警報。",
            "waf": "操作"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "fed3c55f-a67e-4875-aadd-3aba3f9fde31",
            "link": "https://learn.microsoft.com/azure/automation/how-to/region-mappings",
            "service": "Monitor",
            "severity": "中等",
            "text": "通過 Azure 自動化帳戶使用更改和清單跟蹤時，請確保已選擇支持的區域，以便將 Log Analytics 工作區和自動化帳戶連結在一起。",
            "waf": "操作"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "f541acdc-e979-4377-acdb-3751ab2ab13a",
            "link": "https://learn.microsoft.com/azure/governance/policy/concepts/guest-configuration",
            "service": "VM",
            "severity": "中等",
            "text": "使用 Azure 策略通過 VM 擴展自動部署軟體配置，並強制實施合規的基線 VM 配置。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "description": "Azure Policy 的來賓配置功能可以審核和修正計算機設置（例如 OS、應用程式、環境），以確保資源與預期配置保持一致，更新管理可以強制實施 VM 的修補程式管理。",
            "guid": "da6e55d7-d8a2-4adb-817d-6326af625ca4",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/management-operational-compliance#monitoring-for-configuration-drift",
            "service": "VM",
            "severity": "中等",
            "text": "通過 Azure Policy 監視 VM 安全配置偏差。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "2476e49f-541a-4cdc-b979-377bcdb3751a",
            "link": "https://learn.microsoft.com/azure/site-recovery/site-recovery-overview",
            "service": "VM",
            "severity": "中等",
            "text": "將 Azure Site Recovery 用於 Azure 到 Azure 虛擬機的災難恢復方案。這使您能夠跨區域複製工作負載。",
            "waf": "操作"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "f625ca44-e569-45f2-823a-ce8cb12308ca",
            "link": "https://learn.microsoft.com/azure/backup/backup-center-overview",
            "service": "Backup",
            "severity": "中等",
            "text": "使用 Azure 本機備份功能或與 Azure 相容的第三方備份解決方案。",
            "waf": "操作"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "826c5c45-bb79-4951-a812-e3bfbfd7326b",
            "link": "https://learn.microsoft.com/azure/reliability/availability-zones-overview",
            "service": "VM",
            "severity": "高",
            "text": "在支援可用性區域的區域中為 VM 利用可用性區域。",
            "waf": "可靠性"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "7ccb7c06-5511-42df-8177-d97f08d0337d",
            "link": "https://learn.microsoft.com/azure/virtual-machines/availability",
            "service": "VM",
            "severity": "高",
            "text": "避免在單個 VM 上運行生產工作負載。",
            "waf": "可靠性"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "84101f59-1941-4195-a270-e28034290e3a",
            "link": "https://learn.microsoft.com/azure/load-balancer/load-balancer-overview",
            "service": "VM",
            "severity": "中等",
            "text": "Azure 負載均衡器和應用程式閘道在多個資源之間分配傳入的網路流量。",
            "waf": "可靠性"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "5017f154-e3ab-4369-9829-e7e316183687",
            "link": "https://learn.microsoft.com/azure/key-vault/general/overview",
            "service": "Key Vault",
            "severity": "高",
            "text": "使用 Azure Key Vault 儲存機密和憑據",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "graph": "ResourceContainers | where type=='microsoft.resources/subscriptions'| parse id with '/subscriptions/' SubscriptionID| project subscriptionId, SubscriptionName = name| join kind=leftouter (Resources| where type == 'microsoft.keyvault/vaults'| project id, name, subscriptionId) on subscriptionId| join kind= leftouter (Resources| where type == 'microsoft.keyvault/vaults'| summarize ResourceCount = count() by subscriptionId) on subscriptionId| extend RCount = iff(isnull(ResourceCount), 0, ResourceCount)| project-away ResourceCount| extend compliant = (RCount <> 1)",
            "guid": "a0477a20-9945-4bda-9333-4f2491163418",
            "link": "https://learn.microsoft.com/azure/key-vault/general/overview-throttling",
            "service": "Key Vault",
            "severity": "中等",
            "text": "對不同的應用程式和區域使用不同的 Azure Key Vault，以避免事務規模限制並限制對機密的訪問。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "2ba52752-6944-4008-ae7d-7e4843276d8b",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "severity": "中等",
            "text": "預配啟用軟刪除和清除策略的 Azure Key Vault，以允許對已刪除物件進行保留保護。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "dc055bcf-619e-48a1-9f98-879525d62688",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "severity": "中等",
            "text": "遵循最低特權模型，將永久刪除密鑰、機密和證書的授權限制為專用的自定義 Microsoft Entra ID 角色。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "6d70ba6c-97be-4995-8904-83845c986cb2",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "severity": "中等",
            "text": "使用公共證書頒發機構自動執行證書管理和續訂過程，以簡化管理。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "913156a1-2476-4e49-b541-acdce979377b",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "severity": "中等",
            "text": "建立金鑰和證書輪換的自動化流程。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "cdb3751a-b2ab-413a-ba6e-55d7d8a2adb1",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "severity": "中等",
            "text": "在保管庫上啟用防火牆和虛擬網路服務終結點或專用終結點，以控制對密鑰保管庫的訪問。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "17d6326a-f625-4ca4-9e56-95f2223ace8c",
            "link": "https://learn.microsoft.com/azure/key-vault/general/monitor-key-vault",
            "service": "Key Vault",
            "severity": "中等",
            "text": "使用平臺中心的 Azure Monitor Log Analytics 工作區審核每個 Key Vault 實例中的金鑰、證書和機密使用方式。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "b12308ca-5017-4f15-9e3a-b3693829e7e3",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "severity": "中等",
            "text": "委託 Key Vault 實例化和特權訪問，並使用 Azure Policy 強制實施一致的合規配置。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "91163418-2ba5-4275-8694-4008be7d7e48",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "severity": "中等",
            "text": "每個應用程式、每個環境、每個區域使用 Azure Key Vault。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "25d62688-6d70-4ba6-a97b-e99519048384",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "severity": "中等",
            "text": "如果要自帶密鑰，則並非所有考慮的服務都支援此功能。實施相關的緩解措施，使不一致不會妨礙預期的結果。選擇適當的區域對和災難恢復區域，以最大程度地減少延遲。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "4ac6b67c-b3a4-4ff9-8e87-b07a7ce7bbdb",
            "link": "https://learn.microsoft.com/en-us/industry/sovereignty/key-management",
            "service": "Key Vault",
            "severity": "中等",
            "text": "對於主權登陸區域，請使用 Azure Key Vault 託管 HSM 來儲存機密和憑據。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "4e5695f2-223a-4ce8-ab12-308ca5017f15",
            "link": "https://learn.microsoft.com/azure/active-directory/reports-monitoring/overview-reports",
            "service": "Entra",
            "severity": "中等",
            "text": "使用 Microsoft Entra ID 報告功能生成訪問控制審核報告。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "09945bda-4333-44f2-9911-634182ba5275",
            "link": "https://learn.microsoft.com/azure/defender-for-cloud/concept-cloud-security-posture-management",
            "service": "Defender",
            "severity": "高",
            "text": "為所有訂閱啟用Defender雲安全態勢管理。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "36a72a48-fffe-4c40-9747-0ab5064355ba",
            "link": "https://learn.microsoft.com/azure/defender-for-cloud/plan-defender-for-servers-select-plan",
            "service": "Defender",
            "severity": "高",
            "text": "在所有訂閱上為伺服器啟用Defender雲工作負載保護計劃。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "77425f48-ecba-43a0-aeac-a3ac733ccc6a",
            "link": "https://www.microsoft.com/en-gb/security/business/solutions/cloud-workload-protection",
            "service": "Defender",
            "severity": "高",
            "text": "在所有訂閱上為 Azure 資源啟用 Defender 雲工作負載保護計劃。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "24d96b30-61ee-4436-a1cc-d6ef08bc574b",
            "link": "https://learn.microsoft.com/mem/configmgr/protect/deploy-use/endpoint-protection",
            "service": "VM",
            "severity": "高",
            "text": "在 IaaS 伺服器上啟用 Endpoint Protection。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "15833ee7-ad6c-46d3-9331-65c7acbe44ab",
            "link": "https://learn.microsoft.com/azure/security-center/",
            "service": "VM",
            "severity": "中等",
            "text": "通過 Azure Monitor 紀錄和 Defender for Cloud 監視基本作業系統修補偏差。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "e5f8d79f-2e87-4768-924c-516775c6ea95",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/design-logs-deployment",
            "service": "Monitor",
            "severity": "中等",
            "text": "將預設資源配置連接到集中式 Azure Monitor Log Analytics 工作區。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "1761e147-f65e-4d09-bbc2-f464f23e2eba",
            "link": "https://learn.microsoft.com/en-us/industry/sovereignty/transparency-logs",
            "service": "Entra",
            "severity": "中等",
            "text": "對於主權登陸區域，在 Entra ID 租戶上啟用透明度日誌。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "d21a922d-5ca7-427a-82a6-35f7b21f1bfc",
            "link": "https://learn.microsoft.com/en-us/azure/security/fundamentals/customer-lockbox-overview",
            "service": "Entra",
            "severity": "中等",
            "text": "對於主權登陸區域，在 Entra ID 租戶上啟用客戶密碼箱。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "b03ed428-4617-4067-a787-85468b9ccf3f",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-require-secure-transfer",
            "service": "Storage",
            "severity": "高",
            "text": "應啟用到存儲帳戶的安全傳輸",
            "waf": "安全"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "159aac9f-863f-4f48-82cf-00c28fa97a0e",
            "link": "https://learn.microsoft.com/azure/storage/blobs/data-protection-overview#recommendations-for-basic-data-protection",
            "service": "Storage",
            "severity": "高",
            "text": "為存儲帳戶啟用容器軟刪除，以恢復已刪除的容器及其內容。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "108d5099-a11d-4445-bd8b-e12a5e95412e",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/development-strategy-development-lifecycle#automated-builds",
            "service": "Key Vault",
            "severity": "高",
            "text": "使用 Key Vault 機密可避免對敏感資訊（例如憑據（虛擬機器用戶密碼）、證書或密鑰）進行硬編碼。",
            "waf": "操作"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "f00a69de-7076-4734-a734-6e4552cad9e1",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-latest-version-for-customer-managed-certificates",
            "service": "Front Door",
            "severity": "中等",
            "text": "如果將客戶管理的 TLS 證書用於 Azure Front Door，請使用“最新”證書版本。降低手動證書續訂導致的中斷風險",
            "waf": "操作"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "graph": "resources | where type == 'microsoft.network/applicationgateways' | project id, compliant = properties.sku.name in ('Standard_v2', 'WAF_v2') | project id,compliant",
            "guid": "553585a6-abe0-11ed-afa1-0242ac120002",
            "link": "https://learn.microsoft.com/azure/application-gateway/overview-v2",
            "service": "App Gateway",
            "severity": "中等",
            "text": "確保使用應用程式閘道 v2 SKU",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "安全"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "graph": "resources | where type == 'microsoft.network/loadbalancers' | project id, compliant=(tolower(sku.name) == 'standard')",
            "guid": "4e35fbf5-0ae2-48b2-97ce-753353edbd1a",
            "link": "https://learn.microsoft.com/azure/load-balancer/load-balancer-overview",
            "service": "Load Balancer",
            "severity": "中等",
            "text": "確保將標準 SKU 用於 Azure 負載均衡器",
            "waf": "安全"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "9432621a-8397-4654-a882-5bc856b7ef83",
            "link": "https://learn.microsoft.com/azure/load-balancer/load-balancer-standard-availability-zones",
            "service": "Load Balancer",
            "severity": "中等",
            "text": "確保您的負載均衡器前端IP位址是區域冗餘的（除非您需要區域前端）。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "graph": "resources | where type=='microsoft.network/applicationgateways' | extend subnetId = tostring(properties.gatewayIPConfigurations[0].properties.subnet.id) | project id, subnetId | join (resources | where type=='microsoft.network/virtualnetworks' | project id,subnets=properties.subnets | mv-expand subnets | mv-expand subnets.properties.addressPrefixes | project id, subnetId = tostring(subnets.id), prefix1 = subnets.properties.addressPrefix, prefix2 = subnets.properties.addressPrefixes | mv-expand prefix2 | extend prefix = iff(isnotnull(prefix1), prefix1, prefix2) | extend subnetPrefixLength = split(prefix, '/')[1])on subnetId | extend compliant = (subnetPrefixLength <= 24 or subnetPrefixLength == 64) | distinct id,compliant",
            "guid": "dfc50f87-3800-424c-937b-ed5f186e7c15",
            "link": "https://learn.microsoft.com/azure/application-gateway/configuration-infrastructure#size-of-the-subnet",
            "service": "App Gateway",
            "severity": "中等",
            "text": "應用程式閘道 v2 應部署在IP前綴等於或大於 /24 的子網中",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "安全"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "description": "一般而言，反向代理（尤其是 WAF）的管理更接近應用程式而不是網路，因此它們與應用程式屬於同一訂閱。如果應用程式閘道和 WAF 由一個團隊管理，則可以將應用程式閘道和 WAF 集中到連接訂閱中。",
            "guid": "48b662d6-d15f-4512-a654-98f6dfe237de",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "service": "App Gateway",
            "severity": "中等",
            "text": "部署 Azure 應用程式閘道 v2 或合作夥伴 NVA，用於在登陸區域虛擬網路中代理入站 HTTP（S） 連接，並使用它們保護的應用。",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "安全"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "f109e1f3-c79b-4f14-82de-6b5c22314d08",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "service": "App Gateway",
            "severity": "中等",
            "text": "對應用程式登陸區域中的所有公共IP位址使用 DDoS 網路或IP保護計畫。",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "安全"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "graph": "resources | where type =~ 'microsoft.network/applicationGateways' | extend compliant = (isnotnull(properties.autoscaleConfiguration) and properties.autoscaleConfiguration.minCapacity >= 2) | distinct id,compliant",
            "guid": "135bf4ac-f9db-461f-b76b-2ee9e30b12c0",
            "link": "https://learn.microsoft.com/azure/application-gateway/application-gateway-autoscaling-zone-redundant",
            "service": "App Gateway",
            "severity": "中等",
            "text": "配置自動縮放，最小實例數為 2。",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "可靠性"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "graph": "resources | where type =~ 'microsoft.network/applicationGateways' | extend compliant = (isnotnull(zones) and array_length(zones) > 1) | distinct id,compliant",
            "guid": "060c6964-52b5-48db-af8b-83e4b2d85349",
            "link": "https://learn.microsoft.com/azure/reliability/migrate-app-gateway-v2",
            "service": "App Gateway",
            "severity": "中等",
            "text": "跨可用性區域部署應用程式閘道",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "可靠性"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "e79d17b7-3b22-4a5a-97e7-a8ed4b30e38c",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "service": "Front Door",
            "severity": "中等",
            "text": "將 Azure Front Door 與 WAF 策略結合使用，以交付和幫助保護跨多個 Azure 區域的全球 HTTP/S 應用。",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "安全"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "3f29812b-2363-4cef-b179-b599de0d5973",
            "link": "https://learn.microsoft.com/azure/ddos-protection/ddos-protection-overview",
            "service": "Front Door",
            "severity": "中等",
            "text": "使用 Front Door 和應用程式閘道幫助保護 HTTP/S 應用時，請在 Front Door 中使用 WAF 策略。鎖定應用程式閘道以僅接收來自 Front Door 的流量。",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "安全"
        },
        {
            "ammp": true,
            "arm-service": "microsoft.network/trafficManagerProfiles",
            "checklist": "Azure Application Delivery Networking",
            "guid": "cd4cd21b-0881-437f-9e6c-4cfd3e504547",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "service": "Traffic Manager",
            "severity": "高",
            "text": "使用流量管理器交付跨 HTTP/S 以外的協定的全域應用。",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "可靠性"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "3b4b3e88-a459-4ed5-a22f-644dfbc58204",
            "link": "https://learn.microsoft.com/azure/active-directory/app-proxy/application-proxy#how-application-proxy-works",
            "service": "Entra",
            "severity": "低",
            "text": "如果使用者只需要存取內部應用程式，是否將 Microsoft Entra ID 應用程式代理視為 Azure 虛擬桌面 （AVD） 的替代方案？",
            "training": "https://learn.microsoft.com/learn/modules/configure-azure-ad-application-proxy/",
            "waf": "安全"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "01ca7cf1-5754-442d-babb-8ba6772e5c30",
            "link": "https://learn.microsoft.com/azure/active-directory/app-proxy/application-proxy#how-application-proxy-works",
            "service": "Entra",
            "severity": "中等",
            "text": "若要減少為網路中的傳入連接打開的防火牆埠數，請考慮使用 Microsoft Entra ID 應用程式代理為遠端使用者提供對內部應用程式的安全且經過身份驗證的訪問。",
            "training": "https://learn.microsoft.com/learn/paths/implement-applications-external-access-azure-ad/",
            "waf": "安全"
        },
        {
            "ammp": true,
            "checklist": "Azure Application Delivery Networking",
            "graph": "resources | where type == 'microsoft.network/frontdoorwebapplicationfirewallpolicies' | project policyName=name, policyId=id,policySku=sku.name, links=properties.securityPolicyLinks, enabledState=properties.policySettings.enabledState, mode=properties.policySettings.mode | mvexpand links | extend securityPolicy=links.id | extend securityPolicyParts=split(securityPolicy, '/') | extend profileId=strcat_array(array_slice(securityPolicyParts, 0, -3), '/') | project id=profileId, compliant=((enabledState=='Enabled') and (mode=='Prevention')), enabledState, mode",
            "guid": "ae248989-b306-4591-9186-de482e3f0f0e",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-policy-settings",
            "service": "Front Door",
            "severity": "高",
            "text": "在「預防」模式下部署 Front Door 的 WAF 配置檔。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "checklist": "Azure Application Delivery Networking",
            "guid": "062d5839-4d36-402f-bfa4-02811eb936e9",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#avoid-combining-traffic-manager-and-front-door",
            "service": "Front Door",
            "severity": "高",
            "text": "避免結合使用 Azure 流量管理器和 Azure Front Door。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "checklist": "Azure Application Delivery Networking",
            "guid": "5efeb96a-003f-4b18-8fcd-b4d84459c2b2",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-the-same-domain-name-on-front-door-and-your-origin",
            "service": "Front Door",
            "severity": "高",
            "text": "在 Azure Front Door 和源上使用相同的功能變數名稱。不匹配的主機名可能會導致細微的錯誤。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "graph": "cdnresources | where type =~ 'microsoft.cdn/profiles/origingroups/origins' | extend frontDoorId = substring(id, 0, indexof(id, '/origingroups')) | extend originGroupId = substring(id, 0, indexof(id, '/origins')) | join kind=inner (cdnresources | where type =~ 'microsoft.cdn/profiles/origingroups' | extend originGroupName = name | extend hasHealthProbe = isnotnull(properties.healthProbeSettings)) on $left.originGroupId == $right.id | summarize numberOrigins = count() by originGroupId, subscriptionId, frontDoorId, hasHealthProbe, originGroupName | extend compliant = not(numberOrigins == 1 and hasHealthProbe) | project id = frontDoorId, compliant",
            "guid": "0b5a380c-4bfb-47bc-b1d7-dcfef363a61b",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#disable-health-probes-when-theres-only-one-origin-in-an-origin-group",
            "service": "Front Door",
            "severity": "低",
            "text": "當 Azure Front Door 源組中只有一個源時，禁用運行狀況探測。",
            "waf": "性能"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "5567048e-e5d7-4206-9c55-b5ed45d2cc0c",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#select-good-health-probe-endpoints",
            "service": "Front Door",
            "severity": "中等",
            "text": "為 Azure Front Door 選擇運行狀況良好的探測終結點。請考慮生成用於檢查應用程式的所有依賴項的運行狀況終結點。",
            "waf": "可靠性"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "graph": "cdnresources | where type =~ 'microsoft.cdn/profiles/origingroups' | extend frontDoorId = substring(id, 0, indexof(id, '/origingroups/')) | extend compliant = (isnull(properties['healthProbeSettings']['probeRequestType']) or toupper(properties['healthProbeSettings']['probeRequestType']) == 'HEAD') | project compliant, id=frontDoorId",
            "guid": "a13f72f3-8f5c-4864-95e5-75bf37fbbeb1",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-head-health-probes",
            "service": "Front Door",
            "severity": "低",
            "text": "將 HEAD 運行狀況探測與 Azure Front Door 配合使用，以減少 Front Door 發送到應用程式的流量。",
            "waf": "性能"
        },
        {
            "ammp": true,
            "checklist": "Azure Application Delivery Networking",
            "graph": "resources | where type=='microsoft.network/loadbalancers' | extend countOutRules=array_length(properties.outboundRules) | extend compliant = (countOutRules == 0) | distinct id,compliant",
            "guid": "97a2fd46-64b0-1dfa-b72d-9c8869496d75",
            "link": "https://learn.microsoft.com/azure/nat-gateway/nat-overview#outbound-connectivity",
            "service": "Load Balancer",
            "severity": "高",
            "text": "使用 Azure NAT 閘道而不是負載均衡器出站規則，以獲得更好的 SNAT 可伸縮性",
            "waf": "可靠性"
        },
        {
            "ammp": true,
            "checklist": "Azure Application Delivery Networking",
            "graph": "cdnresources | where type =~ 'microsoft.cdn/profiles/customdomains' | extend frontDoorId = substring(id, 0, indexof(id, '/customdomains')) | extend compliant = (isnull(properties['tlsSettings']['certificateType']) or tolower(properties['tlsSettings']['certificateType']) =~ 'customercertificate') | project compliant, id = frontDoorId",
            "guid": "af95c92d-d723-4f4a-98d7-8722324efd4d",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-managed-tls-certificates",
            "service": "Front Door",
            "severity": "高",
            "text": "將託管 TLS 證書與 Azure Front Door 配合使用。降低運營成本和因證書續訂而導致的中斷風險。",
            "waf": "操作"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "189ea962-3969-4863-8f5a-5ad808c2cf4b",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#define-your-waf-configuration-as-code",
            "service": "Front Door",
            "severity": "中等",
            "text": "將 Azure Front Door WAF 配置定義為代碼。通過使用代碼，您可以更輕鬆地採用新的規則集版本並獲得額外的保護。",
            "waf": "操作"
        },
        {
            "ammp": true,
            "checklist": "Azure Application Delivery Networking",
            "guid": "2e30abab-5478-417c-81bf-bf1ad4ed1ed4",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-end-to-end-tls",
            "service": "Front Door",
            "severity": "高",
            "text": "將端到端 TLS 與 Azure Front Door 配合使用。將 TLS 用於從用戶端到 Front Door 的連接，以及從 Front Door 到源的連接。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "10aa45af-166f-44c4-9f36-b6d592dac2ca",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-http-to-https-redirection",
            "service": "Front Door",
            "severity": "中等",
            "text": "將 HTTP 到 HTTPS 重定向與 Azure Front Door 配合使用。通過自動將舊用戶端重定向到 HTTPS 請求來支持它們。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "checklist": "Azure Application Delivery Networking",
            "guid": "28b9ee82-b2c7-45aa-bc98-6de6f59a095d",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#enable-the-waf",
            "service": "Front Door",
            "severity": "高",
            "text": "啟用 Azure Front Door WAF。保護您的應用程式免受一系列攻擊。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "checklist": "Azure Application Delivery Networking",
            "guid": "2902d8cc-1b0c-4495-afad-624ab70f7bd6",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#tune-your-waf",
            "service": "Front Door",
            "severity": "高",
            "text": "針對工作負載優化 Azure Front Door WAF。減少誤報檢測。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "checklist": "Azure Application Delivery Networking",
            "guid": "17ba124b-127d-42b6-9322-388d5b2bbcfc",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#use-prevention-mode",
            "service": "Front Door",
            "severity": "高",
            "text": "將預防模式與 Azure Front Door WAF 配合使用。防護模式可確保WAF攔截惡意請求。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "checklist": "Azure Application Delivery Networking",
            "guid": "49a98f2b-ec22-4a87-9415-6a10b00d6555",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#enable-default-rule-sets",
            "service": "Front Door",
            "severity": "高",
            "text": "啟用 Azure Front Door WAF 預設規則集。默認規則集檢測並阻止常見攻擊。",
            "waf": "安全"
        },
        {
            "ammp": true,
            "checklist": "Azure Application Delivery Networking",
            "guid": "147a13d4-2a2f-4824-a524-f5855b52b946",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#enable-bot-management-rules",
            "service": "Front Door",
            "severity": "高",
            "text": "啟用 Azure Front Door WAF 機器人管理規則。機器人規則可檢測好的和壞的機器人。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "d7dcdcb9-0d99-44b9-baab-ac7570ede79a",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#use-the-latest-ruleset-versions",
            "service": "Front Door",
            "severity": "中等",
            "text": "使用最新的 Azure Front Door WAF 規則集版本。規則集更新會定期更新，以考慮當前的威脅形勢。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "b9620385-1cde-418f-914b-a84a06982ffc",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#add-rate-limiting",
            "service": "Front Door",
            "severity": "中等",
            "text": "向 Azure Front Door WAF 添加速率限制。速率限制會阻止客戶端在短時間內意外或有意發送大量流量。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "6dc36c52-0124-4ffe-9eaf-23ec1282dedb",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#use-a-high-threshold-for-rate-limits",
            "service": "Front Door",
            "severity": "中等",
            "text": "對 Azure Front Door WAF 速率限制使用高閾值。高速率限制閾值可避免阻止合法流量，同時仍可防止可能使基礎結構不堪重負的大量請求。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "388a3d0e-0a43-4367-90b2-3dd2aeece5ee",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#geo-filter-traffic",
            "service": "Front Door",
            "severity": "低",
            "text": "使用 Azure Front Door WAF 對流量進行異地篩選。僅允許來自預期區域的流量，並阻止來自其他區域的流量。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "00acd8a9-6975-414f-8491-2be6309893b8",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#specify-the-unknown-zz-location",
            "service": "Front Door",
            "severity": "中等",
            "text": "使用 Azure Front Door WAF 對流量進行異地篩選時，指定未知 （ZZ） 位置。避免在IP位址無法進行地理匹配時意外阻止合法請求。",
            "waf": "安全"
        },
        {
            "checklist": "Redis Resiliency checklist",
            "guid": "65285269-440b-44be-9d3e-0844276d4bdc",
            "link": "https://learn.microsoft.com/azure/azure-cache-for-redis/cache-how-to-zone-redundancy",
            "service": "Redis",
            "text": "Azure Cache for Redis 支持高級層和企業層中的區域冗餘配置。區域冗餘緩存可以將其節點放置在同一區域中的不同 Azure 可用性區域中。它消除了數據中心或可用區中斷作為單點故障，並提高了緩存的整體可用性。",
            "waf": "可靠性"
        },
        {
            "checklist": "Redis Resiliency checklist",
            "guid": "bc178bdc-5a06-4ca7-8443-51e19dd34429",
            "link": "https://learn.microsoft.com/en-us/azure/azure-cache-for-redis/cache-high-availability#persistence",
            "service": "Redis",
            "text": "由於緩存數據存儲在記憶體中，因此多個節點的罕見和計劃外故障可能會導致所有數據被丟棄。為了避免完全丟失數據，Redis 持久性允許你定期拍攝記憶體中數據的快照，並將其存儲到存儲帳戶中。",
            "waf": "可靠性"
        },
        {
            "checklist": "Redis Resiliency checklist",
            "guid": "eb722823-7a15-41c5-ab4e-4f1814387e5c",
            "link": "https://learn.microsoft.com/en-us/azure/azure-cache-for-redis/cache-high-availability#storage-account-for-persistence",
            "service": "Redis",
            "text": "使用異地冗餘存儲帳戶保存 Azure Cache for Redis 數據，或在異地冗餘不可用的情況下進行區域冗餘",
            "waf": "可靠性"
        },
        {
            "checklist": "Redis Resiliency checklist",
            "guid": "a8c26c9b-32ab-45bd-bc69-98a135e33789",
            "link": "https://learn.microsoft.com/azure/azure-cache-for-redis/cache-how-to-geo-replication",
            "service": "Redis",
            "text": "異地複製是一種用於連結兩個或多個 Azure Cache for Redis 實例的機制，通常跨越兩個 Azure 區域。異地複製主要用於跨區域災難恢復。兩個高級層緩存實例通過異地複製進行連接，以提供對主緩存的讀取和寫入，並將該數據複製到輔助緩存。",
            "waf": "可靠性"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "應用與存儲相關的 Microsoft 雲安全基準中的指導",
            "guid": "d237de14-3b16-4c21-b7aa-9b64604489a8",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/storage-security-baseline",
            "service": "Azure Storage",
            "severity": "中等",
            "text": "請考慮「存儲的 Azure 安全基線”",
            "waf": "安全"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "默認情況下，Azure 儲存具有公共IP位址，並且可通過Internet訪問。專用終結點允許僅向需要訪問的 Azure 計算資源安全地公開 Azure 存儲，從而消除對公共 Internet 的暴露",
            "guid": "f42d78e7-9d17-4a73-a22a-5a67e7a8ed4b",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-private-endpoints",
            "service": "Azure Storage",
            "severity": "高",
            "text": "考慮將專用終結點用於 Azure 存儲",
            "waf": "安全"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "新創建的存儲帳戶是使用ARM部署模型創建的，因此 RBAC、審核等都已啟用。確保訂閱中沒有具有經典部署模型的舊存儲帳戶",
            "guid": "30e37c3e-2971-41b2-963c-eee079b598de",
            "link": "https://learn.microsoft.com/azure/virtual-machines/migration-classic-resource-manager-overview#migration-of-storage-accounts",
            "service": "Azure Storage",
            "severity": "中等",
            "text": "確保較舊的存儲帳戶未使用“經典部署模型”",
            "waf": "安全"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "利用 Microsoft Defender 瞭解可疑活動和錯誤配置。",
            "guid": "fc5972cd-4cd2-41b0-a803-7f5e6b4bfd3d",
            "link": "https://learn.microsoft.com/azure/storage/common/azure-defender-storage-configure",
            "service": "Azure Storage",
            "severity": "高",
            "text": "為所有存儲帳戶啟用 Microsoft DefenderEnable Defender for all of your storage accounts",
            "waf": "安全"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "軟刪除機制允許恢復意外刪除的 Blob。",
            "guid": "503547c1-447e-4c66-828a-7100f1ce16dd",
            "link": "https://learn.microsoft.com/azure/storage/blobs/soft-delete-blob-overview",
            "service": "Azure Storage",
            "severity": "中等",
            "text": "為 blob 啟用“軟刪除”",
            "waf": "安全"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "請考慮有選擇地禁用某些 blob 容器的「軟刪除」 例如，如果應用程式必須確保立即刪除已刪除的資訊，例如出於機密性、隱私或合規性原因。",
            "guid": "3f1d5e87-2e52-4e36-81cc-58b4a4b1510e",
            "link": "https://learn.microsoft.com/azure/storage/blobs/soft-delete-blob-enable",
            "service": "Azure Storage",
            "severity": "中等",
            "text": "禁用 blob 的“軟刪除”",
            "waf": "安全"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "容器的軟刪除使你能夠在刪除容器后恢復容器，例如從意外刪除操作中恢復。",
            "guid": "43a58a9c-2289-4c3d-9b57-d0c655462f2a",
            "link": "https://learn.microsoft.com/azure/storage/blobs/soft-delete-container-overview",
            "service": "Azure Storage",
            "severity": "高",
            "text": "為容器啟用“軟刪除”",
            "waf": "安全"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "請考慮有選擇地禁用某些 blob 容器的「軟刪除」 例如，如果應用程式必須確保立即刪除已刪除的資訊，例如出於機密性、隱私或合規性原因。",
            "guid": "3e3453a3-c863-4964-ab65-2d6c15f51296",
            "link": "https://learn.microsoft.com/azure/storage/blobs/soft-delete-container-enable",
            "service": "Azure Storage",
            "severity": "中等",
            "text": "禁用容器的“軟刪除”",
            "waf": "安全"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "通過強制使用者在刪除之前先刪除刪除鎖，防止意外刪除存儲帳戶",
            "guid": "5398e6de-d227-4dd1-92b0-6c21d7999a64",
            "link": "https://learn.microsoft.com/azure/storage/common/lock-account-resource",
            "service": "Azure Storage",
            "severity": "高",
            "text": "在存儲帳戶上啟用資源鎖",
            "waf": "安全"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "請考慮對 blob 使用“合法保留”或“基于時間的保留”策略，這樣就無法刪除 blob、容器或存儲帳戶。請注意，「不可能」實際上意味著「不可能」;存儲帳戶包含不可變 blob 後，「擺脫」該存儲帳戶的唯一方法是取消 Azure 訂閱。",
            "guid": "6f4389a8-f42c-478e-98c0-6a73a22a4956",
            "link": "https://learn.microsoft.com/azure/storage/blobs/immutable-storage-overview",
            "service": "Azure Storage",
            "severity": "高",
            "text": "考慮不可變的 blob",
            "waf": "安全"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "請考慮禁用對存儲帳戶的未受保護的 HTTP/80 訪問，以便對所有數據傳輸進行加密、完整性保護，並對伺服器進行身份驗證。",
            "guid": "e7a8dc4a-20e2-47c3-b297-11b1352beee0",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-require-secure-transfer",
            "service": "Azure Storage",
            "severity": "高",
            "text": "需要 HTTPS，即在儲存帳戶上禁用埠 80",
            "waf": "安全"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "在儲存帳戶上配置自定義域（主機名）時，請檢查是否需要 TLS/HTTPS;如果是這樣，可能需要將 Azure CDN 放在存儲帳戶的前面。",
            "guid": "79b588de-fc49-472c-b3cd-21bf77036e5e",
            "link": "https://learn.microsoft.com/azure/storage/blobs/storage-custom-domain-name",
            "service": "Azure Storage",
            "severity": "高",
            "text": "強制實施 HTTPS（禁用 HTTP）時，請檢查是否未對儲存帳戶使用自定義域 （CNAME）。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "當用戶端使用SAS令牌訪問 blob 資料時，要求使用 HTTPS 有助於將憑據丟失的風險降至最低。",
            "guid": "6b4bed3d-5035-447c-8347-dc56028a71ff",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-sas-overview",
            "service": "Azure Storage",
            "severity": "中等",
            "text": "將共享訪問簽名 （SAS） 令牌限製為僅 HTTPS 連接",
            "waf": "安全"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "在可能的情況下，AAD 令牌應優先於共用訪問簽名",
            "guid": "e1ce15dd-3f0d-45e7-92d4-1e3611cc57b4",
            "link": "https://learn.microsoft.com/azure/storage/common/authorize-data-access",
            "service": "Azure Storage",
            "severity": "高",
            "text": "使用 Azure Active Directory （Azure AD） 令牌進行 blob 訪問",
            "waf": "安全"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "將角色分配給使用者、組或應用程式時，請僅向該安全主體授予他們執行任務所需的許可權。限制對資源的訪問有助於防止無意和惡意濫用數據。",
            "guid": "a4b1410d-4395-48a8-a228-9b3d6b57cfc6",
            "service": "Azure Storage",
            "severity": "中等",
            "text": "IaM 許可權中的最低特權",
            "waf": "安全"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "使用者委派 SAS 使用 Azure Active Directory （Azure AD） 憑據以及為 SAS 指定的許可權進行保護。使用者委派 SAS 在範圍和功能方面類似於服務 SAS，但比服務 SAS 具有安全優勢。",
            "guid": "55461e1a-3e34-453a-9c86-39648b652d6c",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-sas-overview?toc=%2Fazure%2Fstorage%2Fblobs%2Ftoc.json#best-practices-when-using-sas",
            "service": "Azure Storage",
            "severity": "高",
            "text": "使用 SAS 時，首選「使用者委派 SAS」，而不是基於存儲帳戶密鑰的 SAS。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "存儲帳戶金鑰（“共用金鑰”）幾乎沒有審核功能。雖然可以監控誰/何時獲取密鑰副本，但一旦密鑰掌握在多個人手中，就不可能將使用方式歸因於特定使用者。僅依靠 AAD 身份驗證可以更輕鬆地將存儲存取許可權綁定到使用者。",
            "guid": "15f51296-5398-4e6d-bd22-7dd142b06c21",
            "link": "https://learn.microsoft.com/rest/api/storageservices/authorize-with-shared-key",
            "service": "Azure Storage",
            "severity": "高",
            "text": "請考慮禁用存儲帳戶密鑰，以便僅支援 AAD 訪問（和使用者委派 SAS）。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "使用活動日誌數據來標識查看或更改存儲帳戶安全性的“時間”、“人員”、“內容”和“方式”（即存儲帳戶密鑰、訪問策略等）。",
            "guid": "d7999a64-6f43-489a-af42-c78e78c06a73",
            "link": "https://learn.microsoft.com/azure/storage/blobs/blob-storage-monitoring-scenarios#audit-account-activity",
            "service": "Azure Storage",
            "severity": "高",
            "text": "請考慮使用 Azure Monitor 審核存儲帳戶上的控制平面操作",
            "waf": "安全"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "通過金鑰過期策略，您可以設置帳戶訪問金鑰輪換的提醒。如果指定的時間間隔已過且鍵尚未旋轉，則會顯示提醒。",
            "guid": "a22a4956-e7a8-4dc4-a20e-27c3e29711b1",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-account-keys-manage?tabs=azure-portal#create-a-key-expiration-policy",
            "service": "Azure Storage",
            "severity": "中等",
            "text": "使用存儲帳戶密鑰時，請考慮啟用“金鑰過期策略”",
            "waf": "安全"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "SAS 過期策略指定 SAS 有效的建議時間間隔。SAS 過期策略適用於服務 SAS 或帳戶 SAS。當使用者生成的服務 SAS 或帳戶 SAS 的有效期間隔大於建議的時間間隔時，他們會看到警告。",
            "guid": "352beee0-79b5-488d-bfc4-972cd3cd21bf",
            "link": "https://learn.microsoft.com/azure/storage/common/sas-expiration-policy",
            "service": "Azure Storage",
            "severity": "中等",
            "text": "考慮配置 SAS 過期策略",
            "waf": "安全"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "存儲存取策略提供了撤銷服務 SAS 許可權的選項，而無需重新生成儲存帳戶密鑰。",
            "guid": "77036e5e-6b4b-4ed3-b503-547c1347dc56",
            "link": "https://learn.microsoft.com/rest/api/storageservices/define-stored-access-policy",
            "service": "Azure Storage",
            "severity": "中等",
            "text": "考慮將 SAS 連結到儲存存取策略",
            "waf": "安全"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "guid": "028a71ff-e1ce-415d-b3f0-d5e772d41e36",
            "link": "https://microsoft.github.io/code-with-engineering-playbook/continuous-integration/dev-sec-ops/secret-management/recipes/detect-secrets-ado/",
            "service": "Azure Storage",
            "severity": "中等",
            "text": "請考慮配置應用程式的原始程式碼儲存庫，以檢測簽入的連接字串和存儲帳戶密鑰。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "理想情況下，應用程式應使用託管標識向 Azure 儲存進行身份驗證。如果無法做到這一點，請考慮在 Azure KeyVault 或等效服務中使用存儲憑據（連接字串、存儲帳戶密鑰、SAS、服務主體憑據）。",
            "guid": "11cc57b4-a4b1-4410-b439-58a8c2289b3d",
            "link": "https://learn.microsoft.com/azure/architecture/framework/security/design-storage-keys",
            "service": "Azure Storage",
            "severity": "高",
            "text": "請考慮將連接字串儲存在 Azure KeyVault 中（在無法實現託管標識的情況下）",
            "waf": "安全"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "在臨時 SAS 服務 SAS 或帳戶 SAS 上使用近期過期時間。這樣，即使 SAS 遭到入侵，它也只能在很短的時間內有效。如果無法引用存儲訪問策略，則此做法尤為重要。近期過期時間還通過限制可上傳到 blob 的時間來限制可寫入 blob 的數據量。",
            "guid": "27138b82-1102-4cac-9eae-01e6e842e52f",
            "link": "https://learn.microsoft.com/rest/api/storageservices/delegate-access-with-shared-access-signature",
            "service": "Azure Storage",
            "severity": "高",
            "text": "爭取縮短臨時 SAS 的有效期",
            "waf": "安全"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "創建 SAS 時，請盡可能具體和嚴格。首選單個資源和操作的 SAS，而不是提供更廣泛訪問許可權的 SAS。",
            "guid": "4721d928-c1b1-4cd5-81e5-4a29a9de399c",
            "link": "https://learn.microsoft.com/rest/api/storageservices/delegate-access-with-shared-access-signature",
            "service": "Azure Storage",
            "severity": "中等",
            "text": "將窄範圍應用於SAS",
            "waf": "安全"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "SAS 可以包含用戶端 IP 位址或位址範圍有權使用 SAS 請求資源的參數。",
            "guid": "fd7b28dc-9355-4562-82bf-e4564b0d834a",
            "link": "https://learn.microsoft.com/rest/api/storageservices/create-account-sas",
            "service": "Azure Storage",
            "severity": "中等",
            "text": "盡可能考慮將SAS的範圍限定為特定的用戶端IP位址",
            "waf": "安全"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "SAS 無法限制用戶端上傳的數據量;考慮到存儲量隨時間變化的定價模型，驗證用戶端是否惡意上傳了大量內容可能是有意義的。",
            "guid": "348b263e-6dd6-4051-8a36-498f6dbad38e",
            "service": "Azure Storage",
            "severity": "低",
            "text": "請考慮在用戶端使用SAS上傳檔后檢查上傳的數據。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "使用「本地使用者帳戶」通過 SFTP 訪問 Blob 儲存時，“通常”RBAC 控制不適用。通過 NFS 或 REST 進行的 Blob 訪問可能比 SFTP 訪問更嚴格。遺憾的是，截至 2023 年初，本地使用者是 SFTP 端點當前支援的唯一身份管理形式",
            "guid": "ad53cc7c-e1d7-4aaa-a357-1449ab8053d8",
            "link": "https://learn.microsoft.com/azure/storage/blobs/secure-file-transfer-protocol-support#sftp-permission-model",
            "service": "Azure Storage",
            "severity": "高",
            "text": "SFTP：限制 SFTP 訪問的「本地使用者」數量，並審核一段時間內是否需要訪問。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "guid": "9f89dc7b-33be-42a1-a27f-7b9e91be1f38",
            "link": "https://learn.microsoft.com/azure/storage/blobs/secure-file-transfer-protocol-known-issues#authentication-and-authorization",
            "service": "Azure Storage",
            "severity": "中等",
            "text": "SFTP：SFTP 端點不支持類似 POSIX 的 ACL。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "存儲支援 CORS（跨域資源分享），即一種 HTTP 功能，使來自不同域的 Web 應用程式能夠放寬同源策略。啟用 CORS 時，請將 CorsRules 保留為最低許可權。",
            "guid": "cef39812-bd46-43cb-aac8-ac199ebb91a3",
            "link": "https://learn.microsoft.com/rest/api/storageservices/cross-origin-resource-sharing--cors--support-for-the-azure-storage-services",
            "service": "Azure Storage",
            "severity": "高",
            "text": "避免過於寬泛的 CORS 策略",
            "waf": "安全"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "靜態數據始終在伺服器端加密，此外也可能在用戶端加密。伺服器端加密可能使用平臺管理的金鑰（預設）或客戶管理的金鑰進行。用戶端加密可以通過讓用戶端按 blob 向 Azure 儲存提供加密/解密金鑰，或者完全在用戶端處理加密來實現。因此，完全不依賴 Azure 存儲來保證機密性。",
            "guid": "3d90cae2-cc88-4137-86f7-c0cbafe61464",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-service-encryption",
            "service": "Azure Storage",
            "severity": "高",
            "text": "確定應如何加密靜態數據。了解數據的線程模型。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "guid": "8dd457e9-2713-48b8-8110-2cac6eae01e6",
            "link": "https://learn.microsoft.com/azure/storage/common/customer-managed-keys-overview?toc=%2Fazure%2Fstorage%2Fblobs%2Ftoc.json&bc=%2Fazure%2Fstorage%2Fblobs%2Fbreadcrumb%2Ftoc.json",
            "service": "Azure Storage",
            "severity": "中等",
            "text": "確定應使用哪種/是否應使用平臺加密。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "guid": "e842e52f-4721-4d92-ac1b-1cd521e54a29",
            "link": "https://learn.microsoft.com/azure/storage/blobs/encryption-customer-provided-keys",
            "service": "Azure Storage",
            "severity": "中等",
            "text": "確定應使用哪種/是否應使用用戶端加密。",
            "waf": "安全"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "利用 Resource Graph 資源管理器（資源 | where type == 'microsoft.storage/storageaccounts' | where properties['allowBlobPublicAccess'] == true）查找允許匿名 blob 訪問的存儲帳戶。",
            "guid": "659ae558-b937-4d49-a5e1-112dbd7ba012",
            "link": "https://learn.microsoft.com/azure/storage/blobs/anonymous-read-access-configure?tabs=portal#allow-or-disallow-public-read-access-for-a-storage-account",
            "service": "Azure Storage",
            "severity": "高",
            "text": "考慮是否需要公共 blob 訪問，或者是否可以對某些存儲帳戶禁用公共 blob 訪問。",
            "waf": "安全"
        }
    ],
    "metadata": {
        "name": "WAF checklist",
        "timestamp": "February 20, 2024"
    },
    "severities": [
        {
            "name": "高"
        },
        {
            "name": "中等"
        },
        {
            "name": "低"
        }
    ],
    "status": [
        {
            "description": "此檢查尚未查看",
            "name": "未驗證"
        },
        {
            "description": "有一個與此檢查關聯的操作項",
            "name": "打開"
        },
        {
            "description": "此檢查已經過驗證，沒有與之關聯的其他操作項",
            "name": "實現"
        },
        {
            "description": "不適用於當前設計",
            "name": "不適用"
        },
        {
            "description": "不需要",
            "name": "不需要"
        }
    ]
}
{
    "categories": [
        {
            "name": "Gestión de identidades y accesos"
        },
        {
            "name": "Topología y conectividad de red"
        },
        {
            "name": "BC y DR"
        },
        {
            "name": "Gobernanza y seguridad"
        },
        {
            "name": "Gobernanza de costos"
        },
        {
            "name": "Operaciones"
        },
        {
            "name": "Implementación de aplicaciones"
        }
    ],
    "items": [
        {
            "category": "Implementación de aplicaciones",
            "cost": 1,
            "guid": "785c2fa5-5b56-4ad4-a408-fe72734c476b",
            "id": "01.01.01",
            "link": "https://learn.microsoft.com/azure/architecture/reference-architectures/containers/aks/secure-baseline-aks",
            "severity": "Medio",
            "subcategory": "Desarrollo",
            "text": "Uso de implementaciones canary o blue/green",
            "waf": "Operaciones"
        },
        {
            "category": "Implementación de aplicaciones",
            "cost": 1,
            "guid": "ab5351f6-383a-45ed-9c5e-b143b16db40a",
            "id": "01.01.02",
            "link": "https://learn.microsoft.com/azure/aks/use-windows-hpc",
            "severity": "Bajo",
            "subcategory": "Desarrollo",
            "text": "Si es necesario para las cargas de trabajo de Windows de AKS, se pueden usar contenedores HostProcess",
            "waf": "Fiabilidad"
        },
        {
            "category": "Implementación de aplicaciones",
            "guid": "a280dcf5-90ce-465d-b8e1-3f9ccbd46926",
            "id": "01.01.03",
            "link": "https://learn.microsoft.com/azure/azure-functions/functions-kubernetes-keda",
            "scale": 1,
            "severity": "Bajo",
            "simple": -1,
            "subcategory": "Desarrollo",
            "text": "Utilice KEDA si ejecuta cargas de trabajo controladas por eventos",
            "waf": "Rendimiento"
        },
        {
            "category": "Implementación de aplicaciones",
            "guid": "26886d20-b66c-457b-a591-19bf8e8f5c58",
            "id": "01.01.04",
            "link": "https://dapr.io/",
            "severity": "Bajo",
            "simple": 1,
            "subcategory": "Desarrollo",
            "text": "Uso de Dapr para facilitar el desarrollo de microservicios",
            "waf": "Operaciones"
        },
        {
            "category": "Implementación de aplicaciones",
            "guid": "3acbe04b-be20-49d3-afda-47778424d116",
            "ha": 1,
            "id": "01.02.01",
            "link": "https://learn.microsoft.com/azure/developer/terraform/create-k8s-cluster-with-tf-and-aks",
            "severity": "Medio",
            "simple": -1,
            "subcategory": "Infraestructura como código",
            "text": "Uso de la automatización a través de ARM/TF para crear los recursos de Azure",
            "waf": "Operaciones"
        },
        {
            "category": "BC y DR",
            "guid": "36cb45e5-7960-4332-9bdf-8cc23318da61",
            "ha": 1,
            "id": "02.01.01",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/enterprise-scale/business-continuity-and-disaster-recovery",
            "severity": "Alto",
            "subcategory": "Recuperación ante desastres",
            "text": "Programe y realice pruebas de recuperación ante desastres con regularidad",
            "waf": "Fiabilidad"
        },
        {
            "category": "BC y DR",
            "guid": "170265f4-bb46-4a39-9af7-f317284797b1",
            "ha": 1,
            "id": "02.02.01",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-multi-region",
            "severity": "Medio",
            "subcategory": "Alta disponibilidad",
            "text": "Uso de Azure Traffic Manager o Azure Front Door como equilibrador de carga global para la conmutación por error de región",
            "waf": "Fiabilidad"
        },
        {
            "category": "BC y DR",
            "graph": "resources | where type=='microsoft.containerservice/managedclusters' | extend compliant= isnotnull(properties.agentPoolProfiles[0].availabilityZones) | distinct id,compliant",
            "guid": "578a219a-46be-4b54-9350-24922634292b",
            "ha": 1,
            "id": "02.02.02",
            "link": "https://learn.microsoft.com/azure/aks/availability-zones",
            "severity": "Medio",
            "subcategory": "Alta disponibilidad",
            "text": "Use las zonas de disponibilidad si se admiten en la región de Azure",
            "waf": "Fiabilidad"
        },
        {
            "category": "BC y DR",
            "cost": -2,
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (sku.tier=='Paid') | distinct id,compliant",
            "guid": "71d41e36-10cc-457b-9a4b-1410d4395898",
            "ha": 2,
            "id": "02.02.03",
            "link": "https://learn.microsoft.com/azure/aks/uptime-sla",
            "severity": "Alto",
            "subcategory": "Alta disponibilidad",
            "text": "Uso de la oferta de AKS respaldada por SLA",
            "waf": "Fiabilidad"
        },
        {
            "category": "BC y DR",
            "guid": "c1288b3c-6a57-4cfc-9444-51e1a3d3453a",
            "ha": 1,
            "id": "02.02.04",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-scheduler",
            "severity": "Bajo",
            "simple": -1,
            "subcategory": "Alta disponibilidad",
            "text": "Uso de presupuestos de interrupción en el pod y las definiciones de implementación",
            "waf": "Fiabilidad"
        },
        {
            "category": "BC y DR",
            "cost": -1,
            "guid": "3c763963-7a55-42d5-a15e-401955387e5c",
            "ha": 1,
            "id": "02.02.05",
            "link": "https://learn.microsoft.com/azure/container-registry/container-registry-geo-replication",
            "severity": "Alto",
            "subcategory": "Alta disponibilidad",
            "text": "Si usa un registro privado, configure la replicación de regiones para almacenar imágenes en varias regiones",
            "waf": "Fiabilidad"
        },
        {
            "category": "BC y DR",
            "guid": "bc14aea6-e65d-48d9-a3ad-c218e6436b06",
            "ha": 1,
            "id": "02.03.01",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/enterprise-scale/business-continuity-and-disaster-recovery",
            "severity": "Alto",
            "subcategory": "Requisitos",
            "text": "Defina requisitos no funcionales como SLA, RTO (Recovery Time Objective) y RPO (Recovery Point Objective).",
            "waf": "Fiabilidad"
        },
        {
            "category": "Gobernanza de costos",
            "cost": 1,
            "guid": "f82cb8eb-8c0a-4a63-a25a-4956eaa8dc4a",
            "id": "03.01.01",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/aks/eslz-cost-governance-with-kubecost",
            "severity": "Bajo",
            "subcategory": "Costar",
            "text": "Usar una aplicación externa como kubecost para asignar costos a diferentes usuarios",
            "waf": "Costar"
        },
        {
            "category": "Gobernanza de costos",
            "cost": 1,
            "guid": "64d1a846-e28a-4b6b-9a33-22a635c15a21",
            "id": "03.01.02",
            "link": "https://learn.microsoft.com/azure/aks/node-pool-snapshot",
            "severity": "Bajo",
            "subcategory": "Costar",
            "text": "Si es necesario, escale las instantáneas de NodePool",
            "waf": "Costar"
        },
        {
            "category": "Gobernanza de costos",
            "cost": 1,
            "guid": "4d3dfbab-9924-4831-a68d-fdf0d72f462c",
            "id": "03.01.03",
            "link": "https://learn.microsoft.com/azure/aks/scale-down-mode",
            "severity": "Bajo",
            "subcategory": "Costar",
            "text": "Usar el modo de reducción vertical para eliminar/desasignar nodos",
            "waf": "Costar"
        },
        {
            "category": "Gobernanza de costos",
            "cost": 1,
            "guid": "87e651ea-bc4a-4a87-a6df-c06a4b570ebc",
            "id": "03.01.04",
            "link": "https://learn.microsoft.com/azure/aks/gpu-multi-instance",
            "severity": "Medio",
            "subcategory": "Costar",
            "text": "Cuando sea necesario, use la GPU de partición de varias instancias en clústeres de AKS",
            "waf": "Costar"
        },
        {
            "category": "Gobernanza de costos",
            "cost": 1,
            "guid": "2b72a08b-0410-4cd6-9093-e068a5cf27e8",
            "id": "03.01.05",
            "link": "https://learn.microsoft.com/azure/aks/start-stop-nodepools",
            "severity": "Bajo",
            "subcategory": "Costar",
            "text": "Si se ejecuta un clúster de desarrollo y pruebas, use NodePool Start/Stop",
            "waf": "Costar"
        },
        {
            "category": "Gobernanza y seguridad",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (isnotnull(properties.addonProfiles.azurepolicy) and properties.addonProfiles.azurepolicy.enabled==true) | distinct id,compliant",
            "guid": "9ca48e4a-85e2-4223-bce8-bb12307ca5f1",
            "id": "04.01.01",
            "link": "https://learn.microsoft.com/azure/governance/policy/concepts/policy-for-kubernetes",
            "security": 1,
            "severity": "Medio",
            "simple": -1,
            "subcategory": "Conformidad",
            "text": "Uso de Azure Policy para Kubernetes para garantizar el cumplimiento de clústeres",
            "waf": "Seguridad"
        },
        {
            "category": "Gobernanza y seguridad",
            "cost": -1,
            "graph": "where type=='microsoft.containerservice/managedclusters' | project id,resourceGroup,name,pools=properties.agentPoolProfiles | project id,name,resourceGroup,poolcount=array_length(pools) | extend compliant = (poolcount > 1)",
            "guid": "6f158e3e-a3a9-42c2-be7e-2165c3a87af4",
            "id": "04.01.02",
            "link": "https://learn.microsoft.com/azure/aks/use-system-pools",
            "security": 1,
            "severity": "Medio",
            "simple": -1,
            "subcategory": "Conformidad",
            "text": "Separe las aplicaciones del plano de control con grupos de nodos de usuario/sistema",
            "waf": "Seguridad"
        },
        {
            "category": "Gobernanza y seguridad",
            "guid": "a7a1f893-9bda-4477-98f2-4c116775c2ea",
            "ha": 1,
            "id": "04.01.03",
            "link": "https://learn.microsoft.com/azure/aks/use-system-pools",
            "severity": "Bajo",
            "simple": -1,
            "subcategory": "Conformidad",
            "text": "Agregue taint a su grupo de nodos del sistema para que sea dedicado",
            "waf": "Seguridad"
        },
        {
            "category": "Gobernanza y seguridad",
            "guid": "55b46a94-8008-4ae7-b7e4-b475b6c8bdbf",
            "id": "04.01.04",
            "link": "https://learn.microsoft.com/azure/container-registry/",
            "security": 1,
            "severity": "Medio",
            "simple": -1,
            "subcategory": "Conformidad",
            "text": "Utilice un registro privado para sus imágenes, como ACR",
            "waf": "Seguridad"
        },
        {
            "category": "Gobernanza y seguridad",
            "cost": -1,
            "guid": "59bce65d-e8a0-43f9-9879-468d66a786d6",
            "id": "04.01.05",
            "link": "https://learn.microsoft.com/azure/security-center/container-security",
            "security": 1,
            "severity": "Medio",
            "subcategory": "Conformidad",
            "text": "Escanea tus imágenes en busca de vulnerabilidades",
            "waf": "Seguridad"
        },
        {
            "category": "Gobernanza y seguridad",
            "cost": -1,
            "guid": "cc639637-a652-42ac-89e8-06965388e9de",
            "id": "04.01.06",
            "link": "https://learn.microsoft.com/azure/security-center/container-security",
            "security": 1,
            "severity": "Medio",
            "subcategory": "Conformidad",
            "text": "Uso de Azure Security Center para detectar vulnerabilidades de la posición de seguridad",
            "waf": "Seguridad"
        },
        {
            "category": "Gobernanza y seguridad",
            "cost": -1,
            "guid": "42d4aefe-2383-470e-b019-c30df24996b2",
            "id": "04.01.07",
            "link": "https://learn.microsoft.com/azure/aks/use-multiple-node-pools#add-a-fips-enabled-node-pool",
            "security": 1,
            "severity": "Bajo",
            "subcategory": "Conformidad",
            "text": "Si es necesario, configure FIPS",
            "waf": "Seguridad"
        },
        {
            "category": "Gobernanza y seguridad",
            "guid": "d167dd18-2b0a-4c24-8b99-9a646f8389a7",
            "id": "04.01.08",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-cluster-isolation",
            "security": 1,
            "severity": "Alto",
            "subcategory": "Conformidad",
            "text": "Definir los requisitos de separación de aplicaciones (espacio de nombres/grupo de nodos/clúster)",
            "waf": "Seguridad"
        },
        {
            "category": "Gobernanza y seguridad",
            "guid": "5e3df584-eccc-4d97-a3b6-bcda3b50eb2e",
            "id": "04.02.01",
            "link": "https://github.com/Azure/secrets-store-csi-driver-provider-azure",
            "security": 1,
            "severity": "Medio",
            "simple": -1,
            "subcategory": "Secretos",
            "text": "Almacenamiento de los secretos en Azure Key Vault con el controlador del almacén de secretos de CSI",
            "waf": "Seguridad"
        },
        {
            "category": "Gobernanza y seguridad",
            "guid": "b03dda6d-58d7-4c89-8ddb-107d5769ae66",
            "id": "04.02.02",
            "link": "https://learn.microsoft.com/azure/aks/update-credentials",
            "security": 1,
            "severity": "Alto",
            "subcategory": "Secretos",
            "text": "Si usa entidades de servicio para el clúster, actualice las credenciales periódicamente (por ejemplo, trimestralmente)",
            "waf": "Seguridad"
        },
        {
            "category": "Gobernanza y seguridad",
            "cost": -1,
            "guid": "e7ba73a3-0508-4f80-806f-527db30cee96",
            "id": "04.02.03",
            "link": "https://learn.microsoft.com/azure/aks/use-kms-etcd-encryption",
            "security": 1,
            "severity": "Medio",
            "subcategory": "Secretos",
            "text": "Si es necesario, agregue el servicio de administración de claves, etcd, cifrado",
            "waf": "Seguridad"
        },
        {
            "category": "Gobernanza y seguridad",
            "cost": -1,
            "guid": "ec8e4e42-0344-41b0-b865-9123e8956d31",
            "id": "04.02.04",
            "link": "https://learn.microsoft.com/azure/confidential-computing/confidential-nodes-aks-overview",
            "security": 1,
            "severity": "Bajo",
            "subcategory": "Secretos",
            "text": "Si es necesario, considere la posibilidad de usar Proceso confidencial para AKS",
            "waf": "Seguridad"
        },
        {
            "category": "Gobernanza y seguridad",
            "cost": -1,
            "guid": "c9e95ffe-6dd1-4a17-8c5f-110389ca9b21",
            "id": "04.02.05",
            "link": "https://learn.microsoft.com/azure/defender-for-cloud/defender-for-containers-enable",
            "security": 1,
            "severity": "Medio",
            "subcategory": "Secretos",
            "text": "Considere la posibilidad de usar Defender para contenedores",
            "waf": "Seguridad"
        },
        {
            "category": "Gestión de identidades y accesos",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (properties.servicePrincipalProfile.clientId=='msi') | distinct id,compliant",
            "guid": "ed127dd1-42b0-46b2-8c69-99a646f3389a",
            "id": "05.01.01",
            "link": "https://learn.microsoft.com/azure/aks/use-managed-identity",
            "severity": "Alto",
            "simple": 1,
            "subcategory": "Identidad",
            "text": "Uso de identidades administradas en lugar de entidades de servicio",
            "waf": "Seguridad"
        },
        {
            "category": "Gestión de identidades y accesos",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = isnotnull(properties.aadProfile) | distinct id,compliant",
            "guid": "7e42c78e-78c0-46a6-8a21-94956e698dc4",
            "id": "05.01.02",
            "link": "https://learn.microsoft.com/azure/aks/managed-aad",
            "severity": "Medio",
            "simple": 1,
            "subcategory": "Identidad",
            "text": "Integración de la autenticación con AAD (mediante la integración administrada)",
            "waf": "Seguridad"
        },
        {
            "category": "Gestión de identidades y accesos",
            "guid": "a2fe27b2-e287-401a-8352-beedf79b488d",
            "id": "05.01.03",
            "link": "https://learn.microsoft.com/azure/aks/control-kubeconfig-access",
            "security": 1,
            "severity": "Medio",
            "simple": -1,
            "subcategory": "Identidad",
            "text": "Limitar el acceso a admin kubeconfig (get-credentials --admin)",
            "waf": "Seguridad"
        },
        {
            "category": "Gestión de identidades y accesos",
            "guid": "eec4962c-c3bd-421b-b77f-26e5e6b3bec3",
            "id": "05.01.04",
            "link": "https://learn.microsoft.com/azure/aks/manage-azure-rbac",
            "security": 1,
            "severity": "Medio",
            "simple": -1,
            "subcategory": "Identidad",
            "text": "Integración de la autorización con RBAC de AAD",
            "waf": "Seguridad"
        },
        {
            "category": "Gestión de identidades y accesos",
            "guid": "d4f3537c-1346-4dc5-9027-a71ffe1bd05d",
            "ha": 1,
            "id": "05.01.05",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-identity",
            "security": 1,
            "severity": "Alto",
            "simple": -1,
            "subcategory": "Identidad",
            "text": "Uso de espacios de nombres para restringir el privilegio RBAC en Kubernetes",
            "waf": "Seguridad"
        },
        {
            "category": "Gestión de identidades y accesos",
            "guid": "d2e0d5d7-71d4-41e3-910c-c57b4a4b1410",
            "id": "05.01.06",
            "link": "https://learn.microsoft.com/azure/aks/workload-identity-migration-sidecar",
            "security": 1,
            "severity": "Medio",
            "simple": -1,
            "subcategory": "Identidad",
            "text": "Para POD Identity Access Management, use Azure AD Workload Identity (versión preliminar)",
            "waf": "Seguridad"
        },
        {
            "category": "Gestión de identidades y accesos",
            "guid": "f4dcf690-1b30-407d-abab-6f8aa780d3a3",
            "id": "05.01.07",
            "link": "https://learn.microsoft.com/azure/aks/managed-aad#non-interactive-sign-in-with-kubelogin",
            "security": 1,
            "severity": "Medio",
            "simple": -1,
            "subcategory": "Identidad",
            "text": "En el caso de los inicios de sesión no interactivos de AKS, use kubelogin (versión preliminar)",
            "waf": "Seguridad"
        },
        {
            "category": "Gestión de identidades y accesos",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (properties.disableLocalAccounts==true) | distinct id,compliant",
            "guid": "b085b1f2-3119-4771-8c9a-bbf4411810ec",
            "id": "05.01.08",
            "link": "https://learn.microsoft.com/azure/aks/managed-aad#disable-local-accounts",
            "security": 1,
            "severity": "Medio",
            "simple": -1,
            "subcategory": "Identidad",
            "text": "Deshabilitación de cuentas locales de AKS",
            "waf": "Seguridad"
        },
        {
            "category": "Gestión de identidades y accesos",
            "guid": "36abb0db-c118-4f4c-9880-3f30f9a2deb6",
            "id": "05.01.09",
            "link": "https://learn.microsoft.com/azure/aks/managed-aad#configure-just-in-time-cluster-access-with-azure-ad-and-aks",
            "security": 1,
            "severity": "Bajo",
            "simple": -1,
            "subcategory": "Identidad",
            "text": "Configure, si es necesario, el acceso al clúster Just-In-Time",
            "waf": "Seguridad"
        },
        {
            "category": "Gestión de identidades y accesos",
            "guid": "c4d7f4c6-79bf-45d0-aa05-ce8fc717e150",
            "id": "05.01.10",
            "link": "https://learn.microsoft.com/azure/aks/managed-aad#use-conditional-access-with-azure-ad-and-aks",
            "security": 1,
            "severity": "Bajo",
            "simple": -1,
            "subcategory": "Identidad",
            "text": "Configure si es necesario el acceso condicional de AAD para AKS",
            "waf": "Seguridad"
        },
        {
            "category": "Gestión de identidades y accesos",
            "guid": "e1123a7c-a333-4eb4-a120-4ee3f293c9f3",
            "id": "05.01.11",
            "link": "https://learn.microsoft.com/azure/aks/use-group-managed-service-accounts",
            "security": 1,
            "severity": "Bajo",
            "simple": -1,
            "subcategory": "Identidad",
            "text": "Si es necesario para las cargas de trabajo de Windows AKS, configure gMSA ",
            "waf": "Seguridad"
        },
        {
            "category": "Gestión de identidades y accesos",
            "guid": "1f711a74-3672-470b-b8b8-a2148d640d79",
            "id": "05.01.12",
            "link": "https://learn.microsoft.com/azure/aks/use-managed-identity#use-a-pre-created-kubelet-managed-identity",
            "security": 1,
            "severity": "Medio",
            "simple": -1,
            "subcategory": "Identidad",
            "text": "Para un control más preciso, considere la posibilidad de utilizar una identidad de Kubelet administrada",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "cbd8ac2a-aebc-4a2a-94da-1dbf3dc99248",
            "id": "06.01.01",
            "link": "https://azure.github.io/application-gateway-kubernetes-ingress/setup/install-existing/",
            "security": 1,
            "severity": "Medio",
            "simple": -1,
            "subcategory": "Prácticas recomendadas",
            "text": "Si utiliza AGIC, no comparta un AppGW entre clústeres",
            "waf": "Fiabilidad"
        },
        {
            "category": "Topología y conectividad de red",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (isnull(properties.addonProfiles.httpApplicationRouting) or properties.addonProfiles.httpApplicationRouting.enabled==false) | distinct id,compliant",
            "guid": "8008ae7d-7e4b-4475-a6c8-bdbf59bce65d",
            "id": "06.01.02",
            "link": "https://learn.microsoft.com/azure/aks/http-application-routing",
            "scale": 1,
            "severity": "Alto",
            "simple": -1,
            "subcategory": "Prácticas recomendadas",
            "text": "No use el complemento de enrutamiento de aplicaciones de AKS",
            "waf": "Fiabilidad"
        },
        {
            "category": "Topología y conectividad de red",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (isnull(properties.addonProfiles.httpApplicationRouting) or properties.addonProfiles.httpApplicationRouting.enabled==false) | distinct id,compliant",
            "guid": "7bacd7b9-c025-4a9d-a5d2-25d6bc5439d9",
            "id": "06.01.03",
            "link": "https://learn.microsoft.com/azure/virtual-network/accelerated-networking-overview",
            "scale": 1,
            "severity": "Medio",
            "simple": -1,
            "subcategory": "Prácticas recomendadas",
            "text": "En el caso de las cargas de trabajo de Windows, use las redes aceleradas",
            "waf": "Rendimiento"
        },
        {
            "category": "Topología y conectividad de red",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (tolower(properties.networkProfile.loadBalancerSku)=='standard') | distinct id,compliant",
            "guid": "ba7da7be-9952-4914-a384-5d997cb39132",
            "id": "06.01.04",
            "link": "https://learn.microsoft.com/azure/aks/load-balancer-standard",
            "scale": 1,
            "severity": "Alto",
            "subcategory": "Prácticas recomendadas",
            "text": "Utilice el ALB estándar (en lugar del básico)",
            "waf": "Fiabilidad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "22fbe8d6-9b40-47ef-9011-25bb1a555a6b",
            "id": "06.01.05",
            "link": "https://learn.microsoft.com/azure/aks/use-multiple-node-pools#add-a-node-pool-with-a-unique-subnet",
            "security": 1,
            "severity": "Medio",
            "simple": -2,
            "subcategory": "Prácticas recomendadas",
            "text": "Si usa Azure CNI, considere la posibilidad de usar diferentes subredes para NodePools",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "c3c39c98-6bb2-4c12-859a-114b5e3df584",
            "id": "06.02.01",
            "link": "https://learn.microsoft.com/azure/private-link/private-link-overview",
            "security": 1,
            "severity": "Medio",
            "simple": -1,
            "subcategory": "Costar",
            "text": "Use puntos de conexión privados (preferidos) o puntos de conexión de servicio de red virtual para acceder a los servicios PaaS desde el clúster",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "cost": -1,
            "guid": "e8a03f97-8794-468d-96a7-86d60f96c97b",
            "ha": 1,
            "id": "06.03.01",
            "link": "https://learn.microsoft.com/azure/expressroute/designing-for-disaster-recovery-with-expressroute-privatepeering",
            "severity": "Medio",
            "subcategory": "JA",
            "text": "Si se requiere conectividad híbrida, utilice 2xER o ER+VPN para una mejor disponibilidad",
            "waf": "Fiabilidad"
        },
        {
            "category": "Topología y conectividad de red",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (properties.networkProfile.networkPlugin=='azure') | distinct id,compliant",
            "guid": "a0f61565-9de5-458f-a372-49c831112dbd",
            "id": "06.04.01",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-network",
            "severity": "Alto",
            "simple": 1,
            "subcategory": "IPAM",
            "text": "Elija el mejor complemento de red de CNI para sus necesidades (se recomienda Azure CNI)",
            "waf": "Fiabilidad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "7faf12e7-0943-4f63-8472-2da29c2b1cd6",
            "id": "06.04.02",
            "link": "https://learn.microsoft.com/azure/aks/configure-azure-cni",
            "scale": 1,
            "severity": "Alto",
            "subcategory": "IPAM",
            "text": "Si usa CNI de Azure, ajuste el tamaño de la subred en consecuencia teniendo en cuenta el número máximo de pods por nodo",
            "waf": "Rendimiento"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "22f54b29-bade-43aa-b1e8-c38ec9366673",
            "id": "06.04.03",
            "link": "https://learn.microsoft.com/azure/aks/configure-azure-cni",
            "scale": 1,
            "severity": "Alto",
            "simple": -1,
            "subcategory": "IPAM",
            "text": "Si usa Azure CNI, compruebe el número máximo de pods o nodo (valor predeterminado 30)",
            "waf": "Rendimiento"
        },
        {
            "category": "Topología y conectividad de red",
            "description": "En el caso de las aplicaciones internas, las organizaciones suelen abrir toda la subred de AKS en sus firewalls. Esto también abre el acceso de red a los nodos y, potencialmente, también a los pods (si se usa Azure CNI). Si las direcciones IP de LoadBalancer están en una subred diferente, solo esta debe estar disponible para los clientes de la aplicación. Otra razón es que si las direcciones IP de la subred de AKS son un recurso escaso, el consumo de sus direcciones IP para los servicios reducirá la escalabilidad máxima del clúster.",
            "guid": "13c00567-4b1e-4945-a459-c373e7ed6162",
            "id": "06.04.04",
            "link": "https://learn.microsoft.com/azure/aks/internal-lb",
            "security": 1,
            "severity": "Bajo",
            "simple": -1,
            "subcategory": "IPAM",
            "text": "Si usa servicios de LoadBalancer de dirección IP privada, use una subred dedicada (no la subred de AKS)",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "43f63047-22d9-429c-8b1c-d622f54b29ba",
            "id": "06.04.05",
            "link": "https://learn.microsoft.com/azure/aks/configure-azure-cni",
            "scale": 1,
            "severity": "Alto",
            "subcategory": "IPAM",
            "text": "Dimensione el rango de direcciones IP del servicio en consecuencia (limitará la escalabilidad del clúster)",
            "waf": "Fiabilidad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "57bf217f-6dc8-481c-81e2-785773e9c00f",
            "id": "06.05.01",
            "link": "https://learn.microsoft.com/azure/aks/use-byo-cni",
            "security": 1,
            "severity": "Bajo",
            "simple": -2,
            "subcategory": "Operaciones",
            "text": "Si es necesario, agregue su propio complemento CNI",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "4b3bb365-9458-44d9-9ed1-5c8f52890364",
            "id": "06.05.02",
            "link": "https://learn.microsoft.com/azure/aks/use-multiple-node-pools#assign-a-public-ip-per-node-for-your-node-pools",
            "security": 1,
            "severity": "Bajo",
            "simple": -2,
            "subcategory": "Operaciones",
            "text": "Si es necesario, configure la dirección IP pública por nodo en AKS",
            "waf": "Rendimiento"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "b3808b9f-a1cf-4204-ad01-3a923ce474db",
            "id": "06.06.01",
            "link": "https://learn.microsoft.com/azure/aks/concepts-network",
            "scale": 1,
            "severity": "Medio",
            "simple": -1,
            "subcategory": "Escalabilidad",
            "text": "Use un controlador de entrada para exponer aplicaciones basadas en web en lugar de exponerlas con servicios de tipo LoadBalancer",
            "waf": "Fiabilidad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "ccb534e7-416e-4a1d-8e93-533b53199085",
            "id": "06.06.02",
            "link": "https://learn.microsoft.com/azure/aks/nat-gateway",
            "scale": 1,
            "severity": "Bajo",
            "simple": -1,
            "subcategory": "Escalabilidad",
            "text": "Uso de Azure NAT Gateway como outboundType para escalar el tráfico de salida",
            "waf": "Fiabilidad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "8ee9a69a-1b58-4b1e-9c61-476e110a160b",
            "id": "06.06.03",
            "link": "https://learn.microsoft.com/azure/aks/configure-azure-cni#dynamic-allocation-of-ips-and-enhanced-subnet-support",
            "scale": 1,
            "severity": "Medio",
            "simple": -1,
            "subcategory": "Escalabilidad",
            "text": "Uso de asignaciones dinámicas de direcciones IP para evitar el agotamiento de direcciones IP de Azure CNI",
            "waf": "Fiabilidad"
        },
        {
            "category": "Topología y conectividad de red",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (properties.networkProfile.outboundType=='userDefinedRouting') | distinct id,compliant",
            "guid": "3b365a91-7ecb-4e48-bbe5-4cd7df2e8bba",
            "id": "06.07.01",
            "link": "https://learn.microsoft.com/azure/aks/limit-egress-traffic",
            "security": 2,
            "severity": "Alto",
            "simple": -2,
            "subcategory": "Seguridad",
            "text": "Filtre el tráfico de salida con AzFW/NVA si sus requisitos de seguridad lo exigen",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = ((isnull(properties.apiServerAccessProfile.enablePrivateCluster) or properties.apiServerAccessProfile.enablePrivateCluster==false) and isnotnull(properties.apiServerAccessProfile.authorizedIPRanges)) | distinct id,compliant",
            "guid": "c4581559-bb91-463e-a908-aed8c44ce3b2",
            "id": "06.07.02",
            "link": "https://learn.microsoft.com/azure/aks/api-server-authorized-ip-ranges",
            "security": 1,
            "severity": "Medio",
            "simple": -1,
            "subcategory": "Seguridad",
            "text": "Si utiliza un punto de conexión de API público, restrinja las direcciones IP que pueden acceder a él",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "graph": "where type=='microsoft.containerservice/managedclusters' | where isnotnull(properties.apiServerAccessProfile.enablePrivateCluster) | extend compliant = (properties.apiServerAccessProfile.enablePrivateCluster==true) | distinct id, compliant",
            "guid": "ecccd979-3b6b-4cda-9b50-eb2eb03dda6d",
            "id": "06.07.03",
            "link": "https://learn.microsoft.com/azure/aks/private-clusters",
            "security": 1,
            "severity": "Alto",
            "simple": -1,
            "subcategory": "Seguridad",
            "text": "Utilice clústeres privados si sus requisitos lo exigen",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "graph": "where type=='microsoft.containerservice/managedclusters' | where isnotnull(properties.apiServerAccessProfile.enablePrivateCluster) | extend compliant = (properties.apiServerAccessProfile.enablePrivateCluster==true) | distinct id, compliant",
            "guid": "ce7f2a7c-297c-47c6-adea-a6ff838db665",
            "id": "06.07.04",
            "link": "https://learn.microsoft.com/azure/aks/use-network-policies",
            "security": 1,
            "severity": "Medio",
            "simple": -1,
            "subcategory": "Seguridad",
            "text": "Para los nodos de AKS de Windows 2019 y 2022, se pueden usar directivas de red de Calico ",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = isnotnull(properties.networkProfile.networkPolicy) | distinct id,compliant",
            "guid": "58d7c892-ddb1-407d-9769-ae669ca48e4a",
            "id": "06.07.05",
            "link": "https://learn.microsoft.com/azure/aks/use-network-policies",
            "security": 1,
            "severity": "Alto",
            "subcategory": "Seguridad",
            "text": "Habilitación de una opción de directiva de red de Kubernetes (Calico/Azure)",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "85e2223e-ce8b-4b12-907c-a5f16f158e3e",
            "id": "06.07.06",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-network",
            "security": 1,
            "severity": "Alto",
            "simple": -1,
            "subcategory": "Seguridad",
            "text": "Uso de directivas de red de Kubernetes para aumentar la seguridad dentro del clúster",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "cost": -1,
            "guid": "a3a92c2d-e7e2-4165-a3a8-7af4a7a1f893",
            "id": "06.07.07",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-network",
            "security": 2,
            "severity": "Alto",
            "simple": -1,
            "subcategory": "Seguridad",
            "text": "Uso de un WAF para cargas de trabajo web (interfaces de usuario o API)",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "cost": -2,
            "graph": "Resources | where type=~'microsoft.containerservice/managedclusters' | project resourceGroup,name,pools=properties.agentPoolProfiles | mv-expand pools | project subnetId=tostring(pools.vnetSubnetID) | where isnotempty(subnetId) | join (Resources | where type=='microsoft.network/virtualnetworks' | project id,resourceGroup,name,enableDdosProtection=tostring(properties.enableDdosProtection),subnets=properties.subnets | mv-expand subnets | project id,resourceGroup,name,enableDdosProtection,subnetId=tostring(subnets.id)) on subnetId | distinct id,resourceGroup,name,enableDdosProtection | extend compliant = (enableDdosProtection == 'true')",
            "guid": "9bda4776-8f24-4c11-9775-c2ea55b46a94",
            "id": "06.07.08",
            "link": "https://learn.microsoft.com/azure/virtual-network/ddos-protection-overview",
            "security": 2,
            "severity": "Medio",
            "subcategory": "Seguridad",
            "text": "Uso de DDoS Standard en la red virtual de AKS",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "cost": -2,
            "graph": "Resources | where type=~'microsoft.containerservice/managedclusters' | project resourceGroup,name,pools=properties.agentPoolProfiles | mv-expand pools | project subnetId=tostring(pools.vnetSubnetID) | where isnotempty(subnetId) | join (Resources | where type=='microsoft.network/virtualnetworks' | project id,resourceGroup,name,enableDdosProtection=tostring(properties.enableDdosProtection),subnets=properties.subnets | mv-expand subnets | project id,resourceGroup,name,enableDdosProtection,subnetId=tostring(subnets.id)) on subnetId | distinct id,resourceGroup,name,enableDdosProtection | extend compliant = (enableDdosProtection == 'true')",
            "guid": "6c46b91a-1107-4485-ad66-3183e2a8c266",
            "id": "06.07.09",
            "link": "https://learn.microsoft.com/azure/aks/http-proxy",
            "security": 2,
            "severity": "Bajo",
            "subcategory": "Seguridad",
            "text": "Si es necesario, agregue el proxy HTTP de la empresa",
            "waf": "Seguridad"
        },
        {
            "category": "Topología y conectividad de red",
            "guid": "e9855d04-c3c3-49c9-a6bb-2c12159a114b",
            "id": "06.07.10",
            "link": "https://learn.microsoft.com/azure/aks/servicemesh-about",
            "security": 1,
            "severity": "Medio",
            "simple": -2,
            "subcategory": "Seguridad",
            "text": "Considere la posibilidad de usar una malla de servicios para la administración avanzada de comunicaciones de microservicios",
            "waf": "Seguridad"
        },
        {
            "category": "Operaciones",
            "guid": "67f7a9ed-5b31-4f38-a3f3-9812b2463cff",
            "ha": 1,
            "id": "07.01.01",
            "link": "https://learn.microsoft.com/azure/azure-monitor/insights/container-insights-metric-alerts",
            "severity": "Alto",
            "simple": -1,
            "subcategory": "Alertas",
            "text": "Configurar alertas sobre las métricas más críticas (consulte Container Insights para obtener recomendaciones)",
            "waf": "Operaciones"
        },
        {
            "category": "Operaciones",
            "guid": "337453a3-cc63-4963-9a65-22ac19e80696",
            "ha": 1,
            "id": "07.02.01",
            "link": "https://learn.microsoft.com/azure/advisor/advisor-get-started",
            "severity": "Bajo",
            "simple": -1,
            "subcategory": "Conformidad",
            "text": "Consulte periódicamente Azure Advisor para obtener recomendaciones sobre el clúster",
            "waf": "Operaciones"
        },
        {
            "category": "Operaciones",
            "guid": "5388e9de-d167-4dd1-a2b0-ac241b999a64",
            "id": "07.02.02",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-scheduler",
            "severity": "Bajo",
            "simple": 1,
            "subcategory": "Conformidad",
            "text": "Desarrolle sus manifiestos YAML con editores de texto inteligentes como vscode+kubeadvisor",
            "waf": "Operaciones"
        },
        {
            "category": "Operaciones",
            "guid": "3aa70560-e7e7-4968-be3d-628af35b2ced",
            "id": "07.02.03",
            "link": "https://learn.microsoft.com/azure/aks/certificate-rotation",
            "severity": "Bajo",
            "simple": 1,
            "subcategory": "Conformidad",
            "text": "Habilitación de la rotación automática de certificados de AKS",
            "waf": "Operaciones"
        },
        {
            "category": "Operaciones",
            "guid": "e189c599-df0d-45a7-9dd4-ce32c1881370",
            "id": "07.02.04",
            "link": "https://learn.microsoft.com/azure/aks/supported-kubernetes-versions",
            "security": 1,
            "severity": "Alto",
            "simple": -1,
            "subcategory": "Conformidad",
            "text": "Tenga un proceso regular para actualizar la versión de Kubernetes periódicamente (trimestralmente, por ejemplo) o use la característica de actualización automática de AKS",
            "waf": "Operaciones"
        },
        {
            "category": "Operaciones",
            "guid": "6f7c4c0d-4e51-4464-ad24-57ed67138b82",
            "id": "07.02.05",
            "link": "https://learn.microsoft.com/azure/aks/node-updates-kured",
            "severity": "Alto",
            "simple": -1,
            "subcategory": "Conformidad",
            "text": "Utilice kured para las actualizaciones de nodos de Linux en caso de que no esté utilizando la actualización de imagen de nodo",
            "waf": "Operaciones"
        },
        {
            "category": "Operaciones",
            "guid": "139c9580-ade3-426a-ba09-cf157d9f6477",
            "id": "07.02.06",
            "link": "https://learn.microsoft.com/azure/aks/node-image-upgrade",
            "security": 1,
            "severity": "Alto",
            "simple": -1,
            "subcategory": "Conformidad",
            "text": "Disponer de un proceso regular para actualizar las imágenes de los nodos del clúster periódicamente (semanalmente, por ejemplo)",
            "waf": "Operaciones"
        },
        {
            "category": "Operaciones",
            "guid": "0102ce16-ee30-41e6-b882-e52e4621dd68",
            "id": "07.02.07",
            "link": "https://learn.microsoft.com/azure/architecture/example-scenario/bedrock/bedrock-automated-deployments",
            "severity": "Bajo",
            "subcategory": "Conformidad",
            "text": "Considere la posibilidad de implementar aplicaciones o configuraciones de clústeres en varios clústeres",
            "waf": "Operaciones"
        },
        {
            "category": "Operaciones",
            "guid": "d7672c26-7602-4482-85a4-14527fbe855c",
            "id": "07.02.08",
            "link": "https://learn.microsoft.com/azure/aks/command-invoke",
            "severity": "Bajo",
            "subcategory": "Conformidad",
            "text": "Considere la posibilidad de usar la invocación de comandos de AKS en clústeres privados",
            "waf": "Operaciones"
        },
        {
            "category": "Operaciones",
            "guid": "31d7aaab-7571-4449-ab80-53d89e89d17b",
            "id": "07.02.09",
            "link": "https://learn.microsoft.com/azure/aks/node-auto-repair#node-autodrain",
            "security": 1,
            "severity": "Bajo",
            "subcategory": "Conformidad",
            "text": "En el caso de los eventos planeados, considere la posibilidad de utilizar el drenaje automático de nodos",
            "waf": "Operaciones"
        },
        {
            "category": "Operaciones",
            "guid": "ed0fda7f-211b-47c7-8b6e-c18873fb473c",
            "id": "07.02.10",
            "link": "https://learn.microsoft.com/azure/aks/faq",
            "security": 1,
            "severity": "Alto",
            "subcategory": "Conformidad",
            "text": "Desarrollar sus propias prácticas de gobernanza para asegurarse de que los operadores no realicen cambios en el nodo RG (también conocido como 'infra RG')",
            "waf": "Operaciones"
        },
        {
            "category": "Operaciones",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (properties.nodeResourceGroup !startswith 'MC_') | distinct id,compliant",
            "guid": "73b32a5a-67f7-4a9e-b5b3-1f38c3f39812",
            "id": "07.02.11",
            "link": "https://learn.microsoft.com/azure/aks/cluster-configuration",
            "severity": "Bajo",
            "simple": 1,
            "subcategory": "Conformidad",
            "text": "Usar el nombre personalizado de Node RG (también conocido como 'Infra RG')",
            "waf": "Operaciones"
        },
        {
            "category": "Operaciones",
            "guid": "b2463cff-e189-4c59-adf0-d5a73dd4ce32",
            "ha": 1,
            "id": "07.02.12",
            "link": "https://kubernetes.io/docs/setup/release/notes/",
            "severity": "Medio",
            "simple": -1,
            "subcategory": "Conformidad",
            "text": "No use API de Kubernetes obsoletas en los manifiestos de YAML",
            "waf": "Operaciones"
        },
        {
            "category": "Operaciones",
            "guid": "c1881370-6f7c-44c0-b4e5-14648d2457ed",
            "ha": 1,
            "id": "07.02.13",
            "link": "https://learn.microsoft.com/azure-stack/aks-hci/adapt-apps-mixed-os-clusters",
            "severity": "Bajo",
            "simple": -1,
            "subcategory": "Conformidad",
            "text": "Nodos de Windows de Taint",
            "waf": "Operaciones"
        },
        {
            "category": "Operaciones",
            "guid": "67138b82-0102-4ce1-9ee3-01e6e882e52e",
            "id": "07.02.14",
            "link": "https://learn.microsoft.com/virtualization/windowscontainers/deploy-containers/version-compatibility?tabs=windows-server-20H2%2Cwindows-10-20H2",
            "severity": "Bajo",
            "subcategory": "Conformidad",
            "text": "Mantener el nivel de revisión de los contenedores de Windows sincronizado con el nivel de revisión del host",
            "waf": "Operaciones"
        },
        {
            "category": "Operaciones",
            "cost": -1,
            "description": "A través de la configuración de diagnóstico en el nivel de clúster",
            "guid": "5b56ad48-408f-4e72-934c-476ba280dcf5",
            "ha": 1,
            "id": "07.02.15",
            "link": "https://learn.microsoft.com/azure/aks/monitor-aks",
            "severity": "Bajo",
            "subcategory": "Conformidad",
            "text": "Envío de registros maestros (también conocidos como registros de API) a Azure Monitor o a la solución de administración de registros que prefiera",
            "waf": "Operaciones"
        },
        {
            "category": "Operaciones",
            "cost": 1,
            "guid": "c5a5b252-1e44-4a59-a9d2-399c4d7b68d0",
            "id": "07.03.01",
            "link": "https://learn.microsoft.com/azure/aks/spot-node-pool",
            "severity": "Bajo",
            "simple": -1,
            "subcategory": "Costar",
            "text": "Considere la posibilidad de crear grupos de nodos de acceso puntual para cargas de trabajo no urgentes",
            "waf": "Operaciones"
        },
        {
            "category": "Operaciones",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (isnotnull(properties.addonProfiles.aciConnectorLinux) and properties.addonProfiles.aciConnectorLinux.enabled==true) | distinct id,compliant",
            "guid": "c755562f-2b4e-4456-9b4d-874a748b662e",
            "id": "07.03.02",
            "link": "https://learn.microsoft.com/azure/aks/concepts-scale",
            "scale": 1,
            "severity": "Bajo",
            "simple": -1,
            "subcategory": "Costar",
            "text": "Considere la posibilidad de utilizar el nodo virtual de AKS para una ráfaga rápida",
            "waf": "Operaciones"
        },
        {
            "category": "Operaciones",
            "guid": "6f8389a7-f82c-4b8e-a8c0-aa63a25a4956",
            "ha": 1,
            "id": "07.04.01",
            "link": "https://learn.microsoft.com/azure/azure-monitor/insights/container-insights-overview",
            "severity": "Alto",
            "simple": -1,
            "subcategory": "Monitorización",
            "text": "Supervise las métricas de clúster con Container Insights (u otras herramientas como Prometheus)",
            "waf": "Operaciones"
        },
        {
            "category": "Operaciones",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (isnotnull(properties.addonProfiles.omsagent) and properties.addonProfiles.omsagent.enabled==true) | distinct id,compliant",
            "guid": "eaa8dc4a-2436-47b3-9697-15b1752beee0",
            "ha": 1,
            "id": "07.04.02",
            "link": "https://learn.microsoft.com/azure/azure-monitor/insights/container-insights-overview",
            "severity": "Alto",
            "simple": -1,
            "subcategory": "Monitorización",
            "text": "Almacene y analice los registros del clúster con Container Insights (u otras herramientas como Telegraf/ElasticSearch)",
            "waf": "Operaciones"
        },
        {
            "category": "Operaciones",
            "guid": "4621dd68-c5a5-4be2-bdb1-1726769ef669",
            "ha": 1,
            "id": "07.04.03",
            "link": "https://learn.microsoft.com/azure/azure-monitor/containers/container-insights-analyze",
            "severity": "Medio",
            "simple": -1,
            "subcategory": "Monitorización",
            "text": "Supervisar el uso de la CPU y la memoria de los nodos",
            "waf": "Operaciones"
        },
        {
            "category": "Operaciones",
            "guid": "1a4835ac-9422-423e-ae80-b123081a5417",
            "ha": 1,
            "id": "07.04.04",
            "link": "https://learn.microsoft.com/azure/aks/configure-azure-cni",
            "severity": "Medio",
            "simple": -1,
            "subcategory": "Monitorización",
            "text": "Si usa Azure CNI, supervise el porcentaje de direcciones IP de pod consumidas por nodo",
            "waf": "Operaciones"
        },
        {
            "category": "Operaciones",
            "description": "La E/S en el disco del sistema operativo es un recurso crítico. Si el sistema operativo de los nodos se limita en la E/S, esto podría dar lugar a un comportamiento impredecible, que normalmente terminaría en que el nodo se declarara NotReady",
            "guid": "415833ea-3ad3-4c2d-b733-165c3acbe04b",
            "ha": 1,
            "id": "07.04.05",
            "link": "https://learn.microsoft.com/azure/virtual-machines/premium-storage-performance",
            "severity": "Medio",
            "simple": -1,
            "subcategory": "Monitorización",
            "text": "Supervisión de la profundidad de la cola de disco del sistema operativo en los nodos",
            "waf": "Operaciones"
        },
        {
            "category": "Operaciones",
            "guid": "be209d39-fda4-4777-a424-d116785c2fa5",
            "ha": 1,
            "id": "07.04.06",
            "link": "https://learn.microsoft.com/azure/aks/load-balancer-standard",
            "severity": "Medio",
            "simple": -1,
            "subcategory": "Monitorización",
            "text": "Si no usa el filtrado de salida con AzFW/NVA, supervise los puertos SNAT asignados por ALB estándar",
            "waf": "Operaciones"
        },
        {
            "category": "Operaciones",
            "guid": "74c2ee76-569b-4a79-a57e-dedf91b022c9",
            "ha": 1,
            "id": "07.04.07",
            "link": "https://learn.microsoft.com/azure/aks/aks-resource-health",
            "severity": "Medio",
            "subcategory": "Monitorización",
            "text": "Suscríbase a las notificaciones de estado de los recursos para el clúster de AKS",
            "waf": "Operaciones"
        },
        {
            "category": "Operaciones",
            "guid": "b54eb2eb-03dd-4aa3-9927-18e2edb11726",
            "ha": 1,
            "id": "07.05.01",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-scheduler",
            "severity": "Alto",
            "simple": -1,
            "subcategory": "Recursos",
            "text": "Configurar solicitudes y límites en las especificaciones del pod",
            "waf": "Operaciones"
        },
        {
            "category": "Operaciones",
            "guid": "769ef669-1a48-435a-a942-223ece80b123",
            "ha": 1,
            "id": "07.05.02",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-scheduler",
            "severity": "Medio",
            "simple": -1,
            "subcategory": "Recursos",
            "text": "Aplicación de cuotas de recursos para espacios de nombres",
            "waf": "Operaciones"
        },
        {
            "category": "Operaciones",
            "cost": 1,
            "guid": "081a5417-4158-433e-a3ad-3c2de733165c",
            "id": "07.05.03",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits",
            "severity": "Alto",
            "subcategory": "Recursos",
            "text": "Asegúrese de que la suscripción tiene suficiente cuota para escalar horizontalmente los grupos de nodos",
            "waf": "Operaciones"
        },
        {
            "category": "Operaciones",
            "cost": -1,
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (isnotnull(properties.autoScalerProfile)) | distinct id,compliant",
            "guid": "90ce65de-8e13-4f9c-abd4-69266abca264",
            "ha": 1,
            "id": "07.06.01",
            "link": "https://learn.microsoft.com/azure/aks/concepts-scale",
            "severity": "Medio",
            "subcategory": "Escalabilidad",
            "text": "Uso del escalador automático de clústeres",
            "waf": "Rendimiento"
        },
        {
            "category": "Operaciones",
            "cost": -1,
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (isnotnull(properties.austoscalerProfile)) | distinct id,compliant",
            "guid": "831c2872-c693-4b39-a887-a561bada49bc",
            "ha": 1,
            "id": "07.06.02",
            "link": "https://learn.microsoft.com/azure/aks/custom-node-configuration",
            "severity": "Bajo",
            "subcategory": "Escalabilidad",
            "text": "Personalización de la configuración de nodos para grupos de nodos de AKS",
            "waf": "Rendimiento"
        },
        {
            "category": "Operaciones",
            "guid": "faa19bfe-9d55-4d04-a3c4-919ca1b2d121",
            "id": "07.06.03",
            "link": "https://learn.microsoft.com/azure/aks/concepts-scale",
            "scale": 1,
            "severity": "Medio",
            "simple": -1,
            "subcategory": "Escalabilidad",
            "text": "Usar el escalador automático horizontal de pods cuando sea necesario",
            "waf": "Rendimiento"
        },
        {
            "category": "Operaciones",
            "cost": 1,
            "description": "Los nodos más grandes aportarán un mayor rendimiento y características como discos efímeros y redes aceleradas, pero aumentarán el radio de explosión y disminuirán la granularidad de escalado",
            "guid": "5ae124ba-34df-4585-bcdc-e9bd3bb0cdb3",
            "id": "07.06.04",
            "link": "https://blog.cloudtrooper.net/2020/10/23/which-vm-size-should-i-choose-as-aks-node/",
            "severity": "Alto",
            "subcategory": "Escalabilidad",
            "text": "Considere un tamaño de nodo adecuado, ni demasiado grande ni demasiado pequeño",
            "waf": "Rendimiento"
        },
        {
            "category": "Operaciones",
            "cost": 1,
            "guid": "38800e6a-ae01-40a2-9fbc-ae5a06e5462d",
            "id": "07.06.05",
            "link": "https://learn.microsoft.com/azure/aks/quotas-skus-regions#service-quotas-and-limits",
            "severity": "Bajo",
            "subcategory": "Escalabilidad",
            "text": "Si se requieren más de 5000 nodos para la escalabilidad, considere la posibilidad de usar un clúster de AKS adicional",
            "waf": "Rendimiento"
        },
        {
            "category": "Operaciones",
            "cost": 1,
            "guid": "9583c0f6-6083-43f6-aa6b-df7102c901bb",
            "id": "07.06.06",
            "link": "https://learn.microsoft.com/azure/event-grid/event-schema-aks",
            "severity": "Bajo",
            "subcategory": "Escalabilidad",
            "text": "Considere la posibilidad de suscribirse a eventos de EventGrid para la automatización de AKS",
            "waf": "Rendimiento"
        },
        {
            "category": "Operaciones",
            "cost": 1,
            "guid": "c5016d8c-c6c9-4165-89ae-673ef0fff19d",
            "id": "07.06.07",
            "link": "https://learn.microsoft.com/azure/aks/manage-abort-operations",
            "severity": "Bajo",
            "subcategory": "Escalabilidad",
            "text": "Para una operación de ejecución prolongada en un clúster de AKS, considere la finalización de eventos",
            "waf": "Rendimiento"
        },
        {
            "category": "Operaciones",
            "cost": 1,
            "guid": "c4e37133-f186-4ce1-aed9-9f1b32f6e021",
            "id": "07.06.08",
            "link": "https://learn.microsoft.com/azure/aks/use-azure-dedicated-hosts",
            "severity": "Bajo",
            "subcategory": "Escalabilidad",
            "text": "Si es necesario, considere la posibilidad de usar Azure Dedicated Hosts para nodos de AKS",
            "waf": "Rendimiento"
        },
        {
            "category": "Operaciones",
            "cost": -1,
            "graph": "where type=='microsoft.containerservice/managedclusters' | project id,resourceGroup,name,pools=properties.agentPoolProfiles | mvexpand pools | extend compliant = (pools.osDiskType=='Ephemeral') | project id,name=strcat(name,'-',pools.name), resourceGroup, compliant",
            "guid": "24367b33-6971-45b1-952b-eee0b9b588de",
            "id": "07.07.01",
            "link": "https://learn.microsoft.com/azure/aks/cluster-configuration",
            "scale": 1,
            "severity": "Alto",
            "subcategory": "Almacenamiento",
            "text": "Usar discos de sistema operativo efímeros",
            "waf": "Rendimiento"
        },
        {
            "category": "Operaciones",
            "cost": -1,
            "guid": "fc4972cc-3cd2-45bf-a707-6e9eab4bed32",
            "id": "07.07.02",
            "link": "https://learn.microsoft.com/azure/virtual-machines/disks-types",
            "scale": 1,
            "severity": "Alto",
            "subcategory": "Almacenamiento",
            "text": "En el caso de los discos no efímeros, use IOPS altas y discos de sistema operativo más grandes para los nodos cuando ejecute muchos pods o nodos, ya que requiere un alto rendimiento para ejecutar varios pods y generará registros enormes con umbrales de rotación de registros de AKS predeterminados",
            "waf": "Rendimiento"
        },
        {
            "category": "Operaciones",
            "cost": -1,
            "guid": "39c486ce-d5af-4062-89d5-18bb5fd795db",
            "id": "07.07.03",
            "link": "https://learn.microsoft.com/azure/aks/use-ultra-disks",
            "scale": 1,
            "severity": "Bajo",
            "subcategory": "Almacenamiento",
            "text": "Para la opción de almacenamiento de hiperrendimiento, use discos Ultra en AKS",
            "waf": "Rendimiento"
        },
        {
            "category": "Operaciones",
            "guid": "9f7547c1-747d-4c56-868a-714435bd19dd",
            "ha": 1,
            "id": "07.07.04",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-multi-region",
            "severity": "Medio",
            "simple": -1,
            "subcategory": "Almacenamiento",
            "text": "Evite mantener el estado en el clúster y almacene los datos fuera (AzStorage, AzSQL, Cosmos, etc.)",
            "waf": "Rendimiento"
        },
        {
            "category": "Operaciones",
            "cost": -1,
            "guid": "24429eb7-2281-4376-85cc-57b4a4b18142",
            "id": "07.07.05",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-storage",
            "scale": 1,
            "severity": "Medio",
            "subcategory": "Almacenamiento",
            "text": "Si usa AzFiles Standard, considere AzFiles Premium o ANF por motivos de rendimiento",
            "waf": "Rendimiento"
        },
        {
            "category": "Operaciones",
            "guid": "83958a8c-2689-4b32-ab57-cfc64546135a",
            "ha": 1,
            "id": "07.07.06",
            "link": "https://learn.microsoft.com/azure/aks/availability-zones#azure-disk-availability-zone-support",
            "severity": "Medio",
            "simple": -1,
            "subcategory": "Almacenamiento",
            "text": "Si usa Azure Disks y AZ, considere la posibilidad de tener grupos de nodos dentro de una zona para el disco LRS con VolumeBindingMode:WaitForFirstConsumer para aprovisionar el almacenamiento en la zona correcta o use el disco ZRS para los grupos de nodos que abarquen varias zonas",
            "waf": "Rendimiento"
        }
    ],
    "metadata": {
        "name": "Azure AKS Review",
        "state": "GA",
        "timestamp": "October 20, 2023"
    },
    "severities": [
        {
            "name": "Alto"
        },
        {
            "name": "Medio"
        },
        {
            "name": "Bajo"
        }
    ],
    "status": [
        {
            "description": "Esta comprobación aún no se ha examinado",
            "name": "No verificado"
        },
        {
            "description": "Hay un elemento de acción asociado a esta comprobación",
            "name": "Abrir"
        },
        {
            "description": "Esta comprobación se ha verificado y no hay más elementos de acción asociados a ella",
            "name": "Cumplido"
        },
        {
            "description": "Recomendación entendida, pero no necesaria por los requisitos actuales",
            "name": "No es necesario"
        },
        {
            "description": "No aplicable para el diseño actual",
            "name": "N/A"
        }
    ],
    "waf": [
        {
            "name": "Fiabilidad"
        },
        {
            "name": "Seguridad"
        },
        {
            "name": "Costar"
        },
        {
            "name": "Operaciones"
        },
        {
            "name": "Rendimiento"
        }
    ]
}
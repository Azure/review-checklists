{
    "items": [
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "f00a69de-7076-4734-a734-6e4552cad9e1",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-latest-version-for-customer-managed-certificates",
            "service": "Front Door",
            "severity": "Medio",
            "text": "Si usa certificados TLS administrados por el cliente con Azure Front Door, use la versión de certificado \"más reciente\". Reduzca el riesgo de interrupciones causadas por la renovación manual de certificados",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "graph": "resources | where type == 'microsoft.network/applicationgateways' | project id, compliant = properties.sku.name in ('Standard_v2', 'WAF_v2') | project id,compliant",
            "guid": "553585a6-abe0-11ed-afa1-0242ac120002",
            "link": "https://learn.microsoft.com/azure/application-gateway/overview-v2",
            "service": "App Gateway",
            "severity": "Medio",
            "text": "Asegúrese de que usa la SKU de Application Gateway v2",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "graph": "resources | where type == 'microsoft.network/loadbalancers' | project id, compliant=(tolower(sku.name) == 'standard')",
            "guid": "4e35fbf5-0ae2-48b2-97ce-753353edbd1a",
            "link": "https://learn.microsoft.com/azure/load-balancer/load-balancer-overview",
            "service": "Load Balancer",
            "severity": "Medio",
            "text": "Asegúrese de que usa la SKU estándar para Azure Load Balancers",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "9432621a-8397-4654-a882-5bc856b7ef83",
            "link": "https://learn.microsoft.com/azure/load-balancer/load-balancer-standard-availability-zones",
            "service": "Load Balancer",
            "severity": "Medio",
            "text": "Asegúrese de que las direcciones IP de front-end de Load Balancers tengan redundancia de zona (a menos que necesite front-end zonal).",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "graph": "resources | where type=='microsoft.network/applicationgateways' | extend subnetId = tostring(properties.gatewayIPConfigurations[0].properties.subnet.id) | project id, subnetId | join (resources | where type=='microsoft.network/virtualnetworks' | project id,subnets=properties.subnets | mv-expand subnets | mv-expand subnets.properties.addressPrefixes | project id, subnetId = tostring(subnets.id), prefix1 = subnets.properties.addressPrefix, prefix2 = subnets.properties.addressPrefixes | mv-expand prefix2 | extend prefix = iff(isnotnull(prefix1), prefix1, prefix2) | extend subnetPrefixLength = split(prefix, '/')[1])on subnetId | extend compliant = (subnetPrefixLength <= 24 or subnetPrefixLength == 64) | distinct id,compliant",
            "guid": "dfc50f87-3800-424c-937b-ed5f186e7c15",
            "link": "https://learn.microsoft.com/azure/application-gateway/configuration-infrastructure#size-of-the-subnet",
            "service": "App Gateway",
            "severity": "Medio",
            "text": "Application Gateways v2 debe implementarse en subredes con prefijos IP iguales o mayores que /24",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "description": "La administración de proxies inversos en general y de WAF en particular está más cerca de la aplicación que de la red, por lo que pertenecen a la misma suscripción que la aplicación. La centralización de Application Gateway y WAF en la suscripción de conectividad puede ser correcta si la administra un solo equipo.",
            "guid": "48b662d6-d15f-4512-a654-98f6dfe237de",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "service": "App Gateway",
            "severity": "Medio",
            "text": "Implemente Azure Application Gateway v2 o aplicaciones virtuales de red de asociados que se usan para proxy de conexiones HTTP(S) entrantes dentro de la red virtual de la zona de aterrizaje y con las aplicaciones que están protegiendo.",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "f109e1f3-c79b-4f14-82de-6b5c22314d08",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "service": "App Gateway",
            "severity": "Medio",
            "text": "Use una red DDoS o planes de protección IP para todas las direcciones IP públicas en las zonas de aterrizaje de la aplicación.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "graph": "resources | where type =~ 'microsoft.network/applicationGateways' | extend compliant = (isnotnull(properties.autoscaleConfiguration) and properties.autoscaleConfiguration.minCapacity >= 2) | distinct id,compliant",
            "guid": "135bf4ac-f9db-461f-b76b-2ee9e30b12c0",
            "link": "https://learn.microsoft.com/azure/application-gateway/application-gateway-autoscaling-zone-redundant",
            "service": "App Gateway",
            "severity": "Medio",
            "text": "Configure el escalado automático con una cantidad mínima de instancias de dos.",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "Fiabilidad"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "graph": "resources | where type =~ 'microsoft.network/applicationGateways' | extend compliant = (isnotnull(zones) and array_length(zones) > 1) | distinct id,compliant",
            "guid": "060c6964-52b5-48db-af8b-83e4b2d85349",
            "link": "https://learn.microsoft.com/azure/reliability/migrate-app-gateway-v2",
            "service": "App Gateway",
            "severity": "Medio",
            "text": "Implementación de Application Gateway en zonas de disponibilidad",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "Fiabilidad"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "e79d17b7-3b22-4a5a-97e7-a8ed4b30e38c",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "service": "Front Door",
            "severity": "Medio",
            "text": "Use Azure Front Door con directivas de WAF para entregar y ayudar a proteger aplicaciones HTTP/S globales que abarcan varias regiones de Azure.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "3f29812b-2363-4cef-b179-b599de0d5973",
            "link": "https://learn.microsoft.com/azure/ddos-protection/ddos-protection-overview",
            "service": "Front Door",
            "severity": "Medio",
            "text": "Al usar Front Door y Application Gateway para ayudar a proteger las aplicaciones HTTP/S, use directivas de WAF en Front Door. Bloquee Application Gateway para recibir tráfico solo de Front Door.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Seguridad"
        },
        {
            "ammp": true,
            "arm-service": "microsoft.network/trafficManagerProfiles",
            "checklist": "Azure Application Delivery Networking",
            "guid": "cd4cd21b-0881-437f-9e6c-4cfd3e504547",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "service": "Traffic Manager",
            "severity": "Alto",
            "text": "Use el Administrador de tráfico para entregar aplicaciones globales que abarquen protocolos distintos de HTTP/S.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Fiabilidad"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "3b4b3e88-a459-4ed5-a22f-644dfbc58204",
            "link": "https://learn.microsoft.com/azure/active-directory/app-proxy/application-proxy#how-application-proxy-works",
            "service": "Entra",
            "severity": "Bajo",
            "text": "Si los usuarios solo necesitan acceso a aplicaciones internas, ¿se ha considerado Microsoft Entra ID Application Proxy como una alternativa a Azure Virtual Desktop (AVD)?",
            "training": "https://learn.microsoft.com/learn/modules/configure-azure-ad-application-proxy/",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "01ca7cf1-5754-442d-babb-8ba6772e5c30",
            "link": "https://learn.microsoft.com/azure/active-directory/app-proxy/application-proxy#how-application-proxy-works",
            "service": "Entra",
            "severity": "Medio",
            "text": "Para reducir el número de puertos de firewall abiertos para las conexiones entrantes en la red, considere la posibilidad de usar Microsoft Entra ID Application Proxy para proporcionar a los usuarios remotos acceso seguro y autenticado a las aplicaciones internas.",
            "training": "https://learn.microsoft.com/learn/paths/implement-applications-external-access-azure-ad/",
            "waf": "Seguridad"
        },
        {
            "ammp": true,
            "checklist": "Azure Application Delivery Networking",
            "graph": "resources | where type == 'microsoft.network/frontdoorwebapplicationfirewallpolicies' | project policyName=name, policyId=id,policySku=sku.name, links=properties.securityPolicyLinks, enabledState=properties.policySettings.enabledState, mode=properties.policySettings.mode | mvexpand links | extend securityPolicy=links.id | extend securityPolicyParts=split(securityPolicy, '/') | extend profileId=strcat_array(array_slice(securityPolicyParts, 0, -3), '/') | project id=profileId, compliant=((enabledState=='Enabled') and (mode=='Prevention')), enabledState, mode",
            "guid": "ae248989-b306-4591-9186-de482e3f0f0e",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-policy-settings",
            "service": "Front Door",
            "severity": "Alto",
            "text": "Implemente la directiva de WAF para Front Door en modo de \"prevención\".",
            "waf": "Seguridad"
        },
        {
            "ammp": true,
            "checklist": "Azure Application Delivery Networking",
            "guid": "062d5839-4d36-402f-bfa4-02811eb936e9",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#avoid-combining-traffic-manager-and-front-door",
            "service": "Front Door",
            "severity": "Alto",
            "text": "Evite combinar Azure Traffic Manager y Azure Front Door.",
            "waf": "Seguridad"
        },
        {
            "ammp": true,
            "checklist": "Azure Application Delivery Networking",
            "guid": "5efeb96a-003f-4b18-8fcd-b4d84459c2b2",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-the-same-domain-name-on-front-door-and-your-origin",
            "service": "Front Door",
            "severity": "Alto",
            "text": "Use el mismo nombre de dominio en Azure Front Door y su origen. Los nombres de host no coincidentes pueden causar errores sutiles.",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "graph": "cdnresources | where type =~ 'microsoft.cdn/profiles/origingroups/origins' | extend frontDoorId = substring(id, 0, indexof(id, '/origingroups')) | extend originGroupId = substring(id, 0, indexof(id, '/origins')) | join kind=inner (cdnresources | where type =~ 'microsoft.cdn/profiles/origingroups' | extend originGroupName = name | extend hasHealthProbe = isnotnull(properties.healthProbeSettings)) on $left.originGroupId == $right.id | summarize numberOrigins = count() by originGroupId, subscriptionId, frontDoorId, hasHealthProbe, originGroupName | extend compliant = not(numberOrigins == 1 and hasHealthProbe) | project id = frontDoorId, compliant",
            "guid": "0b5a380c-4bfb-47bc-b1d7-dcfef363a61b",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#disable-health-probes-when-theres-only-one-origin-in-an-origin-group",
            "service": "Front Door",
            "severity": "Bajo",
            "text": "Deshabilite los sondeos de estado cuando solo haya un origen en un grupo de orígenes de Azure Front Door.",
            "waf": "Rendimiento"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "5567048e-e5d7-4206-9c55-b5ed45d2cc0c",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#select-good-health-probe-endpoints",
            "service": "Front Door",
            "severity": "Medio",
            "text": "Seleccione puntos de conexión de sondeo de estado correctos para Azure Front Door. Considere la posibilidad de crear puntos de conexión de estado que comprueben todas las dependencias de la aplicación.",
            "waf": "Fiabilidad"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "graph": "cdnresources | where type =~ 'microsoft.cdn/profiles/origingroups' | extend frontDoorId = substring(id, 0, indexof(id, '/origingroups/')) | extend compliant = (isnull(properties['healthProbeSettings']['probeRequestType']) or toupper(properties['healthProbeSettings']['probeRequestType']) == 'HEAD') | project compliant, id=frontDoorId",
            "guid": "a13f72f3-8f5c-4864-95e5-75bf37fbbeb1",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-head-health-probes",
            "service": "Front Door",
            "severity": "Bajo",
            "text": "Use sondeos de estado de HEAD con Azure Front Door para reducir el tráfico que Front Door envía a la aplicación.",
            "waf": "Rendimiento"
        },
        {
            "ammp": true,
            "checklist": "Azure Application Delivery Networking",
            "graph": "resources | where type=='microsoft.network/loadbalancers' | extend countOutRules=array_length(properties.outboundRules) | extend compliant = (countOutRules == 0) | distinct id,compliant",
            "guid": "97a2fd46-64b0-1dfa-b72d-9c8869496d75",
            "link": "https://learn.microsoft.com/azure/nat-gateway/nat-overview#outbound-connectivity",
            "service": "Load Balancer",
            "severity": "Alto",
            "text": "Use Azure NAT Gateway en lugar de reglas de salida de Load Balancer para mejorar la escalabilidad de SNAT",
            "waf": "Fiabilidad"
        },
        {
            "ammp": true,
            "checklist": "Azure Application Delivery Networking",
            "graph": "cdnresources | where type =~ 'microsoft.cdn/profiles/customdomains' | extend frontDoorId = substring(id, 0, indexof(id, '/customdomains')) | extend compliant = (isnull(properties['tlsSettings']['certificateType']) or tolower(properties['tlsSettings']['certificateType']) =~ 'customercertificate') | project compliant, id = frontDoorId",
            "guid": "af95c92d-d723-4f4a-98d7-8722324efd4d",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-managed-tls-certificates",
            "service": "Front Door",
            "severity": "Alto",
            "text": "Use certificados TLS administrados con Azure Front Door. Reduzca los costos operativos y el riesgo de interrupciones debido a las renovaciones de certificados.",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "189ea962-3969-4863-8f5a-5ad808c2cf4b",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#define-your-waf-configuration-as-code",
            "service": "Front Door",
            "severity": "Medio",
            "text": "Defina la configuración de WAF de Azure Front Door como código. Mediante el uso de código, puede adoptar más fácilmente una nueva versión del conjunto de reglas y obtener protección adicional.",
            "waf": "Operaciones"
        },
        {
            "ammp": true,
            "checklist": "Azure Application Delivery Networking",
            "guid": "2e30abab-5478-417c-81bf-bf1ad4ed1ed4",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-end-to-end-tls",
            "service": "Front Door",
            "severity": "Alto",
            "text": "Use TLS de un extremo a otro con Azure Front Door. Use TLS para las conexiones de los clientes a Front Door y de Front Door al origen.",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "10aa45af-166f-44c4-9f36-b6d592dac2ca",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-http-to-https-redirection",
            "service": "Front Door",
            "severity": "Medio",
            "text": "Use el redireccionamiento de HTTP a HTTPS con Azure Front Door. Apoye a los clientes más antiguos redirigiéndolos automáticamente a una solicitud HTTPS.",
            "waf": "Seguridad"
        },
        {
            "ammp": true,
            "checklist": "Azure Application Delivery Networking",
            "guid": "28b9ee82-b2c7-45aa-bc98-6de6f59a095d",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#enable-the-waf",
            "service": "Front Door",
            "severity": "Alto",
            "text": "Habilite el WAF de Azure Front Door. Proteja su aplicación de una variedad de ataques.",
            "waf": "Seguridad"
        },
        {
            "ammp": true,
            "checklist": "Azure Application Delivery Networking",
            "guid": "2902d8cc-1b0c-4495-afad-624ab70f7bd6",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#tune-your-waf",
            "service": "Front Door",
            "severity": "Alto",
            "text": "Ajuste el WAF de Azure Front Door para su carga de trabajo. Reduzca las detecciones de falsos positivos.",
            "waf": "Seguridad"
        },
        {
            "ammp": true,
            "checklist": "Azure Application Delivery Networking",
            "guid": "17ba124b-127d-42b6-9322-388d5b2bbcfc",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/application-gateway-waf-request-size-limits#request-body-inspection",
            "service": "Front Door",
            "severity": "Alto",
            "text": "Habilite la característica de inspección del cuerpo de la solicitud habilitada en la directiva WAF de Azure Front Door.",
            "waf": "Seguridad"
        },
        {
            "ammp": true,
            "checklist": "Azure Application Delivery Networking",
            "guid": "49a98f2b-ec22-4a87-9415-6a10b00d6555",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#enable-default-rule-sets",
            "service": "Front Door",
            "severity": "Alto",
            "text": "Habilite los conjuntos de reglas predeterminados de WAF de Azure Front Door. Los conjuntos de reglas predeterminados detectan y bloquean los ataques comunes.",
            "waf": "Seguridad"
        },
        {
            "ammp": true,
            "checklist": "Azure Application Delivery Networking",
            "guid": "147a13d4-2a2f-4824-a524-f5855b52b946",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#enable-bot-management-rules",
            "service": "Front Door",
            "severity": "Alto",
            "text": "Habilite el conjunto de reglas de protección contra bots de Azure Front Door WAF. Las reglas de bots detectan bots buenos y malos.",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "d7dcdcb9-0d99-44b9-baab-ac7570ede79a",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#use-the-latest-ruleset-versions",
            "service": "Front Door",
            "severity": "Medio",
            "text": "Use la versión más reciente del conjunto de reglas de WAF de Azure Front Door. Las actualizaciones del conjunto de reglas se actualizan periódicamente para tener en cuenta el panorama actual de amenazas.",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "b9620385-1cde-418f-914b-a84a06982ffc",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#add-rate-limiting",
            "service": "Front Door",
            "severity": "Medio",
            "text": "Agregue limitación de velocidad al WAF de Azure Front Door. La limitación de velocidad bloquea a los clientes que envían accidental o intencionadamente grandes cantidades de tráfico en un corto período de tiempo.",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "6dc36c52-0124-4ffe-9eaf-23ec1282dedb",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#use-a-high-threshold-for-rate-limits",
            "service": "Front Door",
            "severity": "Medio",
            "text": "Use un umbral alto para los límites de frecuencia de WAF de Azure Front Door. Los umbrales de límite de velocidad altos evitan el bloqueo del tráfico legítimo, a la vez que proporcionan protección contra un número extremadamente alto de solicitudes que podrían sobrecargar su infraestructura. ",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "388a3d0e-0a43-4367-90b2-3dd2aeece5ee",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#geo-filter-traffic",
            "service": "Front Door",
            "severity": "Bajo",
            "text": "Si no espera tráfico de todas las regiones geográficas, utilice filtros geográficos para bloquear el tráfico de países no esperados.",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "00acd8a9-6975-414f-8491-2be6309893b8",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#specify-the-unknown-zz-location",
            "service": "Front Door",
            "severity": "Medio",
            "text": "Especifique la ubicación desconocida (ZZ) al filtrar geográficamente el tráfico con el WAF de Azure Front Door. Evite bloquear accidentalmente solicitudes legítimas cuando las direcciones IP no puedan coincidir geográficamente.",
            "waf": "Seguridad"
        },
        {
            "ammp": true,
            "checklist": "Azure Application Delivery Networking",
            "graph": "resources | where type == 'microsoft.network/applicationgatewaywebapplicationfirewallpolicies' | mv-expand properties.managedRules.managedRuleSets | project id, rulesettype = properties_managedRules_managedRuleSets.ruleSetType | extend compliant1 = (rulesettype == 'Microsoft_BotManagerRuleSet') | project id, compliant1 | summarize compliant = max(compliant1) by id",
            "guid": "2f8e81eb-8e68-4026-8b1f-70f9b05f7cf9",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/bot-protection",
            "service": "App Gateway",
            "severity": "Alto",
            "text": "Habilitación del conjunto de reglas de protección contra bots de WAF de Azure Application Gateway Las reglas de bots detectan bots buenos y malos.",
            "waf": "Seguridad"
        },
        {
            "ammp": true,
            "checklist": "Azure Application Delivery Networking",
            "guid": "8ea8e0d4-84e8-4b33-aeab-493f6391b4d6",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/application-gateway-waf-request-size-limits#request-body-inspection",
            "service": "App Gateway",
            "severity": "Alto",
            "text": "Habilite la característica de inspección del cuerpo de la solicitud habilitada en la directiva WAF de Azure Application Gateway.",
            "waf": "Seguridad"
        },
        {
            "ammp": true,
            "checklist": "Azure Application Delivery Networking",
            "guid": "a4dd86d3-5ffa-408c-b660-cce073d085b8",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/best-practices#tune-your-waf",
            "service": "App Gateway",
            "severity": "Alto",
            "text": "Ajuste el WAF de Azure Application Gateway para la carga de trabajo. Reduzca las detecciones de falsos positivos.",
            "waf": "Seguridad"
        },
        {
            "ammp": true,
            "checklist": "Azure Application Delivery Networking",
            "graph": "resources | where type == 'microsoft.network/frontdoorwebapplicationfirewallpolicies' | project policyName=name, policyId=id,policySku=sku.name, links=properties.securityPolicyLinks, enabledState=properties.policySettings.enabledState, mode=properties.policySettings.mode | mvexpand links | extend securityPolicy=links.id | extend securityPolicyParts=split(securityPolicy, '/') | extend profileId=strcat_array(array_slice(securityPolicyParts, 0, -3), '/') | project id=profileId, compliant=((enabledState=='Enabled') and (mode=='Prevention')), enabledState, mode",
            "guid": "baf8e317-2397-4d49-b3d1-0dcc16d8778d",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-policy-settings",
            "service": "App Gateway",
            "severity": "Alto",
            "text": "Implemente la directiva de WAF para Application Gateway en modo de \"prevención\".",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "43fae595-8a32-4299-a69e-0f32c454dcc9",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/rate-limiting-overview",
            "service": "App Gateway",
            "severity": "Medio",
            "text": "Agregue limitación de velocidad al WAF de Azure Application Gateway. La limitación de velocidad bloquea a los clientes que envían accidental o intencionadamente grandes cantidades de tráfico en un corto período de tiempo.",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "041e0ad8-7b12-4694-a0b7-a0e25ee2470f",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/rate-limiting-overview#rate-limiting-details",
            "service": "App Gateway",
            "severity": "Medio",
            "text": "Use un umbral alto para los límites de frecuencia de WAF de Azure Application Gateway. Los umbrales de límite de velocidad altos evitan el bloqueo del tráfico legítimo, a la vez que proporcionan protección contra un número extremadamente alto de solicitudes que podrían sobrecargar su infraestructura. ",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "99937189-ff78-492a-b9ca-18d828d82b37",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/best-practices#geo-filtering-best-practices",
            "service": "App Gateway",
            "severity": "Bajo",
            "text": "Si no espera tráfico de todas las regiones geográficas, utilice filtros geográficos para bloquear el tráfico de países no esperados.",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "349a15c1-52f4-4319-9078-3895d95ecafd",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/geomatch-custom-rules",
            "service": "App Gateway",
            "severity": "Medio",
            "text": "Especifique la ubicación desconocida (ZZ) al filtrar geográficamente el tráfico con el WAF de Azure Application Gateway. Evite bloquear accidentalmente solicitudes legítimas cuando las direcciones IP no puedan coincidir geográficamente.",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "6c19dfd5-a61c-436c-9001-491b9b3d0228",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/best-practices#use-the-latest-ruleset-versions",
            "service": "App Gateway",
            "severity": "Medio",
            "text": "Use la versión más reciente del conjunto de reglas de WAF de Azure Application Gateway. Las actualizaciones del conjunto de reglas se actualizan periódicamente para tener en cuenta el panorama actual de amenazas.",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "f84106a2-2e9e-42ac-add6-d3416ecfed53",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/best-practices#add-diagnostic-settings-to-save-your-wafs-logs",
            "service": "App Gateway",
            "severity": "Medio",
            "text": "Agregue la configuración de diagnóstico para guardar los registros de WAF de Azure Application Gateway.",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "4cea4050-7946-4a7c-89e6-b021b73c352d",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#add-diagnostic-settings-to-save-your-wafs-logs",
            "service": "Front Door",
            "severity": "Medio",
            "text": "Agregue la configuración de diagnóstico para guardar los registros de WAF de Azure Front Door.",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "92664c60-47e3-4591-8b1b-8d557656e686",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/best-practices#send-logs-to-microsoft-sentinel",
            "service": "App Gateway",
            "severity": "Medio",
            "text": "Envíe registros de WAF de Azure Application Gateway a Microsoft Sentinel.",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "845f5f91-9c21-4674-a725-5ce890850e20",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#send-logs-to-microsoft-sentinel",
            "service": "Front Door",
            "severity": "Medio",
            "text": "Envíe registros de WAF de Azure Front Door a Microsoft Sentinel.",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "ba0e9b26-6e0d-4ec8-8541-023c00afd5b7",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/best-practices#define-your-waf-configuration-as-code",
            "service": "App Gateway",
            "severity": "Medio",
            "text": "Defina la configuración de WAF de Azure Application Gateway como código. Mediante el uso de código, puede adoptar más fácilmente una nueva versión del conjunto de reglas y obtener protección adicional.",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "f17ec301-8470-4afd-aabc-c1fdfe47dcc0",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/policy-overview",
            "service": "App Gateway",
            "severity": "Medio",
            "text": "Utilice directivas de WAF en lugar de la configuración de WAF heredada.",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "d4eb8667-f8cb-4cdd-94e6-2f967ba98f88",
            "link": "https://learn.microsoft.com/azure/virtual-wan/scenario-secured-hub-app-gateway",
            "service": "App Gateway",
            "severity": "Medio",
            "text": "Filtre el tráfico entrante en los back-end para que solo acepten conexiones de la subred de Application Gateway, por ejemplo, con grupos de seguridad de red.",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "7d3df025-59a3-447d-ac25-3f5750d35de1",
            "link": "https://learn.microsoft.com/azure/frontdoor/origin-security?tabs=app-service-functions",
            "service": "Front Door",
            "severity": "Medio",
            "text": "Asegúrese de que los orígenes solo toman tráfico de la instancia de Azure Front Door.",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "a66f0fd8-2ca4-422e-8df3-235148127ca2",
            "link": "https://learn.microsoft.com/azure/application-gateway/ssl-overview",
            "service": "App Gateway",
            "severity": "Alto",
            "text": "Debe cifrar el tráfico a los servidores backend.",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "3dba65cb-834d-44d8-a3ca-a6aa2f1587be",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/overview",
            "service": "App Gateway",
            "severity": "Alto",
            "text": "Debe utilizar un firewall de aplicaciones web.",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "0158fcb6-0bc1-4687-832f-cc7c359c22d2",
            "link": "https://learn.microsoft.com/azure/application-gateway/redirect-overview",
            "service": "App Gateway",
            "severity": "Medio",
            "text": "Redirigir HTTP a HTTPS",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "bb697864-1b4c-43af-8667-90cc69aaed5f",
            "link": "https://learn.microsoft.com/azure/application-gateway/how-application-gateway-works#modifications-to-the-request",
            "service": "App Gateway",
            "severity": "Medio",
            "text": "Utilice cookies administradas por puerta de enlace para dirigir el tráfico de una sesión de usuario al mismo servidor para su procesamiento",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "ff353ad8-15fb-4ae8-9fc5-a85a36d36a35",
            "link": "https://learn.microsoft.com/azure/application-gateway/configuration-http-settings",
            "service": "App Gateway",
            "severity": "Alto",
            "text": "Habilite el drenaje de conexiones durante las actualizaciones de servicio planificadas para evitar la pérdida de conexión a los miembros existentes del grupo de back-end",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "c8741f03-45a4-4183-a6b8-139e0773b8b5",
            "link": "https://learn.microsoft.com/azure/application-gateway/custom-error",
            "service": "App Gateway",
            "severity": "Bajo",
            "text": "Crear páginas de error personalizadas para mostrar una experiencia de usuario personalizada",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "f850d46f-f5d7-4b17-b48c-a780741402e1",
            "link": "https://learn.microsoft.com/azure/application-gateway/rewrite-http-headers-url",
            "service": "App Gateway",
            "severity": "Medio",
            "text": "Edite las solicitudes HTTP y los encabezados de respuesta para facilitar el enrutamiento y el intercambio de información entre el cliente y el servidor",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "eadc3164-4a0f-461c-85f1-1a372c04dfd1",
            "link": "https://learn.microsoft.com/azure/frontdoor/front-door-overview",
            "service": "App Gateway",
            "severity": "Medio",
            "text": "Configure Front Door para optimizar el enrutamiento del tráfico web global y el rendimiento del usuario final de primer nivel, así como la confiabilidad a través de una rápida conmutación por error global",
            "waf": "Rendimiento"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "29dcc19f-a8fa-4c35-8281-290577538793",
            "link": "https://learn.microsoft.com/azure/load-balancer/load-balancer-overview",
            "service": "App Gateway",
            "severity": "Medio",
            "text": "Usar el equilibrio de carga de la capa de transporte",
            "waf": "Rendimiento"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "276898c1-af5e-4819-9e8e-049c7801ab9d",
            "link": "https://learn.microsoft.com/azure/application-gateway/multiple-site-overview",
            "service": "App Gateway",
            "severity": "Medio",
            "text": "Configure el enrutamiento basado en el host o el nombre de dominio para varias aplicaciones web en una sola puerta de enlace",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "5fe365b6-58e8-47ed-a8cf-5163850380a2",
            "link": "https://learn.microsoft.com/azure/application-gateway/create-ssl-portal",
            "service": "App Gateway",
            "severity": "Medio",
            "text": "Centralice la administración de certificados SSL para reducir la sobrecarga de cifrado y descifrado de una granja de servidores back-end",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Application Delivery Networking",
            "guid": "fa64b4dd-35c2-4047-ac5c-45dfbf8b0db9",
            "link": "https://learn.microsoft.com/azure/application-gateway/application-gateway-websocket",
            "service": "App Gateway",
            "severity": "Bajo",
            "text": "Uso de Application Gateway para obtener compatibilidad nativa con los protocolos WebSocket y HTTP/2",
            "waf": "Seguridad"
        },
        {
            "checklist": "Logic Apps checklist",
            "guid": "cb26b2ba-a9db-45d1-8260-d9c6ec1447d9",
            "link": "https://learn.microsoft.com/en-us/azure/logic-apps/single-tenant-overview-compare",
            "service": "Logic Apps",
            "severity": "Alto",
            "text": "Seleccione el plan de hospedaje de aplicaciones lógicas adecuado en función de los requisitos empresariales y de SLO",
            "waf": "Fiabilidad"
        },
        {
            "checklist": "Logic Apps checklist",
            "guid": "f6dd7977-1123-4f39-b488-f91415a8430a",
            "link": "https://learn.microsoft.com/en-us/azure/logic-apps/set-up-zone-redundancy-availability-zones?tabs=standard#next-steps",
            "service": "Logic Apps",
            "severity": "Alto",
            "text": "Proteja las aplicaciones lógicas de errores de región con redundancia de zona y zonas de disponibilidad",
            "waf": "Fiabilidad"
        },
        {
            "checklist": "Logic Apps checklist",
            "guid": "8aed4fbf-0830-4883-899d-222a154af478",
            "link": "https://learn.microsoft.com/en-us/azure/logic-apps/business-continuity-disaster-recovery-guidance?toc=%2Fazure%2Freliability%2Ftoc.json&bc=%2Fazure%2Freliability%2Fbreadcrumb%2Ftoc.json",
            "service": "Logic Apps",
            "severity": "Alto",
            "text": "Considere la posibilidad de una estrategia de recuperación ante desastres entre regiones para cargas de trabajo críticas",
            "waf": "Fiabilidad"
        },
        {
            "checklist": "Logic Apps checklist",
            "guid": "da0f033e-d180-4f36-9aa4-c468dba14203",
            "link": "https://learn.microsoft.com/en-us/azure/app-service/environment/intro",
            "service": "Logic Apps",
            "severity": "Alto",
            "text": "Si se implementa en un entorno aislado, use o migre a App Service Environment (ASE) v3",
            "waf": "Fiabilidad"
        },
        {
            "checklist": "Logic Apps checklist",
            "guid": "62711604-c9d1-4b0a-bdb7-5fda54a4f6c1",
            "link": "https://learn.microsoft.com/en-us/training/modules/deploy-azure-functions/",
            "service": "Logic Apps",
            "severity": "Medio",
            "text": "Aproveche Azure DevOps o GitHub para simplificar la CI/CD y proteger el código de la aplicación lógica",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "Aplicación de las instrucciones de la prueba comparativa de seguridad en la nube de Microsoft relacionadas con el almacenamiento",
            "guid": "d237de14-3b16-4c21-b7aa-9b64604489a8",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/storage-security-baseline",
            "service": "Azure Storage",
            "severity": "Medio",
            "text": "Tenga en cuenta la \"línea base de seguridad de Azure para el almacenamiento\"",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "De forma predeterminada, Azure Storage tiene una dirección IP pública y es accesible desde Internet. Los puntos de conexión privados permiten exponer de forma segura Azure Storage solo a los recursos de proceso de Azure que necesitan acceso, lo que elimina la exposición a la Internet pública",
            "guid": "f42d78e7-9d17-4a73-a22a-5a67e7a8ed4b",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-private-endpoints",
            "service": "Azure Storage",
            "severity": "Alto",
            "text": "Considere la posibilidad de usar puntos de conexión privados para Azure Storage",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "Las cuentas de almacenamiento recién creadas se crean mediante el modelo de implementación de ARM, de modo que RBAC, auditoría, etc. están habilitados. Asegúrese de que no hay cuentas de almacenamiento antiguas con el modelo de implementación clásica en una suscripción",
            "guid": "30e37c3e-2971-41b2-963c-eee079b598de",
            "link": "https://learn.microsoft.com/azure/virtual-machines/migration-classic-resource-manager-overview#migration-of-storage-accounts",
            "service": "Azure Storage",
            "severity": "Medio",
            "text": "Asegúrese de que las cuentas de almacenamiento más antiguas no usan el \"modelo de implementación clásica\"",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "Aproveche Microsoft Defender para obtener información sobre la actividad sospechosa y los errores de configuración.",
            "guid": "fc5972cd-4cd2-41b0-a803-7f5e6b4bfd3d",
            "link": "https://learn.microsoft.com/azure/storage/common/azure-defender-storage-configure",
            "service": "Azure Storage",
            "severity": "Alto",
            "text": "Habilitación de Microsoft Defender para todas las cuentas de almacenamiento",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "El mecanismo de eliminación temporal permite recuperar blobs eliminados accidentalmente.",
            "guid": "503547c1-447e-4c66-828a-7100f1ce16dd",
            "link": "https://learn.microsoft.com/azure/storage/blobs/soft-delete-blob-overview",
            "service": "Azure Storage",
            "severity": "Medio",
            "text": "Habilitación de la \"eliminación temporal\" para blobs",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "Considere la posibilidad de deshabilitar de forma selectiva la \"eliminación temporal\" para determinados contenedores de blobs, por ejemplo, si la aplicación debe asegurarse de que la información eliminada se elimina inmediatamente, por ejemplo, por motivos de confidencialidad, privacidad o cumplimiento. ",
            "guid": "3f1d5e87-2e52-4e36-81cc-58b4a4b1510e",
            "link": "https://learn.microsoft.com/azure/storage/blobs/soft-delete-blob-enable",
            "service": "Azure Storage",
            "severity": "Medio",
            "text": "Deshabilitación de la \"eliminación temporal\" de blobs",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "La eliminación temporal de contenedores permite recuperar un contenedor después de que se haya eliminado, por ejemplo, recuperarse de una operación de eliminación accidental.",
            "guid": "43a58a9c-2289-4c3d-9b57-d0c655462f2a",
            "link": "https://learn.microsoft.com/azure/storage/blobs/soft-delete-container-overview",
            "service": "Azure Storage",
            "severity": "Alto",
            "text": "Habilitación de la \"eliminación temporal\" para los contenedores",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "Considere la posibilidad de deshabilitar de forma selectiva la \"eliminación temporal\" para determinados contenedores de blobs, por ejemplo, si la aplicación debe asegurarse de que la información eliminada se elimina inmediatamente, por ejemplo, por motivos de confidencialidad, privacidad o cumplimiento. ",
            "guid": "3e3453a3-c863-4964-ab65-2d6c15f51296",
            "link": "https://learn.microsoft.com/azure/storage/blobs/soft-delete-container-enable",
            "service": "Azure Storage",
            "severity": "Medio",
            "text": "Deshabilitación de la \"eliminación temporal\" para contenedores",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "Evita la eliminación accidental de una cuenta de almacenamiento, obligando al usuario a quitar primero el bloqueo de eliminación, antes de la eliminación",
            "guid": "5398e6de-d227-4dd1-92b0-6c21d7999a64",
            "link": "https://learn.microsoft.com/azure/storage/common/lock-account-resource",
            "service": "Azure Storage",
            "severity": "Alto",
            "text": "Habilitación de bloqueos de recursos en cuentas de almacenamiento",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "Considere la posibilidad de aplicar directivas de \"retención legal\" o \"retención basada en el tiempo\" para los blobs, de modo que sea imposible eliminar el blob, el contenedor o la cuenta de almacenamiento. Tenga en cuenta que 'imposible' en realidad significa 'imposible'; una vez que una cuenta de almacenamiento contiene un blob inmutable, la única manera de \"deshacerse\" de esa cuenta de almacenamiento es cancelando la suscripción de Azure.",
            "guid": "6f4389a8-f42c-478e-98c0-6a73a22a4956",
            "link": "https://learn.microsoft.com/azure/storage/blobs/immutable-storage-overview",
            "service": "Azure Storage",
            "severity": "Alto",
            "text": "Considere la posibilidad de blobs inmutables",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "Considere la posibilidad de deshabilitar el acceso HTTP/80 sin protección a la cuenta de almacenamiento, de modo que todas las transferencias de datos estén cifradas, protegidas por integridad y el servidor esté autenticado. ",
            "guid": "e7a8dc4a-20e2-47c3-b297-11b1352beee0",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-require-secure-transfer",
            "service": "Azure Storage",
            "severity": "Alto",
            "text": "Requerir HTTPS, es decir, deshabilitar el puerto 80 en la cuenta de almacenamiento",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "Al configurar un dominio personalizado (nombre de host) en una cuenta de almacenamiento, compruebe si necesita TLS/HTTPS; si es así, es posible que tenga que colocar Azure CDN delante de la cuenta de almacenamiento.",
            "guid": "79b588de-fc49-472c-b3cd-21bf77036e5e",
            "link": "https://learn.microsoft.com/azure/storage/blobs/storage-custom-domain-name",
            "service": "Azure Storage",
            "severity": "Alto",
            "text": "Al aplicar HTTPS (deshabilitar HTTP), compruebe que no usa dominios personalizados (CNAME) para la cuenta de almacenamiento.",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "Requerir HTTPS cuando un cliente usa un token de SAS para acceder a los datos de blobs ayuda a minimizar el riesgo de pérdida de credenciales.",
            "guid": "6b4bed3d-5035-447c-8347-dc56028a71ff",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-sas-overview",
            "service": "Azure Storage",
            "severity": "Medio",
            "text": "Limitar los tokens de firma de acceso compartido (SAS) solo a las conexiones HTTPS",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "Los tokens de AAD deben favorecerse sobre las firmas de acceso compartido, siempre que sea posible",
            "guid": "e1ce15dd-3f0d-45e7-92d4-1e3611cc57b4",
            "link": "https://learn.microsoft.com/azure/storage/common/authorize-data-access",
            "service": "Azure Storage",
            "severity": "Alto",
            "text": "Uso de tokens de Azure Active Directory (Azure AD) para el acceso a blobs",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "Al asignar un rol a un usuario, grupo o aplicación, conceda a esa entidad de seguridad solo los permisos necesarios para que pueda realizar sus tareas. Limitar el acceso a los recursos ayuda a evitar el uso indebido no intencionado y malintencionado de los datos.",
            "guid": "a4b1410d-4395-48a8-a228-9b3d6b57cfc6",
            "service": "Azure Storage",
            "severity": "Medio",
            "text": "Privilegios mínimos en los permisos de IaM",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "Una SAS de delegación de usuarios está protegida con credenciales de Azure Active Directory (Azure AD) y también con los permisos especificados para la SAS. Una SAS de delegación de usuarios es análoga a una SAS de servicio en cuanto a su ámbito y función, pero ofrece ventajas de seguridad sobre la SAS de servicio. ",
            "guid": "55461e1a-3e34-453a-9c86-39648b652d6c",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-sas-overview?toc=%2Fazure%2Fstorage%2Fblobs%2Ftoc.json#best-practices-when-using-sas",
            "service": "Azure Storage",
            "severity": "Alto",
            "text": "Al usar SAS, prefiera \"SAS de delegación de usuarios\" en lugar de SAS basada en claves de cuenta de almacenamiento.",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "Las claves de la cuenta de almacenamiento (\"claves compartidas\") tienen muy pocas funcionalidades de auditoría. Si bien se puede monitorear quién o cuándo obtuvo una copia de las claves, una vez que las claves están en manos de varias personas, es imposible atribuir el uso a un usuario específico. Confiar únicamente en la autenticación de AAD facilita la vinculación del acceso al almacenamiento a un usuario. ",
            "guid": "15f51296-5398-4e6d-bd22-7dd142b06c21",
            "link": "https://learn.microsoft.com/rest/api/storageservices/authorize-with-shared-key",
            "service": "Azure Storage",
            "severity": "Alto",
            "text": "Considere la posibilidad de deshabilitar las claves de la cuenta de almacenamiento, de modo que solo se admita el acceso a AAD (y la SAS de delegación de usuarios).",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "Use los datos del registro de actividad para identificar \"cuándo\", \"quién\", \"qué\" y \"cómo\" se está viendo o cambiando la seguridad de la cuenta de almacenamiento (es decir, claves de cuenta de almacenamiento, directivas de acceso, etc.).",
            "guid": "d7999a64-6f43-489a-af42-c78e78c06a73",
            "link": "https://learn.microsoft.com/azure/storage/blobs/blob-storage-monitoring-scenarios#audit-account-activity",
            "service": "Azure Storage",
            "severity": "Alto",
            "text": "Considere la posibilidad de usar Azure Monitor para auditar las operaciones del plano de control en la cuenta de almacenamiento",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "Una directiva de expiración de claves le permite establecer un recordatorio para la rotación de las claves de acceso a la cuenta. El recordatorio se muestra si ha transcurrido el intervalo especificado y las teclas aún no se han girado.",
            "guid": "a22a4956-e7a8-4dc4-a20e-27c3e29711b1",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-account-keys-manage?tabs=azure-portal#create-a-key-expiration-policy",
            "service": "Azure Storage",
            "severity": "Medio",
            "text": "Al usar claves de cuenta de almacenamiento, considere la posibilidad de habilitar una \"directiva de expiración de claves\"",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "Una directiva de expiración de SAS especifica un intervalo recomendado durante el cual la SAS es válida. Las directivas de expiración de SAS se aplican a una SAS de servicio o a una SAS de cuenta. Cuando un usuario genera una SAS de servicio o una SAS de cuenta con un intervalo de validez mayor que el intervalo recomendado, verá una advertencia.",
            "guid": "352beee0-79b5-488d-bfc4-972cd3cd21bf",
            "link": "https://learn.microsoft.com/azure/storage/common/sas-expiration-policy",
            "service": "Azure Storage",
            "severity": "Medio",
            "text": "Considere la posibilidad de configurar una directiva de expiración de SAS",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "Las directivas de acceso almacenadas ofrecen la opción de revocar los permisos de una SAS de servicio sin tener que volver a generar las claves de la cuenta de almacenamiento. ",
            "guid": "77036e5e-6b4b-4ed3-b503-547c1347dc56",
            "link": "https://learn.microsoft.com/rest/api/storageservices/define-stored-access-policy",
            "service": "Azure Storage",
            "severity": "Medio",
            "text": "Considere la posibilidad de vincular SAS a una directiva de acceso almacenada",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "guid": "028a71ff-e1ce-415d-b3f0-d5e772d41e36",
            "link": "https://microsoft.github.io/code-with-engineering-playbook/continuous-integration/dev-sec-ops/secret-management/recipes/detect-secrets-ado/",
            "service": "Azure Storage",
            "severity": "Medio",
            "text": "Considere la posibilidad de configurar el repositorio de código fuente de la aplicación para detectar cadenas de conexión protegidas y claves de cuenta de almacenamiento.",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "Lo ideal es que la aplicación use una identidad administrada para autenticarse en Azure Storage. Si esto no es posible, considere la posibilidad de tener la credencial de almacenamiento (cadena de conexión, clave de cuenta de almacenamiento, SAS, credencial de entidad de servicio) en Azure KeyVault o un servicio equivalente.",
            "guid": "11cc57b4-a4b1-4410-b439-58a8c2289b3d",
            "link": "https://learn.microsoft.com/azure/architecture/framework/security/design-storage-keys",
            "service": "Azure Storage",
            "severity": "Alto",
            "text": "Considere la posibilidad de almacenar cadenas de conexión en Azure KeyVault (en escenarios en los que las identidades administradas no son posibles)",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "Use los tiempos de expiración a corto plazo en una SAS de servicio SAS ad hoc o en una SAS de cuenta. De esta manera, incluso si una SAS se ve comprometida, es válida solo por un corto tiempo. Esta práctica es especialmente importante si no puede hacer referencia a una directiva de acceso almacenada. Los tiempos de expiración a corto plazo también limitan la cantidad de datos que se pueden escribir en un blob al limitar el tiempo disponible para cargarlo.",
            "guid": "27138b82-1102-4cac-9eae-01e6e842e52f",
            "link": "https://learn.microsoft.com/rest/api/storageservices/delegate-access-with-shared-access-signature",
            "service": "Azure Storage",
            "severity": "Alto",
            "text": "Esfuércese por obtener períodos de validez cortos para SAS ad-hoc",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "Al crear una SAS, sea lo más específico y restrictivo posible. Prefiera una SAS para un solo recurso y operación en lugar de una SAS que proporciona un acceso mucho más amplio.",
            "guid": "4721d928-c1b1-4cd5-81e5-4a29a9de399c",
            "link": "https://learn.microsoft.com/rest/api/storageservices/delegate-access-with-shared-access-signature",
            "service": "Azure Storage",
            "severity": "Medio",
            "text": "Aplicación de un ámbito limitado a una SAS",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "Una SAS puede incluir parámetros en los que las direcciones IP de cliente o los intervalos de direcciones están autorizados a solicitar un recurso mediante la SAS. ",
            "guid": "fd7b28dc-9355-4562-82bf-e4564b0d834a",
            "link": "https://learn.microsoft.com/rest/api/storageservices/create-account-sas",
            "service": "Azure Storage",
            "severity": "Medio",
            "text": "Considere la posibilidad de definir el ámbito de SAS en una dirección IP de cliente específica, siempre que sea posible",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "Una SAS no puede restringir la cantidad de datos que carga un cliente; Dado el modelo de precios de la cantidad de almacenamiento a lo largo del tiempo, podría tener sentido validar si los clientes cargaron contenido de gran tamaño malintencionado.",
            "guid": "348b263e-6dd6-4051-8a36-498f6dbad38e",
            "service": "Azure Storage",
            "severity": "Bajo",
            "text": "Considere la posibilidad de comprobar los datos cargados, después de que los clientes hayan usado una SAS para cargar un archivo. ",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "Al acceder a Blob Storage a través de SFTP mediante una \"cuenta de usuario local\", no se aplican los controles RBAC \"habituales\". El acceso a blobs a través de NFS o REST puede ser más restrictivo que el acceso SFTP. Desafortunadamente, a partir de principios de 2023, los usuarios locales son la única forma de administración de identidades que actualmente se admite para el punto de conexión SFTP",
            "guid": "ad53cc7c-e1d7-4aaa-a357-1449ab8053d8",
            "link": "https://learn.microsoft.com/azure/storage/blobs/secure-file-transfer-protocol-support#sftp-permission-model",
            "service": "Azure Storage",
            "severity": "Alto",
            "text": "SFTP: Limite la cantidad de \"usuarios locales\" para el acceso SFTP y audite si el acceso es necesario a lo largo del tiempo.",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "guid": "9f89dc7b-33be-42a1-a27f-7b9e91be1f38",
            "link": "https://learn.microsoft.com/azure/storage/blobs/secure-file-transfer-protocol-known-issues#authentication-and-authorization",
            "service": "Azure Storage",
            "severity": "Medio",
            "text": "SFTP: El punto de conexión SFTP no admite ACL similares a POSIX.",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "El almacenamiento es compatible con CORS (Cross-Origin Resource Sharing), es decir, una función HTTP que permite a las aplicaciones web de un dominio diferente relajar la política del mismo origen. Al habilitar CORS, mantenga CorsRules con el mínimo privilegio.",
            "guid": "cef39812-bd46-43cb-aac8-ac199ebb91a3",
            "link": "https://learn.microsoft.com/rest/api/storageservices/cross-origin-resource-sharing--cors--support-for-the-azure-storage-services",
            "service": "Azure Storage",
            "severity": "Alto",
            "text": "Evite las políticas de CORS demasiado amplias",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "Los datos en reposo siempre están cifrados en el lado del servidor y, además, también pueden estar cifrados en el lado del cliente. El cifrado del lado del servidor puede realizarse mediante una clave administrada por la plataforma (predeterminada) o una clave administrada por el cliente. El cifrado del lado cliente puede producirse haciendo que el cliente proporcione una clave de cifrado y descifrado por blob a Azure Storage o controlando completamente el cifrado en el lado cliente. por lo tanto, no depende en absoluto de Azure Storage para obtener garantías de confidencialidad.",
            "guid": "3d90cae2-cc88-4137-86f7-c0cbafe61464",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-service-encryption",
            "service": "Azure Storage",
            "severity": "Alto",
            "text": "Determine cómo se deben cifrar los datos en reposo. Comprender el modelo de subprocesos para los datos.",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "guid": "8dd457e9-2713-48b8-8110-2cac6eae01e6",
            "link": "https://learn.microsoft.com/azure/storage/common/customer-managed-keys-overview?toc=%2Fazure%2Fstorage%2Fblobs%2Ftoc.json&bc=%2Fazure%2Fstorage%2Fblobs%2Fbreadcrumb%2Ftoc.json",
            "service": "Azure Storage",
            "severity": "Medio",
            "text": "Determine qué cifrado de plataforma se debe usar o si se debe usar.",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "guid": "e842e52f-4721-4d92-ac1b-1cd521e54a29",
            "link": "https://learn.microsoft.com/azure/storage/blobs/encryption-customer-provided-keys",
            "service": "Azure Storage",
            "severity": "Medio",
            "text": "Determine qué cifrado del lado del cliente se debe usar o si.",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Blob Storage Review",
            "description": "Aproveche el Explorador de Resource Graph (resources | where type == 'microsoft.storage/storageaccounts' | where properties['allowBlobPublicAccess'] == true) para buscar cuentas de almacenamiento que permitan el acceso anónimo a blobs.",
            "guid": "659ae558-b937-4d49-a5e1-112dbd7ba012",
            "link": "https://learn.microsoft.com/azure/storage/blobs/anonymous-read-access-configure?tabs=portal#allow-or-disallow-public-read-access-for-a-storage-account",
            "service": "Azure Storage",
            "severity": "Alto",
            "text": "Considere si se necesita acceso público a blobs o si se puede deshabilitar para determinadas cuentas de almacenamiento. ",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "70c15989-c726-42c7-b0d3-24b7375b9201",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/multi-tenant/considerations-recommendations",
            "service": "Entra",
            "severity": "Medio",
            "text": "Use un inquilino de Entra para administrar los recursos de Azure, a menos que tenga un requisito normativo o empresarial claro para varios inquilinos.",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "6309957b-821a-43d1-b9d9-7fcf1802b747",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/multi-tenant/automation",
            "service": "Entra",
            "severity": "Bajo",
            "text": "Asegúrese de que tiene un enfoque de automatización multiinquilino para administrar los inquilinos de Microsoft Entra ID",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "78e11934-499a-45ed-8ef7-aae5578f0ecf",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/multi-tenant/lighthouse",
            "service": "Entra",
            "severity": "Bajo",
            "text": "Aprovechamiento de Azure Lighthouse para la administración multiinquilino",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "5d82e6df-6f61-42f2-82e2-3132d293be3d",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/azure-billing-microsoft-customer-agreement#design-recommendations",
            "service": "Entra",
            "severity": "Medio",
            "text": "Asegúrese de que el asociado usa Azure Lighthouse para administrar el inquilino",
            "waf": "Costar"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "984a859c-773e-47d2-9162-3a765a917e1f",
            "link": "https://learn.microsoft.com/azure/active-directory/roles/security-emergency-access",
            "service": "Entra",
            "severity": "Alto",
            "text": "Implemente un acceso de emergencia o cuentas de emergencia para evitar el bloqueo de cuentas en todo el inquilino",
            "training": "https://learn.microsoft.com/learn/modules/azure-ad-privileged-identity-management/",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "1cf0b8da-70bd-44d0-94af-8d99cfc89ae1",
            "link": "https://learn.microsoft.com/azure/active-directory/reports-monitoring/concept-activity-logs-azure-monitor",
            "service": "Entra",
            "severity": "Medio",
            "text": "Integre los registros de identificador de Microsoft Entra con Azure Monitor central de la plataforma. Azure Monitor permite una única fuente de información en torno a los datos de registro y supervisión en Azure, lo que ofrece a las organizaciones opciones nativas en la nube para cumplir los requisitos relacionados con la recopilación y retención de registros.",
            "waf": "Seguridad"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "348ef254-c27d-442e-abba-c7571559ab91",
            "link": "https://learn.microsoft.com/azure/role-based-access-control/overview",
            "service": "Entra",
            "severity": "Alto",
            "text": "Aplique un modelo RBAC que se alinee con su modelo operativo en la nube. Ámbito y asignación entre grupos de administración y suscripciones.",
            "training": "https://learn.microsoft.com/learn/paths/implement-resource-mgmt-security/",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "53e8908a-e28c-484c-93b6-b7808b9fe5c4",
            "link": "https://learn.microsoft.com/azure/active-directory/conditional-access/overview",
            "service": "Entra",
            "severity": "Bajo",
            "text": "Aplicación de directivas de acceso condicional de Microsoft Entra ID para cualquier usuario con derechos en entornos de Azure",
            "training": "https://learn.microsoft.com/learn/modules/plan-implement-administer-conditional-access/",
            "waf": "Seguridad"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "1049d403-a923-4c34-94d0-0018ac6a9e01",
            "link": "https://learn.microsoft.com/azure/active-directory/authentication/concept-mfa-howitworks",
            "service": "Entra",
            "severity": "Alto",
            "text": "Aplicación de la autenticación multifactor para cualquier usuario con derechos en los entornos de Azure",
            "training": "https://learn.microsoft.com/learn/modules/secure-aad-users-with-mfa/",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "14658d35-58fd-4772-99b8-21112df27ee4",
            "link": "https://learn.microsoft.com/azure/active-directory/privileged-identity-management/pim-configure",
            "service": "Entra",
            "severity": "Medio",
            "text": "Aplique la administración de identidades privilegiadas (PIM) de Microsoft Entra ID para establecer el acceso permanente cero y los privilegios mínimos",
            "training": "https://learn.microsoft.com/learn/modules/azure-ad-privileged-identity-management/",
            "waf": "Seguridad"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "12e7f983-f630-4472-8dd6-9c5b5c2622f5",
            "link": "https://learn.microsoft.com/azure/active-directory/roles/security-planning#identify-microsoft-accounts-in-administrative-roles-that-need-to-be-switched-to-work-or-school-accounts",
            "service": "Entra",
            "severity": "Alto",
            "text": "Utilice solo el tipo de autenticación Cuenta profesional o educativa para todos los tipos de cuenta. Evite usar la cuenta de Microsoft",
            "training": "https://learn.microsoft.com/learn/modules/explore-basic-services-identity-types/",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "4b69bad3-3aad-45e8-a68e-1d76667313b4",
            "link": "https://learn.microsoft.com/azure/active-directory/fundamentals/active-directory-groups-create-azure-portal",
            "service": "Entra",
            "severity": "Medio",
            "text": "Utilice solo grupos para asignar permisos. Agregue grupos locales al grupo solo de Azure-AD si ya existe un sistema de administración de grupos.",
            "training": "https://learn.microsoft.com/learn/paths/manage-identity-and-access/",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "8b9fe5c4-1049-4d40-9a92-3c3474d00018",
            "link": "https://learn.microsoft.com/azure/active-directory-domain-services/overview",
            "service": "Entra",
            "severity": "Medio",
            "text": "Si Entra Domain Services está en uso, evalúe la compatibilidad de todas las cargas de trabajo",
            "training": "https://learn.microsoft.com/learn/modules/implement-hybrid-identity-windows-server/",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "d5d1e4e6-1465-48d3-958f-d77249b82111",
            "link": "https://learn.microsoft.com/azure/active-directory/app-proxy/application-proxy",
            "service": "Entra",
            "severity": "Medio",
            "text": "Cuando sea necesario, use Microsoft Entra ID Application Proxy para proporcionar a los usuarios remotos acceso seguro y autenticado a las aplicaciones internas (hospedadas en la nube o en el entorno local).",
            "training": "https://learn.microsoft.com/learn/paths/implement-applications-external-access-azure-ad/",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "35037e68-9349-4c15-b371-228514f4cdff",
            "link": "https://learn.microsoft.com/azure/active-directory/roles/best-practices",
            "service": "Entra",
            "severity": "Medio",
            "text": "Evite el uso de cuentas sincronizadas locales para las asignaciones de roles de identificador de Microsoft Entra.",
            "training": "https://learn.microsoft.com/learn/modules/design-identity-security-strategy/",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "143b16c3-1d7a-4a9b-9470-4489a8042d88",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "service": "VNet",
            "severity": "Medio",
            "text": "Use una red DDoS o planes de protección IP para todas las direcciones IP públicas en las zonas de aterrizaje de la aplicación.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Seguridad"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "guid": "de0d5973-cd4c-4d21-a088-137f5e6c4cfd",
            "link": "https://learn.microsoft.com/en-us/azure/expressroute/expressroute-howto-macsec",
            "service": "ExpressRoute",
            "severity": "Medio",
            "text": "Cuando use ExpressRoute Direct, configure MACsec para cifrar el tráfico en el nivel de capa dos entre los enrutadores de la organización y MSEE. El diagrama muestra este cifrado en el flujo.",
            "waf": "Seguridad"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "guid": "ed301d6e-872e-452e-9611-cc58b5a4b151",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-erdirect-about",
            "service": "ExpressRoute",
            "severity": "Bajo",
            "text": "En escenarios en los que MACsec no es una opción (por ejemplo, no usar ExpressRoute Direct), use una puerta de enlace de VPN para establecer túneles IPsec a través del emparejamiento privado de ExpressRoute.",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "e8bbac75-7155-49ab-a153-e8908ae28c84",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/enterprise-scale/network-topology-and-connectivity",
            "service": "VNet",
            "severity": "Medio",
            "text": "Aproveche un diseño de red basado en la topología de red radial tradicional para escenarios de red que requieren la máxima flexibilidad.",
            "training": "https://learn.microsoft.com/learn/paths/architect-network-infrastructure/",
            "waf": "Seguridad"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "7dd61623-a364-4a90-9eca-e48ebd54cd7d",
            "link": "https://learn.microsoft.com/azure/architecture/reference-architectures/hybrid-networking/expressroute",
            "service": "VNet",
            "severity": "Alto",
            "text": "Asegúrese de que los servicios de redes compartidas, incluidas las puertas de enlace de ExpressRoute, las puertas de enlace de VPN y Azure Firewall o las aplicaciones virtuales de red de asociados en la red virtual del centro central. Si es necesario, implemente también servidores DNS.",
            "waf": "Costar"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "e2e8abac-3571-4559-ab91-53e89f89dc7b",
            "link": "https://learn.microsoft.com/azure/architecture/reference-architectures/dmz/nva-ha",
            "service": "NVA",
            "severity": "Medio",
            "text": "Al implementar tecnologías de redes de asociados o aplicaciones virtuales de red, siga las instrucciones del proveedor de asociados",
            "waf": "Fiabilidad"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "guid": "ce463dbb-bc8a-4c2a-aebc-92a43da1dae2",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-howto-coexist-resource-manager#to-enable-transit-routing-between-expressroute-and-azure-vpn",
            "service": "ExpressRoute",
            "severity": "Bajo",
            "text": "Si necesita el tránsito entre ExpressRoute y las puertas de enlace de VPN en escenarios radiales, use Azure Route Server.",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,subnets=properties.subnets | mv-expand subnets | project id, subnetName = subnets.name, subnetPrefix = subnets.properties.addressPrefix | extend subnetPrefixLength = split(subnetPrefix, '/')[1] | where subnetName == 'RouteServerSubnet' | extend compliant = (subnetPrefixLength <= 27) | distinct id, compliant",
            "guid": "91b9d7d5-91e1-4dcb-8f1f-fa7e465646cc",
            "link": "https://learn.microsoft.com/azure/route-server/quickstart-configure-route-server-portal#create-a-route-server-1",
            "service": "ARS",
            "severity": "Bajo",
            "text": "Si utiliza el servidor de rutas, utilice un prefijo /27 para la subred del servidor de rutas.",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "cc881471-607c-41cc-a0e6-14658dd558f9",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-networks-faq#can-i-create-a-peering-connection-to-a-vnet-in-a-different-region",
            "service": "VNet",
            "severity": "Medio",
            "text": "En el caso de las arquitecturas de red con varias topologías en estrella tipo hub-and-spoke en las regiones de Azure, use emparejamientos de red virtual global entre las redes virtuales del centro para conectar las regiones entre sí.",
            "training": "https://learn.microsoft.com/learn/paths/azure-administrator-manage-virtual-networks/",
            "waf": "Rendimiento"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "4722d929-c1b1-4cd6-81f5-4b29bade39ad",
            "link": "https://learn.microsoft.com/azure/azure-monitor/insights/network-insights-overview",
            "service": "VNet",
            "severity": "Medio",
            "text": "Use Azure Monitor para redes para supervisar el estado de un extremo a otro de las redes en Azure.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-network-monitoring/",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type == 'microsoft.network/virtualnetworks' | mvexpand properties.virtualNetworkPeerings | summarize peeringcount = count() by id | extend compliant = (peeringcount < 450) | distinct id,compliant",
            "guid": "0e7c28ec-9366-4572-83b0-f4664b1d944a",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits?toc=/azure/virtual-network/toc.json#azure-resource-manager-virtual-networking-limits",
            "service": "VNet",
            "severity": "Medio",
            "text": "Al conectar redes virtuales de radio a la red virtual del centro central, tenga en cuenta los límites de emparejamiento de red virtual (500), el número máximo de prefijos que se pueden anunciar a través de ExpressRoute (1000)",
            "waf": "Fiabilidad"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/routetables' | mvexpand properties.routes | summarize routeCount = count() by id | extend compliant = (routeCount < 360) | distinct id,compliant",
            "guid": "3d457936-e9b7-41eb-bdff-314b26450b12",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits?toc=/azure/virtual-network/toc.json#azure-resource-manager-virtual-networking-limits",
            "service": "VNet",
            "severity": "Medio",
            "text": "Tenga en cuenta el límite de rutas por tabla de rutas (400).",
            "waf": "Fiabilidad"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type == 'microsoft.network/virtualnetworks' | mvexpand properties.virtualNetworkPeerings | project id, peeringName=properties_virtualNetworkPeerings.name, compliant = (properties_virtualNetworkPeerings.properties.allowVirtualNetworkAccess == True)",
            "guid": "c76cb5a2-abe2-11ed-afa1-0242ac120002",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-network-manage-peering",
            "service": "VNet",
            "severity": "Alto",
            "text": "Use la opción \"Permitir tráfico a la red virtual remota\" al configurar emparejamientos de red virtual",
            "waf": "Fiabilidad"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "guid": "359c373e-7dd6-4162-9a36-4a907ecae48e",
            "link": "https://learn.microsoft.com/azure/architecture/reference-architectures/hybrid-networking/hub-spoke?tabs=cli",
            "service": "ExpressRoute",
            "severity": "Medio",
            "text": "Asegúrese de que ha investigado la posibilidad de usar ExpressRoute como conexión principal a Azure.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Rendimiento"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "description": "Puede usar la anteposición de AS y los pesos de conexión para influir en el tráfico de Azure al entorno local, y la gama completa de atributos de BGP en sus propios enrutadores para influir en el tráfico del entorno local a Azure.",
            "guid": "f29812b2-363c-4efe-879b-599de0d5973c",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-routing",
            "service": "ExpressRoute",
            "severity": "Medio",
            "text": "Cuando use varios circuitos ExpressRoute o varias ubicaciones locales, asegúrese de optimizar el enrutamiento con atributos BGP, si se prefieren determinadas rutas de acceso.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Fiabilidad"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources| where type == 'microsoft.network/virtualnetworkgateways'| where properties.gatewayType =~ 'vpn' or properties.gatewayType == 'ExpressRoute'| extend SKUName = properties.sku.name, SKUTier = properties.sku.tier, Type = properties.gatewayType| extend compliant = SKUTier !in ('Basic', 'Standard')| project name, id, subscriptionId, resourceGroup, compliant",
            "guid": "d4cd21b0-8813-47f5-b6c4-cfd3e504547c",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-routing",
            "service": "ExpressRoute",
            "severity": "Medio",
            "text": "Asegúrese de que usa la SKU correcta para las puertas de enlace de ExpressRoute/VPN en función de los requisitos de ancho de banda y rendimiento.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Rendimiento"
        },
        {
            "ammp": true,
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/expressroutecircuits' | extend compliant = (tolower(sku.family) == 'metereddata' or tolower(sku.tier) == 'local') | distinct id,compliant",
            "guid": "7025b442-f6e9-4af6-b11f-c9574916016f",
            "link": "https://learn.microsoft.com/azure/expressroute/plan-manage-cost",
            "service": "ExpressRoute",
            "severity": "Alto",
            "text": "Asegúrese de que usa circuitos ExpressRoute de datos ilimitados solo si alcanza el ancho de banda que justifica su costo.",
            "waf": "Costar"
        },
        {
            "ammp": true,
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/connections' | where properties.connectionType == 'ExpressRoute' | project id, gwid=tostring(properties.virtualNetworkGateway1.id), circuitid=tostring(properties.peer.id) | join (resources | where type=='microsoft.network/expressroutecircuits' | project circuitid=tostring(id), circuitsku=sku.tier) on circuitid | project id=gwid, compliant = (circuitsku == 'Local') | summarize compliant=max(compliant) by id",
            "guid": "f4e7926a-ec35-476e-a412-5dd17136bd62",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-faqs#expressroute-local",
            "service": "ExpressRoute",
            "severity": "Alto",
            "text": "Aproveche la SKU local de ExpressRoute para reducir el costo de los circuitos, si la ubicación de emparejamiento de los circuitos admite las regiones de Azure para la SKU local.",
            "waf": "Costar"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources| where type == 'microsoft.network/virtualnetworkgateways'| where properties.gatewayType =~ 'vpn' or properties.gatewayType == 'ExpressRoute'| extend SKUName = properties.sku.name, SKUTier = properties.sku.tier, Type = properties.gatewayType| extend compliant = SKUTier contains 'AZ'| project name, id, subscriptionId, resourceGroup, Type, compliant",
            "guid": "2447ec66-138a-4720-8f1c-e16ed301d6e8",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-about-virtual-network-gateways",
            "service": "ExpressRoute",
            "severity": "Medio",
            "text": "Implemente una puerta de enlace de ExpressRoute con redundancia de zona en las regiones de Azure admitidas.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Fiabilidad"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "guid": "72e52e36-11cc-458b-9a4b-1511e43a58a9",
            "link": "https://learn.microsoft.com/azure/networking/",
            "service": "ExpressRoute",
            "severity": "Medio",
            "text": "En escenarios que requieren un ancho de banda superior a 10 Gbps o puertos dedicados de 10/100 Gbps, use ExpressRoute Direct.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Rendimiento"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "guid": "c2299c4d-7b57-4d0c-9555-62f2b3e4563a",
            "link": "https://learn.microsoft.com/azure/expressroute/about-fastpath",
            "service": "ExpressRoute",
            "severity": "Medio",
            "text": "Cuando se requiera una latencia baja o el rendimiento del entorno local a Azure sea superior a 10 Gbps, habilite FastPath para omitir la puerta de enlace de ExpressRoute de la ruta de acceso de datos.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Rendimiento"
        },
        {
            "arm-service": "microsoft.network/vpnGateways",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/virtualnetworkgateways' | where properties.gatewayType == 'Vpn' | extend compliant = (tolower(properties.sku.name) contains 'az') | distinct id, compliant",
            "guid": "4d873974-8b66-42d6-b15f-512a65498f6d",
            "link": "https://learn.microsoft.com/azure/vpn-gateway/create-zone-redundant-vnet-gateway",
            "service": "VPN",
            "severity": "Medio",
            "text": "Use puertas de enlace de VPN con redundancia de zona para conectar sucursales o ubicaciones remotas a Azure (donde estén disponibles).",
            "training": "https://learn.microsoft.com/training/modules/intro-to-azure-vpn-gateway/",
            "waf": "Fiabilidad"
        },
        {
            "arm-service": "microsoft.network/vpnGateways",
            "checklist": "Azure Landing Zone Review",
            "guid": "45866df8-cf85-4ca9-bbe2-65ec1478919e",
            "link": "https://learn.microsoft.com/azure/vpn-gateway/vpn-gateway-highlyavailable",
            "service": "VPN",
            "severity": "Medio",
            "text": "Use dispositivos VPN redundantes en las instalaciones (activo/activo o activo/pasivo).",
            "training": "https://learn.microsoft.com/training/modules/intro-to-azure-vpn-gateway/",
            "waf": "Fiabilidad"
        },
        {
            "ammp": true,
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "guid": "718cb437-b060-2589-8856-2e93a5c6633b",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-erdirect-about",
            "service": "ExpressRoute",
            "severity": "Alto",
            "text": "Si usa ExpressRoute Direct, considere la posibilidad de usar circuitos locales de ExpressRoute a las regiones locales de Azure para ahorrar costos",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Costar"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "guid": "8042d88e-79d1-47b7-9b22-a5a67e7a8ed4",
            "link": "https://learn.microsoft.com/azure/architecture/framework/services/networking/expressroute/reliability",
            "service": "ExpressRoute",
            "severity": "Medio",
            "text": "Cuando se requiere aislamiento de tráfico o ancho de banda dedicado, por ejemplo, para separar entornos de producción y no de producción, use circuitos ExpressRoute diferentes. Le ayudará a garantizar dominios de enrutamiento aislados y a aliviar los riesgos de vecinos ruidosos.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Seguridad"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "guid": "b30e38c3-f298-412b-8363-cefe179b599d",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-monitoring-metrics-alerts",
            "service": "ExpressRoute",
            "severity": "Medio",
            "text": "Supervise la disponibilidad y el uso de ExpressRoute mediante Express Route Insights integrado.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Operaciones"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "guid": "5bf68dc9-325e-4873-bf88-f8214ef2e5d2",
            "link": "https://learn.microsoft.com/azure/expressroute/how-to-configure-connection-monitor",
            "service": "ExpressRoute",
            "severity": "Medio",
            "text": "Use el Monitor de conexión para la supervisión de la conectividad en toda la red, especialmente entre el entorno local y Azure.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Operaciones"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/connections' | where properties.connectionType == 'ExpressRoute' | project cxId=id, gwId=tostring(properties.virtualNetworkGateway1.id), circuitId=tostring(properties.peer.id) | join (resources | where type=='microsoft.network/expressroutecircuits' | project circuitId=tostring(id), circuitLocation=tostring(properties.serviceProviderProperties.peeringLocation)) on circuitId | distinct gwId, circuitLocation | summarize countErLocations=count() by id=gwId | extend compliant = (countErLocations >= 2)",
            "guid": "e0d5973c-d4cd-421b-8881-37f5e6c4cfd3",
            "link": "https://learn.microsoft.com/azure/expressroute/designing-for-disaster-recovery-with-expressroute-privatepeering#challenges-of-using-multiple-expressroute-circuits",
            "service": "ExpressRoute",
            "severity": "Medio",
            "text": "Use circuitos ExpressRoute de diferentes ubicaciones de emparejamiento para obtener redundancia.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Fiabilidad"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "guid": "cf3fe65c-fec0-495a-8edc-9675200f2add",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-howto-coexist-resource-manager",
            "service": "ExpressRoute",
            "severity": "Medio",
            "text": "Use VPN de sitio a sitio como conmutación por error de ExpressRoute, especialmente si solo usa un único circuito ExpressRoute.",
            "waf": "Fiabilidad"
        },
        {
            "ammp": true,
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,resourceGroup,name,subnets=properties.subnets | mv-expand subnets | project id,resourceGroup,name,subnetName=tostring(subnets.name),routeTableId=tostring(subnets.properties.routeTable.id) | where subnetName == 'GatewaySubnet' | join kind=leftouter (Resources | where type == 'microsoft.network/routetables' | project routeTableName=name,routeTableId=id, disableBgpRoutePropagation=properties.disableBgpRoutePropagation) on routeTableId | project id,compliant = (disableBgpRoutePropagation == False or isnull(disableBgpRoutePropagation))",
            "guid": "72105cc8-aaea-4ee1-8c7a-ad25977afcaf",
            "link": "https://learn.microsoft.com/azure/vpn-gateway/vpn-gateway-about-vpn-gateway-settings#gwsub",
            "service": "ExpressRoute",
            "severity": "Alto",
            "text": "Si utiliza una tabla de rutas en GatewaySubnet, asegúrese de que las rutas de puerta de enlace se propagan.",
            "waf": "Fiabilidad"
        },
        {
            "ammp": true,
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "guid": "d581a947-69a2-4783-942e-9df3664324c8",
            "link": "https://learn.microsoft.com/azure/expressroute/designing-for-high-availability-with-expressroute#active-active-connections",
            "service": "ExpressRoute",
            "severity": "Alto",
            "text": "Si usa ExpressRoute, el enrutamiento local debe ser dinámico: en caso de que se produzca un error de conexión, debe converger a la conexión restante del circuito. La carga debe compartirse entre ambas conexiones, idealmente como activa/activa, aunque también se admite activa/pasiva.",
            "waf": "Fiabilidad"
        },
        {
            "ammp": true,
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "guid": "558fd772-49b8-4211-82df-27ee412e7f98",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-ip-addressing",
            "service": "ExpressRoute",
            "severity": "Alto",
            "text": "Asegúrese de que no se usan espacios de direcciones IP superpuestos en las regiones de Azure y las ubicaciones locales",
            "training": "https://learn.microsoft.com/learn/paths/architect-network-infrastructure/",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type == 'microsoft.network/virtualnetworks' | extend addressSpace = todynamic(properties.addressSpace) | extend addressPrefix = todynamic(properties.addressSpace.addressPrefixes) | mvexpand addressSpace | mvexpand addressPrefix | project name, id, location, resourceGroup, subscriptionId, cidr = addressPrefix | extend compliant = (cidr matches regex @'^(10\\\\.|172\\\\.(1[6-9]|2[0-9]|3[01])\\\\.|192\\\\.168\\\\.)')  | project id, compliant, cidr",
            "guid": "3f630472-2dd6-49c5-a5c2-622f54b69bad",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-ip-addressing",
            "service": "VNet",
            "severity": "Bajo",
            "text": "Utilice direcciones IP de los rangos de asignación de direcciones para Internet privadas (RFC 1918).",
            "training": "https://learn.microsoft.com/learn/paths/architect-network-infrastructure/",
            "waf": "Seguridad"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type == 'microsoft.network/virtualnetworks' | extend addressSpace = todynamic(properties.addressSpace) | extend addressPrefix = todynamic(properties.addressSpace.addressPrefixes) | mvexpand addressSpace | mvexpand addressPrefix | extend addressMask = split(addressPrefix,'/')[1] | extend compliant = addressMask > 16 | project name, id, subscriptionId, resourceGroup, addressPrefix, compliant",
            "guid": "33aad5e8-c68e-41d7-9667-313b4f5664b5",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-ip-addressing",
            "service": "VNet",
            "severity": "Alto",
            "text": "Asegúrese de que no se desperdicie espacio de direcciones IP, no cree redes virtuales innecesariamente grandes (por ejemplo, /16)",
            "training": "https://learn.microsoft.com/learn/paths/architect-network-infrastructure/",
            "waf": "Rendimiento"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "f348ef25-4c27-4d42-b8bb-ac7571559ab9",
            "link": "https://learn.microsoft.com/azure/site-recovery/concepts-on-premises-to-azure-networking#retain-ip-addresses",
            "service": "VNet",
            "severity": "Alto",
            "text": "Evite el uso de intervalos de direcciones IP superpuestos para los sitios de producción y recuperación ante desastres.",
            "training": "https://learn.microsoft.com/learn/paths/az-104-manage-virtual-networks/",
            "waf": "Fiabilidad"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "153e8908-ae28-4c84-a33b-6b7808b9fe5c",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-networks-name-resolution-for-vms-and-role-instances",
            "service": "DNS",
            "severity": "Medio",
            "text": "En entornos en los que la resolución de nombres en Azure es todo lo que se requiere, use Azure Private DNS para la resolución con una zona delegada para la resolución de nombres (como \"azure.contoso.com\").",
            "training": "https://learn.microsoft.com/learn/paths/az-104-manage-virtual-networks/",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "41049d40-3a92-43c3-974d-00018ac6a9e0",
            "link": "https://learn.microsoft.com/azure/dns/dns-private-resolver-overview",
            "service": "DNS",
            "severity": "Medio",
            "text": "En el caso de los entornos en los que se requiere la resolución de nombres en Azure y en el entorno local, considere la posibilidad de usar Azure DNS Private Resolver.",
            "training": "https://learn.microsoft.com/training/modules/intro-to-azure-dns-private-resolver/",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "1e6a83de-5de3-42c1-a924-81607d5d1e4e",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-networks-name-resolution-for-vms-and-role-instances",
            "service": "DNS",
            "severity": "Bajo",
            "text": "Las cargas de trabajo especiales que requieren e implementan su propio DNS (como Red Hat OpenShift) deben utilizar su solución DNS preferida.",
            "waf": "Operaciones"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "614658d3-558f-4d77-849b-821112df27ee",
            "link": "https://learn.microsoft.com/azure/dns/private-dns-autoregistration",
            "service": "DNS",
            "severity": "Alto",
            "text": "Habilite el registro automático de Azure DNS para administrar automáticamente el ciclo de vida de los registros DNS de las máquinas virtuales implementadas en una red virtual.",
            "training": "https://learn.microsoft.com/learn/paths/az-104-manage-virtual-networks/",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "ee1ac551-c4d5-46cf-b035-d0a3c50d87ad",
            "link": "https://learn.microsoft.com/azure/bastion/bastion-overview",
            "service": "Bastion",
            "severity": "Medio",
            "text": "Considere la posibilidad de usar Azure Bastion para conectarse de forma segura a la red.",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,subnets=properties.subnets | mv-expand subnets | project id, subnetName = subnets.name, subnetPrefix = subnets.properties.addressPrefix | extend subnetPrefixLength = split(subnetPrefix, '/')[1] | where subnetName == 'AzureBastionSubnet' | extend compliant = (subnetPrefixLength <= 26) | distinct id, compliant",
            "guid": "6eab9eb6-762b-485e-8ea8-15aa5dba0bd0",
            "link": "https://learn.microsoft.com/azure/bastion/bastion-faq#subnet",
            "service": "Bastion",
            "severity": "Medio",
            "text": "Use Azure Bastion en una subred /26 o superior.",
            "waf": "Seguridad"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "e6c4cfd3-e504-4547-a244-7ec66138a720",
            "link": "https://learn.microsoft.com/azure/app-service/networking-features",
            "service": "Firewall",
            "severity": "Alto",
            "text": "Use Azure Firewall para controlar el tráfico saliente de Azure a Internet, las conexiones entrantes que no son HTTP/S y el filtrado del tráfico Este/Oeste (si la organización lo requiere)",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "5a4b1511-e43a-458a-ac22-99c4d7b57d0c",
            "link": "https://learn.microsoft.com/azure/firewall/",
            "service": "Firewall",
            "severity": "Medio",
            "text": "Cree una directiva global de Azure Firewall para controlar la posición de seguridad en todo el entorno de red global y asígnela a todas las instancias de Azure Firewall. Permita que las directivas granulares satisfagan los requisitos de regiones específicas delegando directivas de firewall incrementales a los equipos de seguridad locales a través del control de acceso basado en roles de Azure.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "655562f2-b3e4-4563-a4d8-739748b662d6",
            "link": "https://learn.microsoft.com/azure/firewall/",
            "service": "Firewall",
            "severity": "Bajo",
            "text": "Configure los proveedores de seguridad SaaS de socios compatibles dentro de Firewall Manager si la organización desea utilizar dichas soluciones para ayudar a proteger las conexiones salientes.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "1d7aa9b6-4704-4489-a804-2d88e79d17b7",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/afds-overview",
            "service": "WAF",
            "severity": "Medio",
            "text": "Use directivas de Azure Front Door y WAF para proporcionar protección global en todas las regiones de Azure para las conexiones HTTP/S entrantes a una zona de aterrizaje.",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "3b22a5a6-7e7a-48ed-9b30-e38c3f29812b",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "service": "WAF",
            "severity": "Bajo",
            "text": "Al usar Azure Front Door y Azure Application Gateway para ayudar a proteger las aplicaciones HTTP/S, use directivas de WAF en Azure Front Door. Bloquee Azure Application Gateway para recibir tráfico solo de Azure Front Door.",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "waf": "Seguridad"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "2363cefe-179b-4599-be0d-5973cd4cd21b",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "service": "WAF",
            "severity": "Alto",
            "text": "La implementación de WAF y otros servidores proxy inversos son necesarios para las conexiones HTTP/S entrantes, impleméntelos dentro de una red virtual de zona de aterrizaje y junto con las aplicaciones que protegen y exponen a Internet.",
            "training": "https://learn.microsoft.com/learn/paths/architect-network-infrastructure/",
            "waf": "Seguridad"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "088137f5-e6c4-4cfd-9e50-4547c2447ec6",
            "link": "https://learn.microsoft.com/azure/ddos-protection/ddos-protection-reference-architectures",
            "service": "VNet",
            "severity": "Alto",
            "text": "Use planes de protección IP o de red DDoS de Azure para ayudar a proteger los puntos de conexión de direcciones IP públicas dentro de las redes virtuales.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Seguridad"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/firewallpolicies' | extend compliant = (properties.dnsSettings.enableProxy == true) | distinct id,compliant",
            "guid": "14d99880-2f88-47e8-a134-62a7d85c94af",
            "link": "https://learn.microsoft.com/azure/firewall/fqdn-filtering-network-rules",
            "service": "Firewall",
            "severity": "Alto",
            "text": "Use reglas de red basadas en FQDN y Azure Firewall con proxy DNS para filtrar el tráfico de salida a Internet a través de protocolos no admitidos por las reglas de aplicación.",
            "waf": "Seguridad"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/firewallpolicies' | extend compliant = (properties.sku.tier == 'Premium') | distinct id,compliant",
            "guid": "c10d51ef-f999-455d-bba0-5c90ece07447",
            "link": "https://learn.microsoft.com/azure/firewall/premium-features",
            "service": "Firewall",
            "severity": "Alto",
            "text": "Use Azure Firewall Premium para obtener seguridad y protección adicionales.",
            "waf": "Seguridad"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/firewallpolicies' | extend compliant = (properties.threatIntelMode == 'Deny') | distinct id,compliant",
            "guid": "e9c8f584-6d5e-473b-8dc5-acc9fbaab4e3",
            "link": "https://learn.microsoft.com/azure/firewall/premium-features",
            "service": "Firewall",
            "severity": "Alto",
            "text": "Configure el modo de inteligencia sobre amenazas de Azure Firewall en Alerta y denegación para obtener protección adicional.",
            "waf": "Seguridad"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/firewallpolicies' | extend compliant = (properties.intrusionDetection.mode == 'Deny') | project id, compliant",
            "guid": "b9d0dff5-bdd4-4cd8-88ed-5811610b2b2c",
            "link": "https://learn.microsoft.com/azure/firewall/premium-features#idps",
            "service": "Firewall",
            "severity": "Alto",
            "text": "Configure el modo IDPS de Azure Firewall en Denegar para obtener protección adicional.",
            "waf": "Seguridad"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,resourceGroup,name,subnets=properties.subnets | mv-expand subnets | project id,name,subnetId=tostring(subnets.id), subnetName=tostring(subnets.name),subnetRT=subnets.properties.routeTable.id | where not (subnetName in ('GatewaySubnet', 'AzureFirewallSubnet', 'RouteServerSubnet', 'AzureBastionSubnet')) | extend hasRT = isnotnull(subnetRT) | distinct id, hasRT, subnetId | join kind=fullouter (resources | where type == 'microsoft.network/virtualnetworks' | mvexpand properties.virtualNetworkPeerings | extend isVWAN=(tolower(split(properties_virtualNetworkPeerings.name, '_')[0]) == 'remotevnettohubpeering') | mv-expand properties.subnets | project id, isVWAN, name, subnetId=tostring(properties_subnets.id), subnetName=tostring(properties_subnets.name) | summarize PeeredToVWAN=max(isVWAN) by id, subnetId | project id, subnetId, isVWANpeer = (PeeredToVWAN == true)) on subnetId | project id=iff(isnotempty(id), id, id1), subnetId=iff(isnotempty(subnetId), subnetId, subnetId1), hasRT, isVWANpeer | extend compliant = (hasRT==true or isVWANpeer==true) | distinct id, subnetId, compliant",
            "guid": "a3784907-9836-4271-aafc-93535f8ec08b",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-networks-udr-overview",
            "service": "Firewall",
            "severity": "Alto",
            "text": "En el caso de las subredes de las redes virtuales que no están conectadas a Virtual WAN, adjunte una tabla de rutas para que el tráfico de Internet se redirija a Azure Firewall o a una aplicación virtual de red",
            "waf": "Seguridad"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "b034c01e-110b-463a-b36e-e3346e57f225",
            "link": "https://learn.microsoft.com/en-us/azure/virtual-network/ip-services/default-outbound-access",
            "service": "VNet",
            "severity": "Alto",
            "text": "Evalúe y revise la configuración y la estrategia del tráfico saliente de la red antes del próximo cambio importante. El 30 de septiembre de 2025, se retirará el acceso saliente predeterminado para las nuevas implementaciones y solo se permitirán las configuraciones de acceso explícitas",
            "waf": "Fiabilidad"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "b1c82a3f-2320-4dfa-8972-7ae4823c8930",
            "link": "https://learn.microsoft.com/azure/ddos-protection/ddos-protection-reference-architectures",
            "service": "VNet",
            "severity": "Alto",
            "text": "Agregue configuraciones de diagnóstico para guardar registros relacionados con DDoS para todas las direcciones IP públicas protegidas (DDoS IP o Protección de red).",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Seguridad"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "715d833d-4708-4527-90ac-1b142c7045ba",
            "link": "https://learn.microsoft.com/en-us/azure/firewall/firewall-structured-logs",
            "service": "Firewall",
            "severity": "Medio",
            "text": "Agregue la configuración de diagnóstico para guardar registros, mediante la tabla de destino Recurso específico, para todas las implementaciones de Azure Firewall.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Operaciones"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "e960fc6b-4ab2-4db6-9609-3745135f9ffa",
            "link": "https://learn.microsoft.com/en-us/azure/firewall-manager/migrate-to-policy",
            "service": "Firewall",
            "severity": "Importante",
            "text": "Migre de las reglas de Azure Firewall clásico (si existen) a la directiva de firewall.",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Operaciones"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "d301d6e8-72e5-42e3-911c-c58b5a4b1511",
            "link": "https://learn.microsoft.com/azure/virtual-network/vnet-integration-for-azure-services",
            "service": "App Gateway",
            "severity": "Alto",
            "text": "Asegúrese de que la comunicación del plano de control para los servicios PaaS de Azure insertados en una red virtual no se interrumpa, por ejemplo, con una ruta 0.0.0.0/0 o una regla de grupo de seguridad de red que bloquee el tráfico del plano de control.",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/?source=learn",
            "waf": "Seguridad"
        },
        {
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "guid": "b3e4563a-4d87-4397-98b6-62d6d15f512a",
            "link": "https://learn.microsoft.com/azure/app-service/networking-features",
            "service": "ExpressRoute",
            "severity": "Medio",
            "text": "Acceda a los servicios PaaS de Azure desde el entorno local a través de puntos de conexión privados y emparejamiento privado de ExpressRoute. Este método evita el tránsito a través de la Internet pública.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type =~ 'microsoft.network/virtualnetworks' | project id,resourceGroup,name,subnets = properties.subnets | mv-expand subnets | project id = subnets.id, resourceGroup, VNet = name, serviceEndpoints = subnets.properties.serviceEndpoints, compliant = (isnull(subnets.properties.serviceEndpoints) or array_length(subnets.properties.serviceEndpoints) == 0) | order by compliant asc",
            "guid": "4704489a-8042-4d88-b79d-17b73b22a5a6",
            "link": "https://learn.microsoft.com/azure/app-service/networking-features",
            "service": "VNet",
            "severity": "Medio",
            "text": "No habilite los puntos de conexión de servicio de red virtual de forma predeterminada en todas las subredes.",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/?source=learn",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "7e7a8ed4-b30e-438c-9f29-812b2363cefe",
            "link": "https://learn.microsoft.com/azure/app-service/networking-features",
            "service": "Firewall",
            "severity": "Medio",
            "text": "Filtre el tráfico de salida a los servicios PaaS de Azure mediante FQDN en lugar de direcciones IP en Azure Firewall o una aplicación virtual de red para evitar la filtración de datos. Si usa Private Link, puede bloquear todos los FQDN, de lo contrario, permita solo los servicios PaaS necesarios.",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/?source=learn",
            "waf": "Seguridad"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,subnets=properties.subnets | mv-expand subnets | project id, subnetName = subnets.name, subnetPrefix = subnets.properties.addressPrefix | extend subnetPrefixLength = split(subnetPrefix, '/')[1] | where subnetName == 'AzureFirewallSubnet' | extend compliant = (subnetPrefixLength == 26) | distinct id, compliant",
            "guid": "22d6419e-b627-4d95-9e7d-019fa759387f",
            "link": "https://learn.microsoft.com/azure/firewall/firewall-faq#why-does-azure-firewall-need-a--26-subnet-size",
            "service": "Firewall",
            "severity": "Alto",
            "text": "Use un prefijo /26 para las subredes de Azure Firewall.",
            "waf": "Seguridad"
        },
        {
            "ammp": true,
            "arm-service": "microsoft.network/expressRouteCircuits",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/virtualnetworks' | project id,subnets=properties.subnets | mv-expand subnets | project id, subnetName = subnets.name, subnetPrefix = subnets.properties.addressPrefix | extend subnetPrefixLength = split(subnetPrefix, '/')[1] | where subnetName == 'GatewaySubnet' | extend compliant = (subnetPrefixLength <= 27) | distinct id, compliant",
            "guid": "f2aad7e3-bb03-4adc-8606-4123d342a917",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-howto-add-gateway-resource-manager#add-a-gateway",
            "service": "ExpressRoute",
            "severity": "Alto",
            "text": "Use al menos un prefijo /27 para las subredes de puerta de enlace",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/networksecuritygroups' | mvexpand properties.securityRules | project id,name,ruleAction=properties_securityRules.properties.access,rulePriority=properties_securityRules.properties.priority,ruleDst=properties_securityRules.properties.destinationAddressPrefix,ruleSrc=properties_securityRules.properties.sourceAddressPrefix,ruleProt=properties_securityRules.properties.protocol,ruleDirection=properties_securityRules.properties.direction,rulePort=properties_securityRules.properties.destinationPortRange | summarize StarDenies=countif(ruleAction=='Deny' and ruleDst=='*' and ruleSrc=='*' and ruleProt=='*' and rulePort=='*') by id,tostring(ruleDirection) | where ruleDirection == 'Inbound' | project id,compliant=(StarDenies>0) | union (resources | where type=='microsoft.network/networksecuritygroups' | where array_length(properties.securityRules)==0 | extend compliant=false | project id,compliant)",
            "guid": "11deb39d-8299-4e47-bbe0-0fb5a36318a8",
            "link": "https://learn.microsoft.com/azure/virtual-network/service-tags-overview#available-service-tags",
            "service": "NSG",
            "severity": "Medio",
            "text": "No confíe en las reglas predeterminadas de entrada del grupo de seguridad de red que usan la etiqueta de servicio VirtualNetwork para limitar la conectividad.",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "872e52e3-611c-4c58-a5a4-b1511e43a58a",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview",
            "service": "NSG",
            "severity": "Medio",
            "text": "Use grupos de seguridad de red para ayudar a proteger el tráfico entre subredes, así como el tráfico este/oeste a través de la plataforma (tráfico entre zonas de aterrizaje).",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "graph": "Resources | where type=='microsoft.network/virtualnetworks' | project id,resourceGroup,name,subnets=properties.subnets | mv-expand subnets | project id,name,subnetName=subnets.name,subnetNsg=subnets.properties.networkSecurityGroup | where not (subnetName in ('GatewaySubnet', 'AzureFirewallSubnet', 'RouteServerSubnet', 'AzureBastionSubnet')) | extend compliant = isnotnull(subnetNsg)",
            "guid": "9c2299c4-d7b5-47d0-a655-562f2b3e4563",
            "service": "NSG",
            "severity": "Medio",
            "text": "El equipo de aplicaciones debe usar grupos de seguridad de aplicaciones en los grupos de seguridad de red de nivel de subred para ayudar a proteger las máquinas virtuales de varios niveles dentro de la zona de aterrizaje.",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "a4d87397-48b6-462d-9d15-f512a65498f6",
            "link": "https://learn.microsoft.com/azure/virtual-network/network-security-group-how-it-works",
            "service": "NSG",
            "severity": "Medio",
            "text": "Use grupos de seguridad de red y grupos de seguridad de aplicaciones para microsegmentar el tráfico dentro de la zona de aterrizaje y evitar el uso de una aplicación virtual de red central para filtrar los flujos de tráfico.",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "dfe237de-143b-416c-91d7-aa9b64704489",
            "link": "https://learn.microsoft.com/azure/virtual-network/network-security-group-how-it-works",
            "service": "NSG",
            "severity": "Medio",
            "text": "Habilite los registros de flujo de red virtual e introdúzcalos en Análisis de tráfico para obtener información sobre los flujos de tráfico internos y externos.",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-network-monitoring/",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type == 'microsoft.network/networksecuritygroups' | project id, rules = array_length(properties.securityRules) | project id, compliant = (rules < 900)",
            "guid": "0390417d-53dc-44d9-b3f4-c8832f359b41",
            "link": "https://learn.microsoft.com/en-us/azure/azure-resource-manager/management/azure-subscription-service-limits",
            "service": "NSG",
            "severity": "Medio",
            "text": "Tenga en cuenta el límite de reglas de grupo de seguridad de red por grupo de seguridad de red (1000).",
            "training": "https://learn.microsoft.com/en-us/azure/virtual-network/network-security-group-how-it-works",
            "waf": "Fiabilidad"
        },
        {
            "arm-service": "microsoft.network/virtualWans",
            "checklist": "Azure Landing Zone Review",
            "guid": "412e7f98-3f63-4047-82dd-69c5b5c2622f",
            "link": "https://learn.microsoft.com/azure/virtual-wan/scenario-any-to-any",
            "service": "VWAN",
            "severity": "Medio",
            "text": "Considere la posibilidad de utilizar Virtual WAN para simplificar la administración de redes de Azure y asegúrese de que el escenario se describe explícitamente en la lista de diseños de enrutamiento de Virtual WAN",
            "training": "https://learn.microsoft.com/learn/modules/introduction-azure-virtual-wan/",
            "waf": "Operaciones"
        },
        {
            "arm-service": "microsoft.network/virtualWans",
            "checklist": "Azure Landing Zone Review",
            "guid": "54b69bad-33aa-4d5e-ac68-e1d76667313b",
            "link": "https://learn.microsoft.com/azure/virtual-wan/virtual-wan-about",
            "service": "VWAN",
            "severity": "Medio",
            "text": "Use un centro de conectividad de Virtual WAN por región de Azure para conectar varias zonas de aterrizaje entre sí en las regiones de Azure a través de una instancia global común de Azure Virtual WAN.",
            "waf": "Rendimiento"
        },
        {
            "arm-service": "microsoft.network/virtualWans",
            "checklist": "Azure Landing Zone Review",
            "guid": "8ac6a9e0-1e6a-483d-b5de-32c199248160",
            "link": "https://learn.microsoft.com/azure/virtual-wan/virtual-wan-about",
            "service": "VWAN",
            "severity": "Bajo",
            "text": "Siga el principio \"el tráfico de Azure permanece en Azure\" para que la comunicación entre los recursos de Azure se produzca a través de la red troncal de Microsoft",
            "waf": "Rendimiento"
        },
        {
            "arm-service": "microsoft.network/virtualWans",
            "checklist": "Azure Landing Zone Review",
            "graph": "resources | where type=='microsoft.network/virtualhubs' | extend compliant = isnotnull(properties.azureFirewall.id) | project id, compliant",
            "guid": "7d5d1e4e-6146-458d-9558-fd77249b8211",
            "link": "https://learn.microsoft.com/azure/virtual-wan/virtual-wan-about",
            "service": "VWAN",
            "severity": "Medio",
            "text": "Para la protección y el filtrado del tráfico de Internet saliente, implemente Azure Firewall en centros seguros",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "waf": "Seguridad"
        },
        {
            "arm-service": "microsoft.network/virtualWans",
            "checklist": "Azure Landing Zone Review",
            "guid": "6667313b-4f56-464b-9e98-4a859c773e7d",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits",
            "service": "VWAN",
            "severity": "Medio",
            "text": "Asegúrese de que la arquitectura de red está dentro de los límites de Azure Virtual WAN.",
            "waf": "Fiabilidad"
        },
        {
            "arm-service": "microsoft.network/virtualWans",
            "checklist": "Azure Landing Zone Review",
            "guid": "261623a7-65a9-417e-8f34-8ef254c27d42",
            "link": "https://learn.microsoft.com/azure/virtual-wan/azure-monitor-insights",
            "service": "VWAN",
            "severity": "Medio",
            "text": "Use Azure Monitor Insights para Virtual WAN para supervisar la topología de un extremo a otro de Virtual WAN, el estado y las métricas clave.",
            "waf": "Operaciones"
        },
        {
            "arm-service": "microsoft.network/virtualWans",
            "checklist": "Azure Landing Zone Review",
            "guid": "727c77e1-b9aa-4a37-a024-129d042422c1",
            "link": "https://learn.microsoft.com/azure/virtual-wan/virtual-wan-faq#is-branch-to-branch-connectivity-allowed-in-virtual-wan",
            "service": "VWAN",
            "severity": "Medio",
            "text": "Asegúrese de que las implementaciones de IaC no deshabiliten el tráfico de sucursal a sucursal en Virtual WAN, a menos que estos flujos se bloqueen explícitamente.",
            "waf": "Fiabilidad"
        },
        {
            "arm-service": "microsoft.network/virtualWans",
            "checklist": "Azure Landing Zone Review",
            "guid": "d49ac006-6670-4bc9-9948-d3e0a3a94f4d",
            "link": "https://learn.microsoft.com/azure/virtual-wan/about-virtual-hub-routing-preference",
            "service": "VWAN",
            "severity": "Medio",
            "text": "Use AS-Path como preferencia de enrutamiento del centro, ya que es más flexible que ExpressRoute o VPN.",
            "waf": "Fiabilidad"
        },
        {
            "arm-service": "microsoft.network/virtualWans",
            "checklist": "Azure Landing Zone Review",
            "guid": "2586b854-237e-47f1-84a1-d45d4cd2310d",
            "link": "https://learn.microsoft.com/azure/virtual-wan/about-virtual-hub-routing#labels",
            "service": "VWAN",
            "severity": "Medio",
            "text": "Asegúrese de que las implementaciones de IaC configuran la propagación basada en etiquetas en Virtual WAN, de lo contrario, la conectividad entre los centros virtuales se verá afectada.",
            "waf": "Fiabilidad"
        },
        {
            "ammp": true,
            "arm-service": "microsoft.network/virtualWans",
            "checklist": "Azure Landing Zone Review",
            "guid": "9c75dfef-573c-461c-a698-68598595581a",
            "link": "https://learn.microsoft.com/azure/virtual-wan/virtual-wan-faq#what-is-the-recommended-hub-address-space-during-hub-creation",
            "service": "VWAN",
            "severity": "Alto",
            "text": "Asigne suficiente espacio IP a los centros virtuales, idealmente un prefijo /23.",
            "waf": "Fiabilidad"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "5c986cb2-9131-456a-8247-6e49f541acdc",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "service": "Policy",
            "severity": "Alto",
            "text": "Aproveche Azure Policy estratégicamente, defina controles para su entorno y use iniciativas de directivas para agrupar directivas relacionadas.",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "e979377b-cdb3-4751-ab2a-b13ada6e55d7",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/naming-and-tagging",
            "service": "Policy",
            "severity": "Medio",
            "text": "Identifique las etiquetas de Azure necesarias y use el modo de directiva \"anexar\" para aplicar el uso a través de Azure Policy.",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "d8a2adb1-17d6-4326-af62-5ca44e5695f2",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "service": "Policy",
            "severity": "Medio",
            "text": "Asigne los requisitos normativos y de cumplimiento normativo a las definiciones de Azure Policy y a las asignaciones de roles de Azure.",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "223ace8c-b123-408c-a501-7f154e3ab369",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "service": "Policy",
            "severity": "Medio",
            "text": "Establezca definiciones de Azure Policy en el grupo de administración raíz intermedio para que se puedan asignar en ámbitos heredados",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "3829e7e3-1618-4368-9a04-77a209945bda",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "service": "Policy",
            "severity": "Medio",
            "text": "Administre las asignaciones de directivas en el nivel más alto adecuado con exclusiones en los niveles inferiores, si es necesario.",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "43334f24-9116-4341-a2ba-527526944008",
            "link": "https://learn.microsoft.com/security/benchmark/azure/mcsb-asset-management#am-2-use-only-approved-services",
            "service": "Policy",
            "severity": "Bajo",
            "text": "Use Azure Policy para controlar qué servicios pueden aprovisionar los usuarios en el nivel de suscripción o grupo de administración",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "be7d7e48-4327-46d8-adc0-55bcf619e8a1",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "service": "Policy",
            "severity": "Medio",
            "text": "Utilice políticas integradas siempre que sea posible para minimizar la sobrecarga operativa.",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "description": "La asignación del rol Colaborador de directivas de recursos a ámbitos específicos le permite delegar la administración de directivas a los equipos pertinentes. Por ejemplo, un equipo de TI central puede supervisar las directivas a nivel de grupo de administración, mientras que los equipos de aplicaciones se encargan de las directivas de sus suscripciones, lo que permite la gobernanza distribuida con el cumplimiento de los estándares de la organización.",
            "guid": "3f988795-25d6-4268-a6d7-0ba6c97be995",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview#azure-rbac-permissions-in-azure-policy",
            "service": "Policy",
            "severity": "Medio",
            "text": "Asigne el rol integrado Colaborador de directivas de recursos en un ámbito determinado para habilitar la gobernanza de nivel de aplicación.",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "19048384-5c98-46cb-8913-156a12476e49",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview",
            "service": "Policy",
            "severity": "Medio",
            "text": "Limite el número de asignaciones de Azure Policy realizadas en el ámbito del grupo de administración raíz para evitar la administración a través de exclusiones en ámbitos heredados.",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "5a917e1f-348e-4f25-9c27-d42e8bbac757",
            "link": "https://azure.microsoft.com/resources/achieving-compliant-data-residency-and-security-with-azure/",
            "service": "Policy",
            "severity": "Medio",
            "text": "Si existen requisitos de soberanía de datos, se pueden implementar directivas de Azure para aplicarlos",
            "training": "https://learn.microsoft.com/learn/paths/secure-your-cloud-data/",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "78b22132-b41c-460b-a4d3-df8f73a67dc2",
            "link": "https://github.com/Azure/sovereign-landing-zone/blob/main/docs/scenarios/Sovereignty-Policy-Baseline.md",
            "service": "Policy",
            "severity": "Medio",
            "text": "En el caso de la Zona de Aterrizaje Soberana, la iniciativa política de referencia de la política de soberanía se despliega y asigna al nivel correcto de MG.",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "caeea0e9-1024-41df-a52e-d99c3f22a6f4",
            "link": "https://learn.microsoft.com/en-us/industry/sovereignty/policy-portfolio-baseline",
            "service": "Policy",
            "severity": "Medio",
            "text": "En el caso de la Zona de Aterrizaje Soberana, se documentan los objetivos de control soberano para el mapeo de políticas.",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "9b461617-db7b-4399-8ac6-d4eb7153893a",
            "service": "Policy",
            "severity": "Medio",
            "text": "En el caso de la Zona de Aterrizaje Soberana, existe un proceso para el CRUD de \"Objetivos de Control Soberano para el mapeo de políticas\".",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "9b5e2a28-9823-4faf-ab7e-afa5f6c57221",
            "link": "https://learn.microsoft.com/azure/automation/automation-solution-vm-management-config",
            "service": "VM",
            "severity": "Bajo",
            "text": "Considere la posibilidad de usar etiquetas de automatización para iniciar o detener máquinas virtuales en su entorno para ahorrar costos.",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "ecdc7506-6f37-4ea9-be87-fc5d3df08a64",
            "link": "https://learn.microsoft.com/azure/virtual-machine-scale-sets/overview",
            "service": "VMSS",
            "severity": "Medio",
            "text": "Aproveche los conjuntos de escalado de máquinas virtuales de Azure para escalar horizontalmente y horizontalmente en función de la carga.",
            "waf": "Fiabilidad"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "89cc5e11-aa4d-4c3b-893d-feb99215266a",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#add-diagnostic-settings-to-save-your-wafs-logs",
            "service": "WAF",
            "severity": "Alto",
            "text": "Agregue la configuración de diagnóstico para guardar los registros de WAF de los servicios de entrega de aplicaciones, como Azure Front Door y Azure Application Gateway. Revise periódicamente los registros para comprobar si hay ataques y detecciones de falsos positivos.",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "7f408960-c626-44cb-a018-347c8d790cdf",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#send-logs-to-microsoft-sentinel",
            "service": "WAF",
            "severity": "Medio",
            "text": "Envíe registros de WAF desde los servicios de entrega de aplicaciones, como Azure Front Door y Azure Application Gateway, a Microsoft Sentinel. Detecte ataques e integre la telemetría de WAF en su entorno general de Azure.",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "eba8cf22-45c6-4dc1-9b57-2cceb3b97ce5",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-redundancy",
            "service": "Backup",
            "severity": "Medio",
            "text": "Al usar Azure Backup, tenga en cuenta los diferentes tipos de copia de seguridad (GRS, ZRS Y LRS), ya que la configuración predeterminada es GRS",
            "waf": "Fiabilidad"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "67e7a8ed-4b30-4e38-a3f2-9812b2363cef",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/design-logs-deployment",
            "service": "Monitor",
            "severity": "Medio",
            "text": "Use un área de trabajo de registros de un único monitor para administrar las plataformas de forma centralizada, excepto cuando el control de acceso basado en rol de Azure (Azure RBAC), los requisitos de soberanía de datos o las directivas de retención de datos exijan áreas de trabajo independientes.",
            "training": "https://learn.microsoft.com/azure/azure-monitor/logs/design-logs-deployment",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "5e6c4cfd-3e50-4454-9c24-47ec66138a72",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/data-retention-archive?tabs=portal-1%2Cportal-2#how-retention-and-archiving-work",
            "service": "Monitor",
            "severity": "Medio",
            "text": "Use los registros de Azure Monitor cuando los requisitos de retención de registros superen los dos años. Actualmente puede mantener los datos archivados durante un máximo de 7 años.",
            "training": "https://learn.microsoft.com/learn/paths/architect-infrastructure-operations/",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "00f1ce16-ed30-41d6-b872-e52e3611cc58",
            "link": "https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/govern/policy-compliance/regulatory-compliance",
            "service": "Policy",
            "severity": "Medio",
            "text": "Use Azure Policy para el control de acceso y los informes de cumplimiento. Azure Policy proporciona la capacidad de aplicar la configuración de toda la organización para garantizar el cumplimiento coherente de las directivas y la detección rápida de infracciones.",
            "training": "https://learn.microsoft.com/en-us/azure/governance/policy/concepts/effects",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "e7d7e484-3276-4d8b-bc05-5bcf619e8a13",
            "link": "https://learn.microsoft.com/azure/governance/policy/how-to/guest-configuration-create",
            "service": "VM",
            "severity": "Medio",
            "text": "Supervise el desfase de configuración de la máquina virtual (VM) invitada mediante Azure Policy. La habilitación de las capacidades de auditoría de configuración de invitado a través de la directiva ayuda a las cargas de trabajo del equipo de aplicaciones a consumir inmediatamente las capacidades de las funciones con poco esfuerzo.",
            "training": "https://learn.microsoft.com/learn/paths/implement-resource-mgmt-security/",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "f9887952-5d62-4688-9d70-ba6c97be9951",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/management-operational-compliance#update-management-considerations ",
            "service": "VM",
            "severity": "Medio",
            "text": "Use Azure Update Manager como mecanismo de aplicación de revisiones para máquinas virtuales Windows y Linux en Azure.",
            "training": "https://learn.microsoft.com/azure/update-manager/overview?tabs=azure-vms",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "c806c048-26b7-4ddf-b4c2-b4f0c476925d",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/management-operational-compliance#update-management-considerations ",
            "service": "VM",
            "severity": "Medio",
            "text": "Use Azure Update Manager como mecanismo de aplicación de revisiones para máquinas virtuales Windows y Linux fuera de Azure mediante Azure Arc.",
            "training": "https://learn.microsoft.com/azure/update-manager/overview?tabs=azure-vms",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "90483845-c986-4cb2-a131-56a12476e49f",
            "link": "https://learn.microsoft.com/azure/network-watcher/network-watcher-monitoring-overview",
            "service": "Network Watcher",
            "severity": "Medio",
            "text": "Utilice Network Watcher para supervisar de forma proactiva los flujos de tráfico",
            "training": "https://learn.microsoft.com/learn/modules/configure-network-watcher/",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "9945bda4-3334-4f24-a116-34182ba52752",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/design-logs-deployment",
            "service": "Monitor",
            "severity": "Medio",
            "text": "Use un área de trabajo centralizada de Log Analytics de Azure Monitor para recopilar registros y métricas de los recursos de aplicaciones IaaS y PaaS y controlar el acceso a los registros con Azure RBAC.",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "6944008b-e7d7-4e48-9327-6d8bdc055bcf",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-setup-guide/monitoring-reporting?tabs=AzureMonitor",
            "service": "Monitor",
            "severity": "Medio",
            "text": "Use los registros de Azure Monitor para obtener información e informes.",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "97be9951-9048-4384-9c98-6cb2913156a1",
            "link": "https://learn.microsoft.com/azure/azure-monitor/alerts/alerts-overview",
            "service": "Monitor",
            "severity": "Medio",
            "text": "Use alertas de Azure Monitor para la generación de alertas operativas.",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "fed3c55f-a67e-4875-aadd-3aba3f9fde31",
            "link": "https://learn.microsoft.com/azure/automation/how-to/region-mappings",
            "service": "Monitor",
            "severity": "Medio",
            "text": "Al usar el seguimiento de cambios e inventario a través de cuentas de Azure Automation, asegúrese de que ha seleccionado las regiones admitidas para vincular el área de trabajo de Log Analytics y las cuentas de automatización.",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "f541acdc-e979-4377-acdb-3751ab2ab13a",
            "link": "https://learn.microsoft.com/azure/governance/policy/concepts/guest-configuration",
            "service": "VM",
            "severity": "Medio",
            "text": "Use directivas de Azure para implementar automáticamente configuraciones de software a través de extensiones de máquina virtual y aplicar una configuración de máquina virtual de línea base compatible.",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "description": "Las características de configuración de invitado de Azure Policy pueden auditar y corregir la configuración de la máquina (por ejemplo, el sistema operativo, la aplicación, el entorno) para asegurarse de que los recursos se alinean con las configuraciones esperadas, y Update Management puede aplicar la administración de revisiones para las máquinas virtuales.",
            "guid": "da6e55d7-d8a2-4adb-817d-6326af625ca4",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/management-operational-compliance#monitoring-for-configuration-drift",
            "service": "VM",
            "severity": "Medio",
            "text": "Supervise el desfase de la configuración de seguridad de la máquina virtual a través de Azure Policy.",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "2476e49f-541a-4cdc-b979-377bcdb3751a",
            "link": "https://learn.microsoft.com/azure/site-recovery/site-recovery-overview",
            "service": "VM",
            "severity": "Medio",
            "text": "Use Azure Site Recovery para escenarios de recuperación ante desastres de Azure a Azure Virtual Machines. Esto le permite replicar cargas de trabajo en todas las regiones.",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "f625ca44-e569-45f2-823a-ce8cb12308ca",
            "link": "https://learn.microsoft.com/azure/backup/backup-center-overview",
            "service": "Backup",
            "severity": "Medio",
            "text": "Use funcionalidades de copia de seguridad nativas de Azure o una solución de copia de seguridad de terceros compatible con Azure.",
            "waf": "Operaciones"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "826c5c45-bb79-4951-a812-e3bfbfd7326b",
            "link": "https://learn.microsoft.com/azure/reliability/availability-zones-overview",
            "service": "VM",
            "severity": "Alto",
            "text": "Aproveche las zonas de disponibilidad para las máquinas virtuales en las regiones en las que se admiten.",
            "waf": "Fiabilidad"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "7ccb7c06-5511-42df-8177-d97f08d0337d",
            "link": "https://learn.microsoft.com/azure/virtual-machines/availability",
            "service": "VM",
            "severity": "Alto",
            "text": "Evite ejecutar una carga de trabajo de producción en una sola máquina virtual.",
            "waf": "Fiabilidad"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "84101f59-1941-4195-a270-e28034290e3a",
            "link": "https://learn.microsoft.com/azure/load-balancer/load-balancer-overview",
            "service": "VM",
            "severity": "Medio",
            "text": "Azure Load Balancer y Application Gateway distribuyen el tráfico de red entrante entre varios recursos.",
            "waf": "Fiabilidad"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "5017f154-e3ab-4369-9829-e7e316183687",
            "link": "https://learn.microsoft.com/azure/key-vault/general/overview",
            "service": "Key Vault",
            "severity": "Alto",
            "text": "Uso de Azure Key Vault para almacenar los secretos y las credenciales",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "graph": "ResourceContainers | where type=='microsoft.resources/subscriptions'| parse id with '/subscriptions/' SubscriptionID| project subscriptionId, SubscriptionName = name| join kind=leftouter (Resources| where type == 'microsoft.keyvault/vaults'| project id, name, subscriptionId) on subscriptionId| join kind= leftouter (Resources| where type == 'microsoft.keyvault/vaults'| summarize ResourceCount = count() by subscriptionId) on subscriptionId| extend RCount = iff(isnull(ResourceCount), 0, ResourceCount)| project-away ResourceCount| extend compliant = (RCount <> 1)",
            "guid": "a0477a20-9945-4bda-9333-4f2491163418",
            "link": "https://learn.microsoft.com/azure/key-vault/general/overview-throttling",
            "service": "Key Vault",
            "severity": "Medio",
            "text": "Use diferentes instancias de Azure Key Vaults para diferentes aplicaciones y regiones para evitar límites de escala de transacciones y restringir el acceso a los secretos.",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "2ba52752-6944-4008-ae7d-7e4843276d8b",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "severity": "Medio",
            "text": "Aprovisione Azure Key Vault con las directivas de eliminación temporal y purga habilitadas para permitir la protección de retención de los objetos eliminados.",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "dc055bcf-619e-48a1-9f98-879525d62688",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "severity": "Medio",
            "text": "Siga un modelo de privilegios mínimos limitando la autorización para eliminar claves, secretos y certificados de forma permanente a roles de identificador personalizados especializados de Microsoft Entra.",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "6d70ba6c-97be-4995-8904-83845c986cb2",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "severity": "Medio",
            "text": "Automatice el proceso de gestión y renovación de certificados con autoridades de certificación públicas para facilitar la administración.",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "913156a1-2476-4e49-b541-acdce979377b",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "severity": "Medio",
            "text": "Establezca un proceso automatizado para la rotación de claves y certificados.",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "cdb3751a-b2ab-413a-ba6e-55d7d8a2adb1",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "severity": "Medio",
            "text": "Habilite el firewall y el punto de conexión de servicio de red virtual o el punto de conexión privado en el almacén para controlar el acceso al almacén de claves.",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "17d6326a-f625-4ca4-9e56-95f2223ace8c",
            "link": "https://learn.microsoft.com/azure/key-vault/general/monitor-key-vault",
            "service": "Key Vault",
            "severity": "Medio",
            "text": "Use el área de trabajo de Log Analytics de Azure Monitor central de la plataforma para auditar el uso de claves, certificados y secretos en cada instancia de Key Vault.",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "b12308ca-5017-4f15-9e3a-b3693829e7e3",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "severity": "Medio",
            "text": "Delegue la creación de instancias de Key Vault y el acceso con privilegios, y use Azure Policy para aplicar una configuración coherente y compatible.",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "91163418-2ba5-4275-8694-4008be7d7e48",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "severity": "Medio",
            "text": "Use una instancia de Azure Key Vault por aplicación, por entorno, por región.",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "25d62688-6d70-4ba6-a97b-e99519048384",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices",
            "service": "Key Vault",
            "severity": "Medio",
            "text": "Si desea traer sus propias claves, es posible que esto no sea compatible con todos los servicios considerados. Implemente la mitigación pertinente para que las inconsistencias no obstaculicen los resultados deseados. Elija los pares de regiones y las regiones de recuperación ante desastres adecuados que minimicen la latencia.",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "4ac6b67c-b3a4-4ff9-8e87-b07a7ce7bbdb",
            "link": "https://learn.microsoft.com/en-us/industry/sovereignty/key-management",
            "service": "Key Vault",
            "severity": "Medio",
            "text": "En el caso de la zona de aterrizaje soberana, use el HSM administrado de Azure Key Vault para almacenar los secretos y las credenciales.",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "4e5695f2-223a-4ce8-ab12-308ca5017f15",
            "link": "https://learn.microsoft.com/azure/active-directory/reports-monitoring/overview-reports",
            "service": "Entra",
            "severity": "Medio",
            "text": "Use las funcionalidades de informes de Microsoft Entra ID para generar informes de auditoría de control de acceso.",
            "waf": "Seguridad"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "09945bda-4333-44f2-9911-634182ba5275",
            "link": "https://learn.microsoft.com/azure/defender-for-cloud/concept-cloud-security-posture-management",
            "service": "Defender",
            "severity": "Alto",
            "text": "Habilite la administración de la posición de seguridad en la nube de Defender para todas las suscripciones.",
            "waf": "Seguridad"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "36a72a48-fffe-4c40-9747-0ab5064355ba",
            "link": "https://learn.microsoft.com/azure/defender-for-cloud/plan-defender-for-servers-select-plan",
            "service": "Defender",
            "severity": "Alto",
            "text": "Habilite un plan de protección de cargas de trabajo en la nube de Defender para servidores en todas las suscripciones.",
            "waf": "Seguridad"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "77425f48-ecba-43a0-aeac-a3ac733ccc6a",
            "link": "https://www.microsoft.com/en-gb/security/business/solutions/cloud-workload-protection",
            "service": "Defender",
            "severity": "Alto",
            "text": "Habilite los planes de protección de cargas de trabajo en la nube de Defender para recursos de Azure en todas las suscripciones.",
            "waf": "Seguridad"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "24d96b30-61ee-4436-a1cc-d6ef08bc574b",
            "link": "https://learn.microsoft.com/mem/configmgr/protect/deploy-use/endpoint-protection",
            "service": "VM",
            "severity": "Alto",
            "text": "Habilite Endpoint Protection en servidores IaaS.",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "15833ee7-ad6c-46d3-9331-65c7acbe44ab",
            "link": "https://learn.microsoft.com/azure/security-center/",
            "service": "VM",
            "severity": "Medio",
            "text": "Supervise el desfase de revisiones del sistema operativo base a través de los registros de Azure Monitor y Defender for Cloud.",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "e5f8d79f-2e87-4768-924c-516775c6ea95",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/design-logs-deployment",
            "service": "Monitor",
            "severity": "Medio",
            "text": "Conecte las configuraciones de recursos predeterminadas a un área de trabajo centralizada de Log Analytics de Azure Monitor.",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "1761e147-f65e-4d09-bbc2-f464f23e2eba",
            "link": "https://learn.microsoft.com/en-us/industry/sovereignty/transparency-logs",
            "service": "Entra",
            "severity": "Medio",
            "text": "En el caso de la zona de aterrizaje soberana, los registros de transparencia están habilitados en el inquilino de Entra ID.",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure Landing Zone Review",
            "guid": "d21a922d-5ca7-427a-82a6-35f7b21f1bfc",
            "link": "https://learn.microsoft.com/en-us/azure/security/fundamentals/customer-lockbox-overview",
            "service": "Entra",
            "severity": "Medio",
            "text": "En el caso de la zona de aterrizaje soberana, la caja de seguridad del cliente está habilitada en el inquilino de Entra ID.",
            "waf": "Seguridad"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "b03ed428-4617-4067-a787-85468b9ccf3f",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-require-secure-transfer",
            "service": "Storage",
            "severity": "Alto",
            "text": "La transferencia segura a cuentas de almacenamiento debe estar habilitada",
            "waf": "Seguridad"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "159aac9f-863f-4f48-82cf-00c28fa97a0e",
            "link": "https://learn.microsoft.com/azure/storage/blobs/data-protection-overview#recommendations-for-basic-data-protection",
            "service": "Storage",
            "severity": "Alto",
            "text": "Habilite la eliminación temporal del contenedor para que la cuenta de almacenamiento recupere un contenedor eliminado y su contenido.",
            "waf": "Seguridad"
        },
        {
            "ammp": true,
            "checklist": "Azure Landing Zone Review",
            "guid": "108d5099-a11d-4445-bd8b-e12a5e95412e",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/considerations/development-strategy-development-lifecycle#automated-builds",
            "service": "Key Vault",
            "severity": "Alto",
            "text": "Use secretos de Key Vault para evitar codificar de forma rígida información confidencial, como credenciales (máquinas virtuales, contraseñas de usuario), certificados o claves.",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "d7941d4a-7b6f-458f-8714-2f8f8c059ad4",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-error-handling-policies",
            "service": "APIM",
            "severity": "Medio",
            "text": "Implementar una política de control de errores a nivel global",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "0b0c0765-ff37-4369-90bd-3eb23ce71b08",
            "link": "https://learn.microsoft.com/azure/api-management/set-edit-policies?tabs=form#use-base-element-to-set-policy-evaluation-order",
            "service": "APIM",
            "severity": "Medio",
            "text": "Asegúrese de que todas las políticas de API incluyan un <base/> elemento.",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "a5c45b03-93b6-42fe-b16b-8fccb6a79902",
            "link": "https://learn.microsoft.com/azure/api-management/policy-fragments",
            "service": "APIM",
            "severity": "Medio",
            "text": "Uso de fragmentos de políticas para evitar repetir las mismas definiciones de políticas en varias API",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "c3818a95-6ff3-4474-88dc-e809b46dad6a",
            "link": "https://learn.microsoft.com/azure/api-management/monetization-support",
            "service": "APIM",
            "severity": "Medio",
            "text": "Si planeas monetizar tus API, revisa el artículo \"Soporte de monetización\" para conocer las prácticas recomendadas",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "a7d0840a-c8c4-4e83-adec-5ca578eb4049",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-use-azure-monitor#resource-logs",
            "service": "APIM",
            "severity": "Alto",
            "text": "Habilitación de la configuración de diagnóstico para exportar registros a Azure Monitor",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "8691fa38-45ed-4299-a247-fecd98d35deb",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-app-insights",
            "service": "APIM",
            "severity": "Medio",
            "text": "Habilitación de Application Insights para obtener telemetría más detallada",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "55fd27bb-76ac-4a91-bc37-049e885be6b7",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-use-azure-monitor",
            "service": "APIM",
            "severity": "Alto",
            "text": "Configurar alertas sobre las métricas más críticas",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "39460bdb-156f-4dc2-a87f-1e8c11ab0998",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/api-management-security-baseline?toc=%2Fazure%2Fapi-management%2F&bc=%2Fazure%2Fapi-management%2Fbreadcrumb%2Ftoc.json#certificate-management-in-azure-key-vault",
            "service": "APIM",
            "severity": "Alto",
            "text": "Asegúrese de que los certificados SSL personalizados se almacenan en Azure Key Vault para que se pueda acceder a ellos y actualizarlos de forma segura",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "e9217997-5f6c-479d-8576-8f2adf706ec8",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/api-management-security-baseline?toc=%2Fazure%2Fapi-management%2F&bc=%2Fazure%2Fapi-management%2Fbreadcrumb%2Ftoc.json#azure-ad-authentication-required-for-data-plane-access",
            "service": "APIM",
            "severity": "Alto",
            "text": "Protección de las solicitudes entrantes a las API (plano de datos) con Azure AD",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "5e5f64ba-c90e-480e-8888-398d96cf0bfb",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-aad",
            "service": "APIM",
            "severity": "Medio",
            "text": "Uso de Azure AD para autenticar usuarios en el Portal de desarrollador",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "f8e574ce-280f-49c8-b2ef-68279b081cf3",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-create-groups",
            "service": "APIM",
            "severity": "Medio",
            "text": "Crear grupos adecuados para controlar la visibilidad de los productos",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "06862505-2d9a-4874-9491-2837b00a3475",
            "link": "https://learn.microsoft.com/azure/api-management/backends",
            "service": "APIM",
            "severity": "Medio",
            "text": "Utilice la función Backends para eliminar las configuraciones redundantes de back-end de la API",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "03b125d5-b69b-4739-b7fd-84b86da4933e",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-properties?tabs=azure-portal",
            "service": "APIM",
            "severity": "Medio",
            "text": "Usar valores con nombre para almacenar valores comunes que se pueden usar en políticas",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "beae759e-4ddb-4326-bf26-47f87d3454b6",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-deploy-multi-region",
            "service": "APIM",
            "severity": "Medio",
            "text": "Implementación en varias regiones de Azure",
            "waf": "Fiabilidad"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "9c8d1664-dd9a-49d4-bd83-950af0af4044",
            "link": "https://learn.microsoft.com/azure/api-management/high-availability",
            "service": "APIM",
            "severity": "Medio",
            "text": "Implemente al menos dos unidades de escalado distribuidas en dos zonas de disponibilidad por región para obtener la mejor disponibilidad y rendimiento",
            "waf": "Fiabilidad"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "8d2db6e8-85c6-4118-a52c-ae76a4f27934",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/api-management-security-baseline?toc=%2Fazure%2Fapi-management%2F&bc=%2Fazure%2Fapi-management%2Fbreadcrumb%2Ftoc.json#service-native-backup-capability",
            "service": "APIM",
            "severity": "Alto",
            "text": "Asegúrese de que haya una rutina de copia de seguridad automatizada",
            "waf": "Fiabilidad"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "8210699f-8d43-45c2-8f19-57e54134bd8f",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-log-event-hubs",
            "service": "APIM",
            "severity": "Bajo",
            "text": "Si necesita iniciar sesión en niveles de alto rendimiento, tenga en cuenta la directiva de Event Hubs",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "121bfc39-fa7b-4096-b93b-ab56c1bc0bed",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-sample-flexible-throttling",
            "service": "APIM",
            "severity": "Medio",
            "text": "Aplicación de directivas de limitación para controlar el número de solicitudes por segundo",
            "training": "https://learn.microsoft.com/training/modules/protect-apis-on-api-management/",
            "waf": "Rendimiento"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "bb5f356b-3daf-47a2-a9ee-867a8100bbd5",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-autoscale",
            "service": "APIM",
            "severity": "Medio",
            "text": "Configurar el escalado automático para escalar horizontalmente el número de instancias cuando aumenta la carga",
            "waf": "Rendimiento"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "84b94abb-59b6-4b9d-8587-3413669468e8",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-provision-self-hosted-gateway",
            "service": "APIM",
            "severity": "Medio",
            "text": "Implemente puertas de enlace autohospedadas en las que Azure no tenga una región cercana a las API de back-end.",
            "waf": "Rendimiento"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "7519e385-a88b-4d34-966b-6269d686e890",
            "link": "https://learn.microsoft.com/azure/api-management/front-door-api-management",
            "service": "APIM",
            "severity": "Medio",
            "text": "Uso de Azure Front Door delante de APIM para la implementación en varias regiones",
            "waf": "Rendimiento"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "cd45c90e-7690-4753-930b-bf290c69c074",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/api-management-security-baseline?toc=%2Fazure%2Fapi-management%2F&bc=%2Fazure%2Fapi-management%2Fbreadcrumb%2Ftoc.json#virtual-network-integration",
            "service": "APIM",
            "severity": "Medio",
            "text": "Implementación del servicio dentro de una red virtual (VNet)",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "02661582-b3d1-48d1-9d7b-c6a918a0ca33",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/api-management-security-baseline?toc=%2Fazure%2Fapi-management%2F&bc=%2Fazure%2Fapi-management%2Fbreadcrumb%2Ftoc.json#network-security-group-support",
            "service": "APIM",
            "severity": "Medio",
            "text": "Implemente grupos de seguridad de red (NSG) en las subredes para restringir o supervisar el tráfico hacia/desde APIM.",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "67437a28-2721-4a2c-becd-caa54c8237a5",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/api-management-security-baseline?toc=%2Fazure%2Fapi-management%2F&bc=%2Fazure%2Fapi-management%2Fbreadcrumb%2Ftoc.json#azure-private-link",
            "service": "APIM",
            "severity": "Medio",
            "text": "Implemente puntos de conexión privados para filtrar el tráfico entrante cuando APIM no se implemente en una red virtual.",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "d698adbd-3288-44cb-b10a-9b572da395ae",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/api-management-security-baseline?toc=%2Fazure%2Fapi-management%2F&bc=%2Fazure%2Fapi-management%2Fbreadcrumb%2Ftoc.json#disable-public-network-access",
            "service": "APIM",
            "severity": "Alto",
            "text": "Deshabilitar el acceso a la red pública",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "0674d750-0c6f-4ac0-8717-ceec04d0bdbd",
            "link": "https://learn.microsoft.com/azure/api-management/automation-manage-api-management",
            "service": "APIM",
            "severity": "Medio",
            "text": "Simplifique la administración con scripts de automatización de PowerShell",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "c385bfcd-49fd-4786-81ba-cedbb4c57345",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/app-platform/api-management/platform-automation-and-devops#design-recommendations",
            "service": "APIM",
            "severity": "Medio",
            "text": "Revise las prácticas recomendadas de DevOps desde el acelerador de zonas de aterrizaje de API de Cloud Adaption Framework",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "6c3a27c0-197f-426c-9ffa-86fed51d9ab6",
            "link": "https://learn.microsoft.com/azure/api-management/visual-studio-code-tutorial",
            "service": "APIM",
            "severity": "Medio",
            "text": "Promover el uso de la extensión APIM de Visual Studio Code para un desarrollo de API más rápido",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "354f1c03-8112-4965-85ad-c0074bddf231",
            "link": "https://learn.microsoft.com/azure/api-management/devops-api-development-templates",
            "service": "APIM",
            "severity": "Medio",
            "text": "Implemente DevOps y CI/CD en su flujo de trabajo",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "b6439493-426a-45f3-9697-cf65baee208d",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-mutual-certificates-for-clients",
            "service": "APIM",
            "severity": "Medio",
            "text": "API seguras mediante la autenticación de certificados de cliente",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "2a67d143-1033-4c0a-8732-680896478f08",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-mutual-certificates",
            "service": "APIM",
            "severity": "Medio",
            "text": "Servicios de back-end seguros mediante la autenticación de certificados de cliente",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "074435f5-4a46-41ac-b521-d6114cb5d845",
            "link": "https://learn.microsoft.com/azure/api-management/mitigate-owasp-api-threats",
            "service": "APIM",
            "severity": "Medio",
            "text": "Revise el artículo \"Recomendaciones para mitigar las 10 principales amenazas de seguridad de la API de OWASP\" y compruebe qué es aplicable a sus API",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "5507c4b8-a7f8-41d6-9661-418c987100c9",
            "link": "https://learn.microsoft.com/azure/api-management/authorizations-overview",
            "service": "APIM",
            "severity": "Medio",
            "text": "Utilice la función Autorizaciones para simplificar la administración del token de OAuth 2.0 para las API de back-end",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "2deee033-b906-4bc2-9f26-c8d3699fe091",
            "link": "https://learn.microsoft.com/azure/api-management/api-management-howto-manage-protocols-ciphers",
            "service": "APIM",
            "severity": "Alto",
            "text": "Utilice la versión más reciente de TLS al cifrar la información en tránsito. Deshabilite los protocolos y cifrados obsoletos e innecesarios cuando sea posible.",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "f8af3d94-1d2b-4070-846f-849197524258",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/api-management-security-baseline?toc=%2Fazure%2Fapi-management%2F&bc=%2Fazure%2Fapi-management%2Fbreadcrumb%2Ftoc.json#im-8-restrict-the-exposure-of-credential-and-secrets",
            "service": "APIM",
            "severity": "Alto",
            "text": "Asegúrese de que los secretos (valores con nombre) se almacenan en Azure Key Vault para que se pueda acceder a ellos y actualizarlos de forma segura",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "791abd8b-7706-4e31-9569-afefde724be3",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/api-management-security-baseline?toc=%2Fazure%2Fapi-management%2F&bc=%2Fazure%2Fapi-management%2Fbreadcrumb%2Ftoc.json#managed-identities",
            "service": "APIM",
            "severity": "Medio",
            "text": "Uso de identidades administradas para autenticarse en otros recursos de Azure siempre que sea posible",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure API Management Review",
            "guid": "220c4ca6-6688-476b-b2b5-425a78e6fb87",
            "link": "https://learn.microsoft.com/security/benchmark/azure/baselines/api-management-security-baseline?toc=%2Fazure%2Fapi-management%2F&bc=%2Fazure%2Fapi-management%2Fbreadcrumb%2Ftoc.json#ns-6-deploy-web-application-firewall",
            "service": "APIM",
            "severity": "Alto",
            "text": "Uso del firewall de aplicaciones web (WAF) mediante la implementación de Application Gateway delante de APIM",
            "waf": "Seguridad"
        },
        {
            "checklist": "Redis Resiliency checklist",
            "guid": "65285269-440b-44be-9d3e-0844276d4bdc",
            "link": "https://learn.microsoft.com/azure/azure-cache-for-redis/cache-how-to-zone-redundancy",
            "service": "Redis",
            "text": "Azure Cache for Redis admite configuraciones con redundancia de zona en los niveles Premium y Enterprise. Una caché con redundancia de zona puede colocar sus nodos en diferentes zonas de disponibilidad de Azure en la misma región. Elimina la interrupción del centro de datos o de la zona de disponibilidad como único punto de error y aumenta la disponibilidad general de la memoria caché.",
            "waf": "Fiabilidad"
        },
        {
            "checklist": "Redis Resiliency checklist",
            "guid": "bc178bdc-5a06-4ca7-8443-51e19dd34429",
            "link": "https://learn.microsoft.com/en-us/azure/azure-cache-for-redis/cache-high-availability#persistence",
            "service": "Redis",
            "text": "Dado que los datos de caché se almacenan en la memoria, un error poco frecuente y no planeado de varios nodos puede hacer que se eliminen todos los datos. Para evitar la pérdida completa de datos, la persistencia de Redis permite tomar instantáneas periódicas de los datos en memoria y almacenarlas en la cuenta de almacenamiento.",
            "waf": "Fiabilidad"
        },
        {
            "checklist": "Redis Resiliency checklist",
            "guid": "eb722823-7a15-41c5-ab4e-4f1814387e5c",
            "link": "https://learn.microsoft.com/en-us/azure/azure-cache-for-redis/cache-high-availability#storage-account-for-persistence",
            "service": "Redis",
            "text": "Use una cuenta de almacenamiento con redundancia geográfica para conservar los datos de Azure Cache for Redis o con redundancia zonal donde la redundancia geográfica no esté disponible",
            "waf": "Fiabilidad"
        },
        {
            "checklist": "Redis Resiliency checklist",
            "guid": "a8c26c9b-32ab-45bd-bc69-98a135e33789",
            "link": "https://learn.microsoft.com/azure/azure-cache-for-redis/cache-how-to-geo-replication",
            "service": "Redis",
            "text": "La replicación geográfica es un mecanismo para vincular dos o más instancias de Azure Cache for Redis, que normalmente abarcan dos regiones de Azure. La replicación geográfica está diseñada principalmente para la recuperación ante desastres entre regiones. Dos instancias de caché de nivel Premium se conectan a través de la replicación geográfica de una manera que proporciona lecturas y escrituras en la caché principal, y esos datos se replican en la caché secundaria.",
            "waf": "Fiabilidad"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "ab5351f6-383a-45ed-9c5e-b143b16db40a",
            "link": "https://learn.microsoft.com/azure/aks/use-windows-hpc",
            "service": "AKS",
            "severity": "Bajo",
            "text": "Si es necesario para las cargas de trabajo de Windows de AKS, se pueden usar contenedores HostProcess",
            "waf": "Fiabilidad"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "a280dcf5-90ce-465d-b8e1-3f9ccbd46926",
            "link": "https://learn.microsoft.com/azure/azure-functions/functions-kubernetes-keda",
            "service": "AKS",
            "severity": "Bajo",
            "text": "Utilice KEDA si ejecuta cargas de trabajo controladas por eventos",
            "waf": "Rendimiento"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "26886d20-b66c-457b-a591-19bf8e8f5c58",
            "link": "https://dapr.io/",
            "service": "AKS",
            "severity": "Bajo",
            "text": "Uso de Dapr para facilitar el desarrollo de microservicios",
            "waf": "Operaciones"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (sku.tier=='Paid') | distinct id,compliant",
            "guid": "71d41e36-10cc-457b-9a4b-1410d4395898",
            "link": "https://learn.microsoft.com/azure/aks/uptime-sla",
            "service": "AKS",
            "severity": "Alto",
            "text": "Uso de la oferta de AKS respaldada por SLA",
            "waf": "Fiabilidad"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "c1288b3c-6a57-4cfc-9444-51e1a3d3453a",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-scheduler",
            "service": "AKS",
            "severity": "Bajo",
            "text": "Uso de presupuestos de interrupción en el pod y las definiciones de implementación",
            "waf": "Fiabilidad"
        },
        {
            "checklist": "Azure AKS Review",
            "guid": "3c763963-7a55-42d5-a15e-401955387e5c",
            "link": "https://learn.microsoft.com/azure/container-registry/container-registry-geo-replication",
            "service": "ACR",
            "severity": "Alto",
            "text": "Si usa un registro privado, configure la replicación de regiones para almacenar imágenes en varias regiones",
            "waf": "Fiabilidad"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "f82cb8eb-8c0a-4a63-a25a-4956eaa8dc4a",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/scenarios/aks/eslz-cost-governance-with-kubecost",
            "service": "AKS",
            "severity": "Bajo",
            "text": "Usar una aplicación externa como kubecost para asignar costos a diferentes usuarios",
            "waf": "Costar"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "4d3dfbab-9924-4831-a68d-fdf0d72f462c",
            "link": "https://learn.microsoft.com/azure/aks/scale-down-mode",
            "service": "AKS",
            "severity": "Bajo",
            "text": "Usar el modo de reducción vertical para eliminar/desasignar nodos",
            "waf": "Costar"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "87e651ea-bc4a-4a87-a6df-c06a4b570ebc",
            "link": "https://learn.microsoft.com/azure/aks/gpu-multi-instance",
            "service": "AKS",
            "severity": "Medio",
            "text": "Cuando sea necesario, use la GPU de partición de varias instancias en clústeres de AKS",
            "waf": "Costar"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "2b72a08b-0410-4cd6-9093-e068a5cf27e8",
            "link": "https://learn.microsoft.com/azure/aks/start-stop-nodepools",
            "service": "AKS",
            "severity": "Bajo",
            "text": "Si se ejecuta un clúster de desarrollo y pruebas, use NodePool Start/Stop",
            "waf": "Costar"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (isnotnull(properties.addonProfiles.azurepolicy) and properties.addonProfiles.azurepolicy.enabled==true) | distinct id,compliant",
            "guid": "9ca48e4a-85e2-4223-bce8-bb12307ca5f1",
            "link": "https://learn.microsoft.com/azure/governance/policy/concepts/policy-for-kubernetes",
            "service": "AKS",
            "severity": "Medio",
            "text": "Uso de Azure Policy para Kubernetes para garantizar el cumplimiento de clústeres",
            "waf": "Seguridad"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | project id,resourceGroup,name,pools=properties.agentPoolProfiles | project id,name,resourceGroup,poolcount=array_length(pools) | extend compliant = (poolcount > 1)",
            "guid": "6f158e3e-a3a9-42c2-be7e-2165c3a87af4",
            "link": "https://learn.microsoft.com/azure/aks/use-system-pools",
            "service": "AKS",
            "severity": "Medio",
            "text": "Separe las aplicaciones del plano de control con grupos de nodos de usuario/sistema",
            "waf": "Seguridad"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "a7a1f893-9bda-4477-98f2-4c116775c2ea",
            "link": "https://learn.microsoft.com/azure/aks/use-system-pools",
            "service": "AKS",
            "severity": "Bajo",
            "text": "Agregue taint a su grupo de nodos del sistema para que sea dedicado",
            "waf": "Seguridad"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "55b46a94-8008-4ae7-b7e4-b475b6c8bdbf",
            "link": "https://learn.microsoft.com/azure/container-registry/",
            "service": "AKS",
            "severity": "Medio",
            "text": "Utilice un registro privado para sus imágenes, como ACR",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure AKS Review",
            "guid": "59bce65d-e8a0-43f9-9879-468d66a786d6",
            "link": "https://learn.microsoft.com/azure/security-center/container-security",
            "service": "ACR",
            "severity": "Medio",
            "text": "Escanea tus imágenes en busca de vulnerabilidades",
            "waf": "Seguridad"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "d167dd18-2b0a-4c24-8b99-9a646f8389a7",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-cluster-isolation",
            "service": "AKS",
            "severity": "Alto",
            "text": "Definición de los requisitos de separación de aplicaciones (espacio de nombres/grupo de nodos/clúster)",
            "waf": "Seguridad"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "5e3df584-eccc-4d97-a3b6-bcda3b50eb2e",
            "link": "https://github.com/Azure/secrets-store-csi-driver-provider-azure",
            "service": "AKS",
            "severity": "Medio",
            "text": "Almacenamiento de los secretos en Azure Key Vault con el controlador del almacén de secretos de CSI",
            "waf": "Seguridad"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "b03dda6d-58d7-4c89-8ddb-107d5769ae66",
            "link": "https://learn.microsoft.com/azure/aks/update-credentials",
            "service": "AKS",
            "severity": "Alto",
            "text": "Si usa entidades de servicio para el clúster, actualice las credenciales periódicamente (por ejemplo, trimestralmente)",
            "waf": "Seguridad"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "e7ba73a3-0508-4f80-806f-527db30cee96",
            "link": "https://learn.microsoft.com/azure/aks/use-kms-etcd-encryption",
            "service": "AKS",
            "severity": "Medio",
            "text": "Si es necesario, agregue el servicio de administración de claves, etcd, cifrado",
            "waf": "Seguridad"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "ec8e4e42-0344-41b0-b865-9123e8956d31",
            "link": "https://learn.microsoft.com/azure/confidential-computing/confidential-nodes-aks-overview",
            "service": "AKS",
            "severity": "Bajo",
            "text": "Si es necesario, considere la posibilidad de usar Proceso confidencial para AKS",
            "waf": "Seguridad"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "c9e95ffe-6dd1-4a17-8c5f-110389ca9b21",
            "link": "https://learn.microsoft.com/azure/defender-for-cloud/defender-for-containers-enable",
            "service": "AKS",
            "severity": "Medio",
            "text": "Considere la posibilidad de usar Defender para contenedores",
            "waf": "Seguridad"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (properties.servicePrincipalProfile.clientId=='msi') | distinct id,compliant",
            "guid": "ed127dd1-42b0-46b2-8c69-99a646f3389a",
            "link": "https://learn.microsoft.com/azure/aks/use-managed-identity",
            "service": "AKS",
            "severity": "Alto",
            "text": "Uso de identidades administradas en lugar de entidades de servicio",
            "waf": "Seguridad"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = isnotnull(properties.aadProfile) | distinct id,compliant",
            "guid": "7e42c78e-78c0-46a6-8a21-94956e698dc4",
            "link": "https://learn.microsoft.com/azure/aks/managed-aad",
            "service": "AKS",
            "severity": "Medio",
            "text": "Integración de la autenticación con AAD (mediante la integración administrada)",
            "waf": "Seguridad"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "a2fe27b2-e287-401a-8352-beedf79b488d",
            "link": "https://learn.microsoft.com/azure/aks/control-kubeconfig-access",
            "service": "AKS",
            "severity": "Medio",
            "text": "Limitar el acceso a admin kubeconfig (get-credentials --admin)",
            "waf": "Seguridad"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "eec4962c-c3bd-421b-b77f-26e5e6b3bec3",
            "link": "https://learn.microsoft.com/azure/aks/manage-azure-rbac",
            "service": "AKS",
            "severity": "Medio",
            "text": "Integración de la autorización con RBAC de AAD",
            "waf": "Seguridad"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "d4f3537c-1346-4dc5-9027-a71ffe1bd05d",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-identity",
            "service": "AKS",
            "severity": "Alto",
            "text": "Uso de espacios de nombres para restringir el privilegio RBAC en Kubernetes",
            "waf": "Seguridad"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "d2e0d5d7-71d4-41e3-910c-c57b4a4b1410",
            "link": "https://learn.microsoft.com/azure/aks/workload-identity-migration-sidecar",
            "service": "AKS",
            "severity": "Medio",
            "text": "Para la administración de acceso a identidades de pods, use Azure AD Workload Identity (versión preliminar)",
            "waf": "Seguridad"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "f4dcf690-1b30-407d-abab-6f8aa780d3a3",
            "link": "https://learn.microsoft.com/azure/aks/managed-aad#non-interactive-sign-in-with-kubelogin",
            "service": "AKS",
            "severity": "Medio",
            "text": "En el caso de los inicios de sesión no interactivos de AKS, use kubelogin (versión preliminar)",
            "waf": "Seguridad"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (properties.disableLocalAccounts==true) | distinct id,compliant",
            "guid": "b085b1f2-3119-4771-8c9a-bbf4411810ec",
            "link": "https://learn.microsoft.com/azure/aks/managed-aad#disable-local-accounts",
            "service": "AKS",
            "severity": "Medio",
            "text": "Deshabilitación de cuentas locales de AKS",
            "waf": "Seguridad"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "36abb0db-c118-4f4c-9880-3f30f9a2deb6",
            "link": "https://learn.microsoft.com/azure/aks/managed-aad#configure-just-in-time-cluster-access-with-azure-ad-and-aks",
            "service": "AKS",
            "severity": "Bajo",
            "text": "Configure, si es necesario, el acceso al clúster Just-In-Time",
            "waf": "Seguridad"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "c4d7f4c6-79bf-45d0-aa05-ce8fc717e150",
            "link": "https://learn.microsoft.com/azure/aks/managed-aad#use-conditional-access-with-azure-ad-and-aks",
            "service": "AKS",
            "severity": "Bajo",
            "text": "Configure si es necesario el acceso condicional de AAD para AKS",
            "waf": "Seguridad"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "e1123a7c-a333-4eb4-a120-4ee3f293c9f3",
            "link": "https://learn.microsoft.com/azure/aks/use-group-managed-service-accounts",
            "service": "AKS",
            "severity": "Bajo",
            "text": "Si es necesario para las cargas de trabajo de Windows AKS, configure gMSA ",
            "waf": "Seguridad"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "1f711a74-3672-470b-b8b8-a2148d640d79",
            "link": "https://learn.microsoft.com/azure/aks/use-managed-identity#use-a-pre-created-kubelet-managed-identity",
            "service": "AKS",
            "severity": "Medio",
            "text": "Para un control más preciso, considere la posibilidad de utilizar una identidad de Kubelet administrada",
            "waf": "Seguridad"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "cbd8ac2a-aebc-4a2a-94da-1dbf3dc99248",
            "link": "https://azure.github.io/application-gateway-kubernetes-ingress/setup/install-existing/",
            "service": "AKS",
            "severity": "Medio",
            "text": "Si utiliza AGIC, no comparta un AppGW entre clústeres",
            "waf": "Fiabilidad"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (isnull(properties.addonProfiles.httpApplicationRouting) or properties.addonProfiles.httpApplicationRouting.enabled==false) | distinct id,compliant",
            "guid": "8008ae7d-7e4b-4475-a6c8-bdbf59bce65d",
            "link": "https://learn.microsoft.com/azure/aks/http-application-routing",
            "service": "AKS",
            "severity": "Alto",
            "text": "No use el complemento de enrutamiento HTTP de AKS, use en su lugar la entrada NGINX administrada con el complemento de enrutamiento de aplicaciones.",
            "waf": "Fiabilidad"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "7bacd7b9-c025-4a9d-a5d2-25d6bc5439d9",
            "link": "https://learn.microsoft.com/azure/virtual-network/accelerated-networking-overview",
            "service": "AKS",
            "severity": "Medio",
            "text": "En el caso de las cargas de trabajo de Windows, use las redes aceleradas",
            "waf": "Rendimiento"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (tolower(properties.networkProfile.loadBalancerSku)=='standard') | distinct id,compliant",
            "guid": "ba7da7be-9952-4914-a384-5d997cb39132",
            "link": "https://learn.microsoft.com/azure/aks/load-balancer-standard",
            "service": "AKS",
            "severity": "Alto",
            "text": "Utilice el ALB estándar (en lugar del básico)",
            "waf": "Fiabilidad"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "22fbe8d6-9b40-47ef-9011-25bb1a555a6b",
            "link": "https://learn.microsoft.com/azure/aks/use-multiple-node-pools#add-a-node-pool-with-a-unique-subnet",
            "service": "AKS",
            "severity": "Medio",
            "text": "Si usa Azure CNI, considere la posibilidad de usar diferentes subredes para NodePools",
            "waf": "Seguridad"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "c3c39c98-6bb2-4c12-859a-114b5e3df584",
            "link": "https://learn.microsoft.com/azure/private-link/private-link-overview",
            "service": "AKS",
            "severity": "Medio",
            "text": "Use puntos de conexión privados (preferidos) o puntos de conexión de servicio de red virtual para acceder a los servicios PaaS desde el clúster",
            "waf": "Seguridad"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (properties.networkProfile.networkPlugin=='azure') | distinct id,compliant",
            "guid": "a0f61565-9de5-458f-a372-49c831112dbd",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-network",
            "service": "AKS",
            "severity": "Alto",
            "text": "Elija el mejor complemento de red de CNI para sus necesidades (se recomienda Azure CNI)",
            "waf": "Fiabilidad"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "7faf12e7-0943-4f63-8472-2da29c2b1cd6",
            "link": "https://learn.microsoft.com/azure/aks/configure-azure-cni",
            "service": "AKS",
            "severity": "Alto",
            "text": "Si usa CNI de Azure, ajuste el tamaño de la subred en consecuencia teniendo en cuenta el número máximo de pods por nodo",
            "waf": "Rendimiento"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "22f54b29-bade-43aa-b1e8-c38ec9366673",
            "link": "https://learn.microsoft.com/azure/aks/configure-azure-cni",
            "service": "AKS",
            "severity": "Alto",
            "text": "Si usa Azure CNI, compruebe el número máximo de pods o nodo (valor predeterminado 30)",
            "waf": "Rendimiento"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "description": "En el caso de las aplicaciones internas, las organizaciones suelen abrir toda la subred de AKS en sus firewalls. Esto también abre el acceso de red a los nodos y, potencialmente, también a los pods (si se usa Azure CNI). Si las direcciones IP de LoadBalancer están en una subred diferente, solo esta debe estar disponible para los clientes de la aplicación. Otra razón es que si las direcciones IP de la subred de AKS son un recurso escaso, el consumo de sus direcciones IP para los servicios reducirá la escalabilidad máxima del clúster.",
            "guid": "13c00567-4b1e-4945-a459-c373e7ed6162",
            "link": "https://learn.microsoft.com/azure/aks/internal-lb",
            "service": "AKS",
            "severity": "Bajo",
            "text": "Si usa servicios de LoadBalancer de dirección IP privada, use una subred dedicada (no la subred de AKS)",
            "waf": "Seguridad"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "43f63047-22d9-429c-8b1c-d622f54b29ba",
            "link": "https://learn.microsoft.com/azure/aks/configure-azure-cni",
            "service": "AKS",
            "severity": "Alto",
            "text": "Dimensione el rango de direcciones IP del servicio en consecuencia (limitará la escalabilidad del clúster)",
            "waf": "Fiabilidad"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "57bf217f-6dc8-481c-81e2-785773e9c00f",
            "link": "https://learn.microsoft.com/azure/aks/use-byo-cni",
            "service": "AKS",
            "severity": "Bajo",
            "text": "Si es necesario, agregue su propio complemento CNI",
            "waf": "Seguridad"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "4b3bb365-9458-44d9-9ed1-5c8f52890364",
            "link": "https://learn.microsoft.com/azure/aks/use-multiple-node-pools#assign-a-public-ip-per-node-for-your-node-pools",
            "service": "AKS",
            "severity": "Bajo",
            "text": "Si es necesario, configure la dirección IP pública por nodo en AKS",
            "waf": "Rendimiento"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "b3808b9f-a1cf-4204-ad01-3a923ce474db",
            "link": "https://learn.microsoft.com/azure/aks/concepts-network",
            "service": "AKS",
            "severity": "Medio",
            "text": "Use un controlador de entrada para exponer aplicaciones basadas en web en lugar de exponerlas con servicios de tipo LoadBalancer",
            "waf": "Fiabilidad"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "ccb534e7-416e-4a1d-8e93-533b53199085",
            "link": "https://learn.microsoft.com/azure/aks/nat-gateway",
            "service": "AKS",
            "severity": "Bajo",
            "text": "Uso de Azure NAT Gateway como outboundType para escalar el tráfico de salida",
            "waf": "Fiabilidad"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "8ee9a69a-1b58-4b1e-9c61-476e110a160b",
            "link": "https://learn.microsoft.com/azure/aks/configure-azure-cni#dynamic-allocation-of-ips-and-enhanced-subnet-support",
            "service": "AKS",
            "severity": "Medio",
            "text": "Uso de asignaciones dinámicas de direcciones IP para evitar el agotamiento de direcciones IP de Azure CNI",
            "waf": "Fiabilidad"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (properties.networkProfile.outboundType=='userDefinedRouting') | distinct id,compliant",
            "guid": "3b365a91-7ecb-4e48-bbe5-4cd7df2e8bba",
            "link": "https://learn.microsoft.com/azure/aks/limit-egress-traffic",
            "service": "AKS",
            "severity": "Alto",
            "text": "Filtre el tráfico de salida con AzFW/NVA si sus requisitos de seguridad lo exigen",
            "waf": "Seguridad"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = ((isnull(properties.apiServerAccessProfile.enablePrivateCluster) or properties.apiServerAccessProfile.enablePrivateCluster==false) and isnotnull(properties.apiServerAccessProfile.authorizedIPRanges)) | distinct id,compliant",
            "guid": "c4581559-bb91-463e-a908-aed8c44ce3b2",
            "link": "https://learn.microsoft.com/azure/aks/api-server-authorized-ip-ranges",
            "service": "AKS",
            "severity": "Medio",
            "text": "Si utiliza un punto de conexión de API público, restrinja las direcciones IP que pueden acceder a él",
            "waf": "Seguridad"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | where isnotnull(properties.apiServerAccessProfile.enablePrivateCluster) | extend compliant = (properties.apiServerAccessProfile.enablePrivateCluster==true) | distinct id, compliant",
            "guid": "ecccd979-3b6b-4cda-9b50-eb2eb03dda6d",
            "link": "https://learn.microsoft.com/azure/aks/private-clusters",
            "service": "AKS",
            "severity": "Alto",
            "text": "Utilice clústeres privados si sus requisitos lo exigen",
            "waf": "Seguridad"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | where isnotnull(properties.apiServerAccessProfile.enablePrivateCluster) | extend compliant = (properties.apiServerAccessProfile.enablePrivateCluster==true) | distinct id, compliant",
            "guid": "ce7f2a7c-297c-47c6-adea-a6ff838db665",
            "link": "https://learn.microsoft.com/azure/aks/use-network-policies",
            "service": "AKS",
            "severity": "Medio",
            "text": "Para los nodos de AKS de Windows 2019 y 2022, se pueden usar directivas de red de Calico ",
            "waf": "Seguridad"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = isnotnull(properties.networkProfile.networkPolicy) | distinct id,compliant",
            "guid": "58d7c892-ddb1-407d-9769-ae669ca48e4a",
            "link": "https://learn.microsoft.com/azure/aks/use-network-policies",
            "service": "AKS",
            "severity": "Alto",
            "text": "Habilitación de una opción de directiva de red de Kubernetes (Calico/Azure)",
            "waf": "Seguridad"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "85e2223e-ce8b-4b12-907c-a5f16f158e3e",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-network",
            "service": "AKS",
            "severity": "Alto",
            "text": "Uso de directivas de red de Kubernetes para aumentar la seguridad dentro del clúster",
            "waf": "Seguridad"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "a3a92c2d-e7e2-4165-a3a8-7af4a7a1f893",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-network",
            "service": "AKS",
            "severity": "Alto",
            "text": "Uso de un WAF para cargas de trabajo web (interfaces de usuario o API)",
            "waf": "Seguridad"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "Resources | where type=~'microsoft.containerservice/managedclusters' | project resourceGroup,name,pools=properties.agentPoolProfiles | mv-expand pools | project subnetId=tostring(pools.vnetSubnetID) | where isnotempty(subnetId) | join (Resources | where type=='microsoft.network/virtualnetworks' | project id,resourceGroup,name,enableDdosProtection=tostring(properties.enableDdosProtection),subnets=properties.subnets | mv-expand subnets | project id,resourceGroup,name,enableDdosProtection,subnetId=tostring(subnets.id)) on subnetId | distinct id,resourceGroup,name,enableDdosProtection | extend compliant = (enableDdosProtection == 'true')",
            "guid": "9bda4776-8f24-4c11-9775-c2ea55b46a94",
            "link": "https://learn.microsoft.com/azure/virtual-network/ddos-protection-overview",
            "service": "AKS",
            "severity": "Medio",
            "text": "Uso de DDoS Standard en la red virtual de AKS",
            "waf": "Seguridad"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "Resources | where type=~'microsoft.containerservice/managedclusters' | project resourceGroup,name,pools=properties.agentPoolProfiles | mv-expand pools | project subnetId=tostring(pools.vnetSubnetID) | where isnotempty(subnetId) | join (Resources | where type=='microsoft.network/virtualnetworks' | project id,resourceGroup,name,enableDdosProtection=tostring(properties.enableDdosProtection),subnets=properties.subnets | mv-expand subnets | project id,resourceGroup,name,enableDdosProtection,subnetId=tostring(subnets.id)) on subnetId | distinct id,resourceGroup,name,enableDdosProtection | extend compliant = (enableDdosProtection == 'true')",
            "guid": "6c46b91a-1107-4485-ad66-3183e2a8c266",
            "link": "https://learn.microsoft.com/azure/aks/http-proxy",
            "service": "AKS",
            "severity": "Bajo",
            "text": "Si es necesario, agregue el proxy HTTP de la empresa",
            "waf": "Seguridad"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "e9855d04-c3c3-49c9-a6bb-2c12159a114b",
            "link": "https://learn.microsoft.com/azure/aks/servicemesh-about",
            "service": "AKS",
            "severity": "Medio",
            "text": "Considere la posibilidad de usar una malla de servicios para la administración avanzada de comunicaciones de microservicios",
            "waf": "Seguridad"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "67f7a9ed-5b31-4f38-a3f3-9812b2463cff",
            "link": "https://learn.microsoft.com/azure/azure-monitor/insights/container-insights-metric-alerts",
            "service": "AKS",
            "severity": "Alto",
            "text": "Configurar alertas sobre las métricas más críticas (consulte Container Insights para obtener recomendaciones)",
            "waf": "Operaciones"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "337453a3-cc63-4963-9a65-22ac19e80696",
            "link": "https://learn.microsoft.com/azure/advisor/advisor-get-started",
            "service": "AKS",
            "severity": "Bajo",
            "text": "Consulte periódicamente Azure Advisor para obtener recomendaciones sobre el clúster",
            "waf": "Operaciones"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "3aa70560-e7e7-4968-be3d-628af35b2ced",
            "link": "https://learn.microsoft.com/azure/aks/certificate-rotation",
            "service": "AKS",
            "severity": "Bajo",
            "text": "Habilitación de la rotación automática de certificados de AKS",
            "waf": "Operaciones"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "e189c599-df0d-45a7-9dd4-ce32c1881370",
            "link": "https://learn.microsoft.com/azure/aks/supported-kubernetes-versions",
            "service": "AKS",
            "severity": "Alto",
            "text": "Tenga un proceso regular para actualizar la versión de Kubernetes periódicamente (trimestralmente, por ejemplo) o use la característica de actualización automática de AKS",
            "waf": "Operaciones"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "6f7c4c0d-4e51-4464-ad24-57ed67138b82",
            "link": "https://learn.microsoft.com/azure/aks/node-updates-kured",
            "service": "AKS",
            "severity": "Alto",
            "text": "Utilice kured para las actualizaciones de nodos de Linux en caso de que no esté utilizando la actualización de imagen de nodo",
            "waf": "Operaciones"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "139c9580-ade3-426a-ba09-cf157d9f6477",
            "link": "https://learn.microsoft.com/azure/aks/node-image-upgrade",
            "service": "AKS",
            "severity": "Alto",
            "text": "Disponer de un proceso regular para actualizar las imágenes de los nodos del clúster periódicamente (semanalmente, por ejemplo)",
            "waf": "Operaciones"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "0102ce16-ee30-41e6-b882-e52e4621dd68",
            "link": "https://learn.microsoft.com/azure/architecture/example-scenario/bedrock/bedrock-automated-deployments",
            "service": "AKS",
            "severity": "Bajo",
            "text": "Considere la posibilidad de implementar aplicaciones o configuraciones de clústeres en varios clústeres",
            "waf": "Operaciones"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "d7672c26-7602-4482-85a4-14527fbe855c",
            "link": "https://learn.microsoft.com/azure/aks/command-invoke",
            "service": "AKS",
            "severity": "Bajo",
            "text": "Considere la posibilidad de usar la invocación de comandos de AKS en clústeres privados",
            "waf": "Operaciones"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "31d7aaab-7571-4449-ab80-53d89e89d17b",
            "link": "https://learn.microsoft.com/azure/aks/node-auto-repair#node-autodrain",
            "service": "AKS",
            "severity": "Bajo",
            "text": "En el caso de los eventos planeados, considere la posibilidad de utilizar el drenaje automático de nodos",
            "waf": "Operaciones"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "ed0fda7f-211b-47c7-8b6e-c18873fb473c",
            "link": "https://learn.microsoft.com/azure/aks/faq",
            "service": "AKS",
            "severity": "Alto",
            "text": "Desarrollar sus propias prácticas de gobernanza para asegurarse de que los operadores no realicen cambios en el nodo RG (también conocido como 'infra RG')",
            "waf": "Operaciones"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (properties.nodeResourceGroup !startswith 'MC_') | distinct id,compliant",
            "guid": "73b32a5a-67f7-4a9e-b5b3-1f38c3f39812",
            "link": "https://learn.microsoft.com/azure/aks/cluster-configuration",
            "service": "AKS",
            "severity": "Bajo",
            "text": "Usar el nombre personalizado de Node RG (también conocido como 'Infra RG')",
            "waf": "Operaciones"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "b2463cff-e189-4c59-adf0-d5a73dd4ce32",
            "link": "https://kubernetes.io/docs/setup/release/notes/",
            "service": "AKS",
            "severity": "Medio",
            "text": "No use API de Kubernetes obsoletas en los manifiestos de YAML",
            "waf": "Operaciones"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "c1881370-6f7c-44c0-b4e5-14648d2457ed",
            "link": "https://learn.microsoft.com/azure-stack/aks-hci/adapt-apps-mixed-os-clusters",
            "service": "AKS",
            "severity": "Bajo",
            "text": "Nodos de Windows de Taint",
            "waf": "Operaciones"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "67138b82-0102-4ce1-9ee3-01e6e882e52e",
            "link": "https://learn.microsoft.com/virtualization/windowscontainers/deploy-containers/version-compatibility?tabs=windows-server-20H2%2Cwindows-10-20H2",
            "service": "AKS",
            "severity": "Bajo",
            "text": "Mantener el nivel de revisión de los contenedores de Windows sincronizado con el nivel de revisión del host",
            "waf": "Operaciones"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "description": "A través de la configuración de diagnóstico en el nivel de clúster",
            "guid": "5b56ad48-408f-4e72-934c-476ba280dcf5",
            "link": "https://learn.microsoft.com/azure/aks/monitor-aks",
            "service": "AKS",
            "severity": "Bajo",
            "text": "Envío de registros maestros (también conocidos como registros de API) a Azure Monitor o a la solución de administración de registros que prefiera",
            "waf": "Operaciones"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "64d1a846-e28a-4b6b-9a33-22a635c15a21",
            "link": "https://learn.microsoft.com/azure/aks/node-pool-snapshot",
            "service": "AKS",
            "severity": "Bajo",
            "text": "Si es necesario, utilice instantáneas de nodePool",
            "waf": "Costar"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "c5a5b252-1e44-4a59-a9d2-399c4d7b68d0",
            "link": "https://learn.microsoft.com/azure/aks/spot-node-pool",
            "service": "AKS",
            "severity": "Bajo",
            "text": "Considere la posibilidad de crear grupos de nodos de acceso puntual para cargas de trabajo no urgentes",
            "waf": "Operaciones"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (isnotnull(properties.addonProfiles.aciConnectorLinux) and properties.addonProfiles.aciConnectorLinux.enabled==true) | distinct id,compliant",
            "guid": "c755562f-2b4e-4456-9b4d-874a748b662e",
            "link": "https://learn.microsoft.com/azure/aks/concepts-scale",
            "service": "AKS",
            "severity": "Bajo",
            "text": "Considere la posibilidad de utilizar el nodo virtual de AKS para una ráfaga rápida",
            "waf": "Operaciones"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "6f8389a7-f82c-4b8e-a8c0-aa63a25a4956",
            "link": "https://learn.microsoft.com/azure/azure-monitor/insights/container-insights-overview",
            "service": "AKS",
            "severity": "Alto",
            "text": "Supervise las métricas de clúster con Container Insights (u otras herramientas como Prometheus)",
            "waf": "Operaciones"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (isnotnull(properties.addonProfiles.omsagent) and properties.addonProfiles.omsagent.enabled==true) | distinct id,compliant",
            "guid": "eaa8dc4a-2436-47b3-9697-15b1752beee0",
            "link": "https://learn.microsoft.com/azure/azure-monitor/insights/container-insights-overview",
            "service": "AKS",
            "severity": "Alto",
            "text": "Almacene y analice los registros del clúster con Container Insights (u otras herramientas como Telegraf/ElasticSearch)",
            "waf": "Operaciones"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "4621dd68-c5a5-4be2-bdb1-1726769ef669",
            "link": "https://learn.microsoft.com/azure/azure-monitor/containers/container-insights-analyze",
            "service": "AKS",
            "severity": "Medio",
            "text": "Supervisar el uso de la CPU y la memoria de los nodos",
            "waf": "Operaciones"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "1a4835ac-9422-423e-ae80-b123081a5417",
            "link": "https://learn.microsoft.com/azure/aks/configure-azure-cni",
            "service": "AKS",
            "severity": "Medio",
            "text": "Si usa Azure CNI, supervise el porcentaje de direcciones IP de pod consumidas por nodo",
            "waf": "Operaciones"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "description": "La E/S en el disco del sistema operativo es un recurso crítico. Si el sistema operativo de los nodos se limita en la E/S, esto podría dar lugar a un comportamiento impredecible, que normalmente terminaría en que el nodo se declarara NotReady",
            "guid": "415833ea-3ad3-4c2d-b733-165c3acbe04b",
            "link": "https://learn.microsoft.com/azure/virtual-machines/premium-storage-performance",
            "service": "AKS",
            "severity": "Medio",
            "text": "Supervisión de la profundidad de la cola de disco del sistema operativo en los nodos",
            "waf": "Operaciones"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "be209d39-fda4-4777-a424-d116785c2fa5",
            "link": "https://learn.microsoft.com/azure/aks/load-balancer-standard",
            "service": "AKS",
            "severity": "Medio",
            "text": "Si no usa el filtrado de salida con AzFW/NVA, supervise los puertos SNAT asignados por ALB estándar",
            "waf": "Operaciones"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "74c2ee76-569b-4a79-a57e-dedf91b022c9",
            "link": "https://learn.microsoft.com/azure/aks/aks-resource-health",
            "service": "AKS",
            "severity": "Medio",
            "text": "Suscríbase a las notificaciones de estado de los recursos para el clúster de AKS",
            "waf": "Operaciones"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "b54eb2eb-03dd-4aa3-9927-18e2edb11726",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-scheduler",
            "service": "AKS",
            "severity": "Alto",
            "text": "Configurar solicitudes y límites en las especificaciones del pod",
            "waf": "Operaciones"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "769ef669-1a48-435a-a942-223ece80b123",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-scheduler",
            "service": "AKS",
            "severity": "Medio",
            "text": "Aplicación de cuotas de recursos para espacios de nombres",
            "waf": "Operaciones"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "081a5417-4158-433e-a3ad-3c2de733165c",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits",
            "service": "AKS",
            "severity": "Alto",
            "text": "Asegúrese de que la suscripción tiene suficiente cuota para escalar horizontalmente los grupos de nodos",
            "waf": "Operaciones"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (isnotnull(properties.autoScalerProfile)) | distinct id,compliant",
            "guid": "90ce65de-8e13-4f9c-abd4-69266abca264",
            "link": "https://learn.microsoft.com/azure/aks/concepts-scale",
            "service": "AKS",
            "severity": "Medio",
            "text": "Uso del escalador automático de clústeres",
            "waf": "Rendimiento"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | extend compliant = (isnotnull(properties.austoscalerProfile)) | distinct id,compliant",
            "guid": "831c2872-c693-4b39-a887-a561bada49bc",
            "link": "https://learn.microsoft.com/azure/aks/custom-node-configuration",
            "service": "AKS",
            "severity": "Bajo",
            "text": "Personalización de la configuración de nodos para grupos de nodos de AKS",
            "waf": "Rendimiento"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "faa19bfe-9d55-4d04-a3c4-919ca1b2d121",
            "link": "https://learn.microsoft.com/azure/aks/concepts-scale",
            "service": "AKS",
            "severity": "Medio",
            "text": "Usar el escalador automático horizontal de pods cuando sea necesario",
            "waf": "Rendimiento"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "description": "Los nodos más grandes aportarán un mayor rendimiento y características como discos efímeros y redes aceleradas, pero aumentarán el radio de explosión y disminuirán la granularidad de escalado",
            "guid": "5ae124ba-34df-4585-bcdc-e9bd3bb0cdb3",
            "link": "https://blog.cloudtrooper.net/2020/10/23/which-vm-size-should-i-choose-as-aks-node/",
            "service": "AKS",
            "severity": "Alto",
            "text": "Considere un tamaño de nodo adecuado, ni demasiado grande ni demasiado pequeño",
            "waf": "Rendimiento"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "38800e6a-ae01-40a2-9fbc-ae5a06e5462d",
            "link": "https://learn.microsoft.com/azure/aks/quotas-skus-regions#service-quotas-and-limits",
            "service": "AKS",
            "severity": "Bajo",
            "text": "Si se requieren más de 5000 nodos para la escalabilidad, considere la posibilidad de usar un clúster de AKS adicional",
            "waf": "Rendimiento"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "9583c0f6-6083-43f6-aa6b-df7102c901bb",
            "link": "https://learn.microsoft.com/azure/event-grid/event-schema-aks",
            "service": "AKS",
            "severity": "Bajo",
            "text": "Considere la posibilidad de suscribirse a eventos de EventGrid para la automatización de AKS",
            "waf": "Rendimiento"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "c5016d8c-c6c9-4165-89ae-673ef0fff19d",
            "link": "https://learn.microsoft.com/azure/aks/manage-abort-operations",
            "service": "AKS",
            "severity": "Bajo",
            "text": "Para una operación de ejecución prolongada en un clúster de AKS, considere la finalización de eventos",
            "waf": "Rendimiento"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "c4e37133-f186-4ce1-aed9-9f1b32f6e021",
            "link": "https://learn.microsoft.com/azure/aks/use-azure-dedicated-hosts",
            "service": "AKS",
            "severity": "Bajo",
            "text": "Si es necesario, considere la posibilidad de usar Azure Dedicated Hosts para nodos de AKS",
            "waf": "Rendimiento"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "graph": "where type=='microsoft.containerservice/managedclusters' | project id,resourceGroup,name,pools=properties.agentPoolProfiles | mvexpand pools | extend compliant = (pools.osDiskType=='Ephemeral') | project id,name=strcat(name,'-',pools.name), resourceGroup, compliant",
            "guid": "24367b33-6971-45b1-952b-eee0b9b588de",
            "link": "https://learn.microsoft.com/azure/aks/cluster-configuration",
            "service": "AKS",
            "severity": "Alto",
            "text": "Usar discos de sistema operativo efímeros",
            "waf": "Rendimiento"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "f0ce315f-1120-4166-8206-94f2cf3a4d07",
            "link": "https://learn.microsoft.com/azure/virtual-machines/disks-types",
            "service": "AKS",
            "severity": "Alto",
            "text": "En el caso de los discos no efímeros, use IOPS altas y discos de sistema operativo más grandes para los nodos cuando ejecute muchos pods o nodos, ya que requiere un alto rendimiento para ejecutar varios pods y generará registros enormes con umbrales de rotación de registros de AKS predeterminados",
            "waf": "Rendimiento"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "39c486ce-d5af-4062-89d5-18bb5fd795db",
            "link": "https://learn.microsoft.com/azure/aks/use-ultra-disks",
            "service": "AKS",
            "severity": "Bajo",
            "text": "Para la opción de almacenamiento de hiperrendimiento, use discos Ultra en AKS",
            "waf": "Rendimiento"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "9f7547c1-747d-4c56-868a-714435bd19dd",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-multi-region",
            "service": "AKS",
            "severity": "Medio",
            "text": "Evite mantener el estado en el clúster y almacene los datos fuera (AzStorage, AzSQL, Cosmos, etc.)",
            "waf": "Rendimiento"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "24429eb7-2281-4376-85cc-57b4a4b18142",
            "link": "https://learn.microsoft.com/azure/aks/operator-best-practices-storage",
            "service": "AKS",
            "severity": "Medio",
            "text": "Si usa AzFiles Standard, considere AzFiles Premium o ANF por motivos de rendimiento",
            "waf": "Rendimiento"
        },
        {
            "arm-service": "microsoft.containerservice/managedClusters",
            "checklist": "Azure AKS Review",
            "guid": "83958a8c-2689-4b32-ab57-cfc64546135a",
            "link": "https://learn.microsoft.com/azure/aks/availability-zones#azure-disk-availability-zone-support",
            "service": "AKS",
            "severity": "Medio",
            "text": "Si usa Azure Disks y AZ, considere la posibilidad de tener grupos de nodos dentro de una zona para el disco LRS con VolumeBindingMode:WaitForFirstConsumer para aprovisionar el almacenamiento en la zona correcta o use el disco ZRS para los grupos de nodos que abarquen varias zonas",
            "waf": "Rendimiento"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "32e42e36-11c8-418b-8a0b-c510e43a18a9",
            "service": "AVS",
            "severity": "Alto",
            "text": "Asegúrese de que los controladores de dominio ADDS se implementan en la suscripción de identidad en Azure nativo",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "75089c20-990d-4927-b105-885576f76fc2",
            "service": "AVS",
            "severity": "Medio",
            "text": "Asegúrese de que los sitios y servicios de ADDS están configurados para mantener las solicitudes de autenticación de los recursos basados en Azure (incluida Azure VMware Solution) locales en Azure",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "de3aad1e-7c28-4ec9-9666-b7570449aa80",
            "service": "AVS",
            "severity": "Alto",
            "text": "Asegúrese de que vCenter esté conectado a ADDS para habilitar la autenticación basada en \"cuentas de usuario designadas\"",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "cd289ced-6b17-4db8-8554-61e2aee3553a",
            "service": "AVS",
            "severity": "Medio",
            "text": "Asegúrese de que la conexión de vCenter a ADDS utilice un protocolo seguro (LDAPS)",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "b9d37dac-43bc-46cd-8d79-a9b24604489a",
            "service": "AVS",
            "severity": "Medio",
            "text": "La cuenta de CloudAdmin en vCenter IdP solo se utiliza como una cuenta de emergencia (break-glass)",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "53d88e89-d17b-473b-82a5-a67e7a9ed5b3",
            "service": "AVS",
            "severity": "Alto",
            "text": "Asegúrese de que NSX-Manager esté integrado con un proveedor de identidades externo (LDAPS)",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "ae0e37ce-e297-411b-b352-caaab79b198d",
            "service": "AVS",
            "severity": "Medio",
            "text": "¿Se ha creado un modelo RBAC para su uso en VMware vSphere?",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "ab81932c-9fc9-4d1b-a780-36f5e6bfbb9e",
            "service": "AVS",
            "severity": "Medio",
            "text": "Los permisos RBAC deben concederse a grupos ADDS y no a usuarios específicos",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "d503547c-c447-4e82-9128-a71f0f1cac6d",
            "service": "AVS",
            "severity": "Alto",
            "text": "Los permisos de RBAC en el recurso de Azure VMware Solution en Azure están \"bloqueados\" solo para un conjunto limitado de propietarios",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "fd9f0df4-68dc-4976-b9a9-e6a79f7682c5",
            "service": "AVS",
            "severity": "Alto",
            "text": "Asegúrese de que todos los roles personalizados tengan el ámbito de las autorizaciones permitidas de CloudAdmin",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "9ef1d5e8-32e4-42e3-911c-818b0a0bc510",
            "link": "https://github.com/Azure/AzureCAT-AVS/tree/main/networking",
            "service": "AVS",
            "severity": "Alto",
            "text": "¿Se ha seleccionado el modelo de conectividad de Azure VMware Solution correcto para el caso de uso del cliente en cuestión?",
            "waf": "Rendimiento"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "eb710a37-cbc1-4055-8dd5-a936a8bb7cf5",
            "service": "AVS",
            "severity": "Alto",
            "text": "Asegúrese de que las conexiones de ExpressRoute o VPN desde el entorno local a Azure se supervisan mediante el \"monitor de conexiones\"",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "976e24f2-a7f8-426c-9253-2a92a2a7ed99",
            "service": "AVS",
            "severity": "Medio",
            "text": "Asegúrese de que se crea un monitor de conexión desde un recurso nativo de Azure a una máquina virtual de Azure VMware Solution para supervisar la conexión de ExpressRoute back-end de Azure VMware Solution",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "f41ce6a0-64f3-4805-bc65-3ab50df01265",
            "service": "AVS",
            "severity": "Medio",
            "text": "Asegúrese de que se crea un monitor de conexión desde un recurso local a una máquina virtual de Azure VMware Solution para supervisar la conectividad de extremo a extremo",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "563b4dc7-4a74-48b6-933a-d1a0916a6649",
            "service": "AVS",
            "severity": "Alto",
            "text": "Cuando se utiliza el servidor de rutas, asegúrese de que no se propaguen más de 1000 rutas desde el servidor de rutas a la puerta de enlace de ExR al entorno local (límite de ARS).",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "6128a71f-0f1c-4ac6-b9ef-1d5e832e42e3",
            "service": "AVS",
            "severity": "Alto",
            "text": "¿Se ha implementado Privileged Identity Management para los roles que administran el recurso de Azure VMware Solution en Azure Portal (no se permiten permisos permanentes)?",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "c4e2436b-b336-4d71-9f17-960eee0b9b5c",
            "service": "AVS",
            "severity": "Alto",
            "text": "Los informes de auditoría de Privileged Identity Management deben implementarse para los roles PIM de Azure VMware Solution",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "78c447a8-26b2-4863-af0f-1cac599ef1d5",
            "service": "AVS",
            "severity": "Medio",
            "text": "Si se usa Privileged Identity Management, asegúrese de que se crea una cuenta válida habilitada para Entra ID con un registro SMTP válido para las notificaciones de reemplazo automático de host de Azure VMware Solution. (se requieren permisos permanentes)",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "8defc4d7-21d3-41d2-90fb-707ae9eab40e",
            "service": "AVS",
            "severity": "Alto",
            "text": "Limite el uso de la cuenta de CloudAdmin solo al acceso de emergencia",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "d329f798-bc17-48bd-a5a0-6ca7144351d1",
            "service": "AVS",
            "severity": "Medio",
            "text": "Cree funciones RBAC personalizadas en vCenter para implementar un modelo de privilegios mínimos dentro de vCenter",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "9dd24429-eb72-4281-97a1-51c5bb4e4f18",
            "service": "AVS",
            "severity": "Medio",
            "text": "Es un proceso definido para rotar periódicamente las credenciales de administrador de la nube (vCenter) y administrador (NSX)",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "586cb291-ec16-4a1d-876e-f9f141acdce5",
            "service": "AVS",
            "severity": "Alto",
            "text": "Uso de un proveedor de identidades centralizado que se usará para las cargas de trabajo (VM) que se ejecutan en Azure VMware Solution",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "79377bcd-b375-41ab-8ab0-ead66e15d3d4",
            "service": "AVS",
            "severity": "Medio",
            "text": "¿Se implementa el filtrado de tráfico este-oeste en NSX-T?",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "a2adb1c3-d232-46af-825c-a44e1695fddd",
            "service": "AVS",
            "severity": "Alto",
            "text": "Las cargas de trabajo de Azure VMware Solution no se exponen directamente a Internet. El tráfico se filtra e inspecciona mediante Azure Application Gateway, Azure Firewall o soluciones de terceros",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "eace4cb1-deb4-4c65-8c3f-c14eeab36938",
            "service": "AVS",
            "severity": "Alto",
            "text": "La auditoría y el registro se implementan para las solicitudes entrantes de Internet a Azure VMware Solution y a las cargas de trabajo basadas en Azure VMware Solution",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "29e3eec2-1836-487a-8077-a2b5945bda43",
            "service": "AVS",
            "severity": "Medio",
            "text": "La supervisión de sesiones se implementa para las conexiones salientes a Internet desde Azure VMware Solution o cargas de trabajo basadas en Azure VMware Solution para identificar actividades sospechosas o malintencionadas",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "334fdf91-c234-4182-a652-75269440b4be",
            "service": "AVS",
            "severity": "Medio",
            "text": "¿Está habilitada la protección estándar de DDoS en la subred de puerta de enlace de ExR/VPN en Azure?",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "3d3e0843-276d-44bd-a015-bcf219e4a1eb",
            "service": "AVS",
            "severity": "Medio",
            "text": "Use una estación de trabajo de acceso con privilegios (PAW) dedicada para administrar Azure VMware Solution, vCenter, NSX Manager y HCX Manager",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "9ccbd869-266a-4cca-874f-aa19bf39d95d",
            "service": "AVS",
            "severity": "Medio",
            "text": "Habilitación de la detección avanzada de amenazas (Microsoft Defender for Cloud, también conocida como ASC) para cargas de trabajo que se ejecutan en Azure VMware Solution",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "44c7c891-9ca1-4f6d-9315-ae524ba34d45",
            "service": "AVS",
            "severity": "Medio",
            "text": "Use Azure ARC for Servers para controlar correctamente las cargas de trabajo que se ejecutan en Azure VMware Solution mediante tecnologías nativas de Azure (Azure ARC for Azure VMware Solution aún no está disponible)",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "85e12139-bd7b-4b01-8f7b-95ef6e043e2a",
            "service": "AVS",
            "severity": "Bajo",
            "text": "Asegúrese de que las cargas de trabajo de Azure VMware Solution usen suficiente cifrado de datos durante el tiempo de ejecución (como el cifrado de disco invitado y SQL TDE). (El cifrado de vSAN en reposo es el predeterminado)",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "a3592718-e6e2-4051-9267-6ae46691e883",
            "service": "AVS",
            "severity": "Bajo",
            "text": "Cuando se usa el cifrado en invitado, almacene las claves de cifrado en Azure Key Vault siempre que sea posible",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "5ac94222-3e13-4810-9230-81a941741583",
            "service": "AVS",
            "severity": "Medio",
            "text": "Considere la posibilidad de usar la compatibilidad con actualizaciones de seguridad extendidas para las cargas de trabajo que se ejecutan en Azure VMware Solution (Azure VMware Solution es apta para ESU)",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "3ef7ad7c-6d37-4331-95c7-acbe44bbe609",
            "service": "AVS",
            "severity": "Alto",
            "text": "Asegúrese de que se utiliza el método de redundancia de datos de vSAN adecuado (especificación RAID)",
            "waf": "Fiabilidad"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "d88408f3-7273-44c8-96ba-280214590146",
            "service": "AVS",
            "severity": "Alto",
            "text": "Asegúrese de que la directiva de error de tolerancia esté implementada para satisfacer sus necesidades de almacenamiento de vSAN",
            "waf": "Fiabilidad"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "d89f2e87-7784-424d-9167-85c6fa95b96a",
            "service": "AVS",
            "severity": "Alto",
            "text": "Asegúrese de que ha solicitado una cuota suficiente, asegurándose de que ha tenido en cuenta el crecimiento y el requisito de recuperación ante desastres",
            "waf": "Fiabilidad"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "5d38e53f-9ccb-4d86-a266-acca274faa19",
            "service": "AVS",
            "severity": "Medio",
            "text": "Asegúrese de que se comprenden las restricciones de acceso a ESXi, ya que existen límites de acceso que pueden afectar a las soluciones de terceros.",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "bf39d95d-44c7-4c89-89ca-1f6d5315ae52",
            "service": "AVS",
            "severity": "Medio",
            "text": "Asegúrese de tener una política en torno a la densidad y la eficiencia del host ESXi, teniendo en cuenta el tiempo de espera para solicitar nuevos nodos",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "4ba34d45-85e1-4213-abd7-bb012f7b95ef",
            "service": "AVS",
            "severity": "Medio",
            "text": "Asegúrese de que existe un buen proceso de administración de costos para Azure VMware Solution: se puede usar Azure Cost Management",
            "waf": "Costar"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "6e043e2a-a359-4271-ae6e-205172676ae4",
            "service": "AVS",
            "severity": "Bajo",
            "text": "¿Se usan instancias reservadas de Azure para optimizar el costo de uso de Azure VMware Solution?",
            "waf": "Costar"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "6691e883-5ac9-4422-83e1-3810523081a9",
            "service": "AVS",
            "severity": "Medio",
            "text": "Tenga en cuenta el uso de Azure Private-Link cuando use otros servicios nativos de Azure",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "db611712-6904-40b4-aa3d-3e0803276d4b",
            "service": "AVS",
            "severity": "Alto",
            "text": "Asegúrese de que todos los recursos necesarios residen en las mismas zonas de disponibilidad de Azure",
            "waf": "Rendimiento"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "48b262d6-cc5f-4512-a253-98e6db9d37da",
            "service": "AVS",
            "severity": "Medio",
            "text": "Habilitación de cargas de trabajo de máquina virtual invitada de Microsoft Defender for Cloud for Azure VMware Solution",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "41741583-3ef7-4ad7-a6d3-733165c7acbe",
            "service": "AVS",
            "severity": "Medio",
            "text": "Uso de servidores habilitados para Azure Arc para administrar las cargas de trabajo de máquinas virtuales invitadas de Azure VMware Solution",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "88f03a4d-2cd4-463c-abbc-868295abc91a",
            "service": "AVS",
            "severity": "Alto",
            "text": "Habilitación del registro de diagnósticos y métricas en Azure VMware Solution",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "4ed90dae-2cc8-44c4-9b6b-781cbafe6c46",
            "service": "AVS",
            "severity": "Medio",
            "text": "Implementación de los agentes de Log Analytics en cargas de trabajo de máquinas virtuales invitadas de Azure VMware Solution",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "589d457a-927c-4397-9d11-02cad6aae11e",
            "service": "AVS",
            "severity": "Medio",
            "text": "Asegúrese de que dispone de una directiva y una solución de copia de seguridad documentadas e implementadas para las cargas de trabajo de máquina virtual de Azure VMware Solution",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "ee29711b-d352-4caa-ab79-b198dab81932",
            "service": "AVS",
            "severity": "Medio",
            "text": "Uso de Microsoft Defender for Cloud para la supervisión del cumplimiento de las cargas de trabajo que se ejecutan en Azure VMware Solution",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "c9fc9d1b-b780-436f-9e6b-fbb9ed503547",
            "service": "AVS",
            "severity": "Medio",
            "text": "¿Se agregan las líneas base de cumplimiento aplicables a Microsoft Defender for Cloud?",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "cc447e82-6128-4a71-b0f1-cac6d9ef1d5e",
            "service": "AVS",
            "severity": "Alto",
            "text": "¿Se evaluó la residencia de datos al seleccionar las regiones de Azure que se usarán para la implementación de Azure VMware Solution?",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "832e42e3-611c-4818-a0a0-bc510e43a18a",
            "service": "AVS",
            "severity": "Alto",
            "text": "¿Son claras y documentadas las implicaciones del procesamiento de datos (proveedor de servicios / modelo de consumidor de servicios)?",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "547c1747-dc56-4068-a714-435cd19dd244",
            "service": "AVS",
            "severity": "Medio",
            "text": "Considere la posibilidad de usar CMK (clave administrada por el cliente) para vSAN solo si es necesario por motivos de cumplimiento.",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "e43a18a9-cd28-49ce-b6b1-7db8255461e2",
            "service": "AVS",
            "severity": "Alto",
            "text": "Creación de paneles para habilitar la información principal de supervisión de Azure VMware Solution",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "6b84ee5d-f47d-42d9-8881-b1cd5d1e54a2",
            "service": "AVS",
            "severity": "Alto",
            "text": "Creación de alertas de advertencia para umbrales críticos para alertas automáticas sobre el rendimiento de Azure VMware Solution (CPU >80 %, memoria media >80 %, vSAN >70 %)",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "9659e396-80e7-4828-ac93-5657d02bff45",
            "service": "AVS",
            "severity": "Alto",
            "text": "Asegúrese de que se crea una alerta crítica para supervisar si el consumo de vSAN es inferior al 75 %, ya que se trata de un umbral de soporte de VMware",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "64b0d934-a348-4726-be79-d6b5c3a36495",
            "service": "AVS",
            "severity": "Alto",
            "text": "Asegúrese de que las alertas están configuradas para las alertas y notificaciones de Azure Service Health",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "b6abad38-aad5-43cc-99e1-d86667357c54",
            "service": "AVS",
            "severity": "Medio",
            "text": "Configure el registro de Azure VMware Solution para que se envíe a una cuenta de Azure Storage o Azure EventHub para su procesamiento",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "9674c5ed-85b8-459c-9733-be2b1a27b775",
            "service": "AVS",
            "severity": "Bajo",
            "text": "Si se requiere una visión profunda de VMware vSphere: ¿Se utiliza vRealize Operations o vRealize Network Insights en la solución?",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "a91be1f3-88f0-43a4-b2cd-463cbbbc8682",
            "service": "AVS",
            "severity": "Alto",
            "text": "Asegúrese de que la directiva de almacenamiento de vSAN para las máquinas virtuales NO sea la directiva de almacenamiento predeterminada, ya que esta directiva aplica el aprovisionamiento grueso",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "d9ef1d5e-832d-442e-9611-c818b0afbc51",
            "service": "AVS",
            "severity": "Medio",
            "text": "Asegúrese de que las bibliotecas de contenido de vSphere no se coloquen en vSAN, ya que vSAN es un recurso finito",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "0e43a18a-9cd2-489b-bd6b-17db8255461e",
            "service": "AVS",
            "severity": "Medio",
            "text": "Asegúrese de que los repositorios de datos de la solución de copia de seguridad se almacenen fuera del almacenamiento de vSAN. Ya sea en Azure nativo o en un almacén de datos respaldado por un grupo de discos",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "2aee3453-aec8-4339-848b-262d6cc5f512",
            "service": "AVS",
            "severity": "Medio",
            "text": "Asegúrese de que las cargas de trabajo que se ejecutan en Azure VMware Solution se administran de forma híbrida mediante Azure Arc para servidores (Arc para Azure VMware Solution está en versión preliminar)",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "925398e6-da9d-437d-ac43-bc6cd1d79a9b",
            "service": "AVS",
            "severity": "Medio",
            "text": "Asegúrese de que las cargas de trabajo que se ejecutan en Azure VMware Solution se supervisan mediante Azure Log Analytics y Azure Monitor",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "24604489-a8f4-42d7-ae78-cb6a33bd2a09",
            "service": "AVS",
            "severity": "Medio",
            "text": "Inclusión de cargas de trabajo que se ejecutan en Azure VMware Solution en las herramientas de administración de actualizaciones existentes o en Azure Update Management",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "17e7a8d9-0ae0-4e27-aee2-9711bd352caa",
            "service": "AVS",
            "severity": "Medio",
            "text": "Uso de Azure Policy para incorporar cargas de trabajo de Azure VMware Solution en las soluciones de administración, supervisión y seguridad de Azure",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "aee3553a-fc83-4392-98b2-62d6cc5f5129",
            "service": "AVS",
            "severity": "Medio",
            "text": "Asegúrese de que las cargas de trabajo que se ejecutan en Azure VMware Solution se incorporan a Microsoft Defender for Cloud",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "25398e6d-b9d3-47da-a43b-c6cd1d79a9b2",
            "service": "AVS",
            "severity": "Medio",
            "text": "Asegúrese de que las copias de seguridad no se almacenen en vSAN, ya que vSAN es un recurso finito",
            "waf": "Fiabilidad"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "5e6bfbb9-ed50-4354-9cc4-47e826028a71",
            "service": "AVS",
            "severity": "Medio",
            "text": "¿Se han considerado todas las soluciones de recuperación ante desastres y se ha decidido por la mejor solución para su negocio? [SRM/JetStream/Zerto/Veeam/...]",
            "waf": "Fiabilidad"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "f0f1cac6-d9ef-41d5-b832-d42e3611c818",
            "service": "AVS",
            "severity": "Medio",
            "text": "Uso de Azure Site Recovery cuando la tecnología de recuperación ante desastres sea IaaS nativa de Azure",
            "waf": "Fiabilidad"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "b0afbc51-0e43-4a18-a9cd-289bed6b17db",
            "service": "AVS",
            "severity": "Alto",
            "text": "Utilice planes de recuperación automatizados con cualquiera de las soluciones ante desastres, evite las tareas manuales tanto como sea posible",
            "waf": "Fiabilidad"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "8255461e-2aee-4345-9aec-8339248b262d",
            "service": "AVS",
            "severity": "Medio",
            "text": "Usar el par de regiones geopolíticas como entorno secundario de recuperación ante desastres",
            "waf": "Fiabilidad"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "6cc5f512-9253-498e-9da9-d37dac43bc6c",
            "service": "AVS",
            "severity": "Alto",
            "text": "Utilice 2 espacios de direcciones diferentes entre las regiones, por ejemplo: 10.0.0.0/16 y 192.168.0.0/16 para las diferentes regiones",
            "waf": "Fiabilidad"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "d1d79a9b-2460-4448-aa8f-42d78e78cb6a",
            "service": "AVS",
            "severity": "Medio",
            "text": "¿Se usará Global Reach de ExpressRoute para la conectividad entre las nubes privadas de Azure VMware Solution principal y secundaria, o el enrutamiento se realiza a través de aplicaciones virtuales de red?",
            "waf": "Fiabilidad"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "33bd2a09-17e7-4a8d-a0ae-0e27cee29711",
            "service": "AVS",
            "severity": "Medio",
            "text": "¿Se han considerado todas las soluciones de copia de seguridad y se ha decidido por la mejor solución para su negocio? [ MABS/CommVault/Metallic.io/Veeam/ . ]",
            "waf": "Fiabilidad"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "bd352caa-ab79-4b18-adab-81932c9fc9d1",
            "service": "AVS",
            "severity": "Medio",
            "text": "Implemente la solución de copia de seguridad en la misma región que la nube privada de Azure VMware Solution",
            "waf": "Fiabilidad"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "bb77036f-5e6b-4fbb-aed5-03547cc447e8",
            "service": "AVS",
            "severity": "Medio",
            "text": "Implementación de la solución de copia de seguridad fuera de vSan, en componentes nativos de Azure",
            "waf": "Fiabilidad"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "26028a71-f0f1-4cac-9d9e-f1d5e832d42e",
            "service": "AVS",
            "severity": "Bajo",
            "text": "¿Existe un proceso para solicitar una restauración de los componentes de VMware administrados por la plataforma Azure?",
            "waf": "Fiabilidad"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "4604489a-8f42-4d78-b78c-b7a33bd2a0a1",
            "service": "AVS",
            "severity": "Bajo",
            "text": "En el caso de las implementaciones manuales, se deben documentar todas las configuraciones e implementaciones",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "7e7a8d90-ae0e-437c-be29-711bd352caaa",
            "service": "AVS",
            "severity": "Bajo",
            "text": "En el caso de las implementaciones manuales, considere la posibilidad de implementar bloqueos de recursos para evitar acciones accidentales en la nube privada de Azure VMware Solution",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "b79b198d-ab81-4932-a9fc-9d1bb78036f5",
            "service": "AVS",
            "severity": "Bajo",
            "text": "Para implementaciones automatizadas, implemente una nube privada mínima y escale según sea necesario",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "e6bfbb9e-d503-4547-ac44-7e826128a71f",
            "service": "AVS",
            "severity": "Bajo",
            "text": "En el caso de las implementaciones automatizadas, solicite o reserve una cuota antes de iniciar la implementación",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "0f1cac6d-9ef1-4d5e-a32e-42e3611c818b",
            "service": "AVS",
            "severity": "Bajo",
            "text": "En el caso de la implementación automatizada, asegúrese de que se crean bloqueos de recursos relevantes a través de la automatización o a través de Azure Policy para una gobernanza adecuada",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "e2cc95d4-8c6b-4791-bca0-f6c56589e558",
            "service": "AVS",
            "severity": "Bajo",
            "text": "Implemente nombres comprensibles para las claves de autorización ExR para permitir una fácil identificación del propósito y uso de las claves.",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "255461e2-aee3-4553-afc8-339248b262d6",
            "service": "AVS",
            "severity": "Bajo",
            "text": "Uso de Key Vault para almacenar secretos y claves de autorización cuando se usan principios de servicio independientes para implementar Azure VMware Solution y ExpressRoute",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "cc5f5129-2539-48e6-bb9d-37dac43bc6cd",
            "service": "AVS",
            "severity": "Bajo",
            "text": "Defina dependencias de recursos para serializar acciones en IaC cuando sea necesario implementar muchos recursos en Azure VMware Solution, ya que Azure VMware Solution solo admite un número limitado de operaciones paralelas.",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "1d79a9b2-4604-4489-a8f4-2d78e78cb7a3",
            "service": "AVS",
            "severity": "Bajo",
            "text": "Al realizar la configuración automatizada de segmentos de NSX-T con una única puerta de enlace de nivel 1, use las API de Azure Portal en lugar de las API de NSX-Manager",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "3bd2a0a1-7e7a-48d9-8ae0-e37cee29711b",
            "service": "AVS",
            "severity": "Medio",
            "text": "Si tiene la intención de usar el escalado horizontal automatizado, asegúrese de solicitar una cuota suficiente de Azure VMware Solution para las suscripciones que ejecutan Azure VMware Solution",
            "waf": "Rendimiento"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "d352caaa-b79b-4198-bab8-1932c9fc9d1b",
            "service": "AVS",
            "severity": "Medio",
            "text": "Cuando tenga la intención de usar la reducción horizontal automatizada, asegúrese de tener en cuenta los requisitos de la directiva de almacenamiento antes de realizar dicha acción",
            "waf": "Rendimiento"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "b78036f5-e6bf-4bb9-bd50-3547cc447e82",
            "service": "AVS",
            "severity": "Medio",
            "text": "Las operaciones de escalado siempre deben serializarse dentro de un único SDDC, ya que solo se puede realizar una operación de escalado a la vez (incluso cuando se utilizan varios clústeres)",
            "waf": "Rendimiento"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "bf15bce2-19e4-4a0e-a588-79424d226786",
            "service": "AVS",
            "severity": "Medio",
            "text": "Considerar y validar las operaciones de escalado en soluciones de terceros utilizadas en la arquitectura (compatibles o no)",
            "waf": "Rendimiento"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "d20b56c5-7be5-4851-a0f8-3835c586cb29",
            "service": "AVS",
            "severity": "Medio",
            "text": "Defina y aplique límites máximos de escalado vertical y horizontal para su entorno en las automatizaciones",
            "waf": "Rendimiento"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "1dc15a1c-075e-4e9f-841a-cccd579376bc",
            "service": "AVS",
            "severity": "Medio",
            "text": "Implemente reglas de supervisión para supervisar las operaciones de escalado automatizadas y supervisar el éxito y el fracaso para permitir respuestas adecuadas (automatizadas)",
            "waf": "Operaciones"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "c5972cd4-cd21-4b07-9036-f5e6b4bfd3d5",
            "link": "https://learn.microsoft.com/azure/active-directory/app-proxy/application-proxy#how-application-proxy-works",
            "service": "AVS",
            "severity": "Alto",
            "text": "Al usar MON, tenga en cuenta los límites de las máquinas virtuales configuradas simultáneamente (límite de MON para HCX [400 - estándar, 1000 - dispositivo más grande])",
            "training": "https://learn.microsoft.com/learn/modules/configure-azure-ad-application-proxy/",
            "waf": "Fiabilidad"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "be1f38cf-03a8-422b-b463-cbbbc8ac299e",
            "link": "https://learn.microsoft.com/azure/active-directory/app-proxy/application-proxy#how-application-proxy-works",
            "service": "AVS",
            "severity": "Alto",
            "text": "Al usar MON, no puede habilitar MON en más de 100 extensiones de red",
            "training": "https://learn.microsoft.com/learn/paths/implement-applications-external-access-azure-ad/",
            "waf": "Fiabilidad"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "bc91a43d-90da-4e2c-a881-4706f7c1cbaf",
            "service": "AVS",
            "severity": "Medio",
            "text": "Si utiliza una conexión VPN para migraciones, ajuste el tamaño de su MTU en consecuencia.",
            "waf": "Rendimiento"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "e614658d-d457-4e92-9139-b821102cad6e",
            "service": "AVS",
            "severity": "Medio",
            "text": "En el caso de las regiones de baja conectividad que se conectan a Azure (500 Mbps o menos), considere la posibilidad de implementar el dispositivo de optimización de WAN de HCX",
            "waf": "Rendimiento"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "ae01e6e8-43e5-42f4-922d-928c1b1cd521",
            "service": "AVS",
            "severity": "Medio",
            "text": "Asegúrese de que las migraciones se inicien desde el dispositivo local y NO desde el dispositivo en la nube (NO realice una migración inversa)",
            "waf": "Fiabilidad"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "e54a29a9-de39-4ac0-b7c2-8dc935657202",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-policy-settings",
            "service": "AVS",
            "severity": "Medio",
            "text": "Cuando se usa Azure NetApp Files para ampliar el almacenamiento de Azure VMware Solution, considere la posibilidad de usarlo como almacén de datos de VMware en lugar de adjuntarlo directamente a una máquina virtual.",
            "waf": "Fiabilidad"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "bff4564b-0d93-44a3-98b2-63e7dd60513a",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#avoid-combining-traffic-manager-and-front-door",
            "service": "AVS",
            "severity": "Medio",
            "text": "Asegúrese de que se usa una puerta de enlace de ExpressRoute dedicada para soluciones de almacenamiento de datos externos",
            "waf": "Fiabilidad"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "3649906e-bad3-48ea-b53c-c7de1d8aaab3",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-the-same-domain-name-on-front-door-and-your-origin",
            "service": "AVS",
            "severity": "Medio",
            "text": "Asegúrese de que FastPath está habilitado en la puerta de enlace de ExpressRoute que se usa para las soluciones de almacenamiento de datos externos",
            "waf": "Fiabilidad"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "571549ab-8153-4d89-b89d-c7b33be2b1a2",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#disable-health-probes-when-theres-only-one-origin-in-an-origin-group",
            "service": "AVS",
            "severity": "Alto",
            "text": "Si utiliza un clúster ampliado, asegúrese de que la solución de recuperación ante desastres seleccionada sea compatible con el proveedor",
            "waf": "Fiabilidad"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "4c486b6d-8bdc-4059-acf7-5ee8a1309888",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#select-good-health-probe-endpoints",
            "service": "AVS",
            "severity": "Alto",
            "text": "Si utiliza un clúster ampliado, asegúrese de que el Acuerdo de Nivel de Servicio proporcionado cumpla sus requisitos",
            "waf": "Fiabilidad"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "9579d66b-896d-471f-a6ca-7be9955d04c3",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-head-health-probes",
            "service": "AVS",
            "severity": "Alto",
            "text": "Si usa un clúster extendido, asegúrese de que ambos circuitos ExpressRoute están conectados al centro de conectividad.",
            "waf": "Fiabilidad"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "c49d987c-b3d1-4325-aa12-4b6e4d0685ed",
            "link": "https://learn.microsoft.com/azure/nat-gateway/nat-overview#outbound-connectivity",
            "service": "AVS",
            "severity": "Alto",
            "text": "Si usa un clúster extendido, asegúrese de que ambos circuitos ExpressRoute tengan habilitado GlobalReach.",
            "waf": "Fiabilidad"
        },
        {
            "checklist": "Azure VMware Solution Design Review",
            "guid": "dce9793b-7bcd-4b3b-91eb-2ec14eea6e59",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-managed-tls-certificates",
            "service": "AVS",
            "severity": "Alto",
            "text": "Haga que la configuración de tolerancia ante desastres del sitio se considere y cambie correctamente para su negocio si es necesario.",
            "waf": "Fiabilidad"
        },
        {
            "checklist": "Azure App Service Review",
            "guid": "b32e1aa1-4813-4602-88fe-27ca2891f421",
            "link": "https://learn.microsoft.com/en-us/azure/architecture/reference-architectures/app-service-web-app/zone-redundant?source=recommendations",
            "service": "App Services",
            "severity": "Bajo",
            "text": "Consulte la arquitectura de aplicación web de redundancia de zona de alta disponibilidad de línea de base para conocer los procedimientos recomendados",
            "waf": "Fiabilidad"
        },
        {
            "checklist": "Azure App Service Review",
            "guid": "e4b31c6a-2e3f-4df1-8e8b-9c3aa5a27820",
            "link": "https://learn.microsoft.com/en-us/azure/app-service/overview-hosting-plans",
            "service": "App Services",
            "severity": "Medio",
            "text": "Utilice los niveles Premium y Estándar. Estos niveles admiten ranuras de ensayo y copias de seguridad automatizadas.",
            "waf": "Fiabilidad"
        },
        {
            "checklist": "Azure App Service Review",
            "guid": "a7e2e6c2-491f-4fa4-a82b-521d0bc3b202",
            "link": "https://learn.microsoft.com/en-us/azure/reliability/migrate-app-service",
            "service": "App Services",
            "severity": "Alto",
            "text": "Aproveche las zonas de disponibilidad cuando corresponda regionalmente (requiere el nivel Premium v2 o v3)",
            "waf": "Fiabilidad"
        },
        {
            "checklist": "Azure App Service Review",
            "guid": "1275e4a9-7b6a-43c3-a9cd-5ee18d8995ad",
            "link": "https://learn.microsoft.com/en-us/azure/app-service/monitor-instances-health-check",
            "service": "App Services",
            "severity": "Medio",
            "text": "Implementación de comprobaciones de estado",
            "waf": "Fiabilidad"
        },
        {
            "checklist": "Azure App Service Review",
            "guid": "35a91c5d-4ad6-4d9b-8e0f-c47db9e6d1e7",
            "link": "https://learn.microsoft.com/en-us/azure/app-service/manage-backup",
            "service": "App Services",
            "severity": "Alto",
            "text": "Consulte los procedimientos recomendados de copia de seguridad y restauración para Azure App Service",
            "waf": "Fiabilidad"
        },
        {
            "checklist": "Azure App Service Review",
            "guid": "e68cd0ec-afc6-4bd8-a27f-7860ad9a0db2",
            "link": "https://learn.microsoft.com/en-us/azure/architecture/framework/services/compute/azure-app-service/reliability",
            "service": "App Services",
            "severity": "Alto",
            "text": "Implementación de los procedimientos recomendados de confiabilidad de Azure App Service",
            "waf": "Fiabilidad"
        },
        {
            "checklist": "Azure App Service Review",
            "guid": "bd2a865c-0835-4418-bb58-4df91a5a9b3f",
            "link": "https://learn.microsoft.com/en-us/azure/app-service/manage-disaster-recovery#recover-app-content-only",
            "service": "App Services",
            "severity": "Bajo",
            "text": "Familiarizarse con cómo mover una aplicación de App Service a otra región durante un desastre",
            "waf": "Fiabilidad"
        },
        {
            "checklist": "Azure App Service Review",
            "guid": "f3d2f1e4-e6d4-4b7a-a5a5-e2a9b2c6f293",
            "link": "https://learn.microsoft.com/en-us/azure/reliability/reliability-app-service",
            "service": "App Services",
            "severity": "Alto",
            "text": "Familiarizarse con la compatibilidad con la confiabilidad en Azure App Service",
            "waf": "Fiabilidad"
        },
        {
            "checklist": "Azure App Service Review",
            "guid": "c7b5f3d1-0569-4fd2-9f32-c0b64e9c0c5e",
            "link": "https://learn.microsoft.com/en-us/azure/azure-functions/dedicated-plan#always-on",
            "service": "App Services",
            "severity": "Medio",
            "text": "Asegúrese de que \"Siempre activado\" está habilitado para las aplicaciones de funciones que se ejecutan en un plan de App Service",
            "waf": "Fiabilidad"
        },
        {
            "checklist": "Azure App Service Review",
            "guid": "a3b4d5f6-758c-4f9d-9e1a-d7c6b7e8f9ab",
            "link": "https://learn.microsoft.com/en-us/azure/app-service/monitor-instances-health-check",
            "service": "App Services",
            "severity": "Medio",
            "text": "Supervisión de instancias de App Service mediante comprobaciones de estado",
            "waf": "Fiabilidad"
        },
        {
            "checklist": "Azure App Service Review",
            "guid": "c7d3e5f9-a19c-4833-8ca6-1dcb0128e129",
            "link": "https://learn.microsoft.com/en-us/azure/azure-monitor/app/availability-overview",
            "service": "App Services",
            "severity": "Medio",
            "text": "Supervisión de la disponibilidad y la capacidad de respuesta de la aplicación web o el sitio web mediante pruebas de disponibilidad de Application Insights",
            "waf": "Fiabilidad"
        },
        {
            "checklist": "Azure App Service Review",
            "guid": "b4e3f2d5-a5c6-4d7e-8b2f-c5d9e7a8f0ea",
            "link": "https://learn.microsoft.com/en-us/azure/azure-monitor/app/availability-standard-tests",
            "service": "App Services",
            "severity": "Bajo",
            "text": "Uso de la prueba estándar de Application Insights para supervisar la disponibilidad y la capacidad de respuesta de la aplicación web o el sitio web",
            "waf": "Fiabilidad"
        },
        {
            "checklist": "Azure App Service Review",
            "description": "Use Azure Key Vault para almacenar los secretos que necesita la aplicación.  Key Vault proporciona un entorno seguro y auditado para almacenar secretos y está bien integrado con App Service a través del SDK de Key Vault o las referencias de Key Vault de App Service.",
            "guid": "834ac932-223e-4ce8-8b12-3071a5416415",
            "link": "https://learn.microsoft.com/azure/app-service/app-service-key-vault-references",
            "service": "App Services",
            "severity": "Alto",
            "text": "Uso de Key Vault para almacenar secretos",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure App Service Review",
            "description": "Use una identidad administrada para conectarse a Key Vault mediante el SDK de Key Vault o a través de las referencias de Key Vault de App Service.",
            "guid": "833ea3ad-2c2d-4e73-8165-c3acbef4abe1",
            "link": "https://learn.microsoft.com/azure/app-service/app-service-key-vault-references",
            "service": "App Services",
            "severity": "Alto",
            "text": "Uso de la identidad administrada para conectarse a Key Vault",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure App Service Review",
            "description": "Almacene el certificado TLS de App Service en Key Vault.",
            "guid": "f8d39fda-4776-4831-9c11-5775c2ea55b4",
            "link": "https://learn.microsoft.com/azure/app-service/configure-ssl-certificate",
            "service": "App Services",
            "severity": "Alto",
            "text": "Use Key Vault para almacenar el certificado TLS.",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure App Service Review",
            "description": "Los sistemas que procesan información confidencial deben estar aislados.  Para ello, use planes del Servicio de aplicaciones o entornos del Servicio de aplicaciones independientes y considere la posibilidad de usar suscripciones o grupos de administración diferentes.",
            "guid": "6ad48408-ee72-4734-a475-ba18fdbf590c",
            "link": "https://learn.microsoft.com/azure/app-service/overview-hosting-plans",
            "service": "App Services",
            "severity": "Medio",
            "text": "Aísle los sistemas que procesan información confidencial",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure App Service Review",
            "description": "Los discos locales de App Service no están cifrados y los datos confidenciales no deben almacenarse en ellos.  (Por ejemplo: D:\\\\Local y %TMP%).",
            "guid": "e65de8e0-3f9b-4cbd-9682-66abca264f9a",
            "link": "https://learn.microsoft.com/azure/app-service/operating-system-functionality#file-access",
            "service": "App Services",
            "severity": "Medio",
            "text": "No almacene datos confidenciales en el disco local",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure App Service Review",
            "description": "En el caso de la aplicación web autenticada, use un proveedor de identidades bien establecido, como Azure AD o Azure AD B2C.  Aproveche el marco de aplicaciones de su elección para integrarse con este proveedor o use la característica de autenticación o autorización del Servicio de aplicaciones.",
            "guid": "919ca0b2-c121-459e-814b-933df574eccc",
            "link": "https://learn.microsoft.com/azure/app-service/overview-authentication-authorization",
            "service": "App Services",
            "severity": "Medio",
            "text": "Usar un proveedor de identidades establecido para la autenticación",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure App Service Review",
            "description": "Implemente código en App Service desde un entorno controlado y de confianza, como una canalización de implementación de DevOps bien administrada y segura. De este modo, se evita el código que no se ha controlado la versión y se ha comprobado que se implementará desde un host malintencionado.",
            "guid": "3f9bcbd4-6826-46ab-aa26-4f9a19aed9c5",
            "link": "https://learn.microsoft.com/azure/app-service/deploy-best-practices",
            "service": "App Services",
            "severity": "Alto",
            "text": "Implementación desde un entorno de confianza",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure App Service Review",
            "description": "Deshabilite la autenticación básica tanto para FTP/FTPS como para WebDeploy/SCM.  Esto deshabilita el acceso a estos servicios y exige el uso de puntos de conexión protegidos de Azure AD para la implementación.  Tenga en cuenta que el sitio de SCM también se puede abrir con credenciales de Azure AD.",
            "guid": "5d04c2c3-919c-4a0b-8c12-159e114b933d",
            "link": "https://learn.microsoft.com/azure/app-service/deploy-configure-credentials#disable-basic-authentication",
            "service": "App Services",
            "severity": "Alto",
            "text": "Deshabilitar la autenticación básica",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure App Service Review",
            "description": "Siempre que sea posible, use Managed Identity para conectarse a los recursos protegidos de Azure AD.  Si esto no es posible, almacene los secretos en Key Vault y conéctese a Key Vault mediante una identidad administrada en su lugar.",
            "guid": "f574eccc-d9bd-43ba-bcda-3b54eb2eb03d",
            "link": "https://learn.microsoft.com/azure/app-service/overview-managed-identity?tabs=portal%2Chttp",
            "service": "App Services",
            "severity": "Alto",
            "text": "Uso de la identidad administrada para conectarse a los recursos",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure App Service Review",
            "description": "Cuando use imágenes almacenadas en Azure Container Registry, extráigalas mediante una identidad administrada.",
            "guid": "d9a25827-18d2-4ddb-8072-5769ee6691a4",
            "link": "https://learn.microsoft.com/azure/app-service/configure-custom-container#use-managed-identity-to-pull-image-from-azure-container-registry",
            "service": "App Services",
            "severity": "Alto",
            "text": "Extracción de contenedores mediante una identidad administrada",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure App Service Review",
            "description": "Al configurar las opciones de diagnóstico de App Service, puede enviar todos los datos de telemetría a Log Analytics como destino central para el registro y la supervisión. Esto le permite supervisar la actividad en tiempo de ejecución de App Service, como los registros HTTP, los registros de aplicaciones, los registros de plataforma, ...",
            "guid": "47768314-c115-4775-a2ea-55b46ad48408",
            "link": "https://learn.microsoft.com/azure/app-service/troubleshoot-diagnostic-logs",
            "service": "App Services",
            "severity": "Medio",
            "text": "Envío de registros en tiempo de ejecución de App Service a Log Analytics",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure App Service Review",
            "description": "Configure una configuración de diagnóstico para enviar el registro de actividad a Log Analytics como destino central para el registro y la supervisión. Esto le permite supervisar la actividad del plano de control en el propio recurso de App Service.",
            "guid": "ee72734b-475b-4a18-bdbf-590ce65de8e0",
            "link": "https://learn.microsoft.com/azure/azure-monitor/essentials/activity-log",
            "service": "App Services",
            "severity": "Medio",
            "text": "Envío de registros de actividad de App Service a Log Analytics",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure App Service Review",
            "description": "Controle el acceso saliente a la red mediante una combinación de integración de red virtual regional, grupos de seguridad de red y UDR.  El tráfico debe enrutarse a una aplicación virtual de red, como Azure Firewall.  Asegúrese de supervisar los registros del cortafuegos.",
            "guid": "c12159e1-14b9-433d-b574-ecccd9bd3baf",
            "link": "https://learn.microsoft.com/azure/app-service/overview-vnet-integration",
            "service": "App Services",
            "severity": "Medio",
            "text": "El acceso a la red saliente debe controlarse",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure App Service Review",
            "description": "Puede proporcionar una dirección IP de salida estable mediante la integración de red virtual y una puerta de enlace NAT de red virtual o una aplicación virtual de red como Azure Firewall.  Esto permite a la parte receptora incluir en la lista de permitidos en función de la IP, en caso de que sea necesario.  Tenga en cuenta que para las comunicaciones con los servicios de Azure, a menudo no es necesario depender de la dirección IP y, en su lugar, se deben usar mecanismos como los puntos de conexión de servicio.  (Además, el uso de puntos de conexión privados en el extremo receptor evita que se produzca SNAT y proporciona un intervalo de IP de salida estable).",
            "guid": "cda3b54e-b2eb-403d-b9a2-582718d2ddb1",
            "link": "https://learn.microsoft.com/azure/app-service/networking/nat-gateway-integration",
            "service": "App Services",
            "severity": "Bajo",
            "text": "Garantizar una IP estable para las comunicaciones salientes hacia las direcciones de Internet",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure App Service Review",
            "description": "Controle el acceso entrante a la red mediante una combinación de restricciones de acceso al Servicio de aplicaciones, puntos de conexión de servicio o puntos de conexión privados. Se pueden requerir y configurar diferentes restricciones de acceso para la propia aplicación web y el sitio de SCM.",
            "guid": "0725769e-e669-41a4-a34a-c932223ece80",
            "link": "https://learn.microsoft.com/azure/app-service/networking-features#access-restrictions",
            "service": "App Services",
            "severity": "Alto",
            "text": "El acceso a la red entrante debe controlarse",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure App Service Review",
            "description": "Protéjase contra el tráfico entrante malintencionado mediante un firewall de aplicaciones web como Application Gateway o Azure Front Door.  Asegúrese de supervisar los registros del WAF.",
            "guid": "b123071a-5416-4415-a33e-a3ad2c2de732",
            "link": "https://learn.microsoft.com/azure/app-service/networking/app-gateway-with-service-endpoints",
            "service": "App Services",
            "severity": "Alto",
            "text": "Uso de un WAF delante de App Service",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure App Service Review",
            "description": "Asegúrese de que no se pueda omitir el WAF bloqueando el acceso solo al WAF.  Use una combinación de restricciones de acceso, puntos de conexión de servicio y puntos de conexión privados.",
            "guid": "165c3acb-ef4a-4be1-b8d3-9fda47768314",
            "link": "https://learn.microsoft.com/azure/app-service/networking-features#access-restrictions",
            "service": "App Services",
            "severity": "Alto",
            "text": "Evite que se omita WAF",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure App Service Review",
            "description": "Establezca la directiva TLS mínima en 1.2 en la configuración de App Service.",
            "graph": "appserviceresources | where type =~ 'microsoft.web/sites/config' | extend compliant = (properties.MinTlsVersion>=1.2) | distinct id,compliant",
            "guid": "c115775c-2ea5-45b4-9ad4-8408ee72734b",
            "link": "https://learn.microsoft.com/azure/app-service/configure-ssl-bindings#enforce-tls-versions",
            "service": "App Services",
            "severity": "Medio",
            "text": "Establezca la directiva TLS mínima en 1.2",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure App Service Review",
            "description": "Configure App Service para que use solo HTTPS.  Esto hace que App Service se redirija de HTTP a HTTPS.  Considere seriamente el uso de HTTP Strict Transport Security (HSTS) en su código o desde su WAF, que informa a los navegadores que solo se debe acceder al sitio mediante HTTPS.",
            "graph": "where (type=='microsoft.web/sites' and (kind == 'app' or kind == 'app,linux' )) | extend compliant = (properties.httpsOnly==true) | distinct id,compliant",
            "guid": "475ba18f-dbf5-490c-b65d-e8e03f9bcbd4",
            "link": "https://learn.microsoft.com/azure/app-service/configure-ssl-bindings#enforce-https",
            "service": "App Services",
            "severity": "Alto",
            "text": "Usar solo HTTPS",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure App Service Review",
            "description": "No utilice caracteres comodín en la configuración de CORS, ya que esto permite que todos los orígenes accedan al servicio (lo que anula el propósito de CORS). En concreto, solo permite los orígenes que esperas poder acceder al servicio.",
            "guid": "68266abc-a264-4f9a-89ae-d9c55d04c2c3",
            "link": "https://learn.microsoft.com/azure/app-service/app-service-web-tutorial-rest-api",
            "service": "App Services",
            "severity": "Alto",
            "text": "Los comodines no deben usarse para CORS",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure App Service Review",
            "description": "La depuración remota no debe estar activada en producción, ya que esto abre puertos adicionales en el servicio, lo que aumenta la superficie expuesta a ataques. Tenga en cuenta que el servicio desactiva la depuración remota automáticamente después de 48 horas.",
            "graph": "appserviceresources | where type =~ 'microsoft.web/sites/config' | extend compliant = (properties.RemoteDebuggingEnabled == false) | distinct id,compliant",
            "guid": "d9bd3baf-cda3-4b54-bb2e-b03dd9a25827",
            "link": "https://learn.microsoft.com/azure/app-service/configure-common#configure-general-settings",
            "service": "App Services",
            "severity": "Alto",
            "text": "Desactivar la depuración remota",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure App Service Review",
            "description": "Habilite Defender para App Service.  Esto (entre otras amenazas) detecta comunicaciones a direcciones IP maliciosas conocidas.  Revise las recomendaciones de Defender para App Service como parte de las operaciones.",
            "guid": "18d2ddb1-0725-4769-be66-91a4834ac932",
            "link": "https://learn.microsoft.com/azure/defender-for-cloud/defender-for-app-service-introduction",
            "service": "App Services",
            "severity": "Medio",
            "text": "Habilitación de Defender for Cloud: Defender for App Service",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure App Service Review",
            "description": "Azure proporciona protección básica contra DDoS en su red, que se puede mejorar con funcionalidades inteligentes de DDoS Standard que aprenden sobre los patrones de tráfico normales y pueden detectar comportamientos inusuales. DDoS Standard se aplica a una red virtual, por lo que debe configurarse para el recurso de red delante de la aplicación, como Application Gateway o una aplicación virtual de red.",
            "guid": "223ece80-b123-4071-a541-6415833ea3ad",
            "link": "https://learn.microsoft.com/azure/ddos-protection/ddos-protection-overview",
            "service": "App Services",
            "severity": "Medio",
            "text": "Habilitación del estándar de protección DDoS en la red virtual de WAF",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure App Service Review",
            "description": "Cuando use imágenes almacenadas en Azure Container Registry, extráigalas a través de una red virtual desde Azure Container Registry mediante su punto de conexión privado y la configuración de la aplicación \"WEBSITE_PULL_IMAGE_OVER_VNET\".",
            "guid": "2c2de732-165c-43ac-aef4-abe1f8d39fda",
            "link": "https://learn.microsoft.com/azure/app-service/configure-custom-container#use-an-image-from-a-network-protected-registry",
            "service": "App Services",
            "severity": "Medio",
            "text": "Extracción de contenedores a través de una red virtual",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure App Service Review",
            "description": "Realice una prueba de penetración en la aplicación web siguiendo las reglas de participación de las pruebas de penetración.",
            "guid": "eb2eb03d-d9a2-4582-918d-2ddb10725769",
            "link": "https://learn.microsoft.com/azure/security/fundamentals/pen-testing",
            "service": "App Services",
            "severity": "Medio",
            "text": "Realizar una prueba de penetración",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure App Service Review",
            "description": "Implemente código de confianza que se haya validado y analizado en busca de vulnerabilidades de acuerdo con las prácticas de DevSecOps.",
            "guid": "19aed9c5-5d04-4c2c-9919-ca0b2c12159e",
            "link": "https://learn.microsoft.com/azure/architecture/solution-ideas/articles/devsecops-in-azure",
            "service": "App Services",
            "severity": "Medio",
            "text": "Implementación de código validado",
            "waf": "Seguridad"
        },
        {
            "checklist": "Azure App Service Review",
            "description": "Utilice las versiones más recientes de plataformas, lenguajes de programación, protocolos y marcos compatibles.",
            "guid": "114b933d-f574-4ecc-ad9b-d3bafcda3b54",
            "link": "https://learn.microsoft.com/azure/app-service/overview-patch-os-runtime",
            "service": "App Services",
            "severity": "Alto",
            "text": "Utilizar plataformas, lenguajes, protocolos y marcos actualizados",
            "waf": "Seguridad"
        }
    ],
    "metadata": {
        "name": "WAF checklist",
        "timestamp": "March 21, 2024"
    },
    "severities": [
        {
            "name": "Alto"
        },
        {
            "name": "Medio"
        },
        {
            "name": "Bajo"
        }
    ],
    "status": [
        {
            "description": "Esta comprobación aún no se ha examinado",
            "name": "No verificado"
        },
        {
            "description": "Hay un elemento de acción asociado a esta comprobación",
            "name": "Abrir"
        },
        {
            "description": "Esta comprobación se ha verificado y no hay más elementos de acción asociados a ella",
            "name": "Cumplido"
        },
        {
            "description": "No aplicable para el diseño actual",
            "name": "N/A"
        },
        {
            "description": "No es necesario",
            "name": "No es necesario"
        }
    ]
}
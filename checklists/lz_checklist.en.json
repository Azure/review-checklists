{
    "items": [
        {
            "category": "App Delivery",
            "subcategory": "App delivery",
            "text": "If you use customer-managed TLS certificates with Azure Front Door, use the 'Latest' certificate version. Reduce the risk of outages caused by manual certificate renewal.",
            "waf": "Operations",
            "guid": "f00a69de-7076-4734-a734-6e4552cad9e1",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-latest-version-for-customer-managed-certificates"
        },
        {
            "category": "Backup and Disaster Recovery",
            "subcategory": "Data Protection",
            "text": "Consider cross-region replication in Azure for BCDR with paired regions",
            "waf": "Reliability",
            "guid": "7ea02e1c-7166-45a3-bdf5-098891367fcb",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/reliability/cross-region-replication-azure"
        },
        {
            "category": "Backup and Disaster Recovery",
            "subcategory": "Data Protection",
            "text": "When using Azure Backup, consider the different backup types (GRS, ZRS & LRS) as the default setting is GRS",
            "waf": "Reliability",
            "guid": "eba8cf22-45c6-4dc1-9b57-2cceb3b97ce5",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-redundancy"
        },
        {
            "category": "Identity and Access",
            "subcategory": "Identity",
            "text": "Implement for emergency access or break-glass accounts to prevent tenant-wide account lockout",
            "waf": "Security",
            "guid": "984a859c-773e-47d2-9162-3a765a917e1f",
            "severity": "High",
            "training": "https://learn.microsoft.com/learn/modules/azure-ad-privileged-identity-management/",
            "link": "https://learn.microsoft.com/azure/active-directory/roles/security-emergency-access"
        },
        {
            "category": "Identity and Access",
            "subcategory": "Identity",
            "text": "Enforce a RBAC model for management groups, subscriptions, resource groups and resources",
            "waf": "Security",
            "guid": "348ef254-c27d-442e-abba-c7571559ab91",
            "severity": "High",
            "training": "https://learn.microsoft.com/learn/paths/implement-resource-mgmt-security/",
            "link": "https://learn.microsoft.com/azure/role-based-access-control/overview"
        },
        {
            "category": "Identity and Access",
            "subcategory": "Identity",
            "text": "Enforce Azure AD conditional-access policies for any user with rights to Azure environments",
            "waf": "Security",
            "guid": "53e8908a-e28c-484c-93b6-b7808b9fe5c4",
            "severity": "Low",
            "training": "https://learn.microsoft.com/learn/modules/plan-implement-administer-conditional-access/",
            "link": "https://learn.microsoft.com/azure/active-directory/conditional-access/overview"
        },
        {
            "category": "Identity and Access",
            "subcategory": "Identity",
            "text": "Enforce multi-factor authentication for any user with rights to the Azure environments",
            "waf": "Security",
            "guid": "1049d403-a923-4c34-94d0-0018ac6a9e01",
            "severity": "High",
            "training": "https://learn.microsoft.com/learn/modules/secure-aad-users-with-mfa/",
            "link": "https://learn.microsoft.com/azure/active-directory/authentication/concept-mfa-howitworks"
        },
        {
            "category": "Identity and Access",
            "subcategory": "Identity",
            "text": "Enforce centralized and delegated responsibilities to manage resources deployed inside the landing zone, based on role and security requirements",
            "waf": "Security",
            "guid": "e6a83de5-de32-4c19-a248-1607d5d1e4e6",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/paths/azure-administrator-manage-identities-governance/",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/manage/centralize-operations"
        },
        {
            "category": "Identity and Access",
            "subcategory": "Identity",
            "text": "Enforce Azure AD Privileged Identity Management (PIM) to establish zero standing access and least privilege",
            "waf": "Security",
            "guid": "14658d35-58fd-4772-99b8-21112df27ee4",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/modules/azure-ad-privileged-identity-management/",
            "link": "https://learn.microsoft.com/azure/active-directory/privileged-identity-management/pim-configure"
        },
        {
            "category": "Identity and Access",
            "subcategory": "Identity",
            "text": "Only use the authentication type Work or school account for all account types. Avoid using the Microsoft account",
            "waf": "Security",
            "guid": "12e7f983-f630-4472-8dd6-9c5b5c2622f5",
            "severity": "High",
            "training": "https://learn.microsoft.com/learn/modules/explore-basic-services-identity-types/",
            "link": "https://learn.microsoft.com/azure/active-directory/roles/security-planning#identify-microsoft-accounts-in-administrative-roles-that-need-to-be-switched-to-work-or-school-accounts"
        },
        {
            "category": "Identity and Access",
            "subcategory": "Identity",
            "text": "Only use groups to assign permissions. Add on-premises groups to the Azure-AD-only group if a group management system is already in place.",
            "waf": "Security",
            "guid": "4b69bad3-3aad-45e8-a68e-1d76667313b4",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/paths/manage-identity-and-access/",
            "link": "https://learn.microsoft.com/azure/active-directory/fundamentals/active-directory-groups-create-azure-portal"
        },
        {
            "category": "Identity and Access",
            "subcategory": "Identity",
            "text": "Consider using Azure custom roles for the following key roles: Azure platform owner, network management, security operations, subscription owner, application owner",
            "waf": "Security",
            "guid": "f5664b5e-984a-4859-a773-e7d261623a76",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/modules/create-custom-azure-roles-with-rbac/",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/identity-access#prerequisites-for-a-landing-zone---design-recommendations"
        },
        {
            "category": "Identity and Access",
            "subcategory": "Identity",
            "text": "If any data sovereignty requirements exist, Azure Policies can be deployed to enforce them",
            "waf": "Security",
            "guid": "5a917e1f-348e-4f25-9c27-d42e8bbac757",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/paths/secure-your-cloud-data/",
            "link": "https://azure.microsoft.com/resources/achieving-compliant-data-residency-and-security-with-azure/"
        },
        {
            "category": "Identity and Access",
            "subcategory": "Identity",
            "text": "If Azure Active Directory Domains Services (AADDS) is in use, deploy AADDS within the primary region because this service can only be projected into one subscription",
            "waf": "Security",
            "guid": "1559ab91-53e8-4908-ae28-c84c33b6b780",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/modules/azure-active-directory/",
            "link": "https://learn.microsoft.com/azure/active-directory-domain-services/overview"
        },
        {
            "category": "Identity and Access",
            "subcategory": "Identity",
            "text": "If AADDS in use, evaluate the compatibility of all workloads",
            "waf": "Security",
            "guid": "8b9fe5c4-1049-4d40-9a92-3c3474d00018",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/modules/implement-hybrid-identity-windows-server/",
            "link": "https://learn.microsoft.com/azure/active-directory-domain-services/overview"
        },
        {
            "category": "Identity and Access",
            "subcategory": "Identity",
            "text": "If AD on Windows server in use, can all required resources access correct domain controller?",
            "waf": "Security",
            "guid": "ac6a9e01-e6a8-43de-9de3-2c1992481607",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/paths/implement-windows-server-iaas-virtual-machine-identity/",
            "link": "https://learn.microsoft.com/azure/architecture/reference-architectures/identity/adds-extend-domain"
        },
        {
            "category": "Identity and Access",
            "subcategory": "Identity",
            "text": "Consider using Azure AD Application Proxy as a VPN or reverse proxy replacement to give remote users secure and authenticated access to internal applications (hosted in the cloud or on-premises).",
            "waf": "Security",
            "guid": "d5d1e4e6-1465-48d3-958f-d77249b82111",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/paths/implement-applications-external-access-azure-ad/",
            "link": "https://learn.microsoft.com/azure/active-directory/app-proxy/application-proxy"
        },
        {
            "category": "Identity and Access",
            "subcategory": "Identity",
            "text": "Avoid using on-premises synced accounts for Azure AD role assignments.",
            "waf": "Security",
            "guid": "35037e68-9349-4c15-b371-228514f4cdff",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/modules/design-identity-security-strategy/",
            "link": "https://learn.microsoft.com/azure/active-directory/roles/best-practices"
        },
        {
            "category": "Management Group and Subscriptions",
            "subcategory": "Subscriptions",
            "text": "Enforce reasonably flat management group hierarchy with no more than three to four levels, ideally",
            "waf": "Security",
            "guid": "2df27ee4-12e7-4f98-9f63-04722dd69c5b",
            "severity": "Medium",
            "graph": "resourcecontainers| where type == 'microsoft.resources/subscriptions'| extend ManagementGroup = tostring(tags),mgmtChain = properties.managementGroupAncestorsChain| extend compliant =( array_length(mgmtChain) <= 4 and array_length(mgmtChain) > 1)",
            "training": "https://learn.microsoft.com/learn/modules/azure-architecture-fundamentals/",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/resource-org-management-groups"
        },
        {
            "category": "Management Group and Subscriptions",
            "subcategory": "Subscriptions",
            "text": "Enforce or appended resource tags through Azure Policy",
            "waf": "Security",
            "guid": "5c2622f5-4b69-4bad-93aa-d5e8c68e1d76",
            "severity": "Medium",
            "graph": "resources | extend compliant = isnotnull(['tags']) | project name, id, subscriptionId, resourceGroup, tags, compliant",
            "training": "https://learn.microsoft.com/learn/paths/implement-resource-mgmt-security/",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/decision-guides/resource-tagging/?toc=/azure/azure-resource-manager/management/toc.json"
        },
        {
            "category": "Management Group and Subscriptions",
            "subcategory": "Subscriptions",
            "text": "Enforce a sandbox management group to allow users to immediately experiment with Azure",
            "waf": "Security",
            "guid": "667313b4-f566-44b5-b984-a859c773e7d2",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/paths/enterprise-scale-architecture/",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/resource-org-management-groups#management-group-recommendations"
        },
        {
            "category": "Management Group and Subscriptions",
            "subcategory": "Subscriptions",
            "text": "Enforce a platform management group under the root management group to support common platform policy and Azure role assignment",
            "waf": "Security",
            "guid": "61623a76-5a91-47e1-b348-ef254c27d42e",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/paths/enterprise-scale-architecture/",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/resource-org-management-groups#management-group-recommendations"
        },
        {
            "category": "Management Group and Subscriptions",
            "subcategory": "Subscriptions",
            "text": "Enforce a dedicated connectivity subscription in the Platform management group to host an Azure Virtual WAN hub, private Domain Name System (DNS), ExpressRoute circuit, and other networking resources.",
            "waf": "Security",
            "guid": "8bbac757-1559-4ab9-853e-8908ae28c84c",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/paths/enterprise-scale-architecture/",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/resource-org-management-groups#management-group-recommendations"
        },
        {
            "category": "Management Group and Subscriptions",
            "subcategory": "Subscriptions",
            "text": "Enforce no subscriptions are placed under the root management group",
            "waf": "Security",
            "guid": "33b6b780-8b9f-4e5c-9104-9d403a923c34",
            "severity": "Medium",
            "graph": "resourcecontainers| where type == 'microsoft.resources/subscriptions'| extend ManagementGroup = tostring(tags),mgmtChain = properties.managementGroupAncestorsChain| extend compliant = (array_length(mgmtChain) > 1)",
            "link": "https://learn.microsoft.com/azure/governance/management-groups/how-to/protect-resource-hierarchy#setting---default-management-group"
        },
        {
            "category": "Management Group and Subscriptions",
            "subcategory": "Subscriptions",
            "text": "Enforce that only privileged users can operate management groups in the tenant by enabling Azure RBAC authorization in the management group hierarchy settings",
            "waf": "Security",
            "guid": "74d00018-ac6a-49e0-8e6a-83de5de32c19",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/governance/management-groups/how-to/protect-resource-hierarchy#setting---require-authorization"
        },
        {
            "category": "Management Group and Subscriptions",
            "subcategory": "Subscriptions",
            "text": "Enforce management groups under the root-level management group to represent the types of workloads, based on their security, compliance, connectivity, and feature needs.",
            "waf": "Security",
            "guid": "92481607-d5d1-4e4e-9146-58d3558fd772",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/governance/management-groups/overview"
        },
        {
            "category": "Management Group and Subscriptions",
            "subcategory": "Subscriptions",
            "text": "Enforce a process to make resource owners aware of their roles and responsibilities, access review, budget review, policy compliance and remediate when necessary.",
            "waf": "Security",
            "guid": "49b82111-2df2-47ee-912e-7f983f630472",
            "severity": "High",
            "link": "https://learn.microsoft.com/azure/governance/management-groups/overview"
        },
        {
            "category": "Management Group and Subscriptions",
            "subcategory": "Subscriptions",
            "text": "Ensure that all subscription owners and IT core team are aware of subscription resource limitations as part of workload design sessions.",
            "waf": "Security",
            "guid": "2dd69c5b-5c26-422f-94b6-9bad33aad5e8",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits"
        },
        {
            "category": "Management Group and Subscriptions",
            "subcategory": "Subscriptions",
            "text": "Use Reserved Instances where appropriate to optimize cost and ensure available capacity in target regions. Enforce the use of purchased Reserved Instance VM SKUs via Azure Policy.",
            "waf": "Security",
            "guid": "c68e1d76-6673-413b-9f56-64b5e984a859",
            "severity": "High",
            "training": "https://learn.microsoft.com/learn/paths/improve-reliability-modern-operations/",
            "link": "https://learn.microsoft.com/azure/cost-management-billing/reservations/save-compute-costs-reservations"
        },
        {
            "category": "Management Group and Subscriptions",
            "subcategory": "Subscriptions",
            "text": "Enforce a dashboard, workbook, or manual process to monitor used capacity levels",
            "waf": "Security",
            "guid": "c773e7d2-6162-43a7-95a9-17e1f348ef25",
            "severity": "High",
            "training": "https://learn.microsoft.com/learn/paths/monitor-usage-performance-availability-resources-azure-monitor/",
            "link": "https://learn.microsoft.com/azure/architecture/framework/scalability/design-capacity"
        },
        {
            "category": "Management Group and Subscriptions",
            "subcategory": "Subscriptions",
            "text": "Ensure required services and features are available within the chosen deployment regions",
            "waf": "Security",
            "guid": "4c27d42e-8bba-4c75-9155-9ab9153e8908",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/modules/azure-architecture-fundamentals/",
            "link": "https://azure.microsoft.com/global-infrastructure/services/"
        },
        {
            "category": "Management Group and Subscriptions",
            "subcategory": "Subscriptions",
            "text": "Enforce a process for cost management",
            "waf": "Security",
            "guid": "ae28c84c-33b6-4b78-88b9-fe5c41049d40",
            "severity": "High",
            "training": "https://learn.microsoft.com/learn/paths/control-spending-manage-bills/",
            "link": "https://learn.microsoft.com/azure/cost-management-billing/cost-management-billing-overview"
        },
        {
            "category": "Management Group and Subscriptions",
            "subcategory": "Subscriptions",
            "text": "If AD on Windows Server, establish a dedicated identity subscription in the Platform management group to host Windows Server Active Directory domain controllers",
            "waf": "Security",
            "guid": "3a923c34-74d0-4001-aac6-a9e01e6a83de",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/paths/enterprise-scale-architecture/",
            "link": "https://learn.microsoft.com/azure/governance/management-groups/overview"
        },
        {
            "category": "Management Group and Subscriptions",
            "subcategory": "Subscriptions",
            "text": "Ensure tags are used for billing and cost management",
            "waf": "Security",
            "guid": "5de32c19-9248-4160-9d5d-1e4e614658d3",
            "severity": "Medium",
            "graph": "resources | extend compliant = isnotnull(['tags']) | project name, id, subscriptionId, resourceGroup, tags, compliant",
            "training": "https://learn.microsoft.com/learn/paths/implement-resource-mgmt-security/",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/track-costs"
        },
        {
            "category": "Management and Monitoring",
            "subcategory": "App delivery",
            "text": "Add diagnostic settings to save your Azure Front Door WAF's logs. Regularly review the logs to check for attacks and for false positive detections.",
            "waf": "Operations",
            "guid": "89cc5e11-aa4d-4c3b-893d-feb99215266a",
            "severity": "High",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#add-diagnostic-settings-to-save-your-wafs-logs"
        },
        {
            "category": "Management and Monitoring",
            "subcategory": "App delivery",
            "text": "Send Azure Front Door logs to Microsoft Sentinel. Detect attacks and integrate Front Door telemetry into your overall Azure environment.",
            "waf": "Operations",
            "guid": "7f408960-c626-44cb-a018-347c8d790cdf",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#send-logs-to-microsoft-sentinel"
        },
        {
            "category": "Management and Monitoring",
            "subcategory": "Monitoring",
            "text": "Use a single monitor logs workspace to manage platforms centrally except where Azure role-based access control (Azure RBAC), data sovereignty requirements, or data retention policies mandate separate workspaces.",
            "waf": "Operations",
            "guid": "67e7a8ed-4b30-4e38-a3f2-9812b2363cef",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/azure/azure-monitor/logs/design-logs-deployment",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/design-logs-deployment"
        },
        {
            "category": "Management and Monitoring",
            "subcategory": "Monitoring",
            "text": "Is the landing zone documented?",
            "waf": "Operations",
            "guid": "e179b599-de0d-4597-9cd4-cd21b088137f",
            "severity": "Medium"
        },
        {
            "category": "Management and Monitoring",
            "subcategory": "Monitoring",
            "text": "Export logs to Azure Storage if log retention requirements exceed two years. Use immutable storage with a write-once, read-many policy to make data non-erasable and non-modifiable for a user-specified interval.",
            "waf": "Operations",
            "guid": "5e6c4cfd-3e50-4454-9c24-47ec66138a72",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/paths/architect-infrastructure-operations/",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/design-logs-deployment"
        },
        {
            "category": "Management and Monitoring",
            "subcategory": "Monitoring",
            "text": "Use Azure Policy for access control and compliance reporting. Azure Policy provides the ability to enforce organization-wide settings to ensure consistent policy adherence and fast violation detection. ",
            "waf": "Operations",
            "guid": "00f1ce16-ed30-41d6-b872-e52e3611cc58",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/paths/architect-infrastructure-operations/",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/design-logs-deployment"
        },
        {
            "category": "Management and Monitoring",
            "subcategory": "Monitoring",
            "text": "Monitor in-guest virtual machine (VM) configuration drift using Azure Policy. Enabling guest configuration audit capabilities through policy helps application team workloads to immediately consume feature capabilities with little effort.",
            "waf": "Operations",
            "guid": "e7d7e484-3276-4d8b-bc05-5bcf619e8a13",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/paths/implement-resource-mgmt-security/",
            "link": "https://learn.microsoft.com/azure/governance/policy/how-to/guest-configuration-create"
        },
        {
            "category": "Management and Monitoring",
            "subcategory": "Monitoring",
            "text": "Use Update Management in Azure Automation as a long-term patching mechanism for both Windows and Linux VMs. ",
            "waf": "Operations",
            "guid": "f9887952-5d62-4688-9d70-ba6c97be9951",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/paths/azure-administrator-manage-compute-resources/",
            "link": "https://learn.microsoft.com/azure/automation/update-management/overview"
        },
        {
            "category": "Management and Monitoring",
            "subcategory": "Monitoring",
            "text": "Use Network Watcher to proactively monitor traffic flows",
            "waf": "Operations",
            "guid": "90483845-c986-4cb2-a131-56a12476e49f",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/modules/configure-network-watcher/",
            "link": "https://learn.microsoft.com/azure/network-watcher/network-watcher-monitoring-overview"
        },
        {
            "category": "Management and Monitoring",
            "subcategory": "Monitoring",
            "text": "Use resource locks to prevent accidental deletion of critical shared services.",
            "waf": "Operations",
            "guid": "541acdce-9793-477b-adb3-751ab2ab13ad",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/paths/implement-resource-mgmt-security/",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/lock-resources?tabs=json"
        },
        {
            "category": "Management and Monitoring",
            "subcategory": "Monitoring",
            "text": "Use deny policies to supplement Azure role assignments. The combination of deny policies and Azure role assignments ensures the appropriate guardrails are in place to enforce who can deploy and configure resources and what resources they can deploy and configure.",
            "waf": "Operations",
            "guid": "a6e55d7d-8a2a-4db1-87d6-326af625ca44",
            "severity": "Low",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview"
        },
        {
            "category": "Management and Monitoring",
            "subcategory": "Monitoring",
            "text": "Include service and resource health events as part of the overall platform monitoring solution. Tracking service and resource health from the platform perspective is an important component of resource management in Azure.",
            "waf": "Operations",
            "guid": "e5695f22-23ac-4e8c-a123-08ca5017f154",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/service-health/alerts-activity-log-service-notifications-portal"
        },
        {
            "category": "Management and Monitoring",
            "subcategory": "Monitoring",
            "text": "Include alerts and action groups as part of the Azure Service Health platform to ensure that alerts or issues can be actioned",
            "waf": "Operations",
            "guid": "d5f345bf-97ab-41a7-819c-6104baa7d48c",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/azure-monitor/alerts/action-groups"
        },
        {
            "category": "Management and Monitoring",
            "subcategory": "Monitoring",
            "text": "Don't send raw log entries back to on-premises monitoring systems. Instead, adopt a principle that data born in Azure stays in Azure. If on-premises SIEM integration is required, then send critical alerts instead of logs.",
            "waf": "Operations",
            "guid": "e3ab3693-829e-47e3-8618-3687a0477a20",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/sentinel/quickstart-onboard"
        },
        {
            "category": "Management and Monitoring",
            "subcategory": "Monitoring",
            "text": "Use a centralized Azure Monitor Log Analytics workspace to collect logs and metrics from IaaS and PaaS application resources and control log access with Azure RBAC.",
            "waf": "Operations",
            "guid": "9945bda4-3334-4f24-a116-34182ba52752",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/design-logs-deployment"
        },
        {
            "category": "Management and Monitoring",
            "subcategory": "Monitoring",
            "text": "Use Azure Monitor Logs for insights and reporting.",
            "waf": "Operations",
            "guid": "6944008b-e7d7-4e48-9327-6d8bdc055bcf",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-setup-guide/monitoring-reporting?tabs=AzureMonitor"
        },
        {
            "category": "Management and Monitoring",
            "subcategory": "Monitoring",
            "text": "When necessary, use shared storage accounts within the landing zone for Azure diagnostic extension log storage.",
            "waf": "Operations",
            "guid": "619e8a13-f988-4795-85d6-26886d70ba6c",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/azure-monitor/agents/diagnostics-extension-overview"
        },
        {
            "category": "Management and Monitoring",
            "subcategory": "Monitoring",
            "text": "Use Azure Monitor alerts for the generation of operational alerts.",
            "waf": "Operations",
            "guid": "97be9951-9048-4384-9c98-6cb2913156a1",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/azure-monitor/alerts/alerts-overview"
        },
        {
            "category": "Management and Monitoring",
            "subcategory": "Monitoring",
            "text": "Use Azure Site Recovery for Azure-to-Azure Virtual Machines disaster recovery scenarios. This enables you to replicate workloads across regions.",
            "waf": "Operations",
            "guid": "2476e49f-541a-4cdc-b979-377bcdb3751a",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/site-recovery/site-recovery-overview"
        },
        {
            "category": "Management and Monitoring",
            "subcategory": "Monitoring",
            "text": "Ensure to use and test native PaaS service disaster recovery capabilities.",
            "waf": "Operations",
            "guid": "b2ab13ad-a6e5-45d7-b8a2-adb117d6326a",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/architecture/framework/resiliency/backup-and-recovery"
        },
        {
            "category": "Management and Monitoring",
            "subcategory": "Monitoring",
            "text": "Use Azure-native backup capabilities. Verify that partner/customer is aware of Azure Backup and all new capabilities which greatly can simplify backup management",
            "waf": "Operations",
            "guid": "f625ca44-e569-45f2-823a-ce8cb12308ca",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/backup/backup-center-overview"
        },
        {
            "category": "Management and Monitoring",
            "subcategory": "Monitoring",
            "text": "Ensure that monitoring requirements have been assessed and that appropriate data collection and alerting configurations are applied",
            "waf": "Operations",
            "guid": "859c3900-4514-41eb-b010-475d695abd74",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/architecture/best-practices/monitoring"
        },
        {
            "category": "Management and Monitoring",
            "subcategory": "Monitoring",
            "text": "Consider supported regions for linked Log Analytics workspace and automation accounts",
            "waf": "Operations",
            "guid": "fed3c55f-a67e-4875-aadd-3aba3f9fde31",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/automation/how-to/region-mappings"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "App delivery",
            "text": "Perform app delivery within landing zones for both internal-facing (corp) and external-facing apps (online).",
            "waf": "Security",
            "guid": "6138a720-0f1c-4e16-bd30-1d6e872e52e3",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/resource-org-management-groups#management-groups-in-the-azure-landing-zone-accelerator"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "App delivery",
            "text": "Ensure you are using Application Gateway v2 SKU",
            "waf": "Security",
            "guid": "553585a6-abe0-11ed-afa1-0242ac120002",
            "severity": "Medium",
            "graph": "resources | where type == 'microsoft.network/applicationgateways' | project id, compliant = properties.sku.name in ('Standard_v2', 'WAF_v2') | project id,compliant",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "link": "https://learn.microsoft.com/azure/application-gateway/overview-v2"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "App delivery",
            "text": "Deploy Azure Application Gateway v2 or partner NVAs used for proxying inbound HTTP(S) connections within the landing-zone virtual network and with the apps that they're securing.",
            "description": "Administration of reverse proxies in general and WAF in particular is closer to the application than to networking, so they belong in the same subscription as the app. Centralizing the Application Gateway and WAF in the connectivity subscription might be OK if it is managed by one single team.",
            "waf": "Security",
            "guid": "48b662d6-d15f-4512-a654-98f6dfe237de",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "App delivery",
            "text": "Use a DDoS Network or IP protection plans for all Public IP addresses in application landing zones.",
            "waf": "Security",
            "guid": "143b16c3-1d7a-4a9b-9470-4489a8042d88",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "App delivery",
            "text": "Use Azure Front Door with WAF policies to deliver and help protect global HTTP/S apps that span multiple Azure regions.",
            "waf": "Security",
            "guid": "e79d17b7-3b22-4a5a-97e7-a8ed4b30e38c",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "App delivery",
            "text": "When using Front Door and Application Gateway to help protect HTTP/S apps, use WAF policies in Front Door. Lock down Application Gateway to receive traffic only from Front Door.",
            "waf": "Security",
            "guid": "3f29812b-2363-4cef-b179-b599de0d5973",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "link": "https://learn.microsoft.com/azure/ddos-protection/ddos-protection-overview"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "App delivery",
            "text": "Use Traffic Manager to deliver global apps that span protocols other than HTTP/S.",
            "waf": "Reliability",
            "guid": "cd4cd21b-0881-437f-9e6c-4cfd3e504547",
            "severity": "High",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "App delivery",
            "text": "If users only need access to internal applications, has Azure AD Application Proxy been considered as an alternative to Azure Virtual Desktop (AVD)?",
            "waf": "Security",
            "guid": "3b4b3e88-a459-4ed5-a22f-644dfbc58204",
            "severity": "Low",
            "training": "https://learn.microsoft.com/learn/modules/configure-azure-ad-application-proxy/",
            "link": "https://learn.microsoft.com/azure/active-directory/app-proxy/application-proxy#how-application-proxy-works"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "App delivery",
            "text": "To reduce the number of firewall ports open for incoming connections in your network, consider using Azure AD Application Proxy to give remote users secure and authenticated access to internal applications.",
            "waf": "Security",
            "guid": "01ca7cf1-5754-442d-babb-8ba6772e5c30",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/paths/implement-applications-external-access-azure-ad/",
            "link": "https://learn.microsoft.com/azure/active-directory/app-proxy/application-proxy#how-application-proxy-works"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "App delivery",
            "text": "Deploy your WAF profiles for Front Door in 'Prevention' mode.",
            "waf": "Security",
            "guid": "ae248989-b306-4591-9186-de482e3f0f0e",
            "severity": "High",
            "graph": "resources | where type == 'microsoft.network/frontdoorwebapplicationfirewallpolicies' | project policyName=name, policyId=id,policySku=sku.name, links=properties.securityPolicyLinks, enabledState=properties.policySettings.enabledState, mode=properties.policySettings.mode | mvexpand links | extend securityPolicy=links.id | extend securityPolicyParts=split(securityPolicy, '/') | extend profileId=strcat_array(array_slice(securityPolicyParts, 0, -3), '/') | project id=profileId, compliant=((enabledState=='Enabled') and (mode=='Prevention')), enabledState, mode",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-policy-settings"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "App delivery",
            "text": "Avoid combining Azure Traffic Manager and Azure Front Door.",
            "waf": "Security",
            "guid": "062d5839-4d36-402f-bfa4-02811eb936e9",
            "severity": "High",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#avoid-combining-traffic-manager-and-front-door"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "App delivery",
            "text": "Use the same domain name on Azure Front Door and your origin. Mismatched host names can cause subtle bugs.",
            "waf": "Security",
            "guid": "5efeb96a-003f-4b18-8fcd-b4d84459c2b2",
            "severity": "High",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-the-same-domain-name-on-front-door-and-your-origin"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "App delivery",
            "text": "Disable health probes when there is only one origin in an Azure Front Door origin group.",
            "waf": "Performance",
            "guid": "0b5a380c-4bfb-47bc-b1d7-dcfef363a61b",
            "severity": "Low",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#disable-health-probes-when-theres-only-one-origin-in-an-origin-group"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "App delivery",
            "text": "Select good health probe endpoints for Azure Front Door. Consider building health endpoints that check all of your application's dependencies.",
            "waf": "Reliability",
            "guid": "5567048e-e5d7-4206-9c55-b5ed45d2cc0c",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#select-good-health-probe-endpoints"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "App delivery",
            "text": "Use HEAD health probes with Azure Front Door, to reduce the traffic that Front Door sends to your application.",
            "waf": "Performance",
            "guid": "a13f72f3-8f5c-4864-95e5-75bf37fbbeb1",
            "severity": "Low",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-head-health-probes"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Encryption",
            "text": "When you're using ExpressRoute Direct, configure MACsec in order to encrypt traffic at the layer-two level between the organization's routers and MSEE. The diagram shows this encryption in flow.",
            "waf": "Security",
            "guid": "de0d5973-cd4c-4d21-a088-137f5e6c4cfd",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/virtual-network/network-security-group-how-it-works"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Encryption",
            "text": "For scenarios where MACsec isn't an option (for example, not using ExpressRoute Direct), use a VPN gateway to establish IPsec tunnels over ExpressRoute private peering. ",
            "waf": "Security",
            "guid": "ed301d6e-872e-452e-9611-cc58b5a4b151",
            "severity": "Low",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-erdirect-about"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Hub and spoke",
            "text": "Consider a network design based on the traditional hub-and-spoke network topology for network scenarios that require maximum flexibility.",
            "waf": "Security",
            "guid": "e8bbac75-7155-49ab-a153-e8908ae28c84",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/paths/architect-network-infrastructure/",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/enterprise-scale/network-topology-and-connectivity"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Hub and spoke",
            "text": "Ensure that shared networking services, including ExpressRoute gateways, VPN gateways, and Azure Firewall or partner NVAs in the central-hub virtual network. If necessary, also deploy Active Directory domain controllers and DNS servers.",
            "waf": "Cost",
            "guid": "7dd61623-a364-4a90-9eca-e48ebd54cd7d",
            "severity": "High",
            "link": "https://learn.microsoft.com/azure/architecture/reference-architectures/hybrid-networking/expressroute"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Hub and spoke",
            "text": "When deploying partner networking technologies or NVAs, follow the partner vendor's guidance",
            "waf": "Reliability",
            "guid": "e2e8abac-3571-4559-ab91-53e89f89dc7b",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/architecture/reference-architectures/dmz/nva-ha"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Hub and spoke",
            "text": "If you need transit between ExpressRoute and VPN gateways in hub and spoke scenarios, use Azure Route Server.",
            "waf": "Security",
            "guid": "ce463dbb-bc8a-4c2a-aebc-92a43da1dae2",
            "severity": "Low",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-howto-coexist-resource-manager#to-enable-transit-routing-between-expressroute-and-azure-vpn"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Hub and spoke",
            "text": "For network architectures with multiple hub-and-spoke topologies across Azure regions, use global virtual network peerings between the hub VNets to connect the regions to each other. ",
            "waf": "Performance",
            "guid": "cc881471-607c-41cc-a0e6-14658dd558f9",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/paths/azure-administrator-manage-virtual-networks/",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-networks-faq#can-i-create-a-peering-connection-to-a-vnet-in-a-different-region"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Hub and spoke",
            "text": "Use Azure Monitor for Networks to monitor the end-to-end state of the networks on Azure.",
            "waf": "Operations",
            "guid": "4722d929-c1b1-4cd6-81f5-4b29bade39ad",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-network-monitoring/",
            "link": "https://learn.microsoft.com/azure/azure-monitor/insights/network-insights-overview"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Hub and spoke",
            "text": "When connecting spoke virtual networks to the central hub virtual network, consider VNet peering limits and the maximum number of prefixes that can be advertised via ExpressRoute",
            "waf": "Reliability",
            "guid": "0e7c28ec-9366-4572-83b0-f4664b1d944a",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits?toc=/azure/virtual-network/toc.json#azure-resource-manager-virtual-networking-limits"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Hub and spoke",
            "text": "Use the setting 'Allow traffic to remote virtual network' when configuring VNet peerings",
            "waf": "Reliability",
            "guid": "c76cb5a2-abe2-11ed-afa1-0242ac120002",
            "severity": "High",
            "graph": "resources | where type == 'microsoft.network/virtualnetworks' | mvexpand properties.virtualNetworkPeerings | project id, peeringName=properties_virtualNetworkPeerings.name, compliant = (properties_virtualNetworkPeerings.properties.allowVirtualNetworkAccess == True)",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-network-manage-peering"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Hybrid",
            "text": "Ensure that you have investigated the possibility to use ExpressRoute as primary connection to Azure.",
            "waf": "Performance",
            "guid": "359c373e-7dd6-4162-9a36-4a907ecae48e",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "link": "https://learn.microsoft.com/azure/architecture/reference-architectures/hybrid-networking/hub-spoke?tabs=cli"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Hybrid",
            "text": "When you use multiple ExpressRoute circuits, or multiple on-prem locations, make sure to optimize routing with BGP attributes, if certain paths are preferred.",
            "description": "You can use AS-path prepending and connection weights to influence traffic from Azure to on-premises, and the full range of BGP attributes in your own routers to influence traffic from on-premises to Azure.",
            "waf": "Reliability",
            "guid": "f29812b2-363c-4efe-879b-599de0d5973c",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-routing"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Hybrid",
            "text": "Ensure that you're using the right SKU for the ExpressRoute/VPN gateways based on bandwidth and performance requirements.",
            "waf": "Performance",
            "guid": "d4cd21b0-8813-47f5-b6c4-cfd3e504547c",
            "severity": "Medium",
            "graph": "resources| where type == 'microsoft.network/virtualnetworkgateways'| where properties.gatewayType =~ 'vpn' or properties.gatewayType == 'ExpressRoute'| extend SKUName = properties.sku.name, SKUTier = properties.sku.tier, Type = properties.gatewayType| extend compliant = SKUTier !in ('Basic', 'Standard')| project name, id, subscriptionId, resourceGroup, compliant",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-routing"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Hybrid",
            "text": "Deploy a zone-redundant ExpressRoute gateway in the supported Azure regions.",
            "waf": "Reliability",
            "guid": "2447ec66-138a-4720-8f1c-e16ed301d6e8",
            "severity": "Medium",
            "graph": "resources| where type == 'microsoft.network/virtualnetworkgateways'| where properties.gatewayType =~ 'vpn' or properties.gatewayType == 'ExpressRoute'| extend SKUName = properties.sku.name, SKUTier = properties.sku.tier, Type = properties.gatewayType| extend compliant = SKUTier contains 'AZ'| project name, id, subscriptionId, resourceGroup, Type, compliant",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-about-virtual-network-gateways"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Hybrid",
            "text": "For scenarios that require bandwidth higher than 10 Gbps or dedicated 10/100-Gbps ports, use ExpressRoute Direct.",
            "waf": "Performance",
            "guid": "72e52e36-11cc-458b-9a4b-1511e43a58a9",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "link": "https://learn.microsoft.com/azure/networking/"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Hybrid",
            "text": "When low latency is required, or throughput from on-premises to Azure must be greater than 10 Gbps, enable FastPath to bypass the ExpressRoute gateway from the data path.",
            "waf": "Performance",
            "guid": "c2299c4d-7b57-4d0c-9555-62f2b3e4563a",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "link": "https://learn.microsoft.com/azure/expressroute/about-fastpath"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Hybrid",
            "text": "Use VPN gateways to connect branches or remote locations to Azure. For higher resilience, deploy zone-redundant gateways (where available).",
            "waf": "Reliability",
            "guid": "4d873974-8b66-42d6-b15f-512a65498f6d",
            "severity": "Medium",
            "graph": "resources | where type=='microsoft.network/virtualnetworkgateways' | where properties.gatewayType == 'Vpn' | extend compliant = (tolower(properties.sku.name) contains 'az') | distinct id, compliant",
            "training": "https://learn.microsoft.com/training/modules/intro-to-azure-vpn-gateway/",
            "link": "https://learn.microsoft.com/azure/vpn-gateway/create-zone-redundant-vnet-gateway"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Hybrid",
            "text": "If using ExpressRoute Direct, consider using ExpressRoute Local circuits to the local Azure regions to save costs",
            "waf": "Cost",
            "guid": "718cb437-b060-2589-8856-2e93a5c6633b",
            "severity": "High",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-erdirect-about"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Hybrid",
            "text": "When traffic isolation or dedicated bandwidth is required, such as for separating production and nonproduction environments, use different ExpressRoute circuits. It will help you ensure isolated routing domains and alleviate noisy-neighbor risks.",
            "waf": "Security",
            "guid": "8042d88e-79d1-47b7-9b22-a5a67e7a8ed4",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "link": "https://learn.microsoft.com/azure/architecture/framework/services/networking/expressroute/reliability"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Hybrid",
            "text": "Monitor ExpressRoute availability and utilization using built-in Azure Monitor metrics.",
            "waf": "Operations",
            "guid": "b30e38c3-f298-412b-8363-cefe179b599d",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "link": "https://learn.microsoft.com/azure/expressroute/expressroute-monitoring-metrics-alerts"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Hybrid",
            "text": "Use Connection Monitor for connectivity monitoring across the environment.",
            "waf": "Operations",
            "guid": "5bf68dc9-325e-4873-bf88-f8214ef2e5d2",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "link": "https://learn.microsoft.com/azure/expressroute/how-to-configure-connection-monitor"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Hybrid",
            "text": "Use ExpressRoute circuits from different peering locations for redundancy.",
            "waf": "Reliability",
            "guid": "e0d5973c-d4cd-421b-8881-37f5e6c4cfd3",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "link": "https://learn.microsoft.com/azure/expressroute/designing-for-disaster-recovery-with-expressroute-privatepeering#challenges-of-using-multiple-expressroute-circuits"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Hybrid",
            "text": "When deploying an AD Connect VM, consider having a staging sever for high availability / Disaster recovery",
            "waf": "Reliability",
            "guid": "cd163e39-84a5-4b39-97b7-6973abd70d94",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/active-directory/hybrid/how-to-connect-sync-staging-server"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Hybrid",
            "text": "Consider using Azure Bastion to securely connect to your network.",
            "waf": "Security",
            "guid": "ee1ac551-c4d5-46cf-b035-d0a3c50d87ad",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/bastion/bastion-overview"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "IP plan",
            "text": "Ensure no overlapping IP address spaces across Azure regions and on-premises locations are used",
            "waf": "Security",
            "guid": "558fd772-49b8-4211-82df-27ee412e7f98",
            "severity": "High",
            "training": "https://learn.microsoft.com/learn/paths/architect-network-infrastructure/",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-ip-addressing"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "IP plan",
            "text": "Use IP addresses from the address allocation ranges for private internets (RFC 1918).",
            "waf": "Security",
            "guid": "3f630472-2dd6-49c5-a5c2-622f54b69bad",
            "severity": "Low",
            "graph": "resources | where type == 'microsoft.network/virtualnetworks' | extend addressSpace = todynamic(properties.addressSpace) | extend addressPrefix = todynamic(properties.addressSpace.addressPrefixes) | mvexpand addressSpace | mvexpand addressPrefix | project name, id, location, resourceGroup, subscriptionId, cidr = addressPrefix | extend compliant = (cidr matches regex @'^(10\\\\.|172\\\\.(1[6-9]|2[0-9]|3[01])\\\\.|192\\\\.168\\\\.)')  | project id, compliant, cidr",
            "training": "https://learn.microsoft.com/learn/paths/architect-network-infrastructure/",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-ip-addressing"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "IP plan",
            "text": "Ensure that IP address space isn't wasted, don't create unnecessarily large virtual networks (for example /16) ",
            "waf": "Performance",
            "guid": "33aad5e8-c68e-41d7-9667-313b4f5664b5",
            "severity": "High",
            "graph": "resources | where type == 'microsoft.network/virtualnetworks' | extend addressSpace = todynamic(properties.addressSpace) | extend addressPrefix = todynamic(properties.addressSpace.addressPrefixes) | mvexpand addressSpace | mvexpand addressPrefix | extend addressMask = split(addressPrefix,'/')[1] | extend compliant = addressMask > 16 | project name, id, subscriptionId, resourceGroup, addressPrefix, compliant",
            "training": "https://learn.microsoft.com/learn/paths/architect-network-infrastructure/",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-ip-addressing"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "IP plan",
            "text": "Avoid using overlapping IP address ranges for production and DR sites.",
            "waf": "Reliability",
            "guid": "f348ef25-4c27-4d42-b8bb-ac7571559ab9",
            "severity": "High",
            "training": "https://learn.microsoft.com/learn/paths/az-104-manage-virtual-networks/",
            "link": "https://learn.microsoft.com/azure/site-recovery/concepts-on-premises-to-azure-networking#retain-ip-addresses"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "IP plan",
            "text": "For environments where name resolution in Azure is all that's required, use Azure Private DNS for resolution with a delegated zone for name resolution (such as 'azure.contoso.com').",
            "waf": "Operations",
            "guid": "153e8908-ae28-4c84-a33b-6b7808b9fe5c",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/paths/az-104-manage-virtual-networks/",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-networks-name-resolution-for-vms-and-role-instances"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "IP plan",
            "text": "For environments where name resolution across Azure and on-premises is required, consider using Azure DNS Private Resolver.",
            "waf": "Security",
            "guid": "41049d40-3a92-43c3-974d-00018ac6a9e0",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/training/modules/intro-to-azure-dns-private-resolver/",
            "link": "https://learn.microsoft.com/azure/dns/dns-private-resolver-overview"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "IP plan",
            "text": "Special workloads that require and deploy their own DNS (such as Red Hat OpenShift) should use their preferred DNS solution.",
            "waf": "Operations",
            "guid": "1e6a83de-5de3-42c1-a924-81607d5d1e4e",
            "severity": "Low",
            "link": "https://learn.microsoft.com/azure/virtual-network/virtual-networks-name-resolution-for-vms-and-role-instances"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "IP plan",
            "text": "Enable auto-registration for Azure DNS to automatically manage the lifecycle of the DNS records for the virtual machines deployed within a virtual network.",
            "waf": "Operations",
            "guid": "614658d3-558f-4d77-849b-821112df27ee",
            "severity": "High",
            "training": "https://learn.microsoft.com/learn/paths/az-104-manage-virtual-networks/",
            "link": "https://learn.microsoft.com/azure/dns/private-dns-autoregistration"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Internet",
            "text": "Use Azure Firewall to govern Azure outbound traffic to the internet, non-HTTP/S inbound connections, and East/West traffic filtering (if the organization requires it)",
            "waf": "Security",
            "guid": "e6c4cfd3-e504-4547-a244-7ec66138a720",
            "severity": "High",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "link": "https://learn.microsoft.com/azure/app-service/networking-features"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Internet",
            "text": "Create a global Azure Firewall policy to govern security posture across the global network environment and assign it to all Azure Firewall instances. Allow for granular policies to meet requirements of specific regions by delegating incremental firewall policies to local security teams via Azure role-based access control.",
            "waf": "Security",
            "guid": "5a4b1511-e43a-458a-ac22-99c4d7b57d0c",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "link": "https://learn.microsoft.com/azure/firewall/"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Internet",
            "text": "Configure supported partner SaaS security providers within Firewall Manager if the organization wants to use such solutions to help protect outbound connections.",
            "waf": "Security",
            "guid": "655562f2-b3e4-4563-a4d8-739748b662d6",
            "severity": "Low",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "link": "https://learn.microsoft.com/azure/firewall/"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Internet",
            "text": "Use Azure Front Door and WAF policies to provide global protection across Azure regions for inbound HTTP/S connections to a landing zone.",
            "waf": "Security",
            "guid": "1d7aa9b6-4704-4489-a804-2d88e79d17b7",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/afds-overview"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Internet",
            "text": "When using Azure Front Door and Azure Application Gateway to help protect HTTP/S apps, use WAF policies in Azure Front Door. Lock down Azure Application Gateway to receive traffic only from Azure Front Door.",
            "waf": "Security",
            "guid": "3b22a5a6-7e7a-48ed-9b30-e38c3f29812b",
            "severity": "Low",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Internet",
            "text": "Deploy WAFs and other reverse proxies are required for inbound HTTP/S connections, deploy them within a landing-zone virtual network and together with the apps that they're protecting and exposing to the internet.",
            "waf": "Security",
            "guid": "2363cefe-179b-4599-be0d-5973cd4cd21b",
            "severity": "High",
            "training": "https://learn.microsoft.com/learn/paths/architect-network-infrastructure/",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Internet",
            "text": "Use Azure DDoS Network or IP Protection plans to help protect Public IP Addresses endpoints within the virtual networks.",
            "waf": "Security",
            "guid": "088137f5-e6c4-4cfd-9e50-4547c2447ec6",
            "severity": "High",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "link": "https://learn.microsoft.com/azure/ddos-protection/ddos-protection-reference-architectures"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Internet",
            "text": "Use FQDN-based network rules and Azure Firewall with DNS proxy to filter egress traffic to the Internet not supported by application rules.",
            "waf": "Security",
            "guid": "14d99880-2f88-47e8-a134-62a7d85c94af",
            "severity": "High",
            "link": "https://learn.microsoft.com/azure/firewall/fqdn-filtering-network-rules",
            "graph": "resources | where type=='microsoft.network/firewallpolicies' | extend compliant = (properties.dnsSettings.enableProxy == true) | distinct id,compliant"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Internet",
            "text": "Use Azure Firewall Premium for additional security and protection.",
            "waf": "Security",
            "guid": "c10d51ef-f999-455d-bba0-5c90ece07447",
            "severity": "High",
            "link": "https://learn.microsoft.com/azure/firewall/premium-features",
            "graph": "resources | where type=='microsoft.network/firewallpolicies' | extend compliant = (properties.sku.tier == 'Premium') | distinct id,compliant"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Internet",
            "text": "Configure Azure Firewall Threat Intelligence mode to Alert and Deny for additional protection.",
            "waf": "Security",
            "guid": "e9c8f584-6d5e-473b-8dc5-acc9fbaab4e3",
            "severity": "High",
            "link": "https://learn.microsoft.com/azure/firewall/premium-features",
            "graph": "resources | where type=='microsoft.network/firewallpolicies' | extend compliant = (properties.threatIntelMode == 'Deny') | distinct id,compliant"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Internet",
            "text": "Configure Azure Firewall IDPS mode to Deny for additional protection.",
            "waf": "Security",
            "guid": "b9d0dff5-bdd4-4cd8-88ed-5811610b2b2c",
            "severity": "High",
            "link": "https://learn.microsoft.com/azure/firewall/premium-features#idps",
            "graph": "resources | where type=='microsoft.network/firewallpolicies' | extend compliant = (properties.intrusionDetection.mode == 'Deny') | project id, compliant"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "PaaS",
            "text": "Ensure that control-plane communication for Azure PaaS services injected into a virtual network is not broken, for example with a 0.0.0.0/0 route or an NSG rule that blocks control plane traffic.",
            "waf": "Security",
            "guid": "d301d6e8-72e5-42e3-911c-c58b5a4b1511",
            "severity": "High",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/?source=learn",
            "link": "https://learn.microsoft.com/azure/virtual-network/vnet-integration-for-azure-services"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "PaaS",
            "text": "Use Private Link, where available, for shared Azure PaaS services.",
            "waf": "Security",
            "guid": "e43a58a9-c229-49c4-b7b5-7d0c655562f2",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/paths/secure-application-delivery/",
            "link": "https://learn.microsoft.com/azure/app-service/networking-features"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "PaaS",
            "text": "Access Azure PaaS services from on-premises via private endpoints and ExpressRoute private peering. This method avoids transiting over the public internet.",
            "waf": "Security",
            "guid": "b3e4563a-4d87-4397-98b6-62d6d15f512a",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/",
            "link": "https://learn.microsoft.com/azure/app-service/networking-features"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "PaaS",
            "text": "Don't enable virtual network service endpoints by default on all subnets.",
            "waf": "Security",
            "guid": "4704489a-8042-4d88-b79d-17b73b22a5a6",
            "severity": "Medium",
            "graph": "resources | where type =~ 'microsoft.network/virtualnetworks' | project id,resourceGroup,name,subnets = properties.subnets | mv-expand subnets | project id = subnets.id, resourceGroup, VNet = name, serviceEndpoints = subnets.properties.serviceEndpoints, compliant = (isnull(subnets.properties.serviceEndpoints) or array_length(subnets.properties.serviceEndpoints) == 0) | order by compliant asc",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/?source=learn",
            "link": "https://learn.microsoft.com/azure/app-service/networking-features"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "PaaS",
            "text": "If using virtual network service endpoints, filter egress FQDNs on an NVA to prevent data exfiltration.",
            "waf": "Security",
            "guid": "7e7a8ed4-b30e-438c-9f29-812b2363cefe",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/?source=learn",
            "link": "https://learn.microsoft.com/azure/app-service/networking-features"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Segmentation",
            "text": "Don't rely on the NSG inbound default rules using the VirtualNetwork service tag to limit connectivity.",
            "waf": "Security",
            "guid": "11deb39d-8299-4e47-bbe0-0fb5a36318a8",
            "severity": "Medium",
            "graph": "resources | where type=='microsoft.network/networksecuritygroups' | mvexpand properties.securityRules | project id,name,ruleAction=properties_securityRules.properties.access,rulePriority=properties_securityRules.properties.priority,ruleDst=properties_securityRules.properties.destinationAddressPrefix,ruleSrc=properties_securityRules.properties.sourceAddressPrefix,ruleProt=properties_securityRules.properties.protocol,ruleDirection=properties_securityRules.properties.direction,rulePort=properties_securityRules.properties.destinationPortRange | summarize StarDenies=countif(ruleAction=='Deny' and ruleDst=='*' and ruleSrc=='*' and ruleProt=='*' and rulePort=='*') by id,tostring(ruleDirection) | where ruleDirection == 'Inbound' | project id,compliant=(StarDenies>0) | union (resources | where type=='microsoft.network/networksecuritygroups' | where array_length(properties.securityRules)==0 | extend compliant=false | project id,compliant)",
            "link": "https://learn.microsoft.com/azure/virtual-network/service-tags-overview#available-service-tags"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Segmentation",
            "text": "Delegate subnet creation to the landing zone owner. ",
            "waf": "Security",
            "guid": "c2447ec6-6138-4a72-80f1-ce16ed301d6e",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/paths/implement-resource-mgmt-security/",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-landing-zone-network-segmentation"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Segmentation",
            "text": "Use NSGs to help protect traffic across subnets, as well as east/west traffic across the platform (traffic between landing zones).",
            "waf": "Security",
            "guid": "872e52e3-611c-4c58-a5a4-b1511e43a58a",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/ag/ag-overview"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Segmentation",
            "text": "The application team should use application security groups at the subnet-level NSGs to help protect multi-tier VMs within the landing zone.",
            "waf": "Security",
            "guid": "9c2299c4-d7b5-47d0-a655-562f2b3e4563",
            "severity": "Medium",
            "graph": "Resources | where type=='microsoft.network/virtualnetworks' | project id,resourceGroup,name,subnets=properties.subnets | mv-expand subnets | project id,name,subnetName=subnets.name,subnetNsg=subnets.properties.networkSecurityGroup | where not (subnetName in ('GatewaySubnet', 'AzureFirewallSubnet', 'RouteServerSubnet', 'AzureBastionSubnet')) | extend compliant = isnotnull(subnetNsg)",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Segmentation",
            "text": "Use NSGs and application security groups to micro-segment traffic within the landing zone and avoid using a central NVA to filter traffic flows.",
            "waf": "Security",
            "guid": "a4d87397-48b6-462d-9d15-f512a65498f6",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/paths/implement-network-security/",
            "link": "https://learn.microsoft.com/azure/virtual-network/network-security-group-how-it-works"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Segmentation",
            "text": "Enable NSG flow logs and feed them into Traffic Analytics to gain insights into internal and external traffic flows.",
            "waf": "Security",
            "guid": "dfe237de-143b-416c-91d7-aa9b64704489",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/modules/design-implement-network-monitoring/",
            "link": "https://learn.microsoft.com/azure/virtual-network/network-security-group-how-it-works"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Virtual WAN",
            "text": "Consider Virtual WAN for simplified Azure networking management, and make sure your scenario is explicitly described in the list of Virtual WAN routing designs",
            "waf": "Operations",
            "guid": "412e7f98-3f63-4047-82dd-69c5b5c2622f",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/modules/introduction-azure-virtual-wan/",
            "link": "https://learn.microsoft.com/azure/virtual-wan/scenario-any-to-any"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Virtual WAN",
            "text": "Use a Virtual WAN hub per Azure region to connect multiple landing zones together across Azure regions via a common global Azure Virtual WAN.",
            "waf": "Performance",
            "guid": "54b69bad-33aa-4d5e-ac68-e1d76667313b",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/virtual-wan/virtual-wan-about"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Virtual WAN",
            "text": "Connect Virtual WAN hubs to on-premises datacenters by using ExpressRoute",
            "waf": "Performance",
            "guid": "65a917e1-f348-4ef2-94c2-7d42e8bbac75",
            "severity": "Low",
            "training": "https://learn.microsoft.com/learn/modules/configure-expressroute-virtual-wan/",
            "link": "https://learn.microsoft.com/azure/virtual-wan/virtual-wan-about"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Virtual WAN",
            "text": "Follow the principle 'traffic in Azure stays in Azure' so that communication across resources in Azure occurs via the Microsoft backbone network",
            "waf": "Performance",
            "guid": "8ac6a9e0-1e6a-483d-b5de-32c199248160",
            "severity": "Low",
            "link": "https://learn.microsoft.com/azure/virtual-wan/virtual-wan-about"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Virtual WAN",
            "text": "For outbound Internet traffic protection and filtering, deploy Azure Firewall",
            "waf": "Security",
            "guid": "7d5d1e4e-6146-458d-9558-fd77249b8211",
            "severity": "Medium",
            "training": "https://learn.microsoft.com/learn/paths/secure-networking-infrastructure/",
            "link": "https://learn.microsoft.com/azure/virtual-wan/virtual-wan-about"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Virtual WAN",
            "text": "When deploying partner networking technologies and NVAs in VWAN, verify configuration with partner vendor's guidance to ensure there are no conflicting configurations",
            "waf": "Reliability",
            "guid": "12df27ee-412e-47f9-a3f6-304722dd69c5",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/virtual-wan/virtual-wan-about"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Virtual WAN",
            "text": "Ensure that the network architecture is within the Azure Virtual WAN limits.",
            "waf": "Reliability",
            "guid": "6667313b-4f56-464b-9e98-4a859c773e7d",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits"
        },
        {
            "category": "Network Topology and Connectivity",
            "subcategory": "Virtual WAN",
            "text": "Use Azure Monitor Insights for Virtual WAN to monitor the end-to-end topology of the Virtual WAN, status, and key metrics.",
            "waf": "Operations",
            "guid": "261623a7-65a9-417e-8f34-8ef254c27d42",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/virtual-wan/azure-monitor-insights"
        },
        {
            "category": "Network Topology and Connectivity ",
            "subcategory": "Hybrid",
            "text": "If you are deploying at least two VMs running AD DS as domain controllers, add them to different Availability Zones. If not available in the region, deploy in an Availability Set.",
            "waf": "Reliability",
            "guid": "2df4930f-6a43-49a3-926b-309f02c302f0",
            "severity": "High",
            "link": "https://learn.microsoft.com/azure/architecture/reference-architectures/identity/adds-extend-domain#vm-recommendations"
        },
        {
            "category": "Operations",
            "subcategory": "App delivery",
            "text": "Use managed TLS certificates with Azure Front Door. Reduce operational cost and risk of outages due to certificate renewals.",
            "waf": "Operations",
            "guid": "af95c92d-d723-4f4a-98d7-8722324efd4d",
            "severity": "High",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-managed-tls-certificates"
        },
        {
            "category": "Operations",
            "subcategory": "App delivery",
            "text": "Define your Azure Front Door WAF configuration as code. By using code, you can more easily adopt new ruleset versions and gain additional protection.",
            "waf": "Operations",
            "guid": "189ea962-3969-4863-8f5a-5ad808c2cf4b",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#define-your-waf-configuration-as-code"
        },
        {
            "category": "Security, Governance and Compliance",
            "subcategory": "App delivery",
            "text": "Use end-to-end TLS with Azure Front Door. Use TLS for connections from your clients to Front Door, and from Front Door to your origin.",
            "waf": "Security",
            "guid": "2e30abab-5478-417c-81bf-bf1ad4ed1ed4",
            "severity": "High",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-end-to-end-tls"
        },
        {
            "category": "Security, Governance and Compliance",
            "subcategory": "App delivery",
            "text": "Use HTTP to HTTPS redirection with Azure Front Door. Support older clients by redirecting them to an HTTPS request automatically.",
            "waf": "Security",
            "guid": "10aa45af-166f-44c4-9f36-b6d592dac2ca",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#use-http-to-https-redirection"
        },
        {
            "category": "Security, Governance and Compliance",
            "subcategory": "App delivery",
            "text": "Enable the Azure Front Door WAF. Protect your application from a range of attacks.",
            "waf": "Security",
            "guid": "28b9ee82-b2c7-45aa-bc98-6de6f59a095d",
            "severity": "High",
            "link": "https://learn.microsoft.com/azure/frontdoor/best-practices#enable-the-waf"
        },
        {
            "category": "Security, Governance and Compliance",
            "subcategory": "App delivery",
            "text": "Tune the Azure Front Door WAF for your workload. Reduce false positive detections.",
            "waf": "Security",
            "guid": "2902d8cc-1b0c-4495-afad-624ab70f7bd6",
            "severity": "High",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#tune-your-waf"
        },
        {
            "category": "Security, Governance and Compliance",
            "subcategory": "App delivery",
            "text": "Use prevention mode with the Azure Front Door WAF. Prevention mode ensures that the WAF blocks malicious requests.",
            "waf": "Security",
            "guid": "17ba124b-127d-42b6-9322-388d5b2bbcfc",
            "severity": "High",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#use-prevention-mode"
        },
        {
            "category": "Security, Governance and Compliance",
            "subcategory": "App delivery",
            "text": "Enable the Azure Front Door WAF default rule sets. The default rule sets detect and block common attacks.",
            "waf": "Security",
            "guid": "49a98f2b-ec22-4a87-9415-6a10b00d6555",
            "severity": "High",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#enable-default-rule-sets"
        },
        {
            "category": "Security, Governance and Compliance",
            "subcategory": "App delivery",
            "text": "Enable the Azure Front Door WAF bot management rules. The bot rules detect good and bad bots.",
            "waf": "Security",
            "guid": "147a13d4-2a2f-4824-a524-f5855b52b946",
            "severity": "High",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#enable-bot-management-rules"
        },
        {
            "category": "Security, Governance and Compliance",
            "subcategory": "App delivery",
            "text": "Use the latest Azure Front Door WAF ruleset versions. Ruleset updates are regularly updated to take account of the current threat landscape.",
            "waf": "Security",
            "guid": "d7dcdcb9-0d99-44b9-baab-ac7570ede79a",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#use-the-latest-ruleset-versions"
        },
        {
            "category": "Security, Governance and Compliance",
            "subcategory": "App delivery",
            "text": "Add rate limiting to the Azure Front Door WAF. Rate limiting blocks clients accidentally or intentionally sending large amounts of traffic in a short period of time.",
            "waf": "Security",
            "guid": "b9620385-1cde-418f-914b-a84a06982ffc",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#add-rate-limiting"
        },
        {
            "category": "Security, Governance and Compliance",
            "subcategory": "App delivery",
            "text": "Use a high threshold for Azure Front Door WAF rate limits. High rate limit thresholds avoid blocking legitimate traffic, while still providing protection against extremely high numbers of requests that might overwhelm your infrastructure. ",
            "waf": "Security",
            "guid": "6dc36c52-0124-4ffe-9eaf-23ec1282dedb",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#use-a-high-threshold-for-rate-limits"
        },
        {
            "category": "Security, Governance and Compliance",
            "subcategory": "App delivery",
            "text": "Geo-filter traffic by using the Azure Front Door WAF. Allow traffic only from expected regions, and block traffic from other regions.",
            "waf": "Security",
            "guid": "388a3d0e-0a43-4367-90b2-3dd2aeece5ee",
            "severity": "Low",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#geo-filter-traffic"
        },
        {
            "category": "Security, Governance and Compliance",
            "subcategory": "App delivery",
            "text": "Specify the unknown (ZZ) location when geo-filtering traffic with the Azure Front Door WAF. Avoid accidentally blocking legitimate requests when IP addresses can't be geo-matched.",
            "waf": "Security",
            "guid": "00acd8a9-6975-414f-8491-2be6309893b8",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/web-application-firewall/afds/waf-front-door-best-practices#specify-the-unknown-zz-location"
        },
        {
            "category": "Security, Governance and Compliance",
            "subcategory": "Governance",
            "text": "Leverage Azure Policy",
            "waf": "Security",
            "guid": "5c986cb2-9131-456a-8247-6e49f541acdc",
            "severity": "High",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview"
        },
        {
            "category": "Security, Governance and Compliance",
            "subcategory": "Governance",
            "text": "Identify required Azure tags and use the append policy mode to enforce usage.",
            "waf": "Security",
            "guid": "e979377b-cdb3-4751-ab2a-b13ada6e55d7",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/naming-and-tagging"
        },
        {
            "category": "Security, Governance and Compliance",
            "subcategory": "Governance",
            "text": "Map regulatory and compliance requirements to Azure Policy definitions and Azure role assignments.",
            "waf": "Security",
            "guid": "d8a2adb1-17d6-4326-af62-5ca44e5695f2",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview"
        },
        {
            "category": "Security, Governance and Compliance",
            "subcategory": "Governance",
            "text": "Establish Azure Policy definitions at the top-level root management group so that they can be assigned at inherited scopes",
            "waf": "Security",
            "guid": "223ace8c-b123-408c-a501-7f154e3ab369",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview"
        },
        {
            "category": "Security, Governance and Compliance",
            "subcategory": "Governance",
            "text": "Manage policy assignments at the highest appropriate level with exclusions at bottom levels, if required",
            "waf": "Security",
            "guid": "3829e7e3-1618-4368-9a04-77a209945bda",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview"
        },
        {
            "category": "Security, Governance and Compliance",
            "subcategory": "Governance",
            "text": "Use Azure Policy to control which services users can provision at the subscription/management group level",
            "waf": "Security",
            "guid": "43334f24-9116-4341-a2ba-527526944008",
            "severity": "Low",
            "link": "https://learn.microsoft.com/security/benchmark/azure/mcsb-asset-management#am-2-use-only-approved-services"
        },
        {
            "category": "Security, Governance and Compliance",
            "subcategory": "Governance",
            "text": "Use built-in policies where possible to minimize operational overhead.",
            "waf": "Security",
            "guid": "be7d7e48-4327-46d8-adc0-55bcf619e8a1",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview"
        },
        {
            "category": "Security, Governance and Compliance",
            "subcategory": "Governance",
            "text": "Assign the built-in Resource Policy Contributor role at a particular scope to enable application-level governance.",
            "description": "Assigning the Resource Policy Contributor role to specific scopes allows you to delegate policy management to relevant teams. For instance, a central IT team may oversee management group-level policies, while application teams handle policies for their subscriptions, enabling distributed governance with adherence to organizational standards.",
            "waf": "Security",
            "guid": "3f988795-25d6-4268-a6d7-0ba6c97be995",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview#azure-rbac-permissions-in-azure-policy"
        },
        {
            "category": "Security, Governance and Compliance",
            "subcategory": "Governance",
            "text": "Limit the number of Azure Policy assignments made at the root management group scope to avoid managing through exclusions at inherited scopes.",
            "waf": "Security",
            "guid": "19048384-5c98-46cb-8913-156a12476e49",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/governance/policy/overview"
        },
        {
            "category": "Security, Governance and Compliance",
            "subcategory": "Governance",
            "text": "Use Azure policies to automatically deploy software configurations through VM extensions and enforce a compliant baseline VM configuration.",
            "waf": "Security",
            "guid": "f541acdc-e979-4377-acdb-3751ab2ab13a",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/governance/policy/concepts/guest-configuration"
        },
        {
            "category": "Security, Governance and Compliance",
            "subcategory": "Governance",
            "text": "Consider using automation tags to start/stop VM's in your environment to save on cost.",
            "waf": "Security",
            "guid": "9b5e2a28-9823-4faf-ab7e-afa5f6c57221",
            "severity": "Medium",
            "link": "Configure Azure Automation Start/Stop VMs during off-hours | Microsoft Learn"
        },
        {
            "category": "Security, Governance and Compliance",
            "subcategory": "Governance",
            "text": "Monitor VM security configuration drift via Azure Policy.",
            "description": "Azure Policy's guest configuration features can audit and remediate machine settings (e.g., OS, application, environment) to ensure resources align with expected configurations, and Update Management can enforce patch management for VMs.",
            "waf": "Security",
            "guid": "da6e55d7-d8a2-4adb-817d-6326af625ca4",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/management-operational-compliance#monitoring-for-configuration-drift"
        },
        {
            "category": "Security, Governance and Compliance",
            "subcategory": "Secrets",
            "text": "Use Azure Key Vault to store your secrets and credentials",
            "waf": "Security",
            "guid": "5017f154-e3ab-4369-9829-e7e316183687",
            "severity": "High",
            "link": "https://learn.microsoft.com/azure/key-vault/general/overview"
        },
        {
            "category": "Security, Governance and Compliance",
            "subcategory": "Secrets",
            "text": "Use different Azure Key Vaults for different applications and regions to avoid transaction scale limits and restrict access to secrets.",
            "waf": "Security",
            "guid": "a0477a20-9945-4bda-9333-4f2491163418",
            "severity": "Medium",
            "graph": "ResourceContainers | where type=='microsoft.resources/subscriptions'| parse id with '/subscriptions/' SubscriptionID| project subscriptionId, SubscriptionName = name| join kind=leftouter (Resources| where type == 'microsoft.keyvault/vaults'| project id, name, subscriptionId) on subscriptionId| join kind= leftouter (Resources| where type == 'microsoft.keyvault/vaults'| summarize ResourceCount = count() by subscriptionId) on subscriptionId| extend RCount = iff(isnull(ResourceCount), 0, ResourceCount)| project-away ResourceCount| extend compliant = (RCount <> 1)",
            "link": "https://learn.microsoft.com/azure/key-vault/general/overview-throttling"
        },
        {
            "category": "Security, Governance and Compliance",
            "subcategory": "Secrets",
            "text": "Provision Azure Key Vault with the soft delete and purge policies enabled to allow retention protection for deleted objects.",
            "waf": "Security",
            "guid": "2ba52752-6944-4008-ae7d-7e4843276d8b",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices"
        },
        {
            "category": "Security, Governance and Compliance",
            "subcategory": "Secrets",
            "text": "Follow a least privilege model by limiting authorization to permanently delete keys, secrets, and certificates to specialized custom Azure Active Directory (Azure AD) roles.",
            "waf": "Security",
            "guid": "dc055bcf-619e-48a1-9f98-879525d62688",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices"
        },
        {
            "category": "Security, Governance and Compliance",
            "subcategory": "Secrets",
            "text": "Automate the certificate management and renewal process with public certificate authorities to ease administration.",
            "waf": "Security",
            "guid": "6d70ba6c-97be-4995-8904-83845c986cb2",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices"
        },
        {
            "category": "Security, Governance and Compliance",
            "subcategory": "Secrets",
            "text": "Establish an automated process for key and certificate rotation.",
            "waf": "Security",
            "guid": "913156a1-2476-4e49-b541-acdce979377b",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices"
        },
        {
            "category": "Security, Governance and Compliance",
            "subcategory": "Secrets",
            "text": "Enable firewall and virtual network service endpoint or private endpoint on the vault to control access to the key vault.",
            "waf": "Security",
            "guid": "cdb3751a-b2ab-413a-ba6e-55d7d8a2adb1",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices"
        },
        {
            "category": "Security, Governance and Compliance",
            "subcategory": "Secrets",
            "text": "Use the platform-central Azure Monitor Log Analytics workspace to audit key, certificate, and secret usage within each instance of Key Vault.",
            "waf": "Security",
            "guid": "17d6326a-f625-4ca4-9e56-95f2223ace8c",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/key-vault/general/monitor-key-vault"
        },
        {
            "category": "Security, Governance and Compliance",
            "subcategory": "Secrets",
            "text": "Delegate Key Vault instantiation and privileged access and use Azure Policy to enforce a consistent compliant configuration.",
            "waf": "Security",
            "guid": "b12308ca-5017-4f15-9e3a-b3693829e7e3",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices"
        },
        {
            "category": "Security, Governance and Compliance",
            "subcategory": "Secrets",
            "text": "Default to Microsoft-managed keys for principal encryption functionality and use customer-managed keys when required.",
            "waf": "Security",
            "guid": "16183687-a047-47a2-8994-5bda43334f24",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/security/fundamentals/encryption-atrest"
        },
        {
            "category": "Security, Governance and Compliance",
            "subcategory": "Secrets",
            "text": "Use an Azure Key Vault per application per environment per region.",
            "waf": "Security",
            "guid": "91163418-2ba5-4275-8694-4008be7d7e48",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices"
        },
        {
            "category": "Security, Governance and Compliance",
            "subcategory": "Secrets",
            "text": "If you want to bring your own keys, this might not be supported across all considered services. Implement relevant mitigation so that inconsistencies don't hinder desired outcomes. Choose appropriate region pairs and disaster recovery regions that minimize latency.",
            "waf": "Security",
            "guid": "25d62688-6d70-4ba6-a97b-e99519048384",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/key-vault/general/best-practices"
        },
        {
            "category": "Security, Governance and Compliance",
            "subcategory": "Security",
            "text": "Use Azure AD reporting capabilities to generate access control audit reports.",
            "waf": "Security",
            "guid": "4e5695f2-223a-4ce8-ab12-308ca5017f15",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/active-directory/reports-monitoring/overview-reports"
        },
        {
            "category": "Security, Governance and Compliance",
            "subcategory": "Security",
            "text": "Export Azure activity logs to Azure Monitor Logs for long-term data retention. Export to Azure Storage for long-term storage beyond two years, if necessary.",
            "waf": "Security",
            "guid": "4e3ab369-3829-4e7e-9161-83687a0477a2",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/logs-data-export?tabs=portal"
        },
        {
            "category": "Security, Governance and Compliance",
            "subcategory": "Security",
            "text": "Enable Defender for Cloud Standard for all subscriptions.",
            "waf": "Security",
            "guid": "09945bda-4333-44f2-9911-634182ba5275",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/security-center/"
        },
        {
            "category": "Security, Governance and Compliance",
            "subcategory": "Security",
            "text": "Monitor base operating system patching drift via Azure Monitor Logs and Defender for Cloud.",
            "waf": "Security",
            "guid": "15833ee7-ad6c-46d3-9331-65c7acbe44ab",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/security-center/"
        },
        {
            "category": "Security, Governance and Compliance",
            "subcategory": "Security",
            "text": "Connect default resource configurations to a centralized Azure Monitor Log Analytics workspace.",
            "waf": "Security",
            "guid": "e5f8d79f-2e87-4768-924c-516775c6ea95",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/azure-monitor/logs/design-logs-deployment"
        },
        {
            "category": "Security, Governance and Compliance",
            "subcategory": "Security",
            "text": "Determine the incident response plan for Azure services before allowing it into production.",
            "waf": "Security",
            "guid": "b86ad884-08e3-4727-94b8-75ba18f20459",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/security/benchmark/azure/security-control-incident-response"
        },
        {
            "category": "Security, Governance and Compliance",
            "subcategory": "Security",
            "text": "Implement a zero-trust approach for access to the Azure platform, where appropriate.",
            "waf": "Security",
            "guid": "01365d38-e43f-49cc-ad86-8266abca264f",
            "severity": "Medium",
            "link": "https://www.microsoft.com/security/business/zero-trust"
        },
        {
            "category": "Security, Governance and Compliance",
            "subcategory": "Security",
            "text": "Plan how new azure services will be implemented",
            "waf": "Security",
            "guid": "9a19bf39-c95d-444c-9c89-19ca1f6d5215",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/service-enablement-framework"
        },
        {
            "category": "Security, Governance and Compliance",
            "subcategory": "Security",
            "text": "Plan how service request will be fulfilled for Azure services",
            "waf": "Security",
            "guid": "ae514b93-3d45-485e-8112-9bd7ba012f7b",
            "severity": "Medium",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/landing-zone/design-area/service-enablement-framework"
        },
        {
            "category": "Security, Governance and Compliance ",
            "subcategory": "Governance",
            "text": "It is recommended to follow Microsoft Best Practice Naming Standards",
            "waf": "Security",
            "guid": "cacf55bc-e4e4-46be-96bc-57a5f23a269a",
            "severity": "High",
            "link": "https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/resource-naming"
        },
        {
            "category": "Security, Governance and Compliance ",
            "subcategory": "Security",
            "text": "Secure transfer to storage accounts should be enabled",
            "waf": "Security",
            "guid": "b03ed428-4617-4067-a787-85468b9ccf3f",
            "severity": "High",
            "graph": "Resources | where type =~ 'Microsoft.Storage/storageAccounts' | project Subscription = subscriptionId, Name = name, SecureTransferEnabled = properties.supportsHttpsTrafficOnly | extend compliant = iff(SecureTransferEnabled == true, 1, 0)",
            "link": "https://learn.microsoft.com/azure/storage/common/storage-require-secure-transfer"
        },
        {
            "category": "Security, Governance and Compliance ",
            "subcategory": "Security",
            "text": "Enable container soft delete for the storage account to recover a deleted container and its contents.",
            "waf": "Security",
            "guid": "159aac9f-863f-4f48-82cf-00c28fa97a0e",
            "severity": "High",
            "graph": "Resources | where type =~ 'Microsoft.Storage/storageAccounts' | project Subscription = subscriptionId, Name = name, SoftDeleteEnabled = properties.deleteRetentionPolicy.enabled | extend compliant = iff(SoftDeleteEnabled == true, 1, 0)",
            "link": "https://learn.microsoft.com/azure/storage/blobs/data-protection-overview#recommendations-for-basic-data-protection"
        }
    ],
    "categories": [
        {
            "name": "Identity and Access"
        },
        {
            "name": "Network Topology and Connectivity"
        },
        {
            "name": "Security, Governance and Compliance"
        },
        {
            "name": "Management and Monitoring"
        },
        {
            "name": "Management Group and Subscriptions"
        },
        {
            "name": "Operations"
        },
        {
            "name": "Backup and Disaster Recovery"
        }
    ],
    "waf": [
        {
            "name": "Reliability"
        },
        {
            "name": "Security"
        },
        {
            "name": "Cost"
        },
        {
            "name": "Operations"
        },
        {
            "name": "Performance"
        }
    ],
    "status": [
        {
            "name": "Not verified",
            "description": "This check has not been looked at yet"
        },
        {
            "name": "Open",
            "description": "There is an action item associated to this check"
        },
        {
            "name": "Fulfilled",
            "description": "This check has been verified, and there are no further action items associated to it"
        },
        {
            "name": "Not required",
            "description": "Recommendation understood, but not needed by current requirements"
        },
        {
            "name": "N/A",
            "description": "Not applicable for current design"
        }
    ],
    "severities": [
        {
            "name": "High"
        },
        {
            "name": "Medium"
        },
        {
            "name": "Low"
        }
    ],
    "metadata": {
        "name": "Azure Landing Zone Review",
        "state": "GA",
        "timestamp": "April 19, 2023"
    }
}
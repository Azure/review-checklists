description: 'Availability sets will soon be retired. Migrate workloads from VMs to
  VMSS Flex for deployment across zones or within the same zone across different fault
  domains (FDs) and update domains (UDs) for better reliability.

  '
guid: a8d25876-7951-b646-b4e8-880c9031596b
labels:
  area: High Availability
  source: azure-resources/Compute/virtualMachines/recommendations.yaml
  sourceType: aprl
links: []
queries:
- arg: '// Azure Resource Graph Query

    // Find all VMs using Availability Sets

    resources

    | where type =~ ''Microsoft.Compute/virtualMachines''

    | where isnotnull(properties.availabilitySet)

    | project recommendationId = "a8d25876-7951-b646-b4e8-880c9031596b", name, id,
    tags, param1=strcat("availabilitySet: ",properties.availabilitySet.id)


    '
resourceTypes:
- Microsoft.Compute/virtualMachines
service: VM
severity: 0
text: Migrate VMs using availability sets to VMSS Flex

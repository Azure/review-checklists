description: 'IP forwarding allows a virtual machine network interface to receive
  and send network traffic not destined for or originating from its assigned IP addresses.

  '
guid: 41a22a5e-5e08-9647-92d0-2ffe9ef1bdad
labels:
  area: Security
  source: azure-resources/Compute/virtualMachines/recommendations.yaml
  sourceType: aprl
links: []
queries:
- arg: "// Azure Resource Graph Query\n// Find all VM NICs that have IPForwarding\
    \ enabled. This feature is usually only required for Network Virtual Appliances\n\
    Resources\n| where type =~ 'Microsoft.Compute/virtualMachines'\n| where isnotnull(properties.networkProfile.networkInterfaces)\n\
    | mv-expand nic=properties.networkProfile.networkInterfaces\n| project name, id,\
    \ tags, nicId = nic.id\n| extend nicId = tostring(nicId)\n| join kind=inner (\n\
    \    Resources\n    | where type =~ 'Microsoft.Network/networkInterfaces'\n  \
    \  | where properties.enableIPForwarding == true\n    | project nicId = tostring(id)\n\
    ) on nicId\n| project recommendationId = \"41a22a5e-5e08-9647-92d0-2ffe9ef1bdad\"\
    , name, id, tags\n| order by id asc\n\n"
resourceTypes:
- Microsoft.Compute/virtualMachines
service: VM
severity: 1
text: IP Forwarding should only be enabled for Network Virtual Appliances

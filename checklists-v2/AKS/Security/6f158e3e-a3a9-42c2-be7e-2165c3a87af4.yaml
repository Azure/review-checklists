guid: 6f158e3e-a3a9-42c2-be7e-2165c3a87af4
labels:
  area: Governance and Security
  author: jose
  subarea: Compliance
  test: 'yes'
links:
- https://learn.microsoft.com/azure/aks/use-system-pools
queries:
- arg: where type=='microsoft.containerservice/managedclusters' | project id,resourceGroup,name,pools=properties.agentPoolProfiles
    | project id,name,resourceGroup,poolcount=array_length(pools) | extend compliant
    = (poolcount > 1)
resourceTypes: []
service: AKS
severity: 1
text: Separate applications from the control plane with user/system node pools
waf: Security

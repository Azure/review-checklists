guid: c4581559-bb91-463e-a908-aed8c44ce3b2
labels:
  area: Network Topology and Connectivity
  id: 06.07.02
  subarea: Security
links:
- https://learn.microsoft.com/azure/aks/api-server-authorized-ip-ranges
queries:
  arg: where type=='microsoft.containerservice/managedclusters' | extend compliant
    = ((isnull(properties.apiServerAccessProfile.enablePrivateCluster) or properties.apiServerAccessProfile.enablePrivateCluster==false)
    and isnotnull(properties.apiServerAccessProfile.authorizedIPRanges)) | distinct
    id,compliant
resourceTypes: []
service: AKS
severity: 1
text: If using a public API endpoint, restrict the IP addresses that can access it
waf: Security

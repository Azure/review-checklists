description: 'Front Door terminates TCP and TLS connections from clients and establishes
  new connections from each PoP to the origin. Securing these connections with TLS,
  even for Azure-hosted origins, ensures data is always encrypted during transit.

  '
guid: d9bd6780-0d6f-cd4c-bc66-8ddcab12f3d1
labels:
  area: Security
  source: azure-resources/Cdn/profiles/recommendations.yaml
  sourceType: aprl
links: []
queries:
- arg: '// Azure Resource Graph Query

    // Use end-to-end TLS

    cdnresources

    | where type == "microsoft.cdn/profiles/afdendpoints/routes"

    | extend forwardingProtocol=tostring(properties.forwardingProtocol),supportedProtocols=properties.supportedProtocols

    | project id,name,forwardingProtocol,supportedProtocols,tags

    | where forwardingProtocol !~ "httpsonly" or supportedProtocols has "http"

    | project recommendationId= "d9bd6780-0d6f-cd4c-bc66-8ddcab12f3d1", name,id,tags,param1=strcat("forwardingProtocol:",forwardingProtocol),param2=strcat("supportedProtocols:",supportedProtocols)


    '
resourceTypes:
- Microsoft.Cdn/profiles
service: Front Door
severity: 0
text: Use end-to-end TLS

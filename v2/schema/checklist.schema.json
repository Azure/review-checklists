{
    "$schema": "https://json-schema.org/2020-12/schema#",
    "$id": "https://github.com/Azure/review-checklists/v2/checklist.schema.json",
    "title": "Checklist",
    "type": "object",
    "anyOf": [
        {"required": ["include"]},
        {"required": ["exclude"]},
        {"required": ["areas"]}
    ],
    "required": ["name"],
    "properties": {
        "name": {
            "type": "string",
            "description": "Human readable name for the checklist.",
            "minLength": 5,
            "maxLength": 50
        },
        "include": {
            "$ref": "#/definitions/selectorBlock"
        },
        "exclude": {
            "$ref": "#/definitions/selectorBlock"
        },
        "areas": {
            "type": "array",
            "description": "Areas included in the checklist.",
            "items": {
                "type": "object",
                "description": "Areas included in the checklist.",
                "anyOf": [
                    {"required": ["include"]},
                    {"required": ["exclude"]},
                    {"required": ["subareas"]}
                ],
                "properties": {
                    "include": {
                        "$ref": "#/definitions/selectorBlock"
                    },
                    "exclude": {
                        "$ref": "#/definitions/selectorBlock"
                    },
                    "subareas": {
                        "type": "array",
                        "description": "Subareas included in the checklist.",
                        "items": {
                            "type": "object",
                            "description": "Subareas included in the checklist.",
                            "anyOf": [
                                {"required": ["include"]},
                                {"required": ["exclude"]}
                            ],
                            "properties": {
                                "include": {
                                    "$ref": "#/definitions/selectorBlock"
                                },
                                "exclude": {
                                    "$ref": "#/definitions/selectorBlock"
                                }
                            }
                        }
                    }
                }
            }
        }
    },
    "definitions": {
        "selectorBlock": {
            "type": "object",
            "anyOf": [
                {"required": ["nameSelector"]},
                {"required": ["resourceTypeSelector"]},
                {"required": ["wafSelector"]},
                {"required": ["sourceSelector"]}
            ],
            "properties": {
                "nameSelector": {
                    "type": "array",
                    "description": "List of names that will be matched by the selector.",
                    "items": {
                        "type": "string",
                        "minLength": 5,
                        "maxLength": 100
                    }
                },
                "resourceTypeSelector": {
                    "type": "array",
                    "description": "List of resource types that will be matched by the selector.",
                    "items": {
                        "type": "string",
                        "minLength": 4,
                        "maxLength": 50
                    }
                },
                "wafSelector": {
                    "type": "array",
                    "description": "List of WAF pillars that will be matched by the selector.",
                    "items": {
                        "type": "string",
                        "enum": ["Security", "Performance", "Reliability", "Cost", "Operations"]
                    }
                },
                "sourceSelector": {
                    "type": "array",
                    "description": "List of reco sources that will be matched by the selector.",
                    "items": {
                        "type": "string",
                        "enum": ["revcl", "aprl", "wafsg"]
                    }
                }
            }
        }
    }
}
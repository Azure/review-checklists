name: revcl-AddressAllocationRangesIpAddresses
title: Use IP addresses from the address allocation ranges for private internets (RFC
  1918).
source:
  type: revcl
  file: ./checklists/alz_checklist.en.json
resourceTypes:
- Microsoft.Network/virtualNetworks
waf: Security
severity: 2
labels:
  guid: 3f630472-2dd6-49c5-a5c2-622f54b69bad
  area: Network Topology and Connectivity
  subarea: IP plan
  id: D03.02
links:
- type: docs
  url: https://learn.microsoft.com/azure/cloud-adoption-framework/ready/azure-best-practices/plan-for-ip-addressing
- type: docs
  url: https://learn.microsoft.com/learn/paths/architect-network-infrastructure/
queries:
  arg: resources | where type == 'microsoft.network/virtualnetworks' | extend addressSpace
    = todynamic(properties.addressSpace) | extend addressPrefix = todynamic(properties.addressSpace.addressPrefixes)
    | mvexpand addressSpace | mvexpand addressPrefix | project name, id, location,
    resourceGroup, subscriptionId, cidr = addressPrefix | extend compliant = (cidr
    matches regex @'^(10\\.|172\\.(1[6-9]|2[0-9]|3[01])\\.|192\\.168\\.)')  | project
    id, compliant, cidr

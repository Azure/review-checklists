name: revcl-RouteTableLimit
title: Consider the limit of routes per route table (400).
source:
  type: revcl
  file: ./checklists/alz_checklist.en.json
resourceTypes:
- Microsoft.Network/virtualNetworks
waf: Reliability
severity: 1
labels:
  guid: 3d457936-e9b7-41eb-bdff-314b26450b12
  area: Network Topology and Connectivity
  subarea: Hub and spoke
  id: D01.09
links:
- type: docs
  url: https://learn.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits?toc=/azure/virtual-network/toc.json#azure-resource-manager-virtual-networking-limits
queries:
  arg: resources | where type=='microsoft.network/routetables' | mvexpand properties.routes
    | summarize routeCount = count() by id | extend compliant = (routeCount < 360)
    | distinct id,compliant

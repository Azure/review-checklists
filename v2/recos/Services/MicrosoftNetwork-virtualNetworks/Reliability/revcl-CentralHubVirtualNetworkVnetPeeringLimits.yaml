name: revcl-CentralHubVirtualNetworkVnetPeeringLimits
title: When connecting spoke virtual networks to the central hub virtual network,
  consider VNet peering limits (500), the maximum number of prefixes that can be advertised
  via ExpressRoute (1000)
source:
  type: revcl
  file: ./checklists/waf_checklist.en.json
resourceTypes:
- microsoft.network/virtualnetworks
waf: Reliability
severity: 1
labels:
  guid: 0e7c28ec-9366-4572-83b0-f4664b1d944a
links:
- type: docs
  url: https://learn.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits?toc=/azure/virtual-network/toc.json#azure-resource-manager-virtual-networking-limits
queries:
  arg: resources | where type == 'microsoft.network/virtualnetworks' | mvexpand properties.virtualNetworkPeerings
    | summarize peeringcount = count() by id | extend compliant = (peeringcount <
    450) | distinct id,compliant

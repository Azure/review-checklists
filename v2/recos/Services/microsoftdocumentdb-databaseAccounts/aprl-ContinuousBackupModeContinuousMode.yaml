name: aprl-ContinuousBackupModeContinuousMode
title: Configure continuous backup mode
description: |-
  Cosmos DB's backup is always on, offering protection against data mishaps. Continuous mode allows for self-serve restoration to a pre-mishap point, unlike periodic mode which requires contacting Microsoft support, leading to longer restore times.
source:
  type: aprl
  file: azure-resources/DocumentDB/databaseAccounts/recommendations.yaml
  timestamp: July 24, 2024
resourceTypes:
- Microsoft.DocumentDB/databaseAccounts
severity: 0
labels:
  guid: e544520b-8505-7841-9e77-1f1974ee86ec
  area: Disaster Recovery
links: []
queries:
  arg: |-
    // Azure Resource Graph Query
    // Query all Azure Cosmos DB accounts that do not have continuous backup mode configured
    Resources
    | where type =~ 'Microsoft.DocumentDb/databaseAccounts'
    | where
        properties.backupPolicy.type == 'Periodic' and
        properties.enableMultipleWriteLocations == false and
        properties.enableAnalyticalStorage == false
    | project recommendationId='e544520b-8505-7841-9e77-1f1974ee86ec', name, id, tags

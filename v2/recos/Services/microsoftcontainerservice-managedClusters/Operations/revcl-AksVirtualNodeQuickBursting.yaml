name: revcl-AksVirtualNodeQuickBursting
title: Consider AKS virtual node for quick bursting
source:
  type: revcl
  file: ./checklists/waf_checklist.en.json
resourceTypes:
- microsoft.containerservice/managedClusters
waf: Operations
severity: 2
labels:
  guid: c755562f-2b4e-4456-9b4d-874a748b662e
links:
- type: docs
  url: https://learn.microsoft.com/azure/aks/concepts-scale
queries:
  arg: where type=='microsoft.containerservice/managedclusters' | extend compliant
    = (isnotnull(properties.addonProfiles.aciConnectorLinux) and properties.addonProfiles.aciConnectorLinux.enabled==true)
    | distinct id,compliant

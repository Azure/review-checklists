name: ManagedIntegration
title: Integrate authentication with AAD (using the managed integration)
source:
  type: revcl
  file: ./checklists/aks_checklist.en.json
resourceTypes:
- microsoft.containerservice/managedClusters
waf: Security
severity: 1
labels:
  guid: 7e42c78e-78c0-46a6-8a21-94956e698dc4
  area: Identity and Access Management
  subarea: Identity
  id: 05.01.02
links:
- https://learn.microsoft.com/azure/aks/managed-aad
queries:
  arg: where type=='microsoft.containerservice/managedclusters' | extend compliant
    = isnotnull(properties.aadProfile) | distinct id,compliant

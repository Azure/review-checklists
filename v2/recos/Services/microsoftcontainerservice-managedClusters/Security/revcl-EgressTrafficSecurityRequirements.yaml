name: revcl-EgressTrafficSecurityRequirements
title: Filter egress traffic with AzFW/NVA if your security requirements mandate it
source:
  type: revcl
  file: ./checklists/waf_checklist.en.json
resourceTypes:
- microsoft.containerservice/managedClusters
waf: Security
severity: 0
labels:
  guid: 3b365a91-7ecb-4e48-bbe5-4cd7df2e8bba
links:
- type: docs
  url: https://learn.microsoft.com/azure/aks/limit-egress-traffic
queries:
  arg: where type=='microsoft.containerservice/managedclusters' | extend compliant
    = (properties.networkProfile.outboundType=='userDefinedRouting') | distinct id,compliant

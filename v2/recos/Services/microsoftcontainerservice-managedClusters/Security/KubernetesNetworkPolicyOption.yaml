name: KubernetesNetworkPolicyOption
title: Enable a Kubernetes Network Policy option (Calico/Azure)
source:
  type: revcl
  file: ./checklists/aks_checklist.en.json
resourceTypes:
- microsoft.containerservice/managedClusters
waf: Security
severity: 0
labels:
  guid: 58d7c892-ddb1-407d-9769-ae669ca48e4a
  area: Network Topology and Connectivity
  subarea: Security
  id: 06.07.05
links:
- https://learn.microsoft.com/azure/aks/use-network-policies
queries:
  arg: where type=='microsoft.containerservice/managedclusters' | extend compliant
    = isnotnull(properties.networkProfile.networkPolicy) | distinct id,compliant

name: revcl-AksLocalAccounts
title: Disable AKS local accounts
source:
  type: revcl
  file: ./checklists/waf_checklist.en.json
resourceTypes:
- microsoft.containerservice/managedClusters
waf: Security
severity: 1
labels:
  guid: b085b1f2-3119-4771-8c9a-bbf4411810ec
links:
- type: docs
  url: https://learn.microsoft.com/azure/aks/managed-aad#disable-local-accounts
queries:
  arg: where type=='microsoft.containerservice/managedclusters' | extend compliant
    = (properties.disableLocalAccounts==true) | distinct id,compliant

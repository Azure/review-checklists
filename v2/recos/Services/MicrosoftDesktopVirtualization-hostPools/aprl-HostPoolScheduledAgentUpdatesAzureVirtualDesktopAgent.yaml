name: aprl-HostPoolScheduledAgentUpdatesAzureVirtualDesktopAgent
title: Configure host pool scheduled agent updates
description: |-
  Create maintenance schedules for AVD agent updates to avoid disruptions. Use Scheduled Agent Updates to set maintenance windows for updating Azure Virtual Desktop agent, side-by-side stack, and Geneva Monitoring agent.
source:
  type: aprl
  file: azure-resources/DesktopVirtualization/hostPools/recommendations.yaml
  timestamp: July 24, 2024
resourceTypes:
- Microsoft.DesktopVirtualization/hostPools
severity: 1
labels:
  guid: 979ff8be-5f3a-4d8e-9aa3-407ecdd6d6f7
  area: Governance
links: []
queries:
  arg: |-
    // Azure Resource Graph Query
    // This resource graph query will return all AVD host pools that does not have scheduled agent updates configured
    resources
    | where type =~ "Microsoft.DesktopVirtualization/hostpools"
    | where isnull(properties.agentUpdate)
    | project recommendationId = "979ff8be-5f3a-4d8e-9aa3-407ecdd6d6f7", name, id, tags, param1 = 'No scheduled agent updates'

name: aprl-EnterpriseSkuManagedDomain
title: Use at least the Enterprise SKU..
description: |-
  You need to use a minimum of Enterprise SKU for your managed domain to support replica sets.
source:
  type: aprl
  file: azure-resources/AAD/domainServices/recommendations.yaml
  timestamp: July 24, 2024
resourceTypes:
- Microsoft.AAD/domainServices
severity: 0
labels:
  guid: bb6deb9d-24fa-4ee8-bc23-ac3ebc7fdf8e
  area: High Availability
links: []
queries:
  arg: |-
    // Azure Resource Graph Query
    // Gets Entry Domain Services that are using the Standard SKU
    resources
    | where type == "microsoft.aad/domainservices"
    | extend sku = properties.sku
    | where sku =~ 'Standard'
    | project recommendationId='bb6deb9d-24fa-4ee8-bc23-ac3ebc7fdf8e', name=name, id=id, tags=tags, param1=strcat('SKU:', sku)

name: aprl-TrustedLaunchSupportedImagesLargeBootVolume
title: Consider creating TrustedLaunchSupported images where possible
description: |-
  We recommend creating Trusted Launch Supported Images for benefits like Secure Boot, vTPM, trusted launch VMs, large boot volume. These are Gen 2 Images by default and you cannot change a VM's generation after creation, so review the considerations first.
source:
  type: aprl
  file: azure-resources/Compute/galleries/recommendations.yaml
  timestamp: July 24, 2024
resourceTypes:
- Microsoft.Compute/galleries
severity: 2
labels:
  guid: 1c5e1e58-4e56-491c-8529-10f37af9d4ed
  area: High Availability
links: []
queries:
  arg: |
    // Azure Resource Graph Query
    // Query to list all images whose Hyper-V generation is not V2
    resources
    | where type =~ "microsoft.compute/galleries/images"
    | extend VMGeneration = properties.hyperVGeneration
    | where VMGeneration <> 'V2'
    | project RecommendationId="1c5e1e58-4e56-491c-8529-10f37af9d4ed",name,id,tags,param1=strcat("VMGeneration: ",VMGeneration)

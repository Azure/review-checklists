name: revcl-AzureFirewallThreatIntelligenceModeAdditionalProtection
title: Configure Azure Firewall Threat Intelligence mode to Alert and Deny for additional
  protection.
source:
  type: revcl
  file: ./checklists/alz_checklist.en.json
resourceTypes:
- Microsoft.Network/azureFirewalls
waf: Security
severity: 0
labels:
  guid: e9c8f584-6d5e-473b-8dc5-acc9fbaab4e3
  area: Network Topology and Connectivity
  subarea: Firewall
  id: D07.06
links:
- type: docs
  url: https://learn.microsoft.com/azure/firewall/premium-features
queries:
  arg: resources | where type=='microsoft.network/firewallpolicies' | extend compliant
    = (properties.threatIntelMode == 'Deny') | distinct id,compliant

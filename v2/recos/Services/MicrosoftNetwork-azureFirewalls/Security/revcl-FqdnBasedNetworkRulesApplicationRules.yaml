name: revcl-FqdnBasedNetworkRulesApplicationRules
title: Use FQDN-based network rules and Azure Firewall with DNS proxy to filter egress
  traffic to the Internet over protocols not supported by application rules.
source:
  type: revcl
  file: ./checklists/alz_checklist.en.json
resourceTypes:
- Microsoft.Network/azureFirewalls
waf: Security
severity: 0
labels:
  guid: 14d99880-2f88-47e8-a134-62a7d85c94af
  area: Network Topology and Connectivity
  subarea: Firewall
  id: D07.04
links:
- type: docs
  url: https://learn.microsoft.com/azure/firewall/fqdn-filtering-network-rules
queries:
  arg: resources | where type=='microsoft.network/firewallpolicies' | extend compliant
    = (properties.dnsSettings.enableProxy == true) | distinct id,compliant

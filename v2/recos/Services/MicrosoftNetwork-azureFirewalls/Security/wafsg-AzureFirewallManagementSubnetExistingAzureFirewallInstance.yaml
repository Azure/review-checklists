name: wafsg-AzureFirewallManagementSubnetExistingAzureFirewallInstance
title: If required to route all internet-bound traffic to a designated next hop instead
  of going directly to the internet, configure Azure Firewall in forced tunneling
  mode (does not apply to Azure Virtual WAN).
description: Azure Firewall must have direct internet connectivity. If your AzureFirewallSubnet
  learns a default route to your on-premises network via the Border Gateway Protocol,
  you must configure Azure Firewall in the forced tunneling mode. Using the forced
  tunneling feature, you'll need another /26 address space for the Azure Firewall
  Management subnet. You're required to name it AzureFirewallManagementSubnet.If this
  is an existing Azure Firewall instance that can't be reconfigured in the forced
  tunneling mode, create a UDR with a 0.0.0.0/0 route. Set the NextHopType value as
  Internet. Associate it with AzureFirewallSubnet to maintain internet connectivity.
source:
  type: wafsg
  file: ./checklists-ext/wafsg_checklist.en.json
resourceTypes:
- microsoft.network/azurefirewalls
waf: Security
severity: 1
labels:
  guid: 00be10aa-262b-44b5-a82a-8c68aad4cccd
links: []
queries: {}

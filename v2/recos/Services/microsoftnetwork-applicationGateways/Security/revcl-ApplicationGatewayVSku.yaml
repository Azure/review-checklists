name: revcl-ApplicationGatewayVSku
title: Ensure you are using Application Gateway v2 SKU
source:
  type: revcl
  file: ./checklists/waf_checklist.en.json
resourceTypes:
- microsoft.network/applicationGateways
waf: Security
severity: 1
labels:
  guid: 553585a6-abe0-11ed-afa1-0242ac120002
links:
- type: docs
  url: https://learn.microsoft.com/azure/application-gateway/overview-v2
- type: docs
  url: https://learn.microsoft.com/learn/paths/secure-application-delivery/
queries:
  arg: resources | where type == 'microsoft.network/applicationgateways' | project
    id, compliant = properties.sku.name in ('Standard_v2', 'WAF_v2') | project id,compliant

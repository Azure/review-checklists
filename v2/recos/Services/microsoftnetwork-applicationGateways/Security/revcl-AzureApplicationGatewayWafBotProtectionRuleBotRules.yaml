name: revcl-AzureApplicationGatewayWafBotProtectionRuleBotRules
title: Enable the Azure Application Gateway WAF bot protection rule set The bot rules
  detect good and bad bots.
source:
  type: revcl
  file: ./checklists/waf_checklist.en.json
resourceTypes:
- microsoft.network/applicationgateways
waf: Security
severity: 0
labels:
  guid: 2f8e81eb-8e68-4026-8b1f-70f9b05f7cf9
links:
- type: docs
  url: https://learn.microsoft.com/azure/web-application-firewall/ag/bot-protection
queries:
  arg: resources | where type == 'microsoft.network/applicationgatewaywebapplicationfirewallpolicies'
    | mv-expand properties.managedRules.managedRuleSets | project id, rulesettype
    = properties_managedRules_managedRuleSets.ruleSetType | extend compliant1 = (rulesettype
    == 'Microsoft_BotManagerRuleSet') | project id, compliant1 | summarize compliant
    = max(compliant1) by id

name: revcl-NsgRulesLimit
title: Consider the limit of NSG rules per NSG (1000).
source:
  type: revcl
  file: ./checklists/alz_checklist.en.json
resourceTypes:
- Microsoft.Network/networkSecurityGroups
waf: Reliability
severity: 1
labels:
  guid: 0390417d-53dc-44d9-b3f4-c8832f359b41
  area: Network Topology and Connectivity
  subarea: Segmentation
  id: D09.08
links:
- type: docs
  url: https://learn.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits
- type: docs
  url: https://learn.microsoft.com/azure/virtual-network/network-security-group-how-it-works
queries:
  arg: resources | where type == 'microsoft.network/networksecuritygroups' | project
    id, rules = array_length(properties.securityRules) | project id, compliant = (rules
    < 900)

name: aprl-AzureNetappFilesReplicationAzureNetappFilesVolumes
title: Enable Cross-region replication of Azure NetApp Files volumes
description: |-
  Azure NetApp Files replication offers data protection by allowing asynchronous cross-region volume replication for application failover in case of regional outages. Volumes can be replicated across regions, not concurrently with cross-zone replication. Note that failover is a manual process.
source:
  type: aprl
  file: azure-resources/NetApp/netAppAccounts/recommendations.yaml
  timestamp: July 24, 2024
resourceTypes:
- Microsoft.NetApp/netAppAccounts
severity: 0
labels:
  guid: e30317d2-c502-4dfe-a2d3-0a737cc79545
  area: Disaster Recovery
links: []
queries:
  arg: "// Azure Resource Graph Query\n// This Resource Graph query will return all\
    \ Azure NetApp Files volumes without cross-region replication.\nresources\n|\_\
    where\_type\_==\_\"microsoft.netapp/netappaccounts/capacitypools/volumes\"\n|\_\
    extend\_remoteVolumeRegion\_=\_properties.dataProtection.replication.remoteVolumeRegion\n\
    |\_extend\_volumeType\_=\_properties.volumeType\n|\_extend\_replicationType\_\
    =\_iff((remoteVolumeRegion\_==\_location),\_\"CZR\",\_iff((remoteVolumeRegion\_\
    ==\_\"\"),\"n/a\",\"CRR\"))\n| where replicationType != \"CRR\" and volumeType\
    \ != \"DataProtection\"\n| project recommendationId = \"e30317d2-c502-4dfe-a2d3-0a737cc79545\"\
    , name, id, tags\n"

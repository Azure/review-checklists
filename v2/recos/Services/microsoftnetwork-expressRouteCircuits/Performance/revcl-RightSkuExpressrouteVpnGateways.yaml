name: revcl-RightSkuExpressrouteVpnGateways
title: Ensure that you're using the right SKU for the ExpressRoute/VPN gateways based
  on bandwidth and performance requirements.
source:
  type: revcl
  file: ./checklists/alz_checklist.en.json
resourceTypes:
- microsoft.network/expressRouteCircuits
waf: Performance
severity: 1
labels:
  guid: d4cd21b0-8813-47f5-b6c4-cfd3e504547c
  area: Network Topology and Connectivity
  subarea: Hybrid
  id: D06.03
links:
- type: docs
  url: https://learn.microsoft.com/azure/expressroute/expressroute-routing
- type: docs
  url: https://learn.microsoft.com/learn/modules/design-implement-azure-expressroute/
queries:
  arg: resources| where type == 'microsoft.network/virtualnetworkgateways'| where
    properties.gatewayType =~ 'vpn' or properties.gatewayType == 'ExpressRoute'| extend
    SKUName = properties.sku.name, SKUTier = properties.sku.tier, Type = properties.gatewayType|
    extend compliant = SKUTier !in ('Basic', 'Standard')| project name, id, subscriptionId,
    resourceGroup, compliant

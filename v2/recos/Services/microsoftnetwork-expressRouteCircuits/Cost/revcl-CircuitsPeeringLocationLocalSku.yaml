name: revcl-CircuitsPeeringLocationLocalSku
title: Leverage the Local SKU of ExpressRoute to reduce the cost of your circuits,
  if your circuits' peering location supports your Azure regions for the Local SKU.
source:
  type: revcl
  file: ./checklists/alz_checklist.en.json
resourceTypes:
- microsoft.network/expressRouteCircuits
waf: Cost
severity: 0
labels:
  guid: f4e7926a-ec35-476e-a412-5dd17136bd62
  area: Network Topology and Connectivity
  subarea: Hybrid
  id: D06.05
links:
- type: docs
  url: https://learn.microsoft.com/azure/expressroute/expressroute-faqs#expressroute-local
queries:
  arg: resources | where type=='microsoft.network/connections' | where properties.connectionType
    == 'ExpressRoute' | project id, gwid=tostring(properties.virtualNetworkGateway1.id),
    circuitid=tostring(properties.peer.id) | join (resources | where type=='microsoft.network/expressroutecircuits'
    | project circuitid=tostring(id), circuitsku=sku.tier) on circuitid | project
    id=gwid, compliant = (circuitsku == 'Local') | summarize compliant=max(compliant)
    by id

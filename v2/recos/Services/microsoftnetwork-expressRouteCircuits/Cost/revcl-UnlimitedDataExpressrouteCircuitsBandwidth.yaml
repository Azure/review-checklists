name: revcl-UnlimitedDataExpressrouteCircuitsBandwidth
title: Ensure that you're using unlimited-data ExpressRoute circuits only if you reach
  the bandwidth that justifies their cost.
source:
  type: revcl
  file: ./checklists/alz_checklist.en.json
resourceTypes:
- microsoft.network/expressRouteCircuits
waf: Cost
severity: 0
labels:
  guid: 7025b442-f6e9-4af6-b11f-c9574916016f
  area: Network Topology and Connectivity
  subarea: Hybrid
  id: D06.04
links:
- type: docs
  url: https://learn.microsoft.com/azure/expressroute/plan-manage-cost
queries:
  arg: resources | where type=='microsoft.network/expressroutecircuits' | extend compliant
    = (tolower(sku.family) == 'metereddata' or tolower(sku.tier) == 'local') | distinct
    id,compliant

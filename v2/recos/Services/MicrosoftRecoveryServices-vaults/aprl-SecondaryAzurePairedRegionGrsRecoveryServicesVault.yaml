name: aprl-SecondaryAzurePairedRegionGrsRecoveryServicesVault
title: Enable Cross Region Restore for your GRS Recovery Services Vault
description: |-
  Cross Region Restore enables the restoration of Azure VMs in a secondary, Azure paired region, facilitating drills for audit or compliance and allowing recovery of VMs or disks in the event of a primary region disaster. It is an opt-in feature available exclusively for GRS vaults.
source:
  type: aprl
  file: azure-resources/RecoveryServices/vaults/recommendations.yaml
  timestamp: July 24, 2024
resourceTypes:
- Microsoft.RecoveryServices/vaults
severity: 1
labels:
  guid: 1549b91f-2ea0-4d4f-ba2a-4596becbe3de
  area: Disaster Recovery
links: []
queries:
  arg: |-
    // Azure Resource Graph Query
    // Displays all recovery services vaults that do not have cross region restore enabled
    resources
    | where type =~ "Microsoft.RecoveryServices/vaults" and
        properties.redundancySettings.standardTierStorageRedundancy =~ "GeoRedundant" and
        properties.redundancySettings.crossRegionRestore !~ "Enabled"
    | extend
        param1 = strcat("CrossRegionRestore: ", properties.redundancySettings.crossRegionRestore),
        param2 = strcat("StorageReplicationType: ", properties.redundancySettings.standardTierStorageRedundancy)
    | project recommendationId = "1549b91f-2ea0-4d4f-ba2a-4596becbe3de", name, id, tags, param1, param2

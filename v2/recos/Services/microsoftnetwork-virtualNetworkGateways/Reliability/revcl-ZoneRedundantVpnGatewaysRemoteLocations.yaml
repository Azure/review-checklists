name: revcl-ZoneRedundantVpnGatewaysRemoteLocations
title: Use zone-redundant VPN gateways to connect branches or remote locations to
  Azure (where available).
source:
  type: revcl
  file: ./checklists/alz_checklist.en.json
resourceTypes:
- microsoft.network/virtualNetworkGateways
waf: Reliability
severity: 1
labels:
  guid: 4d873974-8b66-42d6-b15f-512a65498f6d
  area: Network Topology and Connectivity
  subarea: Hybrid
  id: D06.09
links:
- type: docs
  url: https://learn.microsoft.com/azure/vpn-gateway/create-zone-redundant-vnet-gateway
- type: docs
  url: https://learn.microsoft.com/training/modules/intro-to-azure-vpn-gateway/
queries:
  arg: resources | where type=='microsoft.network/virtualnetworkgateways' | where
    properties.gatewayType == 'Vpn' | extend compliant = (tolower(properties.sku.name)
    contains 'az') | distinct id, compliant

name: aprl-AzureContainerRegistryAnonymousPullAccess
title: Disable anonymous pull access
description: |-
  By default, Azure container registry requires authentication for pull/push actions. Enabling anonymous pull access exposes all content for public read actions. This applies to all repositories, potentially allowing unrestricted access if repository-scoped tokens are used.
source:
  type: aprl
  file: azure-resources/ContainerRegistry/registries/recommendations.yaml
  timestamp: July 24, 2024
resourceTypes:
- Microsoft.ContainerRegistry/registries
severity: 1
labels:
  guid: 03f4a7d8-c5b4-7842-8e6e-14997a34842b
  area: Security
links: []
queries:
  arg: |
    // Azure Resource Graph Query
    // Find all Container Registries that have anonymous pull access enabled
    resources
    | where type =~ "microsoft.containerregistry/registries"
    | where properties.anonymousPullEnabled == "true"
    | project recommendationId = "03f4a7d8-c5b4-7842-8e6e-14997a34842b", name, id, tags
    | order by id asc

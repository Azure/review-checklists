name: aprl-AzureContainerRegistrySoftDeletePolicy
title: Enable soft delete policy
description: |-
  Enabling soft delete in Azure Container Registry (ACR) allows for the management of deleted artifacts with a specified retention period. Users can list, filter, and restore these artifacts until automatically purged post-retention.
source:
  type: aprl
  file: azure-resources/ContainerRegistry/registries/recommendations.yaml
  timestamp: July 24, 2024
resourceTypes:
- Microsoft.ContainerRegistry/registries
severity: 1
labels:
  guid: e7f0fd54-fba0-054e-9ab8-e676f2851f88
  area: Disaster Recovery
links: []
queries:
  arg: |
    // Azure Resource Graph Query
    // Provides a list of Azure Container Registry resources that do not have soft delete enabled
    resources
    | where type =~ "microsoft.containerregistry/registries"
    | where properties.policies.softDeletePolicy.status == "disabled"
    | project recommendationId = "e7f0fd54-fba0-054e-9ab8-e676f2851f88", name, id, tags
    | order by id asc

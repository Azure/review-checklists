name: revcl-ManagedTlsCertificatesAzureFrontDoor
title: Use managed TLS certificates with Azure Front Door. Reduce operational cost
  and risk of outages due to certificate renewals.
source:
  type: revcl
  file: ./checklists/waf_checklist.en.json
resourceTypes:
- microsoft.network/frontdoors
waf: Operations
severity: 0
labels:
  guid: af95c92d-d723-4f4a-98d7-8722324efd4d
links:
- type: docs
  url: https://learn.microsoft.com/azure/frontdoor/best-practices#use-managed-tls-certificates
queries:
  arg: cdnresources | where type =~ 'microsoft.cdn/profiles/customdomains' | extend
    frontDoorId = substring(id, 0, indexof(id, '/customdomains')) | extend compliant
    = (isnull(properties['tlsSettings']['certificateType']) or tolower(properties['tlsSettings']['certificateType'])
    =~ 'customercertificate') | project compliant, id = frontDoorId

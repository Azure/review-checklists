name: revcl-HeadHealthProbesAzureFrontDoor
title: Use HEAD health probes with Azure Front Door, to reduce the traffic that Front
  Door sends to your application.
source:
  type: revcl
  file: ./checklists/waf_checklist.en.json
resourceTypes:
- microsoft.network/frontdoors
waf: Performance
severity: 2
labels:
  guid: a13f72f3-8f5c-4864-95e5-75bf37fbbeb1
links:
- type: docs
  url: https://learn.microsoft.com/azure/frontdoor/best-practices#use-head-health-probes
queries:
  arg: cdnresources | where type =~ 'microsoft.cdn/profiles/origingroups' | extend
    frontDoorId = substring(id, 0, indexof(id, '/origingroups/')) | extend compliant
    = (isnull(properties['healthProbeSettings']['probeRequestType']) or toupper(properties['healthProbeSettings']['probeRequestType'])
    == 'HEAD') | project compliant, id=frontDoorId

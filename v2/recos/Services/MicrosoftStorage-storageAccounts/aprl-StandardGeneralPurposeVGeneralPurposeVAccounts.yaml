name: aprl-StandardGeneralPurposeVGeneralPurposeVAccounts
title: Consider upgrading legacy storage accounts to v2 storage accounts
description: |-
  General-purpose v2 accounts are recommended for most storage scenarios offering the latest features or the lowest per-gigabyte pricing. Legacy accounts like Standard general-purpose v1 and Blob Storage aren't advised by Microsoft but may fit specific scenarios.
source:
  type: aprl
  file: azure-resources/Storage/storageAccounts/recommendations.yaml
  timestamp: July 24, 2024
resourceTypes:
- Microsoft.Storage/storageAccounts
severity: 2
labels:
  guid: 2ad78dec-5a4d-4a30-8fd1-8584335ad781
  area: Scalability
links: []
queries:
  arg: |
    // Azure Resource Graph Query
    // Find all Azure Storage Accounts, that upgradeable to General purpose v2.
    Resources
    | where type =~ "Microsoft.Storage/storageAccounts" and kind in~ ("Storage", "BlobStorage")
    | extend
        param1 = strcat("AccountKind: ", case(kind =~ "Storage", "Storage (general purpose v1)", kind =~ "BlobStorage", "BlobStorage", kind)),
        param2 = strcat("Performance: ", sku.tier),
        param3 = strcat("Replication: ", sku.name)
    | project recommendationId = "2ad78dec-5a4d-4a30-8fd1-8584335ad781", name, id, tags, param1, param2, param3

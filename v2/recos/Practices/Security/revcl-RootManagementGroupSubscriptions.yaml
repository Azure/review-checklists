name: revcl-RootManagementGroupSubscriptions
title: Enforce no subscriptions are placed under the root management group
source:
  type: revcl
  file: ./checklists/alz_checklist.en.json
resourceTypes: []
waf: Security
severity: 1
labels:
  guid: 33b6b780-8b9f-4e5c-9104-9d403a923c34
  area: Resource Organization
  subarea: Subscriptions
  id: C02.05
links:
- type: docs
  url: https://learn.microsoft.com/azure/governance/management-groups/how-to/protect-resource-hierarchy#setting---default-management-group
queries:
  arg: resourcecontainers| where type == 'microsoft.resources/subscriptions'| extend
    ManagementGroup = tostring(tags),mgmtChain = properties.managementGroupAncestorsChain|
    extend compliant = (array_length(mgmtChain) > 1)

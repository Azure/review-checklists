guid: 1adba190-5c4c-e646-8527-dd1b2a6d8b15
name: SecureInternetConnections
title: Use NAT gateway for outbound connectivity to avoid SNAT Exhaustion
description: Prevent connectivity failures due to SNAT port exhaustion by employing
  NAT gateway for outbound traffic from virtual networks, ensuring dynamic scaling
  and secure internet connections.
source:
  type: aprl
  file: azure-resources/Network/publicIPAddresses/recommendations.yaml
  timestamp: July 24, 2024
services:
- Microsoft.Network/publicIPAddresses
resourceTypes:
- Microsoft.Network/publicIPAddresses
severity: 1
labels:
  area: High Availability
links: []
queries:
  arg: |-
    // Azure Resource Graph query
    // Lists VMs with PIPs
    resources
    | where type =~ 'Microsoft.Network/publicIPAddresses'
    | where tostring(properties.ipConfiguration.id) contains "microsoft.network/networkinterfaces"
    | project recommendationId="1adba190-5c4c-e646-8527-dd1b2a6d8b15", name, id, tags, param1=strcat("Migrate from instance IP to NAT Gateway")

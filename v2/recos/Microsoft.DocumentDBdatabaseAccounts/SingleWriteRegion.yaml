guid: 9cabded7-a1fc-6e4a-944b-d7dd98ea31a2
name: SingleWriteRegion
title: Enable service-managed failover for multi-region accounts with single write
  region
description: Cosmos DB boasts high uptime and resiliency. Even so, issues may arise.
  With Service-Managed failover, if a region is down, Cosmos DB automatically switches
  to the next available region, requiring no user action.
source:
  type: aprl
  file: azure-resources/DocumentDB/databaseAccounts/recommendations.yaml
  timestamp: July 24, 2024
services:
- Microsoft.DocumentDB/databaseAccounts
resourceTypes:
- Microsoft.DocumentDB/databaseAccounts
severity: 0
labels:
  area: Disaster Recovery
links: []
queries:
  arg: |-
    // Azure Resource Graph Query
    // Query to list all Azure Cosmos DB accounts that do not have multiple write locations or automatic failover enabled
    Resources
    | where type =~ 'Microsoft.DocumentDb/databaseAccounts'
    | where
        array_length(properties.locations) > 1 and
        tobool(properties.enableAutomaticFailover) == false and
        tobool(properties.enableMultipleWriteLocations) == false
    | project recommendationId='9cabded7-a1fc-6e4a-944b-d7dd98ea31a2', name, id, tags
